{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stemmer"]},"docs":[{"location":"","title":"Material for MkDocs","text":"<p>Welcome to Material for MkDocs.</p>"},{"location":"backend/framework/spring_boot/","title":"Spring Boot \u6846\u67b6","text":"<ul> <li>\u5b78\u7fd2 Spring Boot \u6846\u67b6\u7684\u57fa\u672c\u89c0\u5ff5 &amp; \u529f\u80fd</li> </ul> \u76ee\u9304<ul> <li>Spring Boot \u6846\u67b6<ul> <li>\u5b78\u7fd2\u8def\u7dda</li> <li>\u5efa\u7acb Spring Boot \u5c08\u6848<ul> <li>\u5c08\u6848\u76ee\u9304\u7d50\u69cb</li> <li>Annotation (\u8a3b\u89e3)</li> </ul> </li> <li>Spring Core \u6838\u5fc3\u89c0\u5ff5<ul> <li>Spring IoC</li> <li>Spring AOP</li> </ul> </li> <li>Spring MVC<ul> <li>Restful API \u98a8\u683c</li> <li>\u9a57\u8b49\u8acb\u6c42\u53c3\u6578</li> <li>HTTP \u72c0\u614b\u78bc</li> <li>\u6514\u622a\u5668 (Interceptor)</li> </ul> </li> <li>Spring JDBC<ul> <li>IntelliJ \u7684\u8cc7\u6599\u5eab GUI</li> <li>\u4f7f\u7528 Spring JDBC</li> <li>Controller-Service-Dao \u4e09\u5c64\u5f0f\u67b6\u69cb</li> <li>\u4ea4\u6613\u7ba1\u7406</li> </ul> </li> <li>Spring Data JPA<ul> <li>JPA &amp; Hibernate</li> <li>\u4f7f\u7528 Spring Data JPA</li> </ul> </li> <li>Spring Boot \u55ae\u5143\u6e2c\u8a66<ul> <li>JUnit \u55ae\u5143\u6e2c\u8a66</li> <li>Service \u5c64\u3001Dao \u5c64\u7684\u55ae\u5143\u6e2c\u8a66</li> <li>Controller \u5c64\u7684\u55ae\u5143\u6e2c\u8a66</li> <li>Mock \u6e2c\u8a66</li> <li>H2 \u8cc7\u6599\u5eab</li> <li>\u55ae\u5143\u6e2c\u8a66\u7d93\u9a57\u8ac7</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#_1","title":"\u5b78\u7fd2\u8def\u7dda","text":"<ul> <li>2024 \u5e74   </li> </ul>"},{"location":"backend/framework/spring_boot/#spring-boot_1","title":"\u5efa\u7acb Spring Boot \u5c08\u6848","text":"<ul> <li>Spring Boot \u6846\u67b6\u5be6\u969b\u4e0a\u80cc\u5f8c\u4ecd\u662f\u4f7f\u7528 Spring \u6846\u67b6\u7684\u529f\u80fd\uff0c\u53ea\u662f\u5305\u88dd\u5f97\u66f4\u7c21\u55ae\uff0c\u5e0c\u671b\u9054\u5230\u958b\u7bb1\u5373\u7528</li> <li>Spring Boot \u7279\u6027<ul> <li>Convention over configuration: \u7d04\u5b9a\u5927\u65bc\u914d\u7f6e or \u6163\u4f8b\u512a\u65bc\u8a2d\u5b9a<ul> <li>\u4e0d\u9700\u6dfb\u52a0\u4efb\u4f55\u8a2d\u5b9a\uff0c\u53ea\u8981\u77e5\u9053\u904b\u4f5c\u898f\u5247\uff0c\u5c31\u80fd\u76f4\u63a5\u4f7f\u7528</li> <li>\u6240\u6709 project \u7686\u9075\u5faa\u4e00\u81f4\u7684\u6a19\u6e96\u5316\u8a2d\u5b9a</li> </ul> </li> </ul> </li> <li>IDE: IntelliJ Ulitimate \u7248\u672c</li> <li>New Project -&gt; Spring Initializr<ul> <li>Type(\u5957\u4ef6\u7ba1\u7406\u5305\u5de5\u5177): Gradle \u6216 Maven</li> <li>JDK: \u9078\u64c7 OpenJDK \u7684\u7248\u672c (e.g. 17.0.4)<ul> <li>\u9700\u7559\u610f JDK \u8207 Java \u7684\u7248\u672c\u9700\u4e00\u81f4!</li> </ul> </li> <li>Java: \u7a0b\u5f0f\u8a9e\u8a00\u7684\u7248\u672c (e.g. 17)<ul> <li>Java \u7248\u672c\u4e5f\u6703\u8207 Spring Boot \u7248\u672c\u6709\u76f8\u4f9d\u6027<ul> <li>Java 11 \u958b\u767c Spring Boot 2</li> <li>Java 17 \u958b\u767c Spring Boot 3</li> </ul> </li> </ul> </li> <li>Packaging: JAR \u6216 WAR</li> </ul> </li> <li>Spring Boot \u9810\u8a2d\u57df\u540d(domain) = <code>http://localhost:8080</code></li> <li> <p>Spring Boot \u9810\u8a2d\u7576\u56de\u50b3\u578b\u5225\u662f\u4f7f\u7528\u8005\u81ea\u5b9a\u7fa9 class \u6642 (e.g. Student)\uff0c\u6703\u81ea\u52d5\u8f49\u63db\u6210 JSON \u683c\u5f0f\u653e\u5230 response body \u56de\u50b3\u51fa\u53bb</p> <ul> <li>\u80cc\u5f8c\u662f\u4f7f\u7528 Jackson library \u4f86\u5b8c\u6210 Java class &lt;-&gt; JSON object</li> </ul> </li> <li> <p>IntelliJ IDE</p> <ul> <li>\u9810\u8a2d\u6703\u81ea\u52d5\u5132\u5b58\u6240\u6709\u7a0b\u5f0f\u78bc\u8b8a\u52d5</li> <li>MacOS: <code>option + Enter</code> \u986f\u793a\u76ee\u524d\u7d05\u8272\u6ce2\u6d6a\u932f\u8aa4\u7684\u53ef\u80fd\u89e3\u6c7a\u65b9\u6cd5\u6709\u54ea\u4e9b</li> <li>MacOS: <code>shift + option</code> \u79fb\u52d5\u7a0b\u5f0f\u78bc (\u4ee5 row \u70ba\u55ae\u4f4d)</li> <li>MacOS \u9078\u53d6\u591a\u500b\u6a94\u6848: \u6309\u4f4f command \u9375</li> <li>MacOS \u6df1\u5165\u6aa2\u8996 method, interface: \u6309\u4f4f command \u9375 + \u6ed1\u9f20\u9ede\u9078\u8a72 method, interface</li> <li>\u8f38\u5165 <code>sout</code> = <code>System.out.println();</code></li> <li>\u8f38\u5165 <code>psvm</code> = <code>public static void main(String[] args) {}</code></li> <li>\u5feb\u901f\u7522\u751f class \u7684 constructor(), getter(), setter() \u65b9\u6cd5: <code>\u53f3\u9375 -&gt; generate -&gt; \u9078\u64c7\u8981\u7522\u751f\u7684 method \u985e\u578b</code></li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#_2","title":"\u5c08\u6848\u76ee\u9304\u7d50\u69cb","text":"Markdown<pre><code>project-name\n\u251c\u2500\u2500 .idea/\n\u251c\u2500\u2500 .mvn/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 main/\n\u2502       \u251c\u2500\u2500 java/               # \u653e Java \u7a0b\u5f0f\n\u2502       \u251c\u2500\u2500 resources/          # \u653e Spring Boot \u8a2d\u5b9a\u6a94\n\u2502       \u251c\u2500\u2500 static/\n\u2502       \u251c\u2500\u2500 templates/\n\u2502       \u2514\u2500\u2500 application.properties  # \u6700\u91cd\u8981\u7684 Spring Boot \u8a2d\u5b9a\u6a94\n\u2502   \u251c\u2500\u2500 test/\n\u2502       \u251c\u2500\u2500 java/               # \u653e\u6e2c\u8a66\u7528\u7684 Java \u7a0b\u5f0f\n\u2502       \u2514\u2500\u2500 resources/          # \u653e\u6e2c\u8a66\u7528\u7684 Spring Boot \u8a2d\u5b9a\u6a94\n\u2514\u2500\u2500 pom.xml                     # Maven \u7ba1\u7406\u5957\u4ef6\u7684\u8a2d\u5b9a\u6a94\n</code></pre> <ul> <li> <p>Spring Boot \u8a2d\u5b9a\u6a94 (application.properties)</p> <ul> <li>\u5b58\u653e Spring Boot \u7684\u8a2d\u5b9a\u503c\uff0c\u7528\u65bc\u5b9a\u7fa9 Spring Boot \u61c9\u7528\u7a0b\u5f0f\u7684\u914d\u7f6e\u53c3\u6578<ul> <li>\u61c9\u7528\u7a0b\u5f0f\u53c3\u6578: log, port ...\u7b49</li> <li>\u74b0\u5883\u914d\u7f6e: dev, test, prod ...\u7b49</li> <li>\u81ea\u5b9a\u7fa9\u53c3\u6578</li> </ul> </li> <li>\u4f7f\u7528 properties \u8a9e\u6cd5: <code>key=value</code><ul> <li><code>=</code> \u7684\u524d\u5f8c\u4e0d\u9700\u52a0\u4e0a\u7a7a\u767d\u9375</li> <li>key \u53ef\u4ee5\u6709 <code>.</code> \u7b26\u865f\uff0c\u76f8\u7576\u65bc\u4e2d\u6587 \"\u7684\"</li> <li>value \u82e5\u70ba String \u578b\u5225\uff0c\u4e0d\u9700\u8981\u52a0\u4e0a <code>\" \"</code></li> <li>\u7528 <code>#</code> \u8868\u793a\u8a3b\u89e3 (comment)</li> </ul> </li> </ul> Properties<pre><code>count=5\nmy.name=Hans\nmy.age=28\n# this is a comment\n</code></pre> </li> <li> <p>\u5957\u4ef6\u7ba1\u7406\u7684\u8a2d\u5b9a\u6a94 (pom.xml)</p> <ul> <li> <p>Maven \u7ba1\u7406\u5957\u4ef6\u7684\u8a2d\u5b9a\u6a94\uff0c\u7528\u65bc\u7ba1\u7406\u5957\u4ef6\u7684\u8a2d\u5b9a\u3001\u7248\u672c\u3001\u4f9d\u8cf4\u95dc\u4fc2</p> </li> <li> <p>\u8a2d\u5b9a Spring Boot \u7248\u672c\u3002\u66f4\u65b0\u5f8c\uff0c\u9700\u6309\u53f3\u9375 Maven -&gt; Reload Project XML<pre><code>&lt;parent&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n    &lt;version&gt;3.2.5&lt;/version&gt;\n    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n&lt;/parent&gt;\n</code></pre></p> </li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#annotation","title":"Annotation (\u8a3b\u89e3)","text":"<ul> <li><code>@SpringBootApplication</code>: \u52a0\u5728 class \u4e0a\uff0c\u57f7\u884c Spring Boot \u7a0b\u5f0f\u7528</li> </ul> Java<pre><code>@SpringBootApplication\npublic class DemoApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(DemoApplication.class, args);\n    }\n\n}\n</code></pre> <ul> <li>\u82e5\u6709\u591a\u500b annotation\uff0c\u5176\u4e4b\u9593\u6c92\u6709\u9806\u5e8f\u6027</li> </ul>"},{"location":"backend/framework/spring_boot/#spring-core","title":"Spring Core \u6838\u5fc3\u89c0\u5ff5","text":""},{"location":"backend/framework/spring_boot/#spring-ioc","title":"Spring IoC","text":"<ul> <li> <p>IoC (Inversion of Control, \u63a7\u5236\u53cd\u8f49): \u5c07 object \u7684\u63a7\u5236\u6b0a\uff0c(\u5012\u8f49)\u4ea4\u7d66\u4e86\u5916\u90e8\u7684 Spring container \u4f86\u7ba1\u7406</p> <ul> <li> <p>Spring \u6703\u9810\u5148\u5efa\u7acb\u7269\u4ef6\uff0c\u5b58\u653e\u5728 container \u7ba1\u7406 (\u4e0d\u7528\u7ba1\u5be6\u969b\u662f\u600e\u9ebc <code>new()</code> \u51fa\u4f86\u7684)</p> <p>Spring \u5148\u8cb7\u4e86\u4e00\u53f0\u5370\u8868\u6a5f\uff0c\u4e4b\u5f8c\u6709\u4eba\u8981\u7528\u5370\u8868\u6a5f\u7684\u8a71\uff0c\u5c31\u8ddf Spring \u501f\u4f86\u7528\uff0c\u800c\u4e0d\u7528\u7ba1\u7406\u662f\u4ec0\u9ebc\u5ee0\u724c\u7684\u5370\u8868\u6a5f</p> </li> </ul> </li> <li> <p>DI (Dependency Injection, \u4f9d\u8cf4\u6ce8\u5165): Spring container \u5c07 bean \u4ea4\u7d66\u67d0\u500b class \u4f7f\u7528</p> </li> <li> <p>Bean: \u5b58\u653e\u5728 Spring container \u88e1\u7684 object</p> <ul> <li>\u9810\u8a2d\u7684\u7269\u4ef6\u540d\u7a31 = @Component class \u7684\u9996\u5b57\u6bcd\u5c0f\u5beb</li> </ul> </li> <li> <p>@Component \u8a3b\u89e3: \u52a0\u5728 class \u4e0a\uff0c\u5c07 class \u8b8a\u6210 Spring container \u6240\u7ba1\u7406\u7684 bean</p> <ul> <li>\u8f03\u5e38\u4f7f\u7528</li> </ul> </li> <li> <p>@Autowired \u8a3b\u89e3: \u52a0\u5728 \u8b8a\u6578 \u4e0a\uff0c\u6839\u64da \u8b8a\u6578\u7684\u578b\u5225\uff0c\u53bb Spring \u5bb9\u5668\u4e2d\u5c0b\u627e\u76f8\u5c0d\u61c9\u7684 bean</p> <ul> <li>\u8b8a\u6578\u578b\u5225\u76e1\u91cf\u4f7f\u7528 Interface\uff0c\u8b93 Java \u53ef\u900f\u904e\u591a\u578b\u9032\u884c\u5411\u4e0a\u8f49\u578b\uff0c\u63d0\u9ad8\u7a0b\u5f0f\u78bc\u91cd\u7528\u6027</li> </ul> </li> <li> <p>@Qualifier \u8a3b\u89e3: \u901a\u5e38\u52a0\u5728 \u8b8a\u6578 \u4e0a\uff0c\u8f14\u52a9 @Autowired\uff0c\u7528\u4f86\u6307\u5b9a\u8981\u8f09\u5165\u7684 bean \u540d\u7a31</p> </li> </ul> Java<pre><code>// \u4ecb\u9762\npublic interface Printer {\n    void print(String message);\n}\n\n// \u5be6\u4f5c\u4ecb\u9762\n@Component  // bean (\u53ef\u60f3\u50cf\u6210 Spring container \u70ba\u6211\u5011\u57f7\u884c Printer hpPrinter = new HpPrinter();)\npublic class HpPrinter implements Printer {\n    @Override\n    public void print(String message) {\n        System.out.println(\"HP \u5370\u8868\u6a5f: \" + message);\n    }\n}\n\n// \u5be6\u4f5c\u4ecb\u9762\n@Component\npublic class CanonPrinter implements Printer {\n    @Override\n    public void print(String message) {\n        System.out.println(\"Canon \u5370\u8868\u6a5f: \" + message);\n    }\n}\n</code></pre> Java<pre><code>// \u539f\u5beb\u6cd5\n// public class Teacher {\n//  private Printer printer = new HpPrinter();\n\n//   public void teach() {\n//     printer.print(\"I'm a teacher.\");\n//   }\n// }\n\n// IoC \u5beb\u6cd5: \u7531 Container \u8ca0\u8cac\u7ba1\u7406 Printer \u7269\u4ef6\n@Component  // \u8981\u4f7f\u7528 DI bean \u4e4b\u524d\uff0c\u81ea\u5df1\u672c\u8eab\u4e5f\u8981\u662f bean\npublic class Teacher {\n    @Autowired  // DI (\u4f9d\u8cf4\u6ce8\u5165)\u7684\u7528\u6cd5\n    @Qualifier(\"hpPrinter\") // \u6307\u5b9a\u8981\u8f09\u5165\u7684 bean \u540d\u7a31\n    private Printer printer; // \u8b8a\u6578\u578b\u5225\u76e1\u91cf\u4f7f\u7528 Interface (e.g. Printer)\n\n    public void teach() {\n        printer.print(\"I'm a teacher.\");\n    }\n}\n</code></pre> <ul> <li>@Configuration \u8a3b\u89e3: \u52a0\u5728 class \u4e0a\uff0c\u8868\u793a\u8a72 class \u662f\u7528\u4f86 \u8a2d\u5b9a Spring \u7528\u7684<ul> <li>\u9019\u6642\u5019 class \u540d\u7a31\u662f\u4ec0\u9ebc\u5176\u5be6\u4e0d\u592a\u91cd\u8981 (e.g. MyConfiguration)</li> </ul> </li> <li>@Bean \u8a3b\u89e3: \u52a0\u5728\u5e36\u6709 @Configuration \u7684 class \u4e0a\uff0c\u65bc Spring container \u4e2d\u5efa\u7acb\u4e00\u500b bean<ul> <li>\u6240\u5efa\u7acb\u51fa\u4f86\u7684 bean\uff0c\u9810\u8a2d\u6703\u662f method \u540d\u7a31</li> <li>\u53ef\u4ee5\u5728 @Bean \u8a3b\u89e3\u5f8c\u9762\u6307\u5b9a bean \u7684\u540d\u7a31<ul> <li><code>@Bean(\"xxx\")</code></li> </ul> </li> </ul> </li> </ul> Java<pre><code>@Configuration\npublic class MyConfiguration {\n        @Bean\n        public Printer myPrinter() {\n        // \u53ef\u60f3\u50cf\u6210 Spring container \u5e6b\u6211\u5011\u57f7\u884c\u4ee5\u4e0b\u9019\u500b method\n        // Printer myPrinter = \u8a72 method \u8fd4\u56de\u7684 object (hpPrinter)\n        // \u6240\u5efa\u7acb\u51fa\u4f86\u7684 bean\uff0c\u9810\u8a2d\u6703\u662f method \u540d\u7a31 (myPrinter)\n        return new HpPrinter();\n    }\n}\n</code></pre> <ul> <li> <p>Spring \u4e2d\u521d\u59cb\u5316 bean \u7684\u65b9\u6cd5</p> <ul> <li>@PostConstruct \u8a3b\u89e3: \u8a2d\u5b9a Spring container \u4e2d\u7684 bean \u7684\u521d\u59cb\u503c<ul> <li>\u8f03\u5e38\u4f7f\u7528</li> <li>\u5fc5\u9808\u662f public method</li> <li>\u8fd4\u56de\u578b\u5225\u5fc5\u9808\u662f void</li> <li>method \u540d\u7a31\u53ef\u4ee5\u96a8\u610f\u53d6</li> <li>method \u4e0d\u80fd\u6709\u53c3\u6578</li> </ul> </li> <li>\u5be6\u4f5c InitializingBean interface \u7684 afterPropertiesSet() method</li> </ul> Java<pre><code>// \u6cd5 1: @PostConstruct \u8a3b\u89e3\npublic class hpPrinter implements Printer {\n    private int count;\n\n    @PostConstruct\n    public void initialize() {\n        count = 5;\n    }\n\n    @Override\n    public void print(String message) {\n        count--;\n        System.out.println(\"HP \u5370\u8868\u6a5f: \" + message);\n        System.out.println(\"\u5269\u9918\u4f7f\u7528\u6b21\u6578: \" + count);\n    }\n}\n</code></pre> Java<pre><code>// \u6cd5 2: \u5be6\u4f5c InitializingBean interface \u7684 afterPropertiesSet() method\n@Component\npublic class HpPrinter implements Printer, InitializingBean {\n    private int count;\n\n    @Override\n    public void afterPropertiesSet throws Exception {\n        count = 5;\n    }\n\n    @Override\n    public void print(String message) {\n        count--;\n        System.out.println(\"HP \u5370\u8868\u6a5f: \" + message);\n        System.out.println(\"\u5269\u9918\u4f7f\u7528\u6b21\u6578: \" + count);\n    }\n}\n</code></pre> </li> <li> <p>Bean \u751f\u547d\u9031\u671f</p> <ul> <li>\u5efa\u7acb -&gt; \u521d\u59cb\u5316 -&gt; \u53ef\u4ee5\u88ab\u5225\u4eba\u62ff\u53bb\u4f7f\u7528</li> <li>\u7576\u5efa\u7acb bean \u6642\u767c\u73fe\u9700\u8981\u4f9d\u8cf4\u5176\u5b83 bean\uff0c\u5247 Spring \u6703\u56de\u904e\u982d\u53bb \"\u5efa\u7acb + \u521d\u59cb\u5316\" \u90a3\u500b\u88ab\u4f9d\u8cf4\u7684 bean</li> <li>\u52ff\u5beb\u51fa\u6703\u767c\u751f\u5faa\u74b0\u4f9d\u8cf4\u7684\u7a0b\u5f0f\u78bc (e.g. A \u4f9d\u8cf4\u65bc B\uff0c\u4e14 B \u4f9d\u8cf4\u65bc A)</li> </ul> </li> <li> <p>@Value \u8a3b\u89e3: \u8b80\u53d6 Spring Boot \u8a2d\u5b9a\u6a94 (<code>application.properties</code>) \u4e2d\uff0c\u6307\u5b9a\u7684 key \u7684\u503c</p> <ul> <li>\u7528\u6cd5: \u52a0\u5728 bean \u6216\u662f\u8a2d\u5b9a Spring \u7528\u7684 class \u88e1\u9762\u7684 \u8b8a\u6578 \u4e0a<ul> <li>e.g. \u5e36\u6709 @Component \u8a3b\u89e3\u3001@Configuration \u8a3b\u89e3 \u7684 class \u4e0a</li> </ul> </li> <li>\u8a9e\u6cd5: <code>\"${ }\"</code><ul> <li><code>${unknown:Amy}</code>: \u8a2d\u5b9a @Value \u8a3b\u89e3\u7684\u9810\u8a2d\u503c (\u82e5\u627e\u4e0d\u5230\u76f8\u5c0d\u61c9 key \u7684\u503c\uff0c\u624d\u6703\u4f7f\u7528\u6307\u5b9a\u7684\u9810\u8a2d\u503c)</li> </ul> </li> </ul> Java<pre><code>@Component\npublic class MyBean {\n    @Value(\"${count}\")\n    private Integer numb;  // 5\n\n    @Value(\"$my.name\")\n    private String name;  // \"Hans\"\n\n    @Value(\"${unknown:Amy}\")\n    private String herName; // \"Amy\"\n}\n</code></pre> </li> <li> <p>IoC \u512a\u9ede</p> <ul> <li>\u9b06\u8026\u5408 (loose coupling): \u8b93 class \u4e4b\u9593\u7684\u95dc\u806f\u6027\u964d\u4f4e</li> <li>\u751f\u547d\u9031\u671f\u7ba1\u7406 (lifecycle management): \u7531 Spring container \u8ca0\u8cac\u8a72 object \u7684\u5efa\u7acb\u3001\u521d\u59cb\u5316\u3001\u92b7\u6bc0</li> <li>\u65b9\u4fbf\u6e2c\u8a66\u7a0b\u5f0f (more testable)</li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#spring-aop","title":"Spring AOP","text":"<ul> <li> <p>AOP (Aspect-Oriented Programming, \u5207\u9762\u5c0e\u5411\u7a0b\u5f0f\u8a2d\u8a08): \u5c07\u6240\u6709 method \u8981\u57f7\u884c\u7684\u5171\u540c\u908f\u8f2f\u5beb\u5728\u5207\u9762\u4e2d\uff0c\u4e26\u4e14\u8b93\u8a72\u5207\u9762\u6a6b\u8cab\u6240\u6709 method\uff0c\u66ff\u6240\u6709 method \u53bb\u57f7\u884c\u9019\u500b\u5171\u540c\u7684\u908f\u8f2f</p> </li> <li> <p>\u8a2d\u5b9a AOP</p> <ul> <li>\u5728 <code>pom.xml</code> \u4e2d\u8a2d\u5b9a\u5f8c\uff0c\u6309\u53f3\u9375 Maven -&gt; Reload Project \u91cd\u65b0\u8f09\u5165\u65b0\u7684\u8a2d\u5b9a</li> </ul> XML<pre><code>&lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> </li> <li> <p>@Aspect \u8a3b\u89e3: \u52a0\u5728 \u5e36\u6709 @Component \u8a3b\u89e3\u7684 class \u4e0a (= bean)\uff0c\u7528\u4f86\u5ba3\u544a\u9019\u500b class \u662f\u4e00\u500b\u5207\u9762</p> </li> <li> <p>\u5207\u5165\u9ede(pointcut) \u8868\u9054\u5f0f: \u8981\u7528\u5230\u6642\u518d\u67e5\u5c31\u53ef\u4ee5\u4e86</p> </li> <li> <p>@Before \u8a3b\u89e3: \u52a0\u5728 \u5207\u9762 class \u7684 method \u4e0a\uff0c\u65bc \u5207\u5165\u9ede\u7684 method \u57f7\u884c\u4e4b\u524d \u6240\u57f7\u884c</p> </li> <li> <p>@After \u8a3b\u89e3: \u52a0\u5728 \u5207\u9762 class \u7684 method \u4e0a\uff0c\u65bc \u5207\u5165\u9ede\u7684 method \u57f7\u884c\u4e4b\u5f8c \u6240\u57f7\u884c</p> </li> <li> <p>@Around \u8a3b\u89e3: \u52a0\u5728 \u5207\u9762 class \u7684 method \u4e0a\uff0c\u65bc \u5207\u5165\u9ede\u7684 method \u57f7\u884c\u4e4b\u524d\u3001\u5f8c \u6240\u57f7\u884c</p> </li> <li> <p><code>Object obj = pjp.proceed()</code>: \u57f7\u884c\u5207\u5165\u9ede\u7684\u65b9\u6cd5</p> </li> <li> <p>@AfterThrowing \u8a3b\u89e3: \u52a0\u5728 \u5207\u9762 class \u7684 method \u4e0a\uff0c\u65bc \u5207\u5165\u9ede\u7684 method \u62cb\u51fa\u7570\u5e38\u5f8c \u624d\u6703\u57f7\u884c</p> <ul> <li>\u8f03\u5c11\u4f7f\u7528</li> </ul> </li> <li> <p>@AfterReturning \u8a3b\u89e3: \u52a0\u5728 \u5207\u9762 class \u7684 method \u4e0a\uff0c\u65bc \u5207\u5165\u9ede\u7684 method \u57f7\u884c\u6210\u529f\u5f8c \u624d\u6703\u57f7\u884c</p> <ul> <li>\u8f03\u5c11\u4f7f\u7528</li> </ul> </li> </ul> Java<pre><code>@Aspect\n@Component\npublic class MyAspect {\n    // 2. @Before \u5728\u57f7\u884c A \u65b9\u6cd5\u4e4b\u524d   // 1. \u6211\u5011\u6307\u5b9a\u7684\u65b9\u6cd5 A\n    @Before(\"execution(* com.example.demo.HpPrinter.*(..))\")\n    // 3. \u5148\u8b93 Spring \u57f7\u884c\u9019\u500b before() \u65b9\u6cd5\n    public void before() {\n        System.out.println(\"I'm before\");\n    }\n\n    public void after() {\n        System.out.println(\"I'm after\");\n    }\n}\n</code></pre> Java<pre><code>@Aspect\n@Component\npublic class MyAspectAround {\n    @Around(\"execution(* com.example.demo.HpPrinter.*(..))\")\n    public Object around(ProceedingJoinPoint pjp) throws Throwable {\n        System.out.println(\"I'm around before.\");\n        // \u57f7\u884c\u5207\u5165\u9ede\u7684\u65b9\u6cd5 (e.g. hpPrinter.print();)\n        Object obj = pjp.proceed();\n        System.out.println(\"I'm around after.\");\n        return obj;\n    }\n}\n</code></pre> <ul> <li>AOP \u4f7f\u7528\u60c5\u5883<ul> <li>\u6b0a\u9650\u9a57\u8b49: Spring Security</li> <li>\u7d71\u4e00\u7684 Exception \u8655\u7406: @ControllerAdvice</li> <li>Log \u7d00\u9304</li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#spring-mvc","title":"Spring MVC","text":"<ul> <li> <p>\u5c6c\u65bc Spring \u6846\u67b6\u7684\u4e00\u90e8\u5206\uff0c\u63a1\u7528 Model-View-Controller (MVC) \u7684\u8a2d\u8a08\u6a21\u5f0f\uff0c\u4ee5\u958b\u767c\u7db2\u9801\u61c9\u7528\u7a0b\u5f0f\u7684\u6846\u67b6</p> <ul> <li>\u5c07\u4e00\u500b\u7cfb\u7d71\uff0c\u53bb\u62c6\u5206\u6210\u300cModel\u3001View\u3001Controller\u300d\u4e09\u500b\u90e8\u5206\uff0c\u4e26\u4e14\u8b93\u6bcf\u4e00\u500b\u90e8\u5206\u90fd\u5404\u81ea\u8ca0\u8cac\u4e0d\u540c\u7684\u529f\u80fd</li> <li>\u5206\u985e\u6211\u5011\u6240\u5beb\u7684\u7a0b\u5f0f</li> <li>\u512a\u9ede: <ul> <li>\u8077\u8cac\u5206\u96e2\uff0c\u66f4\u5bb9\u6613\u7dad\u8b77\u7a0b\u5f0f</li> <li>\u4f7f\u7a0b\u5f0f\u7d50\u69cb\u66f4\u76f4\u89ba\uff0c\u6709\u5229\u65bc\u5718\u968a\u5206\u5de5</li> <li>\u53ef\u91cd\u8907\u4f7f\u7528 \u5beb\u597d\u7684\u7a0b\u5f0f</li> </ul> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> </li> <li> <p>@Controller \u8a3b\u89e3\u3001@RestController \u8a3b\u89e3: \u7528\u5728 class \u4e0a\uff0c\u5c07 class \u8b8a\u6210 bean \u5132\u5b58\uff0c\u4e26\u4e14\u53ef\u4ee5\u4f7f\u7528 @RequestMapping \u8a3b\u89e3\u65bc\u5176\u5167\u90e8\u7684 method \u4e0a</p> <ul> <li>\u53ef\u60f3\u50cf\u6210\u52a0\u5f37\u7248\u7684 @Component \u8a3b\u89e3</li> <li> <p>\u4f7f\u7528 @Controller \u8a3b\u89e3\uff0c\u9700\u5728 class \u5167\u7684\u6bcf\u500b method \u4e0a\u9762\u52a0\u4e0a @RespondBody \u8a3b\u89e3</p> Java<pre><code>@Controller\npublic class MyController {\n    @ResponseBody\n    @RequestMapping(\"/product\")\n    public String product() {\n        return \"\u7b2c\u4e00\u500b\u662f\u860b\u679c \u7b2c\u4e8c\u500b\u662f\u6a58\u5b50\";\n    }\n\n    @ResponseBody\n    @RequestMapping(\"/user\")\n    public String user() {\n        return \"\u540d\u5b57\u70ba Judy\";\n    }\n}\n</code></pre> </li> <li> <p>\u4f7f\u7528 @RestController \u8a3b\u89e3\uff0c\u5c31\u4e0d\u7528\u52a0\u4e0a @ResponseBody \u8a3b\u89e3     Java<pre><code>@RestController\npublic class MyController {\n    @RequestMapping(\"/product\")\n    public String product() {\n        return \"\u7b2c\u4e00\u500b\u662f\u860b\u679c \u7b2c\u4e8c\u500b\u662f\u6a58\u5b50\";\n    }\n\n    @RequestMapping(\"/user\")\n    public String user() {\n        return \"\u540d\u5b57\u70ba Judy\";\n    }\n}\n</code></pre></p> </li> </ul> </li> <li> <p>@RequestMapping \u8a3b\u89e3: \u7528\u5728 \u5e36\u6709 @Controller \u8a3b\u89e3 or @RestController \u8a3b\u89e3\u7684 class \u4e0a\uff0c\u6216 method \u4e0a\uff0c\u53ef\u5c07 \u6307\u5b9a\u7684 url \u7684\u8def\u5f91\u5c0d\u61c9\u5230 method \u4e0a</p> <ul> <li>\u50c5\u9700\u6307\u5b9a url \u7684\u8def\u5f91\u5373\u53ef\uff0c\u4e0d\u9700\u5305\u542b\u57df\u540d</li> </ul> Java<pre><code>@RestController\npublic class MyController {\n    // \u6cd5 1: \u7528\u5728 method \u4e0a\n    @RequestMapping(\"/test\")\n    public String test() {\n        System.out.println(\"Hi!\");\n        return \"Hello World\";\n    }\n}\n</code></pre> Java<pre><code>@RestController\n// \u6cd5 2: \u7528\u5728\u5e36\u6709 @RequestController \u8a3b\u89e3\u7684 class \u4e0a\n@RequestMapping(\"/detail\")\npublic class MyController {\n    @RequestMapping(\"/test\")  // url \u7684\u8def\u5f91\u6703\u8b8a\u6210 /detail/test\n    public String test() {\n        System.out.println(\"Hi!\");\n        return \"Hello World\";\n    }\n}\n</code></pre> </li> <li> <p>\u53d6\u5f97\u8acb\u6c42\u53c3\u6578</p> </li> <li> <p>@RequestParam \u8a3b\u89e3: \u53d6\u5f97 url \u7684\u53c3\u6578 (query parameter)</p> <ul> <li>e.g. http://localhost:8080/test1?id=123&amp;name=Hans</li> <li>\u82e5\u5f8c\u7aef API method \u7684\u53c3\u6578\u6709\u52a0\u4e0a @RequestParam \u8a3b\u89e3\u7684\u8a71\uff0c\u524d\u7aef\u767c\u8d77 request \u6642\uff0c\u5c31\u5fc5\u9808\u8981\u586b\u5165\u53c3\u6578\u503c\uff0c\u5426\u5247\u6703\u5f15\u767c\u932f\u8aa4</li> <li>name \u6216 value \u8a2d\u5b9a: \u6307\u5b9a url \u53c3\u6578\u7684\u540d\u5b57 (\u524d\u7aef\u767c\u51fa request \u6642\u5c31\u5fc5\u9808\u4f7f\u7528\u8a72 url \u53c3\u6578\u540d\u7a31\u4f86\u8ce6\u503c)<ul> <li>\u8f03\u5c11\u4f7f\u7528</li> </ul> </li> <li>required \u8a2d\u5b9a: \u8868\u793a\u662f\u5426\u70ba\u5fc5\u9808\u7684\u53c3\u6578<ul> <li>\u9810\u8a2d = true</li> </ul> </li> <li>defaultValue \u8a2d\u5b9a: \u7576\u524d\u7aef\u767c\u51fa\u7684 request \u672a\u586b\u5165\u53c3\u6578\u503c\u7684\u60c5\u6cc1\u6642\uff0c\u63d0\u4f9b\u9810\u8a2d\u503c<ul> <li>\u53ef\u60f3\u50cf\u6210 required=false \u7684\u52a0\u5f37\u7248\uff0c\u4f86\u907f\u514d\u524d\u7aef\u767c\u8d77 request \u672a\u586b\u5165\u53c3\u6578\u503c\u6642\uff0c\u53c3\u6578\u503c\u70ba null \u7684\u60c5\u6cc1</li> </ul> </li> </ul> Java<pre><code>// @RequestParam \u8a3b\u89e3\u7684\u7528\u6cd5\n@RequestController\npublic class MyController {\n    @RequestMapping(\"/test1\")\n    public String test1(@RequestParam Integer id,\n                        @RequestParam String name) {\n        System.out.println(\"id: \" + id);\n        System.out.println(\"name: \" + name);\n        return \"Hello test1\";\n    }\n}\n</code></pre> Java<pre><code>// @RequestParam \u8a3b\u89e3\u7684 name, required, defaultValue \u8a2d\u5b9a\n@RestController\npublic class MyController {\n    @RequestMapping(\"/test1\")\n    public String test1(@RequestParam(required = false) Integer id,\n                        @RequestParam(name = \"testName\", defaultValue = \"Hans\") String name) {\n        System.out.println(\"id: \" + id);\n        System.out.println(\"name: \" + name);\n        return \"Hello test1\";\n    }\n}\n</code></pre> </li> <li> <p>@RequestBody \u8a3b\u89e3: \u53d6\u5f97 request body \u7684\u53c3\u6578 (\u5c07 JSON \u683c\u5f0f\u7684\u53c3\u6578\u8f49\u63db\u70ba Java object)</p> <ul> <li>\u5f8c\u7aef: \u5148\u5efa\u7acb\u4e00\u500b\u8207 JSON \u683c\u5f0f\u7684\u53c3\u6578\uff0c\u76f8\u5c0d\u61c9\u7684 Java class\u3002\u63a5\u8457\uff0c\u5728 API method \u53c3\u6578\u524d\u9762\u52a0\u4e0a @RequestBody \u8a3b\u89e3</li> <li>Spring Boot \u53ea\u6703\u8f49\u63db\u5f8c\u7aef Java class \u6709\u5ba3\u544a\u7684\u5c6c\u6027\u3002\u82e5\u524d\u7aef\u591a\u5e36\u4e00\u500b key\uff0c\u6703\u88ab\u5f8c\u7aef\u5ffd\u7565; \u53cd\u4e4b\uff0c\u82e5\u524d\u7aef\u5c11\u5e36\u4e00\u500b key\uff0c\u5247\u6703\u5c07\u5176\u6240\u5c0d\u61c9\u7684 object \u5c6c\u6027\u503c\u8a2d\u5b9a\u70ba null</li> </ul> Java<pre><code>@RequestMapping(\"/test2\")\npublic String test2(@RequestBody Student student) {\n    System.out.println(\"student id: \" + student.getId());\n    System.out.println(\"student name: \" + student.getName());\n    return \"Hello test2\";\n}\n</code></pre> </li> <li> <p>@RequestHeader \u8a3b\u89e3: \u53d6\u5f97 requestHeader \u7684\u53c3\u6578</p> <ul> <li>\u5e38\u898b\u7684 request header</li> </ul> Request Header \u610f\u7fa9 \u5e38\u898b\u7684\u503c Content-Type \u8868\u793a request body \u7684\u683c\u5f0f application/json (JSON \u683c\u5f0f\uff0c\u6700\u5e38\u898b)application/octet-stream (\u7528\u65bc\u4e0a\u50b3\u6587\u4ef6)multipart/form-data (\u7528\u65bc\u4e0a\u50b3\u5716\u7247) Authorization \u7528\u65bc\u8eab\u4efd\u9a57\u8b49 <ul> <li> <p>name \u6216 value \u8a2d\u5b9a: \u6307\u5b9a requestHeader \u53c3\u6578\u7684\u540d\u5b57 (\u524d\u7aef\u767c\u51fa request \u6642\u5c31\u5fc5\u9808\u4f7f\u7528\u8a72 requestHeader \u53c3\u6578\u540d\u7a31\u4f86\u8ce6\u503c)</p> <ul> <li>\u883b\u5e38\u4f7f\u7528\uff0c\u56e0\u70ba Java \u7684\u8b8a\u6578\u540d\u7a31\u4e0d\u652f\u63f4<code>-</code> (e.g. Content-Type, User-Agent)</li> </ul> </li> <li> <p>required \u8a2d\u5b9a: \u8868\u793a\u662f\u5426\u70ba\u5fc5\u9808\u7684\u53c3\u6578</p> <ul> <li>\u9810\u8a2d = true</li> </ul> </li> <li> <p>defaultValue \u8a2d\u5b9a: \u7576\u524d\u7aef\u767c\u51fa\u7684 request \u672a\u586b\u5165\u53c3\u6578\u503c\u7684\u60c5\u6cc1\u6642\uff0c\u63d0\u4f9b\u9810\u8a2d\u503c</p> <ul> <li>\u53ef\u60f3\u50cf\u6210 required=false \u7684\u52a0\u5f37\u7248\uff0c\u4f86\u907f\u514d\u524d\u7aef\u767c\u8d77 request \u672a\u586b\u5165\u53c3\u6578\u503c\u6642\uff0c\u53c3\u6578\u503c\u70ba null \u7684\u60c5\u6cc1</li> </ul> </li> </ul> Java<pre><code>@RequestMapping(\"/test3\")\npublic String test3(@RequestHeader String info,\n                    @RequestHeader(name = \"User-Agent\") String userAgent) {\n    System.out.println(\"header info: \" + info);\n    System.out.println(\"user agent: \" + userAgent);\n    return \"Hello test3\";\n}\n</code></pre> </li> <li> <p>@PathVariable \u8a3b\u89e3: \u53d6\u5f97 url \u8def\u5f91\u7684\u503c</p> <ul> <li> <p>name \u8a2d\u5b9a: \u6307\u5b9a url \u7684\u53c3\u6578\u7684\u540d\u5b57 (\u524d\u7aef\u767c\u51fa request \u6642\u5c31\u5fc5\u9808\u4f7f\u7528\u8a72 url \u53c3\u6578\u540d\u7a31\u4f86\u8ce6\u503c)</p> <ul> <li>\u8f03\u5c11\u4f7f\u7528</li> </ul> </li> <li> <p>required \u8a2d\u5b9a: \u8868\u793a\u662f\u5426\u70ba\u5fc5\u9808\u7684\u53c3\u6578</p> <ul> <li>\u9810\u8a2d = true</li> </ul> </li> <li> <p>defaultValue \u8a2d\u5b9a: \u7576\u524d\u7aef\u767c\u51fa\u7684 request \u672a\u586b\u5165\u53c3\u6578\u503c\u7684\u60c5\u6cc1\u6642\uff0c\u63d0\u4f9b\u9810\u8a2d\u503c</p> <ul> <li>\u53ef\u60f3\u50cf\u6210 required=false \u7684\u52a0\u5f37\u7248\uff0c\u4f86\u907f\u514d\u524d\u7aef\u767c\u8d77 request \u672a\u586b\u5165\u53c3\u6578\u503c\u6642\uff0c\u53c3\u6578\u503c\u70ba null \u7684\u60c5\u6cc1</li> </ul> </li> </ul> Java<pre><code>@RequestMapping(\"/test4/{id}/{name}\")\npublic String test4(@PathVariable Integer id,\n                    @PathVariable String name) {\n    System.out.println(\"path id: \" + id);\n    System.out.println(\"path name: \" + name);\n    return \"Hello test4\";\n}\n</code></pre> </li> </ul>"},{"location":"backend/framework/spring_boot/#restful-api","title":"Restful API \u98a8\u683c","text":"<p>REST \u98a8\u683c\u53ea\u662f\u4e00\u7a2e\u7d04\u5b9a\u4fd7\u6210\u7684\u7fd2\u6163\uff0c\u4e26\u4e0d\u662f\u6a19\u6e96\u898f\u7bc4\u3002\u70ba\u4e86\u7c21\u5316\u6e9d\u901a\u6210\u672c</p> <ul> <li> <p>\u4f7f\u7528 HTTP method \u8868\u793a\u52d5\u4f5c</p> HTTP method \u5c0d\u61c9\u7684\u8cc7\u6599\u5eab\u64cd\u4f5c POST Create (\u65b0\u589e) GET Read (\u67e5\u8a62) PUT Update (\u66f4\u65b0) DELETE Delete (\u522a\u9664) <ul> <li>GET, DELETE method \u90fd\u53ea\u80fd\u900f\u904e url \u53c3\u6578 \u50b3\u905e\u8cc7\u8a0a</li> <li>POST, PUT method \u53ef\u4f7f\u7528 request body \u50b3\u905e\u8cc7\u8a0a</li> </ul> </li> <li> <p>\u4f7f\u7528 url \u8def\u5f91\uff0c\u63cf\u8ff0 \u8cc7\u6e90\u4e4b\u9593\u7684\u968e\u5c64\u95dc\u4fc2</p> <ul> <li>e.g. <code>GET /users/123</code> (\u53d6\u5f97 user id \u70ba 123 \u7684 user)</li> </ul> </li> <li> <p>response body \u8fd4\u56de JSON \u6216 XML \u683c\u5f0f\u7684\u8cc7\u6599</p> <ul> <li>Spring Boot: \u5728 class \u4e0a\u9762\u52a0\u4e0a @RestController \u8a3b\u89e3</li> </ul> </li> <li> <p>POST method</p> <ul> <li> <p>\u6cd5 1: \u4f7f\u7528 @PostMapping \u8a3b\u89e3</p> <ul> <li>\u8f03\u5e38\u4f7f\u7528</li> </ul> </li> </ul> Java<pre><code>// \u6cd5 1: \u4f7f\u7528 @PostMapping \u8a3b\u89e3\n@RestController\npublic class StudentController {\n    @PostMapping(\"/students\")\n    public String create(@RequestBody Student student) {\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Create \u64cd\u4f5c\";\n    }\n}\n</code></pre> </li> <li> <p>\u6cd5 2: \u4f7f\u7528 @RequestMapping \u8a3b\u89e3\uff0c\u4e26\u6307\u5b9a value, method</p> Java<pre><code>// \u6cd5 2: \u4f7f\u7528 @RequestMapping \u8a3b\u89e3\uff0c\u4e26\u6307\u5b9a value, method\n@RestController\npublic class StudentController {\n    @RequestMapping(value = \"/students\", method = RequestMethod.POST)\n    public String create(@RequestBody Student student) {\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Create \u64cd\u4f5c\";\n    }\n}\n</code></pre> </li> <li> <p>GET method</p> </li> <li> <p>PUT method</p> </li> <li> <p>DELETE method</p> </li> </ul> Java<pre><code>// CRUD APIs \u7d9c\u5408\u7bc4\u4f8b\n@RestController\npublic class StudentController {\n    @PostMapping(\"/students\")\n    public String create(@RequestBody Student student) {\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Create \u64cd\u4f5c\";\n    }\n\n    @GetMapping(\"/students/{studentId}\")\n    public String read(@PathVariable Integer studentId) {\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Read \u64cd\u4f5c\";\n    }\n\n    @PutMapping(\"/students/{studentId}\")\n    public String update(@PathVariable Integer studentId, @RequestBody Student student) {\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Update \u64cd\u4f5c\";\n    }\n\n    @DeleteMapping(\"/students/{studentId}\")\n    public String delete(@PathVariable Integer studentId) {\n        return  \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Delete \u64cd\u4f5c\";\n    }\n}\n</code></pre>"},{"location":"backend/framework/spring_boot/#_3","title":"\u9a57\u8b49\u8acb\u6c42\u53c3\u6578","text":"<ul> <li> <p>\u53ef\u4ee5\u7528 Java \u7684 if \u5224\u65b7\u5f0f\u4f86\u8655\u7406 -&gt; \u8f03\u5197\u9577\uff0c\u82e5\u53c3\u6578\u5f88\u591a\uff0c\u6703\u5f88\u9ebb\u7169</p> </li> <li> <p>\u63a1\u7528 Spring Boot \u8a3b\u89e3\u4f86\u8655\u7406</p> <ul> <li> <p>Spring Boot v2.3.x \uff5e \u9700\u8981\u5148\u505a\u984d\u5916\u8a2d\u5b9a</p> XML<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> </li> </ul> </li> <li> <p>\u9a57\u8b49\u8acb\u6c42\u53c3\u6578\u7684\u8a3b\u89e3 (\u50c5\u5217\u51fa\u90e8\u5206\u5e38\u7528\u7684)</p> <ul> <li>@Valid \u8a3b\u89e3: \u6a19\u793a \u6307\u5b9a\u7684\u8b8a\u6578\u9700\u88ab\u9a57\u8b49<ul> <li>\u5fc5\u9808\u5728 @RequestBody \u53c3\u6578\u524d\u9762</li> </ul> </li> <li>@Validated \u8a3b\u89e3: \u6574\u500b @RestController class \u90fd\u6703\u751f\u6548<ul> <li>\u53ef\u4ee5\u653e\u5728 @RestController class \u4e0a\uff0c\u4f7f class \u4e2d\u7684\u6240\u6709\u53c3\u6578 \u90fd\u80fd\u88ab\u9a57\u8b49</li> <li>\u9069\u7528\u65bc @RequestParam, @RequestHeader, @PathVariable \u7b49\u8a3b\u89e3</li> </ul> </li> </ul> <p>@RequestBody: \u5728 \u53c3\u6578\u524d\u9762 \u52a0\u4e0a @Valid</p> <p>\u5176\u9918\u4e09\u500b: \u5728 Class \u4e0a\u9762 \u52a0\u4e0a @Validated</p> <ul> <li>@NotNull \u8a3b\u89e3: \u4e0d\u80fd\u70ba null</li> <li>@NotBlank: \u4e0d\u80fd\u70ba null\u3001\u4e14\u4e0d\u80fd\u70ba\u7a7a\u767d\u7684\u5b57\u4e32\uff0c\u7528\u5728\u9a57\u8b49 String \u985e\u578b\u7684\u53c3\u6578 \u4e0a</li> <li>@NotEmpty: \u4e0d\u80fd\u70ba null\u3001\u4e14 size \u5fc5\u9808 &gt; 0\uff0c\u7528\u5728\u9a57\u8b49 \u96c6\u5408\u985e\u578b (List\u3001Set\u3001Map) \u7684\u53c3\u6578 \u4e0a</li> <li>@Min (value): \u503c\u5fc5\u9808 &gt;= value\uff0c\u7528\u5728\u9a57\u8b49\u6578\u5b57\u985e\u578b\u7684\u53c3\u6578\u4e0a</li> <li>@Max(value): \u503c\u5fc5\u9808 &lt;= value\uff0c\u7528\u5728\u9a57\u8b49\u6578\u5b57\u985e\u578b\u7684\u53c3\u6578\u4e0a</li> </ul> Java<pre><code>// Student.java\npublic class Student {\n    @NotNull\n    @Min(100)\n    @Max(200)\n    Integer id;\n\n    @NotBlank\n    String name;\n\n    @NotEmpty\n    List&lt;String&gt; courseList;\n\n    // \u7701\u7565 getter(), setter()\n}\n</code></pre> Java<pre><code>// StudentController.java\n// \u6cd5 1: \u4f7f\u7528 @Valid \u8a3b\u89e3\uff0c\u6a19\u793a\u6307\u5b9a\u7684\u8b8a\u6578\u9700\u88ab\u9a57\u8b49\n@RestController\npublic class StudentController {\n    @PostMapping(\"/students\")\n    public String create(@RequestBody @Valid Student student) {\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Create \u64cd\u4f5c\";\n}\n</code></pre> Java<pre><code>// StudentController.java\n// \u6cd5 2: \u4f7f\u7528 @Validated \u8a3b\u89e3\uff0c\u5c31\u53ef\u4ee5\u628a\u9a57\u8b49\u8acb\u6c42\u8a3b\u89e3\uff0c\u76f4\u63a5\u52a0\u5230 API method \u7684\u53c3\u6578\u524d\u9762\u4f7f\u7528\n@RestController\n@Validated\npublic class StudentController {\n    // \u9a57\u8b49\u8acb\u6c42\u53c3\u6578\u4e5f\u53ef\u4ee5\u76f4\u63a5\u52a0\u5728 API method \u7684\u53c3\u6578\u524d\u9762\n    @GetMapping(\"/students/{studentId}\")\n    public String read(@PathVariable @Min(100) Integer studentId) {\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Read \u64cd\u4f5c\";\n    }\n}\n</code></pre> </li> </ul>"},{"location":"backend/framework/spring_boot/#http","title":"HTTP \u72c0\u614b\u78bc","text":"<ul> <li>\u7528\u4f86\u8868\u793a\u9019\u6b21 http \u8acb\u6c42\u7684\u7d50\u679c\u70ba\u4f55</li> <li> <p>\u53ef\u4ee5\u6839\u64da \u9996\u4f4d\u6578\u5b57 \u5206\u70ba\u4e94\u5927\u985e</p> <ul> <li>1xx: \u8cc7\u8a0a</li> <li>2xx: \u6210\u529f<ul> <li>200 OK: \u8acb\u6c42\u6210\u529f</li> <li>201 Created: \u8acb\u6c42\u6210\u529f\u4e14\u65b0\u7684\u8cc7\u6e90\u88ab\u5efa\u7acb\uff0c\u901a\u5e38\u7528\u5728 POST \u7684 response</li> <li>202 Accepted: \u8acb\u6c42\u5df2\u7d93\u63a5\u53d7\uff0c\u4f46\u5c1a\u672a\u8655\u7406\u5b8c\u6210</li> </ul> </li> <li>3xx: \u91cd\u65b0\u5c0e\u5411<ul> <li>301 Move Permanently: \u6c38\u4e45\u6027 \u91cd\u65b0\u5c0e\u5411\uff0c\u65b0\u7684 url \u6703\u653e\u5728 response header \u7684 <code>Location</code> \u4e2d\u8fd4\u56de\u3002\u901a\u5e38\u6703\u7528\u5728\u7db2\u9801\u642c\u5bb6\u7684\u60c5\u6cc1</li> <li>302 Found: \u81e8\u6642 \u91cd\u65b0\u5c0e\u5411\uff0c\u65b0\u7684 url \u6703\u653e\u5728 response header \u7684 <code>Location</code> \u4e2d\u8fd4\u56de\u3002\u901a\u5e38\u6703\u7528\u5728\u7db2\u9801\u642c\u5bb6\u7684\u60c5\u6cc1</li> </ul> </li> <li>4xx: \u524d\u7aef\u8acb\u6c42\u932f\u8aa4<ul> <li>400 Bad Request: \u524d\u7aef\u7684\u8acb\u6c42\u53c3\u6578\u6709\u8aa4 (e.g. \u524d\u7aef\u50b3\u7d66\u5f8c\u7aef\u7684\u53c3\u6578\u540d\u7a31\u4e0d\u540c\u3001\u8acb\u6c42\u7684\u683c\u5f0f\u6709\u554f\u984c)</li> <li>401 Unauthorized: \u672a\u901a\u904e\u8eab\u4efd\u9a57\u8b49 (e.g. \u6703\u54e1\u5e33\u5bc6\u8f38\u5165\u932f\u8aa4)</li> <li>403 Forbidden: \u8acb\u6c42\u88ab\u5f8c\u7aef\u62d2\u7d55\uff0c\u901a\u5e38\u662f \u6b0a\u9650\u4e0d\u8db3\u5c0e\u81f4 (e.g. \u666e\u901a\u6703\u54e1\u537b\u60f3\u770b VIP \u6703\u54e1\u7684\u5167\u5bb9)</li> <li>404 Not Found: \u7db2\u9801\u4e0d\u5b58\u5728\uff0c\u53ef\u80fd\u662f\u8cc7\u6e90\u88ab\u79fb\u8d70\uff0c\u6216 url \u8f38\u5165\u932f\u8aa4</li> </ul> </li> <li>5xx: \u5f8c\u7aef\u8655\u7406\u6709\u554f\u984c<ul> <li>500 Internal Server Error: \u5f8c\u7aef\u5728\u57f7\u884c\u7a0b\u5f0f\u6642\u767c\u751f\u932f\u8aa4\uff0c\u53ef\u80fd\u662f\u7a0b\u5f0f\u5167\u6709 bug \u5c0e\u81f4\u7684</li> <li>503 Service Unavailable: \u7531\u65bc\u81e8\u6642\u7dad\u8b77 or \u6d41\u91cf\u592a\u5927\uff0c\u5f8c\u7aef\u76ee\u524d\u7121\u6cd5\u8655\u7406\u8acb\u6c42</li> <li>504 Gateway Timeout: \u8acb\u6c42\u8d85\u6642\uff0c\u88ab\u5f37\u5236\u7d50\u675f</li> </ul> </li> </ul> </li> <li> <p>ResponseEntity: \u53ef\u81ea\u5b9a\u7fa9\u56de\u50b3\u7684 response \u7269\u4ef6\u7684\u7d30\u7bc0\uff0c\u4f8b\u5982: http header, status code, body ...\u7b49</p> <ul> <li>\u7528\u6cd5: \u4f5c\u70ba method \u7684\u8fd4\u56de\u578b\u5225</li> <li><code>ResponseEntity.body</code> \u7684\u578b\u5225\u5fc5\u9808\u9075\u5b88 ResponseEntity&lt;&gt; \u6cdb\u578b\u7684\u578b\u5225\u898f\u7bc4</li> </ul> Java<pre><code>@RestController\npublic class MyController {\n    @RequestMapping(\"/test\")\n    public ResponseEntity&lt;String&gt; test() {\n        return ResponseEntity.status(HttpStatus.ACCEPTED).body(\"Hello World\");\n    }\n}\n</code></pre> </li> <li> <p>Java \u7684 Error &amp; Exception \u7e7c\u627f\u95dc\u4fc2\u5716</p> <p> \u5716\u7247\u4f86\u6e90</p> <ul> <li>Error: \u7cfb\u7d71\u932f\u8aa4\uff0c\u4e0d\u9700\u8655\u7406</li> <li>Exception: \u7a0b\u5f0f\u6709\u932f\u8aa4\uff0c\u9700\u8981\u8655\u7406</li> </ul> </li> <li> <p>@ControllerAdvice \u8a3b\u89e3: \u52a0\u5728 class \u4e0a\uff0c\u6703\u5c07\u8a72 class \u8b8a\u6210 bean\uff0c\u4e26\u4e14\u53ef\u5728\u5167\u90e8\u4f7f\u7528 @ExceptionHandler \u8a3b\u89e3</p> <ul> <li>\u512a\u9ede: \u7d71\u4e00\u7ba1\u7406 Exception\uff0c\u4e0d\u7528\u4e00\u500b\u4e00\u500b\u5beb <code>try ... catch ...</code></li> <li>\u5e95\u5c64\u7531 Spring AOP \u6240\u5be6\u4f5c</li> </ul> </li> <li> <p>@ExceptionHandler \u8a3b\u89e3: \u52a0\u5728 method \u4e0a\uff0c\u53bb catch \u65b9\u6cd5\u6240\u5674\u51fa\u7684 Exception</p> <ul> <li>Spring Boot \u6703\u6839\u64da Exception \u7684\u7e7c\u627f\u95dc\u4fc2\uff0c\u5f80\u4e0a\u627e\u5230\u76f8\u5c0d\u61c9\u7684 @ExceptionHandler \u4f86\u8655\u7406</li> </ul> </li> </ul> Java<pre><code>// MyExceptionHandler.java\n@ControllerAdvice\npublic class MyExceptionHandler {\n    // \u8a18\u5f97\u52a0\u4e0a .class\n    @ExceptionHandler(RuntimeException.class)\n    public ResponseEntity&lt;String&gt; handle(RuntimeException exception) {\n        return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE)\n                .body(\"Runtime Exception: \" + exception.getMessage());\n    }\n\n    // \u8a18\u5f97\u52a0\u4e0a .class\n    @ExceptionHandler(IllegalArgumentException.class)\n    public ResponseEntity&lt;String&gt; handle(IllegalArgumentException exception) {\n        return ResponseEntity.status(HttpStatus.BAD_REQUEST)\n                .body(\"IllegalArgumentException: \" + exception.getMessage());\n    }\n}\n</code></pre> Java<pre><code>// MyController.java\n@RestController\npublic class MyController {\n    @RequestMapping(\"/test1\")\n    public String test1() {\n        throw new RuntimeException(\"test1 error\");\n    }\n\n    @RequestMapping(\"/test2\")\n    public String test2() {\n        throw new IllegalArgumentException(\"test2 error\");\n    }\n}\n</code></pre>"},{"location":"backend/framework/spring_boot/#interceptor","title":"\u6514\u622a\u5668 (Interceptor)","text":"<ul> <li> <p>\u5224\u65b7 http request \u662f\u5426\u6709\u554f\u984c</p> <ul> <li>\u82e5\u6c92\u6709\u554f\u984c\u5c31\u53bb\u57f7\u884c\u8a72 url \u8def\u5f91\u6240\u5c0d\u61c9\u7684 API method</li> <li>\u53cd\u4e4b\uff0c\u82e5\u6709\u554f\u984c\uff0c\u5c31\u56de\u50b3\u932f\u8aa4\u8a0a\u606f\u7d66\u524d\u7aef (\u4e0d\u6703\u9001\u9054 controller)</li> </ul> </li> <li> <p>\u5efa\u7acb\u6514\u622a\u5668</p> <ul> <li>step 1: \u52a0\u4e0a @Component \u8a3b\u89e3\uff0c\u8b93\u8a72 class \u6210\u70ba\u4e00\u500b bean</li> <li>step2: \u5be6\u4f5c HandlerInterceptor \u4ecb\u9762<ul> <li>\u5176\u4e2d <code>preHandle()</code> \u65b9\u6cd5\u6700\u91cd\u8981</li> </ul> </li> </ul> Java<pre><code>// MyInterceptor.java\n@Component\npublic class MyInterceptor implements HandlerInterceptor {\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        System.out.println(\"\u57f7\u884c MyInterceptor \u7684 preHandle() \u65b9\u6cd5\");\n        response.setStatus(401);\n        return false;  // \u7531\u8fd4\u56de\u503c true \u6216 false \u6c7a\u5b9a\u6514\u622a\u5668\u7684\u884c\u70ba\n    }\n}\n</code></pre> Java<pre><code>// MyConfig.java\n// \u7b97\u662f\u56fa\u5b9a\u5beb\u6cd5\uff0c\u8981\u7528\u6642\u518d\u4f86\u770b\u5c31\u597d\uff0c\u4e0d\u7528\u80cc\n@Configuration\npublic class MyConfig implements WebMvcConfigurer {\n    @Autowired\n    private MyInterceptor myInterceptor;\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(myInterceptor).addPathPatterns(\"/**\");\n    }\n}\n</code></pre> </li> </ul>"},{"location":"backend/framework/spring_boot/#spring-jdbc","title":"Spring JDBC","text":"<ul> <li>\u5728 Spring Boot \u4e2d\u57f7\u884c\u539f\u59cb SQL \u8a9e\u6cd5\uff0c\u53bb\u64cd\u4f5c\u8cc7\u6599\u5eab</li> </ul> Spring JDBC Spring Data JPA \u4ee5 SQL \u70ba\u4e2d\u5fc3 \u4ee5 Java object \u70ba\u4e2d\u5fc3 \u9700\u8981\u81ea\u5df1\u5beb SQL \u8a9e\u6cd5 \u4e0d\u9700\u5beb SQL \u8a9e\u6cd5\uff0cHibernate \u6703\u81ea\u52d5\u751f\u6210 SQL \u8a9e\u6cd5\uff0c\u53bb\u64cd\u4f5c\u8cc7\u6599\u5eab \u958b\u767c\u6548\u7387\u4f4e \u958b\u767c\u6548\u7387\u9ad8 \u57f7\u884c\u6548\u80fd\u8f03\u597d \u57f7\u884c\u6548\u80fd\u8f03\u5dee \u53ef\u5beb\u51fa\u8907\u96dc SQL \u8a9e\u6cd5 \u8f03\u96e3 \u5beb\u51fa\u8907\u96dc SQL \u8a9e\u6cd5"},{"location":"backend/framework/spring_boot/#intellij-gui","title":"IntelliJ \u7684\u8cc7\u6599\u5eab GUI","text":"<ul> <li>\u9ede\u9078 IntelliJ \u7684 Database \u5716\u793a -&gt; <code>+</code> -&gt; Data Source -&gt; MySQL</li> <li>\u8a2d\u5b9a\u9023\u7dda\u8cc7\u8a0a\u5f8c\uff0c\u53ef\u4ee5 test connection \u5f8c\uff0c\u518d\u6309 OK</li> <li>console \u756b\u9762\u53ef\u4ee5\u76f4\u63a5\u8f38\u5165 SQL \u8a9e\u6cd5\uff0c\u4e26\u57f7\u884c: \u64ad\u653e\u6309\u9215 or <code>command + enter</code></li> <li>\u53ef\u4ee5\u6aa2\u8996 table \u7684\u8cc7\u6599: \u6309\u6ed1\u9f20\u5de6\u9375\u9ede\u9078 table \u5169\u4e0b<ul> <li>\u6240\u6709\u66f4\u52d5\u8cc7\u6599\u5f8c\uff0c\u90fd\u8981\u8a18\u5f97 submit ()</li> <li>\u5728 submit \u4e4b\u524d\uff0c\u90fd\u53ef\u4ee5\u5fa9\u539f\u66f4\u52d5: \u91cd\u65b0\u6574\u7406 ()</li> </ul> </li> <li> <p>\u82e5\u9047\u5230\u6bcf\u7b46\u8cc7\u6599\u7684\u6b04\u4f4d\u904e\u591a\uff0c\u5728 console \u756b\u9762\u8981\u4f86\u56de\u79fb\u52d5\u6642: \u53ef\u4ee5\u9ede\u9078\u53f3\u4e0a\u89d2\u7684 <code>View as</code> \u6309\u9215\uff0c\u9078\u64c7 transpose (\u884c\u3001\u5217\u8f49\u7f6e)\u986f\u793a</p> </li> <li> <p>\u8907\u7fd2 MySQL \u8a9e\u6cd5 SQL<pre><code># \u5efa\u7acb\u8cc7\u6599\u5eab\nCREATE DATABASE myjdbc;\n\n# \u5efa\u7acb\u8cc7\u6599\u8868\nCREATE TABLE student (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(30)\n);\n\n# \u63d2\u5165\u3001\u67e5\u8a62\u3001\u66f4\u65b0\u3001\u522a\u9664\u8cc7\u6599\nINSERT INTO student(id, name) VALUE (1, 'Judy');\nSELECT * FROM student;\nUPDATE student SET name = 'Amy' WHERE id = 1;\nDELETE FROM student WHERE id = 1;\n</code></pre></p> </li> </ul>"},{"location":"backend/framework/spring_boot/#spring-jdbc_1","title":"\u4f7f\u7528 Spring JDBC","text":"<ul> <li>\u8a2d\u5b9a\u5957\u4ef6\u7ba1\u7406\u7684\u8a2d\u5b9a\u6a94 (<code>pom.xml</code>)<ul> <li>\u4f7f\u7528 Spring Boot \u7684 JDBC \u529f\u80fd</li> <li>\u4f7f\u7528 MySQL \u7684 JDBC driver (\u5b98\u7db2\u9023\u7d50: MySQL Connector Java) XML<pre><code>&lt;!-- \u4f7f\u7528 Spring Boot \u7684 JDBC \u529f\u80fd --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;!-- \u4f7f\u7528 MySQL \u7684 JDBC driver --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n    &lt;version&gt;8.0.33&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></li> </ul> </li> <li>\u8a2d\u5b9a Spring JDBC \u7684\u9023\u7dda\u8cc7\u8a0a (<code>application.properties</code>)<ul> <li>Spring JDBC \u6703\u5728 Spring container \u5efa\u7acb\u4e00\u500b NamedParameterJdbcTemplate \u7684 bean</li> <li>\u4ee5\u4e0b\u7684 Spring JDBC \u9023\u7dda\u8a2d\u5b9a\u4e0d\u7528\u7279\u5225\u80cc\uff0c\u8981\u7528\u6642\u518d\u4f86\u770b\u5c31\u597d Properties<pre><code># \u9078\u65b0\u7248 (\u6709 cj \u7684\u90a3\u500b)\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n# \u8cc7\u6599\u5eab\u540d\u7a31: myjdbc (\u5927\u5c0f\u5beb\u654f\u611f\u7684)\nspring.datasource.url=jdbc:mysql://localhost:3306/myjdbc?serverTimezone=Asia/Taipei&amp;characterEncoding=utf-8\nspring.datasource.username=root\nspring.datasource.password=\n</code></pre></li> </ul> </li> <li>NamedParameterJdbcTemplate bean<ul> <li> <p>\u5728 Spring JDBC \u4e2d\uff0c\u6703\u6839\u64da sql \u7684\u8a9e\u6cd5\u53bb\u5340\u5206\u6210\u5169\u5927\u985e\uff0c\u5206\u5225\u662f update \u7cfb\u5217\u3001 query \u7cfb\u5217      \u5716\u7247\u51fa\u8655</p> <ul> <li>update \u7cfb\u5217\u7684\u65b9\u6cd5: \u6539\u8b8a\u8cc7\u6599\u5eab\u4e2d\u5132\u5b58\u7684\u6578\u64da<ul> <li>\u57f7\u884c INSERT\u3001UPDATE\u3001DELETE \u9019\u4e09\u7a2e sql \u8a9e\u6cd5  \u5716\u7247\u51fa\u8655</li> <li><code>update()</code> \u9032\u968e\u7528\u6cd5<ul> <li>\u53d6\u5f97 DB table \u4e2d\uff0c\u6703\u81ea\u52d5\u589e\u52a0(<code>AUTO_INCREMENT</code>)\u7684\u6b04\u4f4d\u503c (e.g. <code>id</code>): \u4f7f\u7528 <code>KeyHolder</code></li> <li>\u6279\u6b21\u57f7\u884c INSERT, UPDATE, DELETE \u7684 SQL \u8a9e\u6cd5: \u4f7f\u7528 <code>batchUpdate()</code> method</li> </ul> </li> </ul> </li> </ul> Java<pre><code>@RestController\npublic class StudentController {\n    @Autowired\n    private NamedParameterJdbcTemplate namedParameterJdbcTemplate;\n\n    @PostMapping(\"/students\")\n    public String insert(@RequestBody Student student) {\n        // `:` \u8868\u793a\u52d5\u614b\u8b8a\u6578\n        String sql = \"INSERT INTO student(name) VALUE (:studentName)\";\n        // \u5728 Spring JDBC \u4e2d\uff0cMap \u901a\u5e38\u6703\u9019\u6a23\u5ba3\u544a\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"studentName\", student.getName());\n\n        // \u53d6\u5f97\u7576\u524d AUTO_INCREMENT \u7684 id \u503c\n        KeyHolder keyHolder = new GeneratedKeyHolder();\n        // \u6bcf\u6b21\u57f7\u884c\u90fd\u6703 call DB\uff0c\u56e0\u6b64\u82e5\u9047\u5230\u6279\u6b21\u8655\u7406\u6642\uff0c\u6548\u80fd\u8f03\u5dee\n        namedParameterJdbcTemplate.update(sql, new MapSqlParameterSource(map), keyHolder);\n        // \u56e0\u70ba schema \u5ba3\u544a id \u70ba INT \u578b\u5225\n        int id = keyHolder.getKey().intValue();\n        System.out.println(\"mysql \u81ea\u52d5\u751f\u6210\u7684 id \u70ba: \" + id);\n\n        return \"\u57f7\u884c INSERT sql\";\n    }\n\n    // \u524d\u7aef\u53ef\u4ee5\u5728 JSON array \u4e2d\uff0c\u53ef\u4ee5\u52a0\u5165\u591a\u500b Student object\uff0c\u6279\u6b21\u50b3\u7d66\u5f8c\u7aef\n    @PostMapping(\"/students/batch\")\n    public String insertList(@RequestBody List&lt;Student&gt; studentList) {\n        String sql = \"INSERT INTO student(name) VALUE (:studentName)\";\n        // \u4e0d\u7528\u80cc\uff0c\u8981\u7528\u6642\u518d\u4f86\u770b\u5c31\u597d\n        MapSqlParameterSource[] parameterSources = new MapSqlParameterSource[studentList.size()];\n        for (int i=0; i &lt; studentList.size(); i++) {\n            Student student = studentList.get(i);\n\n            parameterSources[i] = new MapSqlParameterSource();\n            // \u56e0\u70ba :studentName \u8b8a\u6578\n            parameterSources[i].addValue(\"studentName\", student.getName());\n        }\n        // batchUpdate() \u7684\u7b2c\u4e8c\u500b\u53c3\u6578 parameterSources \u5beb\u6cd5\u6703\u8f03\u8907\u96dc\uff0c\u4f46\u662f\u53ea\u6703 call DB \u4e00\u6b21\uff0c\u6545\u6548\u80fd\u8f03\u4f73\n        namedParameterJdbcTemplate.batchUpdate(sql, parameterSources);\n        return \"\u57f7\u884c\u4e00\u6279 INSERT sql\";\n    }\n\n    @DeleteMapping(\"/students/{studentId}\")\n    public String delete(@PathVariable Integer studentId) {\n        String sql = \"DELETE FROM student WHERE id = :studentId\";\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"studentId\", studentId);\n        namedParameterJdbcTemplate.update(sql, map);\n\n        return \"\u57f7\u884c DELETE sql\";\n    }\n}\n</code></pre> <ul> <li>query \u7cfb\u5217\u7684\u65b9\u6cd5: \u67e5\u8a62 \u8cc7\u6599\u5eab\u4e2d\u7684\u6578\u64da<ul> <li>\u53ea\u80fd\u57f7\u884c SELECT \u9019\u4e00\u7a2e sql \u8a9e\u6cd5<ul> <li><code>query()</code>: \u9069\u7528\u5728\u6240\u6709\u4f7f\u7528 <code>SELECT</code> sql \u67e5\u8a62\u7684\u60c5\u6cc1\uff0c\u56de\u50b3 List&lt;&gt; \u578b\u5225\uff0c\u88e1\u9762\u53ef\u80fd\u5305\u542b 0 ~ n \u7b46\u8cc7\u6599</li> <li><code>queryForObject()</code>: \u50c5\u9069\u7528\u5728 <code>SELECT count(*)</code> sql \u8a9e\u6cd5\uff0c\u56de\u50b3\u4e00\u500b Java object  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li>RowMapper: \u5c07\u6578\u64da\u5f9e\u8cc7\u6599\u5eab\u683c\u5f0f\uff0c\u8f49\u63db\u6210 Java object \u683c\u5f0f<ul> <li>\u6ce8\u610f! <code>mapRow()</code> method \u7684\u8fd4\u56de\u578b\u5225\uff0c\u5fc5\u9808\u8207 RowMapper&lt;&gt; \u6cdb\u578b\u7684\u578b\u5225\u4e00\u81f4</li> <li><code>rs</code> \u53c3\u6578: \u5305\u542b\u7684 column\uff0c\u5373\u70ba SQL select \u51fa\u4f86\u7684\u90a3\u4e9b\u6b04\u4f4d</li> </ul> </li> <li>ResultSetExtractor class: \u80fd\u540c\u6642\u64cd\u4f5c\u591a\u500b row \u7684\u8cc7\u6599<ul> <li>\u7528\u6cd5: <code>namedParameterJdbcTemplate.query(sql, new ResultSetExtractor&lt;&gt;() { ... })</code></li> <li>\u7528\u6cd5: <code>namedParameterJdbcTemplate.query(sql, new ResultSetExtractor&lt;&gt;() { ... })</code></li> </ul> </li> <li> <p>DB schema type \u5c0d\u7167 Java object type</p> <ul> <li>\u82e5 SQL \u6b04\u4f4d\u6709\u4f7f\u7528 <code>AS</code> \u5225\u540d\uff0c\u5728 RowMapper \u4e2d\u8981\u4f7f\u7528\u65b0\u7684\u6b04\u4f4d\u5225\u540d<ul> <li>e.g. SQL: <code>SELECT id AS student_id FROM student;</code></li> <li>e.g. RowMapper: <code>rs.getInt(\"student_id\")</code></li> </ul> </li> </ul> DB schema type Java object type RowMapper method INT Integer rs.getInt(\"id\") VARCHAR String rs.getString(\"name\") BIGINT Long rs.getLong(\"age\") DOUBLE Double rs.getDouble(\"height\") FLOAT Float rs.getFloat(\"weight\") BOOLEAN boolean rs.getBoolean(\"isEducated\") TIMESTAMP Date rs.getTimestamp(\"create_date\") </li> </ul> </li> </ul> Java<pre><code>// StudentRowMapper.java\npublic class StudentRowMapper implements RowMapper&lt;Student&gt; {\n    // rs: \u5f9e\u8cc7\u6599\u5eab\u4e2d\u53d6\u5f97\u7684\u6578\u64da; rowNum: \u53d6\u5230\u7b2c\u5e7e\u7b46\u6578\u64da\n    // (\u8f49\u63db)\u56de\u50b3 Student \u578b\u5225\u7684 Java object\n    @Override\n    public Student mapRow(ResultSet rs, int rowNum) throws SQLException {\n//        // \u5f9e\u8cc7\u6599\u5eab\u4e2d\u53d6\u5f97\u6578\u64da\n//        Integer a = rs.getInt(\"id\");\n//        String b = rs.getString(\"name\");\n//\n//        // \u5c07\u6578\u64da\u8f49\u63db\u70ba Java object\n//        Student student = new Student();\n//        student.setId(a);\n//        student.setName(b);\n\n        // \u5be6\u52d9\u4e0a\u901a\u5e38\u6703\u9019\u6a23\u5beb\n        Student student = new Student();\n        student.setId(rs.getInt(\"id\"));\n        student.setName(rs.getString(\"name\"));\n\n        return student;\n    }\n}\n</code></pre> Java<pre><code>// StudentController.java\n@RestController\npublic class StudentController {\n    @Autowired\n    private NamedParameterJdbcTemplate namedParameterJdbcTemplate;\n\n    // query() \u7684\u7528\u6cd5\n    @GetMapping(\"/students\")\n    public List&lt;Student&gt; select() {\n        // \u9700\u5217\u8209\u6240\u6709\u60f3\u67e5\u8a62\u7684\u6b04\u4f4d\uff0c\u5c11\u7528 `*` \u8868\u793a\uff0c\u56e0\u70ba `*` \u7684\u67e5\u8a62\u6548\u80fd\u8f03\u5dee\n        // \u7f3a\u9ede 1: \u53ef\u80fd\u6703\u56de\u50b3\u4e0d\u5fc5\u8981\u7684\u8cc7\u6599\n        // \u7f3a\u9ede 2: \u8f03\u96e3\u63d0\u5347\u67e5\u8a62\u7684\u901f\u5ea6\n        String sql = \"SELECT id, name FROM student\";\n        // \u5b9a\u7fa9 sql \u7684\u5916\u50b3\u8b8a\u6578\u7528\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        List&lt;Student&gt; list = namedParameterJdbcTemplate.query(sql, map, new StudentRowMapper());\n\n        return list;\n    }\n\n    @GetMapping(\"/students/{studentId}\")\n    public Student select(@PathVariable Integer studentId) {\n        // \u5b9a\u7fa9 sql \u7684\u5916\u50b3\u8b8a\u6578\u7528\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"studentId\", studentId);\n        List&lt;Student&gt; list = namedParameterJdbcTemplate.query(sql, map, new StudentRowMapper());\n\n        if (list.size() &gt; 0) {\n            return list.get(0);\n        } else {\n            return null;\n        }\n    }\n\n    // queryForObject() \u7684\u7528\u6cd5\n    @GetMapping(\"/students/count\")\n    public Integer select() {\n        String countSql = \"SELECT count(*) FROM student\";\n        Map&lt;String, Object&gt; countMap = new HashMap&lt;&gt;();\n        Integer count = namedParameterJdbcTemplate.queryForObject(countSql, countMap, Integer.class);\n\n        return count;\n    }\n}\n</code></pre> </li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#controller-service-dao","title":"Controller-Service-Dao \u4e09\u5c64\u5f0f\u67b6\u69cb","text":"<ul> <li>MVC \u67b6\u69cb\u7b97\u662f\u62bd\u8c61\u6982\u5ff5\uff0c\u5177\u9ad4\u8981\u600e\u9ebc\u5be6\u4f5c\uff0c\u5c31\u6703\u4f9d\u7167\u4e0d\u540c\u7684\u6846\u67b6\uff0c\u800c\u6709\u4e0d\u540c\u5beb\u6cd5</li> <li>\u5728 Spring Boot \u88e1\u9762\uff0c\u6211\u5011\u6703\u5c07 MVC \u7684\u67b6\u69cb\u6a21\u5f0f\uff0c\u53bb\u8f49\u5316\u6210\u662f Controller-Service-Dao \u7684\u4e09\u5c64\u5f0f\u67b6\u69cb \u4f86\u5be6\u4f5c  \u5716\u7247\u51fa\u8655</li> <li>\u547d\u540d\u98a8\u683c: \u901a\u5e38\u6703\u4ee5 Controller, Service, Dao \u505a\u7d50\u5c3e\uff0c\u7528\u4f86\u8868\u793a\u8a72 class \u7684\u529f\u80fd</li> <li>\u5c07 Controller, Service, Dao \u9019\u4e9b class \u8b8a\u6210 bean\uff0c\u4e26\u4f7f\u7528 @Autowired \u4f86\u6ce8\u5165<ul> <li>\u6cd5 2: \u4f7f\u7528 @RestController, @Service, @Repository \u8a3b\u89e3 \u4f86\u8868\u793a\uff0c\u5176\u6548\u679c\u5982\u540c @Component \u8a3b\u89e3\uff0c\u4e5f\u6703\u7522\u751f bean</li> </ul> </li> <li>Controller \u4e0d\u80fd\u76f4\u63a5\u547c\u53eb Dao\uff0c\u5fc5\u9808\u900f\u904e Service \u4f86\u547c\u53eb</li> <li>Dao \u53ea\u80fd\u8ca0\u8cac\u57f7\u884c SQL\uff0c\u4f86\u5b58\u53d6\u8cc7\u6599\u5eab\u5167\u90e8\u7684\u6578\u64da\uff0c\u4e0d\u80fd\u5305\u542b\u5546\u696d\u908f\u8f2f</li> <li> <p>\u901a\u5e38\u6bcf\u500b model \u6703\u5c0d\u61c9\u5230\u4e00\u500b dao\uff0c\u8ca0\u8cac\u8a72 table \u7684 SQL \u64cd\u4f5c</p> </li> <li> <p>\u5be6\u4f5c\u7df4\u7fd2 Markdown<pre><code>demo\n\u251c\u2500\u2500 .idea\n\u251c\u2500\u2500 .mvn\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 main\n\u2502       \u2514\u2500\u2500 java\n\u2502           \u2514\u2500\u2500 com.example.demo\n\u2502               \u251c\u2500\u2500 controller\n\u2502                   \u2514\u2500\u2500 StudentController\n\u2502               \u251c\u2500\u2500 dao\n\u2502                   \u251c\u2500\u2500 StudentDao  &lt;!-- interface --&gt;\n\u2502                   \u2514\u2500\u2500 StudentDaoImpl  &lt;!-- implementation --&gt;\n|               \u251c\u2500\u2500 model\n|                   \u251c\u2500\u2500 Student  &lt;!-- DB table mapping --&gt;\n|               \u251c\u2500\u2500 mapper\n|                   \u2514\u2500\u2500 StudentRowMapper  &lt;!-- RowMapper --&gt;\n\u2502               \u251c\u2500\u2500 service\n\u2502                   \u251c\u2500\u2500 StudentService  &lt;!-- interface --&gt;\n\u2502                   \u2514\u2500\u2500 StudentServiceImpl  &lt;!-- implementation --&gt;\n\u2502               \u251c\u2500\u2500 DemoApplication\n\u2514\u2500\u2500 resources\n</code></pre></p> <ul> <li>\u5be6\u52d9\u4e0a\uff0c\u901a\u5e38\u6703\u5ba3\u544a\u4e09\u500b controller, service, dao \u4e09\u500b package</li> <li>\u4e26\u65bc dao, service \u4e2d\uff0c\u5206\u5225\u5ba3\u544a interface, implementation \u5169\u500b class\u3002\u70ba\u4e86\u8b93 Spring Boot \u505a\u4f9d\u8cf4\u6ce8\u5165 \u6642\uff0c\u80fd\u5920 \u4ee5 interface \u70ba\u6e96\uff0c\u964d\u4f4e class \u4e4b\u9593\u7684\u8026\u5408\u5ea6</li> </ul> </li> </ul> Java<pre><code>// StudentController.java\n@RestController\npublic class StudentController {\n    // \u5c31\u4e0d\u6703\u4f7f\u7528 namedParameterJdbcTemplate \u9019\u500b bean \u4e86\n    @Autowired\n    private StudentService studentService;\n\n    @PostMapping(\"/students\")\n    public String insert(@RequestBody Student student) {\n        studentService.insert(student);\n        return \"\u57f7\u884c INSERT sql\";\n    }\n\n    @PostMapping(\"/students/batch\")\n    public String insertList(@RequestBody List&lt;Student&gt; studentList) {\n        studentService.batchInsert(studentList);\n        return \"\u57f7\u884c\u4e00\u6279 INSERT sql\";\n    }\n\n    @DeleteMapping(\"/students/{studentId}\")\n    public String delete(@PathVariable Integer studentId) {\n        studentService.deleteById(studentId);\n        return \"\u57f7\u884c DELETE sql\";\n    }\n\n    @GetMapping(\"/students/{studentId}\")\n    public Student select(@PathVariable Integer studentId) {\n        return studentService.getById(studentId);\n    }\n}\n</code></pre> Java<pre><code>// StudentService.java\npublic interface StudentService {\n    void insert(Student student);\n    void batchInsert(List&lt;Student&gt; studentList);\n    void deleteById(Integer studentId);\n    Student getById(Integer studentId);\n}\n</code></pre> Java<pre><code>// StudentServiceImpl.java\n@Component\npublic class StudentServiceImpl implements StudentService {\n    @Autowired\n    private StudentDao studentDao;\n\n    @Override\n    public void insert(Student student) {\n        studentDao.insert(student);\n    }\n\n    @Override\n    public void batchInsert(List&lt;Student&gt; studentList) {\n        studentDao.batchInsert(studentList);\n    }\n\n    @Override\n    public void deleteById(Integer studentId) {\n        studentDao.deleteById(studentId);\n    }\n\n    @Override\n    public Student getById(Integer studentId) {\n        return studentDao.getById(studentId);\n    }\n}\n</code></pre> Java<pre><code>// StudentDao.java\npublic interface StudentDao {\n    void insert(Student student);\n    void batchInsert(List&lt;Student&gt; studentList);\n    void deleteById(Integer studentId);\n    Student getById(Integer studentId);\n}\n</code></pre> Java<pre><code>// StudentDaoImpl.java\n@Component\npublic class StudentDaoImpl implements StudentDao{\n    @Autowired\n    private NamedParameterJdbcTemplate namedParameterJdbcTemplate;\n\n    @Override\n    public void insert(Student student) {\n        String sql = \"INSERT INTO student(name) VALUE (:studentName)\";\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"studentName\", student.getName());\n        KeyHolder keyHolder = new GeneratedKeyHolder();\n        namedParameterJdbcTemplate.update(sql, new MapSqlParameterSource(map), keyHolder);\n        int id = keyHolder.getKey().intValue();\n        System.out.println(\"mysql \u81ea\u52d5\u751f\u6210\u7684 id \u70ba: \" + id);\n    }\n\n    @Override\n    public void batchInsert(List&lt;Student&gt; studentList) {\n        String sql = \"INSERT INTO student(name) VALUE (:studentName)\";\n        MapSqlParameterSource[] parameterSources = new MapSqlParameterSource[studentList.size()];\n        for (int i=0; i &lt; studentList.size(); i++) {\n            Student student = studentList.get(i);\n\n            parameterSources[i] = new MapSqlParameterSource();\n            // \u56e0\u70ba :studentName \u8b8a\u6578\n            parameterSources[i].addValue(\"studentName\", student.getName());\n        }\n        // batchUpdate() \u7684\u7b2c\u4e8c\u500b\u53c3\u6578 parameterSources \u5beb\u6cd5\u6703\u8f03\u8907\u96dc\uff0c\u4f46\u662f\u53ea\u6703 call DB \u4e00\u6b21\uff0c\u6545\u6548\u80fd\u8f03\u4f73\n        namedParameterJdbcTemplate.batchUpdate(sql, parameterSources);\n    }\n\n    @Override\n    public void deleteById(Integer studentId) {\n        String sql = \"DELETE FROM student WHERE id = :studentId\";\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"studentId\", studentId);\n        namedParameterJdbcTemplate.update(sql, map);\n    }\n\n    @Override\n    public Student getById(Integer studentId) {\n        String sql = \"SELECT id, name FROM student WHERE id = :studentId\";\n\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"studentId\", studentId);\n        List&lt;Student&gt; list = namedParameterJdbcTemplate.query(sql, map, new StudentRowMapper());\n\n        if (list.size() &gt; 0) {\n            return list.get(0);\n        } else {\n            return null;\n        }\n    }\n}\n</code></pre>"},{"location":"backend/framework/spring_boot/#_4","title":"\u4ea4\u6613\u7ba1\u7406","text":"<ul> <li>@Transactional \u8a3b\u89e3: \u52a0\u5728 class \u6216 method \u4e0a\uff0c\u4f7f\u7528\u4ea4\u6613\u4f86\u7ba1\u7406\u9019\u500b method \u4e2d\u7684\u8cc7\u6599\u5eab\u64cd\u4f5c<ul> <li>\u901a\u5e38\u6703\u52a0\u5728 Service \u5c64\u7684 method \u4e0a\u9762</li> </ul> </li> <li>\u4ea4\u6613\u7ba1\u7406\u7684\u7279\u6027: \u9700\u6eff\u8db3 ACID \u7279\u6027\u7684\u8cc7\u6599\u5eab\uff0c\u624d\u80fd\u5920\u57f7\u884c\u4ea4\u6613\u7ba1\u7406<ul> <li>ACID \u7279\u6027<ul> <li>A: Atomicity (\u539f\u5b50\u6027)<ul> <li>\u4e00\u500b\u4ea4\u6613\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u8981\u9ebc\u5168\u90e8\u6210\u529f\uff0c\u8981\u9ebc\u5168\u90e8\u5931\u6557</li> </ul> </li> <li>C: Consistency (\u4e00\u81f4\u6027)<ul> <li>\u4ea4\u6613\u524d\u5f8c\uff0c\u6578\u64da\u7684\u5b8c\u6574\u6027\u5fc5\u9808\u4fdd\u6301\u4e00\u81f4</li> </ul> </li> <li>I: Isolation (\u9694\u96e2\u6027)<ul> <li>\u4ea4\u6613\u4e4b\u9593\u4e92\u4e0d\u5e72\u64fe</li> </ul> </li> <li>D: Durability (\u6301\u4e45\u6027)<ul> <li>\u4ea4\u6613\u4e00\u65e6\u63d0\u4ea4\uff0c\u5c0d\u8cc7\u6599\u5eab\u7684\u4fee\u6539\u662f\u6c38\u4e45\u6027\u7684</li> </ul> </li> </ul> </li> <li>\u56de\u6efe (rollback): \u4ea4\u6613\u5931\u6557\u6642\uff0c\u6703\u81ea\u52d5\u56de\u6efe (rollback)</li> <li>\u63d0\u4ea4 (commit): \u4ea4\u6613\u6210\u529f\u6642\uff0c\u6703\u81ea\u52d5\u63d0\u4ea4 (commit)</li> <li>\u9ed8\u8a8d\u7684\u9694\u96e2\u7d1a\u5225<ul> <li>READ COMMITTED: \u53ef\u4ee5\u8b80\u53d6\u5230\u5176\u4ed6\u4ea4\u6613\u5df2\u7d93\u63d0\u4ea4\u7684\u6578\u64da\uff0c\u4f46\u662f\u4e0d\u80fd\u8b80\u53d6\u5230\u5176\u4ed6\u4ea4\u6613\u672a\u63d0\u4ea4\u7684\u6578\u64da</li> </ul> </li> </ul> </li> </ul> Java<pre><code>@Transactional\n@Override\npublic void transfer(Integer fromAccountId, Integer toAccountId, Integer money) {\n    // User A \u6263\u9664\u8f49\u5e33\u91d1\u984d\n    accountDao.decreaseMoney(fromAccountId, money);\n    // \u4ea4\u6613\u5931\u6557\uff0c\u5674\u51fa exception\uff0c\u6703\u81ea\u52d5\u56de\u6efe (rollback)\n    Integer a = 1/0;\n    // User B \u6536\u5230\u8f49\u5e33\u91d1\u984d\n    accountDao.increaseMoney(toAccountId, money);\n}\n</code></pre> <ul> <li> <p>\u591a\u500b\u8cc7\u6599\u5eab\u7684\u9023\u7dda\u8a2d\u5b9a</p> <ul> <li><code>application.properties</code><ul> <li>spring.datasource \u5f8c\u9762\u8981\u6307\u5b9a DB \u540d\u7a31</li> <li>spring.datasource.test1.jdbc-url \u5728\u6307\u5b9a DB \u540d\u7a31\u5f8c\u9762\uff0c\u4f7f\u7528 <code>jdbc-url</code>\uff0c\u800c\u4e0d\u662f <code>url</code></li> </ul> </li> <li>@Configuration \u8a3b\u89e3\u7684 class \u5167\u7684 @ConfigurationProperties \u8a3b\u89e3\uff0c\u4f7f\u7528 prefix \u4f86\u6307\u5b9a DB \u540d\u7a31</li> <li>@RestController \u8a3b\u89e3\uff0c\u6307\u5b9a\u8981\u8f09\u5165\u7684 <code>JdbcTemplate</code> \u7684 bean \u540d\u7a31</li> </ul> Properties<pre><code># \u591a\u500b\u8cc7\u6599\u5eab\u7684\u9023\u7dda\u8a2d\u5b9a\nspring.datasource.test1.driver-class-name=com.mysql.cj.jdbc.Driver\nspring.datasource.test1.jdbc-url=jdbc:mysql://localhost:3306/test1?serverTimezone=Asia/Taipei&amp;characterEncoding=utf-8\nspring.datasource.test1.username=root\nspring.datasource.test1.password=springboot\n\nspring.datasource.test2.driver-class-name=com.mysql.cj.jdbc.Driver\nspring.datasource.test2.jdbc-url=jdbc:mysql://localhost:3306/test2?serverTimezone=Asia/Taipei&amp;characterEncoding=utf-8\nspring.datasource.test2.username=root\nspring.datasource.test2.password=springboot\n\n# \u55ae\u500b\u8cc7\u6599\u5eab\u7684\u9023\u7dda\u8a2d\u5b9a\n#spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n#spring.datasource.url=jdbc:mysql://localhost:3306/myjdbc?serverTimezone=Asia/Taipei&amp;characterEncoding=utf-8\n#spring.datasource.username=root\n#spring.datasource.password=springboot\n</code></pre> Java<pre><code>@Configuration\npublic class DataSourceConfiguration {\n\n    // \u9023\u7dda\u5230 test1 \u8cc7\u6599\u5eab\u7684 DataSource \u548c NamedParameterJdbcTemplate\n    @Bean\n    @ConfigurationProperties(prefix = \"spring.datasource.test1\")\n    public DataSource test1DataSource() {\n        return DataSourceBuilder.create().build();\n    }\n\n    @Bean\n    public NamedParameterJdbcTemplate test1JdbcTemplate(\n            @Qualifier(\"test1DataSource\") DataSource dataSource) {\n        return new NamedParameterJdbcTemplate(dataSource);\n    }\n\n\n    // \u9023\u7dda\u5230 test2 \u8cc7\u6599\u5eab\u7684 DataSource \u548c NamedParameterJdbcTemplate\n    @Bean\n    @ConfigurationProperties(prefix = \"spring.datasource.test2\")\n    public DataSource test2DataSource() {\n        return DataSourceBuilder.create().build();\n    }\n\n    @Bean\n    public NamedParameterJdbcTemplate test2JdbcTemplate(\n            @Qualifier(\"test2DataSource\") DataSource dataSource) {\n        return new NamedParameterJdbcTemplate(dataSource);\n    }\n}\n</code></pre> Java<pre><code>@RestController\npublic class StudentController {\n\n    @Autowired\n    @Qualifier(\"test1JdbcTemplate\")\n    private NamedParameterJdbcTemplate test1JdbcTemplate;\n\n    @Autowired\n    @Qualifier(\"test2JdbcTemplate\")\n    private NamedParameterJdbcTemplate test2JdbcTemplate;\n\n\n    @PostMapping(\"/test1/students\")\n    public String test1Insert(@RequestBody Student student) {\n        String sql = \"INSERT INTO student(name) VALUE (:studentName)\";\n\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"studentName\", student.getName());\n\n        test1JdbcTemplate.update(sql, map);\n\n        return \"\u63d2\u5165\u6578\u64da\u5230 test1 \u8cc7\u6599\u5eab\";\n    }\n\n    @PostMapping(\"/test2/students\")\n    public String test2Insert(@RequestBody Student student) {\n        String sql = \"INSERT INTO student(name) VALUE (:studentName)\";\n\n        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"studentName\", student.getName());\n\n        test2JdbcTemplate.update(sql, map);\n\n        return \"\u63d2\u5165\u6578\u64da\u5230 test2 \u8cc7\u6599\u5eab\";\n    }\n}\n</code></pre> </li> </ul>"},{"location":"backend/framework/spring_boot/#spring-data-jpa","title":"Spring Data JPA","text":"<ul> <li>\u4f7f\u7528 ORM \u7684\u6982\u5ff5\uff0c\u900f\u904e\u64cd\u4f5c Java object \u7684\u65b9\u5f0f\uff0c\u53bb\u64cd\u4f5c\u8cc7\u6599\u5eab</li> <li>ORM (Object-Relational Mapping): \u5c07 Java object\uff0c\u53bb\u5c0d\u61c9\u5230\u8cc7\u6599\u5eab\u7684 table</li> </ul>"},{"location":"backend/framework/spring_boot/#jpa-hibernate","title":"JPA &amp; Hibernate","text":"<ul> <li>JPA (Java Persistence API): \u5b9a\u7fa9\u8981\u5982\u4f55\u64cd\u4f5c\u8cc7\u6599\u5eab<ul> <li>\u63d0\u4f9b @Entity, @Table, @Column ...\u7b49\u8a3b\u89e3</li> </ul> </li> <li>Hibernate: \u662f\u4e00\u7a2e ORM \u6846\u67b6\uff0c\u5be6\u4f5c JPA \u7684 API\uff0c(\u6839\u64da JPA \u7684\u898f\u7bc4)\uff0c\u81ea\u52d5\u751f\u6210 SQL \u8a9e\u6cd5\uff0c\u53bb\u64cd\u4f5c\u8cc7\u6599\u5eab</li> </ul>"},{"location":"backend/framework/spring_boot/#spring-data-jpa_1","title":"\u4f7f\u7528 Spring Data JPA","text":"<ul> <li>\u8a2d\u5b9a\u5957\u4ef6\u7ba1\u7406\u7684\u8a2d\u5b9a\u6a94 (<code>pom.xml</code>)<ul> <li>\u4f7f\u7528 Spring Boot \u7684 JDBC \u529f\u80fd</li> <li>\u4f7f\u7528 MySQL \u7684 JDBC driver (\u5b98\u7db2\u9023\u7d50: MySQL Connector Java) XML<pre><code>&lt;!-- \u4f7f\u7528 Spring Boot \u7684 Data JPA \u529f\u80fd --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;!-- \u4f7f\u7528 MySQL \u7684 JDBC driver --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n    &lt;version&gt;8.0.33&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></li> </ul> </li> <li>\u8a2d\u5b9a Spring Data JPA \u7684\u9023\u7dda\u8cc7\u8a0a (<code>application.properties</code>)<ul> <li>\u4ee5\u4e0b\u7684 Spring Data JPA \u9023\u7dda\u8a2d\u5b9a\u4e0d\u7528\u7279\u5225\u80cc\uff0c\u8981\u7528\u6642\u518d\u4f86\u770b\u5c31\u597d Properties<pre><code># \u9078\u65b0\u7248 (\u6709 cj \u7684\u90a3\u500b)\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n# \u8cc7\u6599\u5eab\u540d\u7a31: myjpa (\u5927\u5c0f\u5beb\u654f\u611f\u7684)\nspring.datasource.url=jdbc:mysql://localhost:3306/myjpa?serverTimezone=Asia/Taipei&amp;characterEncoding=utf-8\nspring.datasource.username=root\nspring.datasource.password=\n\n# \u5728 console \u756b\u9762\u4e2d\uff0c\u986f\u793a Hibernate \u52d5\u614b\u7522\u751f\u7684 SQL \u8a9e\u6cd5\nspring.jpa.show-sql=true\n</code></pre></li> </ul> </li> <li><code>CrudRepository</code> interface: \u57fa\u672c\u7684 CRUD \u64cd\u4f5c (\u6700\u5e38\u7528)<ul> <li><code>save()</code>: \u65b0\u589e or \u66f4\u65b0\u6578\u64da</li> <li><code>findById()</code>: \u6839\u64da id \u67e5\u8a62\u6578\u64da</li> <li><code>deleteById()</code>: \u6839\u64da id \u522a\u9664\u6578\u64da</li> </ul> </li> <li><code>PagingAndSortingRepository</code> interface: \u65b0\u589e\u5206\u9801\u3001\u6392\u5e8f\u7684\u64cd\u4f5c</li> <li> <p><code>JpaRepositor</code> interface: \u80fd\u529b\u6700\u5f37\uff0c\u65b0\u589e\u4e86 JPA \u76f8\u95dc\u7684 flush \u64cd\u4f5c  \u5716\u7247\u51fa\u8655</p> </li> <li> <p>CrudRepository \u57fa\u672c CRUD \u64cd\u4f5c</p> </li> </ul> SQL<pre><code>CREATE DATABASE myjpa;\n\nCREATE TABLE student (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(30)\n)\n</code></pre> Java<pre><code>// Student.java\n@Entity\n@Table(name = \"student\") // \u5c0d\u61c9\u5230\u8cc7\u6599\u5eab\u7684\u8868\u683c\u540d\u7a31\npublic class Student {\n\n    @Id // Primary Key\n    @GeneratedValue(strategy = GenerationType.IDENTITY) // id \u503c\u662f\u7531\u8cc7\u6599\u5eab\u81ea\u52d5\u7522\u751f\u7684\n    @Column(name = \"id\") // \u5c0d\u61c9\u5230\u8cc7\u6599\u5eab\u7684\u6b04\u4f4d\u540d\u7a31\n    Integer id;\n\n    @Column(name = \"name\")\n    String name;\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n</code></pre> Java<pre><code>// StudentRepository.java (interface)\npackage com.example.demo;\n\nimport org.springframework.data.repository.CrudRepository;\n\npublic interface StudentRepository extends CrudRepository&lt;Student, Integer&gt; {\n\n}\n</code></pre> Java<pre><code>// StudentController.java\n@RestController\npublic class StudentController {\n    @Autowired\n    private StudentRepository studentRepository;\n\n    @GetMapping(\"/students/{studentId}\")\n    public Student read(@PathVariable Integer studentId) {\n        // \u56e0\u70ba CrudRepository.findById() \u9810\u8a2d\u8fd4\u56de Optional \u578b\u5225\uff0c\u56e0\u6b64\u52a0\u4e0a orElse(null) \u53ef\u4f7f\u5176\u8fd4\u56de Student \u578b\u5225\n        // `orElse(null)`: \u82e5\u65bc\u8cc7\u6599\u5eab\u4e2d\u627e\u4e0d\u5230\u76f8\u5c0d\u61c9\u7684\u6578\u64da\u6642\uff0c\u5c31\u8fd4\u56de null\n        Student student = studentRepository.findById(studentId).orElse(null);\n        return student;\n    }\n\n    @PostMapping(\"/students\")\n    public String insert(@RequestBody Student student) {\n        studentRepository.save(student);\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Create \u64cd\u4f5c\";\n    }\n\n    @PutMapping(\"/students/{studentId}\")\n    public String update(@PathVariable Integer studentId,\n                         @RequestBody Student student) {\n        Student s = studentRepository.findById(studentId).orElse(null);\n        if (s != null) {\n            s.setName(student.getName());\n            studentRepository.save(s);\n            return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Update \u64cd\u4f5c\";\n        } else {\n            return \"Update \u5931\u6557\uff0c\u6578\u64da\u4e0d\u5b58\u5728\";\n        }\n    }\n\n    @DeleteMapping(\"/students/{studentId}\")\n    public String delete(@PathVariable Integer studentId) {\n        studentRepository.deleteById(studentId);\n        return \"\u57f7\u884c\u8cc7\u6599\u5eab\u7684 Delete \u64cd\u4f5c\";\n    }\n}\n</code></pre> <ul> <li> <p>\u81ea\u5b9a\u7fa9\u67e5\u8a62\u689d\u4ef6     Java<pre><code>// StudentRepository.java (interface)\npackage com.example.demo;\n\nimport org.springframework.data.repository.CrudRepository;\n\npublic interface StudentRepository extends CrudRepository&lt;Student, Integer&gt; {\n    // sql: SELECT * FROM Student WHERE name = ?\n    List&lt;Student&gt; findByName(String name);\n\n    // sql: SELECT * FROM Student WHERE id = ? AND name = ?\n    // \u53c3\u6578\u6703\u6309\u7167\"\u9806\u5e8f\"\u50b3\u5165\uff0c\u800c\u53c3\u6578\u540d\u5b57\u4e0d\u91cd\u8981\n    Student findByIdAndName(Integer id, String name);\n}\n</code></pre></p> </li> <li> <p>@Query \u8a3b\u89e3: \u7528\u4f86\u89e3\u6c7a <code>findByXxx</code> \u7121\u6cd5 \u5beb\u51fa\u8907\u96dc\u7684\u67e5\u8a62\u908f\u8f2f\u7684\u554f\u984c (e.g. JOIN \u8a31\u591a table)</p> <ul> <li>\u7528\u9014: \u5728 Spring Data JPA \u4e2d\uff0c\u57f7\u884c\u539f\u751f\u7684 SQL \u8a9e\u6cd5<ul> <li><code>nativeQuery = true</code> \u53c3\u6578: \u8868\u793a\u8981\u57f7\u884c\u539f\u751f\u7684 SQL \u8a9e\u6cd5; false: \u8868\u793a\u8981\u57f7\u884c JPQL \u8a9e\u6cd5</li> </ul> </li> <li>\u5be6\u52d9\u4e0a\uff0c\u6703\u512a\u5148\u4f7f\u7528 <code>findByXxx</code> \u7684\u547d\u540d\u898f\u5247\uff0c\u82e5\u7121\u6cd5\u6eff\u8db3\u9700\u6c42\u6642\uff0c\u624d\u6703\u4f7f\u7528 @Query \u8a3b\u89e3 Java<pre><code>// StudentRepository.java (interface)\npackage com.example.demo;\n\nimport org.springframework.data.jpa.repository.Query;\n\npublic interface StudentRepository extends CrudRepository&lt;Student, Integer&gt; {\n    @Query(value = \"SELECT * FROM student WHERE id = ?1 AND name = ?2\", nativeQuery = true)\n    Student test1(Integer id, String name);\n}\n</code></pre></li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#spring-boot_2","title":"Spring Boot \u55ae\u5143\u6e2c\u8a66","text":"<ul> <li>\u55ae\u5143\u6e2c\u8a66: \u81ea\u52d5\u5316 \u6e2c\u8a66\u7a0b\u5f0f\u78bc\u7684\u6b63\u78ba\u6027<ul> <li>\u4e00\u6b21\u53ea\u6703\u6e2c\u8a66\u4e00\u500b\u529f\u80fd\u9ede (= \u4e00\u500b method \u6216 API)</li> <li>\u5404\u500b\u55ae\u5143\u6e2c\u8a66\u4e92\u76f8\u7368\u7acb\uff0c\u5f7c\u6b64\u4e4b\u9593\u4e0d\u80fd\u6709\u4f9d\u8cf4\u95dc\u4fc2 (e.g. \u5148\u5f8c\u9806\u5e8f)</li> <li>\u6e2c\u8a66\u7684\u7d50\u679c\u662f\u7a69\u5b9a\u7684\uff0c\u4e0d\u53d7\u5916\u90e8\u670d\u52d9\u5f71\u97ff</li> <li>\u6e2c\u8a66\u7684\u7a0b\u5f0f: \u6703\u653e\u5728 <code>test/</code> \u8cc7\u6599\u593e\u4e2d (\u5fc5\u9808\u9075\u5b88\u7684)</li> <li>\u547d\u540d\u98a8\u683c: \u6e2c\u8a66\u7684 class\uff0c\u6703\u4ee5 \u539f class \u7684\u540d\u5b57\u52a0\u4e0a Test \u4f5c\u70ba\u7d50\u5c3e \u4f86\u547d\u540d (e.g. <code>StudentTest</code>)</li> <li>\u6e2c\u8a66\u7684 class \u7684 package\uff0c\u6703\u8207\u539f class \u7684 package \u76f8\u5c0d\u8def\u5f91\u4fdd\u6301\u4e00\u81f4 (\u5dee\u5225\u5728\u4e00\u500b\u4f4d\u65bc <code>main/</code>\uff0c\u53e6\u4e00\u500b\u4f4d\u65bc <code>test/</code> \u8cc7\u6599\u593e\u4e2d)</li> </ul> </li> <li>\u8a2d\u5b9a\u5957\u4ef6\u7ba1\u7406\u7684\u8a2d\u5b9a\u6a94 (<code>pom.xml</code>)<ul> <li>\u4f7f\u7528 Spring Boot \u7684 Test \u529f\u80fd (Spring Boot initializer \u9810\u8a2d\u6703\u5e6b\u5fd9\u52a0\u5165) XML<pre><code>&lt;!-- \u4f7f\u7528 Spring Boot \u7684 Test \u529f\u80fd --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre></li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#junit","title":"JUnit \u55ae\u5143\u6e2c\u8a66","text":"<ul> <li>JUnit: Java \u4e2d\uff0c\u55ae\u5143\u6e2c\u8a66\u7684\u5fc5\u5099\u5de5\u5177<ul> <li>Spring Boot \u8207 JUnit \u7684\u7248\u672c\u76f8\u5bb9\u6027 </li> </ul> </li> <li>@Test \u8a3b\u89e3: \u52a0\u5728 method \u4e0a\uff0c\u5373\u53ef\u751f\u6210\u4e00\u500b\u55ae\u5143\u6e2c\u8a66<ul> <li>\u53ea\u80fd\u7528\u5728 <code>test/</code> \u8cc7\u6599\u593e\u4e2d\u4f7f\u7528\uff0c\u53ef\u4ee5\u5c07\u8a72 method \u8b8a\u6210\u4e00\u500b\u6e2c\u9805(test case)</li> <li>method \u5fc5\u9808\u70ba <code>public void xxx()</code>\uff0c\u4e26\u4e14\u6c92\u6709\u4efb\u4f55\u53c3\u6578</li> <li>method \u540d\u7a31\u53ef\u4efb\u610f\u547d\u540d\uff0c\u4f46\u662f\u6700\u597d \u80fd\u5920\u8868\u9054\u51fa\u8a72 method \u60f3\u6e2c\u8a66\u54ea\u500b\u529f\u80fd\u9ede</li> </ul> </li> <li>Assert \u5e38\u898b\u7528\u6cd5<ul> <li><code>assertNull(A)</code>: \u65b7\u8a00 A \u70ba null</li> <li><code>assertNotNull(A)</code>: \u65b7\u8a00 A \u4e0d\u70ba null</li> <li><code>assertEquals(expected, actual)</code>: \u65b7\u8a00 expected \u8207 actual \u76f8\u7b49\uff0c\u6703\u4f7f\u7528 <code>equals()</code> \u65b9\u6cd5\u53bb\u5224\u65b7</li> <li><code>assertTrue(A)</code>: \u65b7\u8a00 A \u70ba true</li> <li><code>assertFalse(A)</code>: \u65b7\u8a00 A \u70ba false</li> <li><code>assertThrows(exception, method)</code>: \u65b7\u8a00\u57f7\u884c method \u6642\uff0c\u6703\u62cb\u51fa exception</li> </ul> </li> <li>@BeforeEach \u8a3b\u89e3\u3001@AfterEach \u8a3b\u89e3<ul> <li>@BeforeEach: \u5728 \u6bcf\u6b21 @Test \u958b\u59cb\u524d\uff0c\u90fd\u6703\u57f7\u884c\u4e00\u6b21</li> <li>@AfterEach: \u5728 \u6bcf\u6b21 @Test \u7d50\u675f\u5f8c\uff0c\u90fd\u6703\u57f7\u884c\u4e00\u6b21</li> </ul> </li> <li>@BeforeAll \u8a3b\u89e3\u3001@AfterAll \u8a3b\u89e3 (\u5fc5\u9808\u662f static method\uff0c\u56e0\u6b64\u7121\u6cd5\u5b58\u53d6 bean\uff0c\u6240\u4ee5\u8f03\u5c11\u4f7f\u7528)<ul> <li>@BeforeAll: \u5728 \u6240\u6709 @Test \u958b\u59cb\u524d\uff0c\u53ea\u6703\u57f7\u884c\u4e00\u6b21</li> <li>@AfterAll: \u5728 \u6240\u6709 @Test \u7d50\u675f\u5f8c\uff0c\u53ea\u6703\u57f7\u884c\u4e00\u6b21</li> </ul> </li> <li>@Disabled: \u52a0\u5728 method \u4e0a\uff0c\u5ffd\u7565\u8a72 @Test \u4e0d\u57f7\u884c</li> <li>@DisplayName: \u52a0\u5728 method \u4e0a\uff0c\u81ea\u5b9a\u7fa9\u6e2c\u8a66\u7684\u986f\u793a\u540d\u7a31 (\u53ef\u4f7f\u7528\u4e2d\u6587\u547d\u540d)</li> </ul> Java<pre><code>// main/java/com/example/demo/Calculator.java\npublic class Calculator {\n    public int add(int x, int y) {\n        return x + y;\n    }\n\n    public int divide(int x, int y) {\n        return x / y;\n    }\n\n    public static void main(String[] args) {\n        Calculator calculator = new Calculator();\n        int result = calculator.add(1, 2);\n        System.out.println(\"\u7d50\u679c\u70ba: \" + result);\n    }\n}\n</code></pre> Java<pre><code>// test/java/com/example/demo/CalculatorTest.java\npublic class CalculatorTest {\n    @Disabled\n    @Test\n    public void add() {\n        Calculator calculator = new Calculator();\n        int result = calculator.add(1, 2);\n\n        assertNotNull(result);\n        // \u65b7\u8a00(\u6211\u8a8d\u70ba)\u76f8\u7b49\n        assertEquals(3, result, \"\u52a0\u6cd5\u6709\u554f\u984c\");\n        assertTrue(result &gt; 1);\n    }\n\n    @DisplayName(\"\u6e2c\u8a66\u9664\u6cd5\u554f\u984c\")\n    @Test\n    public void divide() {\n        Calculator calculator = new Calculator();\n        assertThrows(ArithmeticException.class, () -&gt; {\n            calculator.divide(1, 0);\n        });\n    }\n}\n</code></pre> Java<pre><code>// test/java/com/example/demo/MyTest.java\npublic class MyTest {\n    @BeforeEach\n    public void beforeEach() {\n        System.out.println(\"\u57f7\u884c @beforeEach\");\n    }\n\n    @AfterEach\n    public void afterEach() {\n        System.out.println(\"\u57f7\u884c @afterEach\");\n    }\n\n    @BeforeAll\n    public static void beforeAll() {\n        System.out.println(\"\u57f7\u884c @BeforeAll\");\n    }\n\n    @AfterAll\n    public static void afterAll() {\n        System.out.println(\"\u57f7\u884c @AfterAll\");\n    }\n\n    @Test\n    public void test1() {\n        System.out.println(\"\u57f7\u884c test1\");\n    }\n\n    @Test\n    public void test2() {\n        System.out.println(\"\u57f7\u884c test2\");\n    }\n}\n\n// \u7d50\u679c\n// \u57f7\u884c @BeforeAll\n// \u57f7\u884c @beforeEach\n// \u57f7\u884c test1\n// \u57f7\u884c @afterEach\n// \u57f7\u884c @beforeEach\n// \u57f7\u884c test2\n// \u57f7\u884c @afterEach\n// \u57f7\u884c @AfterAll\n</code></pre>"},{"location":"backend/framework/spring_boot/#service-dao","title":"Service \u5c64\u3001Dao \u5c64\u7684\u55ae\u5143\u6e2c\u8a66","text":"<ul> <li>@SpringBootTest \u8a3b\u89e3: \u52a0\u5728 class \u4e0a\uff0c\u8868\u793a\u9019\u662f\u4e00\u500b Spring Boot \u7684\u6e2c\u8a66\u985e\u5225<ul> <li>\u76f8\u7576\u65bc\u76f4\u63a5\u555f\u52d5 Spring Boot \u7684\u61c9\u7528\u7a0b\u5f0f</li> <li>\u6703\u81ea\u52d5\u8f09\u5165 Spring Boot \u7684\u6240\u6709\u914d\u7f6e (@Configuration, Interceptor \u90fd\u6703\u751f\u6548)</li> <li>\u6703\u81ea\u52d5\u8f09\u5165\u6240\u6709\u7684 bean (\u53ef\u4f7f\u7528 @Autowired \u4f86\u6ce8\u5165)</li> </ul> </li> <li>@Transactional \u8a3b\u89e3: \u52a0\u5728\u5e36\u6709 @Test \u8a3b\u89e3\u7684 class \u6216 method \u4e0a\uff0c\u5728\u55ae\u5143\u6e2c\u8a66\u7d50\u675f\u5f8c\uff0c\u6703\u5f37\u5236\u56de\u6efe(rollback)\u6240\u6709\u8cc7\u6599\u5eab\u64cd\u4f5c\uff0c\u5c07\u6578\u64da\u6062\u5fa9\u539f\u72c0</li> </ul> \u6bd4\u8f03 @Transactional \u5728 <code>main/</code> \u8cc7\u6599\u593e @Transactional \u5728 <code>test/</code> \u8cc7\u6599\u593e \u8aaa\u660e \u6b63\u5e38\u7a0b\u5f0f \u55ae\u5143\u6e2c\u8a66 \u76ee\u7684 \u4ea4\u6613\u7ba1\u7406 \u907f\u514d\u6e2c\u8a66\u5f71\u97ff\u5230\u8cc7\u6599\u5eab\u4e2d\u7684\u6578\u64da \u56de\u6efe\u6a5f\u5236(rollback) \u7576\u7a0b\u5f0f\u904b\u884c\u4e2d\u9014\u767c\u751f\u932f\u8aa4\u6642\uff0c\u624d\u6703\u56de\u6efe\u5df2\u7d93\u57f7\u884c\u7684\u8cc7\u6599\u5eab\u64cd\u4f5c\uff0c\u5c07\u6578\u64da\u6062\u5fa9\u5143\u72c0 \u5728\u8a72\u55ae\u5143\u6e2c\u8a66\u7d50\u675f\u5f8c\uff0c\u5f37\u5236 rollback \u6240\u6709\u57f7\u884c\u7684\u8cc7\u6599\u5eab\u64cd\u4f5c\uff0c\u5c07\u6578\u64da\u6062\u5fa9\u539f\u72c0 <ul> <li>Service \u5c64\u3001Dao \u5c64\u7684\u55ae\u5143\u6e2c\u8a66 --- \u57fa\u672c\u7bc4\u4f8b Java<pre><code>// test/java/com/example/demo/StudentDaoImplTest.java\n// \u6e2c\u8a66 Dao \u5c64\n@SpringBootTest\npublic class StudentDaoImplTest {\n    @Autowired\n    private StudentDao studentDao;\n\n    @Test\n    public void getById() {\n        Student student = studentDao.getById(3);\n        assertNotNull(student);\n        assertEquals(\"Judy\", student.getName());\n        assertEquals(100.0, student.getScore());\n        assertTrue(student.isGraduate());\n        assertNotNull(student.getCreateDate());\n    }\n\n    @Transactional\n    @Test\n    public void deleteById() {\n        studentDao.deleteById(3);\n\n        Student student = studentDao.getById(3);\n        assertNull(student);\n    }\n\n    // (\u7565) \u5176\u5b83 method \u7684\u55ae\u5143\u6e2c\u8a66\n    @Transactional\n    @Test\n    public void insert() {\n        Student student = new Student();\n        student.setName(\"Kevin\");\n        student.setScore(66.2);\n        student.setGraduate(true);\n\n        Integer studentId = studentDao.insert(student);\n\n        Student result = studentDao.getById(studentId);\n        assertNotNull(result);\n        assertEquals(\"Kevin\", result.getName());\n        assertEquals(66.2, result.getScore());\n        assertTrue(result.isGraduate());\n        assertNotNull(result.getCreateDate());\n    }\n\n    @Transactional\n    @Test\n    public void update() {\n        Student student = new Student();\n        student.setName(\"John\");\n\n        studentDao.update(student);\n    }\n}\n</code></pre></li> </ul>"},{"location":"backend/framework/spring_boot/#controller","title":"Controller \u5c64\u7684\u55ae\u5143\u6e2c\u8a66","text":"<ul> <li>\u6a21\u64ec\u524d\u7aef\u7684\u884c\u70ba\uff0c\u6e2c\u8a66 API \u662f\u5426\u904b\u884c\u6b63\u78ba<ul> <li>\u4e0d\u80fd\u76f4\u63a5\u6ce8\u5165 bean \u4f86\u6e2c\u8a66\uff0c\u9700\u8981\u900f\u904e\u6a21\u64ec\u771f\u5be6\u7684 API call \u4f86\u6e2c\u8a66</li> </ul> </li> <li>MockMVC: \u6a21\u64ec\u771f\u5be6\u7684 API call<ul> <li>@SpringBootTest \u8a3b\u89e3: \u52a0\u5728 class \u4e0a\uff0c\u8868\u793a\u9019\u662f\u4e00\u500b Spring Boot \u7684\u6e2c\u8a66\u985e\u5225</li> <li>@AutoConfigureMockMvc \u8a3b\u89e3: \u52a0\u5728 class \u4e0a\uff0c\u8868\u793a\u555f\u52d5 MockMVC</li> <li>@Autowired: \u6ce8\u5165 MockMVC bean</li> <li>@Test: \u5efa\u7acb\u6e2c\u8a66 method</li> </ul> </li> </ul> Java<pre><code>@SpringBootTest\n@AutoConfigureMockMvc\npublic class StudentControllerTest {\n    @Autowired\n    private MockMvc mockMvc;\n\n    @Test\n    // \u56e0\u70ba perform() method \u53ef\u80fd\u6703\u62cb\u51fa Exception\uff0c\u5c07 Exception \u518d\u7d66\u62cb\u51fa\u53bb\n    public void getById() throws Exception {\n        // step 1: \u5efa\u7acb requestBuilder\uff0c\u8a2d\u5b9a\u8981\u767c\u8d77\u7684 http request \u76f8\u95dc\u7684 request \u53c3\u6578\n        RequestBuilder requestBuilder = MockMvcRequestBuilders\n                .get(\"/students/{studentId}\", 3)\n                .header(\"headerName\", \"headerValue\")\n                .queryParam(\"graduate\", \"true\");\n\n        // step 2: \u57f7\u884c\u8a72 http request\n        MvcResult mvcResult = mockMvc.perform(requestBuilder)\n                // \u5c07 API \u57f7\u884c\u7d50\u679c\u5370\u51fa\u4f86\uff0c\u65b9\u4fbf\u5c0d\u7167\u5beb\u51fa jsonPath() \u9a57\u8b49\n                .andDo(print())\n                // step 3: \u9a57\u8b49\u56de\u50b3\u7684\u7d50\u679c\n                .andExpect(status().is(200))\n                // \u9a57\u8b49\u56de\u50b3\u7684 JSON \u7d50\u679c (`$`: \u8868\u793a\u6700\u5916\u5c64)\n                .andExpect(jsonPath(\"$.id\", equalTo(3)))\n                .andExpect(jsonPath(\"$.name\", notNullValue()))\n                // `andReturn()`: (\u53ea\u80fd\u52a0\u5728\u9a57\u8b49\u7d50\u679c\u7684\u6700\u5f8c\u4e00\u884c)\uff0c\u53d6\u5f97\u5b8c\u6574\u7684 API \u57f7\u884c\u7d50\u679c\n                .andReturn();\n\n        // \u8f38\u51fa mvc \u56de\u50b3\u7d50\u679c\u7684 response body\n        String body = mvcResult.getResponse().getContentAsString();\n        System.out.println(\"\u8fd4\u56de\u7684 response body \u70ba: \" + body);\n    }\n\n    @Test\n    public void create() throws Exception {\n        RequestBuilder requestBuilder = MockMvcRequestBuilders\n                .post(\"/students\")\n                // \u5728\u8a72 http request \u52a0\u4e0a content type \u7684 header\uff0c\u800c\u9019\u500b header \u7684\u503c\u5c31\u662f application/json\n                .contentType(MediaType.APPLICATION_JSON)\n                // \u8981\u5e36\u5165\u7684 request body \u5167\u5bb9\n                .content(\"{\\n\" +\n                        \"  \\\"name\\\": \\\"Hank\\\",\\n\" +\n                        \"  \\\"score\\\": 14.6,\\n\" +\n                        \"  \\\"graduate\\\": false\\n\" +\n                        \"}\");\n\n        mockMvc.perform(requestBuilder)\n                .andExpect(status().is(201));\n    }\n}\n</code></pre>"},{"location":"backend/framework/spring_boot/#mock","title":"Mock \u6e2c\u8a66","text":"<ul> <li>\u76ee\u7684: \u907f\u514d\u70ba\u4e86\u6e2c\u8a66\u67d0\u4e00\u500b\u55ae\u5143\u6e2c\u8a66\uff0c\u800c\u53bb\u5efa\u69cb\u4e86\u6574\u500b bean \u7684 dependency </li> <li>\u4f5c\u6cd5: \u5275\u9020\u4e00\u500b\u5047\u7684 bean\uff0c\u53bb\u66ff\u63db\u6389 Spring container \u4e2d\u539f\u6709\u7684 bean<ul> <li>\u4f7f\u7528 @MockBean \u8a3b\u89e3: \u5efa\u7acb\u4e00\u500b\u5047\u7684 bean<ul> <li>\u6c92\u6709\u5b9a\u7fa9\u7684 method\uff0c\u9810\u8a2d\u56de\u50b3 null</li> </ul> </li> <li>\u4f7f\u7528 @SpyBean \u8a3b\u89e3: Spring container \u4e2d\u7684 bean \u4ecd\u820a\u662f\u6b63\u5e38\u7684 bean\uff0c\u53ea\u66ff\u63db\u5176\u4e2d\u5e7e\u500b\u65b9\u6cd5<ul> <li>\u6c92\u6709\u5b9a\u7fa9\u7684 method\uff0c\u9810\u8a2d\u4f7f\u7528\u771f\u5be6 bean \u7684 method</li> </ul> </li> </ul> </li> <li>\u4f7f\u7528 Mockito \u6846\u67b6: \u5728 Spring Boot \u4e2d\u9032\u884c Mock \u6e2c\u8a66\u7684\u5de5\u5177<ul> <li>\u6a21\u64ec\u65b9\u6cd5\u7684\u8fd4\u56de\u503c<ul> <li>\u6cd5 1: \u4f7f\u7528 <code>when().thenReturn()</code> \u65b9\u6cd5</li> <li>\u6cd5 2: \u4f7f\u7528 <code>doReturn().when()</code> \u65b9\u6cd5</li> </ul> </li> <li>\u6a21\u64ec\u62cb\u51fa\u7684 Exception<ul> <li>\u6cd5 1: \u4f7f\u7528 <code>when().thenThrow()</code> \u65b9\u6cd5</li> <li>\u6cd5 2: \u4f7f\u7528 <code>doThrow().when()</code> \u65b9\u6cd5</li> </ul> </li> <li>\u6a21\u64ec\u65b9\u6cd5\u7684\u4f7f\u7528\u6b21\u6578\u3001\u9806\u5e8f<ul> <li>\u6cd5 1: \u4f7f\u7528 <code>verify().times()</code> \u65b9\u6cd5</li> </ul> </li> </ul> </li> <li>\u4f7f\u7528 Mockito \u6846\u67b6\u7684 \u9650\u5236<ul> <li>\u4e0d\u80fd mock static method</li> <li>\u4e0d\u80fd mock private method</li> <li>\u4e0d\u80fd mock final class</li> </ul> </li> </ul> Java<pre><code>// test/java/com/example/demo/StudentServiceImplMockTest.java\n@SpringBootTest\npublic class StudentServiceImplMockTest {\n    @Autowired\n    private StudentServiceImpl studentService;\n\n    @MockBean\n    private StudentDao studentDao;\n\n    @BeforeEach\n    public void beforeEach() {\n        Student mockStudent = new Student();\n        mockStudent.setId(100);\n        mockStudent.setName(\"I'm mock\");\n\n        Mockito.when(studentDao.getById(Mockito.any())).thenReturn(mockStudent);\n    }\n\n    @Test\n    public void getById() {\n        Student student = studentService.getById(3);\n        assertNotNull(student);\n        assertEquals(\"Judy\", student.getName());\n        assertEquals(100.0, student.getScore());\n        assertTrue(student.isGraduate());\n        assertNotNull(student.getCreateDate());\n    }\n\n    @Test\n    public void getById2() {\n        Student student = studentService.getById(2);\n        assertNotNull(student);\n        assertEquals(100, student.getId());\n        assertEquals(\"I'm mock\", student.getName());\n    }\n}\n</code></pre> Java<pre><code>// test/java/com/example/demo/StudentServiceImplSpyTest.java\n@SpringBootTest\npublic class StudentServiceImplSpyTest {\n    @Autowired\n    private StudentServiceImpl studentService;\n\n    @SpyBean\n    private StudentDao studentDao;\n\n    @Test\n    public void insert() {\n        // \u7576\u4f7f\u7528 @SpyBean \u6642\uff0c\u5efa\u8b70\u4f7f\u7528 doReturn().when() \u7684\u5beb\u6cd5\uff0c\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u932f\u8aa4\n        Mockito.doReturn(100).when(studentDao).insert(Mockito.any());\n\n        Student student = new Student();\n        student.setName(\"Kevin\");\n        student.setScore(50.0);\n        student.setGraduate(false);\n        Integer studentId = studentService.insert(student);\n\n        assertEquals(100, studentId);\n    }\n\n    @Test\n    public void getById() {\n        Student student = studentService.getById(3);\n        assertNotNull(student);\n        assertEquals(3, student.getId());\n        assertEquals(\"Judy\", student.getName());\n    }\n}\n</code></pre>"},{"location":"backend/framework/spring_boot/#h2","title":"H2 \u8cc7\u6599\u5eab","text":"<ul> <li>H2 \u8cc7\u6599\u5eab: \u662f\u4e00\u7a2e\u5d4c\u5165\u5f0f\u8cc7\u6599\u5eab\uff0c\u53ef\u4ee5\u518d\u555f\u52d5 Spring Boot \u6642\u88ab\u751f\u6210\u51fa\u4f86\uff0c\u5728\u904b\u884c\u7d50\u675f\u6642\u88ab\u92b7\u6bc0\uff0c\u7528\u5b8c\u5373\u4e1f<ul> <li>\u907f\u514d\u57f7\u884c\u6e2c\u8a66\u6642\uff0c\u53d7\u5230\u5916\u90e8\u8cc7\u6599\u5eab\u7684\u5f71\u97ff (e.g. MySQL)</li> <li>\u5e38\u7528\u5728\u55ae\u5143\u6e2c\u8a66\u4e2d\uff0c\u4e0d\u9700\u8981\u984d\u5916\u5b89\u88dd\u4efb\u4f55\u8edf\u9ad4\uff0c\u90fd\u53ef\u4ee5\u904b\u884c\u8a72\u55ae\u5143\u6e2c\u8a66</li> </ul> </li> <li>\u8a2d\u5b9a\u5957\u4ef6\u7ba1\u7406\u7684\u8a2d\u5b9a\u6a94 (<code>pom.xml</code>)<ul> <li>\u4f7f\u7528 H2 \u8cc7\u6599\u5eab (\u5b98\u7db2\u9023\u7d50: maven h2)     XML<pre><code>&lt;!-- \u4f7f\u7528 H2 \u8cc7\u6599\u5eab --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.h2database&lt;/groupId&gt;\n    &lt;artifactId&gt;h2&lt;/artifactId&gt;\n    &lt;version&gt;2.2.224&lt;/version&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre></li> </ul> </li> <li>\u4f7f\u7528 H2 \u8cc7\u6599\u5eab\u7684\u9023\u7dda\u8a2d\u5b9a (<code>test/</code> \u8cc7\u6599\u593e\u4e2d\u7684 <code>application.properties</code>)     Properties<pre><code># \u4f7f\u7528 H2 \u8cc7\u6599\u5eab\nspring.datasource.driver-class-name=org.h2.Driver\n# \u9023\u7dda\u5230 H2 \u8cc7\u6599\u5eab\u7684 testdb\nspring.datasource.url=jdbc:h2:mem:testdb\n# \u5be6\u52d9\u4e0a\uff0c\u5e38\u7528 `sa` \u4f5c\u70ba\u6e2c\u8a66\u7528\u5e33\u5bc6\nspring.datasource.username=sa\nspring.datasource.password=sa\n\n# \u82e5\u4f7f\u7528 Spring Data JPA\uff0c\u8981\u52a0\u4e0a\u4ee5\u4e0b\u9019\u884c\uff0c\u4ee5\u907f\u514d Spring Boot \u5728\u57f7\u884c H2 sql \u8a9e\u6cd5\u6642\uff0c\u5f71\u97ff\u5230 Hibernate \u7684\u8a2d\u5b9a\n# spring.jpa.hibernate.ddl-auto: none\n</code></pre></li> <li>\u5efa\u7acb H2 \u8cc7\u6599\u5eab\u7684\u6e2c\u8a66\u7528 schema, data<ul> <li><code>schema.sql</code> \u5fc5\u9808\u653e\u5728 <code>test/resources/</code> \u8cc7\u6599\u593e\u4e2d\uff0c\u5efa\u7acb table SQL<pre><code># \u8a18\u5f97\u52a0\u4e0a IF NOT EXISTS\uff0c\u907f\u514d\u91cd\u8907\u5efa\u7acb table\nCREATE TABLE IF NOT EXISTS student (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(30),\n    score DOUBLE,\n    graduate BOOLEAN,\n    create_date TIMESTAMP\n);\n</code></pre></li> <li><code>data.sql</code> \u5fc5\u9808\u653e\u5728 <code>test/resources/</code> \u8cc7\u6599\u593e\u4e2d\uff0c\u7528\u65bc\u63d2\u5165\u6578\u64da SQL<pre><code># \u9700\u6ce8\u610f H2 sql \u8a9e\u6cd5\u8207 MySQL \u8a9e\u6cd5\uff0c\u53ef\u80fd\u6703\u6709\u4e9b\u8a31\u4e0d\u540c\nINSERT INTO student (name, score, graduate, create_date) VALUES ('Amy', 90.3, true, '2021-09-01 10:20:33');\nINSERT INTO student (name, score, graduate, create_date) VALUES ('Rom', 34.6, false, '2021-08-10 17:21:14');\nINSERT INTO student (name, score, graduate, create_date) VALUES ('Judy', 100.0, true, '2021-09-05 12:19:48');\nINSERT INTO student (name, score, graduate, create_date) VALUES ('Mike', 87.2, true, '2021-09-03 15:01:15');\n</code></pre></li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#_5","title":"\u55ae\u5143\u6e2c\u8a66\u7d93\u9a57\u8ac7","text":"<ul> <li>\u55ae\u5143\u6e2c\u8a66\u7684\u6578\u91cf\uff0c\u4e0d\u662f\u8d8a\u591a\u8d8a\u597d<ul> <li>\u55ae\u5143\u6e2c\u8a66\u4e5f\u662f\u7a0b\u5f0f\uff0c\u7a0b\u5f0f\u8d8a\u591a\uff0c\u5c31\u8868\u793a\u7dad\u8b77\u6210\u672c\u4e5f\u8d8a\u9ad8</li> <li>\u55ae\u5143\u6e2c\u8a66\u7684\u91cd\u8981\u7a0b\u5ea6 = \u5f71\u97ff\u4f7f\u7528\u8005\u7684\u7a0b\u5ea6\uff0c\u4f7f\u7528\u983b\u7387\u8d8a\u9ad8\u7684\u529f\u80fd\uff0c\u8d8a\u9700\u8981\u55ae\u5143\u6e2c\u8a66</li> </ul> </li> <li>\u8996\u7522\u696d\u3001\u5c08\u6848\u985e\u578b\uff0c\u4f86\u6c7a\u5b9a\u8981\u5beb\u591a\u5c11\u55ae\u5143\u6e2c\u8a66<ul> <li>\u91d1\u878d\u696d: \u80fd\u6e2c\u591a\u7d30\u5c31\u591a\u7d30\uff0c\u9322\u5f88\u91cd\u8981</li> <li>\u8edf\u9ad4\u696d: \u4f7f\u7528 MockMvc \u6e2c\u8a66\u5404\u500b API \u7684\u529f\u80fd\u662f\u5426\u904b\u4f5c\u6b63\u5e38</li> <li>\u91cd\u8981\u7684 Service \u5c64\uff0c\u53ef\u4ee5\u52a0\u4e00\u4e9b\u5c08\u5c6c\u7684\u55ae\u5143\u6e2c\u8a66</li> <li>Dao \u5c64\u6bd4\u8f03\u5c11\u6e2c\uff0c\u4f46\u5982\u679c\u6709\u8907\u96dc\u7684 sql \u8a9e\u6cd5\uff0c\u53ef\u4ee5\u984d\u5916\u6dfb\u52a0\u6e2c\u8a66</li> </ul> </li> <li>\u5f9e User story \u7684\u89d2\u5ea6\u51fa\u767c\uff0c\u4f86\u601d\u8003\u8a72\u5982\u4f55\u5beb\u55ae\u5143\u6e2c\u8a66<ul> <li>\u7d93\u9a57: \u4e0d\u8981\u5728\u5be6\u4f5c\u5b8c\u76f4\u63a5\u5beb\u55ae\u5143\u6e2c\u8a66\uff0c\u53ef\u4ee5\u4f11\u606f\u4e00\u4e0b\u518d\u56de\u4f86\u5beb\uff0c\u514d\u5f97\u947d\u725b\u89d2\u5c16</li> </ul> </li> <li>\u4e00\u5b9a\u8981\u8a18\u5f97\u6e2c\u8a66 Error case!<ul> <li>e.g. \u5728\u6e2c\u8a66 <code>getById()</code> method \u6642\uff0c\u53ef\u4ee5\u6e2c\u8a66\u7576 id \u4e0d\u5b58\u5728\u6642\u600e\u9ebc\u8655\u7406? \u7576 id \u7684\u9577\u5ea6\u8d85\u904e\u9650\u5236\u6642\u600e\u9ebc\u8655\u7406?</li> <li>\u5be6\u4f5c Error handling \u662f\u958b\u767c\u4e2d\u6700\u96e3\u7684\u4e00\u90e8\u5206</li> </ul> </li> <li>\u5584\u7528 Run Test With Coverage\uff0c\u67e5\u770b\u55ae\u5143\u6e2c\u8a66\u7684\u8986\u84cb\u7bc4\u570d<ul> <li>\u4e0d\u8981\u70ba\u4e86\u55ae\u7d14\u63d0\u5347\u6e2c\u8a66\u8986\u84cb\u7387\u800c\u5beb\u55ae\u5143\u6e2c\u8a66\uff0c\u800c\u662f\u8981\u53cd\u904e\u4f86\u601d\u8003\u662f\u5426\u6709\u54ea\u4e9b\u4f7f\u7528\u5834\u666f\u9084\u6c92\u8003\u616e\u5230</li> <li>\u4e0d\u8981\u88ab\u6578\u5b57\u8ff7\u60d1\uff0c\u4e26\u4e0d\u662f\u4e00\u5b9a\u8981 100% \u8986\u84cb\u7387\u624d\u662f\u5b8c\u7f8e\uff0c\u53ea\u8981\u78ba\u4fdd\u91cd\u8981\u7684\u529f\u80fd\u6709\u88ab\u6e2c\u5230\u5373\u53ef</li> </ul> </li> <li>\u5982\u679c\u6e2c\u8a66\u4e2d\u4f7f\u7528\u7684 @SpyBean \u904e\u591a\uff0c\u8868\u793a\u529f\u80fd\u5207\u5206\u7684\u4e0d\u5920\u597d<ul> <li>\u76e1\u91cf\u5f9e\u529f\u80fd\u9762\u53bb\u5340\u5206 Service (e.g. ProductService, OrderService, UserService)</li> <li>\u548c\u5916\u90e8\u670d\u52d9\u6709\u95dc\u7684 API call\uff0c\u7368\u7acb\u6210\u4e00\u500b Service<ul> <li>e.g. \u8207 YouTube \u6709\u95dc\u7684 API call\uff0c\u5c31\u7d71\u4e00\u653e\u5728 YouTubeService \u88e1\u9762</li> </ul> </li> <li>\u9760\u7d93\u9a57\u591a\u7d2f\u7a4d\uff0c\u624d\u80fd\u5920\u66f4\u597d\u7684\u5207\u5206\u529f\u80fd</li> </ul> </li> </ul>"},{"location":"backend/framework/spring_boot/#_6","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>Spring \u5b98\u65b9\u7db2\u7ad9-Guides</li> <li>Developer Roadmaps-Spring Boot Developer</li> <li>Hahow-Spring Boot \u96f6\u57fa\u790e\u5165\u9580\u8ab2\u7a0b (\u53e4\u541b\u8473)<ul> <li>\u53e6\u6709\u5728 iT \u90a6\u5e6b\u5fd9\u9435\u4eba\u8cfd-Spring Boot \u96f6\u57fa\u790e\u5165\u9580 \u7cfb\u5217 \u767c\u8868\u6587\u7ae0</li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/","title":"Domain Driven Design (\u9818\u57df\u9a45\u52d5\u8a2d\u8a08)","text":"<p>DDD \u7684\u57fa\u672c\u89c0\u5ff5 &amp; \u5be6\u4f5c\u7bc4\u4f8b</p> \u76ee\u9304<ul> <li>Domain Driven Design (\u9818\u57df\u9a45\u52d5\u8a2d\u8a08)<ul> <li>DDD \u5b78\u7fd2\u8def\u5f91</li> <li>\u8853\u8a9e\u8868<ul> <li>Strategic Design \u6230\u7565\u8a2d\u8a08</li> <li>Tactical Design \u6230\u8853\u8a2d\u8a08<ul> <li>\u9818\u57df\u7269\u4ef6 (Domain Object)</li> </ul> </li> <li>\u5176\u4ed6\u76f8\u95dc\u540d\u8a5e</li> <li>Event Storming \u4e8b\u4ef6\u98a8\u66b4</li> </ul> </li> <li>DDD \u57fa\u672c\u6982\u5ff5<ul> <li>DDD \u67b6\u69cb\u7684\u5168\u8c8c\u5716</li> <li>\u6230\u7565\u8a2d\u8a08 (Strategic Design)</li> <li>\u6230\u8853\u8a2d\u8a08 (Tactical Design)</li> </ul> </li> <li>DDD \u5be6\u4f5c\u7bc4\u4f8b<ul> <li>\u96fb\u5546\u7684 Bounded Context<ul> <li>\u95dc\u9375\u4f7f\u7528\u6848\u4f8b</li> <li>\u4ee5\u4e0b\u662f\u53ef\u80fd\u7684 Context Mapping \u5716 (\u8a2d\u8a08\u6c92\u6709\u6b63\u78ba\u7b54\u6848)</li> </ul> </li> <li>\u4fdd\u96aa\u516c\u53f8<ul> <li>\u984c\u76ee</li> <li>\u4e00\u5bb6\u4fdd\u96aa\u516c\u53f8\u9700\u8981\u4ee5\u4e0b\u5e7e\u500b Bounded Context</li> <li>\u5b98\u65b9\u5716\u89e3</li> </ul> </li> <li>\u96fb\u5f71\u9662<ul> <li>\u984c\u76ee</li> <li>\u521d\u6b65 Bounded Context \u5716\u89e3</li> <li>\u95dc\u9375\u4f7f\u7528\u6848\u4f8b</li> <li>\u8a73\u7d30 Bounded Context \u5716\u89e3</li> <li>\u88dc\u5145</li> </ul> </li> </ul> </li> <li>\u4e8b\u4ef6\u98a8\u66b4</li> <li>\u89c0\u5ff5\u91d0\u6e05<ul> <li>\u8acb\u8aaa\u660e Subdomain \u8207 Bounded Context \u9593\u7684\u5dee\u5225?</li> <li>\u8acb\u8aaa\u51fa Context Mapping \u7684\u6240\u6709\u6a21\u5f0f\u4ee5\u53ca\u5927\u81f4\u7684\u529f\u80fd?</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/#ddd","title":"DDD \u5b78\u7fd2\u8def\u5f91","text":""},{"location":"backend/system_design/ddd/#_1","title":"\u8853\u8a9e\u8868","text":""},{"location":"backend/system_design/ddd/#strategic-design","title":"Strategic Design \u6230\u7565\u8a2d\u8a08","text":"<ul> <li>Domain (\u9818\u57df):<ul> <li>\u5de5\u4f5c\u4e0a\u7528\u5230\u7684\u554f\u984c (problem space) + \u89e3\u6cd5 (solution space)\u3002 Problem Space \u4ee3\u8868\u8457 \u9818\u57df\u8981\u89e3\u6c7a\u7684\u554f\u984c\uff0c\u800c\u6211\u5011\u9700\u8981\u9032\u4e00\u6b65\u5206\u89e3\u5b83\u6210\u6578\u500b Subdomain\uff0c\u4e26\u4f9d\u7167\u512a\u5148\u5ea6\u8207\u5916\u5305\u7a0b\u5ea6\u5206\u70ba\uff1a Core Domain\u3001Supporting Subdomain\u3001Generic Subdomain\u3002</li> <li>Solution Space \u4ee3\u8868 \u9818\u57df\u7684\u89e3\u6c7a\u65b9\u6848\uff0c\u6211\u5011\u6703\u5728\u88e1\u9762\u958b\u767c\u591a\u500b Domain Models \u4f86\u89e3\u6c7a\u554f\u984c\u3002\u800c Domain odels \u9700\u8981\u88ab\u9694\u96e2\u5728 Bounded Context \u4e2d\u4ee5\u4fdd\u8b49 Model \u8207 Ubiquitous Language \u7684\u4e00\u81f4\u6027\u3002</li> </ul> </li> <li>Ubiquitous Language (\u901a\u7528\u8a9e\u8a00):<ul> <li>\u7528\u65bc\u63cf\u8ff0\u696d\u52d9\u9818\u57df\u7684\u55ae\u4e00\u8a9e\u8a00\uff0c\u8b93\u6240\u6709\u8207\u5c08\u6848\u76f8\u95dc\u7684\u5229\u5bb3\u95dc\u4fc2\u4eba \u4e00 \u8edf\u9ad4\u5de5\u7a0b\u5e2b (PG)\u3001\u7522\u54c1\u8ca0\u8cac\u4eba (PM)\u3001\u9818\u57df\u5c08\u5bb6 (domain expert)\u3001UI/UX \u8a2d\u8a08\u5e2b\uff0c\u80fd\u5920\u4e0d\u4f9d\u8cf4\u8f49\u8b6f\uff0c\u6709\u6548\u6e9d\u901a\u3002</li> </ul> </li> <li>Bounded Context (\u9650\u754c\u4e0a\u4e0b\u6587):<ul> <li>\u4e00\u500b\u53ef\u4ee5\u8b93\u8eab\u8655\u5176\u4e2d\u7684\u55ae\u5b57\u6216\u53e5\u5b50 \u7372\u5f97\u5b8c\u6574\u610f\u7fa9 \u7684\u74b0\u5883\u3002\u4ee5 \u8a9e\u610f \u4f5c\u70ba\u908a\u754c\uff0c\u4f86\u907f\u514d \u540c\u4e00\u500b\u540d\u8a5e\u5728\u4e0d\u540c\u7684\u8a9e\u5883 (Context) \u5e95\u4e0b\u90fd\u6703\u6709\u4e0d\u540c\u7684\u5b9a\u7fa9\u3002 \u672c\u8cea\u4e0a\uff0c\u5c31\u662f\u4e00\u500b \u8a9e\u610f\u4e0a\u7684\u908a\u754c\u3002</li> <li>\u5c0d\u65bc\u627e\u51fa Bounded Context\uff0c\u4e3b\u8981\u4ee5 \u8a9e\u610f \u8207 \u696d\u52d9\u80fd\u529b \u4f86\u91cd\u9ede\u3002\u53ef\u4ee5\u5f9e\u627e\u51fa\u90a3\u4e9b\u4f7f\u7528\u76f8\u8fd1\u6982\u5ff5\u7684\u540d\u8a5e\u8207\u5728\u4e0d\u540c\u60c5\u5883\u4e0b\u7684\u6703\u6709\u6b67\u7570\u7684\u540d\u8a5e\u4e0b\u624b\uff0c\u540c\u6642\u4e5f\u53ef\u4ee5\u85c9\u7531\u5206\u6790\u7cfb\u7d71\u529f\u80fd\u7684\u6b65\u9a5f\u4f86\u89e3\u6790\u51fa Bounded Context\u3002</li> </ul> </li> <li>Context Mapping (\u4e0a\u4e0b\u6587\u5730\u5716):<ul> <li>\u7528\u65bc\u5354\u8abf\u4e0d\u540c\u7684 Bounded Contexts\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u89e3\u6c7a\u4e0d\u540c Bounded Contexts \u4e4b\u9593\u7684\u885d\u7a81\u3001\u8a9e\u610f\u4e0d\u4e00\u81f4\u3001\u5354\u4f5c\u7684\u554f\u984c\u3002</li> </ul> </li> <li>Domain Model (\u9818\u57df\u6a21\u578b):<ul> <li>\u6cdb\u6307\u90a3\u4e9b\u7528\u4f86\u89e3\u6c7a Domain \u554f\u984c\u7684\u89e3\u6c7a\u65b9\u6848 (e.g. \u7a0b\u5f0f\u78bc\u3001UML \u5716\u3001\u5176\u4ed6 Artifacts)\u3002</li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/#tactical-design","title":"Tactical Design \u6230\u8853\u8a2d\u8a08","text":""},{"location":"backend/system_design/ddd/#domain-object","title":"\u9818\u57df\u7269\u4ef6 (Domain Object)","text":"<p>\u4e3b\u8981\u662f\u91dd\u5c0d\u7a0b\u5f0f\u78bc\u5be6\u4f5c\u4e2d Domain layer \u5167\u7684 class</p> <ul> <li>\u5be6\u9ad4 (Entity):      -\u80fd\u88ab\u8b58\u5225\u51fa\u4f86\u7684\u7269\u4ef6 \u6709 id\u3002 Entity \u7684\u72c0\u614b\u6703\u5728\u5176\u751f\u547d\u9031\u671f\u4e2d\u6301\u7e8c\u8ffd\u8e64\u5176\u8b8a\u5316\u3002</li> <li>\u503c\u7269\u4ef6 (Value Object): <ul> <li>\u7121 identity \u6982\u5ff5\u3001\u72c0\u614b\u4e0d\u53ef\u8b8a\u66f4\u7684\u7269\u4ef6 object\uff0c\u7528\u65bc\u63cf\u8ff0\u67d0\u500b\u4e8b\u7269\u7684\u7279\u5fb5\u3002</li> </ul> </li> <li>\u805a\u5408 (Aggregate): <ul> <li>\u7531\u76f8\u95dc\u696d\u52d9\u76ee\u6a19\u7684\u7269\u4ef6\u5305\u542b Entity \u8207 Value Object \u6240\u7d44\u6210\uff0c\u4e00\u500b\u805a\u5408\u5373\u70ba\u4e00\u500b Transaction \u7684\u908a\u754c\u3002\u4e26\u4e14\u6703\u5728\u5176\u4e2d\u9078\u64c7\u4e00\u500b\u5be6\u9ad4\u4f5c\u70ba\u805a\u5408\u6839 Aggregate Root \uff0c\u6240\u6709\u8207\u5916\u754c\u7684\u6e9d\u901a\u90fd\u5fc5\u9808\u4ea4\u7531 Aggregate Root \u4f86\u8ca0\u8cac\u3002</li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/#_2","title":"\u5176\u4ed6\u76f8\u95dc\u540d\u8a5e","text":"<ul> <li>\u5009\u5132 (Repository):<ul> <li>\u9019\u662f\u4e00\u500b\u4fdd\u5b58\u9818\u57df\u7269\u4ef6\u7684\u72c0\u614b\u7684\u8a2d\u8a08\u6a21\u5f0f\uff0c\u53ef\u4ee5\u8f49\u63a5\u8cc7\u6599\u5eab\u3001 ORM \u6216\u6a94\u6848\u7cfb\u7d71\u3002\u4e00\u822c\u4f7f\u7528\u4e0a\u6703\u8003\u616e\u4e00\u500b\u805a\u5408\u5c0d\u4e0a\u4e00\u500b\u5009\u5132\u3002</li> </ul> </li> <li>\u5de5\u5ee0 (Factory):<ul> <li>\u540c GoF \u7684\u5de5\u5ee0\u6a23\u5f0f\uff0c\u5728 DDD \u4e2d\u7528\u65bc\u8655\u7406\u805a\u5408\u751f\u6210\u8f03\u70ba\u8907\u96dc\u7684\u60c5\u5883\u3002</li> </ul> </li> <li>\u9818\u57df\u4e8b\u4ef6 (Domain Event):<ul> <li>\u67d0\u4ef6\u9818\u57df\u5c08\u5bb6\u5728\u4e4e\u7684\u4e8b\u4ef6\uff0c\u901a\u5e38\u7528\u65bc\u805a\u5408\u9593\u7684\u6e9d\u901a\u3002</li> </ul> </li> <li>\u9818\u57df\u670d\u52d9 (Domain Service):<ul> <li>\u7576\u6709\u67d0\u500b\u696d\u52d9\u908f\u8f2f\u8077\u8cac \u7121\u6cd5\u88ab\u6b78\u985e \u5230\u4efb\u4f55\u4e00\u500b\u9818\u57df\u7269\u4ef6\u4e0a\u6642\uff0c\u6703\u5c07\u4ee5\u9818\u57df\u670d\u52d9\u627f\u8f09\u9019\u500b\u8077\u8cac\u3002\u8655\u65bc\u61c9\u7528\u670d\u52d9\u8207\u9818\u57df\u7269\u4ef6\u4e4b\u9593\u3002</li> </ul> </li> <li>\u61c9\u7528\u670d\u52d9 (Application Service):<ul> <li>\u7b49\u540c\u65bc\u7cfb\u7d71\u7684\u4f7f\u7528\u6848\u4f8b\uff0c\u4e3b\u8981\u8ca0\u8cac\u6280\u8853\u7d30\u7bc0\u4e26\u547c\u53eb\u9818\u57df\u7269\u4ef6\u6216\u9818\u57df\u670d\u52d9\u8655\u7406\u696d\u52d9\u908f\u8f2f\u3002</li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/#event-storming","title":"Event Storming \u4e8b\u4ef6\u98a8\u66b4","text":"<ul> <li>\u6a58\u8272(\u6b63\u65b9\u5f62)\uff1aEvent \u4e8b\u4ef6</li> <li>\u85cd\u8272(\u6b63\u65b9\u5f62)\uff1aCommand \u547d\u4ee4</li> <li>\u7d2b\u8272(\u9577\u65b9\u5f62)\uff1a Policy \u653f\u7b56</li> <li>\u9ec3\u8272(\u5c0f\u5f35\u9577\u65b9\u5f62)\uff1aActor \u89d2\u8272</li> <li>\u9ec3\u8272(\u9577\u65b9\u5f62)\uff1aAggregate \u805a\u5408</li> <li>\u7c89\u7d05\u8272(\u9577\u65b9\u5f62)\uff1aExternal System \u5916\u90e8\u7cfb\u7d71</li> <li>\u7d05\u8272(\u6b63\u65b9\u5f62)\uff1aHotspot \u71b1\u9ede</li> <li>\u7d05\u8272(\u5c0f\u5f35\u9577\u65b9\u5f62)\uff1aProblem \u7591\u554f</li> <li>\u7da0\u8272(\u5c0f\u5f35\u9577\u65b9\u5f62)\uff1aOpportunity \u6a5f\u6703</li> <li>\u7da0\u8272(\u6b63\u65b9\u5f62)\uff1aRead Model \u8cc7\u6599\u8b80\u53d6\u6a21\u578b</li> <li>\u767d\u8272(\u5927\u5f35\u6b63\u65b9\u5f62)\uff1aUset Interface \u4f7f\u7528\u8005\u4ecb\u9762</li> </ul> <ul> <li> <p>\u4e8b\u4ef6 (Event):</p> <ul> <li> <p>\u4ee3\u8868 \u5df2\u7d93\u767c\u751f\u904e\u7684\u4e8b\u60c5\uff0c\u901a\u5e38\u6703\u4f7f\u7528 \u904e\u53bb\u5f0f (\u82f1\u6587\u52a0 -ed \uff0c\u4e2d\u6587\u52a0\u300c\u5df2\u300d)\uff0c\u4f8b\u5982: \u5982\u8a02\u55ae\u5df2\u6210\u7acb\u3001\u8ca8\u7269\u5df2\u9001\u51fa\u3001\u65e9\u9910\u5df2\u8cb7\u5230 \u7b49\u7b49\u3002</p> </li> <li> <p>\u9818\u57df\u5c08\u5bb6\u6240\u5728\u4e4e\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982: \u6574\u5408\u7b2c\u4e09\u65b9\u7269\u6d41\u6642\uff0c\u9818\u57df\u5c08\u5bb6\u53ef\u80fd\u53ea\u5728\u4e4e\u9001\u9054\u6642\u9593\u800c\u4e0d\u5728\u4e4e\u4e2d\u9593\u7d30\u7bc0\u7684\u904b\u8f38\u904e\u7a0b\u3002</p> </li> <li> <p>\u6709 \u6642\u9593\u6027\uff0c\u8acb \u5f9e\u5de6\u5230\u53f3 \u6392\u5217\u3002</p> </li> <li> <p>\u53ef\u4ee5\u52a0\u4e0a \u6642\u9593\u6982\u5ff5\u3002\u4f8b\u5982: \u300c\u51cc\u6668\u4e09\u9ede\u5e33\u6b3e\u5df2\u5c0d\u5e33\u5b8c\u6210\u300d\u3001\u300c\u5348\u591c\u5341\u4e8c\u9ede\u99ac\u8eca\u5df2\u8b8a\u6210\u5357\u74dc\u300d\uff0c\u751a\u81f3\u662f\u67d0\u500b\u6642\u9593\u9ede\uff0c\u5982\u300c\u672c\u5b63\u5ea6\u5df2\u7d50\u675f\u300d\u3001\u300c\u5df2\u904e\u4e86\u4e00\u500b\u6708\u300d\u3002</p> </li> <li> <p>\u53ef\u4ee5\u52a0\u4e0a \u539f\u56e0\u3002\u4f8b\u5982:\u300c\u56e0\u70ba\u5bc6\u78bc\u8f38\u5165\u932f\u8aa4\u4e09\u6b21\uff0c\u6240\u4ee5\u5e33\u865f\u5df2\u88ab\u9396\u4f4f\u300d\u3002</p> </li> </ul> <p>\u6839\u64da Alberto Brandolini \u672c\u4eba\u7684\u6558\u8ff0\uff0c\u4f7f\u7528 \u904e\u53bb\u5f0f\u4ee3\u8868\u8457\u7cfb\u7d71\u7684\u72c0\u614b\u3002\u5982\u679c\u4f60\u4eca\u5929\u4f7f\u7528\u7684\u662f\u300c\u8a3b\u518a\u300d\u9019\u985e\u8a5e\u6642\uff0c\u4f60\u4ee3\u8868\u7684\u662f\u4e00\u500b\u6d41\u7a0b\u3002\u76f8\u5c0d\u7684\uff0c\u7528\u300c\u8a3b\u518a\u5df2\u958b\u59cb\u300d\u3001\u300c\u8a3b\u518a\u5df2\u5b8c\u6210\u300d\u6703\u6709\u66f4\u597d\u7684\u6e05\u6670\u5ea6\u4e14\u9846\u7c92\u5ea6\uff0c\u907f\u514d\u904e\u5ea6\u8a2d\u8a08\u3002</p> <p></p> </li> <li> <p>\u547d\u4ee4 (Command): </p> <ul> <li>\u662f\u4ec0\u9ebc\u884c\u70ba\u89f8\u767c \u4e86\u4e8b\u4ef6\u6216\u4e8b\u4ef6\u6d41</li> <li>\u5927\u90e8\u5206\u7684 Command \u8207 Event \u90fd\u50cf\u662f\u5c0d\u7a31\u7684\u5b58\u5728\u3002\u4f8b\u5982: \u300c\u5df2\u7d93\u8cb7\u65e9\u9910\u300dEvent \u524d\u9762\u5c31\u6703\u52a0\u4e0a\u4e00\u500b\u300c\u8cb7\u65e9\u9910\u300dCommand\u3002\u7576\u7136\uff0cCommand \u4e00\u5b9a\u7531\u67d0\u500b\u4f7f\u7528\u8005\uff08\u5be6\u969b\u7684\u4eba\u3001\u865b\u64ec\u7684\u7cfb\u7d71\uff09\u6240\u767c\u51fa\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u5c0f\u5f35\u7684\u9ec3\u8272 Actor \u5beb\u4e0a\u4f7f\u7528\u8005\u540d\u7a31\u7136\u5f8c\u8cbc\u5728\u5c0d\u61c9\u7684 Command\u3002 </li> </ul> </li> <li> <p>\u653f\u7b56 (Policy):</p> <ul> <li>\u5c31\u662f\u6211\u5011\u7684 \u7cfb\u7d71\u5c0d\u65bc\u7279\u5b9a Event \u5982\u4f55\u56de\u61c9\u3002</li> <li>\u627e\u51fa\u898f\u5247\u3001\u6f5b\u898f\u5247\u4ee5\u53ca\u81ea\u52d5\u5316 (listener, saga, process modeliing)\u3002</li> <li>\u8edf\u9ad4\u4e4b\u6240\u4ee5\u6709\u50f9\u503c\uff0c\u5c31\u662f\u56e0\u70ba\u4ed6\u53ef\u4ee5\u5c07\u5f88\u591a \u5546\u696d\u908f\u8f2f\u81ea\u52d5\u5316\u3002</li> <li>Policy \u5c31\u50cf Event Storming \u7684\u5075\u63a2\u4e00\u6a23\uff0c\u53ef\u4ee5 \u627e\u51fa\u8a31\u591a\u5c1a\u672a\u767c\u6398\u7684\u554f\u984c\u6216\u662f\u73fe\u6709\u6d41\u7a0b\u77db\u76fe\u4e4b\u8655\u3002</li> <li>\u8a9e\u6cd5\u516c\u5f0f: \u300c\u51e1\u662f Event \u5c31 Command\u300d(Whenever Event Then Command)\uff0c\u6240\u4ee5\u6703\u63a5\u5728\u67d0\u500b Event \u5f8c\u9762\u7136\u5f8c\u89f8\u767c\u4e00\u500b\u81f3\u591a\u500b Command\u3002\u751a\u81f3\u53ef\u4ee5\u52a0\u4e0a\u984d\u5916\u7684\u689d\u4ef6\u5982\u300c\u51e1\u662f...\u4f46\u5982\u679c...\u5c31...\u300d\u3002 <p>\u4ee5\u8a02\u55ae\u7cfb\u7d71\u70ba\u4f8b - \u7576\u300c\u8a02\u55ae\u5df2\u5c0d\u5e33\u300dEvent \u767c\u51fa\u5f8c\u5c31\u6703\u89f8\u767c Policy \u300c\u51e1\u8a02\u55ae\u5df2\u5c0d\u5e33\uff0c\u5c31\u5bc4\u4fe1\u901a\u77e5\u300d - \u300c\u51e1\u8a02\u55ae\u5df2\u5c0d\u5e33\uff0c\u5c31\u66f4\u6539\u8a02\u55ae\u5e33\u6b3e\u8cc7\u8a0a\u300d</p> </li> <li>Fun Fact: Policy \u7684\u7d2b\u8272 (lilac) \u4ee3\u8868 Event \u8207 Command \u984f\u8272\u6df7\u5408\u3002 </li> </ul> </li> <li>\u89d2\u8272 (Actor):</li> <li>\u4ee3\u8868 \u4f7f\u7528\u8005\uff0c\u53ef\u4ee5\u662f \u771f\u5be6\u7684\u4eba(e.g. \u5ba2\u6236\u3001\u7ba1\u7406\u54e1\u3001\u7de8\u8f2f)\uff0c\u6216\u662f \u865b\u64ec\u7684\u7cfb\u7d71\u3002</li> <li> <p>\u901a\u5e38\u6703\u5728 Command \u4e0a\u8cbc\u4e0a Actor \u7684\u540d\u7a31\uff0c\u8868\u793a\u9019\u500b Command \u662f\u7531\u8ab0\u767c\u51fa\u7684\u3002</p> </li> <li> <p>\u805a\u5408 (Aggregate):</p> <ul> <li>\u4e00\u65e6\u6240\u6709\u7684 Event\u3001Command \u90fd\u88ab\u8868\u793a\u51fa\u4f86\uff0c\u53c3\u8207\u8005\u5c31\u53ef\u4ee5\u958b\u59cb\u8003\u616e \u5c07\u76f8\u95dc\u7684\u6982\u5ff5\u7d44\u7e54\u8d77\u4f86\u3002</li> <li>\u805a\u5408\u6703 \u63a5\u6536\u547d\u4ee4\uff0c\u4e26 \u7522\u751f\u4e8b\u4ef6\u3002 </li> </ul> </li> <li> <p>\u5916\u90e8\u7cfb\u7d71 (External System):</p> <ul> <li>\u5728\u7cfb\u7d71\u958b\u767c\u4e2d\uff0c\u96e3\u514d\u6703\u9700\u8981\u8207\u5916\u90e8\u7cfb\u7d71\u5408\u4f5c\u5b8c\u6210\u529f\u80fd\uff0c\u4ee5\u64f4\u5145\u6a21\u578b\u3002\u9019\u500b\u5916\u90e8\u53ef\u80fd\u662f\u516c\u53f8\u88e1\u7684\u53e6\u4e00\u500b\u7cfb\u7d71\u3001\u7b2c\u4e09\u65b9\u670d\u52d9\u3001\u751a\u81f3\u662f\u6cd5\u689d(e.g. GDPR)\u3002</li> <li>System \u901a\u5e38\u662f\u7531 Command \u6240\u89f8\u767c(e.g. \u7b2c\u4e09\u65b9\u91d1\u6d41\u5916\u90e8\u670d\u52d9\u7531\u300c\u4ed8\u6b3e\u300d\u89f8\u767c)\uff0c\u7136\u5f8c System \u6703\u518d\u7522\u751f\u65b0\u7684 Event\u3002</li> <li>\u9019\u908a \u9818\u57df\u5c08\u5bb6\u9700\u8981\u6ce8\u610f\uff0c\u4ed6 \u8981\u5c07\u5c6c\u65bc\u5916\u90e8\u7cfb\u7d71\u4e0d\u5c6c\u65bc\u81ea\u5df1\u7cfb\u7d71\u95dc\u6ce8\u7684 Event \u79fb\u51fa\uff0c\u6bd4\u5982\u8aaa\u5916\u90e8\u7269\u6d41\u7cfb\u7d71\u53ef\u80fd\u6709\u300c\u8cb7\u5bb6\u63c0\u8ca8\u300d\u3001\u300c\u8d85\u5546\u62d2\u6536\u300d\u3001\u300c\u8d85\u5546\u9a57\u8ca8\u300d\u3001\u300c\u9001\u8ca8\u4e2d\u300d\u3001\u300c\u5546\u54c1\u5df2\u5230\u6307\u5b9a\u8d85\u5546\u300d\u7b49\u7b49 Event\uff0c\u4f46 \u4e8b\u5be6\u4e0a\u4f60\u7684\u7cfb\u7d71\u53ef\u80fd\u53ea\u5728\u4e4e\u4ed6\u6700\u5f8c\u5230\u8ca8\u7684 Event\u3002</li> <li>\u540c\u6642\uff0c System \u4e5f\u6703\u89f8\u767c\u4e0d\u540c\u5206\u652f\u7684 Event \uff0c\u5c31\u50cf\u662f \u5916\u90e8\u7cfb\u7d71\u7e3d\u6709\u6210\u529f or \u5931\u6557\u7684\u53ef\u80fd\uff0c\u6b64\u6642\u9818\u57df\u5c08\u5bb6\u8207\u8207\u6703\u8005\u5c31\u8981\u4e00\u8d77\u601d\u8003\u5931\u6557\u7684\u8655\u7406\u8def\u7dda\u662f\u5426\u662f\u7cfb\u7d71\u6240\u95dc\u6ce8\u7684\u3002 </li> </ul> </li> <li> <p>\u71b1\u9ede (hotspot):</p> <ul> <li>\u5982\u679c\u904e\u7a0b\u4e2d\u67d0\u500b\u7bc0\u9ede\u5361\u4f4f\u592a\u4e45\uff0c\u5f88\u6709\u53ef\u80fd\u662f\u56e0\u70ba\u9818\u57df\u5c08\u5bb6\u4e5f\u4e0d\u592a\u4e86\u89e3\u9019\u500b\u554f\u984c\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u76ee\u524d\u8cc7\u6599\u91cf\u4e0d\u8db3\u4ee5\u505a\u51fa\u6c7a\u5b9a\u3002\u53ef\u4ee5\u5148\u8cbc\u4e0a\u4e00\u5f35 45 \u5ea6\u89d2\u65cb\u8f49\u5f8c\u7684\u7d05\u8272\u7684 Hotspot \u5f85\u65e5\u5f8c\u89e3\u6c7a\u3002</li> <li>\u4e00\u822c\u4f86\u8aaa\uff0cHotspot \u4e00\u65b9\u9762\u4ee3\u8868\u4f60\u7684 \u7cfb\u7d71\u7684\u91cd\u5927\u6311\u6230\uff0c\u53e6\u4e00\u65b9\u9762 \u5982\u679c\u80fd\u5920\u89e3\u6c7a\u5b83\u5c31\u80fd\u70ba\u7cfb\u7d71\u5e36\u4f86\u5de8\u5927\u7684\u50f9\u503c\u3002\u56e0\u6b64\u5728\u9019\u4e00\u56de\u5408\uff0c\u5927\u5bb6\u53ef\u4ee5 \u85c9\u6b64\u4e86\u89e3\u7cfb\u7d71\u7684\u6838\u5fc3\u554f\u984c\u5728\u54ea\u3002</li> </ul> </li> <li> <p>Problem (\u554f\u984c):</p> <ul> <li>\u4ee3\u8868\u4f60\u89ba\u5f97\u6709\u7591\u554f\u3001\u6210\u672c\u9ad8\u3001\u6703\u51fa\u932f\u7684\u5730\u65b9\u3002\u6211\u5011\u53ef\u4ee5\u5728 Question \u5beb\u4e0a\u7c21\u77ed\u7684\u6558\u8ff0\u3002</li> <li>\u5e38\u898b\u7684\u554f\u984c\u6709:<ul> <li>\u6211\u770b\u4e0d\u61c2</li> <li>\u5546\u696d\u908f\u8f2f\u6709\u554f\u984c</li> <li>\u8207\u73fe\u6709\u5c08\u6848\u67b6\u69cb\u4e0d\u5408</li> <li>\u6703\u9020\u6210\u4f7f\u7528\u8005\u4e0d\u723d</li> </ul> </li> </ul> </li> <li> <p>Opportunity (\u6a5f\u6703):</p> <ul> <li>\u4ee3\u8868\u4f60\u89ba\u5f97\u6d41\u7a0b\u4e2d\u5f88\u68d2\u7684\u90e8\u5206\uff0c\u5c31\u50cf\u662f\u6309\u8b9a\u4e00\u6a23\u4e0d\u7528\u5ba2\u6c23\u8cbc\u4e0a\u53bb\u5427! <p>\u6a19\u8a18\u5b8c\u5f8c\uff0c\u4e3b\u6301\u4eba\u53ef\u4ee5\u958b\u59cb\u8b93\u5927\u5bb6\u91dd\u5c0d\u4e00\u500b\u500b Problem\u3001Opportunity \u4f86\u8a0e\u8ad6</p> </li> </ul> </li> <li> <p>Read Model \u8cc7\u6599\u8b80\u53d6\u6a21\u578b:</p> <ul> <li>\u662f Domain \u5167\u7684\u8cc7\u6599\u6aa2\u8996\u3002</li> <li>\u6709\u6642\u5019\uff0c\u7576\u6211\u5011\u9700\u8981\u505a\u6c7a\u7b56\u7684\u6642\u5019\uff0c\u6703\u9700\u8981\u4e00\u4e9b\u8cc7\u6599\u53c3\u8003\u4f9d\u64da\u3002\u4e5f\u5c31\u662f Actor \u6703\u5148\u67e5\u770b Read Model \u5f8c\uff0c\u624d\u6703\u57f7\u884c Command </li> <li>\u8acb\u8a18\u5f97\uff0cRead Model \u4e0d\u53ea\u662f\u8cc7\u6599\uff0c\u540c\u6642\u4e5f\u662f\u505a\u6c7a\u7b56\u7684\u5de5\u5177</li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/#ddd_1","title":"DDD \u57fa\u672c\u6982\u5ff5","text":"<p>\u6838\u5fc3\u7cbe\u795e: Think in context. (\u5728\u8108\u7d61\u4e2d\u601d\u8003)</p>"},{"location":"backend/system_design/ddd/#ddd_2","title":"DDD \u67b6\u69cb\u7684\u5168\u8c8c\u5716","text":"<ul> <li>\u5718\u968a\u8207\u9818\u57df\u5c08\u5bb6\u6e9d\u901a\u53ca\u5408\u4f5c \u6355\u6349\u9818\u57df\u77e5\u8b58 \u4e26\u4e14\u5efa\u69cb \u901a\u7528\u8a9e\u8a00 (Ubiquitous Language)\u3002</li> <li>\u4f9d\u7167\u6240\u7406\u89e3\u7684 \u554f\u984c\u57df (Problem Space) \u4ee5\u53ca \u89e3\u6c7a\u65b9\u6848\u57df(Solution Space) \u7684\u8cc7\u8a0a\u5efa\u7acb \u9818\u57df (Domain)\u3002</li> <li>\u5c07\u9818\u57df (Domain)\u5207\u6210\u82e5\u5e72\u500b \u5b50\u9818\u57df (Subdomain) \uff0c\u4e26\u5b9a\u7fa9\u6bcf\u4e00\u500b\u5b50\u9818\u57df\u7684\u512a\u5148\u7b49\u7d1a\u3002</li> <li>\u5728\u5b50\u9818\u57df\u4e2d\u9075\u5faa\u901a\u7528\u8a9e\u8a00\u5c07\u89e3\u6c7a\u65b9\u6848\u57df\u5207\u5206\u51fa\u4e00\u500b\u500b\u8a9e\u610f\u7684\u908a\u754c\uff1a\u9650\u754c\u4e0a\u4e0b\u6587 (Bounded Context)\u3002</li> <li>\u4f7f\u7528 \u4e0a\u4e0b\u6587\u5730\u5716 (Context Mapping) \u6a21\u5f0f\u5b9a\u7fa9\u4e0d\u540c\u9650\u754c\u4e0a\u4e0b\u6587\u4e4b\u9593\u7684\u4e92\u52d5\u6a21\u5f0f \u3002</li> </ul>"},{"location":"backend/system_design/ddd/#strategic-design_1","title":"\u6230\u7565\u8a2d\u8a08 (Strategic Design)","text":""},{"location":"backend/system_design/ddd/#tactical-design_1","title":"\u6230\u8853\u8a2d\u8a08 (Tactical Design)","text":""},{"location":"backend/system_design/ddd/#ddd_3","title":"DDD \u5be6\u4f5c\u7bc4\u4f8b","text":""},{"location":"backend/system_design/ddd/#bounded-context","title":"\u96fb\u5546\u7684 Bounded Context","text":""},{"location":"backend/system_design/ddd/#_3","title":"\u95dc\u9375\u4f7f\u7528\u6848\u4f8b","text":"<ul> <li>\u8cfc\u7269\u8eca\u7d50\u5e33\u6642\u8981 \u5224\u65b7\u6703\u54e1\u7b49\u7d1a\uff0c\u82e5\u662f VIP \u5247\u6703\u6709\u76f8\u61c9\u7684\u6298\u6263</li> <li>\u700f\u89bd\u5546\u54c1 \u6642\uff0c\u90e8\u5206\u5546\u54c1\u53ea\u80fd \u88ab\u90e8\u5206\u7b49\u7d1a\u7684\u5ba2\u4eba\u770b\u5230\u3002\u6bd4\u5982\u8aaa\u5927\u91cf\u9999\u83f8\u7d44\u5408\u5305\u53ea\u80fd\u88ab\u83c1\u82f1\u6703\u54e1\u700f\u89bd</li> <li>\u8cfc\u7269\u8eca\u7d50\u5e33\u6642\u9700\u8981\u5f9e\u5546\u54c1\u76ee\u9304 \u53d6\u5f97\u5546\u54c1\u8cc7\u8a0a \u4f86\u8a08\u7b97\u50f9\u9322</li> <li>\u8cfc\u7269\u6642\u9700\u8981\u900f\u904e \u7b2c\u4e09\u65b9\u652f\u4ed8 \u4f86\u8655\u7406\u91d1\u6d41</li> <li>\u9700\u8981\u6574\u5408 \u7b2c\u4e09\u65b9\u7269\u6d41 \u8b93\u5ba2\u4eba\u77e5\u9053\u7269\u6d41\u9032\u5ea6</li> <li>\u71df\u6536\u5206\u6790\u7cfb\u7d71 \u9700\u8981\u8207\u8cfc\u7269\u7cfb\u7d71\u5171\u4eab\u8cc7\u6599</li> </ul>"},{"location":"backend/system_design/ddd/#context-mapping","title":"\u4ee5\u4e0b\u662f\u53ef\u80fd\u7684 Context Mapping \u5716 (\u8a2d\u8a08\u6c92\u6709\u6b63\u78ba\u7b54\u6848)","text":""},{"location":"backend/system_design/ddd/#_4","title":"\u4fdd\u96aa\u516c\u53f8","text":""},{"location":"backend/system_design/ddd/#_5","title":"\u984c\u76ee","text":"<ul> <li>GitHub: \u984c\u76ee</li> </ul>"},{"location":"backend/system_design/ddd/#bounded-context_1","title":"\u4e00\u5bb6\u4fdd\u96aa\u516c\u53f8\u9700\u8981\u4ee5\u4e0b\u5e7e\u500b Bounded Context","text":"<ul> <li>Customer Management \u5ba2\u6236\u7ba1\u7406<ul> <li>\u5ba2\u6236\u7ba1\u7406\u7cfb\u7d71\u8981\u7ba1\u7406\u6240\u6709\u4fdd\u96aa\u516c\u53f8\u5ba2\u6236\u7684\u8cc7\u6599\u3002\u56e0\u6b64\uff0c\u4ed6\u901a\u5e38\u5728\u8207\u5176\u4ed6 Bounded Context \u95dc\u4fc2\u4e2d\u7684\u4e2d\u5fc3</li> </ul> </li> <li>Customer Self-Service Management \u5ba2\u6236\u81ea\u52a9\u670d\u52d9<ul> <li>\u9019\u500b Bounded Context \u662f\u4e00\u500b Web \u61c9\u7528\u7a0b\u5f0f\uff0c\u53ef\u4ee5\u8b93\u5ba2\u6236\u767b\u5165\u4e26\u4fee\u6539\u57fa\u672c\u8cc7\u6599\u5982\u5730\u5740</li> </ul> </li> <li>Policy Management \u4fdd\u55ae\u7ba1\u7406<ul> <li>\u4fdd\u55ae\u7ba1\u7406 Bounded Context \u7ba1\u7406\u5ba2\u6236\u6240\u7c3d\u7684\u4fdd\u96aa\u5951\u7d04\u8207\u4fdd\u55ae\u3002\u4ed6\u6703\u8207 Risk Management \u4e00\u8d77\u5408\u4f5c\u53d6\u5f97\u5ba2\u6236\u7684\u98a8\u96aa\u6578\u64da\u4f86\u8a08\u7b97\u8cbb\u7387\u3002\u6b64\u5916\uff0c\u4ed6\u4e5f\u9700\u8981\u8207 Debt Collection \u5171\u4eab\u5167\u6838</li> </ul> </li> <li>Debt Collection \u61c9\u6536\u5e33\u6b3e<ul> <li>\u6b64 Bounded Context \u4f9d\u64da\u76f8\u5c0d\u61c9\u7684\u5951\u7d04\u8207\u4fdd\u55ae\u4f86\u8a08\u7b97\u4fdd\u96aa\u516c\u53f8\u7684\u8ca1\u52d9\u6536\u5165</li> </ul> </li> <li>Risk Management \u98a8\u96aa\u7ba1\u7406<ul> <li>\u6b64 Bounded Context \u8207 Policy Management \u5bc6\u5207\u5408\u4f5c\uff0c\u4e14\u8a08\u7b97\u51fa\u7684\u98a8\u96aa\u8cc7\u8a0a\u6703\u5f71\u97ff\u4fdd\u96aa\u5951\u7d04\u8207\u4fdd\u55ae</li> </ul> </li> <li>Printing Context \u5217\u5370\u529f\u80fd<ul> <li>\u4ee3\u8868\u4e00\u500b\u5916\u90e8\u7cfb\u7d71\u8b93\u8a31\u591a\u5167\u90e8\u7684 Bounded Context \u53ef\u4ee5\u900f\u904e API \u4f86\u4f7f\u7528\u3002\u4ed6\u8655\u7406\u90a3\u4e9b\u9700\u8981\u5217\u5370\u7684\u6587\u4ef6\u5982\u50b5\u52d9 (Debt)\u3001\u4fdd\u55ae\u7b49\u7b49</li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/#_6","title":"\u5b98\u65b9\u5716\u89e3","text":""},{"location":"backend/system_design/ddd/#_7","title":"\u96fb\u5f71\u9662","text":""},{"location":"backend/system_design/ddd/#_8","title":"\u984c\u76ee","text":"<ul> <li>\u9700\u6c42 (\u771f\u5be6\u4e16\u754c\u7684\u60c5\u5883): </li> <li>\u6211\u5e0c\u671b\u80fd\u5920\u6210\u7acb\u4e00\u5bb6\u96fb\u5f71\u9662\uff0c\u9019\u500b\u96fb\u5f71\u9662\u5fc5\u9808\u8981\u6709 \u552e\u7968\u4ead \u53ef\u4ee5\u552e\u7968\u7d66\u9867\u5ba2</li> <li>\u552e\u7968\u6642\uff0c\u54e1\u5de5\u8981\u6aa2\u67e5 \u9867\u5ba2\u7684\u8eab\u5206\u8b49\u3001\u6642\u9593\u3001\u96fb\u5f71\u3001\u5ea7\u4f4d \u7b49\u7b49</li> <li>\u7136\u5f8c\u56e0\u61c9 APP \u7684\u98a8\u6f6e\uff0c\u6240\u4ee5\u6211\u5011\u60f3\u8981\u8ddf \u7b2c\u4e09\u65b9\u8a02\u7968\u8edf\u9ad4 \u5408\u4f5c\uff0c\u5229\u7528\u7dda\u4e0a\u9810\u7d04\u73fe\u5834\u552e\u7968\u8655\u53d6\u7968</li> <li>\u7576\u7136\uff0c\u96fb\u5f71\u9662\u4e00\u5b9a\u8981\u6709 \u653e\u6620\u5ef3\uff0c\u8981\u9032\u53bb\u653e\u6620\u5ef3\u524d\u6703\u6709\u54e1\u5de5 \u6aa2\u67e5\u6d88\u8cbb\u8005\u7684\u7968 \u662f\u5426\u7b26\u5408\u76ee\u524d\u64ad\u653e\u7684\u96fb\u5f71</li> <li>\u518d\u4f86\uff0c \u5ba2\u4eba\u5728\u552e\u7968\u8655\u8cb7\u96fb\u5f71\u7968\u6642\u4e5f\u53ef\u4ee5\u6dfb\u52a0 \u98df\u7269\u5957\u9910\uff0c\u7136\u5f8c\u4f60\u53ef\u4ee5\u6191\u7968\u53bb \u98f2\u98df\u90e8 \u63db\u53d6\u4f60\u7684\u98df\u7269\uff0c\u98f2\u98df\u90e8\u9700\u8981\u8207\u552e\u7968\u8655\u7368\u7acb\u51fa\u4f86\uff0c\u56e0\u70ba\u98f2\u98df\u90e8\u9084\u9700\u8981 \u7ba1\u7406\u98df\u7269\u7684\u5eab\u5b58</li> </ul>"},{"location":"backend/system_design/ddd/#bounded-context_2","title":"\u521d\u6b65 Bounded Context \u5716\u89e3","text":"<ul> <li>Domain</li> <li>Core Domain: Movie(\u653e\u6620\u5ef3)</li> <li>Supporting Subdomain: Ticket(\u552e\u7968)\u3001Food(\u98df\u7269)   </li> </ul>"},{"location":"backend/system_design/ddd/#_9","title":"\u95dc\u9375\u4f7f\u7528\u6848\u4f8b","text":"<ul> <li>\u552e\u7968\u4ead\u53ef\u4ee5\u552e\u7968\u7d66\u5ba2\u4eba\uff0c\u5ba2\u4eba\u53ef\u4ee5\u9078\u64c7\u96fb\u5f71\u3001\u6642\u523b\u3001\u5ea7\u4f4d\u4ee5\u53ca\u662f\u5426\u6dfb\u52a0\u5957\u9910</li> <li>\u552e\u7968\u4ead\u54e1\u5de5\u552e\u7968\u524d\uff0c\u8981\u6aa2\u67e5\u5ba2\u4eba\u7684\u8eab\u5206\u8b49\u4ee5\u7b26\u5408\u96fb\u5f71\u5206\u7d1a</li> <li>\u5ba2\u4eba\u53ef\u4ee5\u7528 APP \u7dda\u4e0a\u9810\u7d04\u8a02\u7968\u8207\u9910\u9ede\uff0c\u7136\u5f8c\u5230\u73fe\u5834\u552e\u7968\u4ead\u53d6\u7968</li> <li>\u5ba2\u4eba\u9032\u5165\u653e\u6620\u5ef3\u524d\uff0c\u653e\u6620\u5ef3\u54e1\u5de5\u8981\u5728\u9580\u53e3\u67e5\u7968\uff0c\u78ba\u8a8d\u597d\u96fb\u5f71\u6642\u523b\u8207\u5ea7\u4f4d\u5f8c\u624d\u80fd\u653e\u5ba2\u4eba\u9032\u53bb</li> <li>\u5ba2\u4eba\u8981\u5230\u98f2\u98df\u90e8\u6191\u7968\u624d\u80fd\u514c\u63db\u5230\u98df\u7269\uff0c\u98f2\u98df\u90e8\u54e1\u5de5\u8981\u4f9d\u96fb\u5f71\u7968\u4e0a\u7684\u9910\u9ede\u54c1\u9805\u88fd\u4f5c\u9910\u9ede</li> <li>\u7576\u98f2\u98df\u90e8\u4efb\u4f55\u98df\u7269\u5eab\u5b58\u4f4e\u65bc 50% \u6642\uff0c\u8981\u901a\u77e5\u5eab\u5b58\u7ba1\u7406\u90e8\u88dc\u8ca8\u3002\u65e9\u4e0a\u901a\u77e5\u4e0b\u5348\u88dc\u8ca8\uff0c\u4e0b\u5348\u901a\u77e5\u9694\u5929\u65e9\u4e0a\u88dc\u8ca8</li> </ul>"},{"location":"backend/system_design/ddd/#bounded-context_3","title":"\u8a73\u7d30 Bounded Context \u5716\u89e3","text":"<ul> <li>Box Office Context \u552e\u7968\u8655</li> <li>Online Booking \u7dda\u4e0a\u8a02\u7968</li> <li>Concession Stand Context \u98f2\u98df\u90e8</li> <li>Inventory Context \u5eab\u5b58\u7ba1\u7406</li> <li>Auditorium Context \u653e\u6620\u5ef3 </li> </ul>"},{"location":"backend/system_design/ddd/#_10","title":"\u88dc\u5145","text":"<ul> <li>\u63a5\u8005\u7576\u4f60\u958b\u59cb\u5728 Bounded Context \u4e2d\u958b\u767c Domain Model \u6642\uff0c\u53ef\u4ee5\u767c\u73fe\u4e00\u4ef6\u6709\u8da3\u7684\u4e8b\u60c5:<ul> <li>\u4e00\u500b\u96fb\u5f71\u7968\u5238\u5728\u4e0d\u540c\u7684 Bounded Context \u4e2d\u6709\u4e0d\u4e00\u6a23\u7684\u884c\u7232 (\u4e00\u500b Ticket \u5404\u81ea\u8868\u8ff0) </li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/#_11","title":"\u4e8b\u4ef6\u98a8\u66b4","text":""},{"location":"backend/system_design/ddd/#_12","title":"\u89c0\u5ff5\u91d0\u6e05","text":""},{"location":"backend/system_design/ddd/#subdomain-bounded-context","title":"\u8acb\u8aaa\u660e Subdomain \u8207 Bounded Context \u9593\u7684\u5dee\u5225?","text":"<ul> <li>Subdomain \u4f60\u5c07\u5546\u696d\u9700\u6c42\u62c6\u89e3\u8207\u5206\u985e\u7684\u7d50\u679c; Bounded Context \u4ee3\u8868\u4f60\u5be6\u969b\u89e3\u6c7a\u554f\u984c\u7684\u7cfb\u7d71\u62c6\u89e3\u8207\u5206\u985e</li> <li>\u6709\u6642\u5019\u9019\u5169\u8005\u7dca\u7dca\u76f8\u95dc\u5f88\u5bb9\u6613\u641e\u6df7\uff0c\u4f46\u4ed6\u5011\u7684\u78ba\u662f\u4e0d\u540c\u7684\u6771\u897f\u3002\u53ef\u4ee5\u53c3\u8003 DDD \u4e4b\u7236 Eric Evans \u5728\u9019\u7bc7 youtube video \u7684\u7c21\u77ed\u56de\u7b54\u3002\u88e1\u9762\u63d0\u5230\uff1a<ul> <li>\u9019\u5c31\u50cf\u5730\u677f\u8207\u5730\u6bef\u7684\u95dc\u4fc2\u3002\u5730\u677f\u662f Subdomain\uff0c Bounded Context \u662f\u5730\u6bef\u3002\u7576\u4f60\u525b\u88dd\u4fee\u597d\u65b0\u5bb6\u5c31\u50cf\u525b\u555f\u52d5\u5c08\u6848\u6642\uff0c\u5730\u6bef\u8a2d\u8a08\u8207\u5730\u677f\u5b8c\u5168\u5339\u914d\uff0c\u6240\u4ee5\u4f60\u5f88\u96e3\u767c\u89ba\u4ed6\u5011\u7684\u5dee\u7570\u3002\u4f46\u5169\u8005\u7684\u78ba\u662f\u4e0d\u540c\u7684\u6771\u897f</li> <li>\u4f46\u6709\u4e00\u5929\u4f60\u63db\u4e86\u4e00\u500b\u65b0\u5730\u6bef\uff0c\u5b83\u53ef\u80fd\u7121\u6cd5\u767e\u5206\u767e\u8207\u5730\u677f\u5339\u914d\uff0c\u6703\u9732\u51fa\u4e00\u4e9b\u5730\u677f\u7684\u539f\u8c8c\uff0c\u751a\u81f3\u6703\u88ab\u4e00\u4e9b\u50a2\u4ff1 (Legacy System) \u7d66\u64cb\u4f4f\uff0c\u8b93\u5169\u8005\u66f4\u96e3\u8cbc\u5408\uff0c\u6b64\u6642\u5169\u8457\u7684\u5dee\u7570\u624d\u6703\u6f38\u6f38\u6d6e\u73fe</li> </ul> </li> <li>\u88dc\u5145\u8aaa\u660e <p>\u5f15\u7528 Patterns, Principles, and Practices of Domain-Driven Design (\u7c21\u7a31 3PoDDD) \u88e1\u9762\u5c0d\u65bc Subdomain \u8207 Bounded Context \u5dee\u5225\u7684\u8ad6\u8ff0</p> <ul> <li>Subdomain \u4ee3\u8868\u8457\u4e00\u584a\u908f\u8f2f\u4e0a\u7684\u9700\u6c42\u57df\uff0c\u901a\u5e38\u4f86\u8aaa\u53cd\u6620\u51fa\u4f01\u696d\u7d44\u7e54\u67b6\u69cb\u7684\u696d\u52d9\u80fd\u529b\u3002\u4ed6\u5011\u88ab\u7528\u4f86\u5340\u5225\u61c9\u7528\u7a0b\u5f0f\u4e0d\u540c\u91cd\u8981\u7a0b\u5ea6\u7684\u90e8\u5206\u5982 Core Domain \u4ee5\u53ca\u7a0d\u5fae\u4e0d\u91cd\u8981\u7684 Supporting Subdomain\u3002Subdomain \u662f\u7528\u4f86\u63d0\u7149\u51fa\u554f\u984c\u7a7a\u9593\u7684\u7cbe\u83ef\u4e26\u89e3\u69cb\u5176\u4e2d\u7684\u8907\u96dc</li> <li>Domain Model \u5247\u662f\u88ab\u5efa\u7acb\u4f86\u6eff\u8db3\u5404\u500b Subdomain \u7684\u4f7f\u7528\u6848\u4f8b\u3002\u7406\u60f3\u4e0a Model \u8207 Subdomain \u9593\u6703\u6709\u4e00\u6bd4\u4e00\u7684\u5c0d\u61c9\u95dc\u4fc2\uff0c\u4f46\u662f\u5f88\u96e3\u5be6\u73fe\u3002Model \u6703\u53d7\u5230\u7d44\u7e54\u67b6\u69cb\u3001\u8a9e\u8a00\u7684\u6a21\u7cca\u6027\u3001\u5546\u696d\u6d41\u7a0b\u6216\u662f\u958b\u767c\u6a21\u5f0f\u7684\u5f71\u97ff\u3002\u56e0\u6b64\u4e00\u500b Subdomain \u53ef\u80fd\u6703\u5305\u542b\u4e00\u500b\u81f3\u591a\u500b Model \uff0c\u800c\u4e00\u500b Model \u4e5f\u6709\u53ef\u80fd\u8de8\u8d8a\u591a\u500b Subdomain\u3002\u9019\u7a2e\u4e8b\u60c5\u5f88\u5e38\u898b\u65bc Legacy System \u7684\u74b0\u5883\u4e2d</li> <li>Models \u9700\u8981\u88ab\u9694\u96e2\u4e26\u5728\u4e00\u500b\u660e\u78ba\u7684(explicit)\u908a\u754c\u5167\u88ab\u5b9a\u7fa9\uff0c\u5982\u6b64\u624d\u80fd\u8b93 Model \u4e0d\u53d7\u6c61\u67d3\u4e14\u5c08\u6ce8\u3002\u5c31\u50cf\u524d\u9762\u6240\u8aaa\uff0c\u9019\u5c31\u662f\u6211\u5011\u7684 Bounded Context\u3002 \u4e0d\u50cf\u662f Subdomain\uff0c\u4e00\u500b Bounded Context \u662f\u4e00\u500b\u80fd\u4fdd\u8b49 Model \u9593\u908a\u754c\u7684\u5177\u9ad4\u7684\u6280\u8853\u5be6\u4f5c\u3002 Bounded Context \u5b58\u5728\u65bc Subdomain \u4e2d\u4e26\u5728\u5176\u4e2d\u660e\u78ba\u7684\u8868\u9054 Domain Models \u7684\u542b\u7fa9\u3002</li> </ul> </li> </ul>"},{"location":"backend/system_design/ddd/#context-mapping_1","title":"\u8acb\u8aaa\u51fa Context Mapping \u7684\u6240\u6709\u6a21\u5f0f\u4ee5\u53ca\u5927\u81f4\u7684\u529f\u80fd?","text":"<ul> <li>Shared Kernel: \u5171\u7528\u7a0b\u5f0f\u78bc     </li> <li>Partnership: \u96d9\u65b9\u96d9\u5411\u5408\u4f5c     </li> <li>Anti-corruption Layer: \u70ba\u4e0b\u6e38\u65b9\u5efa\u7acb\u4e00\u5c64\u8cc7\u6599\u8f49\u63db\u5c64\u4ee5\u6d88\u5316\u4f86\u81ea\u4e0a\u6e38\u7684\u8cc7\u6599     </li> <li>Open Host Service/Published Language: \u5728\u4e0a\u6e38\u65b9\u5efa\u7acb\u4e00\u500b\u958b\u653e\u7684 API \u8b93\u60f3\u4f7f\u7528\u7684\u4e0b\u6e38\u65b9\u4f7f\u7528     </li> <li>Separate Way: \u5169\u8005\u6c92\u6709\u76f4\u63a5\u7684\u5408\u4f5c\u95dc\u4fc2</li> <li>Big Ball of Mud: \u5c07\u4e00\u5718\u6df7\u4e82\u7684\u5927\u7cfb\u7d71\u756b\u4e0b\u908a\u754c\uff0c\u5728\u908a\u754c\u5167\u4e0d\u8981\u8e81\u9032\u6539\u8b8a\uff0c\u5728\u908a\u754c\u5916\u8981\u505a\u597d ACL \u8f49\u63db</li> <li>Customer-Supplier: \u6709\u4e0a\u4e0b\u6e38\u95dc\u4fc2\u4f46\u4e0a\u6e38\u65b9\u5c0d\u4e0b\u6e38\u65b9\u4ecd\u4fdd\u6709\u4e00\u5b9a\u8cac\u4efb     </li> <li>Conformist: \u6709\u4e0a\u4e0b\u6e38\u95dc\u4fc2\u4f46\u4e0a\u6e38\u65b9\u5c0d\u65bc\u4e0b\u6e38\u65b9\u6c92\u6709\u8cac\u4efb     </li> </ul>"},{"location":"backend/system_design/ddd/#_13","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>iT \u90a6\u5e6b\u5fd9: Think in Domain-Driven Design \u7cfb\u5217</li> </ul>"},{"location":"cloud/aws/saa/","title":"AWS --- SAA \u8b49\u7167\u8003\u8a66","text":"<p>\u91cd\u9ede\u6574\u7406</p> \u76ee\u9304<ul> <li>AWS --- SAA \u8b49\u7167\u8003\u8a66<ul> <li>AWS Certified Solutions Architect Associate (SAA-C03)</li> </ul> </li> </ul>"},{"location":"cloud/aws/saa/#aws-certified-solutions-architect-associate-saa-c03","title":"AWS Certified Solutions Architect Associate (SAA-C03)","text":""},{"location":"cloud/k8s/cka/","title":"Kubernetes \u4e00 CKA \u8b49\u7167\u8003\u8a66","text":"<p>\u91cd\u9ede\u6574\u7406</p> \u76ee\u9304<ul> <li>Kubernetes \u4e00 CKA \u8b49\u7167\u8003\u8a66<ul> <li>Introduction</li> <li>Core Concepts<ul> <li>Cluster Architecture</li> <li>Master Node<ul> <li>etcd</li> <li>kube-apiserver</li> <li>kube-controller-manager</li> <li>kube-scheduler</li> </ul> </li> <li>Worker Node<ul> <li>kubelet</li> <li>kube-proxy</li> <li>Pod</li> </ul> </li> <li>ReplicaSet</li> <li>Deployment</li> <li>Service</li> <li>Namespace</li> <li>Imperative vs. Declarative</li> </ul> </li> <li>Scheduling<ul> <li>Manual Scheduling</li> <li>Labels &amp; Selectors &amp; Annotations</li> <li>Taints &amp; Tolerations</li> <li>Node Selectors</li> <li>Node Affinity</li> <li>combine Taints &amp; Tolerations &amp; Node Affinity</li> <li>Resource requests &amp; limits</li> <li>DaemonSet</li> <li>Static Pods</li> <li>Multiple Schedulers</li> <li>Configuring Scheduler Profiles</li> </ul> </li> <li>Logging &amp; Monitoring<ul> <li>Logging</li> <li>Monitoring</li> </ul> </li> <li>Application Lifecycle Management<ul> <li>Rolling Updates and Rollbacks in Deployments<ul> <li>Deployment-Rollout Strategy</li> </ul> </li> <li>Configure Applications<ul> <li>ConfigMap</li> <li>Secrets</li> </ul> </li> <li>Scale Applications<ul> <li>Multi-Container Pod</li> </ul> </li> <li>Self-Healing Application</li> </ul> </li> <li>Cluster Maintenance<ul> <li>Cluster Upgrade Process</li> <li>Operating System Upgrades</li> <li>Backup and Restore Methodologies</li> </ul> </li> <li>Security<ul> <li>Kubernetes Security Primitives</li> <li>Authentication</li> <li>TLS certificates for cluster components<ul> <li>K8s Certificate API</li> <li>kubeconfig</li> </ul> </li> <li>Authorization<ul> <li>K8s API groups</li> <li>Authorization Mechanisms</li> <li>RBAC authorization</li> <li>Check Access Control</li> <li>Resource Names</li> <li>Cluster Roles</li> <li>Service Account</li> </ul> </li> <li>Images Security</li> <li>Security Contexts</li> <li>Network Policies</li> </ul> </li> <li>Storage<ul> <li>Introduction of Docker Storage</li> <li>Volume</li> <li>Persistent Volume</li> <li>Persistent Volume Claim</li> <li>Storage Class</li> </ul> </li> <li>Networking<ul> <li>Networling Prerequisite</li> <li>Pod Networking</li> <li>CNI in K8s</li> <li>CNI-weaveworks</li> <li>IP address management-weaveworks</li> <li>DNS in K8s</li> <li>Ingress</li> </ul> </li> <li>Design K8s Cluster</li> <li>Create K8s cluster using kubeadm tool</li> <li>End to End Tests on K8s Cluster</li> <li>Troubleshooting<ul> <li>Application Failure</li> <li>Control Plane Node Failure</li> <li>Worker Node Failure</li> <li>Networking Failure</li> </ul> </li> <li>Exam Information</li> <li>Exam Tips</li> <li>Reference</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#introduction","title":"Introduction","text":"<ul> <li>\u7531 CNCF \u8207 Linux Foundation \u5408\u4f5c\u7684 Kubernetes \u8b49\u7167\u8003\u8a66<ul> <li>Certified Kubernetes Administrator (CKA): \u5c0d\u65bc Kubernetes \u7ba1\u7406\u8005<ul> <li>Core Concepts</li> <li>HA deployment</li> <li>Kubernetes Scheduler</li> <li>Logging/Monitoring</li> <li>Application Lifecycle</li> <li>Maintenance</li> <li>Security</li> <li>Troubleshooting</li> </ul> </li> <li>Certified Kubernetes Application Developer (CKAD): \u5c0d\u65bc Kubernetes \u958b\u767c\u8005<ul> <li>Core Concepts</li> <li>Config Maps, Secrets</li> <li>Multi-Container Pods</li> <li>Readiness and Liveness Probes</li> <li>Logging/Monitoring</li> <li>Pod Design</li> <li>Jobs</li> <li>Services &amp; Networking</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u8a0a: Frequently Asked Questions: CKA and CKAD &amp; CKS</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#core-concepts","title":"Core Concepts","text":""},{"location":"cloud/k8s/cka/#cluster-architecture","title":"Cluster Architecture","text":"<ul> <li>Master Node<ul> <li>etcd: \u5132\u5b58\u53e2\u96c6\u8cc7\u8a0a</li> <li>kube-scheduler: \u8ca0\u8cac\u6392\u7a0b\u5de5\u4f5c\u7bc0\u9ede\u4e0a\u7684\u61c9\u7528\u7a0b\u5f0f\u6216 container</li> <li>kube-controller-manager: \u8ca0\u8cac\u7ba1\u7406\u4e0d\u540c\u63a7\u5236\u5668\u7684\u529f\u80fd\uff0c\u4f8b\u5982: Node Controller, Replication Controller \u7b49</li> <li>kube-apiserver: \u8ca0\u8cac\u5354\u8abf\u53e2\u96c6\u4e2d\u7684\u6240\u6709\u64cd\u4f5c</li> </ul> </li> <li>Worker Node<ul> <li>kubelet: \u76e3\u807d\u4f86\u81ea kube-apiserver \u7684\u6307\u4ee4\uff0c\u4f86\u7ba1\u7406\u7bc0\u9ede\u4e2d\u7684 container </li> <li>kube-proxy: \u8ca0\u8cac\u7bc0\u9ede\u4e4b\u9593\u7684\u7db2\u8def\u901a\u8a0a  </li> <li>\u5716\u7247\u4f86\u6e90</li> </ul> </li> <li>Docker vs. Containerd<ul> <li>Docker: \u63d0\u4f9b\u5b8c\u6574\u7684 container \u7ba1\u7406\u529f\u80fd\uff0c\u9069\u5408\u5f9e\u958b\u767c\u5230\u751f\u7522\u74b0\u5883\u7684\u6574\u500b container \u751f\u547d\u5468\u671f\u7ba1\u7406 </li> <li>Containerd: \u5c08\u6ce8\u65bc\u9ad8\u6548\u7ba1\u7406 container \u7684\u57f7\u884c\u671f\u9593\uff0c\u4f5c\u70ba Docker \u5f15\u64ce\u7684\u6838\u5fc3\u5143\u4ef6\u4e4b\u4e00\uff0c\u4ea6\u53ef\u4ee5\u7368\u7acb\u4f7f\u7528\u3002<ul> <li>ctr: \u7ba1\u7406 container \u7684 CLI \u5de5\u5177\uff0c\u50c5\u63d0\u4f9b\u57fa\u790e\u7684 container \u7ba1\u7406\u529f\u80fd</li> <li>nerdctl: \u985e\u4f3c\u65bc Docker CLI \u5de5\u5177\uff0c\u63d0\u4f9b\u66f4\u5b8c\u6574\u7684\u529f\u80fd</li> <li>runc: \u662f\u4e00\u500b\u5be6\u73fe OCI \u898f\u7bc4\u7684\u5e95\u5c64\u57f7\u884c\u671f\u9593\u5de5\u5177\uff0c\u8ca0\u8cac\u5be6\u969b\u7684 container \u5275\u5efa\u548c\u904b\u884c </li> <li>\u5716\u7247\u4f86\u6e90</li> </ul> </li> </ul> </li> <li>OCI (Open Container Initiative): \u7531 Linux Foundation \u6240\u63d0\u51fa\u7684\u958b\u653e container \u6a19\u6e96\uff0c\u5305\u542b image-spec\u3001runtime-spec<ul> <li>image-spec: \u898f\u7bc4\u8a72\u5982\u4f55\u5efa\u7acb container image\uff0c\u4ee5\u78ba\u4fdd\u5728\u4e0d\u540c\u57f7\u884c\u74b0\u5883\u4e2d\u53ef\u4ee5\u4e00\u81f4\u5730\u5efa\u7acb container </li> <li>runtime-spec: \u898f\u7bc4\u8a72\u5982\u4f55\u8a2d\u5b9a container runtime\uff0c\u63cf\u8ff0\u5982\u4f55\u5275\u5efa\u3001\u914d\u7f6e\u3001\u7ba1\u7406 container \uff0c\u78ba\u4fdd\u5728\u4e0d\u540c\u7684\u57f7\u884c\u74b0\u5883\u4e2d\uff0c\u53ef\u4ee5\u4e00\u81f4\u5730\u904b\u884c container </li> </ul> </li> <li>K8s CRI (Container Runtime Interface): \u63d0\u4f9b CLI \u7d66\u6240\u6709\u80fd\u8207 OCI \u6a19\u6e96\u6240\u76f8\u5bb9\u7684 container \u57f7\u884c\u74b0\u5883 (e.g. Docker, Containerd, CRI-O)<ul> <li>crictl CLI: \u8207 docker CLI \u6307\u4ee4\u76f8\u4f3c\uff0c\u7528\u4f86\u7ba1\u7406 container \u57f7\u884c\u74b0\u5883</li> <li>\u7528\u9014: \u6aa2\u67e5\u3001\u9664\u932f container \u7684\u57f7\u884c\u74b0\u5883; \u901a\u5e38\u4e0d\u6703\u7528\u4f86\u5efa\u7acb container  </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#master-node","title":"Master Node","text":""},{"location":"cloud/k8s/cka/#etcd","title":"etcd","text":"<ul> <li>\u7528\u9014: \u5132\u5b58 K8s \u53e2\u96c6\u7684\u6240\u6709\u8cc7\u8a0a (e.g. nodes, pods, configs, secrets, accounts, roles, bindings \u7b49)<ul> <li>\u63a1\u7528 Key-Value \u7684\u65b9\u5f0f\u5132\u5b58\u8cc7\u6599</li> <li><code>kubectl get xxx</code> \u6240\u53d6\u5f97\u7684\u8cc7\u6599\uff0c\u90fd\u662f\u5f9e etcd \u4f3a\u670d\u5668\u4e2d\u53d6\u5f97</li> <li>\u9810\u8a2d\u4f7f\u7528 2379 port</li> </ul> </li> <li>etcdctl: \u7528\u4f86\u7ba1\u7406 etcd \u7684 CLI \u5de5\u5177<ul> <li><code>export ETCDCTL_API=3</code>: \u8a2d\u5b9a etcdctl \u7684 API \u7248\u672c\u7684\u74b0\u5883\u8b8a\u6578 (\u76ee\u524d\u6700\u65b0\u70ba v3\uff0c\u6709\u4e9b\u6307\u4ee4\u6703\u8ddf v2 \u4e0d\u540c)</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#kube-apiserver","title":"kube-apiserver","text":"<ul> <li>\u7528\u9014: \u63d0\u4f9b K8s API \u670d\u52d9\uff0c\u8ca0\u8cac\u63a5\u6536\u4f86\u81ea Client \u7684\u8acb\u6c42\uff0c\u4e26\u5c07\u8acb\u6c42\u8f49\u767c\u7d66\u5176\u4ed6\u5143\u4ef6<ul> <li>\u6703\u5148\u8a8d\u8b49\u4f7f\u7528\u8005\u7684\u8eab\u4efd\uff0c\u518d\u9a57\u8b49 API \u8acb\u6c42\u7684\u6b0a\u9650\uff0c\u4e4b\u5f8c\u624d\u6703\u57f7\u884c\u8acb\u6c42\u7684\u64cd\u4f5c</li> <li>\u900f\u904e RESTful API \u8207\u5de5\u4f5c\u7bc0\u9ede\u9032\u884c\u4ea4\u6d41</li> <li>\u9810\u8a2d\u4f7f\u7528 6443 port</li> </ul> </li> <li>\u529f\u80fd:<ul> <li>\u8a8d\u8b49\u4f7f\u7528\u8005</li> <li>\u9a57\u8b49 API \u8acb\u6c42</li> <li>\u50b3\u905e\u8cc7\u6599</li> <li>\u66f4\u65b0 etcd \u8cc7\u8a0a</li> <li>\u900f\u904e kubelet \u8207\u5de5\u4f5c\u7bc0\u9ede\u9032\u884c\u6e9d\u901a </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#kube-controller-manager","title":"kube-controller-manager","text":"<ul> <li>\u7528\u9014: (\u662f\u4e00\u500b process)\uff0c\u6703\u6301\u7e8c\u76e3\u63a7\u53e2\u96c6\u4e2d\u500b\u5de5\u4f5c\u7bc0\u9ede\u7684\u72c0\u614b\uff0c\u4e26\u76e1\u529b\u4f7f\u53e2\u96c6\u7dad\u6301\u5728\u9810\u671f\u7684\u72c0\u614b</li> <li>\u5728\u4e3b\u7bc0\u9ede\u4e0a\uff0ckube-controller-manager \u6703\u5305\u542b\u8a31\u591a\u500b contoller\uff0c\u6bcf\u500b controller \u8ca0\u8cac\u7ba1\u7406\u4e0d\u540c\u7684\u63a7\u5236\u5668<ul> <li>Node Controller: \u8ca0\u8cac\u7ba1\u7406\u7bc0\u9ede\u7684\u72c0\u614b\uff0c\u63a1\u53d6\u5fc5\u8981\u63aa\u65bd\u4ee5\u7dad\u6301\u53e2\u96c6\u6b63\u5e38\u904b\u884c</li> <li>Replication Controller: \u8ca0\u8cac\u76e3\u63a7 replicasets \u7684\u72c0\u614b\uff0c\u4e26\u78ba\u4fdd\u5728\u4efb\u4f55\u6642\u523b\u4e0b pods \u7684\u6578\u91cf\u90fd\u7b26\u5408 replicasets \u7684\u8a2d\u5b9a</li> <li>\u5176\u5b83 controllers </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#kube-scheduler","title":"kube-scheduler","text":"<ul> <li>\u7528\u9014: \u6839\u64da\u5404\u7bc0\u9ede\u7684\u8cc7\u6e90\u72c0\u614b\uff0c\u5c07 pod \u6392\u7a0b\u5230\u9069\u7576\u7684\u7bc0\u9ede\u4e0a<ul> <li>kube-scheduler \u50c5\u8ca0\u8cac\u6c7a\u5b9a pod \u8981\u5b89\u6392\u5230\u54ea\u500b\u7bc0\u9ede\u4e0a; \u800c\u5be6\u969b\u5c07 pod \u653e\u7f6e\u5230\u7bc0\u9ede\u4e0a\u7684\u5de5\u4f5c\uff0c\u662f\u7531 kubelet \u5b8c\u6210</li> </ul> </li> <li>\u6392\u7a0b\u904e\u7a0b<ul> <li>\u6839\u64da\u6bcf\u500b\u7bc0\u9ede\u7684\u8cc7\u6e90\u72c0\u614b\uff0c\u904e\u6ffe\u51fa\u7b26\u5408\u7576\u524d\u8cc7\u6e90\u8981\u6c42\u7684\u7bc0\u9ede\u5011</li> <li>\u900f\u904e priority function\uff0c\u8a08\u7b97\u6bcf\u500b\u7bc0\u9ede\u7684\u5206\u6578\uff0c\u9078\u64c7\u5206\u6578\u6700\u9ad8\u7684\u7bc0\u9ede\uff0c\u512a\u5148\u5c07 pod \u5b89\u6392\u5230\u8a72\u7bc0\u9ede\u4e0a </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#worker-node","title":"Worker Node","text":""},{"location":"cloud/k8s/cka/#kubelet","title":"kubelet","text":"<ul> <li>\u7528\u9014: \u8ca0\u8cac\u7ba1\u7406\u3001\u76e3\u63a7\u5de5\u4f5c\u7bc0\u9ede\u5167\u7684 pod\uff0c\u4ee5\u53ca pod \u4e2d\u7684 container \u72c0\u614b\uff0c\u4e26\u8207\u4e3b\u7bc0\u9ede\u9032\u884c\u901a\u8a0a<ul> <li>\u6703\u5b9a\u671f\u5411\u4e3b\u7bc0\u9ede\u56de\u5831\u7bc0\u9ede\u7684\u72c0\u614b</li> </ul> </li> <li>\u6d41\u7a0b: kube-scheduler -&gt; kube-apiserver -&gt; kubelet -&gt; Docker     </li> <li>kubeadm \u9810\u8a2d\u4e0d\u6703\u90e8\u7f72 kubelet\uff0c\u9700\u8981\u624b\u52d5\u5b89\u88dd\u4e26\u90e8\u7f72 kubelet<ul> <li>\u4e0b\u8f09 kubelet:     Bash<pre><code>wget https://storage.googleapis.com/kubernetes-release/release/v1.13.0/bin/linux/amd64/kubelet\n</code></pre> </li> <li>\u89e3\u58d3\u7e2e:     Bash<pre><code>tar -xvf kubelet\n</code></pre></li> <li>\u57f7\u884c kubelet \u670d\u52d9</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#kube-proxy","title":"kube-proxy","text":"<ul> <li>\u7528\u9014: (\u662f\u4e00\u500b process)\uff0c\u6703\u904b\u884c\u5728\u6bcf\u500b\u5de5\u4f5c\u7bc0\u9ede\u4e0a\uff0c\u8ca0\u8cac\u7dad\u8b77\u7bc0\u9ede\u4e4b\u9593\u7684\u7db2\u8def\u901a\u8a0a\uff0c\u4e26\u5c07\u6d41\u91cf\u8f49\u767c\u5230\u6b63\u78ba\u7684 pod \u4e0a<ul> <li>\u900f\u904e iptables \u898f\u5247\uff0c\u5c07\u6d41\u91cf\u8f49\u767c\u5230\u6b63\u78ba\u7684 pod \u4e0a</li> </ul> </li> <li>e.g. web server \u7684 pod\uff0c\u900f\u904e kube-proxy \u9023\u7dda\u5230 db server \u7684 pod     </li> </ul>"},{"location":"cloud/k8s/cka/#pod","title":"Pod","text":"<ul> <li>\u7528\u9014: \u662f K8s \u4e2d\u6700\u5c0f\u7684\u90e8\u7f72\u55ae\u4f4d\uff0c\u53ef\u4ee5\u5305\u542b\u4e00\u500b\u6216\u591a\u500b container  (\u901a\u5e38\u6703\u5305\u542b\u4e00\u500b container)<ul> <li>Kubernetes \u6703\u64cd\u4f5c pod\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u64cd\u4f5c container  </li> </ul> </li> <li>\u5411\u4e0a\u64f4\u5c55/\u5411\u4e0b\u64f4\u5c55: \u589e\u52a0/\u6e1b\u5c11 pod \u7684\u6578\u91cf<ul> <li>Pod &lt;-&gt; Container : \u901a\u5e38\u662f 1:1 \u7684\u95dc\u4fc2</li> <li>\u53ef\u900f\u904e Deployment \u4f86\u7ba1\u7406 pod \u7684\u6578\u91cf  </li> </ul> </li> <li>multi-containers pods<ul> <li>\u5728\u67d0\u4e9b\u60c5\u5883\u4e0b\uff0c\u6211\u5011\u6703\u5efa\u7acb helper container(= sidecar container)\uff0c\u4f86\u5354\u52a9\u4e3b\u8981\u7684 container\uff0c\u4f8b\u5982: \u6536\u96c6 log\u3001\u76e3\u63a7\u3001\u8cc7\u6599\u8f49\u63db\u7b49  </li> <li>\u4e00\u822c\u800c\u8a00\uff0c\u6211\u5011\u6703\u900f\u904e Docker \u5206\u5225\u5efa\u7acb\u4e00\u500b\u500b container\u3001helper container; \u7136\u800c\u5728 K8s \u4e2d\uff0c\u6211\u5011\u53ef\u4ee5\u5c07\u9019\u4e9b container \u653e\u5728\u540c\u4e00\u500b pod \u4e2d\uff0c\u900f\u904e pod \u4f86\u7ba1\u7406\u9019\u4e9b containers </li> </ul> </li> <li>Pod \u7684 YAML \u683c\u5f0f\u7684 manifest \u8a2d\u5b9a\u6a94<ul> <li>\u5fc5\u586b\u6b04\u4f4d<ul> <li>apiVersion: K8s API \u7248\u672c</li> <li>kind: \u8cc7\u6e90\u985e\u578b (e.g. Pod)</li> <li>metadata: \u8cc7\u6e90\u7684\u540d\u7a31\u3001\u6a19\u7c64\u7b49</li> <li>spec: \u8cc7\u6e90\u7684\u898f\u683c YAML<pre><code># pod-definition.yaml\napiVersion: v1 # String \u8cc7\u6599\u578b\u5225\nkind: Pod # String \u8cc7\u6599\u578b\u5225\nmetadata: # Dictionary \u8cc7\u6599\u578b\u5225\n    name: myapp-pod\n    labels:\n        app: myapp\n        type: front-end\n\nspec: # Dictionary \u8cc7\u6599\u578b\u5225\n    containers: # List/Array \u8cc7\u6599\u578b\u5225 (\u56e0\u70ba Pod \u53ef\u4ee5\u5305\u542b\u591a\u500b container)\n        - name: nginx-container\n          image: nginx\n</code></pre></li> </ul> </li> </ul> </li> <li>Pod \u5e38\u7528\u6307\u4ee4<ul> <li><code>kubectl get pods</code>: \u53d6\u5f97\u6240\u6709 pods \u7684\u76f8\u95dc\u8cc7\u8a0a     <ul> <li><code>READY</code>: (\u5728\u9019\u500b Pod \u4e2d)\uff0c\u6b63\u5728\u57f7\u884c\u7684 container \u6578\u91cf/\u7e3d container \u6578\u91cf</li> </ul> </li> <li><code>kubectl describe pod &lt;pod-name&gt;</code>: \u53d6\u5f97\u6307\u5b9a pod \u7684\u8a73\u7d30\u8cc7\u8a0a     </li> <li><code>kubetctl create -f &lt;pod-definition.yaml&gt;</code>: (\u6839\u64da\u6307\u5b9a\u7684 YAML manifest \u8a2d\u5b9a\u6a94)\uff0c\u5efa\u7acb pod</li> <li><code>kubectl apply -f &lt;pod-definition.yaml&gt;</code>: (\u6839\u64da\u6307\u5b9a\u7684 YAML manifest \u8a2d\u5b9a\u6a94)\uff0c\u5efa\u7acb/\u66f4\u65b0 pod</li> <li><code>kubectl delete pod &lt;pod-name&gt;</code>: \u522a\u9664\u6307\u5b9a\u7684 pod</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#replicaset","title":"ReplicaSet","text":"<ul> <li>\u7528\u9014: <ul> <li>\u70ba\u4e86\u78ba\u4fdd\u7cfb\u7d71\u7684\u9ad8\u53ef\u7528\u6027(high availability)\uff0c\u4ee5\u907f\u514d\u55ae\u4e00\u7bc0\u9ede\u6545\u969c\u7684\u554f\u984c\u3002\u7576\u67d0\u500b pod \u767c\u751f\u6545\u969c\u6642\uff0cReplicaSet \u6703\u81ea\u52d5\u91cd\u555f pod\uff0c\u4ee5\u78ba\u4fdd pod \u7684\u6578\u91cf\u7b26\u5408\u8a2d\u5b9a\u7684 replicas \u6578\u91cf     </li> <li>\u900f\u904e\u81ea\u52d5\u64f4\u5c55\u6a5f\u5236(scaling)\uff0c\u4f86\u8abf\u6574 pod \u7684\u6578\u91cf\uff0c\u4ee5\u9054\u5230 pods \u4e4b\u9593\u7684\u8ca0\u8f09\u5e73\u8861(load balancing)     </li> </ul> </li> <li>\u904b\u7528 template \u4f86\u5b9a\u7fa9 pod \u7684\u898f\u683c     </li> <li>label &amp; selector<ul> <li>label: \u7528\u4f86\u6a19\u8a18 pod \u7684 metadata\uff0c\u4ee5\u4fbf\u65bc\u8fa8\u8b58\u3001\u641c\u5c0b\u3001\u9078\u64c7 pod</li> <li>selector: \u7528\u4f86\u9078\u64c7\u8981\u7ba1\u7406\u7684 pod\uff0c\u900f\u904e label \u4f86\u9078\u64c7\u8981\u7ba1\u7406\u7684 pod     </li> </ul> </li> <li>Replication Controller vs. ReplicaSet<ul> <li>Replication Controller: \u820a\u7248\u7684\u63a7\u5236\u5668\uff0c\u50c5\u652f\u63f4\u57fa\u672c\u7684 pod \u8907\u88fd\u529f\u80fd     YAML<pre><code># rc-definition.yaml\napiVersion: v1 # Replication Controller \u4f7f\u7528 v1 API \u7248\u672c\nkind: ReplicationController\nmetadata:\n    name: myapp-rc\n    labels:\n        app: myapp\n        type: front-end\n\nspec:\n    # \u900f\u904e template \u5b9a\u7fa9 pod \u7684\u898f\u683c\n    template:\n        metadata:\n        name: myapp-pod\n        labels:\n            app: myapp\n            type: front-end\n        spec:\n            containers:\n            -   name: nginx-container\n                image: nginx\n\n    # \u8a2d\u5b9a pod \u7684\u526f\u672c\u6578\u91cf\n    replicas: 3\n</code></pre> </li> <li>ReplicaSet: \u65b0\u7248\u7684\u63a7\u5236\u5668\uff0c\u652f\u63f4\u66f4\u591a\u7684 pod \u8907\u88fd\u529f\u80fd\uff0c\u4f8b\u5982: \u64f4\u5c55\u3001\u7e2e\u5c0f\u3001\u66f4\u65b0 pod \u7b49     YAML<pre><code># replicaset-definition.yaml\napiVersion: apps/v1 # ReplicaSet \u4f7f\u7528 apps/v1 API \u7248\u672c\nkind: ReplicaSet\nmetadata:\n    name: myapp-replicaset\n    labels:\n    app: myapp\n    type: front-end\nspec:\n    template:\n        metadata:\n            name: myapp-pod\n            labels:\n                app: myapp\n                type: front-end\n        spec:\n            containers:\n            -   name: nginx-container\n                image: nginx\n\n    replicas: 3\n    # \u53ea\u6709 ReplicaSet \u80fd\u652f\u63f4 selector \u7684\u8a2d\u5b9a\uff0c\u900f\u904e label \u4f86\u9078\u64c7\u8981\u7ba1\u7406\u7684 pod\n    selector:\n        # \u904e\u6ffe\u5668: \u9078\u64c7\u8981\u7ba1\u7406\u7684 pod\n        matchLabels:\n            # \u6307\u5b9a\u8981\u7ba1\u7406\u5177\u6709\u54ea\u4e9b label \u7684 pod\n            type: front-end\n</code></pre> </li> </ul> </li> <li>ReplicaSet \u7684\u64f4\u5c55\u6a5f\u5236<ul> <li>\u6cd5\u4e00: \u5b8c\u5168\u66ff\u63db\u73fe\u6709\u7684 ReplicaSet\uff0c\u4f7f\u7528\u65b0\u7684\u8a2d\u5b9a\u6a94\u4e2d\u7684\u6240\u6709\u5167\u5bb9<ul> <li>\u9069\u7528\u60c5\u5883: \u7528\u65bc\u5b8c\u5168\u66ff\u63db\u73fe\u6709\u8cc7\u6e90\uff0c\u4ee5\u5168\u9762\u66f4\u65b0\u8cc7\u6e90\u914d\u7f6e\u6642\u4f7f\u7528  Bash<pre><code>kubectl apply -f replicaset-definition.yaml\n</code></pre></li> </ul> </li> <li>\u6cd5\u4e8c: \u6703\u8a2d\u7f6e ReplicaSet \u7684\u526f\u672c\u6578\u91cf\uff0c\u4f46\u4e0d\u6703\u4fee\u6539\u5176\u4ed6\u5c6c\u6027<ul> <li>\u9069\u7528\u60c5\u5883: \u6839\u64da YAML \u6587\u4ef6\u6307\u5b9a\u7684\u526f\u672c\u6578\u91cf\u9032\u884c\u7e2e\u653e Bash<pre><code>kubectl scale --replicas=6 -f replicaset-definition.yaml\n</code></pre></li> </ul> </li> <li>\u6cd5\u4e09: \u76f4\u63a5\u5728 CLI \u4e2d\u8a2d\u7f6e\u6307\u5b9a ReplicaSet \u7684\u526f\u672c\u6578\u91cf<ul> <li>\u9069\u7528\u60c5\u5883: \u5feb\u901f\u8abf\u6574\u526f\u672c\u6578\u91cf\uff0c\u9069\u5408\u65bc CLI \u64cd\u4f5c Bash<pre><code>kubectl scale --replicas=6 replicaset myapp-replicaset\n</code></pre> </li> </ul> </li> <li> <p>\u8aaa\u660e:</p> <ul> <li><code>kubectl scale</code> \u6307\u4ee4\u4e0d\u6703\u6539\u8b8a YAML \u8a2d\u5b9a\u6a94\u4e2d\u7684\u5167\u5bb9\uff0c\u50c5\u6703\u6539\u8b8a ReplicaSet \u7684\u8a2d\u5b9a\uff0c\u9032\u800c\u5f71\u97ff\u53e2\u96c6\u4e2d pod \u7684\u6578\u91cf </li> <li>\u4e0a\u8ff0\u4e09\u7a2e\u65b9\u6cd5\u5728 runtime \u90fd\u6703\u5c07 pod \u7684\u6578\u91cf\u64f4\u5c55\u5230 6 \u500b; \u4f46\u662f\u80cc\u5f8c\u7684\u610f\u7fa9\u4e0d\u540c<ul> <li>Tips: \u7686\u662f\u5c0d ReplicaSet \u505a\u8a2d\u5b9a; \u800c\u4e0d\u662f\u5c0d YAML \u8a2d\u5b9a\u6a94\u4e2d\u7684 replicas \u503c\u505a\u8a2d\u5b9a</li> </ul> </li> </ul> CLI \u6307\u4ee4 \u57f7\u884c\u5f8c ReplicaSet \u7684 <code>replicas</code> \u6578\u91cf YAML \u8a2d\u5b9a\u6a94\u4e2d\u7684 <code>replicas</code> \u503c <code>kubectl replace -f replicaset-definition.yaml</code> 3 3 <code>kubectl scale --replicas=6 -f replicaset-definition.yaml</code> 6 3 <code>kubectl scale --replicas=6 replicaset myapp-replicaset</code> 6 3 </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#deployment","title":"Deployment","text":"<ul> <li>\u7528\u9014: (\u662f\u4e00\u500b K8s \u7269\u4ef6)\uff0c\u7528\u4f86\u7ba1\u7406 ReplicaSet\uff0c\u4e26\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u529f\u80fd\uff0c\u4f8b\u5982: \u4e0b\u8f09/\u4e0a\u50b3 container image\u3001\u6efe\u52d5\u66f4\u65b0(rolling update)\u3001\u56de\u6efe(rollback)\u3001\u66ab\u505c pod\u3001\u6062\u5fa9\u57f7\u884c pod \u7b49<ul> <li>Deployment \u6703\u81ea\u52d5\u5efa\u7acb ReplicaSet\uff0c\u4e26\u900f\u904e ReplicaSet \u4f86\u7ba1\u7406 Pod \u7684\u6578\u91cf </li> </ul> </li> <li>Deployment \u7684 YAML \u683c\u5f0f\u7684 manifest \u8a2d\u5b9a\u6a94 (\u6703\u81ea\u52d5\u5efa\u7acb ReplicaSet)     YAML<pre><code># deployment-definition.yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n    name: myapp-deployment\n    labels:\n        app: myapp\n        type: front-end\n\nspec:\n    template:\n        metadata:\n            name: myapp-pod\n            labels:\n                app: myapp\n                type: front-end\n    spec:\n        containers:\n        -   name: nginx-container\n            image: nginx\n\nreplicas: 3\nselector:\n    matchLabels:\n        type: front-end\n</code></pre> </li> <li>\u6aa2\u8996\u7576\u524d K8s \u4e2d\u6240\u6709\u7684\u7269\u4ef6     Bash<pre><code>kubectl get all\n</code></pre> </li> </ul>"},{"location":"cloud/k8s/cka/#service","title":"Service","text":"<ul> <li>\u7528\u9014: (\u662f\u4e00\u500b K8s \u7269\u4ef6)\uff0c\u8b93\u591a\u500b pods \u4e4b\u9593\u80fd\u5920\u4e92\u76f8\u901a\u8a0a\uff0c\u6709\u52a9\u65bc\u5fae\u670d\u52d9\u67b6\u69cb(micro service)\u7684\u9b06\u8026\u5408\u7279\u6027(loose coupling)</li> <li> <p>\u6982\u5ff5: (\u5047\u8a2d\u6709\u500b\u5916\u90e8\u4f7f\u7528\u8005\uff0c\u60f3\u8981\u5b58\u53d6 pod \u7684\u7db2\u9801\u670d\u52d9)</p> <ul> <li> <p>\u82e5\u6211\u5011\u60f3\u5b58\u53d6\u79c1\u6709\u7db2\u57df\u4e2d\u7684 pod \u6642\uff0c\u5fc5\u9808\u5148\u900f\u904e SSH \u9023\u7dda\u9032\u5165 K8s \u53e2\u96c6\u4e2d\u7684\u8a72\u5de5\u4f5c\u7bc0\u9ede\u5f8c\uff0c\u518d\u900f\u904e curl \u6307\u4ee4\u4f86\u5b58\u53d6 pod \u7684\u5167\u7db2 IP address     </p> </li> <li> <p>\u4f46\u662f\u4e00\u822c\u4f86\u8aaa\uff0c\u6211\u5011\u6703\u5e0c\u671b\u53ea\u8981\u5b58\u53d6 K8s \u53e2\u96c6\u4e2d\u7684\u8a72\u5de5\u4f5c\u7bc0\u9ede\u7684 IP address\uff0c\u800c\u7121\u9700\u900f\u904e SSH \u9023\u7dda\u9032\u5165\u5de5\u4f5c\u7bc0\u9ede\u5167\u90e8\uff0c\u4f86\u5b58\u53d6 pod \u7684\u670d\u52d9</p> <ul> <li>Solution: \u9019\u6642\u5019\u6211\u5011\u5c31\u53ef\u4ee5\u900f\u904e Service \u4f5c\u70ba\u4e2d\u9593\u7684\u670d\u52d9\uff0c\u5c07\u5916\u90e8\u7684 client \u900f\u904e Service \u4f86\u5b58\u53d6 pod \u7684\u670d\u52d9</li> <li>\u53ef\u4ee5\u628a Service \u60f3\u50cf\u6210\u4e00\u500b\u7bc0\u9ede\u5167\u7684\u865b\u64ec\u4f3a\u670d\u5668\uff0c\u6703\u64c1\u6709\u81ea\u5df1\u7684 IP address\u3001port\uff0c\u4e26\u5c07\u6d41\u91cf\u5c0e\u5411\u5230\u5c0d\u61c9\u7684 pod \u670d\u52d9\u4e0a </li> </ul> </li> </ul> </li> <li> <p>\u5728\u6b63\u5f0f\u74b0\u5883\u4e2d\uff0c\u901a\u5e38\u6703\u662f multiple pods \u7684\u60c5\u5883</p> <ul> <li> <p>\u55ae\u4e00\u7bc0\u9ede\u4e0a\u6709\u591a\u500b pods</p> <ul> <li>\u9019\u4e9b pods \u90fd\u5177\u6709\u76f8\u540c\u7684 label\uff0cnodePort Service \u6703\u900f\u904e label \u4f86\u9078\u64c7\u8981\u7ba1\u7406\u7684 pods\uff0c\u4e26\u5c07\u5916\u90e8\u6d41\u91cf\u5c0e\u5411\u5230\u9019\u4e9b pods \u4e0a<ul> <li>algorithm: random (\u9810\u8a2d\u6703\u4f7f\u7528\u96a8\u6a5f\u6f14\u7b97\u6cd5\uff0c\u4f86\u6c7a\u5b9a\u5c07\u6d41\u91cf\u5c0e\u5411\u5230\u54ea\u500b pod \u4e0a)</li> <li>sessionAffinity: true (\u6703\u5c07\u540c\u4e00\u500b session \u7684\u6d41\u91cf\u5c0e\u5411\u5230\u540c\u4e00\u500b pod \u4e0a) </li> </ul> </li> </ul> </li> <li> <p>\u591a\u500b\u7bc0\u9ede\u4e0a\u5206\u5225\u6709\u4e00\u500b pod</p> <ul> <li>\u5916\u90e8\u4f7f\u7528\u8005\u53ef\u900f\u904e\u4efb\u4f55\u4e00\u500b\u7bc0\u9ede\u7684 IP address\uff0c\u8207\u76f8\u540c\u7684 nodePort \u4f86\u5b58\u53d6 pod \u7684\u670d\u52d9\uff0c\u9054\u5230\u9ad8\u53ef\u7528\u6027\u3001\u8ca0\u8f09\u5747\u8861\u7684\u76ee\u7684  </li> </ul> </li> </ul> </li> <li> <p>\u4e09\u7a2e Service \u985e\u578b</p> <p></p> <ul> <li> <p>ClusterIP: \u6703\u5efa\u7acb\u4e00\u500b\u865b\u64ec IP address \u4ee5\u63d0\u4f9b\u5167\u90e8\u7684 pod \u4e4b\u9593\u901a\u8a0a\uff0c\u50c5\u80fd\u5728\u53e2\u96c6\u5167\u90e8\u4f7f\u7528</p> <ul> <li>ClusterIP Service \u7269\u4ef6\uff0c\u80fd\u5c07\u4e00\u7fa4 pods \u8996\u70ba\u4e00\u500b\u7fa4\u7d44\uff0c\u5c0d\u5916\u63d0\u4f9b\u4e00\u500b\u7d71\u4e00\u7684\u4ecb\u9762\u4f86\u5b58\u53d6\u8a72\u7fa4\u7d44\u4e2d\u7684 pod \u670d\u52d9</li> <li>\u9810\u8a2d\u7684 Service \u985e\u578b</li> <li>\u5e38\u898b\u4f7f\u7528\u60c5\u5883: \u591a\u500b frontend pods \u900f\u904e ClusterIP \u4f86\u5b58\u53d6 backend pods <ul> <li>\u56e0\u70ba\u9019\u4e9b pod \u7686\u6709\u53ef\u80fd\u96a8\u6642\u88ab\u95dc\u9589\uff0c\u56e0\u6b64\u5176 IP address \u7686\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u6545\u6211\u5011\u4e0d\u80fd\u4f9d\u8cf4\u9019\u4e9b IP address \u4f86\u5b58\u53d6 pod \u7684\u670d\u52d9\uff0c\u8981\u4f7f\u7528 Service \u4f86\u5b58\u53d6 pod \u7684\u670d\u52d9 Bash<pre><code># service-definition.yaml\napiVersion: v1\nkind: Service\nmetadata:\n    name: back-end\n\nspec:\n    types: ClusterIP\n    ports:\n        -   targetPort: 80\n            port: 80\nselector:\n    app: myapp\n    type: back-end\n</code></pre> </li> </ul> </li> </ul> </li> <li> <p>NodePort: \u6703\u5728\u6bcf\u500b\u7bc0\u9ede\u4e0a\u958b\u555f\u4e00\u500b port\uff0c\u8b93\u5916\u90e8\u7684 client \u53ef\u4ee5\u900f\u904e\u7bc0\u9ede\u7684 IP address \u4f86\u5b58\u53d6 pod \u7684\u670d\u52d9</p> <ul> <li>nodePort \u7684 port: \u9810\u8a2d\u7bc4\u570d 30000 \uff5e 32767<ul> <li>\u82e5\u672a\u6307\u5b9a port\uff0cK8s \u6703\u81ea\u52d5\u5206\u914d\u4e00\u500b port</li> </ul> </li> <li>port: Service \u7269\u4ef6\u7684 port<ul> <li>\u5fc5\u586b\u6b04\u4f4d</li> </ul> </li> <li> <p>targetPort: pod \u670d\u52d9\u7684 port</p> <ul> <li>\u82e5\u672a\u63d0\u4f9b\uff0c\u9810\u8a2d\u8207 Service \u7269\u4ef6\u7684 port \u76f8\u540c Bash<pre><code># service-definition.yaml\napiVersion: v1\nkind: Service\nmetadata:\n    name: myapp-service\n\nspec:\n    types: NodePort # Service \u985e\u578b\n    ports:\n    # - \u8868\u793a\u70ba List/Array \u8cc7\u6599\u578b\u5225\u7684\u7b2c\u4e00\u500b\u5143\u7d20\n    -   targetPort: 80\n        port: 80 # \u5fc5\u586b\u6b04\u4f4d\n        nodePort: 30008\n    # \u900f\u904e selector \u4f86\u9078\u64c7\u8981\u7ba1\u7406\u7684 pod\n    selector:\n        app: myapp\n        type: front-end\n</code></pre> </li> </ul> </li> <li> <p>\u5efa\u7acb Service \u7269\u4ef6     Bash<pre><code>kubectl create -f service-definition.yaml\n</code></pre></p> </li> <li>\u5217\u51fa\u7576\u524d\u6240\u6709\u7684 Service \u7269\u4ef6     Bash<pre><code>kubectl get services\n</code></pre></li> <li>\u900f\u904e CLI \u5b58\u53d6 pod \u670d\u52d9 (\u800c\u975e\u4f7f\u7528\u700f\u89bd\u5668)     Bash<pre><code># \u5b58\u53d6\u7684\u662f\u7bc0\u9ede IP address \u7684 nodePort\ncurl http://192.168.1.2:30008\n</code></pre> <ul> <li>LoadBalancer: \u900f\u904e\u96f2\u7aef\u63d0\u4f9b\u5546\u4e0a\u5efa\u7acb\u4e00\u500b load balancer\uff0c\u4e26\u5c07\u6d41\u91cf\u5c0e\u5411\u5230 Service \u4e0a</li> </ul> </li> <li>\u5e38\u898b\u4f7f\u7528\u60c5\u5883: \u5728\u591a\u500b\u524d\u7aef pods \u7684\u524d\u9762\uff0c\u52a0\u4e0a\u4e00\u500b load balancer\uff0c\u4f86\u5e73\u8861\u6d41\u91cf</li> <li>\u5728\u6b63\u5f0f\u74b0\u5883\u4e2d\uff0c\u4e00\u822c\u800c\u8a00\uff0c\u5916\u90e8\u4f7f\u7528\u8005\u6703\u60f3\u8981\u76f4\u63a5\u8f38\u5165 url \u4f86\u5b58\u53d6\u7db2\u7ad9\uff0c\u800c\u4e0d\u662f\u900f\u904e IP address + port \u4f86\u5b58\u53d6     <ul> <li>\u6cd5\u4e00: \u5728 VM \u4e0a\uff0c\u624b\u52d5\u5efa\u7acb\u4e00\u500b Load Balancer\uff0c\u8a2d\u5b9a\u597d port forwarding \u898f\u5247\uff0c\u5f8c\u7e8c\u9700\u8981\u7dad\u904b     </li> <li>\u6cd5\u4e8c (\u63a8\u85a6): \u4f7f\u7528\u96f2\u7aef\u63d0\u4f9b\u5546\u7684 Load Balancer \u670d\u52d9\uff0c\u900f\u904e Service \u7269\u4ef6\u4f86\u5efa\u7acb Load Balancer (e.g. GCP)     </li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#namespace","title":"Namespace","text":"<ul> <li>\u7528\u9014: \u7368\u7acb\u7684\u547d\u540d\u7a7a\u9593\u53ef\u4ee5\u7528\u4f86\u9694\u96e2\u8cc7\u6e90 (isolation)\uff0c\u4ee5\u5b58\u653e\u6211\u5011\u5e73\u5e38\u5efa\u7acb\u7684 Pods, Deployments, Services</li> <li>K8s \u53e2\u96c6\u6703\u9810\u8a2d\u81ea\u52d5\u5efa\u7acb\u4ee5\u4e0b\u4e09\u500b namespace<ul> <li>default: \u63d0\u4f9b\u4f7f\u7528\u8005\u9810\u8a2d\u4f7f\u7528\u7684\u547d\u540d\u7a7a\u9593</li> <li>kube-system: \u4e3b\u8981\u662f\u70ba\u4e86\u7dad\u6301 K8s \u53e2\u96c6\u5167\u90e8\u904b\u884c\u6240\u9700(e.g. networking, DNS service)\u3002\u4e5f\u70ba\u4e86\u907f\u514d\u8207\u4f7f\u7528\u8005\u5efa\u7acb\u7684\u7269\u4ef6\u6df7\u6dc6\uff0c\u540c\u6642\u4e5f\u80fd\u907f\u514d\u4f7f\u7528\u8005\u8aa4\u522a or \u4fee\u6539\u9019\u4e9b\u670d\u52d9</li> <li>kube-public: \u6240\u6709\u4f7f\u7528\u8005\u7686\u80fd\u4f7f\u7528\u9019\u500b\u547d\u540d\u7a7a\u9593\u4e2d\u7684\u8cc7\u6e90</li> <li>\u53e6\u5916\uff0c\u6211\u5011\u4e5f\u80fd\u81ea\u5df1\u624b\u52d5\u5efa\u7acb\u547d\u540d\u7a7a\u9593\uff0c\u4f8b\u5982: dev, prod </li> </ul> </li> <li> <p>\u5efa\u7acb namespace</p> <ul> <li> <p>\u6cd5 1: \u4f7f\u7528 YAML manifest \u8a2d\u5b9a\u6a94     YAML<pre><code># namespace-dev.yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n    name: dev\n</code></pre></p> Bash<pre><code>kubectl create -f namespace-dev.yaml\n</code></pre> </li> <li> <p>\u6cd5 2: \u4f7f\u7528 kubectl \u6307\u4ee4     Bash<pre><code>kubectl create namespace dev\n</code></pre> </p> </li> </ul> </li> <li> <p>\u8a2d\u5b9a\u6307\u5b9a\u7684 namespace \u4e2d\u7684\u8cc7\u6e90\u9650\u5236: </p> <ul> <li>\u5efa\u7acb ResourceQuota YAML manifest \u8a2d\u5b9a\u6a94     YAML<pre><code>apiVersion: v1\nkind: ResourceQuota\nmetadata:\n    name: compute-quota\n    # \u6307\u5b9a\u8981\u5957\u7528\u7684 namespace\n    namespace: dev\n\nspec:\n    hard:\n        pods: \"10\"\n        requests.cpu: \"4\"\n        requests.memory: 5Gi\n        limits.cpu: \"10\"\n        limits.memory: 10Gi\n</code></pre></li> <li>\u5957\u7528 ResourceQuota \u8a2d\u5b9a\u6a94     Bash<pre><code>kubectl create -f compute-quota.yaml\n</code></pre> </li> </ul> </li> <li>\u5728\u6307\u5b9a\u7684 namespace \u4e2d\u5efa\u7acb pod<ul> <li>\u6cd5 1:     Bash<pre><code>kubectl create -f pod-definition.yaml --namespace=dev\n</code></pre></li> <li>\u6cd5 2:     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp-pod\n    # \u6307\u5b9a\u8981\u5957\u7528\u7684 namespace\n    namespace: dev\n    labels:\n        app: myapp\n        type: front-end\n\nspec:\n    containers:\n    -   name: nginx-container\n        image: nginx\n</code></pre> </li> </ul> </li> <li>\u5207\u63db\u9810\u8a2d\u7684 namespace (<code>default</code> namespace -&gt; <code>dev</code> namespace)     Bash<pre><code>kubectl config set-context $(kubectl config current-context) --namespace=dev\n</code></pre> </li> <li>\u6aa2\u8996\u9810\u8a2d namespace \u4e2d\u7684\u6240\u6709 pods     Bash<pre><code>kubectl get pods\n</code></pre> </li> <li>\u6aa2\u8996\u6307\u5b9a\u7684 namespace \u4e2d\u7684\u6240\u6709 pods     Bash<pre><code>kubectl get pods --namespace=kube-system\n</code></pre></li> <li>\u6aa2\u8996\u6240\u6709 namespace \u4e2d\u7684\u6240\u6709 pods     Bash<pre><code>kubectl get pods --all-namespaces\n</code></pre></li> </ul>"},{"location":"cloud/k8s/cka/#imperative-vs-declarative","title":"Imperative vs. Declarative","text":"<p>\u5728\u73fe\u4ee3\u7684\u7a0b\u5f0f\u78bc\u5373\u57fa\u790e\u8a2d\u8a2d\u65bd (Infrastructure as Code, IaC) \u4e2d\uff0c\u6709\u4ee5\u4e0b\u5169\u7a2e\u4e3b\u8981\u7684\u7a0b\u5f0f\u78bc\u7ba1\u7406\u65b9\u5f0f</p> <p></p> <ul> <li> <p>\u5ba3\u544a\u5f0f (Imperative): \u900f\u904e\u6307\u4ee4\uff0c\u660e\u78ba\u5730\u544a\u8a34\u7cfb\u7d71\u8981\u57f7\u884c\u7684\u64cd\u4f5c     Bash<pre><code># \u5efa\u7acb\u7269\u4ef6\nkubectl create -f nginx.yaml\n</code></pre></p> Bash<pre><code># \u66f4\u65b0\u7269\u4ef6 --- \u50c5\u5c0d K8s \u53e2\u96c6\u4e2d\u73fe\u884c\u7269\u4ef6\u8a2d\u5b9a\u6a94 (live object configuration) \u505a\u8b8a\u66f4\nkubectl edit deployment nginx\n</code></pre> Bash<pre><code># \u66f4\u65b0\u7269\u4ef6 --- \u5c0d\u539f\u59cb\u8a2d\u5b9a\u6a94 (object configuration file) \u505a\u8b8a\u66f4\u5f8c\uff0c\u518d\u5c07 \"\u8b8a\u52d5\u7684\u90e8\u5206\" \u5957\u7528\u5230 K8s \u53e2\u96c6\u4e2d\nkubectl replace -f nginx.yaml\n</code></pre> Bash<pre><code># \u66f4\u65b0\u7269\u4ef6 --- \u5c0d\u539f\u59cb\u8a2d\u5b9a\u6a94 (object configuration file) \u505a\u8b8a\u66f4\uff0c\u5b8c\u5168\u522a\u9664\u539f\u672c\u7684\u7269\u4ef6\u5f8c\uff0c\u518d\u91cd\u65b0\u5efa\u7acb\u65b0\u7684\u7269\u4ef6\nkubectl replace --force -f nginx.yaml\n</code></pre> <p> </p> </li> <li> <p>\u547d\u4ee4\u5f0f (Declarative): \u900f\u904e YAML manifest \u8a2d\u5b9a\u6a94\u4f86\u63cf\u8ff0\u7cfb\u7d71\u7684\u671f\u671b\u72c0\u614b\uff0c\u7cfb\u7d71\u6703\u6839\u64da\u6211\u5011\u7684\u76ee\u6a19\uff0c\u81ea\u52d5\u8a2d\u5b9a\u7cfb\u7d71     </p> </li> </ul> <p>\u601d\u8003: \u82e5\u5efa\u7acb pod \u5230\u4e00\u534a\uff0c\u767c\u751f\u7cfb\u7d71\u4e2d\u65b7\u554f\u984c\u6642\uff1f</p> <ul> <li>\u5ba3\u544a\u5f0f\u8a9e\u6cd5: \u9700\u900f\u904e\u8a31\u591a\u6aa2\u67e5\u3001\u9664\u932f\u6307\u4ee4\uff0c\u624d\u80fd\u78ba\u5b9a\u7576\u524d\u7684 K8s \u53e2\u96c6\u72c0\u614b\uff0c\u4ee5\u7e7c\u7e8c\u57f7\u884c </li> <li>\u547d\u4ee4\u5f0f\u8a9e\u6cd5: \u80fd\u5920\u81ea\u52d5\u6bd4\u5c0d\u7576\u524d\u7684 K8s \u53e2\u96c6\u72c0\u614b\uff0c\u6839\u64da object configuration file, last-applied-configuration, live object configuration \u7684 YAML manifest \u8a2d\u5b9a\u6a94\uff0c\u81ea\u52d5\u8abf\u6574\u4ee5\u7b26\u5408\u6211\u5011\u7684\u76ee\u6a19\u72c0\u614b </li> </ul> <p></p> <ul> <li>\u539f\u59cb\u8a2d\u5b9a\u6a94 (object configuration file): \u5132\u5b58\u5728\u672c\u5730\u7aef</li> <li>\u4e0a\u6b21\u61c9\u7528\u7684\u8a2d\u5b9a\u6a94 (last-applied-configuration): \u6703\u8f49\u63db\u6210 JSON \u683c\u5f0f\uff0c\u5132\u5b58\u5728 K8s \u53e2\u96c6\u4e2d\uff0c\u7528\u4f86\u8ffd\u8e64\u7269\u4ef6\u7684\u4e0a\u6b21\u61c9\u7528\u8a2d\u5b9a     </li> <li> <p>K8s \u53e2\u96c6\u4e2d\u73fe\u884c\u7269\u4ef6\u8a2d\u5b9a\u6a94 (live object configuration): \u5132\u5b58\u5728 Kubernetes memory \u4e2d\uff0c\u900f\u904e lastProbeTime, status \u4f86\u8ffd\u8e64\u7269\u4ef6\u7684\u7576\u524d\u72c0\u614b</p> </li> <li> <p>\u53c3\u8003\u8cc7\u6599</p> <ul> <li>Kubernetes Object Management</li> <li>Declarative Management of Kubernetes Objects Using Configuration Files</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#scheduling","title":"Scheduling","text":""},{"location":"cloud/k8s/cka/#manual-scheduling","title":"Manual Scheduling","text":"<p>\u601d\u8003: \u82e5\u6211\u5011\u6c92\u6709 kube-scheduler \u5728\u6211\u5011\u7684 K8s \u53e2\u96c6\u4e2d\uff0c\u6211\u5011\u8a72\u5982\u4f55\u5c07 pod \u6392\u7a0b\u5230\u6307\u5b9a\u7684\u7bc0\u9ede\u4e0a\uff1f</p> <ul> <li>\u8a2d\u5b9a nodeName \u5c6c\u6027: \u6307\u5b9a pod \u8981\u6392\u7a0b\u5230\u54ea\u500b\u7bc0\u9ede\u4e0a<ul> <li><code>nodeName</code>: \u6bcf\u500b Pod \u9810\u8a2d\u90fd\u4e0d\u6703\u6709\u9019\u500b\u5c6c\u6027\uff0c\u56e0\u70ba K8s \u53e2\u96c6\u7684 kube-scheduler \u6703\u8ca0\u8cac\u5c07 pod \u6392\u7a0b\u5230\u9069\u5408\u7684\u7bc0\u9ede\u4e0a YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: nginx\n    labels:\n        name: nginx\n\nspec:\n    containers:\n    -   name: nginx\n        image: nginx\n        ports:\n        - containerPort: 8080\n    # \u6307\u5b9a pod \u8981\u6392\u7a0b\u5230\u54ea\u500b\u7bc0\u9ede\u4e0a\n    nodeName: node02\n</code></pre> </li> </ul> </li> <li> <p>\u5047\u5982 K8s \u53e2\u96c6\u4e2d\u6c92\u6709 kube-scheduler\uff0c\u82e5\u6211\u5011\u5efa\u7acb\u4e00\u500b Pod \u6642\uff0c\u537b\u672a\u8a2d\u5b9a nodeName =&gt; Pod \u6703\u7dad\u6301\u5728 Pending \u72c0\u614b</p> <ul> <li>Kubernetes \u50c5\u63a5\u53d7\u5efa\u7acb Pod \u4e4b\u524d\uff0c\u5c31\u8981\u5148\u5728 YAML manifest \u8a2d\u5b9a\u6a94\u4e2d\u6307\u5b9a nodeName\uff0c\u800c\u4e0d\u63a5\u53d7\u518d\u5efa\u7acb Pod \u5f8c\u624d\u6307\u5b9a nodeName</li> <li>\u89e3\u6c7a\u65b9\u6848 1: \u5efa\u7acb Pod \u4e4b\u524d\uff0c\u5c31\u8981\u5148\u5728 YAML manifest \u8a2d\u5b9a\u6a94\u4e2d\u6307\u5b9a nodeName     </li> <li> <p>\u89e3\u6c7a\u65b9\u6848 2: (\u82e5\u5df2\u5efa\u7acb Pod)\uff0c\u53ef\u900f\u904e Binding \u7269\u4ef6\uff0c\u5c07 Pod \u6392\u7a0b\u5230\u6307\u5b9a\u7684\u7bc0\u9ede\u4e0a</p> <ul> <li> <p>\u4f7f\u7528 POST \u8acb\u6c42\uff0c\u5c07 request body \u4ee5 JSON \u683c\u5f0f\u50b3\u9001\u5230 kube-apiserver =&gt; \u6a21\u64ec kube-scheduler \u7684\u5be6\u969b\u6392\u7a0b Pod \u7684\u884c\u70ba     YAML<pre><code>apiVersion: v1\nkind: Binding\nmetadata:\n    name: nginx\ntarget:\n    apiVersion: v1\n    kind: Node\n    name: node02\n</code></pre></p> YAML<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n    name: nginx\n    labels:\n        name: nginx\nspec:\n    containers:\n    -   name: nginx\n        image: nginx\n        ports:\n        -   containerPort: 8080\n</code></pre> </li> </ul> <p></p> </li> </ul> </li> <li> <p>\u5728 K8s \u53e2\u96c6\u4e2d\uff0c\u6211\u5011\u4e0d\u80fd\u5c07\u4e00\u500b\u904b\u884c\u4e2d\u7684 Pod \u79fb\u52d5\u5230\u53e6\u4e00\u500b\u7bc0\u9ede\u4e0a\uff0c\u56e0\u70ba Pod \u7684 IP address \u662f\u56fa\u5b9a\u7684\uff0c\u4e14 Pod \u7684\u72c0\u614b\u662f\u4e0d\u53ef\u8b8a\u7684</p> <ul> <li>\u89c0\u5ff5: \u672c\u8cea\u4e0a\uff0cPod (container) \u7b97\u662f\u7cfb\u7d71\u4e0a\u7684\u4e00\u500b process\uff0c\u800c process \u662f\u4e0d\u53ef\u79fb\u52d5\u7684</li> <li>\u82e5\u6211\u5011\u60f3\u8981\u5c07 Pod \u79fb\u52d5\u5230\u53e6\u4e00\u500b\u7bc0\u9ede\u4e0a\uff0c\u6211\u5011\u5fc5\u9808\u5148\u522a\u9664 Pod\uff0c\u518d\u91cd\u65b0\u5efa\u7acb Pod\uff0c\u4e26\u6307\u5b9a nodeName</li> <li>\u6cd5 1: \u522a\u9664 Pod\uff0c\u518d\u91cd\u65b0\u5efa\u7acb Pod     Bash<pre><code>kubectl delete pod nginx\nkubectl create -f pod-definition.yaml\n</code></pre></li> <li>\u6cd5 2: \u5f37\u5236\u66ff\u63db Pod Bash<pre><code>kubectl replace --force -f pod-definition.yaml\n</code></pre></li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#labels-selectors-annotations","title":"Labels &amp; Selectors &amp; Annotations","text":"<ul> <li>\u5728 K8s \u53e2\u96c6\u4e2d\uff0c\u6709\u8a31\u591a\u8cc7\u6e90/\u7269\u4ef6\uff0c\u6211\u5011\u53ef\u4ee5\u900f\u904e labels, selectors \u4f86\u5c0d\u904e\u6ffe\u3001\u5206\u7fa4\u9019\u4e9b\u8cc7\u6e90/\u7269\u4ef6\uff0c\u4ee5\u9032\u884c\u7ba1\u7406\u3002\u4f8b\u5982\u63a1\u7528\u4ee5\u4e0b\u65b9\u5f0f\u505a\u5206\u985e<ul> <li>\u6839\u64da\u8cc7\u6e90\u985e\u578b\u505a\u5206\u985e     </li> <li>\u6839\u64da\u61c9\u7528\u7a0b\u5f0f\u985e\u578b\u505a\u5206\u985e     </li> <li>\u6839\u64da\u529f\u80fd\u505a\u5206\u985e     </li> </ul> </li> <li>\u6a19\u7c64 (labels): \u6703\u9644\u52a0\u5728 K8s \u8cc7\u6e90/\u7269\u4ef6\u4e0a\u7684 key-value pair\uff0c\u7528\u4f86\u8b58\u5225\u3001\u5206\u985e<ul> <li>\u5efa\u7acb labels     YAML<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n    name: simple-webapp\n    # \u5efa\u7acb labels\n    labels:\n        app: App1\n        function: Front-end\n\nspec:\n    containers:\n    -   name: simple-webapp\n        image: simple-webapp\n        ports:\n        - containerPort: 8080\n</code></pre> </li> </ul> </li> <li>\u9078\u64c7\u5668 (selectors): \u91dd\u5c0d labels\uff0c\u4f86\u9078\u64c7\u8981\u7ba1\u7406\u7684\u8cc7\u6e90/\u7269\u4ef6<ul> <li>\u4f7f\u7528 selectors     Bash<pre><code>kubectl get pods --selector app=App1\n</code></pre> </li> </ul> </li> <li>\u8a3b\u89e3 (annotations): \u53ef\u9644\u52a0\u5728 K8s \u8cc7\u6e90/\u7269\u4ef6\u4e0a\u7684 key-value pair\uff0c\u7528\u4f86\u63d0\u4f9b/\u8a18\u9304\u984d\u5916\u7684\u8cc7\u8a0a\uff0c\u901a\u5e38\u4e0d\u6d89\u53ca\u8cc7\u6e90/\u7269\u4ef6\u7684\u9078\u64c7, \u904e\u6ffe YAML<pre><code># replicaset-definition.yaml\napiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n    name: simple-webapp\n    labels:\n        app: App1\n        function: Front-end\n    # \u5efa\u7acb annotations\n    annotations:\n        buildversion: 1.34\n\nspec:\n    replicas: 3\n    selector:\n        matchLabels:\n            app: App1\ntemplate:\n    metadata:\n        labels:\n            app: App1\n            function: Front-end\nspec:\n    containers:\n    -   name: simple-webapp\n        image: simple-webapp   \n</code></pre> </li> <li>\u5c0d\u6240\u6709 K8s \u53e2\u96c6\u4e2d\u7684\u8cc7\u6e90/\u7269\u4ef6\uff0c\u4f7f\u7528 labels \u505a\u5206\u985e     </li> <li>\u5c0d\u6240\u6709 K8s \u53e2\u96c6\u4e2d\u7684\u8cc7\u6e90/\u7269\u4ef6\uff0c\u4f7f\u7528\u591a\u500b labels \u505a\u5206\u985e </li> <li> <p>labels &amp; selectors \u61c9\u7528</p> <ul> <li> <p>ReplicaSet     YAML<pre><code>apiVersion: apps/v1\nkind: ReplicaSet\n# ReplicaSet \u7684 metadata\nmetadata:\n    name: simple-webapp\n    # \u5efa\u7acb labels\n    labels:\n        app: App1\n        function: Front-end\n\nspec:\n    replicas: 3\n    # \u4f7f\u7528 selectors \u4f86\u9078\u64c7\u8981\u7ba1\u7406\u7684\u7269\u4ef6\n    selector:\n        matchLabels:\n            app: App1\n    template:\n        # Pod \u7684 metadata (\u8f03\u91cd\u8981)\n        metadata:\n                app: App1\n            labels:\n                function: Front-end\n    spec:\n        containers:\n        -   name: simple-webapp\n            image: simple-webapp\n</code></pre></p> <p></p> </li> <li> <p>Service     YAML<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n    name: my-service\n\nspec:\n    # \u4f7f\u7528 selectors \u4f86\u9078\u64c7\u8981\u7ba1\u7406\u7684\u7269\u4ef6\n    selector:\n        app: App1\n    ports:\n    -   protocol: TCP\n        port: 80\n        targetPort: 9376 \n</code></pre></p> <p></p> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#taints-tolerations","title":"Taints &amp; Tolerations","text":"<ul> <li>\u70ba\u4e86\u9650\u5236 Node \u63a5\u53d7\u67d0\u4e9b Pod \u7684\u6392\u7a0b\uff0c\u4e26\u8b93\u53ef\u4ee5 tolerate \u7279\u5b9a taint \u7684 Pod \u88ab\u6392\u7a0b\u5230\u8a72 Node \u4e0a<ul> <li>\u6ce8\u610f! taints &amp; tolerations \u4e26\u4e0d\u6703\u544a\u8a34 Pod \u53bb\u7279\u5b9a\u7684 Node \u4e0a\uff0c\u800c\u662f\u544a\u8a34 taint Node \u50c5\u80fd\u63a5\u53d7\u5177\u6709\u7279\u5b9a tolerations \u7684 Pod</li> <li>taints &amp; tolerations \u8207\u5b89\u5168\u6027\u6216\u5165\u4fb5\u7121\u95dc\uff0c\u50c5\u662f\u7528\u4f86\u9650\u5236 Pod \u7684\u6392\u7a0b </li> </ul> </li> <li> <p>taints (\u6c61\u9ede)</p> <ul> <li>\u8a2d\u5b9a\u65bc Node \u4e0a</li> <li>\u529f\u80fd: \u53ef\u4ee5\u8a2d\u5b9a\u7576\u4e0d\u80fd tolerate \u7684 Pod \u88ab\u6392\u7a0b\u5230\u8a72 Node \u4e0a\u6642\uff0c\u8a72\u5982\u4f55\u8655\u7406\uff1f<ul> <li>NoSchedule: \u8868\u793a\u65b0 Pod \u4e0d\u6703\u88ab\u6392\u7a0b\u5230\u9019\u500b\u7bc0\u9ede\u4e0a\uff0c\u9664\u975e\u9019\u4e9b Pod \u6709\u76f8\u61c9\u7684 toleration<ul> <li>\u7528\u9014: \u7528\u65bc\u5f37\u5236\u6027\u5730\u907f\u514d Pod \u88ab\u6392\u7a0b\u5230\u7279\u5b9a\u7bc0\u9ede\u4e0a</li> </ul> </li> <li>PreferNoSchedule: \u8868\u793a Kubernetes \u6703\u76e1\u91cf\u907f\u514d\u5c07 Pod \u6392\u7a0b\u5230\u9019\u500b\u7bc0\u9ede\u4e0a\uff0c\u4f46\u9019\u4e0d\u662f\u5f37\u5236\u7684\u3002\u82e5\u6c92\u6709\u5176\u4ed6\u5408\u9069\u7684\u7bc0\u9ede\uff0cPod \u4ecd\u7136\u53ef\u80fd\u6703\u88ab\u6392\u7a0b\u5230\u9019\u500b\u7bc0\u9ede\u4e0a<ul> <li>\u7528\u9014: \u7528\u65bc\u8edf\u6027\u5730\u907f\u514d Pod \u6392\u7a0b\u5230\u7279\u5b9a\u7bc0\u9ede\u4e0a\uff0c\u4f46\u5728\u8cc7\u6e90\u4e0d\u8db3\u6216\u5176\u4ed6\u60c5\u6cc1\u4e0b\u5141\u8a31\u4f8b\u5916</li> </ul> </li> <li>NoExecute: \u8868\u793a\u4e0d\u50c5\u65b0 Pod \u7121\u6cd5\u88ab\u6392\u7a0b\u5230\u9019\u500b\u7bc0\u9ede\u4e0a\uff0c\u5df2\u7d93\u5728\u9019\u500b\u7bc0\u9ede\u4e0a\u7684 Pod \u4e5f\u6703\u88ab\u9a45\u9010 (\u9664\u975e\u9019\u4e9b Pod \u6709\u76f8\u61c9\u7684 toleration)<ul> <li>\u7528\u9014: \u7528\u65bc\u5728\u7bc0\u9ede\u72c0\u614b\u6539\u8b8a\u6216\u9700\u8981\u9032\u884c\u7dad\u8b77\u6642\uff0c\u9a45\u9010\u4e0d\u7b26\u5408\u689d\u4ef6\u7684 Pod</li> </ul> </li> </ul> </li> <li>\u8a2d\u5b9a taints     Bash<pre><code>kubectl taint nodes node1 app=blue:NoSchedule\n</code></pre></li> </ul> <p></p> <ul> <li>\u53bb\u9664 taints     Bash<pre><code>kubectl taint nodes node1 app=blue:NoSchedule-\n</code></pre></li> </ul> </li> <li> <p>tolerations (\u5bb9\u5fcd)</p> <ul> <li>\u9810\u8a2d\u6240\u6709 Pod \u90fd\u4e0d\u6703\u6709 tolerations</li> <li>\u529f\u80fd: \u8a2d\u5b9a\u65bc Pod \u4e0a\uff0c\u6982\u5ff5\u4e0a\u5982\u540c taints\uff0c\u53ea\u662f\u8981\u5beb\u5728 Pod \u7684 YAML manifest \u8a2d\u5b9a\u6a94\u4e2d</li> <li>\u8a2d\u5b9a tolerations     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp-pod\n\nspec:\n    containers:\n    -   name: nginx-container\n        image: nginx\n\n    # \u8a2d\u5b9a tolerations\uff0c\u4ee5 key-value pair \u8868\u793a\uff0c\u5176\u4e2d value \u9700\u52a0\u4e0a\u96d9\u5f15\u865f \" \"\n    tolerations:\n    -   key: \"app\"\n        operator: \"Equal\"\n        value: \"blue\"\n        effect: \"NoSchedule\"\n</code></pre></li> </ul> <p></p> </li> <li> <p>\u70ba\u4ec0\u9ebc K8s \u53e2\u96c6\u7684 master node \u4e0d\u6703\u88ab\u6392\u7a0b Pod\uff1f</p> <ul> <li> <p>\u56e0\u70ba\u5728 K8s \u53e2\u96c6\u521d\u59cb\u5316\u6642\uff0cmaster node \u6703\u81ea\u52d5\u88ab\u8a2d\u5b9a taints (\u9810\u8a2d\u70ba NoSchedule)\uff0c\u4e14 Pod \u672a\u8a2d\u5b9a tolerations     Bash<pre><code>kubectl describe node kubemaster | grep Taint\n</code></pre></p> <p></p> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#node-selectors","title":"Node Selectors","text":"<ul> <li>\u7528\u9014: \u7528\u4f86\u9650\u5236 Pod \u88ab\u6392\u7a0b\u5230\u6307\u5b9a\u7684 Node \u4e0a</li> </ul> <p>\u60c5\u5883: \u5047\u8a2d\u6709\u4e09\u500b Node (node-1, node-2, node-3)\uff0c\u6839\u64da\u5176\u8cc7\u6e90\u914d\u7f6e\u5206\u5225\u70ba large, medium, small\uff0c\u4e26\u5206\u5225\u70ba\u5176\u8a2d\u5b9a labels</p> <p></p> <ul> <li>\u6b65\u9a5f 1: \u5206\u5225\u70ba Pod \u8a2d\u5b9a labels     Bash<pre><code>kubectl label nodes node-1 size=large\nkubectl label nodes node-2 size=medium\nkubectl label nodes node-3 size=small\n</code></pre> </li> <li>\u6b65\u9a5f 2: \u5efa\u7acb Pod \u7684 YAML manifest \u8a2d\u5b9a\u6a94\uff0c\u4e26\u8a2d\u5b9a nodeSelector     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp-pod\n\nspec:\n    containers:\n    -   name: data-processor\n        image: data-processor\n    # \u6839\u64da\u6307\u5b9a\u7684 label\uff0c\u8a2d\u5b9a nodeSelector\uff0c\u4ee5\u9650\u5236 Pod \u88ab\u6392\u7a0b\u5230\u6307\u5b9a\u7684 Node \u4e0a\n    nodeSelector:\n        size: Large\n</code></pre> </li> <li>\u6b65\u9a5f 3: \u5efa\u7acb Pod     Bash<pre><code>kubectl create -f pod-definition.yaml\n</code></pre></li> <li>nodeSelector \u7684\u9650\u5236<ul> <li>\u50c5\u80fd\u4f7f\u7528\u7b49\u65bc (Equal) \u904b\u7b97\u5b50</li> <li>\u82e5\u9047\u5230\u66f4\u8907\u96dc\u7684\u9700\u6c42\uff0c\u5c31\u5fc5\u9808\u4f7f\u7528 Node Affinity \u4f86\u89e3\u6c7a =&gt; e.g. Large or Medium, NOT Small </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#node-affinity","title":"Node Affinity","text":"<ul> <li>\u7528\u9014: \u78ba\u4fdd Pod \u80fd\u88ab\u6392\u7a0b\u5230\u6307\u5b9a\u7684 Node \u4e0a\uff0c\u4ee5\u7b26\u5408\u7279\u5b9a\u7684\u9700\u6c42</li> <li> <p>\u8a2d\u5b9a nodeAffinity     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp-pod\n\nspec:\n    containers:\n    -   name: data-processor\n        image: data-processor\n    # \u8a2d\u5b9a nodeAffinity\n    affinity:\n        nodeAffinity:\n            requiredDuringSchedulingIgnoredDuringExecution:\n                nodeSelectorTerms:\n                # \u53ef\u652f\u63f4\u66f4\u8907\u96dc\u7684\u9700\u6c42 (\u8868\u9054\u5f0f)\n                -   matchExpressions:\n                    -   key: size\n                        # \u904b\u7b97\u5b50\u9700\u4f7f\u7528 Pascal Case\n                        operator: In\n                        values: \n                        -   Large\n                        -   Medium\n</code></pre></p> YAML<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp-pod\n\nspec:\n    containers:\n    -   name: data-processor\n        image: data-processor\n    # \u8a2d\u5b9a nodeAffinity\n    affinity:\n        nodeAffinity:\n            requiredDuringSchedulingIgnoredDuringExecution:\n                nodeSelectorTerms:\n                # \u53ef\u652f\u63f4\u66f4\u8907\u96dc\u7684\u9700\u6c42 (\u8868\u9054\u5f0f)\n                -   matchExpressions:\n                    -   key: size\n                        # \u904b\u7b97\u5b50\u9700\u4f7f\u7528 Pascal Case\n                        operator: NotIn\n                        values: \n                        -   Small\n</code></pre> YAML<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\nname: myapp-pod\n\nspec:\n    containers:\n    -   name: data-processor\n        image: data-processor\n\n    # \u8a2d\u5b9a nodeAffinity\n    affinity:\n        nodeAffinity:\n            requiredDuringSchedulingIgnoredDuringExecution:\n                nodeSelectorTerms:\n                    # \u53ef\u652f\u63f4\u66f4\u8907\u96dc\u7684\u9700\u6c42 (\u8868\u9054\u5f0f)\n                    -   matchExpressions:\n                        -   key: size\n                            # \u53ef\u4f7f\u7528 Exists \u904b\u7b97\u5b50\n                            operator: Exists\n</code></pre> </li> <li> <p>nodeAffinity \u7684\u985e\u578b</p> <ul> <li> <p>\u76ee\u524d\u5df2\u53ef\u7528\u7684</p> <ul> <li>Type 1 <code>requiredDuringSchedulingIgnoredDuringExecution</code>: \u9019\u662f\u5f37\u5236\u6027\u7684 Node Affinity\u3002kube-scheduler \u53ea\u6703\u5c07 Pod \u6392\u7a0b\u5230\u6eff\u8db3\u6240\u6709\u6307\u5b9a Node Affinity \u689d\u4ef6\u7684\u7bc0\u9ede\u4e0a\u3002\u82e5\u6c92\u6709\u6eff\u8db3\u689d\u4ef6\u7684\u7bc0\u9ede\uff0cPod \u5c31\u7121\u6cd5\u88ab\u6392\u7a0b</li> <li>Type 2 <code>preferredDuringSchedulingIgnoredDuringExecution</code>: \u9019\u662f\u6709\u5f48\u6027\u7684 Node Affinity\u3002kube-scheduler \u6703\u76e1\u91cf\u5c07 Pod \u6392\u7a0b\u5230\u6eff\u8db3\u689d\u4ef6\u7684\u7bc0\u9ede\u4e0a\u3002\u4f46\u5982\u679c\u6c92\u6709\u7b26\u5408\u689d\u4ef6\u7684\u7bc0\u9ede\uff0cPod \u4ecd\u7136\u53ef\u4ee5\u88ab\u6392\u7a0b\u5230\u5176\u4ed6\u7bc0\u9ede </li> </ul> </li> <li> <p>\u672a\u4f86\u6b63\u5728\u898f\u5283\u4e2d\u7684</p> <ul> <li>Type 3 <code>requiredDuringSchedulingRequiredDuringExecution</code>: \u9019\u662f\u4e00\u500b\u8a08\u5283\u4e2d\u7684\u529f\u80fd\uff0c\u76ee\u524d\u5c1a\u672a\u5be6\u73fe\u3002kube-scheduler \u53ea\u6703\u5c07 Pod \u6392\u7a0b\u5230\u7b26\u5408\u689d\u4ef6\u7684\u7bc0\u9ede\u4e0a\u3002\u800c\u5728 Pod \u904b\u884c\u671f\u9593\uff0c\u82e5\u7bc0\u9ede\u4e0d\u518d\u7b26\u5408\u689d\u4ef6\uff0cPod \u6703\u88ab\u9a45\u9010</li> <li>Type 4 <code>preferredDuringSchedulingRequiredDuringExecution</code>: \u9019\u662f\u4e00\u500b\u8a08\u5283\u4e2d\u7684\u529f\u80fd\uff0c\u76ee\u524d\u5c1a\u672a\u5be6\u73fe\u3002kube-scheduler \u6703\u76e1\u91cf\u5c07 Pod \u6392\u7a0b\u5230\u7b26\u5408\u689d\u4ef6\u7684\u7bc0\u9ede\u4e0a\u3002\u800c\u5728 Pod \u904b\u884c\u671f\u9593\uff0c\u5982\u679c\u7bc0\u9ede\u4e0d\u518d\u7b26\u5408\u689d\u4ef6\uff0cPod \u6703\u88ab\u9a45\u9010 </li> </ul> </li> </ul> </li> <li> <p>\u53c3\u8003\u8cc7\u6599</p> <ul> <li>Schedule a Pod using required node affinity </li> <li>Node affinity</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#combine-taints-tolerations-node-affinity","title":"combine Taints &amp; Tolerations &amp; Node Affinity","text":"<p>\u60c5\u5883: \u5047\u8a2d\u6709\u4e94\u500b Node (Blue, Red, Green, Gray, Gray)\uff0c\u4e26\u4e14\u6709\u4e94\u500b Pods (blue, red, green, gray, gray)\u3002 \u6211\u5011\u5e0c\u671b\u5c07 blue Pod \u6392\u7a0b\u5230 Blue Node \u4e0a\uff0cred Pod \u6392\u7a0b\u5230 Red Node \u4e0a\uff0cgreen Pod \u6392\u7a0b\u5230 Green Node \u4e0a\uff0cgray Pod \u6392\u7a0b\u5230 Gray Node \u4e0a\u3002 \u4e5f\u5c31\u662f\u8aaa\uff0c\u5728\u6bcf\u500b\u984f\u8272\u7684 Node \u4e0a\uff0c\u50c5\u80fd\u6392\u7a0b\u5c0d\u61c9\u984f\u8272\u7684 Pod\u3002</p> <p></p> <ul> <li>Taints &amp; Tolerations: \u7121\u6cd5\u78ba\u4fdd Pod \u50c5\u6703\u88ab\u6392\u7a0b\u5230\u6307\u5b9a\u7684 Node \u4e0a\uff0c\u50c5\u80fd\u9650\u5236\u4e0d\u5177\u5099\u6307\u5b9a tolerations \u7684 Pod \u4e0d\u6703\u88ab\u6392\u7a0b\u5230\u6307\u5b9a taints \u7684 Node \u4e0a (\u56e0\u6b64\u4ecd\u7136\u53ef\u80fd\u6703\u767c\u751f\u975e\u9810\u671f\u7684\u932f\u8aa4\u7d50\u679c)<ul> <li>\u8a2d\u5b9a Node \u7684 taints     </li> <li>\u8a2d\u5b9a Pod \u7684 tolerations     </li> <li>\u7d50\u679c (\u4ecd\u7136\u53ef\u80fd\u6703\u767c\u751f Pod \u6392\u7a0b\u5230\u932f\u8aa4\u7684 Node \u4e0a =&gt; \u975e\u9810\u671f\u7d50\u679c)     </li> </ul> </li> <li>Node Selectors: \u50c5\u80fd\u9650\u5236\u6307\u5b9a\u7684 Pod \u6703\u88ab\u6392\u7a0b\u5230\u6307\u5b9a\u7684 Node \u4e0a\uff0c\u4f46\u7121\u6cd5\u9650\u5236\u5176\u4ed6 Pod \u4e5f\u88ab\u6392\u7a0b\u5230\u6307\u5b9a\u7684 Node \u4e0a     <ul> <li>\u7d50\u679c (\u4ecd\u7136\u53ef\u80fd\u6703\u767c\u751f Pod \u6392\u7a0b\u5230\u932f\u8aa4\u7684 Node \u4e0a =&gt; \u975e\u9810\u671f\u7d50\u679c)     </li> </ul> </li> <li>\u6b63\u78ba\u89e3\u6cd5: \u4f7f\u7528 Taints &amp; Tolerations \u9632\u6b62\u5176\u5b83 Pod \u653e\u5230\u932f\u8aa4\u7684 Node \u4e0a\u3002\u518d\u4f7f\u7528 Node Affinity \u9632\u6b62 Pod \u653e\u5230\u932f\u8aa4\u7684 Node \u4e0a<ul> <li>\u7d50\u679c (Pod \u6703\u88ab\u6b63\u78ba\u5730\u6392\u7a0b\u5230\u6307\u5b9a\u7684 Node \u4e0a)     </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#resource-requests-limits","title":"Resource requests &amp; limits","text":"<ul> <li> <p>\u7528\u9014: \u7528\u4f86\u9650\u5236 Pod \u4f7f\u7528\u7684 CPU \u548c memory \u8cc7\u6e90</p> <ul> <li>\u8cc7\u6e90\u985e\u578b<ul> <li>CPU: \u4ee5 CPU \u55ae\u4f4d (vCPU) \u4f86\u8868\u793a<ul> <li>\u6700\u4f73\u5be6\u8e10: \u8a2d\u5b9a CPU requests \u5c31\u597d </li> </ul> </li> <li>Memory: \u4ee5 memory \u55ae\u4f4d (MiB) \u4f86\u8868\u793a</li> </ul> </li> <li> <p>\u8cc7\u6e90\u8acb\u6c42\u8207\u9650\u5236</p> <ul> <li>requests: \u4ee3\u8868\u5bb9\u5668\u6b63\u5e38\u904b\u884c\u6642\uff0c\u6240\u9700\u7684\u6700\u4f4e\u8cc7\u6e90\u4e0b\u9650<ul> <li>K8s \u9810\u8a2d\u6bcf\u500b Pod \u7684 resource requests: CPU = 0.5 vCPU, memory = 256 MiB </li> </ul> </li> <li>limits: \u4ee3\u8868\u5bb9\u5668\u904b\u884c\u904e\u7a0b\u4e2d\uff0c\u80fd\u4f7f\u7528\u7684\u6700\u591a\u8cc7\u6e90\u4e0a\u9650<ul> <li>K8s \u9810\u8a2d\u6bcf\u500b Pod \u7684 resource limits: CPU = 1 vCPU, memory = 512 MiB </li> </ul> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: simple-webapp-color\n    labels:\n        name: simple-webapp-color\n\nspec:\n    containers:\n    -   name: simple-webapp-color\n        image: simple-webapp-color\n\n        ports:\n        -   containerPort:  8080\n\n        # \u8a2d\u5b9a resource requests &amp; limits\n        resources:\n            requests:\n                memory: \"1Gi\"\n                cpu: \"1\"\n            limits:\n                memory: \"2Gi\"\n                cpu: \"2\"\n</code></pre> </li> </ul> </li> <li> <p>\u8a2d\u5b9a Resource LimitRange: \u5e6b\u52a9\u6211\u5011\u5b9a\u7fa9\u6bcf\u500b Pod \u7684\u9810\u8a2d\u8cc7\u6e90\u8acb\u6c42\u8207\u9650\u5236</p> <ul> <li>\u6703\u5957\u7528\u5728\u672a\u4f86\u5efa\u7acb\u7684 Pod \u4e0a\uff0c\u4f46\u4e0d\u6703\u5957\u7528\u65bc\u6b63\u5728\u57f7\u884c\u4e2d\u7684 Pod \u4e0a</li> </ul> YAML<pre><code># limit-range-cpu.yaml\napiVersion: v1\nkind: LimitRange\nmetadata:\n    name: cpu-resource-constraint\n\nspec:\n    limits:\n    -  default: # limit\n            cpu: 500m # 0.5 vCPU\n        defaultRequest: # request\n            cpu: 500m # 0.5 vCPU\n        max: # limit\n            cpu: 1 # 1 vCPU\n        min: # request\n            cpu: 100m # 0.1 vCPU\n        type: Container\n</code></pre> YAML<pre><code># limit-range-memory.yaml\napiVersion: v1\nkind: LimitRange\nmetadata:\n    name: memory-resource-constraint\n\nspec:\n    limits:\n    -   default: # limit\n            memory: 1Gi # 1 GiB\n        defaultRequest: # request\n            memory: 1Gi # 1 GiB\n        max: # limit\n            memory: 1Gi # 1 GiB\n        min: # request\n            memory: 500Mi # 500 MiB\n        type: Container\n</code></pre> </li> <li> <p>\u8a2d\u5b9a Resource Quota: \u7528\u4f86\u8a2d\u5b9a\u6574\u500b Namespace \u7684\u8cc7\u6e90\u8acb\u6c42\u8207\u9650\u5236 YAML<pre><code># resource-quota.yaml\napiVersion: v1\nkind: ResourceQuota\nmetadata:\n    name: my-resource-quota\n\nspec:\n    hard:\n        pods: \"10\"\n        requests.cpu: \"4\"\n        requests.memory: 4Gi\n        limits.cpu: \"10\"\n        limits.memory: 10Gi\n</code></pre></p> <p> </p> </li> <li> <p>\u7576\u8d85\u904e resource limits \u7684\u9650\u5236\u6642</p> <ul> <li>CPU: \u6703\u88ab\u9650\u5236\u5728\u6307\u5b9a\u7684 CPU \u6578\u91cf\u4e0a\uff0c\u8d85\u904e\u7684\u90e8\u5206\u6703\u88ab\u66ab\u505c (throttle)<ul> <li>Pod \u6703\u986f\u793a\u8655\u65bc Pending \u72c0\u614b\uff0c\u56e0\u70ba kube-scheduler \u627e\u4e0d\u5230\u5177\u6709\u8db3\u5920 CPU \u4f86\u6392\u7a0b </li> </ul> </li> <li>Memory: \u6703\u88ab\u9650\u5236\u5728\u6307\u5b9a\u7684 memory \u4e0a\uff0c\u8d85\u904e\u7684\u90e8\u5206\u6703\u88ab\u522a\u9664 (terminate)<ul> <li>\u56e0\u70ba\u6211\u5011\u7121\u6cd5\u7bc0\u6d41 (throttle) memory\uff0c\u56e0\u6b64\u7576\u8d85\u904e memory limits \u6642\uff0c\u50c5\u80fd\u900f\u904e\u522a\u9664 Pod \u4f86\u91cb\u653e memory</li> <li>\u6703\u62cb\u51fa OOM \u932f\u8aa4 (Out Of Memory) </li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#daemonset","title":"DaemonSet","text":"<ul> <li>\u7528\u9014: \u985e\u4f3c ReplicaSet\uff0c\u80fd\u5e6b\u52a9\u6211\u5011\u5728\u5404\u500b Node \u4e0a\u90e8\u7f72\u591a\u500b\u76f8\u540c\u7684 Pod \u526f\u672c\u3002\u4f46\u662f DaemonSet \u50c5\u6703\u5728\u5404\u500b Node \u4e0a\u904b\u884c\u4e00\u500b Pod \u526f\u672c<ul> <li>\u7576\u6709\u65b0\u7684 Node \u52a0\u5165 K8s \u53e2\u96c6\u6642\uff0cDaemonSet \u6703\u81ea\u52d5\u5728\u65b0\u7684 Node \u4e0a\u90e8\u7f72\u4e00\u500b Pod \u526f\u672c</li> <li>\u7576\u6709 Node \u5f9e K8s \u53e2\u96c6\u4e2d\u79fb\u9664\u6642\uff0cDaemonSet \u6703\u81ea\u52d5\u522a\u9664\u8a72 Node \u4e0a\u7684 Pod \u526f\u672c </li> </ul> </li> <li>\u5e38\u898b\u61c9\u7528\u60c5\u5883: Monitoring solution, Logs viewer, kube-proxy, Networking solution      </li> <li> <p>\u5efa\u7acb DaemonSet</p> <ul> <li>\u985e\u4f3c\u65bc ReplicaSet \u7684 YAML manifest \u8a2d\u5b9a\u6a94\uff0c\u4f46\u662f kind \u8981\u6539\u6210 DaemonSet YAML<pre><code># daemonset-definition.yaml\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n    name: monitoring-daemon\n    labels:\n        app: nginx\n\nspec:\n    selector:\n        matchLabels:\n            app: monitoring-agent\n    template:\n        metadata:\n            labels:\n                app: monitoring-agent\n    spec:\n        containers:\n        -   name: monitoring-agent\n            image: monitoring-agent\n</code></pre></li> </ul> Bash<pre><code>kubectl create -f daemonset-definition.yaml\n</code></pre> </li> <li> <p>\u6aa2\u8996\u5728\u6240\u6709\u7684 Namespace \u4e2d\uff0c\u76ee\u524d\u6240\u6709\u7684 DaemonSet     Bash<pre><code>kubectl get daemonsets -A\n</code></pre></p> </li> <li> <p>\u8a73\u7d30\u6aa2\u8996\u6307\u5b9a DaemonSet \u7684\u8cc7\u8a0a     Bash<pre><code>kubectl describe daemonsets monitoring-daemon\n</code></pre></p> <p></p> </li> <li> <p>DaemonSet \u662f\u5982\u4f55\u5c07 Pod \u5206\u5225\u6392\u7a0b\u5230\u5404\u500b Node \u4e0a\u7684\uff1f</p> <ul> <li>\u5728 K8s v1.12 \u4e4b\u524d: \u4f7f\u7528 nodeSelector</li> <li>\u5728 K8s v1.12 \u4e4b\u5f8c: \u4f7f\u7528 Node Affinity, default kube-scheduler </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#static-pods","title":"Static Pods","text":"<ul> <li>Static Pod: \u5728 K8s \u53e2\u96c6\u4e2d\uff0c\u7531 kubelet \u76f4\u63a5\u7ba1\u7406\u7684 Pod\uff0c\u800c\u4e0d\u662f\u900f\u904e kube-apiserver \u4f86\u5efa\u7acb\u3001\u7ba1\u7406<ul> <li>kubelet \u6703\u81ea\u52d5\u76e3\u63a7\u3001\u555f\u52d5\u9019\u4e9b Static Pod</li> <li>\u4e0d\u6703\u88ab\u8a18\u9304\u5728 etcd \u4e2d\uff0c\u56e0\u6b64\u4e0d\u80fd\u900f\u904e <code>kubectl</code> \u6307\u4ee4\u4f86\u7ba1\u7406</li> </ul> </li> <li> <p>\u5047\u8a2d\u6c92\u6709 K8s \u53e2\u96c6\uff0c\u4e5f\u6c92\u6709 Master Node\uff0c\u4e5f\u6c92\u6709 kube-apiserver\u3002\u90a3\u9ebc Worker Node \u6703\u5982\u4f55\u904b\u4f5c\uff1f</p> <ul> <li>Ans: kubelet \u6703\u900f\u904e\u9810\u8a2d\u5728 <code>/etc/kubernetes/manifests</code> \u76ee\u9304\u4e0b\u7684 YAML manifest \u8a2d\u5b9a\u6a94\uff0c\u4f86\u5efa\u7acb Static Pods<ul> <li>\u6cd5 1: \u900f\u904e CLI \u7684 <code>--pod-manifest-path</code> \u9078\u9805\uff0c\u901a\u77e5 kubelet \u5efa\u7acb Static Pods     </li> <li>\u6cd5 2: \u7de8\u8f2f kubeconfig.yaml \u8a2d\u5b9a\u6a94\uff0c\u52a0\u5165 <code>staticPodPath: /etc/kubernetes/manifests</code> \u8a2d\u5b9a\uff0c\u901a\u77e5 kubelet \u5efa\u7acb Static Pods     </li> </ul> </li> <li> <p>\u9019\u6642\u5019\uff0c\u82e5\u8981\u6aa2\u8996\u7576\u524d\u6709\u54ea\u4e9b Static Pods\uff0c\u56e0\u70ba\u6211\u5011\u6c92\u6709\u4e00\u500b\u5b8c\u6574\u7684 K8s \u53e2\u96c6\uff0c\u56e0\u6b64\u53ea\u80fd\u900f\u904e Docker \u6307\u4ee4\u4f86\u67e5\u770b     Bash<pre><code>docker ps\n</code></pre></p> <p></p> </li> </ul> </li> <li> <p>kubelet \u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u5169\u7a2e\u65b9\u5f0f\uff0c\u5efa\u7acb Pod (\u5169\u7a2e Pods \u90fd\u53ef\u4ee5\u7d93\u7531 <code>kubectl get pods</code> \u67e5\u770b)</p> <ul> <li>\u7531 kube-apiserver \u904b\u7528 HTTP request\uff0c\u901a\u77e5 kubelet \u5efa\u7acb Pod</li> <li>kubelet \u6839\u64da <code>/etc/kubernetes/manifests</code> \u76ee\u9304\u4e0b\u7684 YAML manifest \u8a2d\u5b9a\u6a94\uff0c\u5efa\u7acb Static Pods<ul> <li>\u5176\u5be6\uff0c\u7576\u5efa\u7acb Static Pod \u6642\uff0c\u4e5f\u6703\u5728 kube-apiserver \u5efa\u7acb\u4e00\u500b read-only mirror object\u3002\u56e0\u6b64\uff0c\u5982\u679c\u8981\u7de8\u8f2f\u9019\u500b Static Pod\uff0c\u9084\u662f\u5fc5\u9808\u5230 Worker Node \u7684 <code>/etc/kubernetes/manifests</code> \u76ee\u9304\u4e0b\u7de8\u8f2f YAML manifest \u8a2d\u5b9a\u6a94 </li> </ul> </li> </ul> </li> <li> <p>Static Pod \u7684\u61c9\u7528\u60c5\u5883</p> <ul> <li>kubeadm \u8a2d\u5b9a K8s \u53e2\u96c6\u7684\u65b9\u5f0f: \u56e0\u70ba Static Pod \u4e0d\u9700\u8981\u4f9d\u8cf4 K8s \u53e2\u96c6\u7684\u7279\u6027\uff0c\u56e0\u6b64\u53ef\u5728\u5404\u7bc0\u9ede\u4e0a\uff0c\u900f\u904e kubelet \u5efa\u7acb Static Pod\uff0c\u4f86\u904b\u884c\u5404\u7a2e\u7cfb\u7d71\u670d\u52d9 (e.g. controller-manager, apiserver, etcd, scheduler)\u3002\u4e26\u4e14 kubelet \u6703\u81ea\u52d5\u7ba1\u7406\u9019\u4e9b\u7cfb\u7d71\u670d\u52d9\uff0c\u78ba\u4fdd\u5176\u6301\u7e8c\u904b\u884c  </li> </ul> </li> <li> <p>\u6aa2\u8996\u6240\u6709 Namespace \u4e2d\u6709\u5e7e\u500b Static Pods</p> <ul> <li>\u67e5\u770b Pod name \u7684\u5f8c\u7db4\uff0c\u6703\u5e36\u6709 Node name \u7684\u5c31\u662f Static Pods     </li> <li>\u6aa2\u8996 Static Pods \u7684\u8a73\u7d30\u8cc7\u8a0a: ownerReferences.kind = Node </li> </ul> </li> <li>Static Pod \u7684 YAML manifest \u8a2d\u5b9a\u6a94\u6703\u5b58\u653e\u5728\u54ea\uff1f<ul> <li>\u6b65\u9a5f 1: \u6aa2\u8996 kubelet \u7684 <code>/var/lib/kubelet/config.yaml</code> \u8a2d\u5b9a\u6a94\u5167\u5bb9\uff0c\u78ba\u8a8d staticPodPath: /etc/kubernetes/manifests \u7684\u8def\u5f91\u4f4d\u7f6e<ul> <li>\u9810\u8a2d\u6703\u653e\u5728 Node \u4e0a\u7684 <code>/etc/kubernetes/manifests</code> \u76ee\u9304\u4e0b</li> </ul> </li> <li>\u6b65\u9a5f 2: \u5230 staticPodPath \u78ba\u8a8d\u7576\u524d kubelet \u6709\u54ea\u4e9b\u95dc\u65bc Static Pod \u7684\u8a2d\u5b9a\u6a94     </li> </ul> </li> <li>Static Pods vs. DaemonSets     </li> </ul>"},{"location":"cloud/k8s/cka/#multiple-schedulers","title":"Multiple Schedulers","text":"<ul> <li>\u7528\u9014: \u53ef\u4ee5\u5728 K8s \u53e2\u96c6\u4e2d\uff0c\u540c\u6642\u90e8\u7f72\u591a\u500b scheduler     </li> <li>\u624b\u52d5\u5efa\u7acb\u4e00\u500b\u81ea\u5b9a\u7fa9\u7684 scheduler<ul> <li>\u6cd5 1: \u900f\u904e scheduler \u7684 binary \u6a94\uff0c\u5efa\u7acb scheduler<ul> <li>\u4e0b\u8f09 scheduler \u7684 binary \u6a94     Bash<pre><code>wget https://storage.googleapis.com/kubernetes-release/release/v1.12.0/bin/linux/amd64/kube-scheduler\n</code></pre></li> <li>\u6307\u5b9a scheduler \u540d\u7a31\uff0c\u4ee5\u53ca scheduler \u7684 YAML manifest \u8a2d\u5b9a\u6a94     </li> </ul> </li> <li>\u6cd5 2: \u5c07 scheduler \u8996\u70ba\u4e00\u500b Pod\uff0c\u5148\u5efa\u7acb scheduler-config \u6a94\u5f8c\uff0c\u518d\u5ba3\u544a <code>--config</code> \u9078\u9805\u4f86\u6307\u5b9a scheduler \u7684 YAML manifest \u8a2d\u5b9a\u6a94\u7684\u8def\u5f91<ul> <li><code>leaderElect</code>: true \u8868\u793a\u9019\u500b scheduler \u6703\u9078\u8209\u4e00\u500b leader\uff0c\u4e26\u4e14\u53ea\u6709 leader \u624d\u6703\u57f7\u884c\u4efb\u52d9 (\u56e0\u70ba\u5728 K8s \u53e2\u96c6\u4e2d\uff0c\u4e00\u6b21\u53ea\u80fd\u6709\u4e00\u500b scheduler \u8655\u65bc active \u72c0\u614b\uff0c\u4ee5\u907f\u514d\u6392\u7a0b\u6f14\u7b97\u6cd5\u7684\u6c7a\u7b56\u885d\u7a81\u554f\u984c)     </li> <li>\u5efa\u7acb scheduler Pod     Bash<pre><code>kubectl create -f my-custom-scheduler.yaml\n</code></pre></li> </ul> </li> </ul> </li> <li>\u6aa2\u8996\u6307\u5b9a Namespace \u4e2d\u7684\u6240\u6709 Scheduler Pods     Bash<pre><code>kubectl get pods -n kube-system\n</code></pre></li> <li> <p>\u904b\u7528\u525b\u525b\u5efa\u7acb\u7684 scheduler\uff0c\u5efa\u7acb\u4e00\u500b Pod: \u8a2d\u5b9a <code>schedulerName</code> \u53c3\u6578\u503c     YAML<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n    name: nginx\n\nspec:\n    containers:\n    -   image: nginx\n        name: nginx\n    # \u6307\u5b9a\u4f7f\u7528\u81ea\u5b9a\u7fa9\u7684 scheduler\n    schedulerName: my-custom-scheduler\n</code></pre></p> <p></p> </li> <li> <p>\u5982\u4f55\u67e5\u8a62\u54ea\u500b scheduler \u8ca0\u8cac\u6392\u7a0b\u54ea\u4e9b Pods\uff1f     Bash<pre><code>kubectl get events -o=wide\n</code></pre></p> <p></p> </li> <li> <p>\u5982\u4f55\u67e5\u8a62 scheduler \u7684\u6392\u7a0b\u8a18\u9304 log\uff1f     Bash<pre><code>kubectl logs my-custom-scheduler -n=kube-system\n</code></pre></p> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#configuring-scheduler-profiles","title":"Configuring Scheduler Profiles","text":"<ul> <li>\u6bcf\u500b scheduler \u90fd\u6703\u5177\u5099\u4ee5\u4e0b\u5e7e\u500b\u64f4\u5c55\u9ede (extension points)\uff0c\u80fd\u900f\u904e\u52a0\u5165\u63d2\u4ef6 (plugin) \u7684\u65b9\u5f0f\uff0c\u4f86\u64f4\u5c55 scheduler \u7684\u529f\u80fd<ul> <li>\u64f4\u5c55\u9ede (extension points): \u8868\u793a\u6392\u7a0b\u904e\u7a0b\u4e2d\u7684\u7279\u5b9a\u968e\u6bb5\uff0c\u9019\u4e9b\u968e\u6bb5\u80fd\u5141\u8a31\u4f7f\u7528\u8005\u63d2\u5165\u81ea\u5b9a\u7fa9\u63d2\u4ef6\u908f\u8f2f\uff0c\u4ee5\u4fee\u6539 or \u64f4\u5c55 scheduler \u7684\u884c\u70ba</li> <li>\u63d2\u4ef6 (plugins): \u9644\u52a0\u5728scheduler \u7684\u64f4\u5c55\u9ede\u4e0a\uff0c\u7528\u4f86\u81ea\u5b9a\u7fa9 or \u64f4\u5c55 scheduler \u7684\u884c\u70ba </li> </ul> </li> <li>\u5f9e K8s v.1.18 \u4ee5\u5f8c\uff0c\u80fd\u900f\u904e KubeSchedulerConfiguration \u7269\u4ef6\uff0c\u5728\u540c\u4e00\u4efd scheduler \u8a2d\u5b9a\u6a94\u4e2d\uff0c\u8a2d\u5b9a\u591a\u500b scheduler profiles<ul> <li><code>profiles</code>: \u80fd\u6307\u5b9a\u591a\u500b schedulerName\uff0c\u4ee5\u8a2d\u5b9a\u591a\u500b scheduler profiles<ul> <li><code>plugins</code>: \u53ef\u5206\u5225\u8a2d\u5b9a\u5404\u500b scheduler \u7684 plugins \u5167\u5bb9 </li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#logging-monitoring","title":"Logging &amp; Monitoring","text":""},{"location":"cloud/k8s/cka/#logging","title":"Logging","text":"<ul> <li> <p>Docker: \u57f7\u884c\u4e00\u500b\u6a21\u64ec\u7522\u751f log \u7684\u7a0b\u5f0f\uff0c\u4e26\u5be6\u6642\u67e5\u770b log \u8cc7\u8a0a     </p> <p><code>-f</code> \u53c3\u6578: \u8868\u793a follow\uff0c\u7528\u4f86\u5be6\u6642\u8ffd\u8e64 log \u8f38\u51fa\u8cc7\u8a0a\uff0c\u985e\u4f3c\u65bc Linux \u4e2d\u7684 tail -f \u547d\u4ee4 </p> </li> <li> <p>Kubernetes: \u5efa\u7acb\u4e26\u57f7\u884c\u4e00\u500b\u6a21\u64ec\u7522\u751f log \u7684 Pod\uff0c\u4e26\u5be6\u6642\u67e5\u770b log \u8cc7\u8a0a     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: event-simulator-pod\n\nspec:\n    containers:\n    -   name: event-simulator\n        image: kodekloud/event-simulator\n</code></pre></p> Bash<pre><code>kubectl logs -f event-simulator-pod\n</code></pre> <p></p> </li> <li> <p>\u82e5\u5728\u4e00\u500b Pod \u4e2d\uff0c\u6709\u591a\u500b container\uff0c\u5247\u9700\u6307\u5b9a container name     Bash<pre><code># kubectl logs -f &lt;pod-name&gt; -c &lt;container-name&gt;\nkubectl logs -f even-simulator-pod -c event-simulator\n</code></pre></p> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#monitoring","title":"Monitoring","text":"<ul> <li> <p>\u622a\u81f3\u76ee\u524d(2024)\uff0cK8s \u5b98\u65b9\u4e26\u7121\u5167\u5efa\u7684\u5168\u529f\u80fd\u76e3\u63a7\u5de5\u5177\uff0c\u56e0\u6b64\u9700\u8981\u900f\u904e\u7b2c\u4e09\u65b9\u958b\u6e90\u5de5\u5177\u4f86\u76e3\u63a7 K8s \u53e2\u96c6     </p> </li> <li> <p>Heapster \u66fe\u7d93\u662f K8s \u5b98\u65b9\u7684\u76e3\u63a7\u5de5\u5177\uff0c\u4f46\u5728 K8s v1.11 \u4e4b\u5f8c\uff0c\u5df2\u7d93\u88ab\u6dd8\u6c70\u3002\u73fe\u5df2\u7531 Metrics Server \u53d6\u4ee3 </p> </li> <li> <p>Metrics Server</p> <ul> <li>\u50c5\u63d0\u4f9b\u57fa\u672c\u7684\u76e3\u63a7\u529f\u80fd (e.g. CPU, Memory \u4f7f\u7528\u7387)\uff0c\u4e26\u4e0d\u63d0\u4f9b\u9032\u968e\u7684\u76e3\u63a7\u529f\u80fd (log \u6536\u96c6\u3001\u9032\u968e\u5206\u6790\u3001\u8996\u89ba\u5316\u986f\u793a)</li> <li>\u50c5\u6703\u5c07\u5404\u500b Node \u4e0a\u7684 metrics \u8cc7\u6599\uff0c\u5132\u5b58\u5728 in-memory \u4e2d\uff0c\u800c\u4e0d\u6703\u5132\u5b58\u5728\u786c\u789f\u4e2d\uff0c\u56e0\u6b64\u6211\u5011\u7121\u6cd5\u900f\u904e Metrics Server \u67e5\u8a62\u6b77\u53f2\u76e3\u63a7\u8cc7\u6599</li> </ul> <p></p> </li> <li> <p>\u6bcf\u500b Node \u662f\u5982\u4f55\u6536\u96c6\u76e3\u63a7\u6307\u6a19\u7684\u8cc7\u6599\u5462\uff1f</p> <ul> <li>\u900f\u904e kubelet \u7684 cAdvisor \u4f86\u6536\u96c6 Pod \u7684\u76e3\u63a7\u6307\u6a19\u8cc7\u6599\uff0c\u4e26\u5b9a\u671f\u5411 Metrics Server \u56de\u5831</li> </ul> <p></p> </li> <li> <p>\u555f\u52d5 Metrics Server</p> <ul> <li>\u6cd5 1 (minikube):     Bash<pre><code>minikube addons enable metrics-server\n</code></pre></li> <li> <p>\u6cd5 2 (\u5176\u5b83\u60c5\u6cc1):     Bash<pre><code>git clone https://github.com/kubernetes-incubator/metrics-server.git\n</code></pre></p> Bash<pre><code>kubectl create -f metric-server/deploy/1.8+/\n</code></pre> </li> </ul> <p></p> </li> <li> <p>\u76e3\u63a7 Node-level \u7684\u6307\u6a19</p> <ul> <li>\u6b63\u5728\u904b\u884c\u4e2d\u7684\u7bc0\u9ede\u6578\u91cf</li> <li>CPU \u4f7f\u7528\u7387</li> <li>Memory \u4f7f\u7528\u7387</li> <li>Disk \u4f7f\u7528\u7387</li> <li>Network \u4f7f\u7528\u7387</li> </ul> Bash<pre><code>kubectl top node\n</code></pre> </li> <li> <p>\u76e3\u63a7 Pod-level \u7684\u6307\u6a19</p> <ul> <li>\u6b63\u5728\u904b\u884c\u4e2d\u7684 Pod \u6578\u91cf</li> <li>CPU \u4f7f\u7528\u7387</li> <li>Memory \u4f7f\u7528\u7387</li> <li>Disk \u4f7f\u7528\u7387</li> <li>Network \u4f7f\u7528\u7387</li> </ul> Bash<pre><code>kubectl top pod\n</code></pre> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#application-lifecycle-management","title":"Application Lifecycle Management","text":""},{"location":"cloud/k8s/cka/#rolling-updates-and-rollbacks-in-deployments","title":"Rolling Updates and Rollbacks in Deployments","text":"<ul> <li>\u7576\u6211\u5011\u7b2c\u4e00\u6b21\u5efa\u7acb Deployment\uff0c\u6703\u89f8\u767c\u4e00\u500b Rollout\uff0c\u7522\u751f\u4e00\u500b Revision\u3002\u800c\u4e4b\u5f8c\u7684\u6bcf\u6b21\u66f4\u65b0\uff0c\u90fd\u6703\u89f8\u767c\u4e00\u500b\u65b0\u7684 Rollout\uff0c\u7522\u751f\u4e00\u500b\u65b0\u7684 Revision     </li> </ul>"},{"location":"cloud/k8s/cka/#deployment-rollout-strategy","title":"Deployment-Rollout Strategy","text":"<ul> <li>\u5efa\u7acb Deployment     Bash<pre><code>kubectl create deployment nginx --image=nginx\n</code></pre></li> <li>\u67e5\u770b\u7576\u524d Deployment \u7684\u6efe\u52d5\u66f4\u65b0\u72c0\u614b\uff0c\u544a\u8a34\u6211\u5011\u65b0\u7684 Pod \u662f\u5426\u5df2\u7d93\u5c31\u7dd2     Bash<pre><code>kubectl rollout status deployment/myapp-deployment\n</code></pre></li> <li> <p>\u67e5\u770b Deployment \u7684\u6b77\u53f2\u8a18\u9304\uff0c\u5305\u542b\u6bcf\u6b21\u8b8a\u66f4\u7684\u4fee\u8a02\u7248\u672c\u3001\u8b8a\u66f4\u539f\u56e0     Bash<pre><code>kubectl rollout history deployment/myapp-deployment\n</code></pre></p> <p> </p> </li> <li> <p>Deployment \u7684\u5169\u7a2e Rollout \u7b56\u7565</p> <ul> <li>Recreate: \u5148\u522a\u9664\u820a\u7684 Pod\uff0c\u518d\u5efa\u7acb\u65b0\u7684 Pod</li> <li>RollingUpdate (\u9810\u8a2d): \u6efe\u52d5\u66f4\u65b0\uff0c\u9010\u6b65\u522a\u9664\u820a\u7684 Pod\uff0c\u4e26\u5efa\u7acb\u65b0\u7684 Pod<ul> <li><code>maxUnavailable</code>: \u4e00\u6b21\u6700\u591a\u522a\u9664\u591a\u5c11\u500b Pod</li> <li><code>maxSurge</code>: \u4e00\u6b21\u6700\u591a\u65b0\u589e\u591a\u5c11\u500b Pod </li> </ul> </li> </ul> </li> <li> <p>\u66f4\u65b0 Deployment \u7684 Rollout \u7b56\u7565</p> <ul> <li> <p>\u6cd5 1: \u900f\u904e <code>kubectl edit</code> \u6307\u4ee4\uff0c\u7de8\u8f2f Deployment \u7684 YAML manifest \u8a2d\u5b9a\u6a94     Bash<pre><code>kubectl edit deployment-definition.yaml\n</code></pre></p> YAML<pre><code># deployment-definition.yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n    name: myapp-deployment\n    labels:\n        app: nginx\nspec:\n    template:\n        metadata:\n            name: myap-pod\n            labels:\n                app: myapp\n                type: front-end\n        spec:\n            containers:\n            -   name: nginx-container\n                image: nginx:1.7.1\n\n    replicas: 3\n    selector:\n        matchLabels:\n            type: front-end\n</code></pre> Bash<pre><code>kubectl apply -f deployment-definition.yaml\n</code></pre> </li> <li> <p>\u6cd5 2: \u900f\u904e <code>kubectl set</code> \u6307\u4ee4\uff0c\u8a2d\u5b9a Deployment \u7684 Rollout \u7b56\u7565     Bash<pre><code>kubectl set image deployment/myapp-deployment nginx=nginx:1.9.1\n</code></pre></p> <p></p> </li> </ul> </li> <li> <p>\u5347\u7d1a Deployment \u7684\u7248\u672c: K8s \u53e2\u96c6\u6703\u5efa\u7acb\u4e00\u500b\u65b0\u7684 ReplicaSet \u4f86\u5efa\u7acb\u65b0\u7684 Pods     </p> </li> <li> <p>\u56de\u6efe Deployment \u7684\u7248\u672c: \u904b\u7528 <code>kubectl rollout undo</code> \u6307\u4ee4\uff0cK8s \u53e2\u96c6\u6703\u5c07\u65b0\u7684 ReplicaSet \u4e2d\u7684 Pods \u522a\u9664\uff0c\u4e26\u91cd\u65b0\u5efa\u7acb\u820a\u7684 ReplicaSet \u4e2d\u7684 Pods     Bash<pre><code>kubectl rollout undo deployment/myapp-deployment\n</code></pre></p> <p></p> </li> <li> <p>\u7d71\u6574: \u95dc\u65bc Deployment \u7684\u5e38\u898b kubectl \u6307\u4ee4     Bash<pre><code>kubectl create -f deployment-definition.yaml\nkubectl get deployments\nkubectl apply -f deployment-definition.yaml\nkubectl set image deployment/myapp-deployment nginx=nginx:1.9.1\nkubectl rollout status deployment/myapp-deployment\nkubectl rollout history deployment/myapp-deployment\nkubectl rollout undo deployment/myapp-deployment\n</code></pre></p> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#configure-applications","title":"Configure Applications","text":"<ul> <li>\u8a2d\u5b9a\u61c9\u7528\u7a0b\u5f0f\u7684 Command &amp; Arguments<ul> <li>container \u4e0d\u662f\u7528\u4f86\u8a17\u7ba1\u4f5c\u696d\u7cfb\u7d71\uff08operating system\uff09\u7684\uff0c\u800c\u662f\u7528\u4f86\u57f7\u884c\u7279\u5b9a\u4efb\u52d9 or \u9032\u7a0b\uff08process\uff09\uff0c\u4f8b\u5982: \u7db2\u9801\u4f3a\u670d\u5668\u3001\u61c9\u7528\u7a0b\u5f0f\u4f3a\u670d\u5668\u3001\u8cc7\u6599\u5eab\u4f3a\u670d\u5668...\u7b49<ul> <li>\u7576\u4efb\u52d9\u5b8c\u6210\u5f8c\uff0ccontainer \u6703\u81ea\u52d5\u7d50\u675f\uff08\u4ea6\u5373\uff0ccontainter \u50c5\u5728\u5176\u5167\u90e8\u7684 process \u8655\u65bc active \u72c0\u614b\u6642\uff0c\u624d\u6703\u5b58\u5728\uff09</li> <li>\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0cDocker \u5728\u57f7\u884c\u6642\uff0c\u4e0d\u6703\u5c07 terminal \u9644\u52a0\u5230 container \u4e0a </li> </ul> </li> </ul> </li> <li>\u5982\u4f55\u6307\u5b9a\u4e0d\u540c\u7684\u6307\u4ee4\uff0c\u4f86\u555f\u52d5 container \u5462\uff1f<ul> <li>\u6cd5 1 (\u81e8\u6642\u4f5c\u6cd5): \u7576 Docker \u57f7\u884c\u6642\uff0c\u5728 CLI \u52a0\u4e0a\u6307\u5b9a\u7684\u57f7\u884c\u9078\u9805     Bash<pre><code>docker run ubuntu sleep 5\n</code></pre></li> <li>\u6cd5 2 (\u6c38\u4e45\u4f5c\u6cd5): \u53ef\u900f\u904e\u8a2d\u5b9a Dockerfile \u7684 <code>ENTRYPOINT</code>\u3001<code>CMD</code> \u6307\u4ee4<ul> <li><code>ENTRYPOINT</code>: \u5b9a\u7fa9 container \u555f\u52d5\u6642\uff0c\u4e00\u5b9a\u8981\u5148\u57f7\u884c\u7684\u6307\u4ee4</li> <li><code>CMD</code>: \u5b9a\u7fa9 container \u555f\u52d5\u6642\uff0c\u8981\u57f7\u884c\u7684\u6307\u4ee4<ul> <li>Tips: \u5fc5\u9808\u7528\u9663\u5217 <code>[ ]</code> \u4f86\u8868\u793a\uff0c\u4e14\u5176\u4e2d\u7684\u5143\u7d20\u90fd\u5fc5\u9808\u7528\u96d9\u62ec\u5f27 <code>\" \"</code> \u4f86\u8868\u793a\uff0c\u9663\u5217\u5143\u7d20\u4e4b\u9593\u9700\u7528\u9017\u865f <code>,</code> \u505a\u5206\u9694  </li> </ul> </li> <li>\u5efa\u7acb Dockerfile     Docker<pre><code>FROM ubuntu\nCMD [\"sleep\", \"5\"]\n</code></pre></li> <li>\u5efa\u7acb Docker image     Bash<pre><code>docker build -t ubuntu-sleeper .\n</code></pre></li> <li>\u57f7\u884c Docker container     Bash<pre><code>docker run ubuntu-sleeper\n</code></pre></li> </ul> </li> </ul> </li> <li> <p>Dockerfile <code>CMD</code> vs. <code>ENTRYPOINT</code> \u7684\u61c9\u7528</p> <ul> <li>\u60c5\u6cc1 1: \u50c5\u5ba3\u544a <code>CMD</code>\u3002\u7576 Docker \u57f7\u884c\u5bb9\u5668\u6642\uff0c\u53ef\u900f\u904e CLI \u50b3\u905e\u6307\u4ee4\u3001\u53c3\u6578\uff0c\u4f86\u8986\u5beb <code>CMD</code> \u6307\u4ee4</li> <li>\u60c5\u6cc1 2: \u50c5\u5ba3\u544a <code>ENTRYPOINT</code>\u3002\u7576 Docker \u57f7\u884c\u5bb9\u5668\u6642\uff0c\u53ea\u8981\u50b3\u905e\u53c3\u6578\u5373\u53ef</li> <li> <p>\u60c5\u6cc1 3: \u50c5\u5ba3\u544a <code>ENTRYPOINT</code>\uff0c\u4f46 Docker \u57f7\u884c\u5bb9\u5668\u6642\uff0c\u672a\u50b3\u905e\u53c3\u6578 =&gt; \u6703\u5831\u932f\uff08missing operand\uff09 </p> </li> <li> <p>\u60c5\u6cc1 4: \u540c\u6642\u5ba3\u544a <code>ENTRYPOINT</code> \u8207 <code>CMD</code>\u3002\u7576 Docker \u57f7\u884c\u5bb9\u5668\u6642\uff0c<code>CMD</code> \u6307\u4ee4\u6703\u4f5c\u70ba\u53c3\u6578\uff0c\u50b3\u905e\u7d66 <code>ENTRYPOINT</code> \u6307\u4ee4</p> </li> <li>\u60c5\u6cc1 5: \u540c\u6642\u5ba3\u544a <code>ENTRYPOINT</code> \u8207 <code>CMD</code>\uff0c\u4e14\u7576 Docker \u57f7\u884c\u5bb9\u5668\u6642\uff0c\u900f\u904e CLI \u50b3\u905e\u53c3\u6578\uff0c\u6703\u8986\u5beb\u539f\u672c\u7684 <code>CMD</code> \u6307\u4ee4</li> <li>\u60c5\u6cc1 6: \u540c\u6642\u5ba3\u544a <code>ENTRYPOINT</code> \u8207 <code>CMD</code>\uff0c\u4e14\u7576 Docker \u57f7\u884c\u5bb9\u5668\u6642\uff0c\u900f\u904e CLI \u50b3\u905e\u53c3\u6578\uff0c\u6703\u8986\u5beb\u539f\u672c\u7684 <code>ENTRYPOINT</code> \u6307\u4ee4 </li> </ul> </li> <li> <p>Dockerfile vs. Kubernetes Pod YAML manifest \u8a2d\u5b9a\u6a94</p> <ul> <li>Dockerfile     Docker<pre><code>FROM ubuntu\nENTRYPOINT [\"sleep\"]\nCMD [\"5\"]\n</code></pre></li> <li>K8s Pod \u7684 YAML manifest \u8a2d\u5b9a\u6a94     YAML<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n    name: ubuntu-sleeper-pod\n\nspec:\n    containers:\n    -   name: ubuntu-sleeper\n        image: ubuntu-sleeper\n        command: [\"sleep2.0\"]\n        args: [\"10\"]\n</code></pre></li> <li>\u6ce8\u610f! Dockerfile \u4e2d\u7684 <code>ENTRYPOINT</code> \u6307\u4ee4\uff0c\u6703\u5c0d\u61c9\u5230 K8s Pod YAML manifest \u8a2d\u5b9a\u6a94\u4e2d\u7684 <code>command</code> \u6b04\u4f4d; \u800c <code>CMD</code> \u6307\u4ee4\uff0c\u5247\u6703\u5c0d\u61c9\u5230 <code>args</code> \u6b04\u4f4d </li> </ul> </li> <li> <p>\u8a2d\u5b9a\u74b0\u5883\u8b8a\u6578</p> <ul> <li>\u6cd5 1: \u904b\u7528\u55ae\u7d14\u7684 key-value \u9375\u503c\u5c0d\uff0c\u8a2d\u5b9a\u74b0\u5883\u8b8a\u6578</li> <li>\u6cd5 2: \u904b\u7528 K8s ConfigMap\uff0c\u8a2d\u5b9a\u74b0\u5883\u8b8a\u6578\u3002\u9700\u7528\u9663\u5217 <code>[ ]</code> \u8868\u793a\uff0c\u4ee5\u53ca\u4f7f\u7528 <code>valueFrom.configMapKeyRef</code> \u4f86\u7d66\u5b9a ConfigMap</li> <li>\u6cd5 3: \u904b\u7528 K8s Secrets\uff0c\u8a2d\u5b9a\u74b0\u5883\u8b8a\u6578\u3002\u9700\u7528\u9663\u5217 <code>[ ]</code> \u8868\u793a\uff0c\u4ee5\u53ca\u4f7f\u7528 <code>valueFrom.secretKeyRef</code> \u4f86\u7d66\u5b9a Secrets </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#configmap","title":"ConfigMap","text":"<ul> <li>\u7528\u9014: \u5132\u5b58\u61c9\u7528\u7a0b\u5f0f\u7684\u8a2d\u5b9a\u8cc7\u6599</li> <li> <p>\u5efa\u7acb ConfigMap</p> <ul> <li> <p>\u547d\u4ee4\u5f0f (Imperative):      Bash<pre><code># \u5728 CLI \u4e0a\uff0c\u76f4\u63a5\u7d66\u5b9a key-value \u5c0d\uff0c\u4f86\u5efa\u7acb ConfigMap\nkubectl create configmap app-config --from-literal=APP_COLOR=blue --from-literal=APP_MODE=prod\n</code></pre></p> Bash<pre><code># \u900f\u904e\u6a94\u6848\u4f86\u5efa\u7acb ConfigMap\nkubectl create configmap app-config --from-file=app_config.properties\n</code></pre> <p></p> </li> <li> <p>\u5ba3\u544a\u5f0f (Declarative):     YAML<pre><code># configmap-definition.yaml\napiVersion: v1\nkind: ConfigMap\n    metadata:\n        name: app-config\n    data:\n        APP_COLOR: blue\n        APP_MODE: prod\n</code></pre></p> Bash<pre><code>kubectl create -f configmap-definition.yaml\n</code></pre> <p> </p> </li> </ul> </li> <li> <p>\u6ce8\u5165 ConfigMap \u5230 Pod \u4e2d</p> <ul> <li> <p><code>envFrom.configMapRef</code>: \u9069\u7528\u65bc\u9700\u8981\u5c07\u6240\u6709 ConfigMap \u7684 key-value \u5c0d\uff0c\u90fd\u4f5c\u70ba\u74b0\u5883\u8b8a\u6578\u7684\u60c5\u6cc1     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: simple-webapp-color\nspec:\n    containers:\n    -   name: simple-webapp-color\n        image: simple-webapp-color\n        ports:\n        - containerPort: 8080\n\n        # \u6ce8\u5165 ConfigMap \u5230 Pod \u4e2d (`envFrom` \u63a1\u7528\u9663\u5217\u8868\u793a)\n        envFrom:\n        - configMapRef:\n            name: app-config\n</code></pre></p> YAML<pre><code># configmap-definition.yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n    name: app-config\ndata:\n    APP_COLOR: blue\n    APP_MODE: prod\n</code></pre> Bash<pre><code>kubectl create -f pod-definition.yaml\n</code></pre> <p></p> </li> <li> <p>\u5176\u5b83\u65b9\u5f0f</p> <ul> <li><code>env.valueFrom.configMapKeyRef</code>: \u9069\u7528\u65bc\u53ea\u9700\u8981\u7279\u5b9a ConfigMap \u7684 key-value \u5c0d\uff0c\u4f5c\u70ba\u74b0\u5883\u8b8a\u6578\u7684\u60c5\u6cc1</li> <li><code>volumes.configMap</code>: \u9069\u7528\u65bc\u61c9\u7528\u7a0b\u5f0f\uff0c\u9700\u8981 volume \u5f62\u5f0f\u7684\u8a2d\u5b9a\u8cc7\u6599\uff0c\u4f5c\u70ba\u74b0\u5883\u8b8a\u6578\u7684\u60c5\u6cc1 </li> </ul> </li> </ul> </li> <li> <p>\u67e5\u8a62\u76ee\u524d\u6709\u54ea\u4e9b ConfigMaps     Bash<pre><code>kubectl get configmaps \n# (or)\n# kubectl get cm\n</code></pre></p> <p></p> </li> <li> <p>\u8a73\u7d30\u6aa2\u8996\u6307\u5b9a\u7684 ConfigMap     Bash<pre><code>kubectl describe configmap app-config -o=yaml\n</code></pre></p> </li> </ul>"},{"location":"cloud/k8s/cka/#secrets","title":"Secrets","text":"<ul> <li>\u7528\u9014: \u5132\u5b58\u7cfb\u7d71\u7684\u6a5f\u654f\u8cc7\u6599</li> <li> <p>\u6ce8\u610f! K8s \u7684 Secrets \u53ea\u662f\u7528 base64 \u7de8\u78bc (encode) \u904e\u7684\u8cc7\u6599\u800c\u5df2\uff0c\u9019\u4e26\u4e0d\u7b97\u662f\u771f\u6b63\u7684\u52a0\u5bc6 (encrypt)\u3002\u4efb\u4f55\u4eba\u53ea\u8981\u77e5\u9053 base64 \u7de8\u78bc\u7684\u89e3\u78bc (decode) \u65b9\u6cd5\uff0c\u5c31\u80fd\u89e3\u78bc Secrets</p> <ul> <li> <p>\u5b89\u5168\u6027\u6982\u5ff5: \u5118\u7ba1 K8s \u5b98\u65b9\u6587\u4ef6\u5c07 Secrets \u8996\u70ba\u5b58\u5132\u654f\u611f\u6578\u64da\u7684 \"\u66f4\u5b89\u5168\u9078\u64c7 (safer option)\"\uff0c\u9019\u4e3b\u8981\u662f\u56e0\u70ba\u5b83\u5011\u6bd4\u7d14\u6587\u5b57 (plain text) \u8f03\u5b89\u5168\uff0c\u53ef\u4ee5\u964d\u4f4e\u610f\u5916\u6d29\u6f0f\u5bc6\u78bc\u3001\u5176\u4ed6\u6a5f\u654f\u8cc7\u6599\u7684\u98a8\u96aa\u3002\u771f\u6b63\u7684\u5b89\u5168\u6027\u4f86\u81ea\u65bc\u5982\u4f55\u4f7f\u7528\u548c\u7ba1\u7406\u9019\u4e9b Secrets\uff0c\u800c\u4e0d\u662f Secrets \u672c\u8eab\u7684\u5b89\u5168\u6027 </p> </li> <li> <p>\u53ef\u53c3\u8003 K8s \u5b98\u65b9\u6587\u4ef6: Encrypting Confidential Data at Rest</p> </li> <li>\u5efa\u7acb Secret</li> <li> <p>\u547d\u4ee4\u5f0f (Imperative):      Bash<pre><code># \u5728 CLI \u4e0a\uff0c\u76f4\u63a5\u7d66\u5b9a key-value \u5c0d\uff0c\u4f86\u5efa\u7acb Secret\nkubectl create secret generic app-secret --from-literal=DB_Host=mysql --from-literal=DB_User=root --from-literal=DB_Password=paswrd\n</code></pre></p> Bash<pre><code># \u900f\u904e\u6a94\u6848\u4f86\u5efa\u7acb Secret\nkubectl create secret generic app-secret --from-file=app_secret.properties\n</code></pre> <p></p> </li> <li> <p>\u5ba3\u544a\u5f0f (Declarative):</p> <ul> <li> <p>\u5c07\u539f\u59cb\u6a5f\u654f\u8cc7\u6599\uff0c\u904b\u7528 base64 \u7de8\u78bc (\u975e\u52a0\u5bc6)     Bash<pre><code>echo -n \"mysql\" | base64\necho -n \"root\" | base64\necho -n \"paswrd\"| base64\n</code></pre></p> <p></p> </li> <li> <p>\u5efa\u7acb Secret \u7684 YAML manifest \u8a2d\u5b9a\u6a94     YAML<pre><code># secret-data.yaml\napiVersion: v1\nkind: Secret\nmetadata:\n    name: app-secret\ndata:\n    DB_Host: bX1zcWw=\n    DB_User: cm9vdA==\n    DB_Password: cGFzd3Jk\n</code></pre></p> </li> <li>\u5efa\u7acb Secret     Bash<pre><code>$ kubectl create -f secret-data.yaml\n</code></pre></li> </ul> <p></p> </li> </ul> </li> <li> <p>\u6ce8\u5165 Secret \u5230 Pod \u4e2d</p> <ul> <li> <p><code>envFrom.secretRef</code>: \u9069\u7528\u65bc\u9700\u8981\u4f7f\u7528\u6240\u6709 Secret \u7684 key-value \u5c0d     YAML<pre><code># secret-definition.yaml\napiVersion: v1\nkind: Secret\nmetadata:\n    name: app-secret\ndata:\n    DB_Host: bX1zcWw=\n    DB_User: cm9vdA==\n    DB_Password: cGFzd3Jk\n</code></pre></p> YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: simple-webapp-color\n\nspec:\n    containers:\n    -   name: simple-webapp-color\n        image: simple-webapp-color\n        ports:\n        -   containerPort: 8080\n\n        # \u6ce8\u5165 Secret \u5230 Pod \u4e2d (`envFrom` \u63a1\u7528\u9663\u5217\u8868\u793a)\n        envFrom:\n        -   secretRef:\n            name: app-secret\n</code></pre> Bash<pre><code>kubectl create -f pod-definition.yaml\n</code></pre> <p></p> </li> <li> <p>\u5176\u5b83\u65b9\u5f0f</p> <ul> <li><code>env.valueFrom.secretKeyRef</code>: \u9069\u7528\u65bc\u53ea\u9700\u8981\u4f7f\u7528\u7279\u5b9a Secret \u7684 key-value \u5c0d</li> <li><code>volumes.secret</code>: \u9069\u7528\u65bc\u61c9\u7528\u7a0b\u5f0f\uff0c\u9700\u8981\u4f7f\u7528 volume \u5f62\u5f0f\u7684\u8a2d\u5b9a\u8cc7\u6599<ul> <li>Secret \u4e2d\u7684\u6bcf\u500b\u5c6c\u6027\uff0c\u90fd\u6703\u88ab\u5efa\u7acb\u70ba\u4e00\u500b\u6a94\u6848\uff0c\u4e14\u6bcf\u500b\u6a94\u6848\u7684\u540d\u7a31\u5c31\u662f Secret \u7684\u9375 (key)\uff0c\u6a94\u6848\u7684\u5167\u5bb9\u5c31\u662f Secret \u7684\u503c (value) </li> </ul> </li> </ul> <p></p> </li> </ul> </li> <li> <p>base64 \u89e3\u78bc (decode)     Bash<pre><code>echo -n \"bX1zcWw=\" | base64 --decode\necho -n \"cm9vdA==\" | base64 --decode\necho -n \"cGFzd3Jk\" | base64 --decode\n</code></pre></p> <p></p> </li> <li> <p>\u67e5\u8a62\u76ee\u524d\u6709\u54ea\u4e9b Secrets     Bash<pre><code>kubectl get secrets\n</code></pre></p> </li> <li> <p>\u8a73\u7d30\u6aa2\u8996\u6307\u5b9a\u7684 Secret     Bash<pre><code>kubectl describe secret app-secret -o=yaml\n</code></pre></p> <p></p> </li> <li> <p>Secret \u7684\u6700\u4f73\u5be6\u8e10     </p> </li> </ul>"},{"location":"cloud/k8s/cka/#scale-applications","title":"Scale Applications","text":""},{"location":"cloud/k8s/cka/#multi-container-pod","title":"Multi-Container Pod","text":"<ul> <li> <p>\u7528\u9014: \u6709\u6642\uff0c\u6211\u5011\u53ef\u80fd\u6703\u9700\u8981\u5169\u7a2e\u670d\u52d9\u4e00\u8d77\u904b\u4f5c\uff0c\u4f8b\u5982: \u7db2\u9801\u4f3a\u670d\u5668 + log \u4ee3\u7406</p> <ul> <li>\u89e3\u6c7a\u65b9\u5f0f: \u6211\u5011\u53ef\u4ee5\u5728\u4e00\u500b Pod \u4e2d\u5305\u542b\u591a\u500b containers\uff0c\u9019\u6a23 containers \u4e4b\u9593\u5c31\u80fd\u8996\u70ba\u540c\u4e00\u500b\u672c\u5730\u7aef (local)\uff0c\u4ea6\u80fd\u5171\u4eab\u540c\u4e00\u500b Networking, Storage \u7b49</li> </ul> <p> </p> </li> <li> <p>\u5efa\u7acb Multi-Container Pod     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: simple-webapp\n    labels:\n        name: simple-webapp\n\nspec:\n    containers:\n    # \u7b2c\u4e00\u500b container\n    -   name: simple-webapp\n        image: simple-webapp\n        ports:\n        -   ContainerPort: 8080\n\n    # \u7b2c\u4e8c\u500b container\n    - name: log-agent\n        image: log-agent\n</code></pre></p> <p> </p> </li> <li> <p>Multi-container Pods \u7684\u4e09\u5927\u8a2d\u8a08\u6a21\u5f0f (Design Patterns)</p> <ul> <li>Sidecar (\u908a\u8eca\u6a21\u5f0f): \u4e3b\u8981 container \u8ca0\u8cac\u61c9\u7528\u7a0b\u5f0f\u7684\u4e3b\u8981\u908f\u8f2f\uff0c\u800c sidecar container \u8ca0\u8cac\u652f\u63f4\u6027\u7684\u5de5\u4f5c<ul> <li>e.g. Logging, Monitoring \u7b49</li> </ul> </li> <li>Adapter (\u9069\u914d\u5668\u6a21\u5f0f): \u4e3b\u8981 container \u8ca0\u8cac\u61c9\u7528\u7a0b\u5f0f\u7684\u4e3b\u8981\u908f\u8f2f\uff0c\u800c adapter container \u8ca0\u8cac\u8f49\u63db\u4e3b\u8981 container \u7684\u8f38\u51fa<ul> <li>e.g. \u628a\u8cc7\u6599\u5f9e JSON \u8f49\u63db\u70ba YAML \u683c\u5f0f</li> </ul> </li> <li>Ambassador (\u5927\u4f7f\u6a21\u5f0f): \u4e3b\u8981 container \u8ca0\u8cac\u61c9\u7528\u7a0b\u5f0f\u7684\u4e3b\u8981\u908f\u8f2f\uff0c\u800c ambassador container \u8ca0\u8cac\u4ee3\u7406\u4e3b\u8981 container \u7684\u7db2\u8def\u8acb\u6c42<ul> <li>e.g. \u4ee3\u7406\u670d\u52d9 (Proxy)\u3001\u8ca0\u8f09\u5747\u8861 (Load Balance)\u3001\u5b89\u5168\u8a8d\u8b49 </li> </ul> </li> </ul> </li> <li> <p>\u5728 Kubernetes \u4e2d\uff0c\u591a\u5bb9\u5668 Pod \u4e2d\u7684\u6bcf\u500b\u5bb9\u5668\u90fd\u9810\u671f\u6703\u5728 Pod \u7684\u751f\u547d\u9031\u671f\u5167\u4fdd\u6301\u904b\u884c\u3002\u4f8b\u5982: \u7db2\u9801\u4f3a\u670d\u5668 + log \u4ee3\u7406 \u90fd\u6703\u9700\u8981\u6301\u7e8c\u904b\u884c\u3002\u82e5\u5176\u4e2d\u4efb\u4f55\u4e00\u500b container \u5931\u6548\uff0cPod \u5c31\u6703\u91cd\u65b0\u555f\u52d5</p> <ul> <li>\u5728 Kubernetes \u4e2d\uff0csidecar container \u662f\u5728\u4e3b\u8981\u7684 container \u4e4b\u524d\u5c31\u6703\u555f\u52d5\uff0c\u4e26\u6301\u7e8c\u904b\u884c</li> </ul> </li> <li> <p>Init Container (\u521d\u59cb\u5316\u5bb9\u5668)</p> <ul> <li>\u7279\u6027:<ul> <li>\u521d\u59cb\u5316\u5bb9\u5668\u7e3d\u662f\u6703\u57f7\u884c\u5230\u6210\u529f\u70ba\u6b62\uff0c\u82e5\u57f7\u884c\u5931\u6557\uff0ckubelet \u6703\u91cd\u8907\u57f7\u884c\u521d\u59cb\u5316\u5bb9\u5668\uff0c\u76f4\u5230\u57f7\u884c\u6210\u529f\u70ba\u6b62</li> <li>\u6bcf\u500b\u521d\u59cb\u5316\u5bb9\u5668\u5fc5\u9808\u5b8c\u6210\u57f7\u884c\u6210\u529f\u5f8c\uff0c\u624d\u80fd\u57f7\u884c\u4e0b\u4e00\u500b\u521d\u59cb\u5316\u5bb9\u5668</li> </ul> </li> </ul> Feature Init Containers (\u521d\u59cb\u5316\u5bb9\u5668) Sidecar Containers (\u908a\u8eca\u5bb9\u5668) \u904b\u884c\u6642\u9593 \u4e3b\u61c9\u7528\u5bb9\u5668\u555f\u52d5\u524d\u5b8c\u6210 \u8207\u4e3b\u61c9\u7528\u5bb9\u5668\u540c\u6642\u904b\u884c \u57f7\u884c\u9806\u5e8f \u9806\u5e8f\u5b8c\u6210\uff0c\u4e3b\u5bb9\u5668\u7b49\u6240\u6709 init \u5bb9\u5668\u5b8c\u6210\u5f8c\u624d\u555f\u52d5 \u8207\u4e3b\u5bb9\u5668\u4e26\u884c\u57f7\u884c \u652f\u63f4 Probe \u985e\u578b \u4e0d\u652f\u63f4 <code>lifecycle</code>\u3001<code>livenessProbe</code>\u3001<code>readinessProbe</code>\u3001<code>startupProbe</code> \u652f\u63f4 <code>lifecycle</code>\u3001<code>livenessProbe</code>\u3001<code>readinessProbe</code>\u3001<code>startupProbe</code> \u8cc7\u6e90\u5171\u4eab \u5171\u4eab\u8cc7\u6e90\uff08CPU\u3001\u8a18\u61b6\u9ad4\u3001\u7db2\u8def\uff09\u4f46\u4e0d\u76f4\u63a5\u4e92\u52d5\uff0c\u53ef\u4f7f\u7528 shared volume \u4f86\u9032\u884c\u8cc7\u6599\u4ea4\u63db \u5171\u4eab\u8cc7\u6e90\uff08CPU\u3001\u8a18\u61b6\u9ad4\u3001\u7db2\u8def\uff09\u4e26\u53ef\u76f4\u63a5\u4e92\u52d5 <ul> <li> <p>\u7bc4\u4f8b:     YAML<pre><code># init-container-pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp-pod\n    labels:\n        app: myapp\n\nspec:\n    # \u8a2d\u5b9a\u521d\u59cb\u5316\u5bb9\u5668\n    initContainers:\n    -   name: init-myservice\n        image: busybox\n        command: ['sh', '-c', 'git clone &lt;some-repository-that-will-be-used-by-application&gt; ; done;']\n\n    # \u8a2d\u5b9a\u4e3b\u8981\u5bb9\u5668\n    containers:\n    -   name: myapp-container\n        image: busybox:1.28\n        command: ['sh', '-c', 'echo The app is running! &amp;&amp; sleep 3600'] \n</code></pre></p> YAML<pre><code># multi-init-container-pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp-pod\n    labels:\n        app: myapp\n\nspec:\n    # \u8a2d\u5b9a\u521d\u59cb\u5316\u5bb9\u5668\n    initContainers:\n        -   name: init-myservice\n            image: busybox:1.28\n            command: ['sh', '-c', 'until nslookup myservice; do echo waiting for myservice; sleep 2; done;']\n        -   name: init-mydb\n            image: busybox:1.28\n            command: ['sh', '-c', 'until nslookup mydb; do echo waiting for mydb; sleep 2; done;']\n\n    # \u8a2d\u5b9a\u4e3b\u8981\u5bb9\u5668\n    containers:\n    -   name: myapp-container\n        image: busybox:1.28\n        command: ['sh', '-c', 'echo The app is running! &amp;&amp; sleep 3600']\n</code></pre> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#self-healing-application","title":"Self-Healing Application","text":"<ul> <li>Kubernetes \u900f\u904e ReplicaSets \u548c Replication Controllers \u652f\u63f4\u81ea\u6211\u4fee\u5fa9\u7684\u61c9\u7528\u7a0b\u5f0f (Self-Healing Application)<ul> <li>Replication Controller \u80fd\u78ba\u4fdd\u7576 POD \u5167\u7684\u61c9\u7528\u7a0b\u5f0f\u5931\u6548\u6642\uff0c\u80fd\u5920\u81ea\u52d5\u91cd\u65b0\u5efa\u7acb\u8a72 POD\uff0c\u4ee5\u78ba\u4fdd\u61c9\u7528\u7a0b\u5f0f\u7684\u526f\u672c\u6578\u91cf (replicas) \u59cb\u7d42\u4fdd\u6301\u5728\u6240\u9700\u7684\u6578\u91cf</li> </ul> </li> <li>Kubernetes \u4ea6\u63d0\u4f9b\u984d\u5916\u7684\u65b9\u6cd5\uff0c\u4f86\u6aa2\u67e5\u5728 POD \u5167\u904b\u884c\u7684\u61c9\u7528\u7a0b\u5f0f container \u7684\u5065\u5eb7\u72c0\u6cc1\uff0c\u4e26\u901a\u904e Liveness Probes \u548c Readiness Probes \u4f86\u78ba\u4fdd\u61c9\u7528\u7a0b\u5f0f\u7684\u6b63\u5e38\u904b\u4f5c<ul> <li>Liveness Probes: \u7528\u65bc\u6aa2\u67e5\u61c9\u7528\u7a0b\u5f0f\u662f\u5426\u6b63\u5728\u904b\u884c\uff0c\u4e26\u5728\u61c9\u7528\u7a0b\u5f0f\u5931\u6548\u6642\uff0c\u81ea\u52d5\u91cd\u65b0\u555f\u52d5\u8a72\u61c9\u7528\u7a0b\u5f0f</li> <li>Readiness Probes: \u7528\u65bc\u6aa2\u67e5\u61c9\u7528\u7a0b\u5f0f\u662f\u5426\u5df2\u7d93\u6e96\u5099\u597d\u63a5\u6536\u6d41\u91cf\uff0c\u4e26\u5728\u61c9\u7528\u7a0b\u5f0f\u5c1a\u672a\u6e96\u5099\u597d\u63a5\u6536\u6d41\u91cf\u6642\uff0c\u5c07\u8a72\u61c9\u7528\u7a0b\u5f0f\u5f9e\u670d\u52d9\u4e2d\u79fb\u9664 YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp-pod\n    labels:\n        app: myapp\n\nspec:\n    containers:\n    -   name: myapp-container\n        image: busybox\n        command: ['sh', '-c', 'echo The app is running! &amp;&amp; sleep 3600']\n\n        # \u8a2d\u5b9a livenessProbe: \u7528\u65bc\u6aa2\u67e5\u61c9\u7528\u7a0b\u5f0f\u662f\u5426\u6b63\u5728\u904b\u884c\n        livenessProbe:\n            exec:\n                command:\n                - cat\n                - /tmp/healthy\n            initialDelaySeconds: 5\n            periodSeconds: 5\n\n        # \u8a2d\u5b9a readinessProbe: \u7528\u65bc\u6aa2\u67e5\u61c9\u7528\u7a0b\u5f0f\u662f\u5426\u5df2\u7d93\u6e96\u5099\u597d\u63a5\u6536\u6d41\u91cf\n        readinessProbe:\n            exec:\n                command:\n                - cat\n                - /tmp/healthy\n            initialDelaySeconds: 5\n            periodSeconds: 5\n</code></pre></li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#cluster-maintenance","title":"Cluster Maintenance","text":""},{"location":"cloud/k8s/cka/#cluster-upgrade-process","title":"Cluster Upgrade Process","text":"<ul> <li> <p>\u6aa2\u8996 K8s \u53e2\u96c6\u7684\u7248\u672c     Bash<pre><code>kubectl get nodes\n</code></pre></p> <p></p> </li> <li> <p>\u8a9e\u610f\u5316\u7248\u672c\u7ba1\u7406 (Semantic Versioning)</p> <ul> <li><code>major.minor.patch</code><ul> <li>major: \u4e3b\u8981\u7248\u672c\uff0c\u7576 K8s \u53e2\u96c6\u6709\u91cd\u5927\u8b8a\u66f4 (breaking changes)\u6642\uff0c\u6703\u589e\u52a0\u6b64\u7248\u672c\u865f</li> <li>minor: \u6b21\u8981\u7248\u672c\uff0c\u7576 K8s \u53e2\u96c6\u6709\u65b0\u529f\u80fd (feature)\u6642\uff0c\u6703\u589e\u52a0\u6b64\u7248\u672c\u865f</li> <li>patch: \u4fee\u88dc\u7248\u672c\uff0c\u7576 K8s \u53e2\u96c6\u6709\u932f\u8aa4\u4fee\u6b63 (bug fix)\u6642\uff0c\u6703\u589e\u52a0\u6b64\u7248\u672c\u865f </li> </ul> </li> <li>\u5728\u6b63\u5f0f\u767c\u5e03\u7248\u672c\u4e4b\u524d\uff0c\u8edf\u9ad4\u901a\u5e38\u6703\u7d93\u6b77\u591a\u500b\u958b\u767c\u968e\u6bb5\u3002\u9019\u4e9b\u7248\u672c\u88ab\u7a31\u70ba\u5148\u884c\u7248\u672c\uff0c\u6a19\u793a\u70ba alpha, beta \u7b49<ul> <li>alpha: \u521d\u59cb\u6e2c\u8a66\u7248\u672c\uff0c\u901a\u5e38\u5728\u529f\u80fd\u958b\u767c\u7684\u65e9\u671f\u968e\u6bb5\u91cb\u51fa\u3002\u5b83\u53ef\u80fd\u5305\u542b\u4e00\u4e9b\u65b0\u529f\u80fd\uff0c\u4f46\u9019\u4e9b\u529f\u80fd\u5c1a\u672a\u5b8c\u5168\u5be6\u73fe or \u5c1a\u672a\u901a\u904e\u5b8c\u6574\u6e2c\u8a66<ul> <li>e.g. <code>v1.0.0-alpha</code></li> </ul> </li> <li>beta: \u662f\u5728 Alpha \u7248\u672c\u4e4b\u5f8c\u91cb\u51fa\u7684\uff0c\u901a\u5e38\u8868\u793a\u529f\u80fd\u5df2\u57fa\u672c\u5b8c\u6210\uff0c\u4e26\u4e14\u5df2\u9032\u884c\u4e86\u521d\u6b65\u6e2c\u8a66\u3002beta \u7248\u672c\u6703\u63d0\u4f9b\u7d66\u66f4\u5ee3\u6cdb\u7684\u4f7f\u7528\u8005\u9032\u884c\u6e2c\u8a66\uff0c\u4ee5\u6536\u96c6\u56de\u994b\uff0c\u4e26\u767c\u73fe\u6f5b\u5728\u554f\u984c<ul> <li>e.g. <code>v1.0.0-beta</code> </li> </ul> </li> </ul> </li> </ul> </li> <li> <p>K8s \u53e2\u96c6\u4e2d\u5404\u7269\u4ef6\u7684\u7248\u672c\u865f</p> <ul> <li>K8s \u53e2\u96c6\u4e2d\u7684\u5404\u7269\u4ef6\uff0c\u6c92\u6709\u5f37\u5236\u3127\u5b9a\u8981\u4f7f\u7528\u76f8\u540c\u7684\u7248\u672c\u865f\uff0c\u4f46\u662f\u6838\u5fc3\u7269\u4ef6 (e.g. Kube-apiserver, Kube-controller-manager, Kube-scheduler, Kubelet, Kube-proxy) \u901a\u5e38\u6703\u4f7f\u7528\u76f8\u540c\u7684\u7248\u672c\u865f</li> <li>K8s \u53e2\u96c6\u4e2d\u7684\u5404\u7269\u4ef6\uff0c\u5c0d\u65bc\u7576\u524d\u7684 K8s \u53e2\u96c6\u7248\u672c\u865f\uff0c\u5206\u5225\u6703\u6709\u53ef\u652f\u63f4\u7684\u7248\u672c\u865f\u7bc4\u570d     </li> <li>K8s \u53e2\u96c6\u4e2d\u7684\u5404\u7269\u4ef6\uff0c\u4f8b\u5982: Pod, Deployment, Service \u7b49\uff0c\u90fd\u6709\u81ea\u5df1\u7684\u7248\u672c\u865f\u3002\u7576 K8s \u53e2\u96c6\u5347\u7d1a\u6642\uff0c\u9019\u4e9b\u7269\u4ef6\u7684\u7248\u672c\u865f\u4e5f\u6703\u96a8\u4e4b\u5347\u7d1a<ul> <li>etcd cluster, CoreDNS \u56e0\u70ba\u662f\u7368\u7acb\u5c08\u6848\uff0c\u56e0\u6b64\u6703\u6709\u5176\u81ea\u5df1\u7684\u7248\u672c\u865f\u3002\u56e0\u6b64\uff0c\u7576 K8s \u53e2\u96c6\u5347\u7d1a\u6642\uff0c\u4e5f\u9700\u8981\u6ce8\u610f K8s \u53e2\u96c6\u8207 etcd cluster, CoreDNS \u7684\u7248\u672c\u76f8\u5bb9\u6027</li> <li>kubectl \u56e0\u70ba\u662f Kubernetes \u7684 CLI \u5de5\u5177\uff0c\u901a\u5e38\u6703\u5b89\u88dd\u5728\u4f7f\u7528\u8005\u7684\u672c\u5730\u7aef\u74b0\u5883\u4e2d\uff0c\u800c\u4e0d\u662f K8s \u53e2\u96c6\u7684 Node \u4e0a\u3002\u56e0\u6b64\uff0ckubectl \u6703\u9700\u8981\u624b\u52d5\u9032\u884c\u5347\u7d1a\u7248\u672c\u865f </li> </ul> </li> </ul> </li> <li> <p>\u5347\u7d1a K8s \u53e2\u96c6\u7684\u7248\u672c\u865f</p> <ul> <li>\u5728\u4efb\u4f55\u6642\u9593\u9ede\uff0cK8s \u53ea\u652f\u63f4\u6700\u8fd1\u7684 3 \u500b\u6b21\u8981\u7248\u672c (minor version)</li> <li> <p>\u6700\u4f73\u5be6\u8e10: \u5efa\u8b70\u7684\u65b9\u6cd5\u662f\u4e00\u6b21\u5347\u7d1a\u4e00\u500b\u6b21\u8981\u7248\u672c     </p> </li> <li> <p>\u5e38\u898b\u7684\u5347\u7d1a K8s \u53e2\u96c6\u65b9\u6cd5:</p> <ul> <li>\u6cd5 1: \u4f7f\u7528\u516c\u6709\u96f2 (e.g. GCP, AWS, Azure)\uff0c\u53ef\u4ee5\u5728 GUI \u4e0a\u9032\u884c\u5347\u7d1a</li> <li>\u6cd5 2: \u4f7f\u7528 kubeadm \u5de5\u5177\uff0c\u900f\u904e CLI \u6307\u4ee4\u9032\u884c\u5347\u7d1a</li> <li>\u6cd5 3: \u624b\u52d5\u90e8\u7f72 K8s \u53e2\u96c6\uff0c\u5c31\u53ea\u80fd\u900f\u904e\u624b\u52d5\u65b9\u5f0f\u9032\u884c\u5347\u7d1a </li> </ul> </li> <li> <p>\u5347\u7d1a K8s \u53e2\u96c6\u7684\u4e09\u7a2e\u4e3b\u8981\u7b56\u7565</p> <ul> <li>Recreate: \u5148\u522a\u9664\u820a\u7684 Node\uff0c\u518d\u5efa\u7acb\u65b0\u7684 Node\u3002\u9019\u6a23\u7684\u65b9\u5f0f\uff0c\u6703\u5c0e\u81f4\u670d\u52d9\u4e2d\u65b7     </li> <li>RollingUpdate (\u9810\u8a2d): \u6efe\u52d5\u66f4\u65b0\uff0c\u4e00\u6b21\u5347\u7d1a\u4e00\u500b Node\u3002\u4ea6\u5373\uff0c\u9010\u6b65\u522a\u9664\u820a\u7684 Node\uff0c\u4e26\u5efa\u7acb\u65b0\u7684 Node\u3002\u9019\u6a23\u7684\u65b9\u5f0f\uff0c\u4e0d\u6703\u5c0e\u81f4\u670d\u52d9\u4e2d\u65b7 </li> <li>Add new Node: \u65b0\u589e\u65b0\u7684 Node\uff0c\u4e26\u5c07\u820a\u7684 Node \u9010\u6b65\u522a\u9664\u3002\u9019\u6a23\u7684\u65b9\u5f0f\uff0c\u4e0d\u6703\u5c0e\u81f4\u670d\u52d9\u4e2d\u65b7 </li> </ul> </li> </ul> </li> <li> <p>\u6aa2\u8996\u7576\u524d\u7684\u4f5c\u696d\u7cfb\u7d71\u7248\u672c     Bash<pre><code>cat /etc/*release\n</code></pre></p> <p></p> </li> <li> <p>\u904b\u7528 kubeadm\uff0c\u5347\u7d1a Master Node</p> <ul> <li> <p>\u6aa2\u67e5\u4e26\u8a08\u5283\u5347\u7d1a\u3002\u9019\u5c07\u78ba\u4fdd\u6240\u6709\u524d\u7f6e\u689d\u4ef6\uff0c\u90fd\u5df2\u6eff\u8db3\u4e26\u544a\u77e5\u9700\u8981\u5347\u7d1a\u7684\u5167\u5bb9     Bash<pre><code>kubeadm upgrade plan\n</code></pre></p> <p></p> </li> <li> <p>\u5347\u7d1a kubeadm \u5de5\u5177\u7684\u7248\u672c\u865f     Bash<pre><code>apt-get upgrade -y kubeadm=1.12.0-00\n</code></pre></p> </li> <li> <p>\u5347\u7d1a K8s \u53e2\u96c6     Bash<pre><code>kubeadm upgrade apply v1.12.0\n</code></pre></p> </li> <li> <p>\u5347\u7d1a K8s \u53e2\u96c6\u6210\u529f\u5f8c\uff0c\u9019\u6642\u5019\u82e5\u6211\u5011\u6aa2\u8996\u7576\u524d\u7684 Node \u4ecd\u986f\u793a\u820a\u7684\u7248\u672c\u865f     </p> </li> <li> <p>\u5347\u7d1a kubelet \u7269\u4ef6 (\u9019\u88e1\u662f\u6307 master node \u4e0a\u7684)     Bash<pre><code>apt-get upgrade kubelet=1.12.0-00\n</code></pre></p> </li> <li> <p>\u91cd\u65b0\u555f\u52d5 kubelet \u7269\u4ef6     Bash<pre><code>systemctl restart kubelet\n</code></pre></p> </li> <li> <p>\u9019\u6642\u5019\uff0c\u518d\u6aa2\u8996\u7576\u524d\u7684 Node\uff0c\u5c31\u6703\u6b63\u78ba\u986f\u793a\u5347\u7d1a\u5f8c\u7684\u65b0\u7248\u672c\u865f     Bash<pre><code>kubectl get nodes\n</code></pre></p> <p></p> </li> </ul> </li> <li> <p>\u904b\u7528 kubeadm\uff0c\u5347\u7d1a Worker Node</p> <ul> <li> <p>\u8981\u5148\u9023\u7dda\u5230 worker node \u4e2d\uff0c\u624d\u53ef\u4ee5\u958b\u59cb\u9032\u884c\u5347\u7d1a (\u53ef\u4ee5\u7528 Node name \u6216 Internal IP \u4f86\u9023\u7dda)     Bash<pre><code>ssh node01\n</code></pre></p> Bash<pre><code>ssh 10.244.0.4\n</code></pre> </li> <li> <p>\u5148\u5c07\u7576\u524d worker node \u4e0a\uff0c\u6240\u6709 Pod \u5de5\u4f5c\u8ca0\u8f09 (workload) \u90fd\u6392\u51fa (drain)     Bash<pre><code>kubectl drain node01 --ignore-daemonsets\n</code></pre></p> </li> <li> <p>\u5347\u7d1a kubeadm\u3001kubelet packages \u7684\u7248\u672c\u865f     Bash<pre><code>apt-get upgrade -y kubeadm=1.12.0-00\napt-get upgrade -y kubelet=1.12.0-00\n</code></pre></p> </li> <li> <p>\u66f4\u65b0 Worker Node \u7684\u8a2d\u5b9a\u6a94\uff0c\u4ee5\u7b26\u5408\u65b0\u7684\u7248\u672c\u865f     Bash<pre><code>kubeadm upgrade node config --kubelet-version v1.12.0\n</code></pre></p> </li> <li> <p>\u91cd\u65b0\u555f\u52d5 kubelet \u670d\u52d9     Bash<pre><code>systemctl restart kubelet\n</code></pre></p> </li> <li> <p>\u5c07\u5347\u7d1a\u5f8c\u7684 Node \u6a19\u8a18\u70ba\u53ef\u6392\u7a0b (schedulable)     Bash<pre><code>kubectl uncordon node-1\n</code></pre></p> <p></p> </li> <li> <p>\u63a5\u4e0b\u4f86\uff0c\u9700\u9010\u4e00\u5347\u7d1a\u6bcf\u4e00\u500b Worker Node\uff0c\u76f4\u5230\u6240\u6709 Worker Node \u90fd\u5b8c\u6210\u5347\u7d1a </p> </li> </ul> </li> <li> <p>\u53c3\u8003\u8cc7\u6599:</p> <ul> <li>K8s \u5b98\u65b9\u6587\u4ef6: release note</li> <li>K8s \u5b98\u65b9\u6587\u4ef6: Upgrading kubeadm clusters<ul> <li>\u6b65\u9a5f 1: Changing the package repository</li> <li>\u6b65\u9a5f 2: Determine which version to upgrade to</li> <li>\u6b65\u9a5f 3: Upgrading control plane nodes</li> <li>\u6b65\u9a5f 4: Upgrade worker nodes</li> <li>\u6b65\u9a5f 5: Verify the status of the cluster</li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#operating-system-upgrades","title":"Operating System Upgrades","text":"<ul> <li> <p>\u5728\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u82e5\u4e00\u500b Node \u5728 5 \u5206\u9418\u5167\u6c92\u6709\u6062\u5fa9\u6b63\u5e38\u72c0\u614b\uff0cK8s \u53e2\u96c6\u5c07\u6703\u958b\u59cb\u9a45\u9010\u8a72 Node \u4e0a\u7684 Pod     Bash<pre><code>kube-controller-manager --pod-eviction-timeout=5m0s\n</code></pre></p> <p></p> </li> <li> <p>Drain Node (\u6392\u51fa): \u5c07 Node \u4e0a\u7684\u6240\u6709 Pod \u9a45\u9010\uff08\u9810\u8a2d\u9664\u4e86 DaemonSet \u7ba1\u7406\u7684 Pod \u5916\uff09\uff0c\u4e26\u5c07 Node \u6a19\u8a18\u70ba\u4e0d\u53ef\u6392\u7a0b (unschedulable) \u7684\u72c0\u614b</p> <ul> <li>\u76ee\u7684: \u5c07 Node \u4e0a\u7684\u6240\u6709 Pod \u5b89\u5168\u5730\u9077\u79fb\u5230\u5176\u4ed6 Node \u4e0a\uff0c\u4ee5\u4fbf\u9032\u884c Node \u7dad\u8b77, \u5347\u7d1a, \u79fb\u9664</li> <li> <p>\u4f7f\u7528\u60c5\u5883: \u9032\u884c Node \u7dad\u8b77, \u5347\u7d1a     Bash<pre><code>kubectl drain node-1 --ignore-daemonsets\n</code></pre></p> <p></p> </li> <li> <p>\u6ce8\u610f! \u82e5 Pod \u4e0d\u662f\u7531 Deployment, ReplicaSet, StatefulSet \u7b49\u63a7\u5236\u5668\u7ba1\u7406\uff0c\u5247\u5728\u57f7\u884c <code>kubectl drain</code> \u6307\u4ee4\u6642\uff0c\u6703\u51fa\u73fe\u932f\u8aa4\u8a0a\u606f\uff0c\u56e0\u70ba K8s \u53e2\u96c6\u70ba\u4e86\u9632\u7bc4\u6211\u5011\u8aa4\u522a Pod\uff0c\u800c\u7121\u6cd5\u5fa9\u539f</p> <ul> <li>\u6b64\u6642\uff0c\u6211\u5011\u53ef\u4ee5\u900f\u904e <code>--force</code> \u9078\u9805\uff0c\u5f37\u5236\u57f7\u884c <code>kubectl drain</code> \u6307\u4ee4 Bash<pre><code>kubectl drain node-1 --ignore-daemonsets --force\n</code></pre></li> </ul> <p></p> </li> </ul> </li> <li> <p>Cordon/Uncordon Node (\u8b66\u6212/\u89e3\u9664\u8b66\u6212)</p> <ul> <li>Cordon: \u7528\u65bc\u6a19\u8a18 Node \u70ba\u4e0d\u53ef\u6392\u7a0b (unschedulable)\uff0c\u5373\u4e0d\u518d\u63a5\u53d7\u65b0\u7684 Pod\u3002\u4f46\u73fe\u6709 Pod \u4e0d\u6703\u53d7\u5230\u5f71\u97ff<ul> <li>\u4f7f\u7528\u60c5\u5883: \u5728\u9700\u8981\u9032\u884c Node \u7dad\u8b77\u6642\uff0c\u9632\u6b62\u65b0\u7684 Pod \u88ab\u6392\u7a0b\u5230\u8a72\u7bc0\u9ede\u4e0a</li> </ul> </li> <li>Uncordon: \u7528\u65bc\u6a19\u8a18 Node \u70ba\u53ef\u6392\u7a0b (schedulable)\uff0c\u5373\u53ef\u4ee5\u63a5\u53d7\u65b0\u7684 Pod<ul> <li>\u4f7f\u7528\u60c5\u5883:  Node \u7dad\u8b77, \u5347\u7d1a\u5b8c\u6210\u5f8c\uff0c\u91cd\u65b0\u5141\u8a31\u8a72 Node \u63a5\u6536\u65b0\u7684 Pod</li> </ul> </li> </ul> Bash<pre><code>kubectl cordon node-1\nkubectl uncordon node-1\n</code></pre> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#backup-and-restore-methodologies","title":"Backup and Restore Methodologies","text":"<ul> <li> <p>\u82e5\u6211\u5011\u8981\u5099\u4efd K8s \u53e2\u96c6\u6642\uff0c\u6703\u9700\u8981\u5099\u4efd\u4ee5\u4e0b\u4e09\u7a2e\u8cc7\u6e90</p> <ul> <li>Resource Configuration: \u5305\u542b\u6240\u6709 Kubernetes \u53e2\u96c6\u4e2d\u7684\u6240\u6709\u8cc7\u6e90\u7684\u8a2d\u5b9a\uff0c\u80fd\u78ba\u4fdd\u5728\u9700\u8981\u6642\u80fd\u5920\u5feb\u901f\u6062\u5fa9 K8s \u53e2\u96c6\u72c0\u614b</li> <li>etcd Cluster: \u5132\u5b58 K8s \u53e2\u96c6\u4e2d\u6240\u6709\u72c0\u614b\u7684\u8cc7\u6599\uff0c\u5305\u62ec\u6240\u6709\u8a2d\u5b9a\u3001\u8cc7\u6e90\u8a2d\u5b9a\u3001\u8cc7\u6599\uff0c\u662f K8s \u53e2\u96c6\u904b\u884c\u7684\u6838\u5fc3</li> <li>Persistent Volume: \u5132\u5b58\u61c9\u7528\u7a0b\u5f0f\u7684\u6301\u4e45\u5316\u8cc7\u6599\uff0c\u5c0d\u65bc\u6709\u72c0\u614b\u7684\u61c9\u7528\u7a0b\u5f0f (e.g. \u8cc7\u6599\u5eab\u3001\u91cd\u8981\u6587\u4ef6) \u975e\u5e38\u91cd\u8981\uff0c\u9019\u4e9b\u8cc7\u6599\u9700\u8981\u88ab\u53ef\u9760\u5730\u5099\u4efd\uff0c\u4ee5\u9632\u907a\u5931 </li> </ul> </li> <li> <p>Backup-Resource Configuration</p> <ul> <li> <p>\u6700\u4f73\u5be6\u8e10: \u5c07\u6240\u6709\u8cc7\u6e90\u8a2d\u5b9a\u5132\u5b58\u5230 Git Repository \u4e2d\uff0c\u4ee5\u4fbf\u80fd\u5920\u5feb\u901f\u6062\u5fa9 K8s \u53e2\u96c6\u72c0\u614b     </p> </li> <li> <p>\u5feb\u901f\u5c0e\u51fa\u591a\u7a2e K8s \u53e2\u96c6\u4e2d\u6838\u5fc3\u8cc7\u6e90\u7684\u8a2d\u5b9a\u6a94\uff0c\u4e26\u5132\u5b58\u5230\u6307\u5b9a\u7684 YAML manifest \u8a2d\u5b9a\u6a94\u4e2d</p> <ul> <li>\u50c5\u652f\u63f4\u532f\u51fa\u4ee5\u4e0b\u8cc7\u6e90\u7684\u8a2d\u5b9a\u6a94: Pod, Service, Deployment, ReplicaSet, StatefulSet, DaemonSet, Job, CronJob Bash<pre><code># (only for few resource groups)\nkubectl get all --all-namespaces -o yaml &gt; all-deploy-services.yaml\n</code></pre></li> <li> <p>\u4e0d\u652f\u63f4\u532f\u51fa\u4ee5\u4e0b\u8cc7\u6e90\u7684\u8a2d\u5b9a\u6a94: ConfigMap, Secret, PersistentVolume, PersistentVolumeClaim, Ingress, Custom Resource Definitions\uff08CRD\uff09\u53ca\u5176\u5be6\u4f8b     Bash<pre><code>kubectl get configmap --all-namespaces -o yaml &gt;&gt; all-deploy-services.yaml\nkubectl get secret --all-namespaces -o yaml &gt;&gt; all-deploy-services.yaml\nkubectl get pv --all-namespaces -o yaml &gt;&gt; all-deploy-services.yaml\nkubectl get pvc --all-namespaces -o yaml &gt;&gt; all-deploy-services.yaml\nkubectl get ingress --all-namespaces -o yaml &gt;&gt; all-deploy-services.yaml\nkubectl get crd --all-namespaces -o yaml &gt;&gt; all-deploy-services.yaml\n</code></pre></p> </li> <li> <p>Velero: \u662f\u4e00\u500b\u5f37\u5927\u7684\u958b\u6e90\u5de5\u5177\uff0c\u7528\u65bc\u5099\u4efd\u3001\u6062\u5fa9\u3001\u9077\u79fb K8s \u53e2\u96c6\u4e2d\u7684\u8cc7\u6e90 &amp; PersistentVolume\u3002\u5b83\u652f\u6301\u5b9a\u671f\u5099\u4efd\u3001\u57fa\u65bc\u7b56\u7565\u7684\u5099\u4efd\u7ba1\u7406</p> </li> </ul> <p></p> </li> </ul> </li> <li> <p>Backup-etcd Cluster</p> <ul> <li>\u5be6\u52d9\u4e0a\uff0c\u6211\u5011\u6703\u5099\u4efd etcd cluster \u7684\u8cc7\u6599\uff0c\u800c\u4e0d\u662f\u5c0d\u65bc\u6bcf\u500b K8s \u53e2\u96c6\u4e2d\u7684\u8cc7\u6e90\u9010\u4e00\u5099\u4efd</li> <li> <p>\u53ef\u6307\u5b9a\u532f\u51fa\u7684 etcd cluster \u5099\u4efd\u6a94\u6848\u8981\u5132\u5b58\u5728\u4ec0\u9ebc\u8def\u5f91\u4f4d\u7f6e     </p> </li> <li> <p>etcdctl: \u7528\u65bc\u8207 etcd cluster \u9032\u884c\u4e92\u52d5\u7684 CLI \u6307\u4ee4\u5de5\u5177\uff0c\u5305\u62ec\u5099\u4efd\u3001\u9084\u539f\u3001\u67e5\u8a62\u7b49\u64cd\u4f5c</p> <ul> <li> <p>\u5099\u4efd (backup)</p> <ul> <li> <p>\u9700\u5148\u6307\u5b9a etcdctl \u7684 API \u7248\u672c\u865f (\u5fc5\u8981)     Bash<pre><code>export ETCDCTL_API=3\n</code></pre></p> </li> <li> <p>\u5efa\u7acb etcd cluster \u7684\u5feb\u7167\u5099\u4efd (snapshot)     Bash<pre><code>etcdctl snapshot save snapshot.db\n</code></pre></p> </li> <li> <p>\u67e5\u8a62 etcd cluster \u7684\u5feb\u7167\u72c0\u614b     Bash<pre><code>etcdctl snapshot status snapshot.db\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>\u9084\u539f (restore)</p> <ul> <li> <p>\u5148\u66ab\u505c kube-apiserver \u670d\u52d9\uff0c\u4ee5\u900f\u904e etcd cluster \u9084\u539f K8s \u53e2\u96c6     Bash<pre><code>service kube-apiserver stop\n</code></pre></p> </li> <li> <p>\u5fa9\u539f etcd cluster \u7684\u5feb\u7167\u5099\u4efd     Bash<pre><code>etcdctl snapshot restore\n</code></pre></p> </li> <li> <p>\u66f4\u65b0 etcd \u670d\u52d9\u7684\u8a2d\u5b9a\u6a94\u5167\u5bb9</p> <ul> <li>\u9810\u8a2d\u8def\u5f91: <code>/etc/kubernetes/manifests/etcd.yaml</code> \u4e2d\u7684 <code>spec.containers.command</code> \u6b04\u4f4d</li> </ul> </li> <li> <p>\u91cd\u65b0\u8f09\u5165\u7cfb\u7d71\u8a2d\u5b9a\u6a94     Bash<pre><code>systemctl daemon-reload\n</code></pre></p> </li> <li> <p>\u91cd\u555f etcd \u670d\u52d9     Bash<pre><code>service etcd restart\n</code></pre></p> </li> <li> <p>\u91cd\u555f kube-apiserver     Bash<pre><code>service kube-apiserver start\n</code></pre></p> </li> </ul> <p></p> </li> </ul> </li> </ul> </li> <li> <p>Tips: \u6bcf\u500b etcdctl \u6307\u4ee4\uff0c\u90fd\u5fc5\u9808\u6307\u5b9a endpoint, cacert, cert,key \u56db\u500b\u9078\u9805\u503c\uff0c\u7528\u4f86\u9a57\u8b49\u6b0a\u9650</p> <ul> <li><code>--endpoints</code>: \u6307\u5b9a etcd \u4f3a\u670d\u5668\u7684 IP address, port</li> <li><code>--cacert</code>: \u6307\u5b9a CA (\u8b49\u66f8\u6388\u6b0a\u6a5f\u69cb) \u7684\u8b49\u66f8\uff0c\u7528\u4f86\u9a57\u8b49 etcd \u4f3a\u670d\u5668\u7684\u8b49\u66f8\u662f\u5426\u7531\u53d7\u4fe1\u4efb\u7684 CA \u6240\u7c3d\u767c</li> <li><code>--cert</code>: \u6307\u5b9a\u5ba2\u6236\u7aef (etcdctl) \u8b49\u66f8\uff0c\u7528\u4f86\u8b49\u660e etcdctl \u7684\u8eab\u4efd\uff0c\u8b93 etcd \u4f3a\u670d\u5668\u53ef\u4ee5\u9a57\u8b49\u5b83\u662f\u5426\u70ba\u53d7\u4fe1\u4efb\u7684\u5be6\u9ad4</li> <li><code>--key</code>: \u6307\u5b9a\u5ba2\u6236\u7aef (etcdctl) \u79c1\u9470\uff0c\u7528\u4f86\u89e3\u5bc6 etcdctl \u8b49\u66f8\u7684\u5167\u5bb9\uff0c\u4ee5\u4fbf\u5728 TLS handshake \u904e\u7a0b\u4e2d\u80fd\u8b49\u660e etcdctl \u7684\u8eab\u4efd</li> </ul> Bash<pre><code>etcdctl \\\nsnapshot save /tmp/snapshot.db \\\n--endpoints=https://127.0.0.1:2379 \\\n--cacert=/etc/kubernetes/pki/etcd/ca.crt \\\n--cert=/etc/kubernetes/pki/etcd/etcd-server.crt \\\n--key=/etc/kubernetes/pki/etcd/etcd-server.key\n</code></pre> <p></p> </li> <li> <p>\u53c3\u8003\u8cc7\u6599: K8s \u5b98\u65b9\u6587\u4ef6: Operating etcd clusters for Kubernetes</p> </li> </ul>"},{"location":"cloud/k8s/cka/#security","title":"Security","text":""},{"location":"cloud/k8s/cka/#kubernetes-security-primitives","title":"Kubernetes Security Primitives","text":"<ul> <li> <p>\u901a\u5e38\u6703\u5c0d kube-apiserver \u8a2d\u5b9a Secure Host</p> <ul> <li> <p>\u7981\u7528\u7d14\u5bc6\u78bc\u5b58\u53d6\uff0c\u4e26\u555f\u7528 SSH key \u8a8d\u8b49     </p> </li> <li> <p>\u8a8d\u8b49 (Authentication): \u6c7a\u5b9a\u8ab0\u80fd\u5b58\u53d6\uff1f</p> <ul> <li>\u4f7f\u7528\u8005\u5e33\u6236/\u5bc6\u78bc</li> <li>\u4f7f\u7528\u8005\u540d\u7a31/token</li> <li>Certificate</li> <li>\u5916\u90e8\u8a8d\u8b49\u63d0\u4f9b\u8005 (e.g. LDAP)</li> <li>\u670d\u52d9\u5e33\u6236 (Service Account)</li> </ul> </li> <li>\u6388\u6b0a (Authorization): \u6c7a\u5b9a\u8ab0\u80fd\u505a\u4ec0\u9ebc\uff1f<ul> <li>\u57fa\u65bc\u89d2\u8272\u5b58\u53d6\u63a7\u5236\u6a5f\u5236 (Role-Based Access Control, RBAC): \u57fa\u65bc\u89d2\u8272\u4f86\u63a7\u5236\u5b58\u53d6\u6b0a\u9650</li> <li>\u57fa\u65bc\u5c6c\u6027\u5b58\u53d6\u63a7\u5236\u6a5f\u5236 (Attribute-Based Access Control, ABAC): \u57fa\u65bc\u4f7f\u7528\u8005\u7684\u5c6c\u6027\u4f86\u63a7\u5236\u5b58\u53d6\u6b0a\u9650</li> <li>Node Authorization: \u6c7a\u5b9a Node \u662f\u5426\u80fd\u52a0\u5165 K8s \u53e2\u96c6</li> <li>Webhook Mode: \u900f\u904e Webhook \u670d\u52d9\u4f86\u6388\u6b0a </li> </ul> </li> </ul> </li> <li> <p>TLS \u8b49\u66f8: \u7528\u65bc\u52a0\u5bc6\u901a\u8a0a</p> <ul> <li>\u5728 K8s \u53e2\u96c6\u4e2d\u7684\u5404\u7269\u4ef6\u4e4b\u9593\uff0c\u90fd\u6703\u4f7f\u7528 TLS \u8b49\u66f8\u4f86\u52a0\u5bc6\u901a\u8a0a     </li> </ul> </li> <li> <p>Networking: \u8b93 K8s \u53e2\u96c6\u4e2d\u7684 Pods \u80fd\u5920\u4e92\u76f8\u901a\u8a0a</p> <ul> <li>\u9810\u8a2d K8s \u53e2\u96c6\u4e2d\u7684 Pods \u80fd\u5920\u4e92\u76f8\u901a\u8a0a</li> <li>\u53ef\u4f7f\u7528 Network Policies \u4f86\u63a7\u5236\u6d41\u91cf     </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#authentication","title":"Authentication","text":"<ul> <li> <p>K8s \u53e2\u96c6\u4e2d\u6703\u6709\u5b58\u5728\u4ee5\u4e0b\u4f7f\u7528\u8005\u5e33\u865f:</p> <ul> <li>\u7ba1\u7406\u8005</li> <li>\u958b\u767c\u8005</li> <li>\u7d42\u7aef\u4f7f\u7528\u8005 (\u7531\u61c9\u7528\u7a0b\u5f0f\u5167\u90e8\u4f5c\u7ba1\u7406\uff0c\u6545\u66ab\u4e0d\u8a0e\u8ad6)</li> <li>\u7b2c\u4e09\u65b9\u61c9\u7528\u7a0b\u5f0f (Bots) </li> </ul> </li> <li> <p>\u4e0a\u8ff0\u7684\u56db\u7a2e\u4f7f\u7528\u8005\u5e33\u6236\uff0c\u53ef\u4ee5\u5927\u81f4\u5283\u5206\u6210\u4ee5\u4e0b\u5169\u985e:</p> <ul> <li>\u4eba\u985e: \u7ba1\u7406\u8005\u3001\u958b\u767c\u8005</li> <li>\u6a5f\u5668: \u5176\u4ed6\u9700\u8981\u5b58\u53d6 K8s \u53e2\u96c6\u7684 process/service/application</li> </ul> </li> <li> <p>K8s \u53e2\u96c6\u7121\u6cd5\u5efa\u7acb/\u67e5\u8a62\u4f7f\u7528\u8005\u5e33\u865f\uff0c\u53ea\u80fd\u900f\u904e\u5916\u90e8\u8a8d\u8b49\u63d0\u4f9b\u8005 (e.g. LDAP) \u4f86\u5efa\u7acb/\u67e5\u8a62\u4f7f\u7528\u8005\u5e33\u865f     </p> </li> <li> <p>\u6240\u6709\u4f7f\u7528\u8005\u7684\u5b58\u53d6\u6b0a\u9650\u90fd\u662f\u7531 kube-apiserver \u9032\u884c\u7ba1\u7406\uff0c\u4e26\u4e14\u6240\u6709\u7684 API \u8acb\u6c42\u90fd\u6703\u7d93\u904e kube-apiserver \u4f86\u8655\u7406     </p> </li> <li> <p>kube-apiserver \u6703\u900f\u904e\u4ee5\u4e0b 4 \u7a2e\u65b9\u6cd5\u4f86\u8a8d\u8b49\u4f7f\u7528\u8005     </p> <ul> <li> <p>\u57fa\u672c\u7684\u4f7f\u7528\u8005\u540d\u7a31/\u5bc6\u78bc (\u5df2\u65bc K8s v1.19 \u7248\u672c\u5f8c\u505c\u7528)</p> <ul> <li> <p>\u6cd5\u4e00: \u5728 CLI \u4e0a\uff0c\u57f7\u884c\u6642\u900f\u904e\u9078\u9805\u8a2d\u5b9a     </p> </li> <li> <p>\u6cd5\u4e8c: \u4f7f\u7528 kubeadm\uff0c\u5728 kube-apiserver YAML manifest \u8a2d\u5b9a\u6a94\u4e2d\uff0c\u8a2d\u5b9a\u4f7f\u7528\u8005\u540d\u7a31/\u5bc6\u78bc     </p> </li> </ul> </li> </ul> </li> <li> <p>\u900f\u904e CLI \u6307\u4ee4\u7684\u9078\u9805\uff0c\u8a8d\u8b49\u4f7f\u7528\u8005     Bash<pre><code>curl -v -k http://master-node-ip:6443/api/v1/pods -u \"user1:password123\"\n</code></pre></p> <p></p> </li> <li> <p>\u900f\u904e token \u8a8d\u8b49\u4f7f\u7528\u8005     </p> </li> </ul>"},{"location":"cloud/k8s/cka/#tls-certificates-for-cluster-components","title":"TLS certificates for cluster components","text":"<ul> <li>\u975e\u5c0d\u7a31\u52a0\u5bc6\u6cd5 (Asymmetric Encryption)<ul> <li>\u53ef\u900f\u904e\u516c\u9470 (Public Key) \u52a0\u5bc6\uff0c\u79c1\u9470 (Private Key) \u89e3\u5bc6</li> </ul> </li> <li> <p>\u5efa\u7acb\u516c\u79c1\u9470\u5c0d     Bash<pre><code>ssh-keygen -t rsa -b 2048 -f mykey\n</code></pre></p> </li> <li> <p>\u6aa2\u8996\u516c\u9470     Bash<pre><code>cat ~/.ssh/id_rsa.pub\n</code></pre></p> </li> <li> <p>\u6307\u5b9a\u79c1\u9470\u7684\u672c\u5730\u7aef\u8def\u5f91\uff0c\u767b\u5165\u9060\u7aef\u7cfb\u7d71     Bash<pre><code>ssh -i /path/to/id_rsa user1@server1\n</code></pre></p> </li> <li> <p>\u540c\u4e00\u500b\u4f7f\u7528\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528\u79c1\u9470\uff0c\u5c0d\u591a\u500b\u9060\u7aef\u7cfb\u7d71\u7684\u516c\u9470\u9032\u884c\u8a8d\u8b49\uff0c\u4f86\u767b\u5165\u7cfb\u7d71     </p> </li> <li> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 OpenSSL \u5de5\u5177\uff0c\u7522\u751f\u516c\u79c1\u9470\u5c0d     Bash<pre><code>openssl genrsa -out my-bank.key 1024\nopenssl rsa -in my-bank.key -pubout &gt; mybank.pem\n</code></pre></p> </li> <li> <p>\u6191\u8b49\u6a5f\u69cb (Certificate Authority, CA)</p> <ul> <li> <p>e.g. Symantec, DigiCert, Comodo, GlobalSign \u7b49 </p> </li> <li> <p>\u9700\u8981\u7528\u79c1\u9470\u4f86\u7522\u751f CSR \u6587\u4ef6</p> </li> <li> <p>CSR (Certificate Signing Request) \u662f\u4e00\u500b\u767c\u9001\u7d66 CA \u7684\u6587\u4ef6\uff0c\u7528\u65bc\u8acb\u6c42\u9812\u767c\u6191\u8b49\u3002CSR \u6703\u5305\u542b\u4e00\u4e9b\u95dc\u9375\u8a0a\u606f\uff0c\u4f8b\u5982: \u7d44\u7e54\u540d\u7a31\u3001\u57df\u540d\u3001\u516c\u9470\u3001\u5176\u4ed6\u8b58\u5225\u4fe1\u606f\u3002</p> </li> <li> <p>\u7c3d\u7f72 SSL/TLS \u8b49\u66f8\u7684\u6d41\u7a0b</p> <ul> <li> <p>Certificate Signing Request (CSR)\uff1a\u7522\u751f\u4e00\u500b\u5305\u542b\u7533\u8acb\u8005\u8a0a\u606f\u7684 CSR \u6587\u4ef6     Bash<pre><code>openssl req -new -key my-bank.key -out my-bank.csr -subj \"/C=US/ST=CA/O=MyOrg, Inc./CN=my-bank.com\"\n</code></pre></p> <p></p> </li> <li> <p>Validate Information\uff1a\u6191\u8b49\u6a5f\u69cb\uff08CA\uff09\u6703\u9a57\u8b49\u7533\u8acb\u8005\u63d0\u4f9b\u7684\u8a0a\u606f     </p> </li> <li> <p>Sign and Send Certificate\uff1aCA \u7c3d\u540d\uff0c\u4e26\u767c\u9001\u6b63\u5f0f\u7684\u8b49\u66f8\u7d66\u7533\u8acb\u8005     </p> </li> </ul> </li> </ul> </li> <li> <p>\u516c\u5171\u9375\u503c\u57fa\u790e\u5efa\u8a2d (Public Key Infrastructure, PKI)</p> <ul> <li>\u7528\u65bc\u5efa\u7acb\u3001\u7ba1\u7406\u3001\u5132\u5b58\u3001\u5206\u767c\u3001\u64a4\u92b7\u6578\u4f4d\u8b49\u66f8</li> <li>\u7528\u65bc\u78ba\u4fdd\u6578\u4f4d\u8b49\u66f8\u7684\u5b89\u5168\u6027 </li> </ul> </li> <li> <p>\u516c\u79c1\u9470\u7684\u6163\u7528\u547d\u540d\u98a8\u683c</p> <ul> <li>\u516c\u9470: <code>.crt</code>, <code>.cert</code>, <code>.pem</code> \u7d50\u5c3e</li> <li>\u79c1\u9470: \u542b\u6709 <code>.key</code></li> </ul> <p></p> </li> <li> <p>\u5728 K8s \u53e2\u96c6\u4e2d\uff0c\u95dc\u65bc TLS \u52a0\u5bc6\u50b3\u8f38\u901a\u5e38\u6703\u6709\u4ee5\u4e0b\u5169\u500b\u8981\u6c42</p> <ul> <li> <p>\u4f3a\u670d\u5668\u7aef\u8b49\u66f8 (Server Certificates): \u9700\u8981\u4f7f\u7528\u4f3a\u670d\u5668\u8b49\u66f8\u4f86\u9a57\u8b49\u5b83\u5011\u7684\u8eab\u4efd</p> <ul> <li>kube-apiserver server: \u7528\u65bc\u8b49\u660e\u81ea\u5df1\u662f\u5408\u6cd5\u7684 kube-apiserver\uff0c\u8b93\u5176\u4ed6\u5ba2\u6236\u7aef\u5982 kubectl\u3001kubelet \u53ef\u4ee5\u4fe1\u4efb\u4e26\u8207\u5176\u5b89\u5168\u901a\u8a0a</li> <li>etcd server: \u7528\u65bc\u8b49\u660e\u81ea\u5df1\u662f\u5408\u6cd5\u7684 etcd \u4f3a\u670d\u5668\uff0c\u8b93 kube-apiserver \u548c\u5176\u4ed6\u5ba2\u6236\u7aef\u53ef\u4ee5\u4fe1\u4efb\u4e26\u8207\u5176\u5b89\u5168\u901a\u8a0a</li> <li>kubelet server: \u7528\u65bc\u8b49\u660e\u81ea\u5df1\u662f\u5408\u6cd5\u7684 kubelet \u4f3a\u670d\u5668\uff0c\u8b93 kube-apiserver \u548c\u5176\u4ed6\u5ba2\u6236\u7aef\u53ef\u4ee5\u4fe1\u4efb\u4e26\u8207\u5176\u5b89\u5168\u901a\u8a0a </li> </ul> </li> <li> <p>\u5ba2\u6236\u7aef\u8b49\u66f8 (Client Certificates): \u9700\u8981\u4f7f\u7528\u5ba2\u6236\u7aef\u8b49\u66f8\u4f86\u8b49\u660e\u5b83\u5011\u7684\u8eab\u4efd</p> <ul> <li>admin</li> <li>kube-scheduler</li> <li>kube-controller-manager</li> <li>kube-proxy</li> <li>kube-apiserver client: \u7576 kube-apiserver \u9700\u8981\u8207 etcd \u7b49\u5176\u4ed6\u670d\u52d9\u901a\u8a0a\u6642\uff0c\u7528\u65bc\u8b49\u660e\u81ea\u5df1\u7684\u8eab\u4efd</li> <li>etcd client: \u7576 etcd \u9700\u8981\u8207\u5176\u4ed6\u670d\u52d9\u901a\u4fe1\u6642\uff0c\u5982 K8s \u53e2\u96c6\u5167\u7684\u5176\u4ed6 etcd \u7bc0\u9ede\uff0c\u7528\u65bc\u8b49\u660e\u81ea\u5df1\u7684\u8eab\u4efd</li> <li>kubelet client: \u7576 kubelet \u9700\u8981\u8207 kube-apiserver \u6216\u5176\u4ed6\u670d\u52d9\u901a\u8a0a\u6642\uff0c\u7528\u65bc\u8b49\u660e\u81ea\u5df1\u7684\u8eab\u4efd </li> </ul> </li> <li> <p>\u7d71\u6574\u6982\u5ff5:      </p> </li> </ul> </li> <li> <p>\u5efa\u7acb TLS \u8b49\u66f8</p> <ul> <li> <p>CA (\u6191\u8b49\u6a5f\u69cb\u672c\u8eab)</p> <ul> <li> <p>Step 1: \u7522\u751f\u516c\u79c1\u9470\u5c0d     Bash<pre><code>openssl genrsa -out ca.key 2048\n</code></pre></p> </li> <li> <p>Step 2: \u7522\u751f CSR \u6587\u4ef6     Text Only<pre><code>openssl req -new -key ca.key -subj \"/CN=KUBERNETES-CA\" -out ca.csr\n</code></pre></p> </li> <li> <p>Step 3: \u7c3d\u7f72\u8b49\u66f8     Text Only<pre><code>openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>Server Certificates</p> <ul> <li> <p>kube-apiserver server:      </p> </li> <li> <p>etcd server      </p> </li> <li> <p>kubelet server:     </p> </li> </ul> </li> <li> <p>Client Certificates</p> <ul> <li> <p>admin </p> <ul> <li> <p>Step 1: \u7522\u751f\u516c\u79c1\u9470\u5c0d     Bash<pre><code>openssl genrsa -out admin.key 2048\n</code></pre></p> </li> <li> <p>Step 2: \u7522\u751f CSR \u6587\u4ef6     Bash<pre><code>openssl req -new -key admin.key -subj \"/CN=kube-admin\" -out admin.csr\n</code></pre></p> </li> <li> <p>Step 3: \u7c3d\u7f72\u8b49\u66f8     Bash<pre><code>openssl x509 -req -in admin.csr -CA ca.crt -CAkey ca.key -out admin.crt\n</code></pre></p> </li> <li> <p>Step 4: \u6388\u6b0a\u7d66 admin \u4f7f\u7528     Bash<pre><code>openssl req -new -key admin.key -subj \"/CN=kube-admin/O=system:masters\" -out admin.csr\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>kube-scheduler     </p> </li> <li> <p>kube-controller-manager     </p> </li> <li> <p>kube-proxy     </p> </li> <li> <p>kubelet client:     </p> </li> <li> <p>\u7d71\u6574:     </p> </li> </ul> </li> </ul> </li> <li> <p>\u8a2d\u5b9a TLS \u8b49\u66f8\u7d66 K8s \u53e2\u96c6\u4e2d\u7684\u5404\u5143\u4ef6</p> <ul> <li>\u624b\u52d5\u8a2d\u5b9a --- \u4e0d\u63a8\u85a6\uff0c\u8f03\u8907\u96dc</li> <li>\u900f\u904e kubeadm \u5de5\u5177\u8a2d\u5b9a --- \u63a8\u85a6\u4f5c\u6cd5 </li> </ul> </li> <li> <p>\u53ef\u900f\u904e kube-apiserver \u7684 YAML manifest \u8a2d\u5b9a\u6a94\uff0c\u4f86\u6aa2\u8996 kube-apiserver \u7684\u8b49\u66f8     Bash<pre><code>cat /etc/kubernetes/manifests/kube-apiserver.yaml\n</code></pre></p> <p></p> </li> <li> <p>\u6aa2\u8996 TLS \u8b49\u66f8\u7684\u5167\u5bb9     Bash<pre><code>openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text -noout\n</code></pre></p> <p></p> </li> <li> <p>\u6aa2\u8996 K8s \u53e2\u96c6\u4e2d\u5404\u5143\u4ef6\u7684 TLS \u8b49\u66f8\u5167\u5bb9: \u6aa2\u67e5 TLS \u8b49\u66f8\u662f\u5426\u7686\u7531\u6b63\u78ba\u7684 CA \u7c3d\u767c\uff0c\u4e14\u662f\u5426\u5728\u6709\u6548\u671f\u9650\u5167     </p> </li> <li> <p>\u6aa2\u8996 K8s \u53e2\u96c6\u7684\u555f\u52d5\u72c0\u614b</p> <ul> <li> <p>\u6cd5\u4e00: \u5047\u8a2d\u4f7f\u7528 kubeadm \u5efa\u7acb K8s \u53e2\u96c6\uff0c\u53ef\u67e5\u770b etcd \u7684 log     Bash<pre><code>kubectl logs etcd-master\n</code></pre></p> <p></p> </li> <li> <p>\u6cd5\u4e8c: \u82e5 K8s \u53e2\u96c6\u672a\u6b63\u78ba\u555f\u52d5 (e.g. kube-apiserver || etcd \u670d\u52d9\u672a\u6b63\u5e38\u555f\u52d5)\uff0c\u5c0e\u81f4 kubectl \u6307\u4ee4\u7121\u6cd5\u4f7f\u7528\u6642\uff0c\u53ef\u6aa2\u8996 container \u7684 log     Bash<pre><code>docker ps -a\n</code></pre></p> Text Only<pre><code>docker logs &lt;container-id&gt;\n</code></pre> <p></p> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#k8s-certificate-api","title":"K8s Certificate API","text":"<ul> <li> <p>K8s Certificate API</p> <ul> <li> <p>K8s \u53e2\u96c6\u6703\u7531 kube-controller-manager \u64d4\u4efb CA \u7684\u89d2\u8272\uff0c\u8ca0\u8cac\u7c3d\u7f72 K8s \u53e2\u96c6\u5167\u90e8\u5404\u5143\u4ef6\u7684 TLS \u8b49\u66f8      </p> </li> <li> <p>\u7c3d\u7f72 TLS \u8b49\u66f8\u7684\u6d41\u7a0b: \u5c07 CSR \u6587\u4ef6\uff0c\u900f\u904e K8s Certificate API \u9001\u81f3 kube-controller-manager\uff0c\u7531\u5176\u7c3d\u7f72\u8b49\u66f8     </p> <ul> <li> <p>Step 1: \u4f7f\u7528\u8005\u5efa\u7acb\u65b0\u7684\u79c1\u9470     Bash<pre><code>openssl genrsa -out jane.key 2048\n</code></pre></p> </li> <li> <p>Step 2: \u7522\u751f\u4e00\u500b CSR \u6587\u4ef6     Bash<pre><code>openssl req -new -key jane.key -subj \"/CN=jane\" -out jane.csr \n</code></pre></p> </li> <li> <p>Step 3: \u4f7f\u7528\u8005\u5c07 CSR \u6587\u4ef6\u767c\u9001\u7d66 admin\uff0c\u7531 admin \u5c07 CSR \u6587\u4ef6\u8f49\u63db\u6210 CSR \u7269\u4ef6\uff0c\u4e26\u5c07\u5176\u904b\u7528 base64 \u7de8\u78bc\u5f8c\u5132\u5b58     YAML<pre><code>apiVersion: certificates.k8s.io/v1beta1\nkind: CertificateSigningRequest\nmetadata:\n    name: jane\n\nspec:\n    groups:\n    -   system:authenticated\n    usages:\n    -   digital signature\n    -   key encipherment\n    -   server auth\nrequest:\n    &lt;certificate-goes-here&gt;\n</code></pre></p> <ul> <li> <p>\u6aa2\u8996 CSR \u6587\u4ef6\u7684\u5167\u5bb9     Bash<pre><code>cat jane.csr | base64\n</code></pre></p> </li> <li> <p>\u5efa\u7acb CertificateSigningRequest \u7269\u4ef6     Bash<pre><code>kubectl create -f jane.yaml\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>Step 4: \u5217\u51fa\u76ee\u524d\u6240\u6709\u7684 CSR \u6587\u4ef6     Bash<pre><code>kubectl get csr\n</code></pre></p> </li> <li> <p>Step 5: \u5141\u8a31\u7c3d\u7f72 CSR \u6587\u4ef6     Bash<pre><code>kubectl certificate approve jane\n</code></pre></p> <ul> <li> <p>\u4e5f\u53ef\u4ee5\u62d2\u7d55\u7c3d\u7f72 CSR \u6587\u4ef6     Bash<pre><code>kubectl certificate deny jane\n</code></pre></p> </li> <li> <p>\u4e5f\u53ef\u4ee5\u522a\u9664 CSR \u6587\u4ef6     Bash<pre><code>kubectl delete csr jane\n</code></pre></p> </li> </ul> </li> <li> <p>Step 6: \u6aa2\u8996 TLS \u8b49\u66f8\u7684\u5167\u5bb9     Bash<pre><code>kubectl get csr jane -o=yaml\n</code></pre></p> <ul> <li>\u6aa2\u8996 TLS \u8b49\u66f8\u7684\u5167\u5bb9     Bash<pre><code>echo \"&lt;certificate&gt;\" | base64 --decode\n</code></pre></li> </ul> <p></p> </li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#kubeconfig","title":"kubeconfig","text":"<ul> <li> <p>kubeconfig</p> <ul> <li> <p>\u7576\u6211\u5011\u8981\u5b58\u53d6 K8s \u53e2\u96c6\u7684\u8cc7\u6e90\u6642\uff0c\u9700\u63d0\u4f9b\u76f8\u95dc\u8a8d\u8b49\u8cc7\u8a0a\u3002\u4f46\u5982\u679c\u6bcf\u6b21\u90fd\u9019\u9ebc\u505a\uff0c\u6703\u6709\u9ede\u9ebb\u7169\u3002\u56e0\u6b64\uff0c\u6211\u5011\u53ef\u4ee5\u8a2d\u5b9a kubeconfig \u6a94\u6848\uff0c\u4f86\u5b58\u653e\u9019\u4e9b\u8a8d\u8b49\u8cc7\u8a0a     </p> Bash<pre><code>kubectl get pods --kubeconfig &lt;config-file-name&gt;\n</code></pre> </li> <li> <p>kubeconfig \u6a94\u6848\u6703\u5305\u542b\u4ee5\u4e0b\u4e09\u500b\u90e8\u5206</p> <ul> <li>Cluster: \u95dc\u65bc K8s \u53e2\u96c6\u7684\u8cc7\u8a0a</li> <li>Context: \u95dc\u65bc\u4f7f\u7528\u8005\u5982\u4f55\u5b58\u53d6 K8s \u53e2\u96c6\u7684\u8cc7\u8a0a (\u5c07 Cluster &amp; User \u7d50\u5408\u5728\u4e00\u8d77)</li> <li>User: \u95dc\u65bc\u4f7f\u7528\u8005\u7684\u8cc7\u8a0a  </li> </ul> </li> <li> <p>\u6aa2\u8996\u7576\u524d K8s \u53e2\u96c6\u6b63\u5728\u4f7f\u7528\u7684 kubeconfig \u8a2d\u5b9a\u6a94\u5167\u5bb9     Bash<pre><code>kubectl config view\n</code></pre></p> <p></p> </li> <li> <p>\u6aa2\u8996\u6307\u5b9a\u8def\u5f91\u4e0b\u7684 kubeconfig \u8a2d\u5b9a\u6a94\u5167\u5bb9     Bash<pre><code>kubectl config veiw --kubeconfig=my-custom-config\n</code></pre></p> <p></p> </li> <li> <p>\u66f4\u65b0\u7576\u524d\u4f7f\u7528\u7684 kubeconfig context \u8a2d\u5b9a     Bash<pre><code>kubectl config use-context &lt;context-name&gt;\nkubectl config use-context prod-user@production\n</code></pre></p> <p></p> </li> <li> <p>\u8a2d\u5b9a kubeconfig \u4e2d context \u7684 namespace     </p> </li> <li> <p>\u8a2d\u5b9a kubeconfig \u4e2d context \u7684 TLS \u8b49\u66f8</p> <ul> <li> <p>\u6cd5\u4e00: \u53ef\u6307\u5b9a TLS \u8b49\u66f8\u7684\u8def\u5f91\u4f4d\u7f6e     </p> </li> <li> <p>\u6cd5\u4e8c: \u53ef\u6307\u5b9a TLS \u8b49\u66f8\u7684 base64 \u7de8\u78bc\u5167\u5bb9      </p> </li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#authorization","title":"Authorization","text":""},{"location":"cloud/k8s/cka/#k8s-api-groups","title":"K8s API groups","text":"<ul> <li> <p>\u6aa2\u8996\u7576\u524d K8s \u53e2\u96c6\u7684\u7248\u672c\u865f     Bash<pre><code>curl https://kube-master:6443/version\n</code></pre></p> </li> <li> <p>\u6aa2\u8996\u7576\u524d K8s \u53e2\u96c6\u6709\u54ea\u4e9b Pods     Bash<pre><code>curl https://kube-master:6443/api/v1/pods\n</code></pre></p> <p></p> </li> <li> <p>K8s \u53e2\u96c6\u7684 APIs \u6703\u6839\u64da\u7528\u9014\u5283\u5206\u70ba\u4ee5\u4e0b\u7684\u7fa4\u7d44:</p> <ul> <li><code>/metrics</code>: \u63d0\u4f9b\u7cfb\u7d71\u6027\u80fd\u3001\u8cc7\u6e90\u4f7f\u7528\u7684\u6307\u6a19\u6578\u64da\uff0c\u5e38\u7528\u65bc\u76e3\u63a7</li> <li><code>/healthz</code>: \u63d0\u4f9b\u61c9\u7528\u7a0b\u5e8f\u7684\u5065\u5eb7\u72c0\u614b\u6aa2\u67e5\uff0c\u7528\u65bc\u78ba\u8a8d\u61c9\u7528\u7a0b\u5f0f\u662f\u5426\u6b63\u5e38\u904b\u884c</li> <li><code>/version</code>: \u986f\u793a kube-apiserver \u7684\u7248\u672c\u8cc7\u8a0a</li> <li> <p><code>/api</code>: \u6838\u5fc3 API \u7684\u5165\u53e3\uff0c\u8655\u7406\u57fa\u672c\u7684 K8s \u8cc7\u6e90     </p> </li> <li> <p><code>/apis</code>: \u64f4\u5c55 API \u7684\u5165\u53e3\uff0c\u8655\u7406\u66f4\u5c08\u9580\u7684 K8s \u8cc7\u6e90     </p> </li> <li> <p><code>/logs</code>: \u63d0\u4f9b log \u6578\u64da\uff0c\u901a\u5e38\u7528\u65bc\u9664\u932f\u3001\u76e3\u63a7 </p> </li> </ul> </li> <li> <p>\u5217\u51fa\u6240\u6709\u7684 API groups     Bash<pre><code>curl http://localhost:6443 -k\n</code></pre></p> Bash<pre><code>curl http://localhost:6443/apis -k | grep \"name\"\n</code></pre> <ul> <li><code>-k</code>: \u7528\u65bc\u544a\u8a34 curl \u5ffd\u7565 SSL \u8b49\u66f8\u7684\u9a57\u8b49\uff0c\u901a\u5e38\u7528\u65bc\u672c\u5730\u7aef or \u6e2c\u8a66\u74b0\u5883 </li> </ul> </li> <li> <p>\u5b58\u53d6 kube-apiserver \u7684\u65b9\u6cd5</p> <ul> <li> <p>\u6cd5\u4e00: curl \u6307\u4ee4 + TLS \u8b49\u66f8 (\u8f03\u8907\u96dc)     </p> </li> <li> <p>\u6cd5\u4e8c: kubectl-proxy \u4f5c\u70ba\u4ee3\u7406\u4f3a\u670d\u5668\uff0c\u4f86\u5b58\u53d6 kube-apiserver     </p> <ul> <li>\u6ce8\u610f! kube-proxy \u4e0d\u7b49\u65bc kubectl-proxy </li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#authorization-mechanisms","title":"Authorization Mechanisms","text":"<ul> <li> <p>K8s \u53e2\u96c6\u652f\u63f4\u4ee5\u4e0b\u5e7e\u7a2e\u6388\u6b0a\u6a5f\u5236\uff0c\u4f86\u63a7\u5236 K8s API \u7684\u5b58\u53d6\u6b0a\u9650</p> <ul> <li> <p>Node Authorization: \u6c7a\u5b9a Node \u662f\u5426\u80fd\u52a0\u5165 K8s \u53e2\u96c6     </p> </li> <li> <p>ABAC (Attribute-Based Access Control): \u57fa\u65bc\u4f7f\u7528\u8005\u7684\u5c6c\u6027\u4f86\u63a7\u5236\u5b58\u53d6\u6b0a\u9650     </p> </li> <li> <p>RBAC (Role-Based Access Control): \u57fa\u65bc\u89d2\u8272\u4f86\u63a7\u5236\u5b58\u53d6\u6b0a\u9650     </p> </li> <li> <p>Webhook Mode: \u900f\u904e Webhook \u670d\u52d9\uff0c\u7531 K8s \u53e2\u96c6\u5916\u90e8\u7684\u670d\u52d9\u9032\u884c\u6388\u6b0a\u6c7a\u7b56     </p> </li> <li> <p>AlwaysAllow: \u7121\u8ad6\u4efb\u4f55\u60c5\u6cc1\uff0c\u90fd\u5141\u8a31\u5b58\u53d6</p> <ul> <li>\u9019\u662f K8s \u53e2\u96c6\u7684\u9810\u8a2d\u6388\u6b0a\u6a5f\u5236 </li> </ul> </li> <li> <p>AlwaysDeny: \u7121\u8ad6\u4efb\u4f55\u60c5\u6cc1\uff0c\u90fd\u62d2\u7d55\u5b58\u53d6</p> </li> </ul> </li> <li> <p>\u82e5\u540c\u6642\u4f7f\u7528\u591a\u7a2e\u6388\u6b0a\u6a5f\u5236\uff0cK8s \u53e2\u96c6\u6703\u6309\u7167\u6240\u5217\u51fa\u7684\u9806\u5e8f\uff0c\u9032\u884c\u6388\u6b0a\u6c7a\u7b56</p> <ul> <li>\u82e5\u524d\u4e00\u500b\u6388\u6b0a\u6a5f\u5236\u62d2\u7d55\u8acb\u6c42\u7684\u8a71\uff0c\u5c31\u7531\u4e0b\u4e00\u500b\u6388\u6b0a\u6a5f\u5236\u9032\u884c\u6388\u6b0a\u6c7a\u7b56\uff0c\u4f9d\u6b64\u985e\u63a8</li> <li>\u4e00\u65e6\u67d0\u500b\u6388\u6b0a\u6a5f\u5236\u5141\u8a31\u8acb\u6c42\uff0c\u5c31\u4e0d\u6703\u518d\u7e7c\u7e8c\u5f80\u4e0b\u9032\u884c\u6388\u6b0a\u6c7a\u7b56 </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#rbac-authorization","title":"RBAC authorization","text":"<ul> <li>\u6bcf\u500b Role \u6703\u5305\u542b\u4e09\u500b\u5340\u584a<ul> <li>apiGroups: \u6307\u5b9a\u4f7f\u7528 API \u7fa4\u7d44<ul> <li><code>\"\"</code>: \u8868\u793a core API \u7fa4\u7d44</li> <li><code>apps</code>: \u8868\u793a named API \u7fa4\u7d44</li> </ul> </li> <li>resources: \u6307\u5b9a\u53ef\u5b58\u53d6\u7684 K8s \u7269\u4ef6\u6709\u54ea\u4e9b</li> <li>verbs: \u6307\u5b9a\u5c0d\u8cc7\u6e90\u53ef\u57f7\u884c\u7684\u64cd\u4f5c\u6709\u54ea\u4e9b</li> </ul> </li> <li> <p>\u5efa\u7acb Role     YAML<pre><code># developer-role.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n    name: developer\n\n# \u6307\u5b9a\u6388\u6b0a\u7684\u898f\u5247\nrules:\n-   apiGroups: [\"\"]        # \"\" indicates the core API group\n    resources: [\"pods\"]\n    verbs: [\"get\", \"list\", \"update\", \"delete\", \"create\"]\n\n-   apiGroups: [\"\"]\n    resources: [\"ConfigMap\"]\n    verbs: [\"create\"]\n</code></pre></p> Bash<pre><code>kubectl create -f developer-role.yaml\n</code></pre> </li> <li> <p>\u6839\u64da Role\uff0c\u5efa\u7acb RoleBinding     YAML<pre><code># developer-role-binding.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n    name: devuser-developer-binding\n\n# \u6307\u5b9a\u8981\u6388\u6b0a\u7684\u4f7f\u7528\u8005\nsubjects:\n-   kind: User\n    name: dev-user # \"name\" is case sensitive\n    apiGroup: rbac.authorization.k8s.io\n\n# \u6307\u5b9a\u8981\u6388\u4e88\u7684 Role\nroleRef:\n    kind: Role\n    name: developer\n    apiGroup: rbac.authorization.k8s.io\n</code></pre></p> Bash<pre><code>kubectl create -f devuser-developer-binding.yaml\n</code></pre> <p></p> </li> <li> <p>\u5217\u51fa\u7576\u524d\u6240\u6709 RBAC \u7684 Role     Bash<pre><code>kubectl get roles\n</code></pre></p> </li> <li> <p>\u8a73\u7d30\u6aa2\u8996\u6307\u5b9a Role \u7684\u8cc7\u8a0a     Bash<pre><code>kubectl describe role developer\n</code></pre></p> </li> <li> <p>\u5217\u51fa\u7576\u524d\u6240\u6709 RBAC \u7684 RoleBinding     Bash<pre><code>kubectl get rolebindings\n</code></pre></p> <p></p> </li> <li> <p>\u8a73\u7d30\u6aa2\u8996\u6307\u5b9a RoleBinding \u7684\u8cc7\u8a0a     Bash<pre><code>kubectl describe rolebinding devuser-developer-binding\n</code></pre></p> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#check-access-control","title":"Check Access Control","text":"<ul> <li> <p>\u6aa2\u8996\u7576\u524d\u4f7f\u7528\u8005\u7684\u5c0d\u65bc\u67d0\u500b\u64cd\u4f5c\u7684\u5b58\u53d6\u6b0a\u9650 Bash<pre><code>kubectl auth can-i create deployments\n</code></pre></p> Bash<pre><code>kubectl auth can-i delete nodes\n</code></pre> </li> <li> <p>\u4ee5\u6307\u5b9a\u4f7f\u7528\u8005\u7684\u8eab\u4efd\uff0c\u6aa2\u8996\u5176\u5c0d\u65bc\u67d0\u500b\u64cd\u4f5c\u7684\u5b58\u53d6\u6b0a\u9650     Bash<pre><code>kubectl auth can-i create deployments --as=dev-user\n</code></pre></p> Bash<pre><code>kubectl auth can-i create pods --as=dev-user\n</code></pre> </li> <li> <p>\u5728\u6307\u5b9a\u7684 namespace \u4e2d\uff0c\u4ee5\u6307\u5b9a\u7684\u4f7f\u7528\u8005\u8eab\u4efd\uff0c\u6aa2\u8996\u5176\u5c0d\u65bc\u67d0\u500b\u64cd\u4f5c\u7684\u5b58\u53d6\u6b0a\u9650     Bash<pre><code>kubectl auth can-i create pods --as dev-user --namespace=test\n</code></pre></p> </li> </ul> <p></p>"},{"location":"cloud/k8s/cka/#resource-names","title":"Resource Names","text":"<ul> <li> <p>\u6307\u5b9a\u54ea\u4e9b K8s \u8cc7\u6e90\u53ef\u4ee5\u88ab\u5b58\u53d6</p> <ul> <li>e.g. Pods</li> </ul> YAML<pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n    name: developer\n\n# \u6307\u5b9a\u6388\u6b0a\u7684\u898f\u5247\nrules:\n-   apiGroups: [\"\"]      # \"\" indicates the core API group\n    # \u6307\u5b9a\u53ef\u4ee5\u5b58\u53d6\u7684 K8s \u8cc7\u6e90\n    resources: [\"pods\"] \n    verbs: [\"get\", \"update\", \"create\"]\n    resourceNames: [\"blue\", \"orange\"]\n</code></pre> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#cluster-roles","title":"Cluster Roles","text":"<ul> <li> <p>\u4e00\u822c\u7684 Role \u662f\u91dd\u5c0d\u67d0\u500b namespace \u4f86\u9032\u884c\u6388\u6b0a     </p> </li> <li> <p>\u800c Cluster Role \u662f\u91dd\u5c0d\u6574\u500b K8s \u53e2\u96c6\u4f86\u9032\u884c\u6388\u6b0a</p> <ul> <li>e.g. \u6211\u5011\u7121\u6cd5\u5c0d Node \u9032\u884c\u8cc7\u6e90\u9694\u96e2\uff0c\u56e0\u70ba Node \u662f\u5c6c\u65bc\u6574\u500b K8s \u53e2\u96c6\u7684\uff0c\u800c\u4e0d\u662f\u96b8\u5c6c\u65bc\u67d0\u500b namespace \u7684 </li> </ul> </li> <li> <p>\u56e0\u6b64\uff0cK8s \u53e2\u96c6\u4e2d\u7684\u6240\u6709\u8cc7\u6e90\u53ef\u5206\u70ba\u4ee5\u4e0b\u5169\u7a2e</p> <ul> <li> <p>Namespaced Resources: \u53ea\u80fd\u5728\u7279\u5b9a\u7684 namespace \u4e2d\u5b58\u53d6     Bash<pre><code>kubectl api-resources --namespaced=true\n</code></pre></p> </li> <li> <p>Cluster-scoped Resources: \u53ef\u5728\u6574\u500b K8s \u53e2\u96c6\u4e2d\u5b58\u53d6     Bash<pre><code>kubectl api-resources --namespaced=false\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>\u5efa\u7acb Cluster Role     YAML<pre><code># cluster-role.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n    name: cluster-administrator\n\n# \u6307\u5b9a\u6388\u6b0a\u7684\u898f\u5247\nrules:\n-   apiGroups: [\"\"] # \"\" indicates the core API group\n    resources: [\"nodes\"]\n    verbs: [\"get\", \"list\", \"delete\", \"create\"]\n</code></pre></p> Bash<pre><code>kubectl create -f cluster-admin-role.yaml\n</code></pre> </li> <li> <p>\u5efa\u7acb Cluster RoleBinding     YAML<pre><code># cluster-admin-role-binding.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n    name: cluster-admin-role-binding\n\n# \u6307\u5b9a\u8981\u6388\u6b0a\u7684\u4f7f\u7528\u8005\nsubjects:\n-   kind: User\n    name: cluster-admin\n    apiGroup: rbac.authorization.k8s.io\n\n# \u6307\u5b9a\u8981\u6388\u4e88\u7684 Cluster Role\nroleRef:\n    kind: ClusterRole\n    name: cluster-administrator\n    apiGroup: rbac.authorization.k8s.io\n</code></pre></p> Bash<pre><code>kubectl create -f cluster-admin-role-binding.yaml\n</code></pre> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#service-account","title":"Service Account","text":"<ul> <li> <p>\u4e00\u822c\u7684 User Account \u4f9b\u4eba\u985e\u4f7f\u7528; \u800c Service Account \u4f9b\u61c9\u7528\u7a0b\u5f0f\u4f7f\u7528     </p> </li> <li> <p>\u5728 K8s v1.24 \u7248\u4e4b\u5f8c\u7684\u66f4\u65b0</p> <ul> <li> <p>\u5efa\u7acb Service Account \u6642\uff0c\u4e0d\u6703\u518d\u81ea\u52d5\u5efa\u7acb token\uff0c\u800c\u662f\u9700\u8981\u900f\u904e TokenRequest API\uff0c\u5efa\u7acb Service Account \u7684 token Bash<pre><code># \u5efa\u7acb Service Account\nkubectl create serviceaccount dashboard-sa\n</code></pre></p> Bash<pre><code># \u900f\u904e TokenRequest API\uff0c\u5efa\u7acb Service Account \u7684 token\nkubectl create token dashboard-sa\n</code></pre> <p></p> </li> <li> <p>\u89e3\u78bc Service Account \u7684 token     Bash<pre><code>jq -R 'split(\".\") | select(length &gt; 0) | .[0], .[1] | @base64d | fromjson' &lt;&lt;&lt; eyJhbGciOiJSUzI...\n</code></pre></p> </li> <li> <p>Service token \u5177\u6709\u6709\u6548\u671f\u9650</p> <ul> <li><code>exp</code>: token \u7684\u904e\u671f\u6642\u9593<ul> <li>\u9810\u8a2d: 1 \u5c0f\u6642</li> </ul> </li> </ul> <p></p> </li> <li> <p>\u82e5\u60f3\u5efa\u7acb\u4e00\u500b\u6c38\u4e45\u6709\u6548\u7684 token\uff0c\u53ef\u5efa\u7acb\u4e00\u500b Secret \u7269\u4ef6\uff0c\u4e26\u5c07 token \u5132\u5b58\u7d81\u5b9a Service Account     YAML<pre><code># secret-definition.yaml\napiVersion: v1\nkind: Secret\ntype: kubernetes.io/service-account-token\nmetadata:\n    name: mysecretname\n    namespace: default\n\n    # \u7d81\u5b9a Service Account\n    annotations:\n        kubernetes.io/service-account.name: dashboard-sa\n\n# \u7d66\u5b9a secret token \u503c\nstringData:\n    token: eyJhbGciOi\n</code></pre></p> Bash<pre><code>kubectl create -f secret-definition.yaml\n</code></pre> <p></p> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#images-security","title":"Images Security","text":"<ul> <li> <p>\u6aa2\u8996 container \u6240\u4f7f\u7528\u7684 image     </p> </li> <li> <p>image name \u7684\u5b8c\u6574\u683c\u5f0f</p> <ul> <li>username/account: \u9810\u8a2d\u662f library\uff0c\u662f Docker Hub \u7684\u9810\u8a2d public namespace\uff0c\u7528\u4f86\u5132\u5b58\u4e00\u4e9b\u77e5\u540d\u4e14\u5e38\u7528\u7684\u5b98\u65b9 image </li> </ul> </li> <li> <p>\u82e5\u8981\u4f7f\u7528 Docker \u767b\u5165 private registry\uff0c\u4e26\u4f7f\u7528 private image     Bash<pre><code>docker login &lt;private-registry.io&gt;\n</code></pre></p> Bash<pre><code>docker run &lt;private-registry.io/apps/internal-app&gt;\n</code></pre> <p></p> </li> <li> <p>\u5728 K8s \u4e2d\uff0c\u9700\u5148\u5efa\u7acb\u4e00\u500b docker-registry secret \u7269\u4ef6\uff0c\u4f86\u5b58\u653e\u767b\u5165 private registry \u7684\u8a8d\u8b49\u8cc7\u8a0a     Bash<pre><code>kubectl create secret docker-registry regcred \\\n    --docker-server=private-registry.io \\ \n    --docker-username=registry-user \\\n    --docker-password=registry-password \\\n    --docker-email=registry-user@org.com\n</code></pre></p> YAML<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n    name: nginx-pod\n\nspec:\n    containers:\n    -   name: nginx\n        image: private-registry.io/apps/internal-app\n\n    # \u6307\u5b9a\u8981\u4f7f\u7528\u7684 docker-registry secret\n    imagePullSecrets:\n    -   name: regcred\n</code></pre> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#security-contexts","title":"Security Contexts","text":"<ul> <li> <p>Docker Security \u5148\u5099\u77e5\u8b58</p> <ul> <li> <p>container \u8207 host \u5171\u4eab\u76f8\u540c\u7684 O.S. kernel\uff0c\u56e0\u6b64\u4e0d\u7b97\u662f\u5b8c\u5168\u7684\u8cc7\u6e90\u9694\u96e2</p> <ul> <li> <p>\u5728 Linux \u4e2d\uff0ccontainer \u662f\u900f\u904e namespace, cgroup \u4f86\u5be6\u73fe\u8cc7\u6e90\u9694\u96e2</p> <ul> <li>namespace: \u7528\u65bc\u9694\u96e2 process</li> <li>cgroup: \u7528\u65bc\u5206\u914d\u8cc7\u6e90 <p>\u4e0d\u540c namespace \u7684\u60c5\u6cc1\u4e0b\uff0c\u53ef\u4ee5\u5b58\u5728\u76f8\u540c\u7684 process ID \u4e0d\u6703\u4e92\u76f8\u5e72\u64fe</p> </li> </ul> </li> <li> <p>container \u8207 host \u4f7f\u7528\u4e0d\u540c\u7684 namespace</p> </li> <li>\u6240\u6709\u5728 container \u4e2d\u904b\u884c\u7684 process \u5be6\u969b\u4e0a\u90fd\u662f\u5728 host \u4e0a\u57f7\u884c\u7684\uff0c\u4f46\u662f\u5728 container \u81ea\u5df1\u7684 namespace \u4e2d\u904b\u884c</li> <li>docker container \u4f4d\u65bc\u81ea\u5df1\u7684 namespace \u4e2d\uff0c\u4e26\u4e14\u53ea\u80fd\u770b\u5230\u81ea\u5df1\u7684 namespace \u4e2d\u7684 process     </li> <li> <p>\u5c0d\u65bc host \u800c\u8a00\uff0ccontainer \u4e2d\u7684 process \u5c31\u50cf\u662f host \u4e0a\u7684\u5176\u4ed6 process \u4e00\u6a23     </p> </li> <li> <p>Host \u9810\u8a2d\u6703\u4f7f\u7528 root \u8eab\u4efd\uff0c\u4f86\u57f7\u884c container \u4e2d\u7684 process</p> <ul> <li> <p>\u53ef\u900f\u904e <code>--user</code> \u9078\u9805\uff0c\u4f86\u6307\u5b9a container \u4e2d\u7684 process \u4f7f\u7528\u8005\u8eab\u4efd     Bash<pre><code>docker run --user=1000 ubuntu sleep 3600\n</code></pre></p> <p></p> </li> <li> <p>\u4e5f\u53ef\u900f\u904e Dockerfile \u6307\u5b9a\u4f7f\u7528\u8005\u8eab\u4efd\uff0c\u672a\u4f86\u7576 container \u57f7\u884c\u9019\u500b image \u6642\uff0c\u5c31\u6703\u9810\u8a2d\u7528\u9019\u500b\u4f7f\u7528\u8005\u8eab\u4efd     Docker<pre><code># my-ubuntu-image.Dockerfile\nFROM ubuntu\nUSER 1\n</code></pre></p> Bash<pre><code>docker build -t my-ubuntu-image .\n</code></pre> Bash<pre><code>docker run my-ubuntu-image sleep 3600\n</code></pre> <p></p> </li> <li> <p>\u900f\u904e Docker \u70ba\u6211\u5011\u5be6\u4f5c\u7684\u5b89\u5168\u6a5f\u5236\uff0ccontainer \u4e2d\u7684 root \u8eab\u4efd\u4e0d\u540c\u65bc host \u4e2d\u7684 root \u8eab\u4efd\uff0c\u80fd\u9650\u5236\u5176\u6b0a\u9650</p> <ul> <li>e.g. \u5728 container \u4e2d\u7684 root \u8eab\u4efd\uff0c\u7121\u6cd5\u76f4\u63a5\u5b58\u53d6 host \u4e2d\u7684\u6a94\u6848</li> <li> <p>Docker \u5be6\u969b\u4e0a\u904b\u7528\u7684\u662f Linux capability \u4f86\u5be6\u4f5c\u5b89\u5168\u6a5f\u5236\u7684 </p> </li> <li> <p>\u8ce6\u4e88 container \u4e2d\u7684 process \u67d0\u4e9b Linux capability \u6b0a\u9650     Bash<pre><code>docker run --cap-add=NET_ADMIN ubuntu sleep 3600\n</code></pre></p> </li> <li> <p>\u9650\u5236 container \u4e2d\u7684 process \u67d0\u4e9b Linux capability \u6b0a\u9650     Bash<pre><code>docker run --cap-drop=NET_ADMIN ubuntu sleep 3600\n</code></pre></p> </li> <li> <p>\u958b\u653e container \u4e2d\u7684 process \u6240\u6709 Linux capability \u6b0a\u9650     Bash<pre><code>docker run --privileged ubuntu sleep 3600\n</code></pre></p> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li> <p>K8s Security</p> <ul> <li> <p>\u53ef\u4ee5\u8a2d\u5b9a Kubernetes Security \u65bc Pod level \u6216 container level</p> <ul> <li>Pod Security Context: \u8a2d\u5b9a\u6574\u500b Pod \u7684\u5b89\u5168\u6027</li> <li>Container Security Context: \u8a2d\u5b9a\u55ae\u4e00\u500b container \u7684\u5b89\u5168\u6027 <p>\u82e5\u5169\u500b\u540c\u6642\u90fd\u6709\u8a2d\u5b9a\uff0c\u5247\u4ee5 Container Security Context \u70ba\u4e3b</p> </li> </ul> <p></p> </li> <li> <p>Pod Level     YAML<pre><code># pod-security-context.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: web-pod\n\nspec:\n    # \u8a2d\u5b9a Pod level \u7684 security context\n    securityContext:\n        runAsUser: 1000\n    containers:\n    -   name: ubuntu\n        image: ubuntu\n        command: [\"sleep\", \"3600\"]\n</code></pre></p> <p></p> </li> <li> <p>container Level     YAML<pre><code># container-security-context.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: web-pod\n\nspec:\n    containers:\n    -   name: ubuntu\n        image: ubuntu\n        command: [\"sleep\", \"3600\"]\n        # \u8a2d\u5b9a container level \u7684 security context\n        securityContext:\n            runAsUser: 1000\n            # \u8a2d\u5b9a container \u7684 linux capability \u6b0a\u9650\n            capabilities: \n                add: [\"MAC_ADMIN\"]\n</code></pre></p> <p></p> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#network-policies","title":"Network Policies","text":"<ul> <li>Network Policies \u7b97\u662f\u4e00\u7a2e K8s \u7269\u4ef6</li> <li> <p>Network Policies \u6709\u4ee5\u4e0b\u5169\u7a2e traffic</p> <ul> <li>Ingress (\u5165\u53e3): \u9032\u5165 Pod \u7684 traffic</li> <li>Egress (\u51fa\u53e3): \u5f9e Pod \u96e2\u958b\u7684 traffic  </li> </ul> </li> <li> <p>K8s \u9810\u8a2d\u662f\u5141\u8a31\u6240\u6709\u7684 traffic \u9032\u51fa Pod; \u82e5\u60f3\u8981\u9650\u5236 traffic\uff0c\u5247\u9700\u8a2d\u5b9a Network Policies</p> </li> <li> <p>\u70ba\u4e86\u7c21\u5316 K8s \u7684\u6d41\u91cf\u7ba1\u7406\uff0c\u4e00\u65e6\u67d0\u500b Ingress traffic \u88ab\u5141\u8a31\u9032\u5165 Pod\uff0c\u76f8\u95dc\u7684 Egress traffic \u4e5f\u6703\u88ab\u9810\u8a2d\u5141\u8a31\uff0c\u9664\u975e\u6709\u660e\u78ba\u7684 Network Policies \u9650\u5236\u8a72 Egress traffic</p> </li> <li> <p>\u7121\u8ad6\u6211\u5011\u4f7f\u7528\u54ea\u7a2e Networking \u89e3\u6c7a\u65b9\u6848\uff0c\u90fd\u61c9\u8a72\u8981\u9810\u8a2d\u4f7f K8s \u53e2\u96c6\u4e2d\u7684\u5404\u500b Pod \u80fd\u5920\u5f7c\u6b64\u901a\u8a0a</p> <ul> <li>\u76f8\u7576\u65bc\u6240\u6709 Pods \u90fd\u5728\u540c\u4e00\u500b\u865b\u64ec\u79c1\u6709\u7db2\u8def (VPN) \u4e2d\uff0c\u800c\u8a72\u865b\u64ec\u79c1\u6709\u7db2\u8def\u6703\u6a6b\u8de8 K8s \u53e2\u96c6\u4e2d\u7684\u6240\u6709 Nodes </li> </ul> </li> <li> <p>\u5efa\u7acb Network Policies</p> <ul> <li> <p>\u53ef\u4ee5\u4f7f\u7528 label, podSelector, namespaceSelector \u4f86\u6307\u5b9a Network Policies     </p> </li> <li> <p>\u53ef\u4ee5\u8a2d\u5b9a Ingress, Egress traffic \u7684\u898f\u5247</p> <ul> <li>Ingress: \u7528 from \u9663\u5217\u958b\u982d\uff0c\u4f86\u6307\u5b9a traffic \u4f86\u6e90</li> <li>Egress: \u7528 to \u9663\u5217\u958b\u982d\uff0c\u4f86\u6307\u5b9a traffic \u76ee\u7684\u5730 </li> </ul> </li> <li> <p>\u53ef\u4ee5\u8a2d\u5b9a ipBlock \u4f86\u9650\u5236\u5916\u90e8\u670d\u52d9\u7684 IP address \u5b58\u53d6\u6b0a\u9650</p> <ul> <li>\u56e0\u70ba\u5916\u90e8\u670d\u52d9\u4e0d\u5728 K8s \u53e2\u96c6\u4e2d\uff0c\u56e0\u6b64\u7121\u6cd5\u4f7f\u7528 label, podSelector, namespaceSelector \u4f86\u8a2d\u5b9a Network Policies  </li> </ul> </li> <li> <p>Tips: \u8a2d\u5b9a Ingress, Egress traffic \u898f\u5247\u6642\uff0c\u9700\u6ce8\u610f <code>-</code> \u9663\u5217\u7684\u8868\u793a\u65b9\u5f0f</p> <ul> <li> <p>\u7576\u4e00\u500b <code>-</code> \u9663\u5217\u4e2d\uff0c\u5305\u542b\u591a\u500b\u898f\u5247\u6642\uff0c\u8868\u793a\u9019\u4e9b\u898f\u5247\u662f AND \u95dc\u4fc2\uff0c\u9700\u540c\u6642\u7b26\u5408     </p> </li> <li> <p>\u7576\u591a\u500b <code>-</code> \u9663\u5217\u4e2d\uff0c\u4e26\u5217\u8868\u793a\u898f\u5247\u6642\uff0c\u8868\u793a\u9019\u4e9b\u898f\u5247\u662f OR \u95dc\u4fc2\uff0c\u53ea\u8981\u7b26\u5408\u5176\u4e2d\u4e00\u500b\u5373\u53ef     </p> </li> </ul> </li> </ul> YAML<pre><code># network-policy-definition.yaml\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n    name: db-policy\n\nspec:\n    podSelector:\n        matchLabels:\n        role: db\n\n    # \u8a2d\u5b9a\u8981\u9650\u5236\u7684 traffic \u985e\u578b\n    policyTypes:\n    -   Ingress\n    -   Egress\n\n    # \u8a2d\u5b9a Ingress traffic \u898f\u5247\n    ingress:\n    - from:\n        # \u591a\u500b `-` \u9663\u5217\u4e2d\uff0c\u4e26\u5217\u8868\u793a\u898f\u5247\uff0c\u8868\u793a\u9019\u4e9b\u898f\u5247\u662f OR \u95dc\u4fc2\uff0c\u53ea\u8981\u7b26\u5408\u5176\u4e2d\u4e00\u500b\u5373\u53ef\n        - ipBlock:\n            cidr: 172.17.0.0/16\n            except:\n            - 172.17.1.0/24\n        - namespaceSelector:\n            matchLabels:\n                project: myproject\n        - podSelector:\n            matchLabels:\n                role: frontend\n\n        ports:\n        -   protocol: TCP\n            port: 6379\n    # \u8a2d\u5b9a Egress traffic \u898f\u5247\n    egress:\n    - to:\n        - ipBlock:\n            cidr: 10.0.0.0/24\n\n        ports:\n        -   protocol: TCP\n            port: 5978\n</code></pre> Bash<pre><code>kubectl create -f network-policy-definition.yaml\n</code></pre> </li> <li> <p>\u5be6\u52d9\u4e0a\uff0c\u6211\u5011\u53ef\u80fd\u6703\u9700\u8981\u983b\u7e41\u5730\u5207\u63db cluster, namespace\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 kubectx, kubens \u5de5\u5177\u4f86\u8f14\u52a9\u6211\u5011\u9054\u6210\u76ee\u6a19</p> <ul> <li>kubectx: \u8f14\u52a9\u5feb\u901f\u5730\u5207\u63db K8s cluster</li> <li>kubens: \u8f14\u52a9\u5feb\u901f\u5730\u5207\u63db K8s namespace</li> <li>\u53c3\u8003\u9023\u7d50: GitHub: kubectx + kubens: Power tools for kubectl</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#storage","title":"Storage","text":""},{"location":"cloud/k8s/cka/#introduction-of-docker-storage","title":"Introduction of Docker Storage","text":"<ul> <li>Docker Storage Driver \u8ca0\u8cac\u7ba1\u7406 container \u6a94\u6848\u7cfb\u7d71\uff0c\u53ef\u6c7a\u5b9a container \u5982\u4f55\u5132\u5b58\u3001\u8b80\u53d6\u8cc7\u6599\uff0c\u4ee5\u4e0b\u662f\u5169\u7a2e\u4e3b\u8981\u7684\u985e\u578b<ul> <li>Storage Driver: \u7528\u65bc\u7ba1\u7406 container \u7684 storage<ul> <li>e.g. Overlay2\uff08\u76ee\u524d Docker \u9810\u8a2d\u4f7f\u7528\uff09, AUFS, Btrfs, ZFS, DeviceMapper</li> </ul> </li> <li>Volume Driver: \u7528\u65bc\u7ba1\u7406 container \u7684 volume<ul> <li>e.g. local\uff08\u9810\u8a2d\u7684 Volume Driver\uff09, nfs, glusterfs, flocker, rexray</li> <li>e.g. (\u7b2c\u4e09\u65b9): Azure file storage, DigitalOcean, Google Compute Persistent Disks, VMware vSphere storage</li> </ul> </li> </ul> </li> <li> <p>\u7576\u5b89\u88dd Docker \u5f8c\uff0c\u5b83\u6703\u81ea\u52d5\u5efa\u7acb\u4ee5\u4e0b\u7684\u76ee\u9304\u7d50\u69cb</p> <ul> <li><code>/var/lib/docker/</code>: \u662f Docker container \u9810\u8a2d\u5132\u5b58\u8cc7\u6599\u7684\u5730\u65b9<ul> <li><code>aufs</code>: \u5132\u5b58 AUFS storage driver \u7684\u8cc7\u6599</li> <li><code>containers</code>: \u5132\u5b58 container \u7684\u8cc7\u6599</li> <li><code>image</code>: \u5132\u5b58 container image \u7684\u8cc7\u6599</li> <li><code>volumes</code>: \u5132\u5b58 container volume \u7684\u8cc7\u6599</li> </ul> </li> </ul> <p></p> </li> <li> <p>Docker image \u7684\u5206\u5c64\u67b6\u69cb</p> <ul> <li>Dockerfile \u7684\u6bcf\u4e00\u884c\u90fd\u6703\u5728 Docker image \u4e2d\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u5c64 (layer)</li> <li>Docker image \u662f\u7531\u591a\u500b\u5206\u5c64\u7d44\u6210\uff0c\u6bcf\u4e00\u5c64\u90fd\u662f\u552f\u8b80\u7684</li> <li> <p>\u6bcf\u4e00\u5c64\u90fd\u6703\u57fa\u65bc\u524d\u4e00\u5c64\u7684\u57fa\u790e\u4e0a\u9032\u884c\u4fee\u6539\uff0c\u56e0\u6b64\u9019\u4e5f\u6703\u53cd\u6620\u5728 image layer \u7684\u6a94\u6848\u5927\u5c0f\u4e0a </p> </li> <li> <p>Docker \u5efa\u7acb image \u6642\uff0c\u6703\u91cd\u8907\u4f7f\u7528\u5feb\u53d6\u4e2d\u7684 image layer\uff0c\u4ee5\u52a0\u901f image \u7684\u5efa\u7acb\uff0c\u540c\u6642\u4e5f\u80fd\u7bc0\u7701\u786c\u789f\u4f7f\u7528\u7a7a\u9593</p> <ul> <li>e.g. \u4ee5\u4e0b\u5716\u70ba\u4f8b\uff0c\u5169\u500b Dockerfile \u5167\u5bb9\u91cd\u8907\u7684\u90e8\u5206 (Layer 1 ~ Layer 3)\uff0cDocker \u6703\u5f9e\u5feb\u53d6\u4e2d\u91cd\u8907\u4f7f\u7528\u5df2\u7d93\u5efa\u7acb\u904e\u7684 image layer </li> </ul> </li> </ul> </li> <li> <p>\u8aaa\u660e Docker \u900f\u904e image\uff0c\u5efa\u7acb\u3001\u57f7\u884c\u3001\u522a\u9664 container \u7684\u904e\u7a0b</p> <ul> <li> <p>Step 1: \u5efa\u7acb\u552f\u8b80\u7684(read-only) image layer Bash<pre><code>docker build Dockerfile -t &lt;myimage&gt;\n</code></pre></p> <p></p> </li> <li> <p>Step 2: \u57f7\u884c image \u6642\uff0c\u5efa\u7acb\u4e00\u500b\u53ef\u5beb\u7684(writeable) container layer\uff0c\u7528\u4f86\u5132\u5b58 container \u7522\u751f\u7684\u8cc7\u6599\uff0c\u4f8b\u5982: \u61c9\u7528\u7a0b\u5f0f\u7522\u751f\u7684 log \u8cc7\u6599\uff0c\u6216\u662f container \u7522\u751f\u7684 temp \u8cc7\u6599     Bash<pre><code>docker run &lt;myimage&gt;\n</code></pre></p> <p></p> <ul> <li>copy-on-write \u6a5f\u5236: \u82e5\u6211\u5011\u60f3\u8981\u7de8\u8f2f image layer \u7684\u7a0b\u5f0f\u78bc\uff0cDocker \u6703\u5e6b\u6211\u5011\u5728 container layer \u5efa\u7acb\u4e00\u500b\u526f\u672c\uff0c\u8b93\u6211\u5011\u53ef\u4ee5\u9032\u884c\u7de8\u8f2f (e.g. app.py)     </li> </ul> </li> <li> <p>Step 3: \u7576 container \u88ab\u522a\u9664\u6642\uff0ccontainer layer \u6240\u5132\u5b58\u7684\u8cc7\u6599\u4e5f\u6703\u88ab\u4e00\u4f75\u522a\u9664</p> <ul> <li>\u6ce8\u610f! \u82e5\u591a\u500b container \u4f7f\u7528\u76f8\u540c\u7684 image\uff0c\u5247\u9019\u4e9b container layer \u6703\u5171\u4eab\u76f8\u540c\u7684 image layer</li> </ul> Bash<pre><code>docker rm &lt;mycontainer&gt;\n</code></pre> </li> </ul> </li> <li> <p>Docker \u5efa\u7acb\u6c38\u4e45\u5132\u5b58\u8cc7\u6599\u7684 container</p> <ul> <li> <p>\u6cd5\u4e00 (Volume mounting): \u7531 Docker \u81ea\u884c\u7ba1\u7406\u7684\u639b\u8f09\u9ede</p> <ul> <li> <p>Step 1: \u5efa\u7acb Volume \u5728 <code>/var/lib/docker/volumes/</code> \u8cc7\u6599\u593e\u4e2d     Bash<pre><code>docker volume create &lt;data_volume&gt;\n</code></pre></p> </li> <li> <p>Step 2: \u5c07 Volume \u639b\u8f09\u5230 container \u4e2d\u3002\u9019\u6a23\uff0c\u7576 container \u88ab\u522a\u9664\u6642\uff0cVolume \u4e2d\u7684\u8cc7\u6599\u53ef\u7e7c\u7e8c\u4fdd\u7559</p> <ul> <li>\u8a3b: <code>/var/lib/mysql</code> \u662f MySQL container \u9810\u8a2d\u5132\u5b58\u8cc7\u6599\u7684\u5730\u65b9</li> </ul> Bash<pre><code>docker run -v &lt;data_volume&gt;:/var/lib/mysql mysql\n</code></pre> </li> <li> <p>\u53ef\u6aa2\u8996\u7576\u524d\u6240\u6709\u7684 Volume     Bash<pre><code>docker volume ls\n</code></pre></p> </li> </ul> </li> <li> <p>\u6cd5\u4e8c (Bind mounting): \u76f4\u63a5\u5c07\u5bbf\u4e3b\u6a5f\u7684\u5132\u5b58\u7a7a\u9593\u639b\u8f09\u5230 container \u4e0a\uff0c\u53ef\u6307\u5b9a\u5bbf\u4e3b\u6a5f\u7684\u5132\u5b58\u7a7a\u9593\u7684\u5b8c\u6574\u8def\u5f91</p> <ul> <li> <p>Step 1: \u5efa\u7acb\u5916\u90e8\u8cc7\u6599\u5132\u5b58\u4f4d\u7f6e     Bash<pre><code>mkdir -p /data/mysql\n</code></pre></p> </li> <li> <p>Step 2: \u5c07\u5916\u90e8\u8cc7\u6599\u5132\u5b58\u4f4d\u7f6e\u639b\u8f09\u5230 container \u4e2d     Bash<pre><code>docker run --mount type=bind,source=/data/mysql,target=/var/lib/mysql mysql\n</code></pre></p> </li> </ul> <p></p> </li> </ul> </li> <li> <p>Storage Driver \u529f\u80fd</p> <ul> <li>\u7dad\u8b77 container image \u7684\u5206\u5c64\u67b6\u69cb</li> <li>\u5efa\u7acb\u53ef\u8b80\u5beb\u7684 container layer</li> <li>\u652f\u63f4 copy-on-write \u6a5f\u5236</li> </ul> </li> <li> <p>\u5e38\u898b\u7684 Storage Driver \u985e\u578b: AUFS, ZFS, BTRFS, Device Mapper, Overlay, Overlay2</p> <ul> <li>Docker \u6703\u6839\u64da\u7576\u524d container \u6240\u5728\u7684\u5e95\u5c64\u4f5c\u696d\u7cfb\u7d71(O.S.)\uff0c\u81ea\u52d5\u5730\u9078\u51fa\u6700\u9069\u5408\u7684 Storage Driver \u4f86\u4f7f\u7528</li> </ul> </li> <li> <p>\u7576 Docker \u904b\u884c container \u6642\uff0c\u53ef\u4ee5\u6307\u5b9a\u8981\u4f7f\u7528\u7684 Volume driver\uff0c\u9019\u6a23\u6703\u5efa\u7acb\u4e00\u500b container \u4e26\u639b\u8f09\u6307\u5b9a\u7684 AWS EBS volume     Bash<pre><code>docker run -it --name mysql --volume-driver rexray/ebs --mount src=ebs-vol,target=/var/lib/mysql mysql\n</code></pre></p> <p></p> </li> <li> <p>Container Interface: \u7528\u4f86\u5b9a\u7fa9 Orchestration \u7cfb\u7d71\u8207 container \u4e4b\u9593\u7684\u6e9d\u901a\u65b9\u5f0f</p> <ul> <li>orchestration \u7cfb\u7d71: \u7528\u4f86\u7ba1\u7406 container \u7684\u7cfb\u7d71\uff0c\u4f8b\u5982: Kubernetes, Docker Swarm, Mesos</li> <li>container runtime: \u7528\u4f86\u57f7\u884c container \u7684\u7cfb\u7d71\uff0c\u4f8b\u5982: Docker, containerd, CRI-O, rkt</li> <li>CRI (Container Runtime Interface)</li> <li>CNI (Container Network Interface)</li> <li>CSI (Container Storage Interface): \u5b9a\u7fa9\u4e86\u4e00\u7d44 RPC \u4f9b Orchestration \u7cfb\u7d71\u4f86\u547c\u53eb\uff0c\u4e26\u4e14\u9019\u4e9b RPC \u5fc5\u9808\u7531 storage driver \u5be6\u4f5c </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#volume","title":"Volume","text":"<ul> <li>\u5728 K8s \u7684\u4e16\u754c\u4e2d\uff0cPod \u7684\u751f\u547d\u9031\u671f\u7e3d\u662f\u77ed\u66ab\u7684\u3002\u56e0\u6b64\uff0c\u6211\u5011\u53ef\u4ee5\u5efa\u7acb Volume \u4f86\u5132\u5b58 Pod \u7684\u8cc7\u6599\uff0c\u4ee5\u4fbf\u5728 Pod \u88ab\u522a\u9664\u5f8c\uff0c\u8cc7\u6599\u4ecd\u7136\u53ef\u4ee5\u88ab\u4fdd\u7559</li> <li> <p>\u6211\u5011\u53ef\u4ee5\u5728 Pod \u7684 YAML manifest \u8a2d\u5b9a\u6a94\u4e2d\uff0c\u6307\u5b9a Volume \u8def\u5f91\u4f4d\u7f6e     YAML<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n    name: random-number-generator\n\nspec:\n    containers:\n    -   name: alpine\n        image: alpine\n        command: [\"/bin/sh\", \"-c\"]\n        args: [\"shuf -i 0-100 -n 1 &gt;&gt; /opt/number.out\"]\n        # \u5b9a\u7fa9 container \u639b\u8f09\u9ede\n        volumeMounts:\n        -   mountPath: /opt\n            name: data-volume\n\n    # \u5b9a\u7fa9 Pod \u6240\u4f7f\u7528\u7684 Volume\n    volumes:\n    -   name: data-volume\n        hostPath:\n            path: /data\n            type: Directory\n</code></pre></p> </li> <li> <p>\u8209\u4f8b\u4f86\u8aaa\uff0c\u6211\u5011\u5efa\u7acb\u4e00\u500b\u53ef\u4ee5\u7522\u751f\u96a8\u6a5f\u6578\u5b57\u7684 Pod\uff0c\u4e26\u5c07 Volume \u639b\u8f09\u5230 container \u5167\u7684 <code>/opt</code> \u8def\u5f91\u4e0a\u3002\u4e4b\u5f8c\uff0c\u7576 container \u904b\u884c\u6642\uff0c\u6240\u7522\u751f\u7684\u96a8\u6a5f\u6578\u5b57\u6703\u88ab\u5beb\u5165 Volume \u4e2d\uff0c\u800c\u5be6\u969b\u662f\u5132\u5b58\u5230\u5bbf\u4e3b\u6a5f\u7684 <code>/data</code> \u8cc7\u6599\u593e\u4e2d</p> <ul> <li>\u9019\u6a23\uff0c\u7576 Pod \u88ab\u522a\u9664\u6642\uff0cVolume \u4e2d\u7684\u8cc7\u6599\u4ecd\u7136\u53ef\u4ee5\u88ab\u4fdd\u7559 </li> </ul> </li> <li> <p>Volume \u7684 Storage option: \u56e0\u70ba Volume \u7684 hostPath \u662f\u4ee3\u8868\u5bbf\u4e3b\u6a5f\u7684\u8def\u5f91\uff0c\u56e0\u6b64\u4e0d\u9069\u7528\u65bc multi-node cluster\uff0c\u9019\u6642\u6211\u5011\u5c31\u8981\u4f7f\u7528\u5916\u90e8\u7684 Storage \u4f86\u89e3\u6c7a\u9019\u500b\u554f\u984c</p> <ul> <li>e.g. NFS, GlusterFS, CephFS</li> <li>e.g. (\u4e09\u5927\u516c\u6709\u96f2) AWS EBS, Azure Disk, Google's Persistent Disk </li> </ul> YAML<pre><code># volume-storage-option.yaml\n# ...\u7565\nvolumes:\n-   name: data-volume\n    awsElasticBlockStore:\n        volumeID: &lt;volume-id&gt;\n        fsType: ext4\n</code></pre> </li> </ul>"},{"location":"cloud/k8s/cka/#persistent-volume","title":"Persistent Volume","text":"<ul> <li>Persistent Volume (PV): \u662f K8s \u53e2\u96c6\u4e2d\u7684\u4e00\u500b\u7269\u4ef6\uff0c\u7528\u4f86\u63d0\u4f9b\u5b58 cluster \u7d1a\u5225\u7684\u5132\u5b58\u7a7a\u9593\u516c\u6c60<ul> <li>\u4f7f\u7528\u8005\u53ef\u900f\u904e Persistent Volume Claim (PVC) \u4f86\u5b58\u53d6 PV</li> <li>PV \u53ef\u6709\u6548\u964d\u4f4e\u4f7f\u7528\u8005\u5728\u6bcf\u6b21\u5efa\u7acb Pod \u6642\uff0c\u9700\u8981\u624b\u52d5\u6307\u5b9a Volume \u7684\u8ca0\u64d4</li> </ul> </li> <li> <p>\u5efa\u7acb Persistent Volume     YAML<pre><code># pv-definition.yaml\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n    name: pv-vol1\n\nspec:\n    accessModes: [ \"ReadWriteOnce\" ]\n    capacity:\n        storage: 1Gi\n    hostPath:\n        path: /tmp/data\n</code></pre></p> Bash<pre><code>kubectl create -f pv-definition.yaml\n</code></pre> </li> <li> <p>\u6aa2\u8996 Persistent Volume     Bash<pre><code>kubectl get pv\n</code></pre></p> </li> <li> <p>\u522a\u9664 Persistent Volume     Bash<pre><code>kubectl delete pv pv-vol1\n</code></pre></p> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#persistent-volume-claim","title":"Persistent Volume Claim","text":"<ul> <li>Persistent Volume Claim (PVC): \u662f K8s \u53e2\u96c6\u4e2d\u7684\u4e00\u500b\u7269\u4ef6\uff0c\u7528\u4f86\u5b58\u53d6 Persistent Volume (PV)</li> <li> <p>\u4e00\u65e6\u5efa\u7acb PVC\uff0cK8s \u6703\u81ea\u52d5\u6839\u64da PVC \u7684\u9700\u6c42\u548c\u5c6c\u6027\uff0c\u5c07 PV \u7d81\u5b9a\u5230 PVC \u4e0a; \u82e5 PVC \u7684\u8a2d\u5b9a\u8981\u6c42\u7121\u6cd5\u8207\u4efb\u4f55 PV \u5339\u914d\uff0c\u5247 PVC \u6703\u4fdd\u6301\u5728 Pending \u72c0\u614b     </p> </li> <li> <p>\u5ba3\u544a PVC, PV \u7684 YAML manifest \u8a2d\u5b9a\u6a94     YAML<pre><code># pv-definition.yaml\nkind: PersistentVolume\napiVersion: v1\nmetadata:\n    name: pv-vol1\n\nspec:\n    accessModes: [ \"ReadWriteOnce\" ]\n    capacity:\n        storage: 1Gi\n    hostPath:\n        path: /tmp/data\n</code></pre></p> YAML<pre><code># pvc-definition.yaml\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n    name: myclaim\n\nspec:\n    accessModes: [ \"ReadWriteOnce\" ]\n    resources:\n        requests:\n            storage: 1Gi\n</code></pre> </li> <li> <p>\u5efa\u7acb\u4e26\u6aa2\u8996 PV     Bash<pre><code>kubectl create -f pv-definition.yaml\n</code></pre></p> Bash<pre><code>kubectl get pv\n</code></pre> <p></p> </li> <li> <p>\u5efa\u7acb\u4e26\u6aa2\u8996 PVC     Bash<pre><code>kubectl create -f pvc-definition.yaml\n</code></pre></p> Bash<pre><code>kubectl get pvc\n</code></pre> <p></p> </li> <li> <p>\u5728 Pod \u7684 YAML manifest \u8a2d\u5b9a\u6a94\u4e2d\uff0c\u6307\u5b9a PVC \u7684\u540d\u7a31     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: mypod\n\nspec:\n    containers:\n    -   name: myfrontend\n        image: nginx\n        volumeMounts:\n        -   mountPath: \"/var/www/html\"\n            name: mypd\n    volumes:\n    -   name: mypd\n        persistentVolumeClaim:\n            claimName: myclaim\n</code></pre></p> </li> <li> <p>\u522a\u9664 PVC     Bash<pre><code>kubectl delete pvc myclaim\n</code></pre></p> </li> <li> <p>\u522a\u9664 PV     Bash<pre><code>kubectl delete pv pv-vol1\n</code></pre></p> </li> <li> <p>PV, PVC, Pod \u4e4b\u9593\u7684\u95dc\u4fc2\u5716     </p> </li> </ul>"},{"location":"cloud/k8s/cka/#storage-class","title":"Storage Class","text":"<ul> <li>Storage Class: \u662f K8s \u53e2\u96c6\u4e2d\u7684\u4e00\u500b\u7269\u4ef6\uff0c\u7528\u4f86\u5b9a\u7fa9 Persistent Volume (PV) \u7684\u5c6c\u6027<ul> <li>Storage Class \u53ef\u4ee5\u5b9a\u7fa9 PV \u7684\u5c6c\u6027\uff0c\u4f8b\u5982: \u5132\u5b58\u985e\u578b\u3001\u5132\u5b58\u5927\u5c0f\u3001\u5132\u5b58\u4f4d\u7f6e\u7b49</li> </ul> </li> <li> <p>Static Provisioning: \u662f\u6307\u5728\u5efa\u7acb PV \u6642\uff0c\u76f4\u63a5\u6307\u5b9a PV \u7684\u5c6c\u6027</p> <ul> <li>\u9700\u5728\u5efa\u7acb PV \u6642\uff0c\u90fd\u8981\u624b\u52d5\u6307\u5b9a PV \u7684\u5c6c\u6027 =&gt; \u8f03\u9ebb\u7169 </li> </ul> </li> <li> <p>Dynamic Provisioning: \u662f\u6307\u5728\u5efa\u7acb PVC \u6642\uff0cK8s \u6703\u81ea\u52d5\u6839\u64da PVC \u7684\u9700\u6c42\u3001\u5c6c\u6027\uff0c\u4f86\u5efa\u7acb PV</p> <ul> <li>\u7576\u6211\u5011\u5efa\u7acb Storage Class \u7269\u4ef6\u5f8c\uff0cPV \u6703\u81ea\u52d5\u5efa\u7acb\uff0c\u6211\u5011\u5c31\u4e0d\u518d\u9700\u8981\u5b9a\u7fa9 PV =&gt; \u8f03\u65b9\u4fbf </li> </ul> </li> <li> <p>\u5efa\u7acb Storage Class     YAML<pre><code># sc-definition.yaml\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n    name: google-storage\n\n# Storage Class \u7684 Dynamic Provisioning \u8a2d\u5b9a\nprovisioner: kubernetes.io/gce-pd\n</code></pre></p> Bash<pre><code>kubectl create -f sc-definition.yaml\n</code></pre> </li> <li> <p>\u6aa2\u8996 Storage Class     Bash<pre><code>kubectl get sc\n</code></pre></p> <p></p> </li> <li> <p>\u5efa\u7acb Persistent Volume Claim (PVC) \u6642\uff0c\u6307\u5b9a Storage Class     YAML<pre><code># pvc-definition.yaml\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n    name: myclaim\n\nspec:\n    accessModes: [ \"ReadWriteOnce\" ]\n    # \u6307\u5b9a\u8981\u4f7f\u7528\u7684 Storage Class \u7269\u4ef6\n    storageClassName: google-storage       \n    resources:\n        requests:\n            storage: 500Mi\n</code></pre></p> Bash<pre><code>kubectl create -f pvc-definition.yaml\n</code></pre> </li> <li> <p>\u5efa\u7acb Pod     YAML<pre><code># pod-definition.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n    name: mypod\n\nspec:\n    containers:\n    -   name: frontend\n        image: nginx\n        volumeMounts:\n        -   mountPath: \"/var/www/html\"\n            name: web\n\n    volumes:\n    -   name: web\n        # \u6307\u5b9a\u8981\u4f7f\u7528\u7684 PVC\n        persistentVolumeClaim:\n            claimName: myclaim\n</code></pre></p> Bash<pre><code>kubectl create -f pod-definition.yaml\n</code></pre> </li> <li> <p>Storage Class \u7684 Provisioner \u9078\u9805</p> <ul> <li>e.g. Portworx, ScaleIO, CephFS</li> <li> <p>e.g. (\u516c\u6709\u96f2) AWS EBS, Azure File, Azure Disk, GCP Persistent Disk     </p> </li> <li> <p>\u800c\u4e4b\u6240\u4ee5\u7a31\u70ba Storage Class\uff0c\u662f\u56e0\u70ba\u5b83\u53ef\u4ee5\u5b9a\u7fa9\u591a\u500b\u4e0d\u540c\u7684 Storage Class\uff0c\u4ee5\u4fbf\u6eff\u8db3\u4e0d\u540c\u7684\u9700\u6c42 </p> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#networking","title":"Networking","text":""},{"location":"cloud/k8s/cka/#networling-prerequisite","title":"Networling Prerequisite","text":"<ul> <li> <p>Switching</p> <ul> <li>\u7528\u9014: \u9023\u63a5\u5340\u57df\u7db2\u8def\uff08LAN\uff09\u4e2d\u7684\u88dd\u7f6e<ul> <li>\u5169\u53f0\u8a2d\u5099\u900f\u904e\u7db2\u8def\u4ecb\u9762\uff08interface\uff09\uff0c\u9023\u63a5\u5230\u4ea4\u63db\u6a5f\uff08switch\uff09</li> </ul> </li> <li> <p>\u6aa2\u8996\u7576\u524d\u4e3b\u6a5f\u7684\u7db2\u8def\u4ecb\u9762</p> <ul> <li>eth0: \u7528\u4f86\u9023\u63a5\u5230\u4ea4\u63db\u6a5f\u4e0a\u7684\u7db2\u8def\u4ecb\u9762 Bash<pre><code>ip link\n</code></pre></li> </ul> </li> <li> <p>\u6aa2\u8996\u7576\u524d\u4e3b\u6a5f\u7684 IP address Bash<pre><code>ip addr\n</code></pre></p> </li> <li> <p>\u65b0\u589e eth0 \u7db2\u8def\u4ecb\u9762\u7684 IP address Bash<pre><code>ip addr add 192.168.1.10/24 dev eth0\n</code></pre></p> Bash<pre><code>ip addr add 192.168.1.11/24 dev eth0\n</code></pre> </li> </ul> <p></p> </li> <li> <p>Routing</p> <ul> <li>\u7528\u9014: \u9023\u63a5\u5169\u500b\u7db2\u8def\uff0c\u6703\u5206\u914d\u7d66\u6bcf\u500b\u7db2\u8def\u4e00\u500b IP address\uff0c\u6839\u64da\u8def\u7531\u8868\uff08IP table\uff09\u5c07\u5c01\u5305\u8f49\u767c\u7d66\u4e0b\u4e00\u500b\u76ee\u7684\u5730</li> <li> <p>\u6aa2\u8996\u7576\u524d\u7684\u8def\u7531\u8868     Bash<pre><code>ip route show\n</code></pre></p> </li> <li> <p>\u65b0\u589e IP address \u5230\u8def\u7531\u8868      Bash<pre><code>ip route add 192.168.1.0/24 via 192.168.2.1\n</code></pre></p> </li> <li> <p>\u8a2d\u5b9a\u9810\u8a2d\u8def\u7531\u5668\u7684 IP address     Bash<pre><code>ip route add default via 192.168.2.1\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>Gateway</p> <ul> <li>\u7528\u9014: \u5c07\u5340\u57df\u7db2\u8def\u9023\u5411\u5916\u90e8\u7db2\u969b\u7db2\u8def\uff08Internet\uff09\u7684\u901a\u9053</li> </ul> </li> <li> <p>DNS</p> <ul> <li>\u7528\u9014: \u5c07 IP address \u8f49\u63db\u6210 domain name</li> <li> <p>\u6aa2\u8996\u975c\u614b DNS \u8a2d\u5b9a\uff08\u82e5\u9019\u908a\u5df2\u67e5\u8a62\u5230\u76f8\u5c0d\u61c9\u7684 IP address &lt;-&gt; domain name\uff0c\u5c31\u4e0d\u6703\u5230 DNS \u4f3a\u670d\u5668\u67e5\u8a62\u4e86\uff09     Bash<pre><code>cat /etc/hosts\n</code></pre></p> <p></p> </li> <li> <p>\u6aa2\u8996\u7576\u524d\u7cfb\u7d71\u6240\u4f7f\u7528\u7684 DNS \u4f3a\u670d\u5668\uff08\u53ef\u5f97\u77e5\u7576\u524d\u7cfb\u7d71\u662f\u5728\u54ea\u88e1\u67e5\u8a62 domain name\uff09     Bash<pre><code>cat /etc/resolv.conf\n</code></pre></p> <p></p> </li> <li> <p>\u6aa2\u8996\u7576\u524d\u9810\u8a2d\u7684 DNS \u89e3\u6790\u9806\u5e8f     Bash<pre><code>cat /etc/nsswitch.conf\n</code></pre></p> <p></p> </li> <li> <p>\u5728\u5c0f\u578b\u7cfb\u7d71\u4e2d\uff0c\u6211\u5011\u6216\u8a31\u53ef\u4ee5\u624b\u52d5\u8a2d\u5b9a\u6bcf\u500b\u4e3b\u6a5f\u7684 /etc/hosts \u6587\u4ef6; \u4f46\u82e5\u662f\u5728\u5927\u578b\u7cfb\u7d71\u4e2d\uff0c\u9700\u8981\u4e00\u500b\u96c6\u4e2d\u8a2d\u5b9a\u7684\u5730\u65b9 =&gt; DNS \u4f3a\u670d\u5668      </p> </li> <li> <p>\u57df\u540d (Domain name)     </p> <ul> <li> <p>Top Level Domain (TLD): \u4f8b\u5982: <code>.com</code>, <code>.org</code>, <code>.net</code> </p> </li> <li> <p>\u57df\u540d\u968e\u5c64\u95dc\u4fc2     </p> </li> <li> <p>\u57df\u540d\u89e3\u6790\u6d41\u7a0b     </p> </li> </ul> </li> <li> <p>DNS \u7d00\u9304\u985e\u5225</p> <ul> <li>A: \u5c07 domain name \u89e3\u6790\u6210 IPv4 address</li> <li>AAAA: \u5c07 domain name \u89e3\u6790\u6210 IPv6 address</li> <li>CNAME: \u5c07 domain name \u89e3\u6790\u6210\u53e6\u4e00\u500b domain name </li> </ul> </li> <li> <p>DNS \u5e38\u7528\u6307\u4ee4</p> <ul> <li> <p><code>nslookup</code>: \u67e5\u8a62 DNS \u8a18\u9304</p> <ul> <li>\u6ce8\u610f! \u9019\u500b\u6307\u4ee4\u53ea\u6703\u67e5\u8a62 DNS \u4f3a\u670d\u5668\u4e2d\u7684\u7d00\u9304; \u800c\u4e0d\u6703\u67e5\u770b <code>/etc/hosts</code> \u6a94\u6848\u4e2d\u7684\u975c\u614b DNS \u8a18\u9304 Bash<pre><code>nslookup www.google.com\n</code></pre></li> </ul> <p></p> </li> <li> <p><code>dig</code>: \u8a73\u7d30\u6aa2\u8996 DNS \u8a18\u9304     Bash<pre><code>dig www.google.com\n</code></pre></p> <p></p> </li> </ul> </li> </ul> </li> <li> <p>Networking Namespace</p> <ul> <li> <p>container \u50c5\u80fd\u770b\u5230\u7531\u5b83\u672c\u8eab\u904b\u884c\u7684 process; \u800c\u5e95\u5c64\u4e3b\u6a5f\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684 process     Bash<pre><code>ps aux\n</code></pre></p> <p></p> </li> <li> <p>\u5efa\u7acb Linux \u4e3b\u6a5f\u7684 network namespace     Bash<pre><code>ip netns add red\n</code></pre></p> </li> <li> <p>\u5217\u51fa\u7576\u524d\u6240\u6709\u7684 network namespace     Bash<pre><code>ip netns\n</code></pre></p> <p></p> </li> <li> <p>\u5728\u6307\u5b9a\u7684 network namespace \u4e2d\u57f7\u884c\u6307\u4ee4     Bash<pre><code>ip netns exec red ip link\n</code></pre></p> <p></p> </li> <li> <p>Step 1: \u5efa\u7acb\u865b\u64ec\u4e59\u592a\u7db2\u8def\u9023\u7dda     Bash<pre><code>ip link add veth-red type veth peer name veth-blue\n</code></pre></p> </li> <li> <p>Step 2: \u5c07\u865b\u64ec\u4e59\u592a\u7db2\u8def\u8a2d\u5b9a\u5230\u6307\u5b9a\u7684 network namespace     Bash<pre><code>ip link set veth-red netns red\n</code></pre></p> Bash<pre><code>ip link set veth-blue netns blue\n</code></pre> </li> <li> <p>Step 3: \u5728\u6307\u5b9a\u7684 network namespace \u4e2d\uff0c\u8a2d\u5b9a\u865b\u64ec\u4ee5\u592a\u7db2\u8def\u7684 IP address     Bash<pre><code>ip -n red addr add 192.168.15.1/24 dev veth-red\n</code></pre></p> Bash<pre><code>ip -n blue addr add 192.168.15.2/24 dev veth-blue\n</code></pre> </li> <li> <p>Step 4: \u5728\u6307\u5b9a\u7684 network namespace \u4e2d\uff0c\u555f\u7528\u865b\u64ec\u4e59\u592a\u7db2\u8def\u9023\u7dda     Bash<pre><code>ip -n red link set veth-red up\n</code></pre></p> Bash<pre><code>ip -n blue link set veth-blue up\n</code></pre> <p></p> </li> <li> <p>\u5728\u6307\u5b9a\u7684 network namespace \u4e2d\uff0c\u6e2c\u8a66\u865b\u64ec\u4e59\u592a\u7db2\u8def\u7684\u9023\u7dda     Bash<pre><code>ip netns exec red ping 192.168.15.2\n</code></pre></p> Bash<pre><code>ip netns exec red arp\n</code></pre> Bash<pre><code>ip netns exec blue arp\n</code></pre> <p></p> </li> <li> <p>\u522a\u9664\u865b\u64ec\u4e59\u592a\u7db2\u8def\u9023\u7dda     Bash<pre><code>ip -n red link del veth-red\n</code></pre></p> Bash<pre><code>ip -n red link del veth-blue\n</code></pre> </li> <li> <p>\u5728\u751f\u7522\u74b0\u5883\u4e2d\uff0c\u901a\u5e38\u6211\u5011\u6703\u5efa\u7acb\u4e00\u500b\u865b\u64ec\u7684\u4ea4\u63db\u6a5f\uff0c\u4f86\u9023\u63a5\u4e0d\u540c\u7684 network namespace\uff0c\u800c\u4e0d\u9700\u8981\u624b\u52d5\u4e00\u500b\u500b\u5efa\u7acb veth pair</p> <ul> <li>e.g. Linux Bridge, Open vSwitch </li> </ul> </li> </ul> </li> <li> <p>Docker Networking: Docker \u6709\u4e09\u7a2e\u7db2\u8def\u6a21\u5f0f</p> <ul> <li> <p>None: \u5728 None \u6a21\u5f0f\u4e0b\uff0c\u5bb9\u5668\u53ea\u6709\u4e00\u500b loopback \u4ecb\u9762\uff0c\u7121\u5176\u4ed6\u7db2\u8def\u4ecb\u9762     Bash<pre><code>docker run --network none nginx\n</code></pre></p> <p></p> </li> <li> <p>Host: \u5728 Host \u6a21\u5f0f\u4e0b\uff0c\u5bb9\u5668\u76f4\u63a5\u4f7f\u7528\u5bbf\u4e3b\u6a5f\u7684\u7db2\u8def\u5806\u758a\uff0c\u6c92\u6709\u7368\u7acb\u7684\u7db2\u8def\u547d\u540d\u7a7a\u9593     Bash<pre><code>docker run --network host nginx\n</code></pre></p> <p></p> </li> <li> <p>Bridge: \u9810\u8a2d\u7684\u7db2\u8def\u6a21\u5f0f\uff0c\u6703\u5efa\u7acb\u4e00\u500b Docker \u5167\u90e8\u5c08\u7528\u7db2\u8def\uff0c\u7528\u65bc\u9023\u63a5 container \u5230 Docker \u5bbf\u4e3b\u6a5f\u7684\u7db2\u8def</p> <ul> <li>\u5bb9\u5668\u4e4b\u9593\u53ef\u4ee5\u900f\u904e IP address \u76f8\u4e92\u901a\u8a0a</li> </ul> Bash<pre><code>docker run --network bridge nginx\n</code></pre> <p></p> </li> <li> <p>\u6aa2\u8996\u7576\u524d\u6240\u6709\u7684 Docker networking     Bash<pre><code>docker network ls\n</code></pre></p> <p></p> </li> <li> <p>\u6aa2\u8996\u7576\u524d Docker container \u7684\u7db2\u8def\u547d\u540d\u7a7a\u9593     Bash<pre><code>ip netns\n</code></pre></p> <p></p> </li> <li> <p>\u958b\u653e Docker container \u7684 port\uff0c\u4f9b\u5916\u90e8\u5b58\u53d6\u4f7f\u7528     Bash<pre><code>docker run -p 8080:80 nginx\n</code></pre></p> <p></p> </li> <li> <p>Docker \u4f7f\u7528 iptables \u7684\u539f\u7406\uff0c\u4f86\u5be6\u73fe traffic \u7684 port-forwarding \u6a5f\u5236     Bash<pre><code>iptables \\\n    -t nat \\\n    -A DOCKER \\\n    -j DNAT \\\n    --dport 8080 \\\n    --to-destination 172.18.0.6:80\n</code></pre></p> <p></p> </li> <li> <p>\u6aa2\u8996 Docker \u7576\u524d\u6240\u6709\u7684 iptables \u898f\u5247     Bash<pre><code>iptables -nvL -t nat\n</code></pre></p> <p></p> </li> </ul> </li> <li> <p>Container Network Interface (CNI)</p> <ul> <li> <p>\u662f\u4e00\u500b\u6a19\u6e96\uff0c\u7528\u4f86\u898f\u7bc4\u5bb9\u5668\u904b\u884c\u6642\u7684\u7db2\u8def\u8a2d\u5b9a      </p> </li> <li> <p>\u7b2c\u4e09\u65b9 Network Plugin \u4f9b\u61c9\u5546</p> <ul> <li>e.g. Weave, Calico, Flannel, Cilium</li> <li>\u4f46\u662f\uff0cDocker \u4f7f\u7528 Container Network Model (CNM) \u4f86\u8655\u7406\u7db2\u8def\u554f\u984c\uff0c\u800c\u4e0d\u662f\u4f7f\u7528 CNI </li> </ul> </li> </ul> </li> <li> <p>K8s \u53e2\u96c6\u5fc5\u9808\u958b\u653e\u54ea\u4e9b ports\uff1f</p> <ul> <li> <p>\u4e00\u822c\u60c5\u6cc1     </p> </li> <li> <p>\u591a\u500b Master Node \u4e4b\u9593\u7684 etcd \u9700\u8981\u4ea4\u63db\u8cc7\u8a0a\uff0c\u53ef\u4ee5\u958b\u653e port 2380 \u4f9b etcd client \u4f7f\u7528     </p> </li> <li> <p>K8s \u5b98\u65b9\u6587\u4ef6\u8981\u6c42\u958b\u653e\u7684 ports     </p> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#pod-networking","title":"Pod Networking","text":"<ul> <li> <p>\u53ef\u4ee5\u4f7f\u7528 K8s \u5b98\u65b9\u63a8\u85a6\u7684\u7b2c\u4e09\u65b9\u63d2\u4ef6\uff08plugin\uff09\uff0c\u4f86\u5be6\u73fe Pod \u7684\u7db2\u8def\u9023\u63a5</p> <ul> <li>\u6bcf\u500b Pod \u90fd\u5fc5\u9808\u64c1\u6709\u4e00\u500b IP address</li> <li>\u5728\u540c\u4e00\u500b Node \u4e2d\u7684\u6240\u6709 Pod \u90fd\u5fc5\u9808\u80fd\u4e92\u76f8\u901a\u8a0a</li> <li>\u5728\u4e0d\u540c Node \u4e2d\u7684 Pod \u4e5f\u5fc5\u9808\u80fd\u4e92\u76f8\u901a\u8a0a\uff0c\u800c\u4e0d\u9700\u8981\u900f\u904e NAT </li> </ul> </li> <li> <p>\u53ef\u4ee5\u5c07\u6240\u6709\u95dc\u65bc\u8a2d\u5b9a Pod \u9023\u7dda\u7684\u6307\u4ee4\uff0c\u5beb\u6210\u4e00\u500b bash script     </p> </li> <li> <p>\u5be6\u52d9\u4e0a\uff0c\u6bd4\u8f03\u597d\u7684\u505a\u6cd5\u662f\u5728\u8a2d\u5b9a\u8def\u7531\u5668\u4f5c\u70ba default Gateway\uff0c\u4f86\u9023\u63a5\u4e0d\u540c\u7684 Node</p> <ul> <li>\u5982\u6b64\uff0c\u6211\u5011\u5c31\u6703\u6709\u4e00\u500b\u865b\u64ec\u7db2\u8def\uff08<code>10.244.0.0/16</code>\uff09\uff0c\u53ef\u4ee5\u4e32\u9023\u6240\u6709\u7684 Node </li> </ul> </li> <li> <p>\u5be6\u52d9\u4e0a\uff0c\u6211\u5011\u9700\u8981\u4e00\u500b\u6a19\u6e96\u3001\u81ea\u52d5\u5316\u7684 K8s networking \u8a2d\u5b9a\u65b9\u5f0f =&gt; \u63a1\u7528 CNI \u6a19\u6e96</p> <ul> <li>\u5206\u6210 ADD, DEL \u5169\u500b\u4e3b\u8981\u90e8\u4efd<ul> <li>ADD: \u5728 k8s networking \u4e2d\uff0c\u65b0\u589e container</li> <li>DEL: \u5f9e k8s networking \u4e2d\uff0c\u79fb\u9664 container</li> </ul> </li> </ul> </li> <li> <p>\u904b\u7528 CNI \u6a19\u6e96\uff0c\u5feb\u901f\u8a2d\u5b9a container \u7684\u7db2\u8def\u9023\u63a5</p> <ul> <li>CNI \u8a2d\u5b9a\u6a94\u7684\u8def\u5f91: <code>/etc/cni/net.d</code></li> <li>CNI \u6307\u4ee4\u6a94\u7684\u8def\u5f91: <code>/opt/cni/bin</code> (e.g. <code>net-script.sh</code>)</li> <li>\u57f7\u884c\u6307\u4ee4: <code>./net-script.sh add &lt;container-name&gt; &lt;namespace&gt;</code> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50: K8s \u5b98\u65b9\u6587\u4ef6: Installing Addons</p> </li> </ul>"},{"location":"cloud/k8s/cka/#cni-in-k8s","title":"CNI in K8s","text":"<ul> <li>\u8a2d\u5b9a CNI<ul> <li>\u5efa\u7acb container runtime: containerd, cri-o</li> <li>\u9078\u64c7 container network plugin: weaveworks, flannel, cilium, VMware NSC<ul> <li>\u8def\u5f91: <code>/opt/cni/bin</code></li> </ul> </li> <li>\u53c3\u8003\u8a2d\u5b9a\u6a94: \u8981\u4f7f\u7528\u54ea\u500b plugin\uff1f \u8a72\u5982\u4f55\u4f7f\u7528 plugin\uff1f<ul> <li>\u8def\u5f91: <code>bridge.conflist</code>, <code>flannel.conflist</code> </li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#cni-weaveworks","title":"CNI-weaveworks","text":"<ul> <li> <p>Weaveworks \u662f\u4e00\u500b CNI plugin\uff0c\u7528\u4f86\u5be6\u73fe K8s \u53e2\u96c6\u7684\u7db2\u8def\u9023\u63a5</p> <ul> <li>\u529f\u80fd: \u63d0\u4f9b\u7db2\u8def\u9023\u63a5\u3001\u7db2\u8def\u5b89\u5168\u3001\u7db2\u8def\u76e3\u63a7\u7b49\u529f\u80fd</li> <li>Weave Net \u5728 K8s \u4e2d\u6703\u4ee5 DaemonSet \u7684\u5f62\u5f0f\u90e8\u7f72\u3002\u56e0\u70ba DaemonSet \u80fd\u78ba\u4fdd\u5728 K8s \u96c6\u7fa4\u4e2d\u7684\u6bcf\u500b\u7bc0\u9ede\u4e0a\u90fd\u6709\u904b\u884c\u4e00\u500b Pod\uff0c\u9019\u5c0d\u65bc\u7db2\u8def\u63d2\u4ef6\u800c\u8a00\u662f\u5fc5\u8981\u7684\u3002\u7db2\u8def\u63d2\u4ef6\u9700\u8981\u5728\u6bcf\u500b\u7bc0\u9ede\u4e0a\u904b\u884c\uff0c\u4ee5\u4fbf\u7ba1\u7406\u8a72\u7bc0\u9ede\u4e0a\u6240\u6709 container \u7684\u7db2\u8def\u8a2d\u5b9a </li> </ul> </li> <li> <p>\u90e8\u7f72 weavework \u63d2\u4ef6     Bash<pre><code>kubectl apply -f \"https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\\n')\"\n</code></pre></p> </li> <li> <p>\u6aa2\u8996\u90e8\u7f72\u597d\u7684 weave net     Bash<pre><code>kubectl get pods \u2013n=kube-system\n</code></pre></p> </li> <li> <p>\u53ef\u900f\u904e log \u4f86\u6aa2\u67e5\u90e8\u7f72 weave net \u6642\u7684\u932f\u8aa4\u8a0a\u606f     Bash<pre><code>kubectl logs weave-net-5gcmb weave \u2013n=kube-system\n</code></pre></p> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#ip-address-management-weaveworks","title":"IP address management-weaveworks","text":"<ul> <li>\u6839\u64da CNI \u6a19\u6e96\u7684\u8981\u6c42\uff0c\u7db2\u8def\u63d2\u4ef6\u5fc5\u9808\u80fd\u7ba1\u7406\u6bcf\u500b container \u7684 IP address      </li> </ul>"},{"location":"cloud/k8s/cka/#dns-in-k8s","title":"DNS in K8s","text":"<ul> <li>Service DNS \u7d00\u9304 (FQDN)</li> <li>Pod DNS \u7d00\u9304 (FQDN)     </li> </ul>"},{"location":"cloud/k8s/cka/#ingress","title":"Ingress","text":"<ul> <li> <p>\u524d\u60c5\u63d0\u8981: \u95dc\u65bc\u5c07\u5916\u90e8\u6d41\u91cf\u5f15\u5c0e\u5230 K8s \u53e2\u96c6\u4e2d\u7684 Pod \u7684\u65b9\u6cd5</p> <ul> <li> <p>\u4f7f\u7528 NodePort Service</p> <ul> <li>\u57df\u540d\u89e3\u6790\uff1a<code>www.my-online-store.com</code> \u88ab\u89e3\u6790\u5230\u4e00\u500b\u7bc0\u9ede\u7684 IP address  <li>NodePort \u670d\u52d9 <code>wear-service</code> \u958b\u653e port 38080</li> <li>\u5916\u90e8\u4f7f\u7528\u8005\u7684\u5b58\u53d6\u6d41\u7a0b: \u4f7f\u7528\u8005\u5b58\u53d6 <code>http://my-online-store.com:38080</code> \u6642\uff0c\u8a72\u8acb\u6c42\u88ab\u8f49\u767c\u5230 NodePort \u670d\u52d9 wear-service\uff0c\u7136\u5f8c\u518d\u8def\u7531\u5230\u5f8c\u7aef\u7684 Pod </li> <li> <p>\u4f7f\u7528\u8ca0\u8f09\u5e73\u8861\uff08Load Balancer\uff09</p> <ul> <li>\u53ef\u900f\u904e\u591a\u500b GCP Load Balancer \u670d\u52d9\uff0c\u5b58\u53d6\u4e0d\u540c\u7684 Service\uff08e.g. <code>wear-service</code>, <code>video-service</code>\uff09 </li> </ul> </li> <li> <p>\u7528\u9014: \u7528\u4f86\u7ba1\u7406\u5916\u90e8\u6d41\u91cf\u9032\u5165 K8s \u53e2\u96c6</p> <ul> <li>\u900f\u904e Ingress Controller \u4f86\u7ba1\u7406\u6d41\u91cf</li> <li>Ingress Controller \u6703\u6839\u64da Ingress \u8cc7\u6e90\u7684\u8a2d\u5b9a\uff0c\u4f86\u5c07\u6d41\u91cf\u5c0e\u5411\u5230\u6307\u5b9a\u7684 Service</li> <li>K8s \u53e2\u96c6\u9810\u8a2d\u4e26\u4e0d\u63d0\u4f9b Ingress Controller\uff0c\u56e0\u6b64\u6211\u5011\u9700\u8981\u81ea\u884c\u90e8\u7f72 Ingress Controller<ul> <li>\u50c5\u9700\u4e00\u6b21\u6027\u8a2d\u5b9a NodePort Service \u6216 Load Balancer\uff0c\u4f7f\u5176\u53ef\u4ee5\u4f9b\u5916\u90e8\u5b58\u53d6 K8s \u53e2\u96c6\u4e2d\u7684 Service \u5373\u53ef  </li> </ul> </li> </ul> </li> <li> <p>Ingress Controller: \u9996\u5148\uff0c\u5fc5\u9808\u5728 K8s \u53e2\u96c6\u4e2d\u90e8\u7f72\u4e00\u500b Ingress Controller \u7528\u4f86\u7ba1\u7406 Ingress Resource \u7684\u63a7\u5236\u5668\uff0c\u5b83\u8ca0\u8cac\u76e3\u807d Ingress Resource \u7684\u8b8a\u66f4\uff0c\u4e26\u6839\u64da Ingress \u898f\u5247\u5c07\u6d41\u91cf\u8def\u7531\u5230\u76f8\u61c9\u7684 Service \u4e0a</p> <ul> <li>\u5e38\u898b\u7684 Ingress Controller: GCP Cloud Load Balancing, Nginx, HAProxy, Traefik, Contour, Istio </li> </ul> </li> <li> <p>Ingress Resource: \u90e8\u7f72\u597d Ingress Controller \u4e4b\u5f8c\uff0c\u9700\u8981\u8a2d\u5b9a Ingress Resource \u4f86\u5b9a\u7fa9\u5177\u9ad4\u7684\u8def\u7531\u898f\u5247\u3002Ingress Resource \u6703\u8a2d\u5b9a\u5982\u4f55\u5c07\u5916\u90e8 HTTP \u548c HTTPS \u8acb\u6c42\u8def\u7531\u5230 K8s \u53e2\u96c6\u5167\u7684 Service \u4e0a     </p> </li> <li> <p>\u5efa\u7acb Ingress Controller \u7684\u6d41\u7a0b</p> <ul> <li> <p>Step 1: \u5efa\u7acb ConfigMap     YAML<pre><code>kind: ConfigMap\napiVersion: v1\nmetadata:\n    name: nginx-configuration\n</code></pre></p> </li> <li> <p>Step 2: \u5efa\u7acb Deployment     YAML<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n    name: ingress-controller\n\nspec:\n    replicas: 1\n    selector:\n        matchLabels:\n            name: nginx-ingress\n    template:\n        metadata:\n            labels:\n                name: nginx-ingress\n        spec:\n            serviceAccountName: ingress-serviceaccount\n            containers:\n                -   name: nginx-ingress-controller\n                    image: quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.21.0\n                    # \u8a2d\u5b9a Nginx Ingress Controller \u7684\u53c3\u6578\n                    args:\n                    -   /nginx-ingress-controller\n                    -   --configmap=$(POD_NAMESPACE)/nginx-configuration\n                env:\n                -   name: POD_NAME\n                    valueFrom:\n                        fieldRef:\n                            fieldPath: metadata.name\n                -   name: POD_NAMESPACE\n                    valueFrom:\n                        fieldRef:\n                            fieldPath: metadata.namespace\n            ports:\n                - name: http\n                    containerPort: 80\n                - name: https\n                    containerPort: 443\n</code></pre></p> </li> <li> <p>Step 3: \u5efa\u7acb Service Account\uff0c\u4ee5\u8a2d\u5b9a\u6b63\u78ba\u7684 Roles, ClusterRoles, RoleBindings \u6b0a\u9650     Bash<pre><code>kubectl create -f ingress-sa.yaml\n</code></pre></p> <p></p> </li> <li> <p>Step 4: \u8a2d\u5b9a Ingress \u7684 NodePort Service\uff0c\u4f9b\u958b\u653e\u5916\u90e8\u5b58\u53d6\u4f7f\u7528     YAML<pre><code># service-Nodeport.yaml\n\napiVersion: v1\nkind: Service\nmetadata:\n    name: ingress\n\nspec:\n    type: NodePort\n    ports:\n    -   port: 80\n        targetPort: 80\n        protocol: TCP\n        name: http\n\n    -   port: 443\n        targetPort: 443\n        protocol: TCP\n        name: https\n\n    selector:\n        name: nginx-ingress\n</code></pre></p> Bash<pre><code>kubectl create -f service-Nodeport.yaml\n</code></pre> Bash<pre><code>kubectl get services\n</code></pre> </li> </ul> </li> <li> <p>\u5efa\u7acb Ingress Resource \u7684\u5169\u7a2e\u7b56\u7565      </p> <ul> <li> <p>\u7b56\u7565 1: 2 Rules and 1 Path each     YAML<pre><code># ingress-wear-watch.yaml\n\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n    name: ingress-wear-watch\n\nspec:\n    # 2 Rules\n    rules:\n    -   host: wear.my-online-store.com\n        http:\n            # 1 Path each\n            paths:\n            -   backend:\n                    serviceName: wear-service\n                    servicePort: 80\n\n    -   host: watch.my-online-store.com\n        http:\n            # 1 Path each\n            paths:\n            -   backend:\n                    serviceName: watch-service\n                    servicePort: 80\n</code></pre></p> <p></p> </li> <li> <p>\u7b56\u7565 2: 1 Rule and 2 Paths     YAML<pre><code># ingress-wear-watch.yaml\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n    name: ingress-wear-watch\n\nspec:\n    # 1 Rule\n    rules:\n    -   http:\n        paths:\n        # 2 Paths\n        -   path: /wear\n            backend:\n                serviceName: wear-service\n                servicePort: 80\n\n        -   path: /watch\n            backend:\n                serviceName: watch-service\n                servicePort: 80\n</code></pre></p> <p> </p> </li> </ul> </li> <li> <p>\u7e3d\u7d50\uff08Ingress \u67b6\u69cb\u5716\uff09     </p> </li>"},{"location":"cloud/k8s/cka/#design-k8s-cluster","title":"Design K8s Cluster","text":"<ul> <li> <p>\u76ee\u6a19</p> <ul> <li>\u5b78\u7fd2/\u6559\u80b2: Minikube, \u55ae\u4e00\u7bc0\u9ede\u7684 K8s \u53e2\u96c6\uff08AWS, GCP, Azure\uff09</li> <li> <p>\u958b\u767c/\u6e2c\u8a66: \u4e00\u500b master node + \u591a\u500b worker node \u7684\u591a\u7bc0\u9ede K8s \u53e2\u96c6\uff08AWS, GCP, Azure\uff09, \u4f7f\u7528 Kubeadm \u5de5\u5177\u4f86\u5feb\u901f\u5efa\u7acb\u53e2\u96c6     </p> </li> <li> <p>\u751f\u7522\u74b0\u5883: \u4f7f\u7528\u4e09\u5927\u516c\u6709\u96f2\u7684 K8s \u4ee3\u7ba1\u670d\u52d9\uff08AWS, GCP, Azure\uff09</p> <ul> <li>Kops for AWS</li> <li>GKE for GCP</li> <li>Azure Kubernetes Service(AKS) for Azure </li> </ul> </li> <li> <p>\u7d71\u6574      </p> </li> </ul> </li> <li> <p>\u67b6\u8a2d K8s \u53e2\u96c6\u524d\u7684\u8003\u91cf</p> <ul> <li>\u90e8\u7f72\u8003\u91cf<ul> <li>\u672c\u5730\u67b6\u8a2d\uff08On premise\uff09</li> <li>\u96f2\u7aef\u4ee3\u7ba1\u670d\u52d9\uff08Cloud\uff09</li> </ul> </li> <li>\u7bc0\u9ede\u8003\u91cf<ul> <li>\u4f7f\u7528\u5be6\u9ad4\u6a5f\u5668 or \u865b\u64ec\u6a5f\u5668\u4f5c\u70ba Node</li> <li>\u6839\u64da\u9700\u6c42\uff0c\u5236\u5b9a K8s \u53e2\u96c6\u7684\u6700\u5c0f\u9700\u6c42\u7bc0\u9ede\u6578\uff08\u542b Master Node, Worker Node\uff09</li> <li>Master Node vs Worker Node \u5206\u5225\u9700\u8981\u5e7e\u500b</li> <li>\u6700\u4f73\u5be6\u8e10: Master Node \u4e0d\u6703\u8ca0\u8cac\u8655\u7406\u5de5\u4f5c\u9700\u6c42\uff08\u96d6\u7136\u7406\u8ad6\u4e0a\u53ef\u4ee5\uff09</li> </ul> </li> <li>\u8cc7\u6e90\u8003\u91cf<ul> <li>\u5132\u5b58\u7a7a\u9593<ul> <li>\u9700\u8981\u9ad8\u6548\u80fd\u7684\u61c9\u7528\u7a0b\u5f0f: SSD Backed Storag</li> <li>\u80fd\u8655\u7406\u9ad8\u4f75\u767c\u9023\u7dda\u7684\u61c9\u7528\u7a0b\u5f0f: Network based storage</li> <li>\u80fd\u8b93\u591a\u500b Pods \u5171\u4eab\u5b58\u53d6\u7684\u6301\u4e45\u6027\u5132\u5b58\u7a7a\u9593: Persistent shared volumes</li> <li>\u900f\u904e label\uff0c\u5c07\u6307\u5b9a\u7684\u61c9\u7528\u7a0b\u5f0f\uff0c\u5206\u914d\u5230\u6307\u5b9a\u7684\u786c\u789f\u985e\u578b\u7684\u7bc0\u9ede\u4e0a</li> <li>\u900f\u904e Node Selectors \u4f86\u6307\u5b9a\u61c9\u7528\u7a0b\u5f0f\uff0c\u4f48\u7f72\u5230\u6307\u5b9a\u7684\u786c\u789f\u985e\u578b\u7684\u7bc0\u9ede\u4e0a</li> </ul> </li> </ul> </li> <li>\u7db2\u8def\u8003\u91cf<ul> <li>K8s networking addons: Weave Net, Flannel ...\u7b49</li> </ul> </li> </ul> </li> <li> <p>\u67b6\u8a2d K8s \u53e2\u96c6</p> <ul> <li> <p>kube-apiserver: \u8a2d\u8a08 active-active \u6a21\u5f0f\uff0c\u662f\u70ba\u4e86\u78ba\u4fdd Master Node \u8207 Worker Node \u80fd\u6301\u7e8c\u4ea4\u6d41\uff0c\u4ee5\u907f\u514d\u55ae\u9ede\u6545\u969c     </p> </li> <li> <p>kube-controller-manager, kube-scheduler: \u8a2d\u8a08 active-standby \u6a21\u5f0f\uff0c\u662f\u70ba\u4e86\u78ba\u4fdd K8s \u53e2\u96c6\u72c0\u614b\u7684\u4e00\u81f4\u6027\uff0c\u4ee5\u907f\u514d Master Node \u4e4b\u9593\u7684\u7af6\u722d     </p> </li> <li> <p>etcd: \u53ef\u9078\u64c7\u63a1\u7528 Stacked \u6216 External etcd \u62d3\u6a38\u67b6\u69cb</p> <ul> <li> <p>Stacked \u62d3\u6a38\u67b6\u69cb: \u8f03\u5bb9\u6613\u8a2d\u5b9a\uff0c\u4f46\u662f\u6c92\u6709 HA \u6a5f\u5236     </p> </li> <li> <p>External etcd \u62d3\u6a38\u67b6\u69cb: \u8f03\u8907\u96dc\u8a2d\u5b9a\uff0c\u4f46\u662f\u6709 HA \u6a5f\u5236     </p> <ul> <li>kube-apiserver \u9700\u8981\u8a2d\u5b9a\u9023\u7dda\u5230\u54ea\u500b etcd \u4f3a\u670d\u5668     </li> </ul> </li> </ul> </li> </ul> </li> <li> <p>etcd \u4f3a\u670d\u5668\u6703\u63a1\u7528 RAFT \u5171\u8b58\u6f14\u7b97\u6cd5\uff0c\u5b9a\u671f\u9078\u51fa Leader Node\uff0c\u4f86\u8ca0\u8cac\u5beb\u5165\u8cc7\u6599; \u800c\u5176\u5b83 Follower Node \u5247\u8ca0\u8cac\u8b80\u53d6\u8cc7\u6599</p> <ul> <li> <p>RAFT \u5171\u8b58\u6f14\u7b97\u6cd5: \u6240\u6709\u7bc0\u9ede\u540c\u6642\u555f\u52d5\u96a8\u6a5f\u8a08\u6642\u5668\uff0c\u7531\u7b2c\u4e00\u500b\u5b8c\u6210\u7684\u7bc0\u9ede\u5411\u5176\u5b83\u7bc0\u9ede\u767c\u51fa\u8acb\u6c42\uff0c\u64d4\u4efb Leader Node\u3002\u7576\u7372\u5f97\u591a\u6578\uff08majority\uff09\u7684\u5176\u4ed6\u7bc0\u9ede\u7684\u8d0a\u540c\u6642\uff0c\u8a72\u7bc0\u9ede\u5c31\u6703\u6210\u70ba Leader Node</p> <ul> <li>\u591a\u6578\uff08majority\uff09= \u6cd5\u5b9a\u4eba\u6578\uff08quorum\uff09: N/2 + 1 </li> </ul> </li> <li> <p>\u7bc0\u9ede\u7e3d\u6578\u662f\u5947\u6578 or \u5076\u6578\u4e5f\u6709\u5dee\u5225; \u6b64\u5916\uff0c\u7db2\u8def\u5206\u6bb5\uff08network segmentation\uff09\u4e5f\u6709\u5f71\u97ff\u591a\u6578\uff08majority\uff09\u7684\u5224\u5b9a</p> </li> <li>\u6700\u4f73\u5be6\u8e10: K8s \u53e2\u96c6\u7684\u7e3d\u7bc0\u9ede\u6578\uff0c\u63a1\u7528\u5947\u6578\uff0c\u4e26\u4e14\u4f7f\u7528 3, 5, 7 ... \u500b\u7bc0\u9ede\u8f03\u597d     </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#create-k8s-cluster-using-kubeadm-tool","title":"Create K8s cluster using kubeadm tool","text":"<ul> <li> <p>\u672c\u8ab2\u7a0b\u7684\u7bc4\u4f8b K8s \u53e2\u96c6\u67b6\u69cb\u8a2d\u8a08\u5716: 1 Master Node + 2 Worker Node      </p> </li> <li> <p>\u672c\u8ab2\u7a0b\u7684\u7bc4\u4f8b K8s \u53e2\u96c6\u5efa\u7f6e\u6d41\u7a0b\u5716\u89e3     </p> <ul> <li>Step 1: \u904b\u7528 Virtual Box \u5efa\u7acb\u865b\u64ec\u6a5f\u5668</li> <li>Step 2: \u904b\u7528 Vagrant \u5feb\u901f\u81ea\u52d5\u5316\u5efa\u7f6e\u865b\u64ec\u6a5f\u5668\u7684\u74b0\u5883</li> <li>Step 3: \u5b89\u88dd container runtime: containerd, Docker<ul> <li>\u4ee5\u9078\u64c7 containerd \u70ba\u4f8b<ul> <li>\u5728 Master Node, Worker Node \u90fd\u8981 \u555f\u7528 IPv4 packet forwarding</li> <li>\u9a57\u8b49 <code>net.ipv4.ip_forward</code> \u5df2\u8a2d\u5b9a\u70ba 1</li> </ul> </li> </ul> </li> <li>Step 4: \u5728 Master Node, Worker Node \u90fd\u8981 \u5b89\u88dd kubeadm, kubectl, kubelet \u5de5\u5177<ul> <li>kubeadm: \u7528\u4f86\u5f15\u5c0e\u5efa\u7acb K8s \u53e2\u96c6\u7684\u6307\u4ee4\u5de5\u5177</li> <li>kubectl: \u7528\u4f86\u8207 K8s \u53e2\u96c6\u6e9d\u901a\u7684 CLI \u547d\u4ee4\u5217\u5de5\u5177</li> <li>kubelet: \u5728 K8s \u53e2\u96c6\u4e2d\u7684\u6240\u6709\u6a5f\u5668\u4e0a\u904b\u884c\u7684\u5143\u4ef6\uff0c\u8ca0\u8cac\u555f\u52d5 Pod\u3001\u5bb9\u5668</li> </ul> </li> <li>Step 5: \u5728 Master Node, Worker Node \u90fd\u8981 \u5b89\u88dd cgroup driver: kubelet\u3001container runtime \u90fd\u9700\u8981\u900f\u904e cgroup driver \u4f86\u7ba1\u7406\u786c\u9ad4\u8cc7\u6e90\uff08e.g. CPU, Memory\uff09<ul> <li>\u4ee5\u9078\u64c7 systemd \u70ba\u4f8b (K8s v1.22 \u4e4b\u5f8c\uff0c\u9810\u8a2d\u5c31\u662f\u4f7f\u7528 systemd\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u505a\u984d\u5916\u8a2d\u5b9a)</li> </ul> </li> <li> <p>Step 6: \u521d\u59cb\u5316 Master Node</p> <ul> <li> <p>\u8a2d\u5b9a Master Node \u7684\u5171\u4eab\u7aef\u9ede\uff0c\u53ef\u4ee5\u662f DNS \u540d\u7a31, IP address, \u8ca0\u8f09\u5e73\u8861\u5668\u7684 IP address (\u82e5\u662f\u8981\u5efa\u7acb 2 \u500b\u4ee5\u4e0a\u7684 Master Node \u624d\u9700\u8981\u8a2d\u5b9a\uff0c\u6240\u4ee5\u662f optional \u7684\u6b65\u9a5f)     Bash<pre><code>kubeadm init --control-plane-endpoint=\n</code></pre></p> </li> <li> <p>\u8a2d\u5b9a Pod network CIDR Bash<pre><code>kubeadm init --pod-network-cidr=\n</code></pre></p> </li> <li> <p>\u8a2d\u5b9a kubeadm \u8981\u4f7f\u7528\u7684 container runtime (\u901a\u5e38 kubeadm \u6703\u81ea\u52d5\u5075\u6e2c\uff0c\u6240\u4ee5\u662f optional \u7684\u6b65\u9a5f)     Bash<pre><code>kubeadm init --cri-socket=&lt;containerd&gt;\n</code></pre></p> </li> <li> <p>\u8a2d\u5b9a kube-apiserver \u7684\u975c\u614b IP address\uff0c\u8b93\u6240\u6709\u7684 Worker Node \u90fd\u80fd\u5b58\u53d6 kube-apiserver (\u901a\u5e38 kubeadm \u9810\u8a2d\u6703\u4f7f\u7528 default gateway \u7684 IP address\uff0c\u6240\u4ee5\u662f optional \u7684\u6b65\u9a5f)     Bash<pre><code>kubeadm init --apiserver-advertise-address=&lt;master-node-ip-address&gt;\n</code></pre></p> </li> </ul> </li> <li> <p>Step 7: \u5efa\u7acb kube config \u6a94\u6848     Bash<pre><code>mkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre></p> <ul> <li>\u78ba\u8a8d Master Node \u662f\u5426\u5df2\u6210\u529f\u521d\u59cb\u5316     Bash<pre><code>kubectl get nodes\n</code></pre></li> </ul> </li> <li> <p>Step 8: \u5728 Master Node\uff0c\u8a2d\u5b9a K8s \u53e2\u96c6\u7684\u7db2\u8def\u9023\u7dda (CNI)</p> <ul> <li> <p>\u4ee5\u9078\u64c7 Weave Net \u70ba\u4f8b     Bash<pre><code>kubectl apply -f https://reweave.azurewebsites.net/k8s/&lt;k8s-version&gt;/net.yaml\n</code></pre></p> </li> <li> <p>\u78ba\u4fdd\u7db2\u8def\u8a2d\u5b9a\u7684\u4e00\u81f4\u6027: \u82e5\u5728 Worker Node \u7684 kube-proxy \u4e2d\u6709\u8a2d\u5b9a <code>--cluster-cidr</code> \u9078\u9805 (\u4e5f\u5c31\u662f <code>kubeadm init --pod-network-cidr=</code> \u7684 IP address) \u7684\u8a71\uff0c\u8acb\u78ba\u4fdd Weave Net \u9019\u500b DaemonSet \u7684\u74b0\u5883\u8b8a\u6578 <code>IPALLOC_RANGE</code> \u7684 IP address \u4e00\u81f4\u6027     Bash<pre><code>kubectl edit daemonset weave-net -n=kube-system\n</code></pre></p> </li> <li> <p>\u78ba\u8a8d Weave Net \u9019\u500b DaemonSet \u662f\u5426\u5df2\u6210\u529f\u90e8\u7f72\u5728 Master Node \u4e0a     Bash<pre><code>kubectl get pods -n=kube-system\n</code></pre></p> </li> </ul> </li> <li> <p>Step 9: \u5c07 Worker Node \u90fd\u52a0\u5165\u5230 K8s \u53e2\u96c6\u4e2d</p> <ul> <li> <p>\u5728 Worker Node \u4e2d\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4     Bash<pre><code>sudo kubeadm join --token &lt;token&gt; &lt;control-plane-host&gt;:&lt;control-plane-port&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;\n</code></pre></p> </li> <li> <p>\u78ba\u8a8d Worker Node \u662f\u5426\u5df2\u6210\u529f\u52a0\u5165 K8s \u53e2\u96c6     Bash<pre><code>kubectl get nodes\n</code></pre></p> </li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#end-to-end-tests-on-k8s-cluster","title":"End to End Tests on K8s Cluster","text":"<p>\u5728 2020/09 \u6708\u4e4b\u5f8c\u7684 CKA \u8003\u8a66\uff0c\u4e0d\u6703\u8003\u5230 End to End Tests \u7684\u90e8\u5206\uff01 </p> <ul> <li> <p>\u6e2c\u8a66 K8s \u53e2\u96c6\u7684\u65b9\u6cd5</p> <ul> <li> <p>\u624b\u52d5\u6e2c\u8a66</p> <ul> <li> <p>\u78ba\u8a8d\u7bc0\u9ede\u6b63\u5e38\u904b\u884c     Bash<pre><code>kubectl get nodes\n</code></pre></p> </li> <li> <p>\u78ba\u8a8d Pod \u6b63\u5e38\u904b\u884c     Bash<pre><code>kubectl get pods\n</code></pre></p> <p></p> </li> <li> <p>\u78ba\u8a8d Master Node</p> <ul> <li> <p>kube-apiserver \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kube-apiserver status\n</code></pre></p> </li> <li> <p>kube-controller-manager \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kube-controller-manager status\n</code></pre></p> </li> <li> <p>kube-scheduler \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kube-scheduler status\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>\u78ba\u8a8d Worker Node</p> <ul> <li> <p>kubelet \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kubelet status\n</code></pre></p> </li> <li> <p>kube-proxy \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kube-proxy status\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>\u78ba\u8a8d Deployment \u80fd\u6210\u529f\u90e8\u7f72     Bash<pre><code>kubectl run nginx\n</code></pre></p> Bash<pre><code>kubectl get pods\n</code></pre> Bash<pre><code>kubectl scale --replicas=3 deploy/nginx\n</code></pre> Bash<pre><code>kubectl get pods\n</code></pre> <p></p> </li> <li> <p>\u78ba\u8a8d Service \u80fd\u6b63\u5e38\u904b\u4f5c     Bash<pre><code>kubectl expose deployment nginx --port=80 --type=NodePort\n</code></pre></p> Bash<pre><code>kubectl get service\n</code></pre> Bash<pre><code>curl http://&lt;worker-node&gt;:&lt;NodePort&gt;\n</code></pre> <p></p> </li> </ul> </li> <li> <p>\u81ea\u52d5\u5316\u6e2c\u8a66\u5de5\u5177: K8s test-infra</p> <ul> <li> <p>\u80fd\u78ba\u4fdd K8s \u53e2\u96c6\u4e2d\u7684 Networking\u3001Service\u3001DNS \u89e3\u6790\u3001Secrets\u3001ConfigMap \u5747\u80fd\u6b63\u5e38\u904b\u4f5c      </p> </li> <li> <p>\u5e38\u7528\u6307\u4ee4     </p> </li> <li> <p>\u7bc4\u4f8b\u6aa2\u6e2c\u7d50\u679c      </p> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50: KodeKloud YouTube \u5f71\u7247\u6559\u5b78: Install Kubernetes from Scratch [19] - End to End Tests</p> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50</p> <ul> <li>K8s \u5b98\u65b9\u6587\u4ef6: \u904b\u7528 kubeadm \u5de5\u5177\uff0c\u5feb\u901f\u5efa\u7acb K8s \u53e2\u96c6</li> <li>GitHub: KodeKloud \u6559\u5b78\u5982\u4f55\u5efa\u7acb K8s \u53e2\u96c6<ul> <li>Kubeadm Clusters</li> <li>Managed Clusters (AWS EKS, Azure AKS, GCP GKE)</li> </ul> </li> <li>GitHub: KodeKloud \u5f9e 0 ~ 1 \u5efa\u7acb K8s \u53e2\u96c6 (\u8f03\u8907\u96dc\u7684\u65b9\u6cd5)<ul> <li>\u53ef\u642d\u914d YouTube: KodeKloud \u5f71\u7247\u6559\u5b78</li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#troubleshooting","title":"Troubleshooting","text":""},{"location":"cloud/k8s/cka/#application-failure","title":"Application Failure","text":"<p>\u60c5\u5883\u5047\u8a2d: \u6211\u5011\u6709\u4e00\u500b\u5169\u5c64\u5f0f\u67b6\u69cb\u7684 Web Server, DB Server\uff0c\u5176\u7cfb\u7d71\u67b6\u69cb\u5982\u4e0b\u5716\u6240\u793a </p> <p></p> <ul> <li> <p>\u82e5\u672c\u8eab\u5c0d\u65bc\u6545\u969c\u6392\u9664\u5df2\u6709\u7d93\u9a57\u7684\u8a71\uff0c\u53ef\u4ee5\u5f9e\u7cfb\u7d71\u67b6\u69cb\u5716\u4e2d\u7684\u4efb\u4e00\u74b0\u7bc0\u958b\u59cb\u9032\u884c\u9664\u932f; \u4f46\u82e5\u662f\u4e00\u6642\u9593\u627e\u4e0d\u51fa\u982d\u7dd2\u7684\u8a71\uff0c\u5efa\u8b70\u53ef\u5f9e\u6700\u6e90\u982d\u7684\u5730\u65b9\u958b\u59cb\u9032\u884c\u9664\u932f\uff0c\u4f8b\u5982: \u5f9e Web Server \u958b\u59cb\u9032\u884c\u9664\u932f</p> <ul> <li>Step 1: \u6aa2\u67e5\u61c9\u7528\u7a0b\u5f0f\u7684\u72c0\u614b     Bash<pre><code>curl http://web-service-ip:node-port\n</code></pre></li> <li> <p>Step 2: \u6aa2\u67e5 Web Service \u7684\u72c0\u614b\uff0c\u662f\u5426\u5df2\u6b63\u78ba\u9023\u63a5\u5230 Web Pod \u7aef\u9ede(endpoint)\uff0c\u4e26\u6aa2\u67e5 Web Service \u6240\u4f7f\u7528\u7684 Selector \u662f\u5426\u6b63\u78ba\u9078\u53d6\u76f8\u5c0d\u61c9 Web Pod \u7684 label     Bash<pre><code>kubectl describe service web-service\n</code></pre></p> <p></p> </li> <li> <p>Step 3: \u6aa2\u67e5 Web Pod \u7684\u72c0\u614b\uff0c\u662f\u5426\u6b63\u5e38\u904b\u884c     Bash<pre><code># \u67e5\u770b Pod Status, Restart \u6b21\u6578\nkubectl get pods\n</code></pre></p> Bash<pre><code>kubectl describe pod web\n</code></pre> Bash<pre><code>kubectl logs web\n</code></pre> Bash<pre><code># \u56e0\u70ba\u7576\u524d\u6b63\u5728\u904b\u884c\u7684 Pod \u53ef\u80fd\u4e0d\u6703\u53cd\u61c9\u4e0a\u6b21 Crash \u7684\u539f\u56e0\uff0c\u56e0\u6b64\u53ef\u4ee5\u52a0\u4e0a -f --previous \u53c3\u6578\uff0c\u4f86\u67e5\u770b\u4e0a\u6b21 Pod Crash \u7684 log \u8a0a\u606f\nkubectl logs web -f --previous\n</code></pre> <p></p> </li> <li> <p>Step 4: \u6700\u5f8c\uff0c\u6aa2\u67e5 DB Service, DB Pod \u7684\u72c0\u614b      </p> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50: K8s \u5b98\u65b9\u6587\u4ef6: Troubleshooting Applications</p> </li> </ul>"},{"location":"cloud/k8s/cka/#control-plane-node-failure","title":"Control Plane Node Failure","text":"<ul> <li> <p>Step 1: \u6aa2\u67e5 K8s \u53e2\u96c6\u4e2d\u6240\u6709\u7bc0\u9ede\u3001Pods \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>kubectl get nodes\n</code></pre></p> Bash<pre><code>kubeclt get pods --all-namespaces\n</code></pre> <p></p> </li> <li> <p>Step 2: (\u82e5\u662f\u4f7f\u7528 kubeadm \u5de5\u5177\u4f86\u5efa\u7acb K8s \u53e2\u96c6\u7684\u8a71)\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>kubectl</code> \u6aa2\u67e5 Control Plane Node \u4e2d\uff0c\u6240\u6709 Pods \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>kubectl get pods -n=kube-system\n</code></pre></p> <p></p> </li> <li> <p>Step 3: \u6aa2\u67e5 Control Plane Node \u4e0a\uff0c\u6240\u6709 K8s \u53e2\u96c6\u670d\u52d9\u7684\u904b\u884c\u72c0\u614b</p> <ul> <li> <p>\u6aa2\u67e5 kube-apiserver \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kube-apiserver status\n</code></pre></p> </li> <li> <p>\u6aa2\u67e5 kube-controller-manager \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kube-controller-manager status\n</code></pre></p> </li> <li> <p>\u6aa2\u67e5 kube-scheduler \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kube-scheduler status\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>Step 4: \u6aa2\u67e5 Worker Node \u4e0a\u7684 kubelet, kube-proxy \u7684\u904b\u884c\u72c0\u614b     Bash<pre><code>service kubelet status\n</code></pre></p> Bash<pre><code>service kube-proxy status\n</code></pre> <p></p> </li> <li> <p>Step 5: \u6aa2\u67e5 Control Plane Node \u4e0a\uff0c\u6240\u6709\u904b\u884c\u7684\u7269\u4ef6\u7684 log \u8a0a\u606f</p> <ul> <li> <p>(\u82e5\u662f\u4f7f\u7528 kubeadm \u5de5\u5177\u4f86\u90e8\u7f72 K8s \u53e2\u96c6\u7684 Control Plan \u76f8\u95dc\u7269\u4ef6\u7684\u8a71)\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>kubectl</code> Bash<pre><code>kubectl logs kube-apiserver-master -n=kube-system\n</code></pre></p> </li> <li> <p>(\u82e5\u662f\u4f7f\u7528 <code>SystemD</code> Service \u4f86\u90e8\u7f72 K8s \u53e2\u96c6\u7684 Control Plan \u76f8\u95dc\u7269\u4ef6\u7684\u8a71)\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>journalctl</code> Bash<pre><code>sudo journalctl -u=kube-apiserver\n</code></pre></p> </li> </ul> <p></p> </li> <li> <p>\u53c3\u8003\u9023\u7d50: K8s \u5b98\u65b9\u6587\u4ef6: Troubleshooting Clusters</p> </li> </ul>"},{"location":"cloud/k8s/cka/#worker-node-failure","title":"Worker Node Failure","text":"<ul> <li> <p>Step 1: \u6aa2\u67e5 K8s \u53e2\u96c6\u4e2d\uff0c\u6240\u6709 Worker Nodes \u7684\u904b\u884c\u72c0\u614b (Ready || NotReady)     Bash<pre><code>kubectl get nodes\n</code></pre></p> <ul> <li> <p>\u82e5\u67d0\u500b Worker Node \u70ba NotReady \u72c0\u614b\uff0c\u5247\u53ef\u4ee5\u9032\u4e00\u6b65\u6aa2\u8996\u8a72 Worker Node \u7684\u8cc7\u6e90\u904b\u7528\u72c0\u614b (e.g. disk, memory)     Bash<pre><code>kubectl describe node worker-1\n</code></pre></p> <p></p> </li> <li> <p>\u82e5\u67d0\u500b Worker Node \u70ba Unknown \u72c0\u614b\uff0c\u8868\u793a\u8a72 Worker Node \u8207 Control Plane Node \u5df2\u5931\u53bb\u9023\u7dda\uff0c\u53ef\u900f\u904e <code>LastHeartbeatTime</code> \u6700\u5f8c\u4e00\u6b21\u7684\u9023\u7dda\u6642\u9593     </p> </li> </ul> </li> <li> <p>Step 2: \u53ef\u91dd\u5c0d\u6307\u5b9a\u7684 Worker Node\uff0c\u5247\u53ef\u4ee5\u9032\u4e00\u6b65\u6aa2\u8996\u8a72 Worker Node \u7684\u8cc7\u6e90\u904b\u7528\u72c0\u614b     Bash<pre><code># \u52d5\u614b\u986f\u793a Worker Node \u7684\u904b\u884c\u72c0\u614b\uff0c\u4e3b\u8981\u7528\u65bc\u76e3\u63a7 CPU, Memory \u7684\u4f7f\u7528\u60c5\u6cc1\ntop\n</code></pre></p> Bash<pre><code># \u986f\u793a Worker Node \u7684\u786c\u789f\u4f7f\u7528\u60c5\u6cc1\uff0c\u4ee5\u9069\u5408\u4eba\u985e\u95b1\u8b80\u7684\u65b9\u5f0f\u4f86\u5448\u73fe\ndf -h\n</code></pre> <p></p> </li> <li> <p>Step 3: \u6aa2\u67e5 Worker Node \u4e0a\u7684 kubelet \u904b\u884c\u72c0\u614b</p> <ul> <li> <p>\u6aa2\u67e5 kubelet \u662f\u5426\u6b63\u5e38\u904b\u884c\u4e2d     Bash<pre><code>serivce kubelet status\n</code></pre></p> </li> <li> <p>\u6aa2\u8996 kubelet \u7684\u904b\u884c\u72c0\u614b log \u8a0a\u606f     Bash<pre><code>sudo journalctl -u kubelet\n</code></pre></p> <p></p> </li> <li> <p>\u6aa2\u67e5 kubelet \u7684 CA \u6191\u8b49\u7684\u6709\u6548\u6027 (e.g. \u5728\u6709\u6548\u671f\u9593\u5167\u3001\u5728\u6b63\u78ba\u7684 group \u4e2d\u3001\u662f\u7531\u6b63\u78ba\u7684 CA \u6a5f\u69cb\u6240\u767c\u884c)     Bash<pre><code>openssl x509 -in /var/lib/kubelet/worker-1.crt -text\n</code></pre></p> </li> </ul> <p></p> </li> </ul>"},{"location":"cloud/k8s/cka/#networking-failure","title":"Networking Failure","text":"<ul> <li>\u5b89\u88dd\u7db2\u8def\u63d2\u4ef6 (CNI)\uff0c\u4f8b\u5982: Weave Net, Flannel<ul> <li>K8s \u5b98\u65b9\u6587\u4ef6: Installing Addons</li> </ul> </li> <li> <p>CoreDNS: K8s \u53e2\u96c6\u53ef\u4f7f\u7528 CoreDNS \u4f5c\u70ba DNS \u4f3a\u670d\u5668</p> <ul> <li> <p>\u53ef\u6aa2\u8996 Corefile plugin\uff0c\u4ee5 ConfigMap \u7684\u5f62\u5f0f\u4f86\u8a2d\u5b9a CoreDNS     YAML<pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n    name: coredns\n    namespace: kube-system\ndata:\n    Corefile: |\n        .:53 {\n            errors\n            health {\n                lameduck 5s\n            }\n            ready\n            kubernetes cluster.local in-addr.arpa ip6.arpa {\n                pods insecure\n                fallthrough in-addr.arpa ip6.arpa\n                ttl 30\n            }\n            prometheus :9153\n            forward . /etc/resolv.conf\n            cache 30\n            loop\n            reload\n            loadbalance\n        }\n</code></pre></p> </li> <li> <p>\u5c07 K8s \u53e2\u96c6\u5916\u7684\u57df\u540d\uff0c\u76f4\u63a5\u8f49\u767c\u5230\u6b63\u78ba\u7684\u6b0a\u5a01 DNS \u4f3a\u670d\u5668     Bash<pre><code>proxy . /etc/resolv.conf\n</code></pre></p> </li> <li> <p>CoreDNS \u6545\u969c\u6392\u9664</p> <ul> <li>\u82e5 Pod \u8655\u65bc pending \u72c0\u614b: \u6aa2\u67e5\u662f\u5426\u5b89\u88dd\u4e86\u7db2\u8def\u63d2\u4ef6 (CNI)</li> <li> <p>\u82e5\u767c\u751f CrashLoopBackOff \u6216\u932f\u8aa4\u72c0\u614b: \u53ef\u80fd\u662f SELinux \u7684\u554f\u984c</p> <p>\u5728 K8s \u4e2d\uff0cSELinux\uff08Security-Enhanced Linux\uff09\u662f\u4e00\u7a2e\u5b89\u5168\u6a21\u7d44\uff0c\u7528\u65bc\u63a7\u5236\u8a2a\u554f\u6b0a\u9650</p> <p>\u7576 Kubernetes \u7bc0\u9ede\u4e0a\u904b\u884c\u7684 CoreDNS Pod \u9047\u5230 SELinux \u554f\u984c\u6642\uff0c\u53ef\u80fd\u6703\u5c0e\u81f4 Pod \u7121\u6cd5\u555f\u52d5\uff0c\u51fa\u73fe <code>CrashLoopBackOff</code> \u6216 <code>Error</code> \u72c0\u614b\u3002\u9019\u4e9b\u554f\u984c\u901a\u5e38\u662f\u7531\u65bc\u820a\u7248 Docker \u8207 SELinux \u7684\u4e0d\u517c\u5bb9\u6027\u6216\u932f\u8aa4\u8a2d\u5b9a\u6240\u5f15\u8d77\u7684 </p> <ul> <li> <p>\u6cd5 1: \u5347\u7d1a Docker (\u5c07 Docker \u5347\u7d1a\u5230\u6700\u65b0\u7248\u672c\uff0c\u4ee5\u78ba\u4fdd\u8207 SELinux \u7684\u517c\u5bb9\u6027)     Bash<pre><code>sudo yum update docker\n\nsudo systemctl restart docker\n</code></pre></p> </li> <li> <p>\u6cd5 2: \u7981\u7528 SELinux</p> <ul> <li> <p>\u81e8\u6642\u7981\u7528 SELinux \u4f86\u6e2c\u8a66\u554f\u984c\u662f\u5426\u89e3\u6c7a     Bash<pre><code>sudo setenforce 0\n</code></pre></p> </li> <li> <p>\u82e5\u554f\u984c\u89e3\u6c7a\uff0c\u53ef\u4ee5\u8003\u616e\u6c38\u4e45\u7981\u7528 SELinux     Bash<pre><code>sudo sed -i 's/^SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config\n\nsudo reboot\n</code></pre></p> </li> </ul> </li> <li> <p>\u6cd5 3: \u4fee\u6539\u90e8\u7f72\u8a2d\u5b9a\u6a94 <code>allowPrivilegeEscalation</code> \u70ba true\uff0c\u5141\u8a31\u63d0\u5347\u6b0a\u9650     Bash<pre><code>kubectl -n kube-system get deployment coredns -o yaml | \\\n    sed 's/allowPrivilegeEscalation: false/allowPrivilegeEscalation: true/g' | \\\n\nkubectl apply -f -\n</code></pre></p> </li> </ul> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50: </p> <ul> <li>K8s \u5b98\u65b9\u6587\u4ef6: Customizing DNS Service</li> <li>K8s \u5b98\u65b9\u6587\u4ef6: Debugging DNS Resolution</li> <li>K8s \u5b98\u65b9\u6587\u4ef6: Debug Services</li> </ul> </li> </ul> </li> <li> <p>kube-proxy</p> <ul> <li>\u6982\u8ff0<ul> <li>\u89d2\u8272: \u904b\u884c\u5728\u6bcf\u500b\u7bc0\u9ede\u4e0a\u7684\u7db2\u8def\u4ee3\u7406\uff0c\u7dad\u8b77\u7bc0\u9ede\u4e0a\u7684\u7db2\u8def\u898f\u5247\uff0c\u5141\u8a31 Pod \u4e4b\u9593\u7684\u7db2\u8def\u901a\u8a0a</li> <li>\u90e8\u7f72: \u82e5\u662f\u900f\u904e kubeadm \u5de5\u5177\u6240\u5efa\u7acb\u7684 K8s \u53e2\u96c6\uff0ckube-proxy \u662f\u4f5c\u70ba DaemonSet \u904b\u884c\u5728\u6bcf\u500b\u5de5\u4f5c\u7bc0\u9ede\u4e0a</li> <li>\u8cac\u4efb: \u76e3\u8996\u670d\u52d9\u548c\u7aef\u9ede\uff0c\u5c07\u6d41\u91cf\u8def\u7531\u5230\u5be6\u969b\u7684 Pod</li> </ul> </li> <li>\u8a2d\u5b9a\u6a94\u7684\u8def\u5f91\u4f4d\u7f6e<ul> <li><code>/var/lib/kube-proxy/config.conf</code>: kube-proxy \u7684\u8a2d\u5b9a\u6a94</li> <li>\u53ef\u8a2d\u5b9a clusterCIDR, kubeproxy mode, ipvs, iptables, bindaddress, kube-config \u7b49</li> </ul> </li> <li>kube-proxy \u6545\u969c\u6392\u9664<ul> <li>\u78ba\u8a8d kube-proxy pod \u5728 kube-system \u547d\u540d\u7a7a\u9593\u4e2d\u662f\u6b63\u5e38\u904b\u884c\u7684</li> <li>\u6aa2\u67e5 kube-proxy \u7684 log \u8a0a\u606f</li> <li>\u9a57\u8b49 configmap \u8207\u5176\u8a2d\u5b9a\u6a94\u5167\u5bb9\u7684\u6b63\u78ba\u6027\u3001\u4e00\u81f4\u6027</li> <li>\u78ba\u8a8d kube-config \u6709\u5728 configmap \u4e2d\u5b9a\u7fa9</li> <li>\u78ba\u8a8d kube-proxy \u5728\u5bb9\u5668\u5167\u662f\u6b63\u5e38\u904b\u884c\u7684     Bash<pre><code>netstat -plan | grep kube-proxy\n</code></pre></li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#exam-information","title":"Exam Information","text":"<ul> <li>\u8003\u8a66\u5167\u5bb9<ul> <li></li> </ul> </li> <li>\u8003\u8a66\u6642\u9593: 2 \u5c0f\u6642</li> <li>\u8003\u8a66\u985e\u578b: \u9060\u7aef\u76e3\u8003</li> <li>\u8003\u8a66\u671f\u9593: \u53ef\u4ee5\u67e5\u770b K8s \u5b98\u65b9\u6587\u4ef6\u7684\u6307\u4ee4</li> <li>\u50f9\u683c: 395 \u7f8e\u91d1<ul> <li>20% \u6298\u6263\u78bc: <code>20KODE</code></li> </ul> </li> <li>\u4e00\u5e74\u5167\u53ef\u4ee5\u514d\u8cbb\u91cd\u8003\u4e00\u6b21</li> <li>\u8b49\u7167\u6709\u6548\u671f\u9650: 3 \u5e74</li> <li>\u8003\u8a66\u524d\u9700\u5148\u901a\u904e PSI Online Proctoring System Check \u6aa2\u9a57\uff0c\u78ba\u8a8d\u7dda\u4e0a\u8003\u8a66\u74b0\u5883\u5df2\u7b26\u5408\u8003\u8a66\u9700\u6c42</li> <li>\u53c3\u8003\u8cc7\u6599<ul> <li>CNCF-CKA \u5831\u540d\u8003\u8a66</li> <li>CNCF-CKA \u8003\u8a66\u8981\u6c42</li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#exam-tips","title":"Exam Tips","text":"<ul> <li> <p>\u8a2d\u5b9a\u5e38\u7528\u6307\u4ee4\u7684\u5225\u540d     Bash<pre><code>alias k=kubectl\n</code></pre></p> </li> <li> <p>\u8a2d\u5b9a kubectl \u7684\u81ea\u52d5\u88dc\u5168\u529f\u80fd (auto complete)     Bash<pre><code>source &lt;(kubectl completion bash)\n</code></pre></p> </li> <li> <p>\u6aa2\u8996 K8s \u53e2\u96c6\u4e2d\u5404\u9805\u8cc7\u6e90\u7684\u7e2e\u5beb\u540d\u7a31 (shortnames, \u662f\u5426\u5c6c\u65bc Namespaced \u7684\u7269\u4ef6)     Bash<pre><code>kubectl api-resources\n</code></pre></p> <p></p> </li> <li> <p>\u6839\u64da CLI \u4e0a\u7684\u6307\u4ee4\u8207\u9078\u9805\uff0c\u5feb\u901f\u5efa\u7acb YAML \u7bc4\u672c: </p> <ul> <li><code>--image</code>: \u6307\u5b9a container image</li> <li><code>--dry-run=client</code>: \u544a\u8a34 kubectl \u57f7\u884c\u547d\u4ee4\uff0c\u4f46\u4e0d\u6703\u5be6\u969b\u5efa\u7acb Pod\uff0c\u53ea\u662f\u6a21\u64ec\u57f7\u884c</li> <li><code>-o=yaml</code>: \u6307\u5b9a\u8f38\u51fa\u683c\u5f0f\u70ba YAML</li> <li><code>&gt; filename.yaml</code>: \u5c07\u57f7\u884c\u7d50\u679c\u8f38\u51fa &amp; \u5132\u5b58\u5230\u6307\u5b9a\u6a94\u6848\uff0c\u4ee5\u4fbf\u5f8c\u7e8c\u4f7f\u7528 Bash<pre><code>kubectl run nginx --image=nginx --dry-run=client -o=yaml &gt; nginx-pod.yaml\n</code></pre></li> <li>\u53c3\u8003\u8cc7\u6599: kubectl Usage Conventions</li> </ul> </li> <li>\u8003\u8a66\u6642\uff0c\u5efa\u8b70\u4f7f\u7528\u5ba3\u544a\u5f0f\u8a9e\u6cd5\u4f86\u64cd\u4f5c K8s \u7269\u4ef6     </li> <li><code>--watch</code>: \u5be6\u6642\u76e3\u63a7 K8s \u53e2\u96c6\u72c0\u614b     Bash<pre><code>kubectl get pods --watch\n</code></pre></li> <li> <p><code>wc -l</code>: \u8a08\u7b97\u6307\u5b9a\u6a94\u6848\u4e2d\u7684\u884c\u6578</p> <ul> <li>wc = word count</li> </ul> Bash<pre><code>kubectl get pods --selector env=dev --no-headers | wc -l\n</code></pre> <p></p> </li> <li> <p><code>--command</code>: \u7528\u65bc\u6307\u5b9a\u5bb9\u5668\u7684\u6307\u4ee4</p> <ul> <li>Tips: <code>--command</code> \u5f8c\u9762\u63a5\u7684\u662f\u5c0d\u65bc\u5bb9\u5668\u7684\u6307\u4ee4\uff0c\u56e0\u6b64\u7fd2\u6163\u4e0a\u6211\u5011\u6703\u628a <code>--command</code> \u653e\u5728\u6700\u5f8c\u9762\u624d\u5ba3\u544a     Bash<pre><code>kubectl run static-busybox --image=busybox --dry-run=client -o=yaml --command -- sleep 1000\n</code></pre></li> </ul> </li> <li> <p>\u5728 CKA \u8003\u8a66\u671f\u9593\uff0c\u6211\u5011\u4e0d\u6703\u77e5\u9053\u81ea\u5df1\u4e0b\u6307\u4ee4\u7684\u7d50\u679c\u662f\u5426\u6b63\u78ba\uff1f \u56e0\u6b64\uff0c\u6211\u5011\u5fc5\u9808\u81ea\u5df1\u9a57\u8b49\u7d50\u679c\u3002\u8209\u4f8b\u8aaa\u660e\u5982\u4e0b</p> <ul> <li>Q: \u984c\u76ee\u8981\u6c42\u6211\u5011\u6839\u64da\u6307\u5b9a\u7684 container image \u5efa\u7acb\u4e00\u500b Pod<ul> <li>A: \u6211\u5011\u53ef\u4ee5\u900f\u904e <code>kubectl describe pod &lt;pod-name&gt;</code> \u4f86\u6aa2\u8996 Pod \u7684\u8a73\u7d30\u8cc7\u8a0a\uff0c\u4ee5\u78ba\u8a8d Pod \u662f\u5426\u6b63\u78ba\u5efa\u7acb</li> </ul> </li> </ul> </li> </ul>"},{"location":"cloud/k8s/cka/#reference","title":"Reference","text":"<ul> <li>Kubernetes \u5b98\u65b9\u6587\u4ef6</li> <li>GitHub: KodeKloud CKA learning notes</li> <li>KodeKloud \u7dda\u4e0a\u6a21\u64ec\u7df4\u7fd2\u74b0\u5883</li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/","title":"\u8cc7\u6599\u7d50\u69cb &amp; \u6f14\u7b97\u6cd5","text":"<ul> <li>\u672c\u7bc7\u662f\u53c3\u8003 Geeks for Geeks \u7db2\u7ad9\u7684 DSA Tutorial \u6240\u6574\u7406\u7684\u5b78\u7fd2\u7b46\u8a18</li> <li>\u4ee5 Java \u7a0b\u5f0f\u8a9e\u8a00\u70ba\u4e3b</li> </ul> \u76ee\u9304<ul> <li>\u8cc7\u6599\u7d50\u69cb &amp; \u6f14\u7b97\u6cd5<ul> <li>\u7e3d\u89bd</li> <li>\u8853\u8a9e\u8868<ul> <li>\u5c08\u696d\u8853\u8a9e\u5b9a\u7fa9</li> <li>\u57fa\u672c\u64cd\u4f5c\u7684\u8853\u8a9e</li> </ul> </li> <li>\u8cc7\u6599\u7d50\u69cb<ul> <li>\u9663\u5217(Array) &amp; ArrayList<ul> <li>Array</li> <li>ArrayList</li> </ul> </li> <li>\u77e9\u9663(Matrix) / \u7db2\u683c(Grid)</li> <li>\u6a39(Tree)</li> <li>\u5806\u7a4d (Heap)</li> </ul> </li> <li>\u6f14\u7b97\u6cd5</li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#_2","title":"\u7e3d\u89bd","text":"<ul> <li>\u5b78\u7fd2 DSA \u7684\u4e94\u500b\u6b65\u9a5f     </li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#_3","title":"\u8853\u8a9e\u8868","text":""},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#_4","title":"\u5c08\u696d\u8853\u8a9e\u5b9a\u7fa9","text":"<ul> <li>\u5ba3\u544a (declaration): \u544a\u8a34\u7de8\u8b6f\u5668\uff0c\u5b58\u5728\u8a72\u8b8a\u6578 or \u7269\u4ef6</li> <li>\u521d\u59cb\u5316 (initialization): \u70ba\u8b8a\u6578\u8ce6\u4e88\u521d\u59cb\u503c<ul> <li>\u539f\u751f\u578b\u5225: \u8ce6\u4e88\u521d\u59cb\u503c</li> <li>\u7269\u4ef6: \u900f\u904e\u5efa\u69cb\u5b50\uff0c\u8ce6\u4e88\u521d\u59cb\u503c\uff0c\u4e26\u5206\u914d\u8a18\u61b6\u9ad4\u7a7a\u9593</li> </ul> </li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#_5","title":"\u57fa\u672c\u64cd\u4f5c\u7684\u8853\u8a9e","text":"<ul> <li>\u5b58\u53d6 (access): \u53d6\u5f97\u8cc7\u6599\u7d50\u69cb\u4e2d\u7684\u5143\u7d20</li> <li>\u904d\u6b77 (traversal): \u8a2a\u554f\u8cc7\u6599\u7d50\u69cb\u4e2d\u7684\u6bcf\u500b\u5143\u7d20</li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#_6","title":"\u8cc7\u6599\u7d50\u69cb","text":"<ul> <li>\u5b9a\u7fa9: \u5e6b\u52a9\u5728\u96fb\u8166\u8a18\u61b6\u9ad4\u4e2d\u6709\u6548\u7d44\u7e54\u548c\u5132\u5b58\u8cc7\u6599</li> <li>\u529f\u80fd: \u63d0\u4f9b\u4e86\u4e00\u7a2e\u6709\u6548\u7ba1\u7406\u548c\u64cd\u4f5c\u8cc7\u6599\u7684\u65b9\u6cd5\uff0c\u4ee5\u5be6\u73fe\u66f4\u5feb\u7684\u5b58\u53d6\u3001\u63d2\u5165\u3001\u522a\u9664\u64cd\u4f5c</li> <li>\u76ee\u7684: \u8a2d\u8a08\u9ad8\u6548\u6f14\u7b97\u6cd5\u548c\u6700\u4f73\u5316\u8edf\u9ad4\u6548\u80fd\u7684\u57fa\u790e</li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#array-arraylist","title":"\u9663\u5217(Array) &amp; ArrayList","text":"<ul> <li>Array vs. ArrayList</li> </ul> Features\\\u8cc7\u6599\u578b\u5225 Array ArrayList \u9577\u5ea6 \u56fa\u5b9a \u8b8a\u52d5 \u8a18\u61b6\u9ad4\u5206\u914d \u9023\u7e8c \u4e0d\u9023\u7e8c \u5143\u7d20\u7684\u8cc7\u6599\u578b\u5225 \u539f\u751f\u8cc7\u6599\u578b\u5225 &amp; \u7269\u4ef6 \u7269\u4ef6 \u64cd\u4f5c\u5143\u7d20 \u4f7f\u7528 <code>[ ]</code> \u904b\u7b97\u5b50 \u4f7f\u7528 <code>add()</code>, <code>set()</code>, <code>remove()</code> ...\u7b49\u65b9\u6cd5 \u57f7\u884c\u901f\u5ea6 \u8f03\u5feb \u8f03\u6162 \u8cc7\u6599\u578b\u522b\u5b89\u5168(thread-safe) \u4e0d\u662f \u662f \u7dad\u5ea6 \u4e00\u7dad \uff5e \u591a\u7dad \u4e00\u7dad"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#array","title":"Array","text":"<ul> <li> <p>\u57fa\u672c\u6982\u5ff5</p> <ul> <li>\u5728\u8a18\u61b6\u9ad4\u4e2d\u9023\u7e8c\u5132\u5b58 (store a collection of elements sequentially)</li> <li>\u4f7f\u7528 index \u4f86\u96a8\u6a5f\u5b58\u53d6\u5143\u7d20 (randomly access)</li> </ul> <p></p> <ul> <li> <p>\u53ef\u5132\u5b58\u539f\u751f\u578b\u5225 or \u7269\u4ef6\u578b\u5225\uff0c\u4f46\u5404\u5143\u7d20\u9700\u70ba\u76f8\u540c\u578b\u5225</p> </li> <li> <p>\u4e00\u65e6\u5ba3\u544a\u5f8c\uff0c\u70ba\u56fa\u5b9a\u5927\u5c0f (fixed-size)</p> </li> <li> <p>Array \u985e\u5225 \u7e7c\u627f Object \u985e\u5225</p> </li> <li> <p>Array \u985e\u5225 \u5be6\u4f5c Cloneable &amp; java.io.Serializable \u4ecb\u9762</p> </li> </ul> </li> <li> <p>\u5e38\u898b\u61c9\u7528\u60c5\u5883</p> <ul> <li>\u5132\u5b58\u8cc7\u6599\uff0c\u4ee5\u4fbf\u5f8c\u7e8c\u8655\u7406</li> <li>\u5be6\u4f5c\u5176\u5b83\u8cc7\u6599\u7d50\u69cb (e.g. Stack, Queue, Tree, Graph)</li> <li>\u8cc7\u6599\u683c\u5f0f\u7684\u8868\u793a\u65b9\u6cd5: \u8868\u683c\u3001\u77e9\u9663</li> </ul> </li> <li> <p>\u5ba3\u544a &amp; \u521d\u59cb\u5316</p> <ul> <li> <p>\u5ba3\u544a (\u6709 2 \u7a2e\u5beb\u6cd5)</p> <ul> <li> <p>\u539f\u751f\u578b\u5225</p> <ul> <li><code>java     int[] arr; // \u63a8\u85a6\u9019\u500b\u5beb\u6cd5\uff0c\u8f03\u76f4\u89ba</code></li> <li><code>java     int arr[];</code></li> </ul> </li> <li> <p>\u53c3\u8003\u578b\u5225</p> <ul> <li><code>java     Student[] arr = new Student[5]; // student is a user-defined class</code></li> </ul> </li> <li> <p>\u591a\u7dad\u9663\u5217 (e.g. 2D Array)</p> Java<pre><code>int[][] arr = new int[3][3];\n</code></pre> </li> </ul> </li> <li> <p>\u521d\u59cb\u5316 (\u5206\u914d\u8a18\u61b6\u9ad4\u7d66\u8a72 Array)</p> Java<pre><code>arr = new int[5];\n</code></pre> </li> <li> <p>\u540c\u6642\u5ba3\u544a + \u521d\u59cb\u5316</p> Java<pre><code>int[] arr = new int[5];\n</code></pre> </li> </ul> </li> <li> <p>\u57fa\u672c\u64cd\u4f5c</p> <ul> <li> <p>\u53d6\u5f97\u9663\u5217\u5bb9\u91cf(capacity)</p> <ul> <li><code>arr.length</code> \u5c6c\u6027</li> </ul> Java<pre><code>int[] arr = new int[5]; // \u5ba3\u544a\u4e00\u500b\u542b\u6709 5 \u683c\u5bb9\u91cf(capacity)\u7684 Array\nSystem.out.println(arr.length); // 5\n\nString[] strArr = { \"GEEKS\", \"FOR\", \"GEEKS\" };\nSystem.out.println(strArr.length); // 3\n</code></pre> </li> </ul> </li> <li> <p>\u5b58\u53d6\u5143\u7d20</p> <ul> <li> <p>\u8996\u60c5\u6cc1\u53ef\u7528 for loop, for-each loop \u4f86\u5b58\u53d6 Array \u5143\u7d20</p> <ul> <li>for loop \u7684 Array index \u5f9e 0 (\u9996\u500b\u5143\u7d20) ~ -1 (\u6700\u672b\u9805\u5143\u7d20)</li> </ul> </li> <li> <p>\u82e5\u5b58\u53d6\u5408\u6cd5 index \u7bc4\u570d\u5916\u7684\u5143\u7d20 =&gt; JVM \u6703\u62cb\u51fa ArrayIndexOutOfBoundsException</p> </li> </ul> </li> <li> <p>\u8907\u88fd\u9663\u5217</p> <ul> <li> <p>1D Array</p> <ul> <li> <p>\u63a1\u7528 deep copy: \u53e6\u5916\u8907\u88fd\u4e00\u500b\u542b\u6709\u76f8\u540c\u5143\u7d20\u5011\u7684\u9663\u5217</p> <p></p> </li> <li> <p>\u57fa\u672c\u7bc4\u4f8b</p> Java<pre><code>int arr[] = { 1, 2, 3 };\nint cloneArr[] = arr.clone();\nSystem.out.println(intArr == arr); // false\n</code></pre> </li> </ul> </li> <li> <p>Multi-D Array</p> <ul> <li> <p>\u63a1\u7528 shallow copy: \u50c5\u8907\u88fd\u539f\u59cb\u7269\u4ef6\u7684\u6700\u5916\u5c64\u7d50\u69cb(\u5916\u6bbc)\uff0c\u88e1\u9762\u7684\u5143\u7d20\u4ecd\u662f\u6307\u5411\u539f\u8cc7\u6599\u7684\u8a18\u61b6\u9ad4\u4f4d\u7f6e</p> <p></p> </li> <li> <p>\u57fa\u672c\u7bc4\u4f8b</p> Java<pre><code>int intArray[][] = {{ 1, 2, 3 }, { 4, 5 }};\nint cloneArr[] = arr.clone();\n\nSystem.out.println(intArray == cloneArray); // false\nSystem.out.println(intArray[0] == cloneArray[0]); // true (sub-arrays are shared)\nSystem.out.println(intArray[1] == cloneArray[1]); // true (sub-arrays are shared)\n</code></pre> </li> </ul> </li> </ul> </li> <li> <p>\u53c3\u8003\u8cc7\u6599</p> <ul> <li>GeeksForGeeks-Arrays in Java</li> </ul> </li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#arraylist","title":"ArrayList","text":"<ul> <li> <p>\u57fa\u672c\u6982\u5ff5</p> <ul> <li> <p>ArrayList \u985e\u5225 \u7e7c\u627f Collection \u985e\u5225\uff0c\u4e14\u5c6c\u65bc java.util package \u7684\u5176\u4e2d\u4e00\u500b\u985e\u5225</p> <ul> <li>ArrayList \u985e\u5225 \u5be6\u4f5c List \u4ecb\u9762</li> <li>\u985e\u4f3c C++ \u7684 vector</li> </ul> <p></p> </li> <li> <p>\u4f7f\u7528 index \u4f86\u96a8\u6a5f\u5b58\u53d6\u5143\u7d20 (randomly access)     </p> </li> <li> <p>\u53ef\u8b8a\u5927\u5c0f (dynamic size): \u8868\u793a\u65b0\u589e, \u522a\u9664\u5143\u7d20\u6703\u81ea\u52d5\u8abf\u6574 <code>ArrayList.size()</code></p> </li> <li> <p>ArrayList \u50c5\u80fd\u88dd wrapper class\uff0c\u800c\u4e0d\u80fd\u88dd\u539f\u751f\u578b\u5225</p> </li> <li> <p>\u975e Synchronized: \u7576 Multi-thread \u540c\u6642\u4fee\u6539\u540c\u4e00\u500b ArrayList \u6642\uff0c\u7121\u6cd5\u4fdd\u8b49 thread-safe (\u6578\u64da\u4e00\u81f4\u6027)</p> </li> </ul> </li> <li> <p>\u5ba3\u544a &amp; \u521d\u59cb\u5316</p> <ul> <li> <p>\u57fa\u672c\u7bc4\u4f8b</p> Java<pre><code>ArrayList&lt;Integer&gt; arrL = new ArrayList&lt;Integer&gt;(2);\n</code></pre> </li> <li> <p>\u57fa\u672c\u64cd\u4f5c</p> <ul> <li> <p>\u53d6\u5f97 ArrayList \u7684\u5143\u7d20\u6578</p> <ul> <li><code>ArrayList.size()</code> \u65b9\u6cd5</li> </ul> Java<pre><code>int sz = arrL.size();  // 4\n</code></pre> </li> </ul> </li> </ul> </li> <li> <p>\u65b0\u589e\u5143\u7d20</p> <ul> <li>\u82e5 ArrayList \u7684 size \u6eff\u4e86\uff0c\u9810\u8a2d\u6703\u81ea\u52d5 doubled size \u4f86\u5132\u5b58\u66f4\u591a\u7684\u5143\u7d20</li> <li>ArrayList \u53ef\u4ee5\u63a5\u53d7 null, \u91cd\u8907\u503c</li> </ul> Java<pre><code>ArrayList&lt;String&gt; arrL = new ArrayList&lt;&gt;();\n// \u6cd5 1: \u6b63\u5e38\u52a0\u5165\u5143\u7d20\narrL.add(\"Alice\");\narrL.add(\"Bob\");\n// \u6cd5 2: \u6307\u5b9a index\uff0c\u63d2\u5165\u5143\u7d20\narrL.add(1, \"and\")\nSystem.out.println(al); // [Alice, and, Bob]\n</code></pre> </li> <li> <p>\u8a2d\u5b9a/\u66f4\u65b0\u5143\u7d20\u503c</p> Java<pre><code>arrL.set(2, \"John\");\nSystem.out.println(arrL); // [Alice, and, John]\n</code></pre> </li> <li> <p>\u522a\u9664\u5143\u7d20</p> Java<pre><code>// \u6cd5 1: \u522a\u9664\u6307\u5b9a\u5143\u7d20 (\u82e5 ArrayList \u4e2d\u5b58\u5728\u76f8\u540c\u7684\u7269\u4ef6\uff0c\u5247\u522a\u9664\u7b2c\u4e00\u500b\u51fa\u73fe\u7684\u7269\u4ef6)\narrL.remove(\"John\");\n// \u6cd5 2: \u522a\u9664\u6307\u5b9a index \u4e0a\u7684\u5143\u7d20\narrL.remove(0);\nSystem.out.println(arrL); [and]\n</code></pre> </li> <li> <p>\u8fed\u4ee3\u5143\u7d20</p> Java<pre><code>ArrayList&lt;String&gt; arrL = new ArrayList&lt;&gt;();\n// \u521d\u59cb\u5316\u6642\uff0c\u8ce6\u503c\u591a\u500b\u5143\u7d20\u503c (Java 9+)\nArrayList&lt;String&gt; arrL = new ArrayList&lt;&gt;(List.of(\"Alice\", \"and\", \"Bob\"));\n\n// \u6cd5 1: \u4f7f\u7528 for loop\nfor (int i = 0; i &lt; arrL.size(); i++) {\n    System.out.print(al.get(i) + \", \"); // Alice, and, Bob\n}\n// \u6cd5 2: \u4f7f\u7528 for-each loop\nfor (String str: arrL) {\n    System.out.print(str + \", \"); // Alice, and, Bob\n}\n</code></pre> </li> <li> <p>\u6392\u5217\u5143\u7d20</p> Java<pre><code>ArrayList&lt;Integer&gt; arrL = new ArrayList();\nlist.add(2);\nlist.add(4);\nlist.add(3);\nlist.add(1);\n\nSystem.out.println(\"Before sorting list:\");\nSystem.out.println(arrL);\n// \u904b\u7528 Collection \u985e\u5225\u7684 sort() \u65b9\u6cd5\nCollections.sort(arrL); // [2, 4, 3, 1]\n\nSystem.out.println(\"after sorting list:\");\nSystem.out.println(arrL); // [1, 2, 3, 4]\n</code></pre> </li> <li> <p>\u53d6\u5f97\u5143\u7d20</p> Java<pre><code>Integer n = list.get(1); // and\n</code></pre> </li> <li> <p>\u53c3\u8003\u8cc7\u6599</p> <ul> <li>GeeksForGeeks-ArrayList in Java</li> <li>GeeksForGeeks-Array vs. ArrayList in Java</li> <li>GeeksForGeeks-How to find length or size of an Array in Java?</li> </ul> </li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#matrix-grid","title":"\u77e9\u9663(Matrix) / \u7db2\u683c(Grid)","text":"<ul> <li>\u57fa\u672c\u6982\u5ff5<ul> <li>\u5b9a\u7fa9: \u77e9\u9663\u8cc7\u6599\u7d50\u69cb\u662f\u7531\u884c\u3001\u5217\u7d44\u6210\u7684\u4e8c\u7dad\u9663\u5217\u3002\u5b83\u662f\u7531\u6c34\u5e73\u689d\u76ee\u3001\u5782\u76f4\u689d\u76ee\u6240\u6392\u5217\u800c\u6210<ul> <li>\u9663\u5217 = [][] \u9663\u5217\u7684\u9663\u5217\uff0c\u4e14\u77e9\u9663\u4e2d\u6bcf\u683c\u7684\u6578 index \u5177\u6709\u76f8\u540c\u7684\u5927\u5c0f</li> <li>\u6c34\u5e73\u689d\u76ee = \u884c (row)</li> <li>\u5782\u76f4\u689d\u76ee = \u5217 (column)</li> </ul> </li> <li>\u77e9\u9663\u7dad\u5ea6 = \u884c\u6578 x \u5217\u6578</li> <li>\u77e9\u9663 index \u8868\u793a\u65b9\u5f0f: (row, column) \u6216 <code>arr[row][column]</code> </li> </ul> </li> <li>\u7279\u6027<ul> <li>\u512a\u9ede<ul> <li>\u6709\u52a9\u65bc \u4e8c\u7dad\u53ef\u8996\u5316</li> <li>\u5141\u8a31 \u96a8\u6a5f\u5b58\u53d6 \u6bcf\u4e00\u683c\u5143\u7d20</li> <li>\u53ef\u4ee5\u5132\u5b58\u4efb\u4f55\u5f62\u5f0f\u7684 \u56fa\u5b9a\u5927\u5c0f \u7684\u8cc7\u6599</li> </ul> </li> <li>\u7f3a\u9ede<ul> <li>\u7576\u77e9\u9663\u4e2d\u5132\u5b58 \u5f88\u5c11 \u7684\u5143\u7d20\u6642\uff0c\u7a7a\u9593\u4f7f\u7528\u6548\u7387\u5f88\u4f4e</li> <li>\u9700\u4e8b\u5148\u5ba3\u544a\u77e9\u9663\u5927\u5c0f</li> <li>\u8abf\u6574\u77e9\u9663\u5927\u5c0f\uff0c\u76f8\u7576\u8017\u6642</li> <li>\u63d2\u5165\u3001\u522a\u9664\u5143\u7d20\uff0c\u9700\u8981\u4f4d\u79fb\u5176\u4ed6\u5143\u7d20\uff0c\u6545\u79fb\u52d5\u6210\u672c\u9ad8</li> </ul> </li> </ul> </li> <li>\u5e38\u898b\u61c9\u7528\u60c5\u5883<ul> <li>\u52d5\u614b\u898f\u5283\u6f14\u7b97\u6cd5: \u77e9\u9663\u7d93\u5e38\u7528\u65bc\u57fa\u65bcDP\u7684\u554f\u984c\u4f86\u5132\u5b58\u5df2\u8a08\u7b97\u72c0\u614b\u7684\u7b54\u6848</li> <li>\u5f71\u50cf\u8655\u7406: \u5f71\u50cf\u53ef\u4ee5\u8868\u793a\u70ba\u50cf\u7d20\u77e9\u9663\uff0c\u5176\u4e2d\u6bcf\u500b\u50cf\u7d20\u5c0d\u61c9\u65bc\u77e9\u9663\u4e2d\u7684\u4e00\u500b\u5143\u7d20\u3002\u9019\u6709\u52a9\u65bc\u5c0d\u5f71\u50cf\u57f7\u884c\u4e0d\u540c\u7684\u64cd\u4f5c</li> <li>\u6a5f\u5668\u4eba\u6280\u8853: \u5728\u6a5f\u5668\u4eba\u6280\u8853\u4e2d\uff0c\u77e9\u9663\u7528\u65bc\u8868\u793a\u6a5f\u5668\u4eba\u53ca\u5176\u672b\u7aef\u57f7\u884c\u5668\u7684\u4f4d\u7f6e\u3001\u65b9\u5411\u3002\u5b83\u5011\u7528\u65bc\u8a08\u7b97\u6a5f\u5668\u624b\u81c2\u7684\u904b\u52d5\u5b78\u548c\u52d5\u529b\u5b78\uff0c\u4e26\u898f\u5283\u5176\u8ecc\u8de1</li> <li>\u4ea4\u901a\u904b\u8f38\u548c\u7269\u6d41: \u4ea4\u901a\u904b\u8f38\u3001\u7269\u6d41\u4e2d\uff0c\u4f7f\u7528\u77e9\u9663\u4f86\u8868\u793a\u904b\u8f38\u7db2\u8def\uff0c\u4e26\u89e3\u6c7a\u904b\u8f38\u554f\u984c\u3001\u5206\u914d\u554f\u984c...\u7b49\u6700\u4f73\u5316\u554f\u984c</li> <li>\u91d1\u878d: \u77e9\u9663\u5728\u91d1\u878d\u4e2d\u7528\u4f86\u8868\u793a\u8cc7\u7522\u7d44\u5408\uff0c\u8a08\u7b97\u6295\u8cc7\u7684\u98a8\u96aa\u548c\u56de\u5831\uff0c\u4e26\u57f7\u884c\u8cc7\u7522\u914d\u7f6e\u3001\u6700\u4f73\u5316\u7b49\u64cd\u4f5c</li> <li>\u7dda\u6027\u4ee3\u6578: \u77e9\u9663\u5ee3\u6cdb\u61c9\u7528\u65bc\u7dda\u6027\u4ee3\u6578\uff0c\u7dda\u6027\u4ee3\u6578\u662f\u8655\u7406\u7dda\u6027\u65b9\u7a0b\u5f0f\u3001\u5411\u91cf\u7a7a\u9593\u3001\u7dda\u6027\u8b8a\u63db\u7684\u6578\u5b78\u5206\u652f\u3002\u77e9\u9663\u7528\u65bc\u8868\u793a\u7dda\u6027\u65b9\u7a0b\u5f0f\u4e26\u6c42\u89e3\u7dda\u6027\u65b9\u7a0b\u7d44</li> </ul> </li> <li>\u5ba3\u544a &amp; \u521d\u59cb\u5316<ul> <li>\u82e5\u77e9\u9663\u50c5\u5ba3\u544a\uff0c\u4f46\u5c1a\u672a\u521d\u59cb\u5316\uff0c\u6839\u64da\u4e0d\u540c\u8cc7\u6599\u578b\u5225\uff0c\u6bcf\u683c\u5143\u7d20\u6703\u6709\u4e0d\u540c\u7684\u9810\u8a2d\u503c<ul> <li>\u6574\u6578(int, short, long, byte): 0</li> <li>\u6d6e\u9ede\u6578(float, double): 0.0</li> <li>\u5e03\u6797\u503c(boolean): false</li> <li>\u5b57\u5143(char): <code>\\u0000</code>(= null \u5b57\u5143) Java<pre><code>// \u5ba3\u544a\nint number_of_rows = 3, number_of_columns = 3;\nint[][] arr1 = new int[number_of_rows][number_of_columns];\n// \u521d\u59cb\u5316\narr1[0][1] = 2;\n// \u540c\u6642\u5ba3\u544a + \u521d\u59cb\u5316\nint arr2[][] = { { 1, 2, 3 }, { 4, 5, 6 }, { 7, 8, 9 } };\n</code></pre></li> </ul> </li> </ul> </li> <li>\u5e38\u898b\u64cd\u4f5c<ul> <li>\u5b58\u53d6\u77e9\u9663\u7684\u5143\u7d20     Java<pre><code>int[][] arr = { { 1, 2, 3 }, { 4, 5, 6 }, { 7, 8, 9 } };\nSystem.out.println(arr[1][2]); // 6\n</code></pre></li> <li>\u904d\u6b77\u77e9\u9663\u5143\u7d20     Java<pre><code>int[][] arr = { { 1, 2, 3, 4 }, { 5, 6, 7, 8 }, { 9, 10, 11, 12 } };\n// \u5148\u904d\u6b77 rows\nfor (int i = 0; i &lt; 3; i++) {\n    // \u518d\u904d\u6b77 columns\n    for (int j = 0; j &lt; 4; j++) {\n        System.out.print(arr[i][j] + \", \");\n    }\n    System.out.println();\n}\n</code></pre> </li> <li>\u5728\u77e9\u9663\u4e2d\u641c\u5c0b     Java<pre><code>public class MyClass {\n    public static void main(String[] args) {\n        int target = 8;\n        int[][] arr = {\n            {0, 6, 8, 9, 11},\n            {20, 22, 28, 29, 31},\n            {36, 38, 50, 61, 63},\n            {64, 66, 100, 122, 128}\n        };\n\n        if (searchInMatrix(arr, target)) {\n            System.out.println(\"found\");\n        } else {\n            System.out.println(\"not found\");\n        }\n    }\n\n    public static boolean searchInMatrix(int[][] arr, int target) {\n        int row = arr.length;\n        int col = arr[0].length;\n\n        for (int i = 0; i &lt; row; i++) {\n            for (int j = 0; j &lt; col; j++) {\n                if (arr[i][j] == target) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n}\n</code></pre></li> <li>\u8f49\u7f6e\u77e9\u9663 (transpose)<ul> <li>\u8f49\u7f6e: \u884c &lt;-&gt; \u5217 (row &lt;-&gt; column)     </li> <li>\u6cd5 1: \u901a\u7528\u60c5\u6cc1     Java<pre><code>// \u5c07 A \u8f49\u7f6e\u70ba B \u77e9\u9663\nstatic void transpose(int A[][], int B[][]) \n{ \n    int Arows = A.length;    // A \u77e9\u9663\u7684\u884c\u6578\n    int Acols = A[0].length; // A \u77e9\u9663\u7684\u5217\u6578\n\n    // Tips: \u5148\u904d\u6b77 A \u77e9\u9663\u7684\u5217 (\u56e0\u70ba\u662f\u8981\u5c07 A \u77e9\u9663\u7684\u5217\uff0c\u8f49\u6210 B \u77e9\u9663\u7684\u884c)\n    for (int i = 0; i &lt; Acols; i++) {\n        // Tips: \u518d\u904d\u6b77 A \u77e9\u9663\u7684\u884c\n        for (int j = 0; j &lt; Arows; j++) {\n            B[i][j] = A[j][i];\n        }\n    }\n}\n\npublic static void main(String[] args) \n{ \n    // \u9577\u65b9\u5f62\u77e9\u9663 (4*3)\n    int A[][] = { { 1, 1, 1 }, \n                { 2, 2, 2 }, \n                { 3, 3, 3 }, \n                { 4, 4, 4 } }; \n    // \u521d\u59cb\u5316 B \u77e9\u9663 = A[\u5217\u6578][\u884c\u6578]\n    int B[][] = new int[A[0].length][A.length]; \n    transpose(A, B); \n\n    System.out.println(\"\u8f49\u7f6e\u5f8c\u7684\u77e9\u9663\");\n    // \u5370\u51fa B \u77e9\u9663\u4e2d\u7684\u6bcf\u4e00\u683c\u5143\u7d20\n    // \u5148\u904d\u6b77 row\uff0c\u56e0\u70ba B[][] \u662f 2 \u7dad\u9663\u5217\uff0c\u6545 B.length = \u884c\u6578 (row)\n    for (int i = 0; i &lt; B.length; i++) {\n        // \u518d\u904d\u6b77\u8a72 row \u7684\u6bcf\u4e00\u683c column \u7684\u5143\u7d20\n        for (int j = 0; j &lt; B[i].length; j++) {\n            System.out.print(B[i][j] + \", \");\n        }\n        System.out.println(\"\"); \n    }\n}\n</code></pre> </li> <li>\u6cd5 2: \u77e9\u9663\u70ba\u6b63\u65b9\u5f62(n x n)\uff0c\u884c\u6578\u8207\u5217\u6578\u76f8\u540c<ul> <li>\u63a1\u539f\u5730\u6392\u5e8f\u6f14\u7b97\u6cd5 (in-place)<ul> <li>Time complexity: O(\\(n^{2}\\))</li> <li>Space complexity: O(1) Java<pre><code>// \u6b63\u65b9\u5f62\u77e9\u9663\u7684\u908a\u9577(\u5143\u7d20\u500b\u6578)\nstatic final int N = 4; \n\n// \u63a1\u539f\u5730\u6392\u5e8f\u6f14\u7b97\u6cd5\uff0c\u8f49\u7f6e\u77e9\u9663 (\u56e0\u70ba\u63a1\u539f\u5730\u6392\u5e8f\uff0c\u6545\u53c3\u6578\u53ea\u9700\u8981\u4e00\u500b\u77e9\u9663 A[][])\nstatic void transpose(int A[][]) \n{\n    for (int i = 0; i &lt; N; i++) \n        for (int j = i + 1; j &lt; N; j++) { \n            int temp = A[i][j]; \n            A[i][j] = A[j][i]; \n            A[j][i] = temp; \n        } \n} \n\npublic static void main(String[] args) \n{ \n    int A[][] = { { 1, 1, 1, 1 }, \n                { 2, 2, 2, 2 }, \n                { 3, 3, 3, 3 }, \n                { 4, 4, 4, 4 } }; \n    transpose(A);\n\n    System.out.println(\"\u8f49\u7f6e\u5f8c\u7684\u77e9\u9663\"); \n    for (int i = 0; i &lt; N; i++) { \n        for (int j = 0; j &lt; N; j++) {\n            System.out.print(A[i][j] + \", \"); \n        }\n        System.out.println(\"\");\n    } \n}\n</code></pre> </li> </ul> </li> </ul> </li> </ul> </li> <li>\u5c0d\u77e9\u9663\u7684\u884c or \u5217\u5143\u7d20\uff0c\u9032\u884c\u6392\u5e8f<ul> <li>\u884c\u6392\u5e8f (row)<ul> <li>\u6cd5 1: \u4f7f\u7528 <code>Arrays.sort()</code> Java<pre><code>import java.io.*;\nimport java.util.Arrays;  // \u8a18\u5f97\u5f15\u7528 Arrays package\n\npublic class MyClass {\npublic static void sortRowWise(int arr[][])\n{\n    for (int i = 0; i &lt; arr.length; i++) {\n        Arrays.sort(arr[i]);\n    }\n\n    for (int i = 0; i &lt; arr.length; i++) {\n        for (int j = 0; j &lt; arr[i].length; j++) {\n            System.out.print(arr[i][j] + \", \");\n        }\n        System.out.println();\n    }\n}\n\npublic static void main(String args[])\n{\n    int arr[][] = { { 9, 8, 7, 1 },\n                { 7, 3, 0, 2 },\n                { 9, 5, 3, 2 },\n                { 6, 3, 1, 2 } };\n\n    sortRowWise(arr);\n}\n}\n</code></pre> </li> </ul> </li> <li>\u5217\u6392\u5e8f (column)<ul> <li>\u6b65\u9a5f 1: \u5c07 A \u8f49\u7f6e\u70ba B \u77e9\u9663</li> <li>\u6b65\u9a5f 2: \u6392\u5e8f B \u77e9\u9663\u7684\u884c\u5143\u7d20 (row)</li> <li>\u6b65\u9a5f 3: \u518d\u5c07 B \u77e9\u9663\u8f49\u7f6e\u70ba\u65b0\u7684 C \u77e9\u9663 Java<pre><code>public static void main(String[] args)\n{\n    int[][] A = { { 1, 6, 10 },\n                { 8, 5, 9 },\n                { 9, 4, 15 },\n                { 7, 3, 60 } };\n\n    int Arows = A.length;\n    int Acols = A[0].length;\n    // \u6b65\u9a5f 1: \u5c07 A \u8f49\u7f6e\u70ba B \u77e9\u9663\n    int[][] B = transpose(A, Arows, Acols);\n    int Brows = B.length;\n    int Bcols = B[0].length;\n\n    // \u6b65\u9a5f 2: \u6392\u5e8f B \u77e9\u9663\u7684\u884c\u5143\u7d20 (row)\n    RowWiseSort(B);\n\n    // \u6b65\u9a5f 3: \u518d\u5c07 B \u77e9\u9663\u8f49\u7f6e\u70ba\u65b0\u7684 C \u77e9\u9663\n    int[][] C = transpose(B, Brows, Bcols);\n    int Crows = C.length;\n    int Ccols = C[0].length;\n\n    // \u5370\u51fa\u7d50\u679c\n    System.out.println(\"\u8f49\u7f6e\u5f8c\u7684\u77e9\u9663\");\n    for(int i = 0; i &lt; Crows; i++) \n    {\n        for(int j = 0; j &lt; Ccols; j++) \n        {\n            System.out.print(C[i][j] + \", \");\n        }\n        System.out.println(\"\");\n    }\n}\n\n// \u8f49\u7f6e\u77e9\u9663\nstatic int[][] transpose(int[][] A, int Arows, int Acols) {\n    // \u521d\u59cb\u5316 B \u77e9\u9663 = A[\u5217\u6578][\u884c\u6578]\n    int[][] B = new int[Acols][Arows];\n\n    // \u904d\u6b77 row\n    for(int i = 0; i &lt; Arows; i++) {\n        // \u904d\u6b77 column\n        for(int j = 0; j &lt; Acols; j++) {\n            // \u8f49\u7f6e\u77e9\u9663\u4e2d\u7684\u6bcf\u4e00\u683c\u5143\u7d20\n            B[j][i] = A[i][j];\n        }\n    }\n\n    return B;\n}\n\n// \u6392\u5e8f\u884c\u5143\u7d20 (row)\nstatic void RowWiseSort(int[][] B)\n{\n    // \u904d\u6b77 row\n    for(int i = 0; i &lt; B.length; i++) {\n        Arrays.sort(B[i]);\n    }\n}\n</code></pre> </li> </ul> </li> </ul> </li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599<ul> <li>GeeksForGeeks-Matrix Data Structure</li> <li>GeeksForGeeks-Introduction to Matrix or Grid Data Structure \u2013 Two Dimensional Array</li> </ul> </li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#tree","title":"\u6a39(Tree)","text":"<ul> <li>\u57fa\u672c\u6982\u5ff5<ul> <li>\u968e\u5c64\u5f0f\u8cc7\u6599\u7d50\u69cb: \u7531\u7bc0\u9ede(node)\u3001\u908a(edge)\u7d44\u6210\uff0c\u4ee5\u908a\u9023\u7d50\u7bc0\u9ede\uff0c\u7bc0\u9ede\u4e4b\u9593\u6709\u968e\u5c64\u95dc\u4fc2</li> <li>\u6613\u65bc\u641c\u5c0b\u5143\u7d20  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li>\u8853\u8a9e\u8868<ul> <li>\u5b50\u6a39 (subtree): \u5305\u542b\u6240\u6709\u5b50\u7bc0\u9ede\u7684\u6a39</li> <li>\u6839\u7bc0\u9ede (root node): \u6a39\u7684\u6700\u4e0a\u5c64\u7bc0\u9ede</li> <li>\u7236\u7bc0\u9ede (parent node): \u67d0\u7bc0\u9ede\u7684 \u5148\u7e7c \u7bc0\u9ede</li> <li>\u5b50\u7bc0\u9ede (child node): \u67d0\u7bc0\u9ede\u7684 \u76f4\u63a5\u5f8c\u7e7c \u7bc0\u9ede</li> <li>\u8449\u7bc0\u9ede (leaf node/external node): \u6c92\u6709\u5b50\u7bc0\u9ede\u7684\u7bc0\u9ede</li> <li>\u5167\u90e8\u7bc0\u9ede (internal node): \u81f3\u5c11\u6709\u4e00\u500b\u5b50\u7bc0\u9ede\u7684\u7bc0\u9ede</li> <li>\u7956\u5148 (ancestor): \u5f9e\u6839\u5230\u8a72\u7bc0\u9ede\u7684\u8def\u5f91\u4e0a\u7684\u4efb\u4f55\u5148\u7e7c\u7bc0\u9ede\uff0c\u90fd\u7a31\u70ba\u8a72\u7bc0\u9ede\u7684\u7956\u5148<ul> <li>e.g. { A, B } \u662f\u7bc0\u9ede { E } \u7684\u7956\u5148\u7bc0\u9ede</li> </ul> </li> <li>\u5f8c\u4ee3 (descendant): \u5f9e\u8a72\u7bc0\u9ede\u5230\u4efb\u4f55\u8449\u7bc0\u9ede\u7684\u8def\u5f91\u4e0a\u7684\u6240\u6709\u5f8c\u7e7c\u7bc0\u9ede\uff0c\u90fd\u7a31\u70ba\u8a72\u7bc0\u9ede\u7684\u5f8c\u4ee3<ul> <li>e.g. \u7bc0\u9ede { E } \u662f { A, B } \u7684\u5f8c\u4ee3\u7bc0\u9ede</li> </ul> </li> <li>\u5144\u5f1f (sibling): \u5177\u6709\u76f8\u540c\u7236\u7bc0\u9ede\u7684\u7bc0\u9ede\u5011</li> <li>\u9130\u5c45 (neighbor): \u8a72\u7bc0\u9ede\u7684\u7236\u7bc0\u9ede or \u5b50\u7bc0\u9ede</li> </ul> </li> <li> <p>Tree \u7684\u5c6c\u6027</p> <ul> <li>\u5c64\u7d1a (level): \u5f9e\u6839\u7bc0\u9ede \uff5e \u8a72\u7bc0\u9ede\u7684\u8def\u5f91\u4e0a\u7684\u908a\u6578<ul> <li>e.g. root level \u53ef\u70ba 0 \u6216 1</li> </ul> </li> <li>\u5206\u53c9\u5ea6 (degree): \u6bcf\u500b\u7bc0\u9ede\u7684\u5b50\u7bc0\u9ede\u6578<ul> <li>e.g. \u8449\u7bc0\u9ede\u7684 degree = 0</li> </ul> </li> <li>\u6a39\u7684\u908a\u6578 (edges): \u5169\u500b\u7bc0\u9ede\u4e4b\u9593\u7684\u9023\u63a5\uff0c\u5f9e\u6a39\u7684\u6bcf\u500b\u7bc0\u9ede\u5230\u4efb\u4f55\u5176\u4ed6\u7bc0\u9ede\u53ea\u6709\u4e00\u689d\u8def\u5f91<ul> <li>e.g. \u82e5\u4e00\u68f5\u6a39\u6709 N \u500b\u7bc0\u9ede\uff0c\u90a3\u9ebc\u5b83\u5c07\u6709 N-1 \u689d\u908a</li> </ul> </li> <li>\u7bc0\u9ede\u6df1\u5ea6 (depth): \u7528\u65bc\u63cf\u8ff0 \u7bc0\u9ede\u5728\u6a39\u4e2d\u7684\u5c64\u6b21 (\u5f9e\u6839\u7bc0\u9ede \uff5e \u7576\u524d\u7bc0\u9ede\uff0c\u6240\u7d93\u904e\u7684\u908a\u6578)</li> <li> <p>\u7bc0\u9ede\u9ad8\u5ea6 (height): \u7528\u65bc\u63cf\u8ff0 \u5f9e\u7bc0\u9ede \uff5e \u5176\u5f8c\u4ee3\u4e2d\u6700\u9060\u8449\u7bc0\u9ede\u7684\u8ddd\u96e2 (\u5f9e\u7576\u524d\u7bc0\u9ede \uff5e \u6700\u9060\u8449\u7bc0\u9ede\uff0c\u6240\u7d93\u904e\u7684\u908a\u6578)</p> <p> \u5716\u7247\u51fa\u8655</p> </li> </ul> </li> <li> <p>Tree \u7684\u5206\u985e      \u5716\u7247\u51fa\u8655</p> </li> <li>Tree \u8d70\u8a2a (traversal)  \u5716\u7247\u51fa\u8655<ul> <li>\u524d\u5e8f\u8d70\u8a2a (Preorder)<ul> <li>\u6839 -&gt; \u5de6 -&gt; \u53f3  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li>\u4e2d\u5e8f\u8d70\u8a2a (Inorder)<ul> <li>\u5de6 -&gt; \u6839 -&gt; \u53f3  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li>\u5f8c\u5e8f\u8d70\u8a2a (Postorder)<ul> <li>\u5de6 -&gt; \u53f3 -&gt; \u6839  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li>\u5c64\u5e8f\u8d70\u8a2a (Level Order)<ul> <li>\u7531\u4e0a\u81f3\u4e0b\uff0c\u7531\u5de6\u81f3\u53f3  \u5716\u7247\u51fa\u8655</li> </ul> </li> </ul> </li> <li>\u7279\u6027<ul> <li>\u512a\u9ede<ul> <li>\u9ad8\u6548\u641c\u5c0b: \u6839\u64da\u6a39\u7684\u985e\u578b\uff0c\u5e73\u8861\u6a39\u5982 AVL \u6a39\u7684\u5e73\u5747\u641c\u5c0b\u6642\u9593\u70ba O(logN)</li> <li>\u5c64\u6b21\u7d50\u69cb\u8868\u793a: \u4f7f\u5f97\u7d44\u7e54, \u5c0b\u627e\u5927\u91cf\u4fe1\u606f\u8b8a\u5f97\u66f4\u5bb9\u6613</li> <li>\u5929\u7136\u905e\u8ff4\u7279\u6027: \u6613\u65bc\u4f7f\u7528\u905e\u8ff4\u7b97\u6cd5\uff0c\u9032\u884c\u904d\u6b77\u3001\u64cd\u4f5c</li> </ul> </li> <li>\u7f3a\u9ede<ul> <li>\u4e0d\u5e73\u8861\u6a39: \u6a39\u7684\u9ad8\u5ea6\u504f\u5411\u4e00\u5074\uff0c\u53ef\u80fd\u5c0e\u81f4\u641c\u5c0b\u6642\u9593\u6548\u7387\u8b8a\u5dee</li> <li>\u5167\u5b58\u9700\u6c42: \u76f8\u6bd4\u65bc\u5176\u5b83\u8cc7\u6599\u7d50\u69cb\uff0c\u5982: Array, Linked List\uff0cTree \u6703\u9700\u8981\u7528\u5230\u66f4\u591a\u7684\u8a18\u61b6\u9ad4\u7a7a\u9593\uff0c\u5c24\u5176\u662f\u5728\u6a39\u975e\u5e38\u5927\u7684\u60c5\u6cc1\u4e0b</li> <li>\u5be6\u73fe\u8907\u96dc: \u6a39\u7684\u5be6\u73fe, \u64cd\u4f5c\u8f03\u8907\u96dc\uff0c\u4e26\u4e14\u9700\u8981\u5c0d\u6f14\u7b97\u6cd5\u6709\u826f\u597d\u7684\u7406\u89e3</li> </ul> </li> </ul> </li> <li>\u5e38\u898b\u61c9\u7528\u60c5\u5883<ul> <li>\u6a94\u6848\u7cfb\u7d71</li> <li>\u8cc7\u6599\u5eab\u7d22\u5f15: B-tree, B+ tree</li> <li>XML \u6587\u4ef6</li> <li>\u4eba\u5de5\u667a\u6167</li> <li>\u8cc7\u6599\u58d3\u7e2e: Huffman tree</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599<ul> <li>GeeksForGeeks-Tree Data Structure</li> <li>GeeksForGeeks-Introduction to Tree \u2013 Data Structure and Algorithm Tutorials</li> </ul> </li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#heap","title":"\u5806\u7a4d (Heap)","text":"<ul> <li>\u57fa\u672c\u6982\u5ff5<ul> <li>\u662f\u4e00\u68f5\u5b8c\u6574\u4e8c\u5143\u6a39(Complete Binary Tree)\uff0c\u4e14\u6eff\u8db3 \u5806\u7a4d\u6027\u8cea<ul> <li>\u5806\u7a4d\u6027\u8cea: \u6bcf\u500b\u7bc0\u9ede\u503c\u90fd &gt;= \u6216 &lt;= \u5176\u5b50\u7bc0\u9ede\u503c\uff0c\u4e14 \u6839\u7bc0\u9ede\u503c \u70ba \u6700\u5927(Max Heap) \u6216 \u6700\u5c0f(Min Heap)</li> </ul> </li> <li>\u901a\u5e38\u7528\u65bc\u5be6\u4f5c \u512a\u5148\u4f47\u5217(Priority Queue)</li> <li>\u5728 Java \u4e2d\uff0c\u53ef\u4f7f\u7528 java.util.PriorityQueue class \u4f86\u5efa\u7acb Heap</li> </ul> </li> <li>Heap \u7684\u985e\u578b<ul> <li>\u6700\u5c0f\u5806\u7a4d(Min Heap): \u6bcf\u500b\u7bc0\u9ede\u503c \u5728\u5176 \u6574\u500b\u5b50\u6a39\u4e2d\u5fc5\u9808\u662f\u6700\u5c0f\u7684</li> <li>\u6700\u5927\u5806\u7a4d(Max Heap): \u6bcf\u500b\u7bc0\u9ede\u503c \u5728\u5176 \u6574\u500b\u5b50\u6a39\u4e2d\u5fc5\u9808\u662f\u6700\u5927\u7684 \u5716\u7247\u51fa\u8655</li> </ul> </li> <li>Heap \u7684\u57fa\u672c\u64cd\u4f5c<ul> <li>Heapify: \u5c07\u4efb\u610f\u4e00\u500b\u4e8c\u5143\u6a39\u8f49\u63db\u70ba Heap      \u5716\u7247\u51fa\u8655</li> <li>\u65b0\u589e\u5143\u7d20: \u5c07\u5143\u7d20\u63d2\u5165 Heap\uff0c\u4e26\u4fdd\u6301 Heap \u7684\u6027\u8cea      \u5716\u7247\u51fa\u8655</li> <li>\u53d6\u51fa\u6700\u5927\u503c/\u6700\u5c0f\u503c: \u53d6\u51fa Heap \u7684\u6839\u7bc0\u9ede\u503c\uff0c\u4e26\u4fdd\u6301 Heap \u7684\u6027\u8cea      \u5716\u7247\u51fa\u8655</li> <li>\u66f4\u65b0\u7279\u5b9a\u7bc0\u9ede\u503c: \u66f4\u65b0 Heap \u4e2d\u7684\u7279\u5b9a\u7bc0\u9ede\u503c\uff0c\u4e26\u4fdd\u6301 Heap \u7684\u6027\u8cea</li> </ul> </li> <li>\u7279\u6027<ul> <li>\u512a\u9ede<ul> <li>\u80fd\u5feb\u901f\u627e\u51fa\u6700\u5927/\u6700\u5c0f\u503c: O(1)</li> <li>\u9ad8\u6548\u7684\u63d2\u5165, \u522a\u9664\u5143\u7d20: O(logN)</li> <li>\u53ef\u7528\u9663\u5217\u4f86\u5be6\u4f5c</li> <li>\u9069\u5408\u5373\u6642\u61c9\u7528\u7a0b\u5f0f</li> </ul> </li> <li>\u7f3a\u9ede<ul> <li>\u7576\u641c\u5c0b\u975e\u6700\u5927/\u6700\u5c0f\u503c\u6642\uff0c\u6548\u7387\u8f03\u5dee: O(N)</li> <li>\u9700\u8981\u984d\u5916\u7684\u8a18\u61b6\u9ad4\u7a7a\u9593\uff0c\u4f86\u5efa\u7acb Heap</li> <li>\u5c0d\u65bc\u975e priority queue \u61c9\u7528\uff0cHeap \u4e0d\u9069\u7528 (\u6bd4 Array, Linked List \u6162)</li> </ul> </li> </ul> </li> <li>\u5e38\u898b\u61c9\u7528\u60c5\u5883<ul> <li>\u5be6\u4f5c Priority Queue</li> <li>\u6392\u5e8f\u9663\u5217\u4e2d\u7684\u5143\u7d20: heap sort<ul> <li>\u7531\u5c0f \uff5e \u5927: Min Heap</li> <li>\u7531\u5927 \uff5e \u5c0f: Max Heap</li> </ul> </li> <li>Graph \u6f14\u7b97\u6cd5<ul> <li>\u5c0b\u627e\u6700\u77ed\u8def\u5f91\u554f\u984c(finding the shortest paths ): Dijkstra \u6f14\u7b97\u6cd5</li> <li>\u627e\u51fa\u6700\u5c0f\u64f4\u5c55\u6a39(minimum spanning trees): Prim \u6f14\u7b97\u6cd5</li> </ul> </li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599<ul> <li>GeeksForGeeks-Heap Data Structure</li> <li>GeeksForGeeks-Introduction to Heap \u2013 Data Structure and Algorithm Tutorials</li> </ul> </li> </ul>"},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#_7","title":"\u6f14\u7b97\u6cd5","text":""},{"location":"coding_interview/geeks_for_geeks/dsa_tutorial/#_8","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>Learn Data Structures and Algorithms | DSA Tutorial</li> </ul>"},{"location":"coding_interview/leetcode/leetcode75/","title":"LeetCode 75 \u984c","text":"<p>\u7531 LeetCode 75 \u6240\u6574\u7406\u7684\u7d93\u5178 75 \u984c\uff0c\u672c\u7bc7\u63a1 Java \u4f5c\u70ba\u4e3b\u8981\u4f7f\u7528\u7684\u7a0b\u5f0f\u8a9e\u8a00</p>"},{"location":"coding_interview/neetcode/core_skills/algorithm/","title":"Algorithm","text":"<p>\u7531 NeetCode75 \u6240\u6574\u7406\u7684\u5e38\u7528\u6f14\u7b97\u6cd5\uff0c\u672c\u7bc7\u63a1 Java \u4f5c\u70ba\u4e3b\u8981\u4f7f\u7528\u7684\u7a0b\u5f0f\u8a9e\u8a00</p>"},{"location":"coding_interview/neetcode/core_skills/data_structure/","title":"Data Structure","text":"<p>\u7531 NeetCode75 \u6240\u6574\u7406\u7684\u5e38\u7528 DS\uff0c\u672c\u7bc7\u63a1 Java \u4f5c\u70ba\u4e3b\u8981\u4f7f\u7528\u7684\u7a0b\u5f0f\u8a9e\u8a00</p> \u76ee\u9304<ul> <li>Data Structure</li> <li>Implement Data Structures<ul> <li>Design Dynamic Array (Resizable Array)</li> <li>Design Singly Linked List</li> <li>Design Double-ended Queue</li> <li>Design Binary Search Tree</li> <li>Design Hash Table</li> <li>Design Heap</li> <li>Design Graph</li> <li>Design Disjoint Set (Union-Find)</li> <li>Design Segment Tree</li> </ul> </li> </ul>"},{"location":"coding_interview/neetcode/core_skills/data_structure/#implement-data-structures","title":"Implement Data Structures","text":""},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-dynamic-array-resizable-array","title":"Design Dynamic Array (Resizable Array)","text":"<p>\u6ce8\u610f   - The index <code>i</code> provided to <code>get(int i)</code> and <code>set(int i)</code> is guranteed to be greater than or equal to 0 and less than the number of elements in the array. Java<pre><code>class DynamicArray {\n  private int[] arr;\n  // \u9663\u5217\u4e2d\u7684\u5be6\u969b\u5143\u7d20\u500b\u6578\n  private int size;\n\n  public DynamicArray(int capacity) {\n    this.arr = new int[capacity];\n    this.size = 0;\n  }\n\n  // Get value at the i-th index\n  public int get(int i) {\n    if (i &lt; 0 || i &gt; size-1) {\n      throw new IndexOutOfBoundsException(\"Index is illegal.\");\n    }\n\n    return arr[i];\n  }\n\n  // Insert value n at the i-th index\n  public void set(int i, int n) {\n    if (i &lt; 0 || i &gt; size-1) {\n      throw new IndexOutOfBoundsException(\"Index is illegal.\");\n    }\n    arr[i] = n;\n  }\n\n  // Insert n in the last position of the array\n  public void pushback(int n) {\n    if (size == arr.length) {\n      resize();\n    }\n    arr[size++] = n;\n  }\n\n  // Remove the last element in the array\n  public int popback() {\n    if (size == 0) {\n      throw new IllegalStateException(\"Cannot pop from an empty array.\");\n    }\n\n    return arr[--size];\n  }\n\n  // Resize the array\n  private void resize() {\n    int newCapacity = arr.length * 2;\n    int[] newArr = new int[newCapacity];\n    System.arraycopy(arr, 0, newArr, 0, this.size);\n    arr = newArr;\n  }\n\n  // Get the size of the array\n  public int getSize() {\n      return size;\n  }\n\n  // Get the capacity of the array\n  public int getCapacity() {\n      return arr.length;\n  }\n}\n</code></pre></p>"},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-singly-linked-list","title":"Design Singly Linked List","text":""},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-double-ended-queue","title":"Design Double-ended Queue","text":""},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-binary-search-tree","title":"Design Binary Search Tree","text":""},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-hash-table","title":"Design Hash Table","text":""},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-heap","title":"Design Heap","text":""},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-graph","title":"Design Graph","text":""},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-disjoint-set-union-find","title":"Design Disjoint Set (Union-Find)","text":""},{"location":"coding_interview/neetcode/core_skills/data_structure/#design-segment-tree","title":"Design Segment Tree","text":""},{"location":"coding_interview/neetcode/core_skills/design_pattern/","title":"Design Pattern","text":"<p>\u7531 NeetCode75 \u6240\u6574\u7406\u7684\u8a2d\u8a08\u6a21\u5f0f\uff0c\u672c\u7bc7\u63a1 Java \u4f5c\u70ba\u4e3b\u8981\u4f7f\u7528\u7684\u7a0b\u5f0f\u8a9e\u8a00</p>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/","title":"Coding Interview Preparation","text":"<ul> <li>\u7531 Blind 75 \u4f5c\u8005\u6240\u6574\u7406 coding interview \u7684\u5e38\u8003 75 \u984c</li> <li>\u672c\u7bc7\u63a1 Java \u4f5c\u70ba\u4e3b\u8981\u4f7f\u7528\u7684\u7a0b\u5f0f\u8a9e\u8a00</li> </ul> \u76ee\u9304<ul> <li>Coding Interview Preparation<ul> <li>Array<ul> <li>\u5c08\u6709\u540d\u8a5e</li> <li>\u6ce8\u610f\u4e8b\u9805</li> <li>\u89e3\u984c\u6280\u5de7<ul> <li>\u6ed1\u52d5\u8996\u7a97 (Sliding Window)</li> <li>\u96d9\u6307\u6a19(Two pointers)</li> <li>\u5f9e\u53f3\u908a\u958b\u59cb\u904d\u6b77 (Traversing from the right)</li> <li>\u6392\u5e8f\u9663\u5217 (Sorting the array)</li> <li>\u9810\u5148\u8a08\u7b97 (Precomputation)</li> <li>\u5c07\u9663\u5217\u7d22\u5f15\u4f5c\u70ba HashMap \u7684 key \u4f7f\u7528 (Index as a hash key)</li> <li>\u591a\u6b21\u904d\u6b77\u9663\u5217 (Traversing the array more than once)</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> <li>Tree<ul> <li>\u4e8c\u5143\u6a39 (Binary Tree, BT)</li> <li>\u4e8c\u5143\u641c\u5c0b\u6a39 (Binary Search Tree, BST)</li> <li>\u6ce8\u610f\u4e8b\u9805 &amp; \u6975\u7aef\u60c5\u6cc1</li> <li>\u5e38\u898b\u6163\u4f8b</li> <li>\u89e3\u984c\u6280\u5de7</li> <li>\u57fa\u672c\u984c\u578b</li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> <li>Heap<ul> <li>Heap \u7684\u985e\u578b</li> <li>\u5be6\u4f5c\u65b9\u5f0f</li> <li>\u5404\u9805\u64cd\u4f5c\u7684\u6642\u9593\u8907\u96dc\u5ea6</li> <li>PriorityQueue \u7684\u5404\u9805\u64cd\u4f5c</li> <li>\u89e3\u984c\u6280\u5de7</li> <li>\u57fa\u672c\u984c\u578b</li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#array","title":"Array","text":""},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_1","title":"\u5c08\u6709\u540d\u8a5e","text":"<ul> <li>Subarray: \u5728\u539f\u9663\u5217\u4e2d\u7684\u4e00\u6bb5 \u9023\u7e8c\u5143\u7d20 Java<pre><code>int[] arr = { 2, 3, 6, 1, 5, 4 };\n// Subarray: { 3, 6, 1 }\n// \u4e0d\u662f Subarray: { 3, 1, 5 }\n</code></pre></li> <li>Subsequence: \u53ef\u4ee5\u900f\u904e\u522a\u9664/\u4e0d\u522a\u9664\u5143\u7d20\uff0c\u800c \u4e0d\u5f71\u97ff\u5269\u9918\u5143\u7d20\u7684\u9806\u5e8f Java<pre><code>int[] arr = { 2, 3, 6, 1, 5, 4 };\n// Subsequence: { 3, 1, 5 };\n// \u4e0d\u662f Subsequence: { 3, 5, 1 }\n</code></pre></li> <li>non-decreasing order: \u9663\u5217\u4e2d\u7684\u5143\u7d20\u503c\u662f \u975e\u905e\u6e1b \u7684\uff0c\u5373\u5143\u7d20\u503c \u53ef\u4ee5\u76f8\u7b49 or \u905e\u589e (e.g. { 1, 2, 2, 3, 4 })</li> <li>non-increasing order: \u9663\u5217\u4e2d\u7684\u5143\u7d20\u503c\u662f \u975e\u905e\u589e \u7684\uff0c\u5373\u5143\u7d20\u503c \u53ef\u4ee5\u76f8\u7b49 or \u905e\u6e1b (e.g. { 4, 3, 2, 2, 1 })</li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_2","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ul> <li>Array \u4e2d\u6709\u91cd\u8907\u503c\u55ce? \u6703\u5f71\u97ff\u7b54\u6848\u55ce? \u4f7f\u554f\u984c\u8b8a\u5f97\u66f4\u7c21\u55ae\u9084\u662f\u66f4\u56f0\u96e3?</li> <li>\u7576\u4f7f\u7528 index \u904d\u6b77 Array \u5143\u7d20\u6642\uff0c\u8acb\u6ce8\u610f\u4e0d\u8981\u8d8a\u754c</li> <li> <p>Array \u5207\u7247\u6216\u9023\u63a5\u6642\uff0c\u901a\u5e38\u9700\u8981 O(n) \u6642\u9593\uff0c\u76e1\u53ef\u80fd\u4f7f\u7528 start \u548c \u7d50\u675f\u7d22\u5f15\u4f86\u5283\u5206 subarry \u6216 array range</p> <ul> <li> <p>Array \u5207\u7247     Java<pre><code>// \u666e\u901a\u505a\u6cd5: \u4f7f\u7528 Arrays.copyOfRange(\u4f86\u6e90, \u8d77\u59cb\u7d22\u5f15, \u7d50\u675f\u7d22\u5f15)\n// \u6642\u9593: O(n)\n// \u7a7a\u9593: O(n)\nint[] array = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\nint[] subarray = Arrays.copyOfRange(array, start, end);\n</code></pre> Java<pre><code>// \u8f03\u4f73\u4f5c\u6cd5: \u4f7f\u7528 index \u904d\u6b77\n// \u6642\u9593: O(1)\n// \u7a7a\u9593: O(1)\nint[] array = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\nint start = 2;\nint end = 5;\n\n// \u8655\u7406\u7bc4\u570d\u5167\u7684\u5143\u7d20\nfor (int i = start1; i &lt; end1; i++) {\n    System.out.println(array[i]);\n}\n</code></pre></p> </li> <li> <p>Array \u9023\u63a5     Java<pre><code>// \u666e\u901a\u4f5c\u6cd5: \u4f7f\u7528 System.arraycopy(\u4f86\u6e90, \u8d77\u59cb\u7d22\u5f15, \u76ee\u7684, \u8d77\u59cb\u7d22\u5f15, \u8981\u8907\u88fd\u7684\u5143\u7d20\u6578\u91cf)\n// \u6642\u9593: O(n)\n// \u7a7a\u9593: O(n)\nint[] subarray1 = { 1, 2, 3 };\nint[] subarray2 = { 4, 5, 6 };\nint[] concatenatedArray = new int[subarray1.length + subarray2.length];\nSystem.arraycopy(subarray1, 0, concatenatedArray, 0, subarray1.length);\nSystem.arraycopy(subarray2, 0, concatenatedArray, subarray1.length, subarray2.length);\n</code></pre></p> Java<pre><code>// \u8f03\u4f73\u4f5c\u6cd5: \u4f7f\u7528 index \u904d\u6b77\n// \u6642\u9593: O(1)\n// \u7a7a\u9593: O(1)\npublic static void main(String[] args) {\n    int[] array = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\n    int start1 = 2;\n    int end1 = 5; // [2, 5) =&gt; \u5143\u7d20 3, 4, 5\n    int start2 = 5;\n    int end2 = 8; // [5, 8) =&gt; \u5143\u7d20 6, 7, 8\n\n    // \u4f7f\u7528\u7d22\u5f15\u8a2a\u554f\u5b50\u9663\u5217\u7bc4\u570d\n    System.out.println(\"Subarray 1 elements:\");\n    printSubarray(array, start1, end1);\n\n    System.out.println(\"Subarray 2 elements:\");\n    printSubarray(array, start2, end2);\n}\n\npublic static void printSubarray(int[] array, int start, int end) {\n    for (int i = start; i &lt; end; i++) {\n        System.out.print(array[i] + \" \");\n    }\n    System.out.println();\n}\n</code></pre> </li> </ul> </li> <li> <p>\u6975\u7aef\u60c5\u6cc1 (corner case)</p> <ul> <li>\u7a7a \u9663\u5217</li> <li>\u50c5\u6709\u4e00\u500b\u5143\u7d20 \u7684\u9663\u5217</li> <li>\u6709 \u91cd\u8907\u5143\u7d20 \u7684\u9663\u5217</li> <li>\u9663\u5217\u4e2d\u7684 \u91cd\u8907\u503c</li> </ul> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_3","title":"\u89e3\u984c\u6280\u5de7","text":""},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#sliding-window","title":"\u6ed1\u52d5\u8996\u7a97 (Sliding Window)","text":"<ul> <li>\u8aaa\u660e: \u5169\u500b\u6307\u91dd\u901a\u5e38\u6703\u671d\u540c\u4e00\u65b9\u5411\u79fb\u52d5\uff0c\u6c38\u9060\u4e0d\u6703\u8d85\u8d8a\u5c0d\u65b9\u3002\u9019\u78ba\u4fdd\u6bcf\u500b\u503c\u6700\u591a\u53ea\u88ab\u8a2a\u554f\u5169\u6b21<ul> <li>\u6642\u9593\u8907\u96dc\u5ea6: O(n)</li> </ul> </li> <li> <p>\u61c9\u7528\u60c5\u5883: \u5b50\u9663\u5217, \u5b50\u5b57\u4e32\u554f\u984c </p> </li> <li> <p>LC 3. (M): \u6700\u9577\u4e0d\u91cd\u8907\u5b50\u5b57\u4e32</p> <ul> <li>Longest Substring Without Repeating Characters</li> <li>\u601d\u8def<ul> <li>\u4f7f\u7528\u6ed1\u52d5\u7a97\u53e3\u6280\u5de7\uff0c\u7528 left, right \u6307\u6a19\u4f86\u6a19\u8a18\u7a97\u53e3\u7684\u5de6\u53f3\u908a\u754c</li> <li>\u4f7f\u7528\u4e00\u500b HashMap \u4f86\u8a18\u9304\u6bcf\u500b\u5b57\u5143 \u6700\u5f8c\u51fa\u73fe\u7684\u4f4d\u7f6e</li> <li>\u7576\u767c\u73fe\u91cd\u8907\u5b57\u5143\u6642\uff0c\u76f4\u63a5\u5c07 left \u6307\u91dd\u79fb\u52d5\u5230\u91cd\u8907\u5b57\u5143\u7684\u4e0b\u4e00\u500b\u4f4d\u7f6e\uff0c\u4ee5\u8df3\u904e\u91cd\u8907\u5b57\u5143</li> <li>\u6bcf\u6b21\u79fb\u52d5 right \u6307\u91dd\u4ee5\u64f4\u5927\u7a97\u53e3\uff0c\u4e26\u66f4\u65b0\u7d50\u679c (\u6700\u9577\u7684\u7121\u91cd\u8907\u5b57\u5143\u5b50\u4e32\u7684\u9577\u5ea6)</li> </ul> </li> </ul> Java<pre><code>// \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u5b57\u4e32\u7684\u9577\u5ea6\n// \u7a7a\u9593: O(min(m, n))\uff0c\u5176\u4e2d n \u662f\u5b57\u4e32\u7684\u9577\u5ea6\uff0cm \u662f\u5b57\u5143\u96c6\u7684\u5927\u5c0f\nclass Solution {\n    public int lengthOfLongestSubstring(String s) {\n        int res = 0;\n        Map&lt;Character, Integer&gt; map = new HashMap&lt;&gt;();\n\n        for (int left = 0, right = 0; right &lt; s.length(); right++) {\n            if (map.containsKey(s.charAt(right))) {\n                // \u6bd4\u8f03 (\u7576\u524d\u7684 left \u6307\u6a19\u6240\u6307\u5411\u7684\u7d22\u5f15\u4f4d\u7f6e, \u7576\u524d right \u6307\u6a19\u65bc HashMap \u4e2d\u6240\u5c0d\u61c9\u4e4b\u7d22\u5f15\u4f4d\u7f6e)\n                // \u53d6\u5176\u5927\u8005\uff0c\u4e26\u66f4\u65b0 left \u6307\u6a19\u7684\u4f4d\u7f6e\n                left = Math.max(left, map.get(s.charAt(right)));\n            }\n            res = Math.max(res, right - left + 1);\n            map.put(s.charAt(right), right + 1);\n        }\n\n        return res;\n    }\n}\n</code></pre> </li> <li> <p>LC 209. (M): \u6700\u5c0f\u5b50\u9663\u5217\u7e3d\u548c</p> <ul> <li>Minimum Size Subarray Sum</li> <li>\u601d\u8def<ul> <li>\u4f7f\u7528\u6ed1\u52d5\u7a97\u53e3\u6280\u5de7\uff0c\u7528 left, right \u6307\u6a19\u4f86\u6a19\u8a18\u7a97\u53e3\u7684\u5de6\u53f3\u908a\u754c</li> <li>\u7576\u6ed1\u52d5\u7a97\u53e3\u5167\u7684 Subarray \u7e3d\u548c &gt;= \u76ee\u6a19\u503c\u6642\uff0c\u7e2e\u5c0f\u7a97\u53e3</li> <li>\u6bcf\u6b21\u8abf\u6574\u7a97\u53e3\u5f8c\uff0c\u66f4\u65b0\u6700\u77ed\u9577\u5ea6\u7684 Subarray</li> </ul> </li> </ul> Java<pre><code>// \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u9663\u5217\u7684\u9577\u5ea6\n// \u7a7a\u9593: O(1)\nclass Solution {\n    public int minSubArrayLen(int target, int[] nums) {\n        // \u8a08\u7b97\u7576\u524d\u7a97\u53e3\u5167\u7684\u5b50\u9663\u5217\u548c\n        int sum = 0;\n        // \u8a18\u9304\u6700\u77ed\u5b50\u9663\u5217\u7684\u9577\u5ea6\n        int res = Integer.MAX_VALUE;\n        for (int left = 0, right = 0; right &lt; nums.length; right++) {\n            sum = sum + nums[right];\n            while (sum &gt;= target) {\n                res = Math.min(res, right - left + 1);\n                sum = sum - nums[left];\n                left++;\n            }\n        }\n\n        return (res != Integer.MAX_VALUE) ? res : 0;\n    }\n}\n</code></pre> </li> <li> <p>LC 76. (H): \u6700\u5c0f\u6ed1\u52d5\u8996\u7a97\u5b50\u5b57\u4e32</p> <ul> <li>Minimum Window Substring</li> <li>\u601d\u8def<ul> <li>\u521d\u59cb\u5316<ul> <li>\u5efa\u7acb\u5169\u500b HashMap: <ul> <li><code>tFreq</code>: \u8a18\u9304\u76ee\u6a19\u5b57\u4e32 <code>t</code> \u4e2d\u6bcf\u500b\u5b57\u5143\u7684\u51fa\u73fe\u6b21\u6578</li> <li><code>windowFreq</code>: \u8a18\u9304\u6ed1\u52d5\u7a97\u53e3\u4e2d\u6bcf\u500b\u5b57\u5143\u7684\u51fa\u73fe\u6b21\u6578</li> </ul> </li> <li>\u521d\u59cb\u5316\u8b8a\u6578<ul> <li><code>required</code>: \u76ee\u6a19\u5b57\u4e32 <code>t</code> \u4e2d\u552f\u4e00\u5b57\u5143\u7684\u500b\u6578</li> <li><code>formed</code>: \u7576\u524d\u7a97\u53e3\u4e2d\u7b26\u5408\u8981\u6c42\u7684\u5b57\u5143\u500b\u6578</li> <li><code>left</code>, <code>right</code>: \u6ed1\u52d5\u7a97\u53e3\u7684\u5de6\u53f3\u6307\u91dd</li> <li><code>minLen</code>, <code>minLeft</code>: \u8a18\u9304\u6700\u5c0f\u7a97\u53e3\u7684\u9577\u5ea6\u3001\u8d77\u59cb\u4f4d\u7f6e</li> </ul> </li> </ul> </li> <li>\u64f4\u5c55\u7a97\u53e3<ul> <li>\u4f7f\u7528 <code>right</code> \u6307\u91dd\u5f9e\u5de6\u5230\u53f3\u904d\u6b77\u5b57\u4e32 <code>s</code>\uff0c\u5c07\u5b57\u5143\u52a0\u5165\u7a97\u53e3\uff0c\u66f4\u65b0 <code>windowFreq</code></li> <li>\u5982\u679c\u7576\u524d\u7a97\u53e3\u4e2d\u7684\u5b57\u5143\u983b\u7387\u7b26\u5408 <code>tFreq</code> \u4e2d\u7684\u983b\u7387\uff0c\u589e\u52a0 <code>formed</code> \u7684\u8a08\u6578</li> </ul> </li> <li>\u6536\u7e2e\u7a97\u53e3<ul> <li>\u7576 <code>formed</code> == <code>required</code> \u6642\uff0c\u5617\u8a66\u6536\u7e2e\u7a97\u53e3<ul> <li>\u66f4\u65b0\u6700\u5c0f\u7a97\u53e3\u9577\u5ea6 <code>minLen</code> \u548c\u8d77\u59cb\u4f4d\u7f6e <code>minLeft</code></li> <li>\u79fb\u52d5 <code>left</code> \u6307\u91dd\uff0c\u5c07\u5b57\u5143\u79fb\u51fa\u7a97\u53e3\uff0c\u66f4\u65b0 <code>windowFreq</code></li> <li>\u5982\u679c\u67d0\u500b\u5b57\u5143\u7684\u983b\u7387\u4e0d\u518d\u7b26\u5408 <code>tFreq</code>\uff0c\u6e1b\u5c11 <code>formed</code> \u7684\u8a08\u6578</li> </ul> </li> </ul> </li> </ul> </li> </ul> Java<pre><code>// \u6642\u9593: O(|s| + |t|)\n// \u7a7a\u9593: O(|s| + |t|)\nclass Solution {\n    public String minWindow(String s, String t) {\n        if (s.length() == 0 || t.length() == 0) {\n            return \"\";\n        }\n\n        // \u8a18\u9304\u76ee\u6a19\u5b57\u4e32 t \u4e2d\u6bcf\u500b\u5b57\u5143\u7684\u51fa\u73fe\u6b21\u6578\n        Map&lt;Character, Integer&gt; tFreq = new HashMap&lt;&gt;();\n        for (char c: t.toCharArray()) {\n            tFreq.put(c, tFreq.getOrDefault(c, 0) + 1);\n        }\n\n        // \u8a18\u9304\u6ed1\u52d5\u7a97\u53e3\u4e2d\u6bcf\u500b\u5b57\u5143\u7684\u51fa\u73fe\u6b21\u6578\n        Map&lt;Character, Integer&gt; windowFreq = new HashMap&lt;&gt;();\n        // \u76ee\u6a19\u5b57\u4e32 `t` \u4e2d\u552f\u4e00\u5b57\u5143\u7684\u500b\u6578\n        int required = tFreq.size();\n        // \u7576\u524d\u7a97\u53e3\u4e2d\u7b26\u5408\u8981\u6c42\u7684\u5b57\u5143\u500b\u6578\n        int formed = 0;\n        int left = 0, right = 0;\n        int minLen = Integer.MAX_VALUE;\n        int minLeft = 0;\n\n    // \u958b\u59cb\u6ed1\u52d5\u7a97\u53e3\n    while (right &lt; s.length()) {\n        char c = s.charAt(right);\n        windowFreq.put(c, windowFreq.getOrDefault(c, 0) + 1);\n\n        // \u7576\u524d\u5b57\u7b26\u5728 t \u4e2d\u51fa\u73fe\u4e14\u5176\u51fa\u73fe\u6b21\u6578\u7b26\u5408\u8981\u6c42\u6642\uff0c\u66f4\u65b0 formed\n        if (tFreq.containsKey(c) &amp;&amp; windowFreq.get(c).intValue() == tFreq.get(c).intValue()) {\n            formed++;\n        }\n\n        // \u7576\u524d\u7a97\u53e3\u5305\u542b\u6240\u6709\u76ee\u6a19\u5b57\u7b26\n        while (left &lt;= right &amp;&amp; formed == required) {\n            c = s.charAt(left);\n\n            // \u66f4\u65b0\u6700\u5c0f\u7a97\u53e3\n            if (right - left + 1 &lt; minLen) {\n                minLen = right - left + 1;\n                minLeft = left;\n            }\n\n            // \u79fb\u51fa\u7a97\u53e3\u7684\u5de6\u7aef\u5b57\u7b26\uff0c\u66f4\u65b0\u983b\u7387\u548c formed\n            windowFreq.put(c, windowFreq.get(c) - 1);\n            if (tFreq.containsKey(c) &amp;&amp; windowFreq.get(c).intValue() &lt; tFreq.get(c).intValue()) {\n                formed--;\n            }\n\n            left++; // \u7e7c\u7e8c\u6536\u7e2e\u7a97\u53e3\n        }\n\n        right++; // \u7e7c\u7e8c\u64f4\u5c55\u7a97\u53e3\n    }\n\n    // \u8fd4\u56de\u6700\u5c0f\u7a97\u53e3\u5b50\u5b57\u7b26\u4e32\uff0c\u82e5\u672a\u627e\u5230\u7b26\u5408\u689d\u4ef6\u7684\u7a97\u53e3\uff0c\u8fd4\u56de\u7a7a\u5b57\u7b26\u4e32\n    return minLen == Integer.MAX_VALUE ? \"\" : s.substring(minLeft, minLeft + minLen);\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#two-pointers","title":"\u96d9\u6307\u6a19(Two pointers)","text":"<ul> <li>\u8aaa\u660e: \u96d9\u6307\u6a19\u7b97\u662f\u6ed1\u52d5\u8996\u7a97\u7684\u66f4\u901a\u7528\u7248\u672c\uff0c\u5176\u4e2d\u6307\u6a19 \u53ef\u4ee5\u76f8\u4e92\u4ea4\u53c9 \u4e26\u4e14 \u53ef\u4ee5\u4f4d\u65bc\u4e0d\u540c\u7684\u9663\u5217\u4e0a</li> <li>\u61c9\u7528\u60c5\u5883: \u5408\u4f75\u5169\u500b\u5df2\u6392\u5e8f\u7684\u9663\u5217</li> <li> <p>LC 75. (M): \u6392\u5217\u984f\u8272</p> <ul> <li>Sort Colors</li> <li>\u9019\u984c\u7b97\u662f\u7d93\u5178\u7684 Dutch national flag \u554f\u984c\u7684\u985e\u4f3c\u984c\u76ee      \u5716\u7247\u51fa\u8655</li> <li>\u601d\u8def<ul> <li>\u4f7f\u7528\u4e09\u500b\u6307\u6a19<ul> <li><code>p0</code>: \u6307\u5411 0 \u7684\u6700\u53f3\u908a\u908a\u754c\uff0c\u5f9e\u9663\u5217\u7684\u6700\u5de6\u908a\u958b\u59cb</li> <li><code>p2</code>: \u6307\u5411 2 \u7684\u6700\u5de6\u908a\u908a\u754c\uff0c\u5f9e\u9663\u5217\u7684\u6700\u53f3\u908a\u958b\u59cb</li> <li><code>curr</code>: \u7576\u524d\u6383\u63cf\u4f4d\u7f6e\uff0c\u5f9e\u9663\u5217\u7684\u6700\u5de6\u908a\u958b\u59cb</li> </ul> </li> <li>\u904d\u6b77\u9663\u5217\u4e26\u6392\u5e8f (\u79fb\u52d5 <code>curr</code> \u6307\u6a19\u4f86\u904d\u6b77\u9663\u5217)<ul> <li>\u7576 <code>curr</code> \u9047\u5230 0 \u6642\uff0c\u5c07\u5176\u8207 <code>p0</code> \u6307\u91dd\u4f4d\u7f6e\u7684\u5143\u7d20\u4ea4\u63db\uff0c\u4e26\u79fb\u52d5 <code>p0</code> \u548c <code>curr</code> \u6307\u91dd</li> <li>\u7576 <code>curr</code> \u9047\u5230 2 \u6642\uff0c\u5c07\u5176\u8207 <code>p2</code> \u6307\u91dd\u4f4d\u7f6e\u7684\u5143\u7d20\u4ea4\u63db\uff0c\u4e26\u79fb\u52d5 <code>p2</code> \u6307\u91dd (\u6ce8\u610f: \u6b64\u6642 <code>curr</code> \u4e0d\u79fb\u52d5\uff0c\u56e0\u70ba\u4ea4\u63db\u5f8c\u9700\u8981\u91cd\u65b0\u6aa2\u67e5)</li> <li>\u7576 <code>curr</code> \u9047\u5230 1 \u6642\uff0c\u53ea\u9700\u79fb\u52d5 <code>curr</code> \u6307\u91dd  \u5716\u7247\u51fa\u8655</li> </ul> </li> </ul> </li> </ul> Java<pre><code>// \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u9663\u5217\u7684\u9577\u5ea6\n// \u7a7a\u9593: O(1)\npublic class Solution {\n    private void swap(int[] nums, int i, int j) {\n            int temp = nums[i];\n            nums[i] = nums[j];\n            nums[j] = temp;\n        }\n\n    public void sortColors(int[] nums) {\n        int p0 = 0, curr = 0, p2 = nums.length - 1;\n\n        while (curr &lt;= p2) {\n            if (nums[curr] == 0) {\n                swap(nums, curr, p0);\n                p0++;\n                curr++;\n            } else if (nums[curr] == 2) {\n                swap(nums, curr, p2);\n                p2--;\n            } else {\n                // \u7576 nums[curr] \u70ba 1 \u6642\uff0c\u53ea\u9700\u79fb\u52d5 curr \u6307\u6a19\n                curr++;\n            }\n        }\n    }\n}\n</code></pre> </li> <li> <p>LC 647. (M): \u56de\u6587\u5b50\u5b57\u4e32</p> <ul> <li>Palindromic Substrings</li> <li>\u601d\u8def: \u4f7f\u7528 \u4e2d\u5fc3\u64f4\u5c55\u6cd5 (Expand Around Center)\uff0c\u4ee5\u6bcf\u500b\u5b57\u5143\u53ca\u6bcf\u5c0d\u76f8\u9130\u5b57\u5143\u4f5c\u70ba\u4e2d\u5fc3\uff0c\u5411\u5169\u908a\u64f4\u5c55\u4f86\u6aa2\u67e5\u662f\u5426\u69cb\u6210\u56de\u6587\u5b50\u5b57\u4e32</li> </ul> Java<pre><code>// \u6642\u9593: O(n^2)\n// \u7a7a\u9593: O(1)\nclass Solution {\n    private int expandAroundCenter(String s, int left, int right) {\n        int count = 0;\n        while (left &gt;= 0 &amp;&amp; right &lt; s.length() &amp;&amp; s.charAt(left) == s.charAt(right)) {\n            count++;\n            // \u5411\u5de6, \u53f3\u5169\u908a\u64f4\u5c55\n            left--;\n            right++;\n        }\n\n        return count;\n    }\n\n    public int countSubstrings(String s) {\n        int totalCount = 0;\n\n        for (int i = 0; i &lt; s.length(); i++) {\n            // \u60c5\u6cc1 1: \u56de\u6587\u4e2d\u5fc3\u662f\u55ae\u500b\u5b57\u5143 (e.g. \"aba\")\n            totalCount = totalCount + expandAroundCenter(s, i, i);\n            // \u60c5\u6cc1 2: \u56de\u6587\u4e2d\u5fc3\u662f\u5169\u500b\u5b57\u5143 (e.g. \"abba\")\n            totalCount = totalCount + expandAroundCenter(s, i, i + 1);\n        }\n\n        return totalCount;\n    }\n}\n</code></pre> </li> <li> <p>LC 88. (E): \u5408\u4f75\u5df2\u6392\u5e8f\u7684\u9663\u5217</p> <ul> <li>Merge Sorted Array</li> <li>\u601d\u8def: \u4f7f\u7528\u96d9\u6307\u6a19\uff0c\u5f9e\u53f3\u908a\u958b\u59cb\u904d\u6b77\u5169\u500b\u9663\u5217\uff0c\u5c07\u5169\u500b\u9663\u5217\u4e2d\u7684\u5143\u7d20\u9032\u884c\u6bd4\u8f03\uff0c\u4e26\u5c07\u8f03\u5927\u7684\u5143\u7d20\u653e\u5165 nums1 \u9663\u5217\u7684\u6700\u5f8c\u4e00\u500b\u4f4d\u7f6e</li> </ul> Java<pre><code>// \u6642\u9593: O(m+n)\uff0c\u5176\u4e2d m \u548c n \u5206\u5225\u662f nums1 \u548c nums2 \u7684\u9663\u5217\u9577\u5ea6\n// \u7a7a\u9593: O(1)\nclass Solution {\n    public void merge(int[] nums1, int m, int[] nums2, int n) {\n        // \u5efa\u7acb p1 \u6307\u91dd (\u6307\u5411 nums1 \u9663\u5217\u7684\u6700\u5f8c\u4e00\u500b\u6709\u6548\u7d22\u5f15\u4f4d\u7f6e)\n        int p1 = m - 1;\n        // \u5efa\u7acb p2 \u6307\u91dd (\u6307\u5411 nums2 \u9663\u5217\u7684\u6700\u5f8c\u4e00\u500b\u6709\u6548\u7d22\u5f15\u4f4d\u7f6e)\n        int p2 = n - 1;\n\n        // \u5efa\u7acb curr \u6307\u91dd\uff0c\u5f9e nums1 \u9663\u5217\u7684\u6700\u5f8c\u4e00\u500b\u7d22\u5f15\u4f4d\u7f6e\uff0c\u5f80\u524d\u904d\u6b77\u8986\u84cb\u5143\u7d20\u503c\n        for (int curr = m + n - 1; curr &gt;= 0; curr--) {\n            // \u82e5 p2 &lt; 0\uff0c\u8868\u793a nums2 \u9663\u5217\u5df2\u7d93\u904d\u6b77\u5b8c\u7562\n            if (p2 &lt; 0) {\n                break;\n            }\n            // \u8868\u793a\n            if (p1 &gt;= 0 &amp;&amp; nums1[p1] &gt; nums2[p2]) {\n                nums1[curr] = nums1[p1];\n                p1--;\n            } else {\n                nums1[curr] = nums2[p2];\n                p2--;\n            }\n        }\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#traversing-from-the-right","title":"\u5f9e\u53f3\u908a\u958b\u59cb\u904d\u6b77 (Traversing from the right)","text":"<ul> <li>\u8aaa\u660e: \u6709\u6642\uff0c\u6211\u5011\u53ef\u4ee5 \u5f9e\u53f3\u908a\u958b\u59cb\u904d\u6b77\u9663\u5217</li> <li> <p>LC 739. (M): \u6bcf\u65e5\u6eab\u5ea6</p> <ul> <li>Daily Temperatures</li> <li>\u601d\u8def: \u4f7f\u7528 <code>hottest</code> \u8b8a\u6578\u4f86\u8a18\u9304\u7576\u524d\u904d\u6b77\u904e\u7a0b\u4e2d\u7684\u6700\u9ad8\u6eab\u5ea6\uff0c\u5f9e\u53f3\u5411\u5de6\u904d\u6b77 \u9663\u5217\u3002\u5c0d\u65bc\u6bcf\u4e00\u5929\uff0c\u627e\u5230\u4e0b\u4e00\u500b\u6bd4\u7576\u524d\u6eab\u5ea6\u9ad8\u7684\u5929\u6578\u3002\u5982\u679c\u7576\u524d\u6eab\u5ea6\u5df2\u7d93\u662f\u6700\u9ad8\u6eab\u5ea6\uff0c\u5247\u66f4\u65b0 <code>hottest</code> \u4e26\u7e7c\u7e8c\u3002\u5982\u679c\u4e0d\u662f\u6700\u9ad8\u6eab\u5ea6\uff0c\u5247\u4f7f\u7528\u7d50\u679c\u9663\u5217\u4e2d\u7684\u8cc7\u8a0a\u4f86\u512a\u5316\u641c\u7d22\u904e\u7a0b\uff0c\u907f\u514d\u9010\u5929\u6aa2\u67e5</li> </ul> Java<pre><code>// \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u6eab\u5ea6\u9663\u5217\u7684\u9577\u5ea6\n// \u7a7a\u9593: O(1)\nclass Solution {\n    public int[] dailyTemperatures(int[] temperatures) {\n        int n = temperatures.length;\n        // \u7576\u524d\u6700\u9ad8\u6eab\u5ea6\n        int hottest = 0;\n        int answer[] = new int[n];\n\n        // \u5f9e\u53f3\u5411\u5de6\u904d\u6b77\u6eab\u5ea6\u9663\u5217\n        for (int currDay = n - 1; currDay &gt;= 0; currDay--) {\n            int currentTemp = temperatures[currDay];\n            if (currentTemp &gt;= hottest) {\n                // \u66f4\u65b0\u6700\u9ad8\u6eab\u5ea6\n                hottest = currentTemp;\n                continue;\n            }\n\n            // \"\u5929\u6578\u5dee\"\n            int days = 1;\n            while (temperatures[currDay + days] &lt;= currentTemp) {\n                // \u589e\u52a0\u5929\u6578\u5dee\uff0c\u8df3\u904e\u4e2d\u9593\u4e0d\u9700\u8981\u6bd4\u8f03\u7684\u5929\u6578\n                days += answer[currDay + days];\n            }\n            // \u8a18\u9304\u7576\u524d\u5929\u6578\u5dee\n            answer[currDay] = days;\n        }\n\n        return answer; // \u8fd4\u56de\u7d50\u679c\u6578\u7d44\n    }\n\n    public static void main(String[] args) {\n        Solution solution = new Solution();\n        int[] temperatures = {73, 74, 75, 71, 69, 72, 76, 73};\n        int[] result = solution.dailyTemperatures(temperatures);\n        for (int temp : result) {\n            System.out.print(temp + \" \");\n        }\n        // Output: 1 1 4 2 1 1 0 0\n    }\n}\n</code></pre> </li> <li> <p>LC 1944. (H): \u968a\u4f0d\u4e2d\u7684\u53ef\u898b\u4eba\u6578</p> <ul> <li>Number of Visible People in a Queue \u5716\u7247\u51fa\u8655</li> <li>\u601d\u8def: \u4f7f\u7528 Stack \u4f86\u8a18\u9304\u6bcf\u500b\u4eba\u7684\u9ad8\u5ea6\uff0c\u4e26\u5f9e\u53f3\u5411\u5de6\u904d\u6b77\u9663\u5217\u3002\u5c0d\u65bc\u6bcf\u500b\u4eba\uff0c\u5c07\u5176\u9ad8\u5ea6\u8207 Stack \u4e2d\u7684\u9ad8\u5ea6\u9032\u884c\u6bd4\u8f03\uff0c\u8a08\u7b97\u53ef\u898b\u4eba\u6578</li> </ul> Java<pre><code>class Solution {\n    public int[] canSeePersonsCount(int[] heights) {\n        int n = heights.length;\n        int[] res = new int[n];\n        Stack&lt;Integer&gt; stack = new Stack&lt;&gt;();\n\n        for (int i = n-1; i &gt;= 0; i--) {\n            // \u8a08\u7b97\u53ef\u898b\u4eba\u6578\n            int count = 0;\n            // \u8a08\u7b97\u6240\u6709\u6bd4\u7576\u524d\u9ad8\u5ea6 heights[i] \u77ee\u7684\u4eba\u6578 (= \u5f80\u53f3\u53ef\u770b\u5230\u7684\u4eba\u6578)\n            while (!stack.isEmpty() &amp;&amp; heights[i] &gt; heights[stack.peek()]) {\n                stack.pop();\n                count++;\n            }\n            // \u6bd4\u7576\u524d\u4eba heights[i] \u9ad8\u6216\u7b49\u9ad8\u7684\u4eba\uff09\uff0c\u5982\u679c\u6709\uff0c\u5c31\u5c07\u9019\u4e9b\u4eba\u4e5f\u8a08\u7b97\u5728\u53ef\u898b\u4eba\u6578\u5167 (= \u5f80\u53f3\u908a\u80fd\u770b\u5230\u7684\u6700\u9060\u7bc4\u570d)\n            if (!stack.isEmpty()) {\n                count++;\n            }\n\n            res[i] = count;\n            stack.push(i);\n        }\n\n        return res;\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#sorting-the-array","title":"\u6392\u5e8f\u9663\u5217 (Sorting the array)","text":"<ul> <li>\u8aaa\u660e: <ul> <li>\u5982\u679c\u9663\u5217\u662f\u5b8c\u5168\u6392\u5e8f or \u90e8\u5206\u6392\u5e8f\u7684\uff0c\u90a3\u9ebc\u53ef\u4ee5\u4f7f\u7528\u67d0\u7a2e\u5f62\u5f0f\u7684 binary search \u4f86\u89e3\u984c\u3002\u9019\u901a\u5e38\u610f\u5473\u8457\u9762\u8a66\u5b98\u5728\u5c0b\u6c42\u4e00\u7a2e\u6bd4 O(n) \u66f4\u5feb\u7684\u89e3\u6cd5\u3002</li> <li>\u80fd\u5920\u6392\u5e8f\u9663\u5217\u55ce? \u6709\u6642\uff0c\u5148\u6392\u5e8f\u9663\u5217\u53ef\u4ee5\u5927\u5927\u7c21\u5316\u554f\u984c\u3002\u7136\u800c\uff0c\u5982\u679c\u9700\u8981\u4fdd\u6301\u9663\u5217\u5143\u7d20\u7684\u9806\u5e8f\uff0c\u9019\u7a2e\u65b9\u6cd5\u5c31\u4e0d\u9069\u7528\u4e86</li> </ul> </li> <li>\u61c9\u7528\u60c5\u5883:<ul> <li>\u7576\u984c\u76ee\u8981\u6c42\u5728\u4e00\u500b\u5b8c\u5168\u6392\u5e8f or \u90e8\u5206\u6392\u5e8f\u7684\u9663\u5217\u4e2d\uff0c\u641c\u5c0b\u67d0\u500b\u5143\u7d20\u6642</li> <li>\u7576\u6392\u5e8f\u5f8c\u53ef\u4ee5\u4f7f\u7528 binary search\uff0c\u6216\u5176\u4ed6\u9ad8\u6548\u641c\u5c0b\u65b9\u6cd5\u4f86\u52a0\u901f\u89e3\u984c\u6d41\u7a0b</li> </ul> </li> <li> <p>LeetCode 56.(M): \u5408\u4f75\u5340\u9593</p> <ul> <li>Merge Intervals \u5716\u7247\u51fa\u8655</li> <li>\u601d\u8def:<ul> <li>\u6392\u5e8f \u5340\u9593: \u6839\u64da\u6bcf\u500b\u5340\u9593\u7684\u8d77\u59cb\u503c\uff0c\u5c0d\u5404\u5340\u9593\u9032\u884c\u6392\u5e8f\uff0c\u4ee5\u78ba\u4fdd\u5728\u904d\u6b77\u6642\uff0c\u6bcf\u500b\u5340\u9593\u53ea\u9700\u8207\u5b83\u76f4\u63a5\u76f8\u9130\u7684\u5340\u9593\u9032\u884c\u6bd4\u8f03</li> <li>\u5408\u4f75 \u5340\u9593: \u904d\u6b77\u6392\u5e8f\u5f8c\u7684\u5340\u9593\uff0c\u5c07\u91cd\u758a\u7684\u5340\u9593\u5408\u4f75</li> </ul> </li> </ul> Java<pre><code>/**\n * \u6642\u9593: O(nlogn)\uff0c\u5176\u4e2d n \u662f intervals \u4e8c\u7dad\u9663\u5217\u7684\u9577\u5ea6\n * \u7a7a\u9593: O(n)\n */\nclass Solution {\n    public int[][] merge(int[][] intervals) {\n        // \u6839\u64da\u6bcf\u500b\u5340\u9593\u7684\u8d77\u59cb\u503c\u9032\u884c\u6392\u5e8f\n        Arrays.sort(intervals, (front, rear) -&gt; Integer.compare(front[0], rear[0]));\n\n        List&lt;int[]&gt; mergedList = new ArrayList&lt;&gt;();\n        // \u521d\u59cb\u5316\u7576\u524d\u8655\u7406\u7684\u5340\u9593\u70ba\u6392\u5e8f\u5f8c\u7684\u7b2c\u4e00\u500b\u5340\u9593\n        int[] currentInterval = intervals[0];\n        mergedList.add(currentInterval);\n\n        for (int[] interval: intervals) {\n            // \u7576\u524d\u5340\u9593\u7684\u7d50\u675f\u4f4d\u7f6e\n            int currentEnd = currentInterval[1];\n            // \u4e0b\u4e00\u500b\u5340\u9593\u7684\u8d77\u59cb\u4f4d\u7f6e\n            int nextStart = interval[0];\n            // \u4e0b\u4e00\u500b\u5340\u9593\u7684\u7d50\u675f\u4f4d\u7f6e\n            int nextEnd = interval[1];\n\n            // \u82e5\u7576\u524d\u5340\u9593\u7684\u7d50\u675f\u4f4d\u7f6e &gt;= \u4e0b\u4e00\u500b\u5340\u9593\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u5247\u5408\u4f75\n            if (currentEnd &gt;= nextStart) {\n                // \u66f4\u65b0\u7576\u524d\u5340\u9593\u7684\u7d50\u675f\u4f4d\u7f6e\n                currentInterval[1] = Math.max(currentEnd, nextEnd);\n            } else {\n                // \u82e5\u4e0d\u91cd\u758a\uff0c\u5247\u66f4\u65b0\u7576\u524d\u5340\u9593 = \u65b0\u7684\u5340\u9593\n                currentInterval = interval;\n                mergedList.add(currentInterval);\n            }\n        }\n\n        return mergedList.toArray(new int[mergedList.size()][]);\n    }\n}\n</code></pre> </li> <li> <p>LeetCode 435. (M): \u975e\u91cd\u758a\u5340\u9593</p> <ul> <li>Non-overlapping Intervals</li> <li>\u601d\u8def: <ul> <li>\u6392\u5e8f \u5340\u9593: \u6839\u64da\u6bcf\u500b\u5340\u9593\u7684\u7d50\u675f\u6642\u9593\u9032\u884c\u6392\u5e8f</li> <li>\u904d\u6b77 \u5340\u9593: \u8ffd\u8e64\u7576\u524d\u975e\u91cd\u758a\u5340\u9593\u7684\u7d50\u675f\u6642\u9593\uff0c\u904d\u6b77\u6392\u5e8f\u5f8c\u7684\u5340\u9593\u4e8c\u7dad\u9663\u5217\uff0c\u6aa2\u67e5\u6bcf\u500b\u5340\u9593\u662f\u5426\u8207\u524d\u4e00\u500b\u975e\u91cd\u758a\u5340\u9593\u91cd\u758a\uff0c\u4e26\u8a08\u7b97\u9700\u8981\u79fb\u9664\u7684\u5340\u9593\u6578\u91cf</li> </ul> </li> </ul> Java<pre><code>/**\n * \u6642\u9593: O(nlogn)\uff0c\u5176\u4e2d n \u662f intervals \u4e8c\u7dad\u9663\u5217\u7684\u9577\u5ea6\n * \u7a7a\u9593: O(1)\n */\nclass Solution {\n    public int eraseOverlapIntervals(int[][] intervals) {\n        // \u6392\u5e8f\u5340\u9593: \u6839\u64da\u6bcf\u500b\u5340\u9593\u7684\u7d50\u675f\u6642\u9593\u9032\u884c\u6392\u5e8f\n        Arrays.sort(intervals, (front, rear) -&gt; Integer.compare(front[1], rear[1]));\n\n        // \u8a08\u6578\u975e\u91cd\u758a\u5340\u9593\n        // \u81f3\u5c11\u6709\u4e00\u500b\u5340\u9593\u662f\u975e\u91cd\u758a\u7684\n        int nonOverlapCount = 1;\n        // \u7576\u524d\u975e\u91cd\u758a\u5340\u9593\u7684\u7d50\u675f\u503c\n        int end = intervals[0][1];\n\n        // \u904d\u6b77\u5340\u9593: \u6aa2\u67e5\u6bcf\u500b\u5340\u9593\u662f\u5426\u8207\u7576\u524d\u975e\u91cd\u758a\u5340\u9593\u91cd\u758a\uff0c\u5982\u679c\u4e0d\u91cd\u758a\uff0c\u66f4\u65b0\u975e\u91cd\u758a\u5340\u9593\u8a08\u6578\uff0c\u4e14\u66f4\u65b0 end\n        for (int i = 1; i &lt; intervals.length; i++) {\n            // \u4e0b\u4e00\u683c\u5340\u9593\u7684\u8d77\u59cb\u503c &gt;= \u7576\u524d\u975e\u91cd\u758a\u5340\u9593\u7684\u7d50\u675f\u503c (\u8868\u793a\u4e0d\u91cd\u758a)\n            if (intervals[i][0] &gt;= end) {\n                nonOverlapCount++;\n                end = intervals[i][1];\n            }\n        }\n\n        // \u8a08\u7b97\u9700\u8981\u79fb\u9664\u7684\u5340\u9593\u6578\n        return intervals.length - nonOverlapCount;\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#precomputation","title":"\u9810\u5148\u8a08\u7b97 (Precomputation)","text":"<ul> <li>\u8aaa\u660e &amp; \u61c9\u7528\u60c5\u5883: \u5c0d\u65bc Subarray \u6c42\u7e3d\u548c or \u4e58\u6cd5\u554f\u984c\uff0c\u53ef\u900f\u904e\u4f7f\u7528 hashing \u5feb\u901f\u67e5\u8a62\u5df2\u7d93\u8a08\u7b97\u904e\u7684\u7d50\u679c\uff0c\u4ee5\u907f\u514d\u91cd\u8907\u8a08\u7b97\u3002\u4ea6\u80fd\u4f7f\u7528\u524d\u7db4/\u5f8c\u7db4\u548c (prefix/suffix sum) \u6216\u524d\u7db4/\u5f8c\u7db4\u4e58\u7a4d(prefix/suffix product) \u4f86\u63d0\u5347\u6f14\u7b97\u6cd5\u7684\u6548\u7387</li> <li> <p>LeetCode 238. (M): \u9023\u4e58\u7a4d\u9663\u5217 (\u9664\u4e86\u81ea\u5df1\u4ee5\u5916\u7684\u6240\u6709\u6578\u5b57)</p> <ul> <li>Product of Array Except Self \u5716\u7247\u51fa\u8655</li> <li>\u601d\u8def: \u9996\u5148\u8a08\u7b97\u6bcf\u500b\u4f4d\u7f6e\u7684\u524d\u7db4\u4e58\u7a4d\uff0c\u518d\u8a08\u7b97\u6bcf\u500b\u4f4d\u7f6e\u7684\u5f8c\u7db4\u4e58\u7a4d\uff0c\u6700\u5f8c\u5c07\u5169\u8005\u76f8\u4e58\u5373\u53ef\u5f97\u5230\u7d50\u679c</li> </ul> Java<pre><code>/**\n * \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u9663\u5217\u7684\u9577\u5ea6\n * \u7a7a\u9593: O(1)\n */\nclass Solution {\n    public int[] productExceptSelf(int[] nums) {\n        int n = nums.length;\n        int[] res = new int[nums.length];\n\n        // \u521d\u59cb\u5316\u7b2c\u4e00\u500b\u5143\u7d20\u7684\u524d\u7db4\u4e58\u7a4d\u70ba 1\uff0c\u56e0\u70ba\u5de6\u908a\u6c92\u6709\u5143\u7d20\n        res[0] = 1;\n        // \u5f9e\u5de6\u5230\u53f3\u904d\u6b77\u9663\u5217\uff0c\u8a08\u7b97\u524d\u7db4\u4e58\u7a4d\n        for (int i = 1; i &lt; n; i++) {\n            res[i] = res[i-1] * nums[i-1];\n        }\n\n        // \u56e0\u70ba\u9663\u5217\u7684\u6700\u5f8c\u4e00\u500b\u5143\u7d20\uff0c\u5b83\u53f3\u908a\u6c92\u6709\u5176\u4ed6\u5143\u7d20\uff0c\u56e0\u6b64\u5f8c\u7db4\u4e58\u7a4d\u521d\u59cb\u5316\u61c9\u8a72\u70ba 1\n        int suffixProduct = 1;\n        // \u5f9e\u53f3\u5230\u5de6\u904d\u6b77\u9663\u5217\uff0c\u8a08\u7b97\u5f8c\u7db4\u4e58\u7a4d\n        for (int i = n-1; i &gt;= 0; i--) {\n            // \u7576\u524d\u5143\u7d20\u7684\u524d\u7db4\u4e58\u7a4d * \u5f8c\u7db4\u4e58\u7a4d\n            res[i] *= suffixProduct;\n            // \u66f4\u65b0\u5f8c\u7db4\u4e58\u7a4d (\u4e58\u4ee5\u7576\u524d\u5143\u7d20\u7684\u503c)\n            suffixProduct *= nums[i];\n        }\n\n        return res;\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#hashmap-key-index-as-a-hash-key","title":"\u5c07\u9663\u5217\u7d22\u5f15\u4f5c\u70ba HashMap \u7684 key \u4f7f\u7528 (Index as a hash key)","text":"<ul> <li>\u8aaa\u660e: \u5047\u8a2d\u9663\u5217\u4e2d\u7684\u503c 1 ~ <code>n</code>\uff0c\u5176\u4e2d <code>n</code> \u662f\u9663\u5217\u9577\u5ea6\uff0c\u53ef\u7528 index-1 &lt;-&gt; \u503c\u4f5c\u70ba\u5c0d\u6620\u95dc\u4fc2</li> <li>\u61c9\u7528\u60c5\u5883: \u7d66\u4e88\u4e00\u500b\u9663\u5217\uff0c\u4e14\u9762\u8a66\u5b98\u8981\u6c42\u7a7a\u9593\u8907\u96dc\u5ea6 O(1)\uff0c\u53ef\u80fd\u4f7f\u7528\u9663\u5217\u672c\u8eab\u4f5c\u70ba Hash table</li> <li> <p>LeetCode 41. (H): \u627e\u51fa\u9996\u500b\u4e0d\u5728\u9663\u5217\u4e2d\u7684\u6b63\u6574\u6578</p> <ul> <li>First Missing Positive</li> <li>\u601d\u8def<ul> <li>\u5c07\u6578\u503c\u653e\u5728\u61c9\u8a72\u5728\u7684 index \u4f4d\u7f6e\u4e0a (e.g. \u6578\u503c 1 \u653e\u5728 index 0, \u6578\u503c 2 \u653e\u5728 index 1 ...\u4f9d\u6b64\u985e\u63a8)</li> <li>\u904d\u6b77\u9663\u5217\uff0c\u627e\u51fa\u7b2c\u4e00\u500b\u4e0d\u7b26\u5408\u9019\u500b\u689d\u4ef6\u7684 index \u4f4d\u7f6e</li> </ul> </li> </ul> Java<pre><code>// \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u9663\u5217\u7684\u9577\u5ea6\n// \u7a7a\u9593: O(1)\nclass Solution {\n    public int firstMissingPositive(int[] nums) {\n        int n = nums.length;\n\n        // \u5c07\u6bcf\u500b\u6578\u5b57\u653e\u5728\u5b83\u61c9\u8a72\u5728\u7684\u4f4d\u7f6e\u4e0a\n        for (int i = 0; i &lt; n; i++) {\n            while (nums[i] &gt; 0 &amp;&amp; nums[i] &lt;= n &amp;&amp; nums[i] != nums[nums[i] - 1]) {\n                int temp = nums[nums[i] - 1];\n                nums[nums[i] - 1] = nums[i];\n                nums[i] = temp;\n            }\n        }\n\n        // // \u627e\u5230\u7b2c\u4e00\u500b\u4e0d\u7b26\u5408\u9019\u500b\u689d\u4ef6\u7684\u4f4d\u7f6e\uff0c\u6240\u5c0d\u61c9\u7684\u6578\u503c\n        for (int i = 0; i &lt; n; i++) {\n            if (nums[i] != i+1) {\n                return i+1;\n            }\n        }\n\n        return n+1;\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#traversing-the-array-more-than-once","title":"\u591a\u6b21\u904d\u6b77\u9663\u5217 (Traversing the array more than once)","text":"<ul> <li>\u8aaa\u660e: \u5373\u4fbf\u904d\u6b77 2 or 3 \u6b21 (\u53ea\u8981\u6b21\u6578\u5c11\u65bc n)\uff0c\u6642\u9593\u8907\u96dc\u5ea6\u4ecd\u7136\u662f O(n)\u3002\u6709\u6642\uff0c\u591a\u6b21\u904d\u6b77\u9663\u5217\u53ef\u4ee5\u5e6b\u52a9\u4f60\u5728\u4fdd\u6301\u6642\u9593\u8907\u96dc\u5ea6\u70ba O(n) \u7684\u60c5\u6cc1\u4e0b\u89e3\u6c7a\u554f\u984c</li> <li>\u61c9\u7528\u60c5\u5883:<ul> <li>\u7576\u9700\u8981\u5728\u9663\u5217\u4e2d\u9032\u884c \u591a\u6b65\u9a5f\u64cd\u4f5c \u6642\uff0c\u5206\u5225\u5728\u4e0d\u540c\u7684\u904d\u6b77\u4e2d\u5b8c\u6210\u4e0d\u540c\u7684\u64cd\u4f5c</li> <li>\u8a08\u7b97\u524d\u7db4\u548c\u5f8c\u7db4\u503c</li> <li>\u6392\u5e8f\u64cd\u4f5c\uff0c\u4f8b\u5982: bucket sort, counting sort</li> <li>\u5c07\u6578\u5b57\u653e\u5728\u5176\u61c9\u8a72\u5728\u7684 index \u4f4d\u7f6e\u4e0a</li> </ul> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_4","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>Tech Interview Handbook --- Array cheatsheet for coding interviews</li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#tree","title":"Tree","text":""},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#binary-tree-bt","title":"\u4e8c\u5143\u6a39 (Binary Tree, BT)","text":"<ul> <li>\u4e8c\u5143\u6a39\u7684\u7a2e\u985e<ul> <li>\u4e8c\u5143\u6a39(binary tree): \u6bcf\u500b\u7bc0\u9ede \u6700\u591a\u6709\u5169\u500b\u5b50\u7bc0\u9ede</li> <li>\u5b8c\u5168\u4e8c\u5143\u6a39(full binary tree): \u6bcf\u500b\u7bc0\u9ede \u90fd\u6709 0 \u6216 2 \u500b\u5b50\u7bc0\u9ede\uff0c\u6700\u5f8c\u4e00\u5c64\u7684\u7bc0\u9ede\u90fd\u9760\u5de6\u6392\u5217</li> <li>\u5b8c\u6574\u4e8c\u5143\u6a39(complete binary tree): \u6a39\u7684\u6bcf\u4e00\u5c64\u90fd\u6709 \u4e00\u7d44\u5b8c\u6574\u7684\u7bc0\u9ede\uff0c\u6700\u5f8c\u4e00\u5c64\u662f\u4f8b\u5916</li> <li>\u5b8c\u7f8e\u4e8c\u5143\u6a39(perfect binary tree): \u6a39\u7684\u6bcf\u4e00\u5c64 (\u5305\u62ec\u6700\u5f8c\u4e00\u5c64) \u90fd\u5df2\u5b8c\u6210</li> <li>\u5e73\u8861\u4e8c\u5143\u6a39(balanced binary tree): \u6240\u6709\u7bc0\u9ede \u5de6, \u53f3\u5b50\u6a39\u7684\u6df1\u5ea6\u76f8\u5dee\u4e0d\u8d85\u904e 1</li> <li>\u4e8c\u5143\u641c\u5c0b\u6a39(binary search tree): \u5de6\u5b50\u6a39\u4e2d\u7684\u6240\u6709\u7bc0\u9ede &lt; \u6bcf\u500b\u7bc0\u9ede &lt; \u5176\u53f3\u5b50\u6a39\u4e2d\u7684\u6240\u6709\u7bc0\u9ede \u5716\u7247\u51fa\u8655</li> </ul> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#binary-search-tree-bst","title":"\u4e8c\u5143\u641c\u5c0b\u6a39 (Binary Search Tree, BST)","text":"<ul> <li>\u7b97\u662f binary tree \u7684\u4e00\u7a2e\u7279\u6b8a\u5f62\u5f0f\uff0c\u5de6\u5b50\u6a39\u4e2d\u7684\u6240\u6709\u7bc0\u9ede &lt; \u6bcf\u500b\u7bc0\u9ede &lt; \u5176\u53f3\u5b50\u6a39\u4e2d\u7684\u6240\u6709\u7bc0\u9ede</li> <li>\u4e2d\u5e8f\u904d\u6b77(in-order traversal) \u4e8c\u5143\u641c\u5c0b\u6a39\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u500b \u6392\u5e8f\u597d\u7684\u9663\u5217 (\u7531\u5c0f \uff5e \u5927)</li> <li>\u901a\u5e38\uff0c\u7576\u9762\u8a66\u5b98\u8981\u6c42\u4e00\u500b \u6bd4 O(n) \u66f4\u5feb\u7684\u89e3\u6cd5 \u6642\uff0c\u53ef\u4ee5\u8003\u616e \u4f7f\u7528\u4e8c\u5143\u641c\u5c0b\u6a39</li> <li> <p>BST \u5404\u9805\u64cd\u4f5c \u7684\u6642\u9593\u8907\u96dc\u5ea6</p> <ul> <li><code>N</code>: \u7bc0\u9ede\u6578\u91cf</li> </ul> \u64cd\u4f5c \u6642\u9593\u8907\u96dc\u5ea6 \u5b58\u53d6(Access) O(logN) \u641c\u5c0b(Search) O(logN) \u63d2\u5165(Insert) O(logN) \u79fb\u9664(Remove) O(logN) </li> <li> <p>BST \u8d70\u8a2a \u7684\u7a7a\u9593\u8907\u96dc\u5ea6</p> <ul> <li><code>h</code>: \u6a39\u9ad8</li> <li><code>n</code>: \u7bc0\u9ede\u6578\u91cf</li> </ul> \u4e8c\u5143\u6a39\u7684\u985e\u578b \u7a7a\u9593\u8907\u96dc\u5ea6 \u5e73\u8861\u4e8c\u5143\u6a39(balanced binary tree) O(h) \u659c\u66f2\u6a39(skewed tree) O(n) </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_5","title":"\u6ce8\u610f\u4e8b\u9805 &amp; \u6975\u7aef\u60c5\u6cc1","text":"<ul> <li>\u7a7a\u6a39</li> <li>\u55ae\u4e00\u7bc0\u9ede</li> <li>\u5169\u500b\u7bc0\u9ede</li> <li>\u975e\u5e38\u659c\u66f2\u7684\u6a39 (\u5982\u540c Linked List)</li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_6","title":"\u5e38\u898b\u6163\u4f8b","text":"<p>\u76e1\u91cf\u719f\u6089\u4ee5\u4e0b\u7684\u6163\u4f8b\uff0c\u56e0\u70ba\u5927\u591a\u6578\u7684\u4e8c\u5143\u6a39\u554f\u984c\uff0c\u90fd\u6703\u4f7f\u7528\u9019\u4e9b\u6163\u4f8b\uff0c\u6df7\u5408\u61c9\u7528\u4f86\u89e3\u984c</p> Java<pre><code>// binary tree node\nclass TreeNode {\n    int val;\n    TreeNode left, right;\n    TreeNode(int x) { val = x; }\n}\n</code></pre> <ul> <li> <p>\u63d2\u5165\u503c/\u522a\u9664\u503c     Java<pre><code>// Insert Value\nclass BinaryTree {\n    public TreeNode insert(TreeNode root, int value) {\n        if (root == null) {\n            return new TreeNode(value);\n        }\n        if (value &lt; root.val) {\n            root.left = insert(root.left, value);\n        } else {\n            root.right = insert(root.right, value);\n        }\n        return root;\n    }\n}\n</code></pre></p> Java<pre><code>// Delete Value\nclass BinaryTree {\n    public TreeNode delete(TreeNode root, int key) {\n        if (root == null) return null;\n        if (key &lt; root.val) {\n            root.left = delete(root.left, key);\n        } else if (key &gt; root.val) {\n            root.right = delete(root.right, key);\n        } else {\n            if (root.left == null) return root.right;\n            if (root.right == null) return root.left;\n            root.val = minValue(root.right);\n            root.right = delete(root.right, root.val);\n        }\n        return root;\n    }\n\n    private int minValue(TreeNode root) {\n        int minVal = root.val;\n        while (root.left != null) {\n            root = root.left;\n            minVal = root.val;\n        }\n        return minVal;\n    }\n}\n</code></pre> </li> <li> <p>\u641c\u5c0b\u7279\u5b9a\u503c \u662f\u5426\u5728\u6a39\u4e2d     Java<pre><code>// Whether a Value is in the Tree\nclass BinaryTree {\n    public boolean contains(TreeNode root, int value) {\n        if (root == null) return false;\n        if (root.val == value) return true;\n        return value &lt; root.val ? contains(root.left, value) : contains(root.right, value);\n    }\n}\n</code></pre></p> </li> <li> <p>\u8a08\u7b97\u6a39\u4e2d\u7684\u7bc0\u9ede\u6578     Java<pre><code>class BinaryTree {\n    public int countNodes(TreeNode root) {\n        if (root == null) return 0;\n        return 1 + countNodes(root.left) + countNodes(root.right);\n    }\n}\n</code></pre></p> </li> <li> <p>\u8a08\u7b97\u6a39\u7684\u9ad8\u5ea6     Java<pre><code>// Calculate Height of the Tree\nclass BinaryTree {\n    public int height(TreeNode root) {\n        if (root == null) return 0;\n        return 1 + Math.max(height(root.left), height(root.right));\n    }\n}\n</code></pre></p> </li> <li> <p>\u4e8c\u5143\u641c\u5c0b\u6a39 \u985e\u578b</p> <ul> <li>\u5224\u65b7 \u662f\u5426\u70ba\u4e8c\u5143\u641c\u5c0b\u6a39</li> <li>\u53d6\u5f97 \u6700\u5927\u503c</li> <li>\u53d6\u5f97 \u6700\u5c0f\u503c</li> </ul> Java<pre><code>// Determine if it is a Binary Search Tree\nclass BinaryTree {\n    public boolean validate(TreeNode root) {\n        return isBST(root, null, null);\n    }\n\n    private boolean isBST(TreeNode node, Integer min, Integer max) {\n        if (node == null) return true;\n        if ((min != null &amp;&amp; node.val &lt;= min) || (max != null &amp;&amp; node.val &gt;= max)) return false;\n        return isBST(node.left, min, node.val) &amp;&amp; isBST(node.right, node.val, max);\n    }\n\n    // Get Maximum Value in Binary Search Tree\n    public int getMaxValue(TreeNode root) {\n        while (root.right != null) {\n            root = root.right;\n        }\n        return root.val;\n    }\n\n    // Get Minimum Value in Binary Search Tree\n    public int getMinValue(TreeNode root) {\n        while (root.left != null) {\n            root = root.left;\n        }\n        return root.val;\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_7","title":"\u89e3\u984c\u6280\u5de7","text":"<ul> <li> <p>\u905e\u8ff4\u6cd5 (Recursion): \u662f\u904d\u6b77\u6a39\u6700\u5e38\u898b\u7684\u65b9\u6cd5\u3002\u7576\u767c\u73fe \u5b50\u6a39\u554f\u984c\u53ef\u4ee5\u7528\u4f86\u89e3\u6c7a\u6574\u500b\u554f\u984c \u6642\uff0c\u8acb \u5617\u8a66\u4f7f\u7528\u905e\u8ff4\u6cd5</p> <ul> <li>\u8acb\u52d9\u5fc5\u8a18\u4f4f\u6aa2\u67e5\u7279\u6b8a\u60c5\u6cc1\uff0c\u901a\u5e38\u662f\u7bc0\u9ede\u503c = null</li> <li>\u6709\u6642\uff0c\u905e\u8ff4\u51fd\u5f0f\u53ef\u80fd\u9700\u8981\u56de\u50b3\u5169\u500b\u503c</li> </ul> Java<pre><code>// \u8a08\u7b97\u4e8c\u5143\u6a39\u7684\u7bc0\u9ede\u7e3d\u6578\nclass BinaryTree {\n    public int countNodes(TreeNode root) {\n        if (root == null) return 0; // \u57fa\u672c\u60c5\u6cc1\n        return 1 + countNodes(root.left) + countNodes(root.right); // \u905e\u6b78\u8a08\u7b97\n    }\n}\n</code></pre> </li> <li> <p>\u4f7f\u7528\u5ee3\u5ea6\u512a\u5148\u641c\u5c0b\u6cd5(BFS)\uff0c\u4f86\u9054\u5230 level order traversal Java<pre><code>// \u6309\u5c64\u6b21\u904d\u6b77\u4e8c\u5143\u6a39\nclass BinaryTree {\n    public void levelOrderTraversal(TreeNode root) {\n        if (root == null) return;\n        Queue&lt;TreeNode&gt; queue = new LinkedList&lt;&gt;();\n        queue.add(root);\n\n        while (!queue.isEmpty()) {\n            TreeNode current = queue.poll();\n            System.out.print(current.val + \" \");\n\n            if (current.left != null) queue.add(current.left);\n            if (current.right != null) queue.add(current.right);\n        }\n    }\n}\n</code></pre></p> </li> <li> <p>\u7bc0\u9ede\u503c\u7e3d\u548c: \u82e5\u984c\u76ee\u6d89\u53ca\u6c42\u6240\u6709\u7bc0\u9ede\u503c\u7684\u7e3d\u548c\uff0c\u8acb\u52d9\u5fc5 \u6aa2\u67e5\u7bc0\u9ede\u503c\u53ef\u5426\u70ba\u8ca0\u6578 Java<pre><code>// \u8a08\u7b97\u4e8c\u5143\u6a39\u6240\u6709\u7bc0\u9ede\u503c\u7684\u7e3d\u548c\nclass BinaryTree {\n    public int sumOfNodes(TreeNode root) {\n        if (root == null) return 0;\n        return root.val + sumOfNodes(root.left) + sumOfNodes(root.right);\n    }\n}\n</code></pre></p> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_8","title":"\u57fa\u672c\u984c\u578b","text":"<ul> <li> <p>LeetCode 104. (E): \u6c42\u4e8c\u5143\u6a39\u7684\u6700\u5927\u6df1\u5ea6</p> <ul> <li>Maximum Depth of Binary Tree</li> <li>\u601d\u8def: <ul> <li>\u4f7f\u7528\u905e\u8ff4\u6cd5\uff0c\u5206\u5225\u8a08\u7b97\u5de6\u3001\u53f3\u5b50\u6a39\u7684\u6df1\u5ea6</li> <li>\u8a08\u7b97\u6574\u68f5\u4e8c\u5143\u6a39\u7684\u6df1\u5ea6 = \u5de6\u5b50\u6a39\u6df1\u5ea6 + \u53f3\u5b50\u6a39\u6df1\u5ea6 + 1 (root \u4e5f\u8981\u7b97\u9032\u53bb)  \u5716\u7247\u51fa\u8655</li> </ul> </li> </ul> Java<pre><code>import java.lang.*;\n\n/**\n * \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u4e8c\u5143\u6a39\u7684\u7bc0\u9ede\u6578\u91cf\n * \u7a7a\u9593: O(n)\uff0c\u82e5\u6700\u5dee\u60c5\u6cc1\u4e0b\uff0c\u905e\u8ff4\u6df1\u5ea6\u7b49\u65bc\u4e8c\u5143\u6a39\u7684\u9ad8\u5ea6\n */\nclass Solution {\n    public int maxDepth(TreeNode root) {\n        // \u82e5\u70ba\u7a7a\u6a39\uff0c\u6df1\u5ea6\u70ba 0\n        if (root == null) {\n            return 0;\n        } else {\n            // \u5206\u5225\u8a08\u7b97\u5de6\u3001\u53f3\u5b50\u6a39\u7684\u6df1\u5ea6\n            int leftDepth = maxDepth(root.left);\n            int rightDepth = maxDepth(root.right);\n            // \u6574\u68f5\u4e8c\u5143\u6a39\u7684\u6df1\u5ea6 = \u5de6\u5b50\u6a39\u6df1\u5ea6 + \u53f3\u5b50\u6a39\u6df1\u5ea6 + 1 (root \u4e5f\u8981\u7b97\u9032\u53bb)\n            return Math.max(leftDepth, rightDepth) + 1;\n        }\n    }\n}\n</code></pre> </li> <li> <p>LeetCode 226. (E): \u53cd\u8f49\u4e8c\u5143\u6a39</p> <ul> <li>Invert Binary Tree</li> <li>\u601d\u8def: <ul> <li>\u4f7f\u7528\u905e\u8ff4\u6cd5\uff0c\u5206\u5225\u53cd\u8f49\u5de6\u3001\u53f3\u5b50\u6a39</li> <li>\u53cd\u8f49\u5b50\u6a39\u7684\u6240\u6709\u5de6\u3001\u53f3\u7bc0\u9ede</li> </ul> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> Java<pre><code>// \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u4e8c\u5143\u6a39\u7684\u7bc0\u9ede\u6578\u91cf\n// \u7a7a\u9593: O(n)\uff0c\u82e5\u6700\u5dee\u60c5\u6cc1\u4e0b\uff0c\u905e\u8ff4\u6df1\u5ea6\u7b49\u65bc\u4e8c\u5143\u6a39\u7684\u9ad8\u5ea6\nclass Solution {\n    public TreeNode invertTree(TreeNode root) {\n        // base case: \u82e5\u70ba\u7a7a\u6a39\u7684\u60c5\u6cc1\u4e0b\uff0c\u4e0d\u505a\u4efb\u4f55\u905e\u8ff4\u53cd\u8f49\n        if (root == null) {\n            return null;\n        } else {\n            // \u905e\u8ff4\u53cd\u8f49\u5de6\u3001\u53f3\u5b50\u6a39\n            invertTree(root.left);\n            invertTree(root.right);\n\n            // \u53cd\u8f49\u5b50\u6a39\u7684\u6240\u6709\u5de6\u3001\u53f3\u7bc0\u9ede\n            TreeNode temp = root.left;\n            root.left = root.right;\n            root.right = temp;\n        }\n\n        return root;\n    }\n}\n</code></pre> </li> <li> <p>LeetCode 235. (M): \u6c42\u4e8c\u5143\u641c\u5c0b\u6a39\u7684\u6700\u8fd1\u5171\u540c\u7956\u5148\u7bc0\u9ede</p> <ul> <li>Lowest Common Ancestor of a Binary Search Tree</li> <li>\u601d\u8def: \u63a1\u8fed\u4ee3\u641c\u5c0b\u6cd5\uff0c\u5f9e\u6839\u7bc0\u9ede\u958b\u59cb\uff0c\u9010\u6b65\u5411\u4e0b\u641c\u5c0b\uff0c\u76f4\u5230\u627e\u5230\u6700\u8fd1\u5171\u540c\u7956\u5148\u7bc0\u9ede  \u5716\u7247\u51fa\u8655</li> </ul> Java<pre><code>// \u6642\u9593: O(n)\uff0c\u5176\u4e2d n \u662f\u4e8c\u5143\u641c\u5c0b\u6a39\u7684\u7bc0\u9ede\u6578\u91cf\n// \u7a7a\u9593: O(1)\uff0c\u56e0\u70ba\u63a1\u7528\u8fed\u4ee3\u904d\u6b77\u6cd5\uff0c\u4e0d\u9700\u50cf\u905e\u8ff4\u6cd5\u4e00\u6a23\u9700\u8981\u984d\u5916\u7684 stack \u7a7a\u9593\u4f86\u5132\u5b58 recursive function call \u7684\u72c0\u614b\nclass Solution {\n    public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) {\n        // \u8fed\u4ee3\u5f80\u4e0b\u641c\u5c0b\uff0c\u76f4\u5230\u627e\u5230\u6700\u8fd1\u5171\u540c\u7956\u5148\u7bc0\u9ede\n        while (root != null) {\n            // \u8868\u793a p, q \u7bc0\u9ede\u90fd\u5728 root \u7684\u5de6\u5b50\u6a39\u4e2d\uff0c\u5247\u5f80\u7576\u524d node \u7684\u5de6\u5b50\u6a39\u7e7c\u7e8c\u641c\u5c0b LCA\n            if ((p.val &lt; root.val) &amp;&amp; (q.val &lt; root.val)) {\n                return root.left;\n            // \u8868\u793a p, q \u7bc0\u9ede\u90fd\u5728 root \u7684\u53f3\u5b50\u6a39\u4e2d\uff0c\u5247\u5f80\u7576\u524d node \u7684\u53f3\u5b50\u6a39\u7e7c\u7e8c\u641c\u5c0b LCA\n            } else if ((p.val &gt; root.val) &amp;&amp; (q.val &gt; root.val)) {\n                return right;\n            // \u8868\u793a p, q \u7bc0\u9ede\u5206\u5225\u5728 root \u7684\u5de6\u3001\u53f3\u5b50\u6a39\u4e2d\uff0c\u5247\u7576\u524d node \u5373\u70ba LCA\n            } else {\n                return root;\n            }\n        }\n\n        return null;\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_9","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>Tech Interview Handbook --- Tree cheatsheet for coding interviews</li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#heap","title":"Heap","text":""},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#heap_1","title":"Heap \u7684\u985e\u578b","text":"<ul> <li>\u6700\u5c0f\u5806\u7a4d(Min Heap): \u6bcf\u500b\u7bc0\u9ede\u503c \u5728\u5176 \u6574\u500b\u5b50\u6a39\u4e2d\u5fc5\u9808\u662f\u6700\u5c0f\u7684</li> <li>\u6700\u5927\u5806\u7a4d(Max Heap): \u6bcf\u500b\u7bc0\u9ede\u503c \u5728\u5176 \u6574\u500b\u5b50\u6a39\u4e2d\u5fc5\u9808\u662f\u6700\u5927\u7684</li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_10","title":"\u5be6\u4f5c\u65b9\u5f0f","text":"\u7a0b\u5f0f\u8a9e\u8a00 \u51fd\u5f0f\u5eab C++ <code>std::priority_queue</code> Java <code>java.util.PriorityQueue</code> Python <code>heapq</code> JavaScript N/A"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_11","title":"\u5404\u9805\u64cd\u4f5c\u7684\u6642\u9593\u8907\u96dc\u5ea6","text":"\u5404\u9805\u64cd\u4f5c \u6642\u9593\u8907\u96dc\u5ea6 \u627e\u51fa\u6700\u5927\u503c/\u6700\u5c0f\u503c O(1) \u63d2\u5165\u5143\u7d20 O(logN) \u522a\u9664\u5143\u7d20 O(logN) Heapify (\u4f7f\u7528\u7d66\u5b9a\u7684\u9663\u5217\u4f86\u5efa\u7acb heap) O(N)"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#priorityqueue","title":"PriorityQueue \u7684\u5404\u9805\u64cd\u4f5c","text":"<ul> <li> <p>\u5efa\u7acb &amp; \u521d\u59cb\u5316 PriorityQueue     Java<pre><code>// \u5efa\u7acb\u6700\u5c0f\u5806\u7a4d (\u9810\u8a2d)\nPriorityQueue&lt;Integer&gt; minHeap = new PriorityQueue&lt;&gt;();\n// \u5efa\u7acb\u6700\u5927\u5806\u7a4d\nPriorityQueue&lt;Integer&gt; maxHeap = new PriorityQueue&lt;&gt;(Collections.reverseOrder());\n</code></pre></p> Java<pre><code>// \u6307\u5b9a\u521d\u59cb\u5bb9\u91cf(capacity)\uff0c\u53ef\u9078\u586b\uff0c\u9810\u8a2d\u70ba 11\nPriorityQueue&lt;Map.Entry&lt;Integer, Integer&gt;&gt; minHeap = new PriorityQueue&lt;&gt;(initialCapacity);\n// \u6307\u5b9a\u6bd4\u8f03\u5668(Comparator)\uff0c\u53ef\u9078\u586b\nPriorityQueue&lt;Map.Entry&lt;Integer, Integer&gt;&gt; minHeap = new PriorityQueue&lt;&gt;((a, b) -&gt; a.getValue() - b.getValue());\n</code></pre> </li> <li> <p><code>add(element)</code>: \u5411\u512a\u5148\u7d1a\u4f47\u5217\u4e2d\u65b0\u589e\u5143\u7d20</p> </li> <li><code>offer(element)</code>: \u5411\u512a\u5148\u4f47\u5217\u5217\u4e2d\u65b0\u589e\u5143\u7d20\uff0c\u8207 <code>add()</code> \u76f8\u4f3c\uff0c\u4f46\u5728\u4f47\u5217\u5bb9\u91cf\u5df2\u6eff\u6642\u4e0d\u6703\u62cb\u51fa\u7570\u5e38</li> <li><code>peek()</code>: \u6aa2\u8996\u4f46\u4e0d\u79fb\u9664 \u4f47\u5217\u982d\u90e8\u7684\u5143\u7d20; \u82e5\u4f47\u5217\u70ba\u7a7a\uff0c\u56de\u50b3 null</li> <li><code>poll()</code>: \u6aa2\u8996\u4e26\u79fb\u9664 \u4f47\u5217\u982d\u90e8\u7684\u5143\u7d20; \u82e5\u4f47\u5217\u70ba\u7a7a\uff0c\u56de\u50b3 null</li> <li><code>isEmpty()</code>: \u6aa2\u67e5\u4f47\u5217\u662f\u5426\u70ba\u7a7a</li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_12","title":"\u89e3\u984c\u6280\u5de7","text":"<ul> <li>\u627e\u51fa \u7b2c k \u5927/\u5c0f\u7684\u5143\u7d20\uff0c\u53ef\u4ee5\u4f7f\u7528 \u6700\u5c0f\u5806 \u6216 \u6700\u5927\u5806 \u4f86\u89e3\u6c7a\u554f\u984c\uff0c\u6bcf\u7576 heap \u7684\u5927\u5c0f\u8d85\u904e k\uff0c\u5c31\u79fb\u9664\u6700\u5c0f\u5143\u7d20\uff0c\u9019\u6a23\u80fd\u78ba\u4fdd heap \u4e2d\u53ea\u6709 k \u500b\u6700\u5927\u5143\u7d20</li> <li>\u7576\u6211\u5011\u9700\u8981\u91cd\u8907\u5730\u79fb\u9664\u6700\u5927\u503c/\u6700\u5c0f\u503c\u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 heap \u4f86\u89e3\u6c7a\u554f\u984c</li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_13","title":"\u57fa\u672c\u984c\u578b","text":"<ul> <li> <p>LeetCode 347. (M): \u51fa\u73fe\u983b\u7387\u524d K \u9ad8\u7684\u5143\u7d20</p> <ul> <li>Top K Frequent Elements</li> <li>\u601d\u8def<ul> <li>\u8655\u7406\u6975\u7aef\u60c5\u6cc1: \u82e5 <code>k</code>  == \u9663\u5217\u9577\u5ea6\uff0c\u8868\u793a\u6240\u6709\u5143\u7d20\u90fd\u662f\u9ad8\u983b\u5143\u7d20\uff0c\u76f4\u63a5\u8fd4\u56de <code>nums</code> \u9663\u5217</li> <li>\u8a08\u7b97\u983b\u7387: \u4f7f\u7528 HashMap \u8a08\u7b97\u6bcf\u500b\u5143\u7d20\u7684\u983b\u7387</li> <li>\u521d\u59cb\u5316 minHeap: \u5229\u7528 PriorityQueue \u4f86\u5be6\u73fe\u6700\u5c0f\u5806\uff0c\u6309\u7167\u983b\u7387\u6392\u5e8f</li> <li>\u7dad\u8b77 minHeap \u7684\u5927\u5c0f: \u904d\u6b77 <code>countMap</code> \u4e2d\u7684\u6240\u6709 key\uff0c\u5c07\u5176\u6dfb\u52a0\u5230 minHeap \u4e2d\uff0c\u4e26\u4e14\u7576 minHeap \u5927\u5c0f\u8d85\u904e <code>k</code> \u6642\u79fb\u9664\u5806\u9802\u5143\u7d20</li> <li>\u69cb\u5efa\u7d50\u679c\u9663\u5217: \u5f9e\u5806\u4e2d\u63d0\u53d6 <code>k</code> \u500b\u983b\u7387\u6700\u9ad8\u7684\u5143\u7d20\uff0c\u4e26\u653e\u5165\u7d50\u679c\u9663\u5217\u4e2d</li> </ul> </li> </ul> Java<pre><code>// \u6642\u9593: O(NlogK)\uff0c\u5176\u4e2d `N` \u662f nums \u9663\u5217\u7684\u9577\u5ea6; `K` \u70ba\u8fd4\u56de\u7684\u524d K \u9ad8\u983b\u5143\u7d20\n// \u7a7a\u9593: O(N)\uff0c\u7528\u65bc\u5132\u5b58 countMap O(N) + minHeap O(K)\nclass Solution {\n    public int[] topKFrequent(int[] nums, int k) {\n        // \u82e5 k \u7b49\u65bc nums \u7684\u9577\u5ea6\uff0c\u5247\u6240\u6709\u5143\u7d20\u90fd\u662f\u9ad8\u983b\u5143\u7d20\uff0c\u76f4\u63a5\u8fd4\u56de nums\n        if (k == nums.length) return nums;\n\n        // \u5efa\u7acb\u4e00\u500b hash map\uff0c\u8a18\u9304\u6bcf\u500b\u6578\u5b57\u51fa\u73fe\u7684\u983b\u7387\n        Map&lt;Integer, Integer&gt; countMap = new HashMap&lt;&gt;();\n        for (int num: nums) {\n            countMap.put(num, countMap.getOrDefault(num, 0)+1);\n        }\n\n        // \u521d\u59cb\u5316\u4e00\u500b minHeap\uff0c\u6839\u64da\u983b\u7387\u4f86\u6392\u5e8f (\u983b\u7387\u8f03\u5c0f\u7684\u5143\u7d20\u5728\u5806\u9802)\n        PriorityQueue&lt;Integer&gt; minHeap = \n            new PriorityQueue&lt;&gt;((num1, num2) -&gt; countMap.get(num1) - countMap.get(num2));\n\n        // \u4fdd\u6301 minHeap \u7684\u5927\u5c0f\u70ba k\uff0c\u7576\u5806\u7684\u5927\u5c0f\u8d85\u904e k \u6642\uff0c\u79fb\u9664\u5806\u9802\u5143\u7d20\n        // \u6642\u9593: O(NlogK)\n        for (int key: countMap.keySet()) {\n            minHeap.add(key);\n            if (minHeap.size() &gt; k) minHeap.poll();\n        }\n\n        // \u5f9e\u9ad8\u983b \uff5e \u4f4e\u983b\u7684\u9806\u5e8f\u6392\u5217\n        int[] res = new int[k];\n        for (int i = k-1; i &gt;= 0; i--) {\n            res[i] = minHeap.poll();\n        }\n\n        return res;\n    }\n}\n</code></pre> </li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_14","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>Tech Interview Handbook --- Heap cheatsheet for coding interviews</li> </ul>"},{"location":"coding_interview/tech_interview_handbook/coding_interview_prepararion/#_15","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>LeetCode: Code templates</li> <li>LeetCode: Stages of an interview</li> <li>LeetCode: Cheatsheets</li> </ul>"},{"location":"mkdocs_info/mkdocs/","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"mkdocs_info/mkdocs/#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - \u5efa\u7acb\u65b0\u7684 MKdocs \u5c08\u6848</li> <li><code>mkdocs serve</code> - \u555f\u52d5\u4e00\u500b\u652f\u63f4\u71b1\u66f4\u65b0\u7684 MKdocs \u4f3a\u670d\u5668</li> <li><code>mkdocs build</code> - \u5efa\u7acb MKdocs \u5c08\u6848\u7684\u975c\u614b\u7db2\u9801</li> <li><code>mkdocs -h</code> - \u5370\u51fa MKdocs \u7684\u6240\u6709\u5e6b\u52a9\u8a0a\u606f</li> <li><code>mkdocs gh-deploy --force</code> - \u624b\u52d5\u4f48\u7f72\u975c\u614b\u7db2\u9801\u81f3 GitHub pages</li> </ul>"},{"location":"mkdocs_info/mkdocs/#project-layout","title":"Project layout","text":"Text Only<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"mkdocs_info/mkdocs/#tips","title":"Tips","text":"<ul> <li>\u6bcf\u500b docs/md \u6587\u4ef6\uff0c\u52ff\u4f7f\u7528 H1 \u6a19\u984c (\u56e0\u70ba\u4e0d\u6703\u986f\u793a\u5728 table on contents)</li> <li>\u56e0\u70ba MKdocs \u9810\u8a2d md \u6587\u4ef6\u7684\u7f6e\u9802\u6a19\u984c\u5c31\u662f H1 \u6a19\u984c\uff0c\u6240\u4ee5\u5f9e H2 \u6a19\u984c\u958b\u59cb\u64b0\u5beb\u6587\u4ef6\u5167\u5bb9</li> <li>\u7c97\u9ad4\u5b57: <code>**\u7c97\u9ad4\u5b57**</code> \u7576\u9047\u5230\u7e41\u9ad4\u4e2d\u6587\u6642\uff0c\u56e0\u70ba\u975e\u7a7a\u767d\u5b57\u5143\u4f5c\u70ba\u5206\u9694\u7b26\u865f\u7684\u8a9e\u8a00\uff0c\u56e0\u6b64\u9700\u8981\u5728\u524d, \u5f8c\u52a0\u4e0a\u7a7a\u767d\u5b57\u5143\uff0c\u624d\u80fd\u986f\u793a\u6b63\u78ba\u7684\u7c97\u9ad4\u5b57<ul> <li>\u89e3\u6c7a\u65b9\u6848: \u7528 HTML \u6a19\u7c64   \u4f86\u8868\u793a\u7c97\u9ad4\u5b57</li> </ul> </li> <li>\u4e0b\u5283\u7dda: \u4f7f\u7528 HTML \u6a19\u7c64   \u4f86\u8868\u793a\u4e0b\u5283\u7dda</li> </ul>"},{"location":"mkdocs_info/mkdocs/#references","title":"References","text":"<ul> <li>Mkdocs \u90e8\u7f72\u975c\u614b\u7db2\u9801\u81f3 GitHub pages \u7d44\u614b\u8aaa\u660e (mkdocs.yml)</li> </ul>"},{"location":"networking/networking/","title":"Networking","text":"<p>\u91cd\u9ede\u6574\u7406</p> \u76ee\u9304<ul> <li>Networking<ul> <li>OSI Model</li> <li>Networking Protocol &amp; Ports</li> <li>Latency/Throughput/Performance<ul> <li>4 types of packet delay</li> <li>Notes</li> </ul> </li> <li>CDN</li> <li>Protocol<ul> <li>Layer 7: Application Layer<ul> <li>DNS (Domain Name System)</li> <li>HTTP (HyperText Transfer Protocol)</li> <li>Telnet protocol</li> <li>FTP (File Transfer Protocol)</li> <li>SSH (Secure Shell)</li> </ul> </li> <li>Layer 6: Presentation Layer<ul> <li>SSL/TLS</li> </ul> </li> <li>Layer 4: Transport Layer<ul> <li>TCP (Transmission Control Protocol)</li> </ul> </li> <li>Layer 3: Network Layer<ul> <li>subnet</li> <li>CIDR (Classless Inter-Domain Routing)</li> <li>IP (Internet Protocol)</li> <li>ICMP (Internet Control Message Protocol)</li> </ul> </li> </ul> </li> <li>Tools<ul> <li>netcat (nc)</li> <li>ping</li> <li>traceroute</li> <li>mtr</li> <li>tcpdump/wireshark<ul> <li>tcpdump</li> <li>WireShark</li> </ul> </li> <li>iperf</li> <li>curl</li> </ul> </li> <li>\u5176\u4ed6\u5b78\u7fd2\u8cc7\u6e90</li> </ul> </li> </ul>"},{"location":"networking/networking/#osi-model","title":"OSI Model","text":"<ul> <li> <p>OSI model vs. TCP/IP model</p> <ul> <li>OSI model: \u4e03\u5c64</li> <li>TCP/IP model: \u56db\u5c64</li> </ul> <p> \u5716\u7247\u51fa\u8655</p> </li> <li> <p>OSI model &amp; Networking Protocol</p> <p> \u5716\u7247\u51fa\u8655</p> <ul> <li>socket: \u5c6c\u65bc\u8868\u73fe\u5c64\uff08Layer 6\uff09\u3002socket \u662f\u4e00\u500b\u62bd\u8c61\u7684\u6982\u5ff5\uff0c\u7528\u65bc\u63cf\u8ff0\u901a\u8a0a\u7684\u4e00\u7aef\uff0c\u901a\u5e38\u7531 IP address + port number \u6240\u7d44\u6210</li> <li>port: \u5c6c\u65bc\u50b3\u8f38\u5c64\uff08Layer 4\uff09\u3002\u53ea\u6709 TCP, UDP \u5354\u5b9a\u624d\u80fd\u6307\u793a\u5c01\u5305\u61c9\u53bb\u5f80\u54ea\u500b port\uff0c\u56e0\u70ba TCP, UDP \u6a19\u982d\u6703\u6709\u4e00\u500b\u7528\u65bc\u6307\u793a port number \u7684\u5340\u6bb5</li> </ul> </li> </ul>"},{"location":"networking/networking/#networking-protocol-ports","title":"Networking Protocol &amp; Ports","text":"<ul> <li>\u5e38\u898b\u7684\u7db2\u8def\u5354\u5b9a\u8207\u76f8\u5c0d\u61c9\u7684 port     </li> </ul>"},{"location":"networking/networking/#latencythroughputperformance","title":"Latency/Throughput/Performance","text":"<ul> <li> <p>\u5ef6\u9072 (Latency): \u5c07\u5c01\u5305\u5f9e\u4e00\u7aef\u50b3\u8f38\u5230\u53e6\u4e00\u7aef\u6240\u9700\u7684\u6642\u9593      \u5716\u7247\u9023\u7d50</p> </li> <li> <p>\u541e\u5410\u91cf (Throughput): \u5728\u4e00\u6bb5\u6642\u9593\u5167\u9032\u5165/\u50b3\u51fa\u786c\u789f\u7684\u8cc7\u6599\u91cf     </p> </li> <li> <p>\u983b\u5bec (Bandwidth): \u5728\u4e00\u689d\u908f\u8f2f or \u5be6\u9ad4\u901a\u8a0a\u8def\u5f91\u4e2d\u7684\u6700\u5927\u541e\u5410\u91cf      \u5716\u7247\u9023\u7d50</p> </li> <li> <p>\u5f80\u8fd4\u6642\u9593 (Round-Trip Time, RTT): \u5f9e\u767c\u9001\u5c01\u5305 \uff5e \u63a5\u6536\u5230\u56de\u61c9\u5c01\u5305\u6240\u9700\u7684\u6642\u9593</p> <ul> <li>\u5305\u62ec Processing delay, Queuing delay, Transmission delay, Propagation delay</li> <li>\u662f\u8861\u91cf\u7db2\u8def\u6548\u80fd\u7684\u91cd\u8981\u6307\u6a19\u4e4b\u4e00\uff0c\u6578\u503c\u8d8a\u5c0f\u8868\u793a\u7db2\u8def\u50b3\u8f38\u6548\u7387\u8d8a\u9ad8 </li> </ul> </li> </ul>"},{"location":"networking/networking/#4-types-of-packet-delay","title":"4 types of packet delay","text":"<ul> <li>Processing delay: \u8655\u7406\u5c01\u5305\u6a19\u982d\u3001bit-level \u932f\u8aa4\u6aa2\u67e5\u3001\u6c7a\u5b9a\u5c01\u5305\u7684\u76ee\u7684\u5730\uff0c\u6240\u9700\u82b1\u8cbb\u7684\u6642\u9593<ul> <li>\u901a\u5e38\u662f\u5fae\u79d2\u7d1a (10<sup>-6</sup> \u79d2)</li> </ul> </li> <li>Queuing delay: \u5c01\u5305\u5728 router \u7684 queue \u4e2d\u7b49\u5f85\u88ab\u8655\u7406\u7684\u6642\u9593<ul> <li>\u53d6\u6c7a\u65bc router \u7684 traffic load</li> </ul> </li> <li>Transmission delay: \u5c01\u5305\u5f9e router \u7684 output port \u8f38\u51fa\u5230 link \u4e0a\u6240\u9700\u82b1\u8cbb\u7684\u6642\u9593<ul> <li>\u53d6\u6c7a\u65bc\u5c01\u5305\u9577\u5ea6\u3001link \u7684\u983b\u5bec</li> </ul> </li> <li>Propagation delay: \u5c01\u5305\u5728 link \u4e0a\u50b3\u64ad\u6240\u9700\u82b1\u8cbb\u7684\u6642\u9593<ul> <li>\u53d6\u6c7a\u65bc link \u7684\u9577\u5ea6\u3001\u50b3\u64ad\u901f\u5ea6</li> <li>Propagation delay \u662f\u7531\u50b3\u8f38 link \u7684\u53ef\u7528\u8cc7\u6599\u901f\u7387\u6240\u6c7a\u5b9a\u7684\uff0c\u8207\u5ba2\u6236\u7aef, \u4f3a\u670d\u5668\u4e4b\u9593\u7684\u8ddd\u96e2\u7121\u95dc</li> </ul> </li> </ul>"},{"location":"networking/networking/#notes","title":"Notes","text":"<ul> <li>\u7db2\u8def\u8cc7\u6599\u901f\u7387\u901a\u5e38\u4ee5 bits per second (bps) \u8868\u793a; \u800c\u975e\u7db2\u8def\u8a2d\u5099\u7684\u8cc7\u6599\u901f\u7387\u901a\u5e38\u4ee5 bytes per second (Bps) \u8868\u793a</li> <li>\u5167\u5bb9\u4ea4\u4ed8\u7db2\u8def (CDN): \u5728\u5168\u7403\u7bc4\u570d\u5167\u5206\u767c\u5167\u5bb9\u4e26\u5f9e\u9644\u8fd1\u4f4d\u7f6e\u5411\u5ba2\u6236\u7aef\u63d0\u4f9b\u5167\u5bb9\uff0c\u4f7f\u6211\u5011\u80fd\u5920\u986f\u8457\u6e1b\u5c11\u6240\u6709\u8cc7\u6599\u5c01\u5305\u7684\u50b3\u64ad\u6642\u9593<ul> <li>\u96d6\u7136\u6211\u5011\u7121\u6cd5\u4f7f\u8cc7\u6599\u5c01\u5305\u50b3\u8f38\u5f97\u66f4\u5feb\uff0c\u4f46\u6211\u5011\u53ef\u4ee5\u900f\u904e\u7b56\u7565\u6027\u5730\u5c07\u4f3a\u670d\u5668\u653e\u7f6e\u5728\u66f4\u9760\u8fd1\u4f7f\u7528\u8005\u7684\u4f4d\u7f6e\u4f86\u7e2e\u77ed\u8ddd\u96e2\uff0c\u5f9e\u800c\u6e1b\u5c11\u50b3\u64ad\u5ef6\u9072</li> </ul> </li> <li>\u6700\u5f8c\u4e00\u54e9\u5ef6\u9072 (Last-Mile Latency): \u4e8b\u5be6\u4e0a\uff0c\u7db2\u8def\u5ef6\u9072\u4e3b\u8981\u767c\u751f\u5728 \u5bb6\u6236\u3001\u8fa6\u516c\u5ba4  ISP  \u7db2\u969b\u7db2\u8def \u9019\u6bb5\u4e0a\uff0c\u800c\u975e\u8de8\u8d8a\u6d77\u6d0b or \u5927\u9678\u7684\u6d77\u5e95\u96fb\u7e9c\u50b3\u8f38\u904e\u7a0b\u4e0a<ul> <li>\u6839\u64da\u9023\u63a5\u985e\u578b\u3001\u8def\u7531\u65b9\u6cd5\u3001\u90e8\u7f72\u7684\u6280\u8853\uff0c\u50c5\u524d\u5e7e\u8df3\uff08\u6700\u5f8c\u4e00\u54e9\u5ef6\u9072\uff09\u5c31\u53ef\u80fd\u9700\u8981\u6578\u5341\u6beb\u79d2<ul> <li>\u5149\u7e96: 10-20 \u6beb\u79d2 (\u5e73\u5747\u6027\u80fd\u6700\u4f73)</li> <li>\u96fb\u7e9c: 15-40 \u6beb\u79d2</li> <li>\u6578\u4f4d\u7528\u6236\u7dda\u8def (Digital Subscriber Line, DSL): 30-65 \u6beb\u79d2</li> </ul> </li> <li>\u53ef\u904b\u7528 <code>traceroute</code> \u6307\u4ee4\uff0c\u4f86\u8ffd\u8e64\u8cc7\u6599\u5c01\u5305\u50b3\u8f38\u6642\uff0c\u6bcf\u4e00\u8df3\u7684\u8def\u5f91      \u5716\u7247\u51fa\u8655</li> </ul> </li> <li>\u5c0d\u65bc\u5927\u591a\u6578\u7db2\u7ad9\u4f86\u8aaa\uff0c\u5ef6\u9072\u624d\u662f\u6548\u80fd\u80fd\u74f6\u9838\uff0c\u800c\u4e0d\u662f\u983b\u5bec\uff01      \u5716\u7247\u51fa\u8655</li> <li>\u5be6\u52d9\u4e0a\uff0c\u4f5c\u70ba\u4e00\u500b\u53c3\u8003\u4f9d\u64da\uff0c\u6536\u770b\u4e00\u500b HD \u4e32\u6d41\u5f71\u7247\u7d04\u9700 2 ~ 10 Mbps \u7684\u983b\u5bec\uff0c\u800c 4K \u5f71\u7247\u5247\u9700\u8981 25 Mbps \u4ee5\u4e0a\u7684\u983b\u5bec\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u5f71\u7247\u89e3\u6790\u5ea6\u3001\u7de8/\u89e3\u78bc\u5668</li> <li>\u53c3\u8003\u9023\u7d50: O'Reilly: High Performance Browser Networking</li> </ul>"},{"location":"networking/networking/#cdn","title":"CDN","text":"<ul> <li> <p>\u8aaa\u660e: \u5167\u5bb9\u4ea4\u4ed8\u7db2\u8def\uff08Content Delivery Network, CDN\uff09\u662f\u4e00\u7a2e\u4e92\u9023\u4f3a\u670d\u5668\u7db2\u8def\uff0c\u53ef\u52a0\u5feb\u8cc7\u6599\u5bc6\u96c6\u578b\u61c9\u7528\u7a0b\u5f0f\u7684\u7db2\u9801\u8f09\u5165\u901f\u5ea6\u3002\u5b58\u653e\u5728 CDN \u4f3a\u670d\u5668\u4e0a\u7684\u7db2\u7ad9\u5167\u5bb9\u5728\u5730\u7406\u4f4d\u7f6e\u4e0a\u9760\u8fd1\u4f7f\u7528\u8005\uff0c\u4fbf\u80fd\u66f4\u5feb\u5730\u50b3\u9001\u5230\u4ed6\u5011\u7684\u96fb\u8166      \u5716\u7247\u51fa\u8655</p> </li> <li> <p>\u4e3b\u8981\u76ee\u7684: \u6e1b\u5c11\u7531\u7db2\u8def\u8a2d\u8a08\u9020\u6210\u7684\u901a\u8a0a\u5ef6\u9072</p> </li> <li>CDN \u512a\u9ede<ul> <li>\u7e2e\u77ed\u9801\u9762\u8f09\u5165\u6642\u9593</li> <li>\u964d\u4f4e\u983b\u5bec\u6210\u672c: \u900f\u904e\u5feb\u53d6\u548c\u5176\u4ed6\u6700\u4f73\u5316\uff0cCDN \u53ef\u4ee5\u6e1b\u5c11\u539f\u59cb\u4f3a\u670d\u5668\u5fc5\u9808\u63d0\u4f9b\u7684\u8cc7\u6599\u91cf\uff0c\u5f9e\u800c\u964d\u4f4e\u7db2\u7ad9\u64c1\u6709\u8005\u7684\u8a17\u7ba1\u6210\u672c</li> <li>\u63d0\u9ad8\u5167\u5bb9\u7684\u5168\u7403\u53ef\u7528\u6027: \u4e00\u6b21\u592a\u591a\u8a2a\u5ba2\u6216\u7db2\u8def\u786c\u9ad4\u6545\u969c\u53ef\u80fd\u5c0e\u81f4\u7db2\u7ad9\u7576\u6a5f\u3002CDN \u670d\u52d9\u53ef\u4ee5\u8655\u7406\u66f4\u591a\u7684 Web \u6d41\u91cf\u4e26\u6e1b\u5c11 Web \u4f3a\u670d\u5668\u7684\u8ca0\u8f09\u3002\u6b64\u5916\uff0c\u5982\u679c\u4e00\u53f0\u6216\u591a\u53f0 CDN \u4f3a\u670d\u5668\u96e2\u7dda\uff0c\u5176\u4ed6\u71df\u904b\u4f3a\u670d\u5668\u53ef\u4e88\u4ee5\u53d6\u4ee3\uff0c\u4ee5\u78ba\u4fdd\u670d\u52d9\u4e0d\u4e2d\u65b7</li> </ul> </li> <li>\u61c9\u7528\u60c5\u5883<ul> <li>\u9ad8\u901f\u5167\u5bb9\u4ea4\u4ed8: e.g. \u8def\u900f\u793e\u900f\u904e CDN \u53ca\u6642\u5411\u5168\u7403\u5ba2\u6236\u63d0\u4f9b\u65b0\u805e\u5167\u5bb9</li> <li>\u5373\u6642\u4e32\u6d41: e.g. Netflix \u900f\u904e CDN \u63d0\u4f9b\u9ad8\u54c1\u8cea\u7684\u4e32\u6d41\u5f71\u7247</li> <li>\u652f\u63f4\u591a\u7528\u6236\u540c\u6642\u4f7f\u7528: e.g. \u7dda\u4e0a\u904a\u6232\u516c\u53f8\u53ef\u4ee5\u900f\u904e AWS CloudFront \u4f86\u652f\u63f4\u591a\u7528\u6236\u540c\u6642\u904a\u73a9</li> </ul> </li> <li>CDN \u91cd\u8981\u529f\u80fd<ul> <li>CDN Geo-location: \u4f7f\u7528\u8005\u6839\u64da\u5176\u5730\u7406\u4f4d\u7f6e\uff0c\u81ea\u52d5\u9023\u63a5\u5230\u6700\u8fd1\u7684 CDN \u4f3a\u670d\u5668\u7bc0\u9ede\uff0c\u5f9e\u800c\u6e1b\u5c11\u5ef6\u9072\u3001\u63d0\u9ad8\u8cc7\u6599\u50b3\u8f38\u901f\u5ea6\u3001\u512a\u5316\u4f7f\u7528\u8005\u9ad4\u9a57<ul> <li>\u4f8b\u5982: \u82e5\u4f7f\u7528\u8005\u4f4d\u65bc\u4e9e\u6d32\uff0c\u5247 CDN \u6703\u81ea\u52d5\u5c07\u5176\u9023\u63a5\u5230\u4e9e\u6d32\u7684\u4f3a\u670d\u5668\uff0c\u800c\u4e0d\u662f\u4f4d\u65bc\u5317\u7f8e\u7684\u4f3a\u670d\u5668</li> </ul> </li> <li>CDN Geo-restriction: \u6839\u64da\u4f7f\u7528\u8005\u7684\u5730\u7406\u4f4d\u7f6e\u9650\u5236\u5176\u5c0d\u67d0\u4e9b\u5167\u5bb9\u7684\u8a2a\u554f\u3002\u9019\u7a2e\u6a5f\u5236\u901a\u5e38\u7528\u65bc\u9075\u5b88\u7248\u6b0a\u6216\u6cd5\u5f8b\u898f\u7bc4\uff0c\u9650\u5236\u67d0\u4e9b\u570b\u5bb6\u3001\u5730\u5340\u7684\u4f7f\u7528\u8005\u5b58\u53d6\u7279\u5b9a\u5167\u5bb9<ul> <li>\u4f8b\u5982: Geo-restriction \u53ef\u4ee5\u900f\u904e\u5728 CDN \u8a2d\u5b9a\u4e2d\u9650\u5236 IP \u4f4d\u5740\u7bc4\u570d, \u5730\u5340\u4f86\u5be6\u73fe</li> </ul> </li> </ul> </li> <li> <p>AWS CloudFront \u670d\u52d9</p> <ul> <li>\u662f\u4e00\u7a2e CDN \u670d\u52d9\uff0c\u900f\u904e\u5728\u908a\u7de3\u4f4d\u7f6e (edge locations)\u4e0a\u5feb\u53d6\u5167\u5bb9\uff0c\u4ee5\u63d0\u5347\u8b80\u53d6\u6548\u80fd<ul> <li>\u82e5\u6240\u9700\u7684\u5167\u5bb9\u672a\u5728\u908a\u7de3\u4f4d\u7f6e\u4e0a\u5feb\u53d6\uff0c\u5247\u5fc5\u9808\u5411\u539f\u59cb\u4f3a\u670d\u5668\u7aef\u53d6\u5f97</li> </ul> </li> <li> <p>\u652f\u63f4 signed URL, signed cookie \u5b83\u5011\u53ef\u8b93\u60a8\u63a7\u5236\u8ab0\u53ef\u4ee5\u5b58\u53d6 AWS CloudFront \u7684\u5167\u5bb9      \u5716\u7247\u51fa\u8655</p> <ul> <li>signed URL: \u7528\u65bc\u9650\u5236\u7279\u5b9a\u7684 URL\uff0c\u4ee5\u4fbf\u53ea\u6709\u64c1\u6709 signed URL \u7684\u4eba\u624d\u80fd\u5b58\u53d6<ul> <li>\u4f7f\u7528\u60c5\u5883: <ul> <li>\u9650\u5236\u5c0d\u55ae\u4e00\u6a94\u6848\u7684\u5b58\u53d6\u6b0a\u9650\uff0c\u4f8b\u5982: \u61c9\u7528\u7a0b\u5f0f\u7684\u5b89\u88dd\u4e0b\u8f09</li> <li>\u4f7f\u7528\u8005\u6b63\u5728\u4f7f\u7528\u4e0d\u652f\u63f4 cookie \u7684\u5ba2\u6236\u7aef\uff08\u4f8b\u5982: \u81ea\u8a02 HTTP \u5ba2\u6236\u7aef\uff09</li> </ul> </li> </ul> </li> <li>signed cookie: \u7528\u65bc\u9650\u5236\u7279\u5b9a\u7684 cookie\uff0c\u4ee5\u4fbf\u53ea\u6709\u64c1\u6709 signed cookie \u7684\u4eba\u624d\u80fd\u5b58\u53d6<ul> <li>\u4f7f\u7528\u60c5\u5883: <ul> <li>\u9650\u5236\u5c0d\u591a\u500b\u6a94\u6848\u7684\u5b58\u53d6\u6b0a\u9650\uff0c\u4f8b\u5982: \u8a02\u95b1\u8005\u80fd\u5b58\u53d6\u7684\u6240\u6709\u9650\u5236\u5167\u5bb9</li> <li>\u4e0d\u60f3\u6539\u8b8a\u73fe\u6709\u7684 URL</li> </ul> </li> </ul> </li> </ul> <p>\u82e5\u540c\u6642\u4f7f\u7528\uff0csigned URL \u6703\u512a\u5148\u65bc signed cookie\uff0cAWS CloudFront \u6703\u50c5\u6839\u64da\u6aa2\u67e5 signed URL\uff0c\u4f86\u6c7a\u5b9a\u662f\u5426\u5141\u8a31\u5b58\u53d6</p> </li> <li> <p>\u7279\u8272</p> <ul> <li>Origin Access Control (OAC) - \u8f03\u65b0\u7684\u9078\u9805<ul> <li>\u652f\u63f4\u66f4\u7d30\u7c92\u5ea6\u7684\u63a7\u5236\uff0c\u4e26\u4e14\u652f\u63f4\u591a\u7a2e AWS \u670d\u52d9\u4f5c\u70ba\u539f\u9ede\uff08\u4f8b\u5982: S3, ALB, EC2 \u7b49\uff09\uff0c\u4e0d\u50c5\u9650\u65bc S3</li> <li>\u63d0\u4f9b\u4e86\u66f4\u5f37\u7684\u5b89\u5168\u63a7\u5236\uff0c\u4f8b\u5982: \u5f37\u5236 HTTPS\u3001\u589e\u5f37\u7684\u4f7f\u7528\u8005\u8a8d\u8b49\u6a5f\u5236</li> </ul> </li> <li>Origin Access Identity (OAI)<ul> <li>\u9650\u5236\u50c5\u80fd\u900f\u904e AWS CloudFront \u5b58\u53d6 S3 \u6a94\u6848\u3002\u9632\u6b62\u4f7f\u7528\u8005\u50c5\u4f7f\u7528\u6a94\u6848\u7684 URL \u76f4\u63a5\u67e5\u770b\u60a8\u7684 S3 \u6a94\u6848<ul> <li>\u82e5\u4e0d\u60f3\u4f7f\u7528 OAI\uff0c\u5247 S3 \u5b58\u5132\u6876\u5fc5\u9808\u5141\u8a31\u516c\u958b\u5b58\u53d6\u6b0a\u9650</li> </ul> </li> </ul> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50: </p> <ul> <li>AWS: What is a CDN (Content Delivery Network)?</li> <li>AWS: Decide to use signed URLs or signed cookies</li> </ul> </li> </ul>"},{"location":"networking/networking/#protocol","title":"Protocol","text":"<p> \u5716\u7247\u51fa\u8655</p> <p> \u5716\u7247\u51fa\u8655</p> <p> \u5716\u7247\u51fa\u8655</p>"},{"location":"networking/networking/#layer-7-application-layer","title":"Layer 7: Application Layer","text":""},{"location":"networking/networking/#dns-domain-name-system","title":"DNS (Domain Name System)","text":"<ul> <li>\u8aaa\u660e: \u662f\u4e00\u7a2e\u80fd\u5c07\u7db2\u57df\u540d\u7a31\u8f49\u63db\u6210 IP \u4f4d\u5740\uff08domain name  IP address\uff09\u7684\u7d22\u5f15\u67e5\u8a62\u670d\u52d9\u3002DNS \u7b97\u662f\u4e00\u500b\u96c6\u5408\u540d\u8a5e\uff0c\u70ba\u5404\u5730\u3001\u5404\u6a5f\u69cb\u7684\u540d\u7a31\u4f3a\u670d\u5668\uff08name server\uff09\u6240\u69cb\u6210\u7684\u7d9c\u5408\u7d71\u7a31</li> <li> <p>DNS \u670d\u52d9\u7684\u529f\u80fd:</p> <ul> <li>\u8f49\u63db \u7db2\u57df\u540d\u7a31  IP \u4f4d\u5740</li> <li>\u652f\u63f4 \u7db2\u57df\u540d\u7a31\u7684\u5225\u540d\u670d\u52d9\uff08alias\uff09</li> <li>\u652f\u63f4\u7db2\u9801\u4f3a\u670d\u5668\u7684\u8ca0\u8f09\u5e73\u8861: \u8b93\u591a\u500b IP \u4f4d\u5740\u90fd\u5c0d\u61c9\u5230\u540c\u4e00\u500b\u7db2\u57df\u540d\u7a31\uff0c\u4ee5\u5be6\u73fe\u8ca0\u8f09\u5e73\u8861 </li> </ul> </li> <li> <p>DNS \u7684\u5206\u6563\u5f0f\u3001\u968e\u5c64\u5f0f\u67b6\u69cb</p> <ul> <li> <p>Local DNS Server: \u4f4d\u65bc ISP \u5167\u90e8\uff0c\u6703\u5148\u67e5\u770b\u5176\u5feb\u53d6\u5167\u5bb9\uff08cache\uff09\u4e2d\u662f\u5426\u6709\u5339\u914d\u7684 DNS entry; \u82e5\u6c92\u6709\uff0c\u5c31\u6703\u5c07\u67e5\u8a62\u5c0e\u5411 Root DNS Server\uff0c\u7e7c\u7e8c\u9032\u4e00\u6b65\u7684\u67e5\u8a62</p> <ul> <li>Local DNS Server \u4e0d\u96b8\u5c6c\u65bc\u4efb\u4f55\u4e00\u500b DNS \u968e\u5c64\u5f0f\u67b6\u69cb\u7684\u5c64\u7d1a\uff0c\u800c\u662f\u4e00\u500b\u7368\u7acb\u7684 DNS \u4f3a\u670d\u5668\uff0c\u5176\u529f\u80fd\u985e\u4f3c\u65bc <code>/etc/hosts</code> \u6a94\u6848<ul> <li>Local DNS Server \u7684\u5feb\u53d6\u662f\u4e00\u500b\u52d5\u614b\u7684\u3001\u96a8\u6642\u9593\u66f4\u65b0\u7684\u8cc7\u6599\u5eab\uff0c\u7528\u65bc\u52a0\u901f\u591a\u6b21\u67e5\u8a62\u76f8\u540c\u57df\u540d\u7684\u904e\u7a0b</li> <li><code>/etc/hosts</code> \u6a94\u6848\u5247\u662f\u4e00\u500b\u975c\u614b\u7684\u3001\u624b\u52d5\u8a2d\u5b9a\u7684\u5feb\u53d6\u6a94\u6848\uff0c\u512a\u5148\u7d1a\u9ad8\u65bc DNS \u4f3a\u670d\u5668\u67e5\u8a62</li> </ul> </li> </ul> <p></p> </li> <li> <p>Root DNS Server: \u8ca0\u8cac\u7ba1\u7406\u5168\u7403 DNS \u540d\u7a31\u7a7a\u9593\u7684\u6700\u9ad8\u5c64\u7d1a\uff0c\u4e26\u5c07\u67e5\u8a62\u5c0e\u5411\u4e0b\u4e00\u5c64\u7684 TLD DNS Server</p> </li> <li>Top Level Domain DNS Server: \u8ca0\u8cac\u7ba1\u7406\u7279\u5b9a\u9802\u7d1a\u57df\u540d\uff08TLD\uff09\u7684 DNS \u8a18\u9304\uff0c\u4e26\u5c07\u67e5\u8a62\u5c0e\u5411\u4e0b\u4e00\u5c64\u7684 Authoritative DNS Server</li> <li>Authoritative DNS Server: \u8ca0\u8cac\u7ba1\u7406\u7279\u5b9a\u7db2\u57df\u540d\u7a31\u7684 DNS \u8a18\u9304\uff0c\u4e26\u56de\u7b54 DNS \u67e5\u8a62  </li> </ul> </li> <li> <p>DNS \u67e5\u8a62\u7684\u5169\u7a2e\u65b9\u5f0f</p> <ul> <li> <p>Recursive Query: \u5ba2\u6236\u7aef\u6703\u5148\u5c0d Resolver Server \u767c\u9001 DNS \u67e5\u8a62\u8acb\u6c42\u5f8c\uff0cDNS \u4f3a\u670d\u5668\u6703\u5c07\u67e5\u8a62\u5c0e\u5411\u4e0b\u4e00\u5c64\u7684 DNS \u4f3a\u670d\u5668\uff0c\u76f4\u5230\u627e\u5230\u5339\u914d\u7684 DNS \u8a18\u9304\uff0c\u4e26\u5c07\u7d50\u679c\u8fd4\u56de\u7d66\u5ba2\u6236\u7aef</p> <ul> <li>\u9810\u8a2d\u63a1\u7528\u9019\u500b DNS \u67e5\u8a62\u65b9\u5f0f\uff0c\u56e0\u70ba\u5c0d\u5ba2\u6236\u7aef\u8f03\u70ba\u7c21\u55ae\uff0c\u53ea\u9700\u7b49\u5f85\u6700\u7d42\u7b54\u6848\u5373\u53ef </li> </ul> </li> <li> <p>Iterative Query: \u5ba2\u6236\u7aef\u6703\u5148\u5c0d Resolver Server \u767c\u9001 DNS \u67e5\u8a62\u8acb\u6c42\u5f8c\uff0cDNS \u4f3a\u670d\u5668\u6703\u5c07\u67e5\u8a62\u5c0e\u5411\u4e0b\u4e00\u5c64\u7684 DNS \u4f3a\u670d\u5668\uff0c\u4f46\u4e0d\u6703\u7b49\u5f85\u7d50\u679c\uff0c\u800c\u662f\u5c07\u67e5\u8a62\u7d50\u679c\u8fd4\u56de\u7d66\u5ba2\u6236\u7aef\uff0c\u8b93\u5ba2\u6236\u7aef\u81ea\u884c\u8655\u7406</p> <ul> <li>\u6e1b\u5c11\u5c0d DNS Server \u7684\u8ca0\u64d4\uff0c\u4f46\u5c0d\u5ba2\u6236\u7aef\u8f03\u70ba\u8907\u96dc\uff0c\u56e0\u70ba\u5b83\u5fc5\u9808\u8655\u7406\u591a\u500b\u67e5\u8a62\u8acb\u6c42\uff0c\u76f4\u5230\u7372\u5f97\u6700\u7d42\u7b54\u6848\uff0c\u6545\u67e5\u8a62\u904e\u7a0b\u53ef\u80fd\u8f03\u6162 </li> </ul> </li> </ul> </li> <li> <p>DNS \u67e5\u8a62\u6d41\u7a0b</p> <ul> <li>\u7576\u5ba2\u6236\u7aef\u767c\u9001 DNS \u67e5\u8a62\u6642\uff0cLocal DNS Server \u6703\u5148\u67e5\u770b\u5176\u5feb\u53d6\u5167\u5bb9\u4e2d\u662f\u5426\u6709\u5339\u914d\u7684 DNS entry; \u82e5\u6c92\u6709\uff0c\u5c31\u6703\u5c07\u67e5\u8a62\u5c0e\u5411 Root DNS Server\uff0c\u7e7c\u7e8c\u9032\u4e00\u6b65\u7684\u67e5\u8a62</li> <li>Root DNS Server \u6703\u5c07\u67e5\u8a62\u5c0e\u5411\u4e0b\u4e00\u5c64\u7684 TLD DNS Server</li> <li>\u518d\u5c07\u67e5\u8a62\u5c0e\u5411\u4e0b\u4e00\u5c64\u7684 Authoritative DNS Server\uff0c\u6700\u7d42\u56de\u7b54 DNS \u67e5\u8a62</li> </ul> </li> <li> <p>DNS \u7d00\u9304\u7684\u985e\u578b     </p> <ul> <li> <p>A (Address) Record: \u5c07\u7db2\u57df\u540d\u7a31  IPv4 \u4f4d\u5740</p> <ul> <li>\u4f7f\u7528\u60c5\u5883: IP \u4f4d\u5740\u67e5\u8a62\uff0c\u9019\u6a23\u53ef\u4ee5\u8b93\u4f7f\u7528\u8005\u7684\u88dd\u7f6e\u9023\u63a5\u4e26\u8f09\u5165\u7db2\u7ad9\uff0c\u800c\u4f7f\u7528\u8005\u7121\u9700\u8a18\u4f4f\u4e26\u8f38\u5165\u5be6\u969b IP \u4f4d\u5740 </li> </ul> </li> <li> <p>AAAA (IPv6 Address) Record: \u5c07\u7db2\u57df\u540d\u7a31  IPv6 \u4f4d\u5740</p> <ul> <li>\u4f7f\u7528\u60c5\u5883: \u50c5\u7576\u7db2\u57df\u540c\u6642\u64c1\u6709 IPv4\u3001IPv6 \u4f4d\u5740\uff0c\u4e14\u76f8\u95dc\u7684\u7528\u6236\u7aef\u88dd\u7f6e\u88ab\u8a2d\u5b9a\u70ba\u4f7f\u7528 IPv6 \u6642\uff0c\u624d\u6703\u4f7f\u7528 AAAA \u8a18\u9304</li> <li>\u96d6\u7136\u6240\u6709\u7db2\u57df\u90fd\u6709\u4e00\u500b\u6216\u591a\u500b IPv4 \u4f4d\u5740\u4ee5\u53ca\u76f8\u5c0d\u61c9\u7684 A \u8a18\u9304\uff0c\u4f46\u56e0\u70ba\u4e26\u975e\u6240\u6709\u7db2\u57df\u90fd\u6709 IPv6 \u4f4d\u5740\uff0c\u4e5f\u4e26\u975e\u6240\u6709\u7684\u4f7f\u7528\u8005\u88dd\u7f6e\u90fd\u88ab\u8a2d\u5b9a\u70ba\u4f7f\u7528 IPv6 </li> </ul> </li> <li> <p>CNAME (Canonical Name) Record: \u5c07\u7db2\u57df\u540d\u7a31  \u53e6\u4e00\u500b\u7db2\u57df\u540d\u7a31</p> <ul> <li>\u4f7f\u7528\u60c5\u5883: \u901a\u5e38\uff0c\u7576\u7db2\u7ad9\u5177\u6709\u5b50\u7db2\u57df\uff08\u4f8b\u5982: blog.example.com \u6216 shop.example.com\uff09\u6642\uff0c\u9019\u4e9b\u5b50\u7db2\u57df\u5c07\u5177\u6709\u6307\u5411\u6839\u7db2\u57df (example.com) \u7684 CNAME \u8a18\u9304\u3002\u9019\u6a23\uff0c\u5982\u679c\u4e3b\u6a5f\u7684 IP \u767c\u751f\u8b8a\u66f4\uff0c\u5247\u50c5\u9700\u8981\u66f4\u65b0\u6839\u7db2\u57df\u7684 DNS A \u8a18\u9304\uff0c\u9019\u6a23\u6240\u6709 CNAME \u8a18\u9304\u90fd\u6703\u8ddf\u96a8\u5c0d\u6839\u6240\u505a\u7684\u4efb\u4f55\u8b8a\u66f4 </li> </ul> </li> <li> <p>MX (Mail Exchange) Record: \u5c07\u7db2\u57df\u540d\u7a31  SMTP \u90f5\u4ef6\u4f3a\u670d\u5668\u7684 IP \u4f4d\u5740</p> <p>MX \u7d00\u9304\u5fc5\u9808\u76f4\u63a5\u6307\u5411 A \u7d00\u9304 or AAAA \u7d00\u9304\uff0c\u800c\u4e0d\u80fd\u6307\u5411 CNAME \u7d00\u9304</p> <ul> <li>\u4f7f\u7528\u60c5\u5883: <ul> <li>\u5047\u8a2d\u5728\u4e00\u500b\u5927\u578b\u4f01\u696d\u4e2d\uff0c\u6709\u591a\u500b SMTP \u90f5\u4ef6\u4f3a\u670d\u5668\uff0c\u53ef\u63d0\u4f9b\u5099\u63f4\u65b9\u6848\u3002\u82e5\u4e3b\u90f5\u4ef6\u4f3a\u670d\u5668\u7121\u6cd5\u5b58\u53d6\uff0c\u96fb\u5b50\u90f5\u4ef6\u6703\u81ea\u52d5\u8f49\u5411\u5099\u7528\u4f3a\u670d\u5668\uff0c\u9019\u6a23\u53ef\u4ee5\u63d0\u9ad8\u90f5\u4ef6\u670d\u52d9\u7684\u7a69\u5b9a\u6027\u3001\u53ef\u9760\u6027</li> <li>\u5047\u8a2d\u5728\u4e00\u500b\u5927\u578b\u4f01\u696d\u4e2d\uff0c\u6709\u591a\u500b SMTP \u90f5\u4ef6\u4f3a\u670d\u5668\uff0c\u53ef\u63d0\u4f9b\u8ca0\u8f09\u5e73\u8861\u3002\u9019\u6a23\u53ef\u4ee5\u5206\u6563\u90f5\u4ef6\u6d41\u91cf\uff0c\u6e1b\u5c11\u55ae\u4e00\u4f3a\u670d\u5668\u7684\u8ca0\u8f09</li> </ul> </li> </ul> <p></p> </li> <li> <p>NS (Name Server) Record: \u5c07\u7db2\u57df\u540d\u7a31  DNS \u4f3a\u670d\u5668\u7684 IP \u4f4d\u5740</p> <p>NS \u7d00\u9304\u4e0d\u80fd\u6307\u5411 CNAME \u7d00\u9304\uff0c\u56e0\u70ba CNAME \u7d00\u9304\u662f\u7528\u4f86\u6307\u5411\u53e6\u4e00\u500b\u7db2\u57df\u540d\u7a31\u7684\uff0c\u800c NS \u7d00\u9304\u662f\u7528\u4f86\u6307\u5411 DNS \u4f3a\u670d\u5668\u7684 IP \u4f4d\u5740\u7684</p> <ul> <li> <p>\u66f4\u65b0 NS \u8a18\u9304\u6642\uff0c\u53ef\u80fd\u9700\u8981\u904e\u5e7e\u500b\u5c0f\u6642\u624d\u80fd\u5c07\u8b8a\u66f4\u8907\u88fd\u5230\u6574\u500b DNS \u4e2d\uff0c\u9019\u662f\u56e0\u70ba DNS \u8a18\u9304\u6709\u4e00\u500b TTL\uff08Time to Live\uff09\u503c\uff0c\u9019\u500b\u503c\u6c7a\u5b9a\u4e86 DNS \u8a18\u9304\u5728 DNS \u4f3a\u670d\u5668\u4e0a\u4fdd\u7559\u7684\u6642\u9593</p> </li> <li> <p>\u4f7f\u7528\u60c5\u5883: \u544a\u8a34\u7db2\u969b\u7db2\u8def\u8981\u53bb\u54ea\u4e00\u500b Authorative DNS Server \u624d\u80fd\u627e\u5230\u6b32\u67e5\u8a62\u7684\u7db2\u57df\u7684 IP \u4f4d\u5740\u3002\u82e5\u6c92\u6709\u6b63\u78ba\u8a2d\u5b9a\u7684 NS \u8a18\u9304\uff0c\u4f7f\u7528\u8005\u5c07\u7121\u6cd5\u8f09\u5165\u7db2\u7ad9\u6216\u61c9\u7528\u7a0b\u5f0f </p> </li> </ul> </li> <li> <p>PTR (Pointer) Record: \u53cd\u5411\u67e5\u8a62 IP \u4f4d\u5740  \u7db2\u57df\u540d\u7a31</p> <ul> <li>\u4f7f\u7528\u60c5\u5883:<ul> <li>\u53cd\u5783\u573e\u90f5\u4ef6: \u6709\u4e9b\u96fb\u5b50\u90f5\u4ef6\u53cd\u5783\u573e\u90f5\u4ef6\u7be9\u9078\u5668\u6703\u4f7f\u7528\u53cd\u5411 DNS \u67e5\u8a62\u4f86\u6aa2\u67e5\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u7684\u7db2\u57df\u540d\u7a31\uff0c\u4e26\u67e5\u770b\u5176\u6240\u95dc\u806f\u7684 IP \u4f4d\u5740\u662f\u5426\u53ef\u80fd\u88ab\u5408\u6cd5\u96fb\u5b50\u90f5\u4ef6\u4f3a\u670d\u5668\u4f7f\u7528</li> <li>\u65e5\u8a8c\u8a18\u9304: \u7cfb\u7d71\u8a18\u9304\u6a94\u901a\u5e38\u53ea\u6703\u8a18\u9304 IP \u4f4d\u5740; \u800c\u53cd\u5411 DNS \u67e5\u8a62\u53ef\u4ee5\u5c07\u9019\u4e9b IP \u4f4d\u5740\u8f49\u63db\u70ba\u7db2\u57df\u540d\u7a31\uff0c\u4ee5\u53d6\u5f97\u66f4\u6613\u65bc\u95b1\u8b80\u7684\u8a18\u9304\u6a94</li> </ul> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> </li> <li> <p>SOA (Start of Authority) Record: \u662f\u6bcf\u500b DNS \u5340\u57df\u7684\u6838\u5fc3\u90e8\u5206\uff0c\u5305\u542b\u4e86\u8207\u8a72\u7db2\u57df\u6216\u5340\u57df\u76f8\u95dc\u7684\u91cd\u8981\u8cc7\u8a0a     </p> </li> <li> <p>SRV (Service) Record: \u70ba\u7279\u5b9a\u7684\u670d\u52d9\uff08\u4f8b\u5982: VoIP\u3001\u5373\u6642\u8a0a\u606f\uff09\u6307\u5b9a\u4e3b\u6a5f\u3001port\u3002\u5927\u591a\u6578\u5176\u4ed6 DNS \u8a18\u9304\u53ea\u6307\u5b9a\u4e00\u500b\u4f3a\u670d\u5668\u6216\u4e00\u500b IP \u4f4d\u5740\uff0c\u4f46 SRV \u8a18\u9304\u9084\u5305\u62ec\u8a72 IP \u4f4d\u5740\u7684\u4e00\u500b\u9023\u63a5\u57e0\u3002\u4e00\u4e9b\u7db2\u969b\u7db2\u8def\u901a\u8a0a\u5354\u5b9a\u9700\u8981\u4f7f\u7528 SRV \u8a18\u9304\u624d\u80fd\u904b\u4f5c</p> <p>SRV \u7d00\u9304\u7684\u4f3a\u670d\u5668\u540d\u7a31\u6b04\u4f4d\u5fc5\u9808\u6307\u5411 A \u7d00\u9304 or AAAA \u7d00\u9304\uff0c\u800c\u4e0d\u80fd\u6307\u5411 CNAME \u7d00\u9304</p> <p></p> </li> <li> <p>TXT (Text) Record: \u7528\u65bc\u5b58\u5132\u4efb\u610f\u6587\u672c\u8cc7\u8a0a</p> <ul> <li> <p>\u4f7f\u7528\u60c5\u5883: </p> <ul> <li> <p>\u5783\u573e\u90f5\u4ef6\u9632\u8b77</p> <ul> <li> <p>SPF\uff08Sender Policy Framework\uff09: TXT \u8a18\u9304\u5e38\u7528\u65bc\u5b9a\u7fa9 SPF \u898f\u5247\uff0c\u9019\u4e9b\u898f\u5247\u6307\u5b9a\u54ea\u4e9b\u90f5\u4ef6\u4f3a\u670d\u5668\u88ab\u5141\u8a31\u4ee3\u8868\u4f60\u7684\u7db2\u57df\u767c\u9001\u96fb\u5b50\u90f5\u4ef6\uff0c\u9019\u6709\u52a9\u65bc\u9632\u6b62\u5783\u573e\u90f5\u4ef6\u3001\u91e3\u9b5a\u653b\u64ca Text Only<pre><code>v=spf1 include:_spf.example.com ~all\n</code></pre></p> </li> <li> <p>DKIM\uff08DomainKeys Identified Mail\uff09: TXT \u8a18\u9304\u4e5f\u7528\u65bc\u5b58\u5132 DKIM \u516c\u9470\uff0c\u9019\u4e9b\u516c\u9470\u7528\u65bc\u9a57\u8b49\u96fb\u5b50\u90f5\u4ef6\u7684\u4f86\u6e90\uff0c\u78ba\u4fdd\u90f5\u4ef6\u672a\u88ab\u7be1\u6539 Text Only<pre><code>v=DKIM1; k=rsa; p=\u516c\u9470\n</code></pre></p> </li> </ul> </li> <li> <p>\u7db2\u57df\u64c1\u6709\u6b0a\u9a57\u8b49</p> <ul> <li>SSL/TLS \u8b49\u66f8\u9a57\u8b49: \u4e00\u4e9b\u6191\u8b49\u9812\u767c\u6a5f\u69cb\uff08CA\uff09\u6703\u8981\u6c42\u4f60\u6dfb\u52a0\u4e00\u500b\u7279\u5b9a\u7684 TXT \u8a18\u9304\uff0c\u4ee5\u9a57\u8b49\u4f60\u5c0d\u7db2\u57df\u7684\u63a7\u5236\u6b0a\uff0c\u5f9e\u800c\u9812\u767c SSL/TLS \u8b49\u66f8</li> </ul> </li> </ul> </li> </ul> <p></p> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50:</p> <ul> <li>AWS: Supported DNS record types</li> <li>Microsoft: Recursive and Iterative Queries</li> <li>Cloudflare: \u4ec0\u9ebc\u662f DNS \u8a18\u9304\uff1f</li> </ul> </li> </ul>"},{"location":"networking/networking/#http-hypertext-transfer-protocol","title":"HTTP (HyperText Transfer Protocol)","text":"<ul> <li>\u8aaa\u660e: \u5728 WWW \u4e0a\uff0cClient :left_arrow_right: Server \u4e4b\u9593\u7684\u50b3\u8f38\u901a\u8a0a\u5354\u5b9a\u3002\u63a1\u7528 Request/Response \u6a5f\u5236\u3001\u9023\u7d50\u5c0e\u5411\u670d\u52d9\u7684\u4e3b\u5f9e\u5f0f\u67b6\u69cb</li> <li> <p>\u7279\u8272:</p> <ul> <li>HTTP \u70ba\u7121\u72c0\u614b\u5354\u5b9a\uff08stateless protocol\uff09 \u279e \u4ea6\u5373\uff0cserver \u4e0d\u5fc5\u4fdd\u7559\u5148\u524d\u7684\u8acb\u6c42 or \u9023\u7dda</li> <li>\u652f\u63f4\u5df2\u5b58\u53d6\u904e\u7684\u7db2\u9801\u5167\u5bb9 =&gt; \u5feb\u53d6\uff08caching\uff09 \u80fd\u529b</li> <li>\u5141\u8a31\u4ee3\u7406\u4f3a\u670d\u5668\uff08proxy server\uff09\u8ca0\u8cac\u8655\u7406\u7db2\u8def\u5feb\u53d6     </li> </ul> </li> <li> <p>HTTP \u5354\u5b9a\u7684\u7248\u672c\u6f14\u9032</p> <ul> <li>HTTP/1.0: \u6700\u521d\u5728 1989 \u5e74\u6240\u767c\u8d77\u5236\u5b9a\uff0c\u63a1\u7528\u55ae\u4e00\u9023\u7dda\u65b9\u5f0f\uff0c\u6bcf\u6b21\u53ea\u80fd\u8655\u7406\u4e00\u500b\u8acb\u6c42</li> <li>HTTP/1.1: \u89e3\u6c7a\u91cd\u8907 TCP \u9023\u7dda\u7684\u554f\u984c<ul> <li>HTTP/1.1 \u63a1\u7528 pipelining \u7684\u6a5f\u5236</li> <li>\u6301\u4e45\u9023\u63a5 (keep-alive)</li> <li>\u66f4\u591a\u7684\u5feb\u53d6\u7de9\u5b58\u7b56\u7565\uff08<code>Etag</code>, <code>If-Unmodified-Since</code>, <code>If-Match</code>, <code>If-None-Match</code>\uff09</li> <li>Host \u5b57\u6bb5\u4f86\u5340\u5206\u540c\u4e00\u53f0\u5be6\u9ad4\u4e3b\u6a5f\u4e2d\u7684\u591a\u53f0\u865b\u64ec\u4e3b\u6a5f</li> <li>\u65b0\u589e\u66f4\u591a\u7684 HTTP \u65b9\u6cd5\uff08<code>PUT</code>, <code>PATCH</code>, <code>DELETE</code>, <code>CONNECT</code>, <code>TRACE</code>, <code>OPTIONS</code>\uff09</li> </ul> </li> <li> <p>HTTP/2: \u89e3\u6c7a\u982d\u90e8\u963b\u585e\uff08head-of-line blocking\uff09\u554f\u984c</p> <ul> <li> <p>\u591a\u8def\u8907\u7528 (request multiplexing): \u5728\u540c\u4e00\u500b TCP \u9023\u7dda\u4e2d\uff0c\u540c\u6642\u767c\u9001\u3001\u63a5\u53d7\u591a\u500b\u8acb\u6c42\uff0c\u4e26\u4e14\u4e0d\u7528\u7b49\u5230\u524d\u4e00\u500b\u8acb\u6c42\u6536\u5230\u56de\u61c9\uff0c\u900f\u904e\u9019\u500b\u6a5f\u5236\uff0c\u89e3\u6c7a\u4e86\u904e\u5f80\u5728 HTTP/1.1 \u7684\u982d\u90e8\u963b\u585e\u554f\u984c</p> <p>\u982d\u90e8\u963b\u585e\u554f\u984c\uff08head-of-line blocking, HOL\uff09: \u5982\u679c\u6709\u4efb\u4e00\u500b\u8acb\u6c42\u8981\u64cd\u4f5c\u5f88\u4e45\u6216\u50b3\u8f38\u5305\u6d41\u5931\uff0c\u90a3\u5c31\u6703\u963b\u585e\u6574\u500b pipeline \u7684\u5de5\u4f5c</p> </li> <li> <p>\u512a\u5148\u8acb\u6c42\u9806\u5e8f: HTTP/2 \u7248\u672c\u4e2d\uff0c\u6bcf\u500b\u8acb\u6c42\u6216\u56de\u61c9\u7684\u6240\u6709\u6578\u64da\u5305\uff0c\u7a31\u4e4b\u70ba\u4e00\u500b\u6578\u64da\u6d41\uff0c\u4e26\u4e14\uff0c\u6bcf\u500b\u6578\u64da\u6d41\u64c1\u6709\u4e00\u500b\u552f\u4e00\u7de8\u865f ID (stream ID)\u3002\u6bcf\u500b\u6578\u64da\u5305\u5728\u767c\u9001\u7684\u6642\u5019\u5c31\u6703\u6234\u4e0a\u5c0d\u61c9\u7684\u6578\u64da\u6d41\u7de8\u865f ID\uff0c\u5ba2\u6236\u7aef\u9084\u80fd\u6307\u5b9a\u6578\u64da\u6d41\u7684\u512a\u5148\u7d1a\uff0c\u512a\u5148\u7d1a\u8d8a\u9ad8\u670d\u52d9\u5668\u4e5f\u6703\u8d8a\u5feb\u505a\u51fa\u56de\u61c9</p> </li> <li>\u6a19\u982d (header) \u8a0a\u606f\u58d3\u7e2e: HTTP/2 \u4f7f\u7528 HPACK \u58d3\u7e2e\u7b97\u6cd5\uff0c\u5c07 HTTP \u6a19\u982d\u58d3\u7e2e\uff0c\u6e1b\u5c11\u50b3\u8f38\u7684\u5927\u5c0f</li> <li>\u4f3a\u670d\u5668\u4e3b\u52d5\u63a8\u9001(server push): HTTP/2 \u5141\u8a31\u4f3a\u670d\u5668\u7aef\u4e3b\u52d5\u5411\u5ba2\u6236\u7aef\u63a8\u9001\u6578\u64da\uff0c\u9019\u80fd\u5354\u52a9\u6e1b\u5c11\u5ba2\u6236\u7aef\u7684\u8acb\u6c42\u6b21\u6578<ul> <li>\u4f8b\u5982: \u700f\u89bd\u5668\u5728\u904e\u53bb\u8981\u8acb\u6c42 index.html \u8207 style.css \u4f86\u6e32\u67d3\u5b8c\u6574\u7684\u756b\u9762\uff1b\u900f\u904e server Push\uff0c\u53ef\u4ee5\u5728\u700f\u89bd\u5668\u8acb\u6c42 index.html \u6642\uff0c\u4e5f\u7531\u4f3a\u670d\u5668\u4e3b\u52d5\u767c\u9001 style.css\uff0c\u9019\u6a23\u53ea\u9700\u8981\u4e00\u8f2a HTTP \u7684\u8acb\u6c42\uff0c\u5c31\u53ef\u4ee5\u62ff\u5230\u6240\u9700\u7684\u6240\u6709\u8cc7\u6e90</li> </ul> </li> </ul> </li> <li> <p>HTTP/3: \u4f7f\u7528 QUIC \u5354\u5b9a\uff0c\u4e26\u4e14\u5728 UDP \u4e0a\u904b\u884c\uff0c\u4ee5\u63d0\u5347\u6548\u80fd</p> <ul> <li>QUIC \u901a\u8a0a\u5354\u5b9a\u7531 Google \u65bc 2012 \u5e74\u958b\u767c\uff0cQUIC \u5c08\u70ba\u884c\u52d5\u5bc6\u96c6\u578b\u7db2\u969b\u7db2\u8def\u4f7f\u7528\u800c\u8a2d\u8a08\uff0c\u5728\u9019\u7a2e\u74b0\u5883\u4e2d\uff0c\u4eba\u5011\u651c\u5e36\u7684\u667a\u6167\u578b\u624b\u6a5f\u6703\u5728\u4e00\u5929\u4e2d\u4e0d\u65b7\u5730\u5f9e\u4e00\u500b\u7db2\u8def\u5207\u63db\u5230\u53e6\u4e00\u500b\u7db2\u8def\u3002\u958b\u767c\u7b2c\u4e00\u500b\u7db2\u969b\u7db2\u8def\u901a\u8a0a\u5354\u5b9a\u6642\u60c5\u6cc1\u4e26\u975e\u5982\u6b64</li> <li>\u63a1\u7528 QUIC \u5354\u5b9a\u4ee3\u8868 HTTP/3 \u5c07\u4f9d\u8cf4\u65bc UDP \u5354\u5b9a\uff0c\u800c\u4e0d\u662f TCP \u5354\u5b9a\u3002\u5207\u63db\u5230 UDP \u5c07\u4f7f\u7dda\u4e0a\u700f\u89bd\u6642\u7684\u9023\u7dda\u901f\u5ea6\u3001\u4f7f\u7528\u8005\u9ad4\u9a57\u66f4\u5feb</li> </ul> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> </li> <li> <p>HTTP \u65b9\u6cd5</p> <ul> <li>\u8aaa\u660e:<ul> <li>GET: \u53d6\u5f97\u8cc7\u6e90</li> <li>HEAD: \u8207 GET \u985e\u4f3c\uff0c\u4f46\u53ea\u56de\u50b3\u8868\u982d\u8cc7\u8a0a\uff0c\u4e0d\u56de\u50b3\u5be6\u969b\u8cc7\u6e90\uff08body\uff09\u3002\u5e38\u7528\u65bc\u6aa2\u67e5\u8cc7\u6e90\u662f\u5426\u5b58\u5728\uff0c\u4ee5\u53ca\u7372\u53d6\u8cc7\u6e90\u7684 metadata</li> <li>POST: \u65b0\u589e\u8cc7\u6e90\uff0c\u901a\u5e38\u6703\u5c0e\u81f4\u72c0\u614b\u8b8a\u66f4\uff0c\u6216\u5c0d\u4f3a\u670d\u5668\u7522\u751f\u526f\u4f5c\u7528\u3002\u5e38\u7528\u65bc\u63d0\u4ea4\u8868\u55ae or \u4e0a\u50b3\u6587\u4ef6</li> <li>PUT: \u66f4\u65b0\u8cc7\u6e90\uff0c\u6703\u5c07 request payload \u53d6\u4ee3\u76ee\u6a19\u8cc7\u6e90\u7576\u524d\u6240\u6709\u7684\u5167\u5bb9\u3002\u82e5\u8cc7\u6e90\u4e0d\u5b58\u5728\uff0c\u6703\u5efa\u7acb\u65b0\u7684\u8cc7\u6e90</li> <li>DELETE: \u522a\u9664\u8cc7\u6e90</li> <li>CONNECT: \u5efa\u7acb\u5ba2\u6236\u7aef :left_arrow_right: \u4f3a\u670d\u5668\u7684\u96a7\u9053\uff08tunnel\uff09\uff0c\u901a\u5e38\u7528\u65bc\u52a0\u5bc6\u901a\u8a0a\uff0c\u4f8b\u5982: HTTPS</li> <li>OPTIONS: \u7528\u65bc\u63cf\u8ff0\u4f3a\u670d\u5668\u652f\u63f4\u7684\u65b9\u6cd5\uff0c\u4e26\u56de\u50b3\u76f8\u95dc\u7684 HTTP \u8868\u982d\u8cc7\u8a0a\u3002\u5e38\u7528\u65bc\u6aa2\u67e5\u8de8\u57df\u8cc7\u6e90\u5171\u4eab\uff08CORS\uff09\u653f\u7b56</li> <li>TRACE: \u57f7\u884c\u4e00\u500b loop-back \u6e2c\u8a66\uff0c\u7528\u65bc\u8ffd\u8e64 request \u7684\u8def\u5f91\uff0c\u4e3b\u8981\u7528\u65bc\u9664\u932f\u3001\u6e2c\u8a66</li> <li>PATCH: \u5c0d\u8cc7\u6e90\u9032\u884c\u5c40\u90e8\u66f4\u65b0\uff0c\u53ea\u4fee\u6539\u8cc7\u6e90\u7684\u90e8\u5206\u5167\u5bb9\uff0c\u800c\u4e0d\u662f\u66ff\u63db\u6574\u500b\u8cc7\u6e90</li> </ul> </li> <li>\u5b89\u5168\u65b9\u6cd5\uff08Safe Methods\uff09: \u4e0d\u6703\u5c0d\u8cc7\u6e90\u9032\u884c\u4fee\u6539\u7684\u65b9\u6cd5<ul> <li>GET, HEAD, OPTIONS, TRACE</li> </ul> </li> <li>\u51aa\u7b49\u65b9\u6cd5\uff08Idempotent Methods\uff09: \u7121\u8ad6\u5c0d\u8cc7\u6e90\u9032\u884c\u591a\u5c11\u6b21\u64cd\u4f5c\uff0c\u7d50\u679c\u90fd\u662f\u4e00\u6a23\u7684<ul> <li>GET, HEAD, PUT, DELETE, OPTIONS, TRACE</li> </ul> </li> </ul> </li> <li> <p>HTTP \u8a0a\u606f</p> <ul> <li> <p>HTTP \u662f\u4e00\u500b text-based \u7684\u50b3\u8f38\u5354\u5b9a\uff0c\u5206\u6210 request \u548c response \u5169\u7a2e\u8a0a\u606f     Text Only<pre><code>&lt;method&gt; &lt;URL&gt; &lt;version&gt;\n&lt;header&gt;\n...\n...\n&lt;header&gt;\n\n&lt;body&gt; \n</code></pre></p> <p></p> Text Only<pre><code>&lt;version&gt; &lt;status code&gt; &lt;status message&gt;\n&lt;header&gt;\n...\n...\n&lt;header&gt;\n\n&lt;body&gt; \n</code></pre> <p></p> </li> </ul> </li> <li> <p>HTTP \u8868\u982d\uff08header\uff09</p> <ul> <li>\u8aaa\u660e: \u7528\u65bc\u50b3\u905e\u95dc\u65bc request \u6216 response \u7684\u9644\u52a0\u8cc7\u8a0a</li> <li>\u683c\u5f0f: key: value</li> <li> <p>\u5e38\u898b\u7684 HTTP header     </p> <ul> <li>Conditionals \u985e\u5225: Client\u53ef\u80fd\u5728\u4e4b\u524d\u5df2\u7d93\u53d6\u5f97\u904e\u76f8\u95dc\u7684\u8cc7\u6e90\uff0c\u4e26\u4e14\u4fdd\u6709\u4e00\u4efd\u5099\u4efd\uff0c\u5982\u679c\u6b64\u8cc7\u6e90\u6c92\u6709\u66f4\u65b0\u6642\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u900f\u904e\u7db2\u8def\u5728\u50b3\u8f38\u4e00\u6b21\uff0c\u4ee5\u7bc0\u7701\u6642\u9593\u53ca\u983b\u5bec<ul> <li>ETag: Response\u4e2d\uff0c\u5c0d\u65bc\u56de\u50b3\u7684\u8cc7\u6599\u52a0\u7684\u4e00\u500b tag\uff0c\u6709\u9ede\u50cf\u662f\u4ee5\u8cc7\u6599\u70ba\u8f38\u5165\u7684 hash \u503c\uff0c\u8b93 client \u53ef\u4ee5\u5f8c\u7e8c\u4f7f\u7528\uff0c\u6703\u5728 <code>If-Match</code>\u53ca <code>If-None-Match</code>\uff0c\u4ee5\u4e0b\u8aaa\u660e<ul> <li>Server \u7aef\u63a5\u6536\u8acb\u6c42\uff0c\u6aa2\u67e5\u662f\u5426\u8207\u76ee\u524d\u8868\u793a\u7684 ETag \u503c\u76f8\u540c\uff0c\u82e5\u76f8\u540c\u5247\u8868\u793a\u8cc7\u6e90\u4e26\u672a\u88ab\u66f4\u52d5</li> </ul> </li> <li>If-Match: Server \u53ea\u6709\u5728 match \u6642\uff0c\u624d\u6703\u52d5\u4f5c\uff0c\u901a\u5e38\u5728 PUT \u64cd\u4f5c\u6642\u7528\u65bc\u907f\u514d lost update \u7684\u554f\u984c\uff0c\u4f8b\u5982: \u4f60\u60f3\u7de8\u8f2f\u4e00\u9801 Wiki \u7684\u5167\u5bb9\uff0c\u4f60\u5148\u8981\u6c42\u4e86\u672c\u4f86\u7684\u9801\u9762\uff0cserver \u56de\u50b3\u4e86 <code>Etag: A</code>\uff0c\u7576\u4f60\u7de8\u8f2f\u5b8c\u9001\u51fa\u6642\uff0c\u5e36\u4e0a <code>If-Match: A</code> \u7684 header\uff0c\u8868\u793a\u53ea\u6709\u7576\u5167\u5bb9\u9084\u662f A \u7248\u672c\u6642\u624d\u6703\u66f4\u65b0\u6210\u529f\uff0c\u5982\u679c\u5728\u4f60\u7de8\u8f2f\u7684\u6642\u5019\u6709\u4eba\u5df2\u7d93\u5148\u66f4\u65b0\u4e86\u9801\u9762\u5167\u5bb9\uff0c\u5247\u6703\u56de\u50b3 412: Precondition Failed\uff0c\u5982\u6b64\u4e00\u4f86\uff0c\u907f\u514d\u4f60\u7684\u66f4\u65b0\u6703\u84cb\u6389\u5225\u4eba\u7684\u66f4\u65b0</li> <li>If-None-Match: Server \u53ea\u6703\u5728\u6c92\u6709 match \u6642\uff0c\u624d\u6703\u56de\u50b3\u8cc7\u6599\uff0c\u56e0\u70ba\u5982\u679c match \u5c31\u4ee3\u8868 client \u64c1\u6709\u7684\u8cc7\u6599\u7684 copy \u9084\u662f\u6700\u65b0\u7684\uff0c\u5c31\u56de\u50b3 304: Not Modified\uff0c\u800c\u4e0d\u6703\u518d\u50b3\u4e00\u6b21\u8cc7\u6599\uff0c\u9019\u6a23\u53ef\u4ee5\u7bc0\u7701\u983b\u5bec</li> <li>Last-Modified: Response \u4e2d\u4f7f\u7528\uff0c\u7528\u4f86\u8aaa\u660e\u56de\u50b3\u7684\u8cc7\u6599\u6700\u8fd1\u4fee\u6539\u7684\u6642\u9593\uff0c\u597d\u8b93 client \u53ef\u4ee5 cache \u8d77\u4f86\u4e26\u642d\u914d<code>If-Modified_Since</code> \u4f86\u66f4\u65b0\uff0c\u8a73\u60c5\u898b\u4e0b\u9762</li> <li>If-Modified-Since: Request \u4f7f\u7528\u6b64 header \u4f86\u6c7a\u5b9a cache \u6709\u6c92\u6709\u904e\u671f\u4e86\uff0c\u6bd4\u5982\u8aaa\u4e0a\u6b21\u62ff\u53d6\u8cc7\u6e90\u6642 server response \u4e86Last-Modified: Sun, 05 Sep 2021 01:40:14 GMT\uff0c\u9019\u6b21\u518d request \u76f8\u540c\u8cc7\u6e90\u6642\uff0c\u5c31\u53ef\u4ee5\u5e36\u4e0a <code>If-Modified-Since</code>: Sun, 05 Sep 2021 01:40:14 GMT\uff0c\u8868\u793a\u82e5\u5728 2021-09-05 \u9019\u500b\u6642\u9593\u9ede\u4e4b\u5f8c\uff0c\u8cc7\u6599\u4e26\u6c92\u6709\u66f4\u65b0\uff0c\u5247 server \u53ef\u4ee5\u56de\u50b3 304: Not Modified\uff0cclient \u5c31\u80fd\u76f4\u63a5\u4f7f\u7528 cache\uff0c \u800c\u4e0d\u9700\u8981\u518d\u900f\u904e\u7db2\u8def\u4e0b\u8f09\u8cc7\u6599\uff0c\u53cd\u4e4b\uff0c\u8cc7\u6599\u6709\u66f4\u6539\u7684\u8a71\uff0c\u5c31\u56de\u50b3\u65b0\u7684\u8cc7\u6599\u4e26\u5e36\u4e0a\u65b0\u7684 <code>Last-Modified</code></li> </ul> </li> <li>Connection management \u985e\u5225: \u7528\u65bc\u7ba1\u7406\u9023\u7dda<ul> <li>Connection: \u7528\u4f86\u544a\u8a34 server \u9019\u500b\u9023\u7dda\u662f\u8981\u6301\u7e8c\u4f7f\u7528 or \u4e00\u6b21\u6027\u7684\uff0c\u5982\u679c\u662f keep-alive\uff0c\u5247 server \u6703\u4fdd\u6301\u9023\u7dda\uff0c\u76f4\u5230 client \u95dc\u9589\u9023\u7dda\uff0c\u9019\u6a23\u53ef\u4ee5\u7bc0\u7701\u5efa\u7acb\u9023\u7dda\u7684\u6642\u9593\uff0c\u63d0\u9ad8\u6548\u80fd</li> <li>Keep-Alive: \u7528\u4f86\u544a\u8a34 server \u9019\u500b\u9023\u7dda\u8981\u4fdd\u6301\u591a\u4e45\uff0c\u901a\u5e38\u662f\u4e00\u500b\u6642\u9593\uff0c\u5982\u679c\u8d85\u904e\u9019\u500b\u6642\u9593\uff0cserver \u6703\u4e3b\u52d5\u95dc\u9589\u9023\u7dda\uff0c\u9019\u6a23\u53ef\u4ee5\u907f\u514d server \u4e00\u76f4\u4fdd\u6301\u9023\u7dda\uff0c\u6d6a\u8cbb\u8cc7\u6e90</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>HTTP \u72c0\u614b\u78bc</p> <ul> <li> <p>HTTP \u72c0\u614b\u78bc\u5171\u5206\u70ba\u4e94\u5927\u985e\uff0c\u7b2c\u4e00\u500b\u6578\u5b57\u4ee3\u8868\u4f3a\u670d\u5668\u56de\u61c9\u7684\u5927\u985e\uff0c\u7b2c\u4e8c\u3001\u4e09\u500b\u6578\u5b57\u518d\u5206\u70ba\u4e2d\u985e\u3001\u5c0f\u985e</p> <ul> <li>1xx (Informational) \u2014 \u8cc7\u8a0a</li> <li>2xx (Successful) \u2014 \u6210\u529f</li> <li>3xx (Redirection) \u2014 \u91cd\u65b0\u5c0e\u5411</li> <li>4xx (Client Error) \u2014 \u5ba2\u6236\u7aef \u932f\u8aa4</li> <li>5xx (Server Error) \u2014 \u4f3a\u670d\u7aef \u932f\u8aa4  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li> <p>\u89c0\u5ff5\u91d0\u6e05</p> <ul> <li> <p>301 vs. 302</p> <p></p> </li> <li> <p>401 vs. 403     </p> </li> </ul> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50:</p> <ul> <li>HTTP/1\u3001HTTP/1.1 \u548c HTTP/2 \u7684\u5340\u5225</li> <li>Cloudflare: \u4ec0\u9ebd\u662f HTTP/3\uff1f</li> <li>MDN: HTTP request methods</li> <li>HTTP headers \u7c21\u4ecb: \u4e00\u4e9b\u5e38\u7528\u7684 headers</li> <li>HTTP \u72c0\u614b\u78bc (Status Codes)</li> </ul> </li> </ul>"},{"location":"networking/networking/#telnet-protocol","title":"Telnet protocol","text":"<ul> <li>\u8aaa\u660e: \u662f\u4e00\u500b\u61c9\u7528\u5c64\u7684\u5354\u5b9a\uff0c\u4e5f\u662f\u4e00\u500b\u7c21\u6613\u7db2\u8def\u8a3a\u65b7\u7684\u5de5\u5177\u3002\u5141\u8a31\u4f7f\u7528\u8005\u900f\u904e TCP \u9023\u7dda\u9032\u5165\u9060\u7aef\u4f3a\u670d\u5668<ul> <li>\u4f7f\u7528 TCP port 23</li> </ul> </li> <li> <p>\u529f\u80fd: \u57f7\u884c\u7a0b\u5f0f\u3001\u555f\u52d5/\u505c\u6b62\u670d\u52d9\u3001\u700f\u89bd\u8cc7\u6599\u593e/\u6a94\u6848\u3001\u6e2c\u8a66 TCP \u9023\u7dda\u3001\u6aa2\u67e5\u9060\u7aef\u4f3a\u670d\u5668\u7684\u6307\u5b9a port \u662f\u5426\u958b\u653e </p> </li> <li> <p>\u57fa\u672c\u6307\u4ee4     Bash<pre><code>telnet &lt;host&gt; &lt;port&gt;\n</code></pre></p> </li> <li>\u7279\u8272<ul> <li>\u512a\u9ede: telnet \u4f7f\u7528\u7d14\u6587\u5b57\u4ecb\u9762\uff0c\u50b3\u8f38\u6548\u7387\u5feb</li> <li>\u7f3a\u9ede: \u8cc7\u5b89\u554f\u984c \u279e \u7531\u65bc telnet \u7f3a\u4e4f\u52a0\u5bc6\uff0c\u4e26\u4e14\u4f7f\u7528\u660e\u6587\u50b3\u8f38\u6578\u64da\uff0c\u5728\u73fe\u4ee3\u74b0\u5883\u4e2d\u591a\u6578\u60c5\u6cc1\u4e0b\u5df2\u88ab SSH \u6240\u53d6\u4ee3\u3002SSH \u63d0\u4f9b\u4e86\u52a0\u5bc6\u901a\u8a0a\uff0c\u9069\u7528\u65bc\u5927\u591a\u6578\u9700\u8981\u5b89\u5168\u50b3\u8f38\u7684\u5834\u666f</li> </ul> </li> </ul>"},{"location":"networking/networking/#ftp-file-transfer-protocol","title":"FTP (File Transfer Protocol)","text":"<ul> <li>\u8aaa\u660e: \u662f\u4e00\u500b\u61c9\u7528\u5c64\u7684\u6a94\u6848\u50b3\u8f38\u5354\u5b9a\uff0c\u662f\u5728\u7db2\u969b\u7db2\u8def\u4e0a\u9032\u884c\u6a94\u6848\u50b3\u8f38\u7684\u4e00\u7a2e\u6a19\u6e96\u5354\u5b9a\uff0c\u53ef\u5c07\u6a94\u6848\u5f9e\u4e00\u500b\u96fb\u8166\u50b3\u8f38\u5230\u53e6\u4e00\u500b\u96fb\u8166<ul> <li>\u4f7f\u7528 TCP port 21</li> </ul> </li> <li> <p>\u7279\u8272: </p> <ul> <li> <p>FTP \u662f\u4e00\u7a2e\u4e3b\u5f9e\u5f0f\u5354\u5b9a\uff08\u5ba2\u6236\u7aef\u8981\u6c42\u6a94\u6848\uff0c\u4f3a\u670d\u5668\u7aef\u8ca0\u8cac\u63d0\u4f9b\u6a94\u6848\uff09</p> <ul> <li>FTP \u5ba2\u6236\u7aef\u8edf\u9ad4: FileZilla\u3001WinSCP \u5716\u7247\u4f86\u6e90</li> </ul> </li> <li> <p>FTP \u5efa\u7acb\u9023\u7dda\u6642\u9700\u8981\u5169\u7a2e\u57fa\u672c\u901a\u9053</p> <ul> <li>\u547d\u4ee4\u901a\u9053: \u8ca0\u8cac\u555f\u52d5\u6307\u4ee4\u4e26\u651c\u5e36\u57fa\u672c\u8cc7\u8a0a\uff08\u8981\u5b58\u53d6\u54ea\u4e9b\u6a94\u6848\uff09<ul> <li>\u4f7f\u7528 TCP port 21</li> </ul> </li> <li>\u8cc7\u6599\u901a\u9053: \u5728\u5169\u500b\u88dd\u7f6e\u4e4b\u9593\u50b3\u905e\u6a94\u6848\u8cc7\u6599<ul> <li>\u4f7f\u7528 TCP port 20</li> </ul> </li> </ul> <p> \u5716\u7247\u4f86\u6e90</p> </li> <li> <p>FTP \u6709\u5169\u7a2e\u6a21\u5f0f</p> <ul> <li> <p>\u4e3b\u52d5\u6a21\u5f0f\uff08Active Mode\uff09: \u4f3a\u670d\u5668\u7aef\u4e3b\u52d5\u9023\u7dda\u5230\u5ba2\u6236\u7aef\u7684\u8cc7\u6599\u901a\u9053\u3002\u7576\u5ba2\u6236\u7aef\u9700\u8981\u50b3\u8f38\u6578\u64da\u6642\uff0c\u5b83\u6703\u5728\u5176\u672c\u5730\u7aef\u96a8\u6a5f\u958b\u555f\u4e00\u500b\u81e8\u6642 port \uff0c\u4e26\u544a\u77e5\u4f3a\u670d\u5668\u7aef\u8a72 port\u3002\u63a5\u8457\uff0c\u4f3a\u670d\u5668\u7aef\u6703\u5f9e\u81ea\u5df1\u7684 port 20 \u4e3b\u52d5\u9023\u7dda\u5230\u5ba2\u6236\u7aef\u6307\u5b9a\u7684 port\uff0c\u5f9e\u800c\u5efa\u7acb\u8cc7\u6599\u901a\u9053\u9032\u884c\u8cc7\u6599\u50b3\u8f38</p> <ul> <li>FTP \u9810\u8a2d\u63a1\u7528\u6b64\u4e3b\u52d5\u6a21\u5f0f</li> <li>\u82e5\u5ba2\u6236\u7aef\u4f4d\u65bc\u9632\u706b\u7246\u6216 NAT \u5f8c\u9762\uff0c\u4f3a\u670d\u5668\u7121\u6cd5\u76f4\u63a5\u9023\u63a5\u5230\u5ba2\u6236\u7aef\u7684\u96a8\u6a5f port\uff0c\u9019\u53ef\u80fd\u6703\u5c0e\u81f4\u9023\u7dda\u5931\u6557  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li> <p>\u88ab\u52d5\u6a21\u5f0f\uff08Passive Mode\uff09: \u5ba2\u6236\u7aef\u4e3b\u52d5\u9023\u7dda\u5230\u4f3a\u670d\u5668\u7aef\u7684\u8cc7\u6599\u901a\u9053\u3002\u5728\u88ab\u52d5\u6a21\u5f0f\u4e0b\uff0c\u7576\u5ba2\u6236\u7aef\u9700\u8981\u50b3\u8f38\u8cc7\u6599\u6642\uff0c\u5b83\u6703\u8981\u6c42\u4f3a\u670d\u5668\u958b\u555f\u4e00\u500b\u96a8\u6a5f\u7aef\u53e3\uff08port \u901a\u5e38 &gt; 1024\uff09\uff0c\u7136\u5f8c\u544a\u77e5\u5ba2\u6236\u7aef\u9019\u500b port\u3002\u96a8\u5f8c\uff0c\u5ba2\u6236\u7aef\u6703\u4e3b\u52d5\u9023\u63a5\u5230\u4f3a\u670d\u5668\u7684\u9019\u500b\u7aef\u53e3\u4f86\u5efa\u7acb\u8cc7\u6599\u901a\u9053</p> <ul> <li>\u88ab\u52d5\u6a21\u5f0f\u53ef\u4ee5\u66f4\u597d\u5730\u61c9\u5c0d\u9632\u706b\u7246\u3001NAT \u7b49\u7db2\u8def\u8a2d\u5099\u7684\u9650\u5236\uff0c\u56e0\u70ba\u5ba2\u6236\u7aef\u8ca0\u8cac\u767c\u8d77\u6240\u6709\u9023\u7dda  \u5716\u7247\u51fa\u8655</li> </ul> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> </li> </ul> </li> <li> <p>\u61c9\u7528\u60c5\u5883: \u5728\u5c01\u9589\u7cfb\u7d71\u5167\uff0c\u50b3\u905e\u5927\u6279\u6b21\u7684\u4f3a\u670d\u5668\u6a94\u6848</p> </li> <li>\u512a\u9ede:<ul> <li>\u53ef\u4ee5\u540c\u6642\u50b3\u905e\u591a\u500b\u6a94\u6848</li> <li>\u5728\u9023\u7dda\u4e2d\u65b7\u5f8c\u6062\u5fa9\u6a94\u6848\u50b3\u905e</li> <li>\u5b89\u6392\u50b3\u905e\u4f5c\u696d</li> </ul> </li> <li>\u7f3a\u9ede: FTP \u7b97\u662f\u4e00\u500b\u76f8\u5c0d\u8001\u820a\u7684\u5354\u5b9a\uff0c\u5b58\u5728\u4e00\u4e9b\u5b89\u5168\u6f0f\u6d1e\u548c\u98a8\u96aa\uff08\u56e0\u70ba FTP \u50b3\u8f38\u8cc7\u6599\u6642\u4e26\u672a\u52a0\u5bc6\uff0c\u9019\u8868\u793a\u7576\u99ed\u5ba2\u64f7\u53d6\u8cc7\u6599\u5c01\u5305\u5f8c\uff0c\u5c31\u80fd\u76f8\u5c0d\u8f15\u6613\u5730\u8b80\u53d6\u5bc6\u78bc\u3001\u4f7f\u7528\u8005\u540d\u7a31\u548c\u5176\u4ed6\u6a5f\u5bc6\u8cc7\u6599\uff09\uff0c\u56e0\u6b64\u5728\u5be6\u969b\u61c9\u7528\u4e2d\uff0c\u6211\u5011\u50be\u5411\u65bc\u4f7f\u7528\u66f4\u65b0\u3001\u66f4\u5b89\u5168\u7684\u5354\u5b9a\uff0c\u4f8b\u5982: SFTP\uff08= FTP + SSH\uff09</li> </ul>"},{"location":"networking/networking/#ssh-secure-shell","title":"SSH (Secure Shell)","text":"<ul> <li>\u8aaa\u660e: \u662f\u4e00\u7a2e\u52a0\u5bc6\u9023\u7dda\u7684\u7db2\u8def\u5354\u5b9a\uff0c\u7528\u65bc\u5728\u4e0d\u5b89\u5168\u7684\u7db2\u8def\u4e0a\u5b89\u5168\u5730\u9060\u7aef\u9023\u63a5\u5230\u9060\u7aef\u4f3a\u670d\u5668<ul> <li>\u4f7f\u7528 TCP port 22</li> </ul> </li> <li> <p>SSH \u63a1\u7528\u4e3b\u5f9e\u5f0f\u67b6\u69cb: \u8981\u5efa\u7acb\u4e00\u500b SSH \u9023\u7dda\uff0c\u9060\u7aef\u7684\u4f3a\u670d\u5668\u5fc5\u9808\u8dd1\u4e00\u500b SSH daemon\uff0c\u672c\u5730\u7aef\u5247\u8981\u6709\u4e00\u500b SSH client \u7a0b\u5e8f</p> <ul> <li>\u4f3a\u670d\u5668\u7aef\u7684 SSH daemon \u6703\u9810\u8a2d\u807d\u5f9e TCP port 22 \u9032\u4f86\u7684\u9023\u7dda\uff0c\u4e26\u5728\u8a8d\u8b49\u5f8c\u63d0\u4f9b\u76f8\u5c0d\u61c9\u7684\u74b0\u5883\u7d66\u4f7f\u7528\u8005</li> <li>SSH client \u5247\u8ca0\u8cac\u4f7f\u7528 SSH protocol \u4f86\u50b3\u9001\u8a8d\u8b49\u8a0a\u606f\u3001\u9023\u7dda\u7d30\u7bc0\u7d66\u9060\u7aef\u6a5f\u5668  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li> <p>SSH \u52a0\u5bc6: \u63a1\u7528\u975e\u5c0d\u7a31\u5f0f\u52a0\u5bc6\u5f8c\u3002\u4e00\u65e6\u5efa\u7acb\u9023\u7dda\u5f8c\uff0c\u96d9\u65b9\u5c31\u80fd\u4f7f\u7528\u5c0d\u7a31\u5f0f\u5bc6\u9470\u4f86\u52a0\u5bc6\u901a\u8a0a</p> <ul> <li>\u5728 SSH \u9023\u7dda\u4e2d\uff0c\u96d9\u65b9\u90fd\u6709\u4e00\u500b\u516c\u958b/\u79c1\u5bc6\u91d1\u9470\u5c0d\uff0c\u4e26\u4e14\u6bcf\u4e00\u65b9\u90fd\u4f7f\u7528\u9019\u4e9b\u91d1\u9470\u4f86\u9a57\u8b49\u5c0d\u65b9\u7684\u8eab\u4efd</li> </ul> <p>\u800c HTTPS \u5728\u5927\u591a\u6578\u5be6\u4f5c\u4e2d\u50c5\u9a57\u8b49 web \u4f3a\u670d\u5668\u7684\u8eab\u5206</p> </li> <li> <p>SSH \u9a57\u8b49     Bash<pre><code>ssh &lt;username&gt;@&lt;host&gt;\n</code></pre></p> </li> <li> <p>\u61c9\u7528\u60c5\u5883: \u9060\u7aef\u767b\u5165\u96fb\u8166\u3001\u5b89\u5168\u5730\u50b3\u8f38\u6a94\u6848\u3001\u52a0\u5bc6\u901a\u8a0a</p> </li> <li>SSH vs. VPN<ul> <li>SSH: \u4e00\u6b21\u50c5\u52a0\u5bc6\u4e00\u500b\u9023\u7dda\uff0c\u7bc4\u570d\u4fb7\u9650\u5728\u55ae\u4e00\u500b session \u4e0a\u3002\u9069\u7528\u65bc\u9700\u8981\u7cbe\u78ba\u63a7\u5236\u3001\u9ad8\u5b89\u5168\u6027\u8981\u6c42\u7684\u5834\u666f\uff0c\u4f8b\u5982: IT \u7cfb\u7d71\u7ba1\u7406\u54e1\u9032\u884c\u9060\u7a0b\u4f3a\u670d\u5668\u7ba1\u7406</li> <li>IPsec VPN: \u52a0\u5bc6\u6240\u6709\u7db2\u8def\u6d41\u91cf\uff0c\u7121\u8ad6\u5176\u4f86\u81ea\u54ea\u500b\u61c9\u7528\u7a0b\u5f0f\u3002\u9069\u7528\u65bc\u9700\u8981\u4fdd\u8b77\u6240\u6709\u7db2\u8def\u901a\u8a0a\u7684\u60c5\u5883\uff0c\u4f8b\u5982: \u5728\u516c\u5171 Wi-Fi \u7db2\u8def\u4e2d\u5de5\u4f5c</li> </ul> </li> <li>\u53c3\u8003\u9023\u7d50: \u4ec0\u9ebc\u662f SSH\uff1f | \u5b89\u5168\u6bbc\u5c64 (SSH) \u901a\u8a0a\u5354\u5b9a</li> </ul>"},{"location":"networking/networking/#layer-6-presentation-layer","title":"Layer 6: Presentation Layer","text":""},{"location":"networking/networking/#ssltls","title":"SSL/TLS","text":"<ul> <li>SSL (Secure Sockets Layer): \u7528\u65bc\u52a0\u5bc6\u3001\u4fdd\u8b77\u3001\u9a57\u8b49\u7db2\u969b\u7db2\u8def\u4e0a\u6240\u767c\u751f\u901a\u8a0a\u7684\u5354\u5b9a<ul> <li>\u76ee\u524d\uff0cSSL \u5df2\u88ab TLS (Transport Layer Security) \u6240\u53d6\u4ee3</li> </ul> </li> <li> <p>TLS \u63e1\u624b\uff08handshake\uff09: \u4f7f\u7528\u975e\u5c0d\u7a31\u52a0\u5bc6\uff08asymmetric encryption\uff09\u4f86\u5efa\u7acb\u5b89\u5168\u901a\u9053 </p> <ul> <li>\u6c7a\u5b9a\u96d9\u65b9\u5c07\u4f7f\u7528\u7684 TLS \u7248\u672c\uff08\u4f8b\u5982: TLS 1.0\u30011.2\u30011.3\uff09</li> <li>\u6c7a\u5b9a\u5b83\u5011\u5c07\u4f7f\u7528\u7684\u5bc6\u78bc\u5957\u4ef6</li> <li>\u900f\u904e\u4f3a\u670d\u5668\u7aef\u7684\u516c\u958b\u5bc6\u9470\u3001SSL \u7684 CA \u9812\u767c\u6a5f\u69cb\u7684\u96fb\u5b50\u7c3d\u540d\uff08digital signature\uff09\u4f86\u9a57\u8b49\u4f3a\u670d\u5668\u7aef\u7684\u8eab\u4efd</li> <li>\u7522\u751f\u5de5\u4f5c\u968e\u6bb5\u5bc6\u9470\uff08session key\uff09\uff0c\u4ee5\u4fbf\u5728 TLS \u63e1\u624b\u5b8c\u6210\u5f8c\uff0c\u53ef\u4f7f\u7528\u5c0d\u7a31\u52a0\u5bc6\uff08symmetric encryption\uff09\u4f86\u52a0\u5bc6\u901a\u8a0a </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50:</p> <ul> <li>Cloudflare: SSL \u662f\u5982\u4f55\u904b\u4f5c\u7684\uff1f | SSL \u6191\u8b49\u548c TLS</li> <li>Cloudflare: TLS \u63e1\u624b\u4e2d\u767c\u751f\u4ec0\u9ebc\u4e8b\u60c5\uff1f| SSL \u63e1\u624b</li> </ul> </li> </ul>"},{"location":"networking/networking/#layer-4-transport-layer","title":"Layer 4: Transport Layer","text":""},{"location":"networking/networking/#tcp-transmission-control-protocol","title":"TCP (Transmission Control Protocol)","text":"<ul> <li>\u8aaa\u660e: \u4e00\u7a2e\u9023\u7d50\u5c0e\u5411\u7684\u5354\u5b9a\uff0c\u53ef\u78ba\u4fdd\u8cc7\u6599\u7684\u53ef\u9760\u50b3\u8f38</li> <li> <p>TCP \u5efa\u7acb\u9023\u7dda\uff08\u4e09\u6b21\u63e1\u624b\uff09 &amp; TCP \u4e2d\u65b7\u9023\u7dda\uff08\u56db\u6b21\u63e1\u624b\uff09      </p> </li> <li> <p>TCP \u6a19\u982d\uff08header\uff09     </p> </li> <li> <p>\u53c3\u8003\u9023\u7d50: TCP \u91cd\u50b3\u3001\u6ed1\u52d5\u7a97\u53e3\u3001\u6d41\u91cf\u63a7\u5236\u3001\u64c1\u585e\u63a7\u5236</p> </li> </ul>"},{"location":"networking/networking/#layer-3-network-layer","title":"Layer 3: Network Layer","text":""},{"location":"networking/networking/#subnet","title":"subnet","text":"<ul> <li>\u8aaa\u660e: subnet\uff08\u5b50\u7db2\uff09\u662f\u7db2\u8def\u7684\u4e00\u90e8\u5206\uff0c\u5b83\u7531\u8f03\u5927\u7db2\u8def\u4e2d\u7684 IP \u4f4d\u5740\u7bc4\u570d\u5283\u5206\u800c\u4f86\u3002\u5b50\u7db2\u7684\u76ee\u7684\u662f\u5c07\u4e00\u500b\u5927\u7684\u7db2\u8def\u5283\u5206\u6210\u8f03\u5c0f\u7684\u3001\u66f4\u5bb9\u6613\u7ba1\u7406\u7684\u90e8\u5206\uff0c\u5f9e\u800c\u63d0\u9ad8\u7db2\u8def\u7684\u6548\u7387\u3001\u5b89\u5168\u6027</li> <li> <p>\u512a\u9ede:</p> <ul> <li>\u63d0\u9ad8\u5b89\u5168\u6027: \u5b50\u7db2\u5283\u5206\u53ef\u4ee5\u5c07\u4e0d\u540c\u7684\u7db2\u6bb5\u9694\u96e2\u958b\u4f86\uff0c\u9650\u5236\u4e0d\u540c\u7db2\u6bb5\u4e4b\u9593\u7684\u901a\u8a0a\uff0c\u5f9e\u800c\u63d0\u9ad8\u7db2\u8def\u5b89\u5168\u6027</li> <li>\u63d0\u9ad8\u6548\u7387: \u5b50\u7db2\u5283\u5206\u6709\u52a9\u65bc\u6e1b\u5c11\u7db2\u8def\u64c1\u585e\uff0c\u56e0\u70ba\u5c01\u5305\u6703\u88ab\u9650\u5236\u5728\u5b50\u7db2\u5167\u90e8\u6d41\u52d5\uff0c\u800c\u4e0d\u6703\u5f71\u97ff\u5230\u6574\u500b\u5927\u7db2\u8def</li> <li>\u65b9\u4fbf\u7ba1\u7406: \u5c07\u5927\u7db2\u8def\u5283\u5206\u70ba\u591a\u500b\u5b50\u7db2\uff0c\u53ef\u4ee5\u66f4\u5bb9\u6613\u7ba1\u7406\u548c\u5206\u914d IP \u5730\u5740\uff0c\u4e26\u9032\u884c\u6545\u969c\u6392\u9664</li> </ul> <p> </p> </li> <li> <p>\u5b50\u7db2\u906e\u7f69 (subnet mask): \u7528\u65bc\u5340\u5206 IP \u4f4d\u5740\u7684\u7db2\u8def\u90e8\u5206\uff08Network bits\uff09\u3001\u4e3b\u6a5f\u90e8\u5206\uff08Host bits\uff09      </p> </li> <li> <p>\u53c3\u8003\u9023\u7d50: \u5f71\u7247: IP address network and host portion | subnet mask explained</p> </li> </ul>"},{"location":"networking/networking/#cidr-classless-inter-domain-routing","title":"CIDR (Classless Inter-Domain Routing)","text":"<ul> <li>\u8aaa\u660e: \u53ef\u4f9d\u64da\u5be6\u969b\u9700\u6c42\uff0c\u5f48\u6027\u8a2d\u5b9a\u6240\u9700\u7684\u7db2\u6bb5 &amp; IP address \u6578\u91cf\uff0c\u4f7f\u7528\u300c\u659c\u7dda\u8868\u793a\u6cd5\u300d\u4f86\u5b9a\u7fa9 subnet mask \u7684\u9577\u5ea6; \u800c\u4e0d\u53d7\u9650\u65bc\u50b3\u7d71\u7684 A, B, C \u985e\u5225\uff0c\u4f8b\u5982 Class A \u662f /8\uff0cClass B \u662f /16\uff0cClass C \u662f /24</li> <li> <p>\u512a\u9ede:</p> <ul> <li>\u6e1b\u5c11 IP \u4f4d\u7f6e\u6d6a\u8cbb: \u56e0\u70ba CIDR \u53ef\u4ee5\u8b93\u6211\u5011\u66f4\u9748\u6d3b\u5730\u6307\u6d3e IP \u4f4d\u5740\u7684\u7db2\u8def\u3001\u4e3b\u6a5f\u8b58\u5225\u7b26\uff0c\u6240\u4ee5\u53ef\u4f7f\u7528 CIDR \u70ba\u7279\u5b9a\u7db2\u8def\u63d0\u4f9b\u6240\u9700\u6578\u91cf\u7684 IP \u4f4d\u5740\u4e26\u6e1b\u5c11\u6d6a\u8cbb\u3002\u6b64\u5916\uff0cCIDR \u6e1b\u5c11\u4e86\u8def\u7531\u8868\u9805\u76ee\uff0c\u7c21\u5316\u4e86\u5c01\u5305\u8def\u7531</li> <li>\u5efa\u7acb\u865b\u64ec\u79c1\u6709\u96f2\u7aef\uff08VPC\uff09: VPC \u662f\u8a17\u7ba1\u5728 AWS \u96f2\u7aef\u4e2d\u7684\u79c1\u6709\u6578\u4f4d\u7a7a\u9593\uff0c\u5176\u5141\u8a31\u6211\u5011\u5728\u9694\u96e2\u4e14\u5b89\u5168\u7684\u74b0\u5883\u4e2d\u4f48\u5efa\u5de5\u4f5c\u8ca0\u8f09\u3002VPC \u5728\u9023\u7dda\u7684\u88dd\u7f6e\u4e4b\u9593\u50b3\u8f38\u5c01\u5305\u6642\u4f7f\u7528 CIDR IP \u5730\u5740</li> </ul> <p> </p> </li> <li> <p>\u53c3\u8003\u9023\u7d50: \u4ec0\u9ebc\u662f CIDR ?</p> </li> </ul>"},{"location":"networking/networking/#ip-internet-protocol","title":"IP (Internet Protocol)","text":"<ul> <li>\u7528\u9014: \u8ca0\u8cac\u5c07\u5c01\u5305\u5f9e\u4e00\u500b\u88dd\u7f6e\u50b3\u9001\u5230\u53e6\u4e00\u500b\u88dd\u7f6e</li> <li>\u91cd\u8981\u89c0\u5ff5:<ul> <li>IP \u6d41\u91cf\u53ef\u4ee5\u4f7f\u7528 TCP \u6216 UDP \u50b3\u9001\u3002TCP \u6703\u5148\u57f7\u884c\u4e09\u6b21\u63e1\u624b\uff0c\u4ee5\u78ba\u4fdd\u5169\u500b\u88dd\u7f6e\u90fd\u6e96\u5099\u597d\u63a5\u6536\u8cc7\u6599\uff0c\u624d\u6703\u958b\u59cb\u50b3\u8f38; \u800c UDP \u5247\u662f\u7121\u9023\u63a5\u7684\u5354\u5b9a\uff0c\u4e0d\u9700\u8981\u63e1\u624b\u904e\u7a0b</li> </ul> </li> <li> <p>IPv4</p> <ul> <li>IPv4 address \u7684\u7e3d\u9577\u5ea6\u70ba 32 bits\uff0c\u4e26\u4e14\u4ee5 <code>.</code> \u5283\u5206\u70ba 4 \u500b\u5340\u6bb5</li> <li>\u6bcf\u4e00\u5340\u6bb5\u7684 number range = (0 ~ 255)<sub>10</sub></li> <li>\u6bcf\u4e00\u5340\u6bb5\u5206\u5225\u70ba 8 \u500b bits \u279e IPv4 \u4e2d\u7684\u6bcf\u500b\u6578\u5b57\u4ee3\u8868 8 bits</li> <li>\u7e3d\u5171 \u53ef\u5206\u914d\u51fa 2<sup>32</sup> \u500b unique \u7684 IPv4 address</li> <li>\u63a1\u7528\u53e5\u865f( <code>.</code> )\u4f86\u5206\u9694\u5404\u5340\u6bb5</li> <li> <p>\u793a\u610f\u5716:      </p> </li> <li> <p>IPv4 datagram \u5167\u5bb9</p> <ul> <li>\u5f9e\u4e0a\u81f3\u4e0b\uff0c\u7b2c 1 \uff5e 5 \u5217\uff08IP datagram header\uff09\u70ba\u5fc5\u586b\u6b04\u4f4d\uff0c\u7b2c 6 \u5217\uff08Option\uff09\u70ba\u9078\u586b\u6b04\u4f4d<ul> <li>IP datagram header: 20 bytes</li> </ul> </li> <li>IP datagram \u5206\u6bb5\u5f8c\uff0c\u8981\u91cd\u7d44\u6210\u539f\u672c\u7684 IP datagram\uff0c\u9700\u8981\u4ee5\u4e0b\u6b04\u4f4d:<ul> <li>Total Length (\u539f\u672c IP datagram \u7684\u5927\u5c0f)</li> <li>Identification (IP \u5206\u6bb5\u5c01\u5305\u624d\u80fd\u77e5\u9053\u5b83\u662f\u4f86\u81ea\u54ea\u4e00\u500b\u539f\u672c\u7684 IP)</li> <li>Flags (\u77e5\u9053\u54ea\u500b IP \u5206\u6bb5\u624d\u662f\u6700\u5f8c\u4e00\u500b\u5206\u6bb5\uff0c\u4e0d\u7136\u7121\u6cd5\u78ba\u8a8d IP \u5206\u6bb5\u5230\u5e95\u5230\u54ea\u7d50\u675f)</li> <li>Fragment Offset (\u7576\u8981\u91cd\u7d44\u7684\u6642\u5019\uff0c\u624d\u80fd\u7d44\u6210\u539f\u672c\u7684 IP datagram\uff0c\u4e0d\u7136\u9806\u5e8f\u6703\u932f\u4e82)</li> </ul> </li> </ul> <p></p> <ul> <li>Version: 4 bits\uff0c\u8868\u793a IP \u5354\u5b9a\u7684\u7248\u672c</li> <li>Internet Header Length: 4 bits\uff0c\u8868\u793a IP \u6a19\u982d\u7684\u9577\u5ea6\uff0c\u4ee5 32 bits \u70ba\u55ae\u4f4d</li> <li>Type of Service: 8 bits\uff0c\u7528\u65bc\u6307\u5b9a IP \u5c01\u5305\u5728\u50b3\u9001\u904e\u7a0b\u4e2d\u8981\u6c42\u7684\u670d\u52d9\u985e\u578b</li> <li>Total Length: 16 bits\uff0c\u8868\u793a\u6574\u500b IP \u5c01\u5305\u7684\u9577\u5ea6\uff0c\u5305\u62ec header, data</li> <li>Identification: 16 bits\uff0c\u7528\u65bc\u8b58\u5225 IP \u5c01\u5305\u7684\u5206\u6bb5\uff08fragmentation\uff09\u3001\u91cd\u7d44\uff08reassembly\uff09\u6240\u4f7f\u7528</li> <li>Flags: 3 bits\uff0c\u7528\u65bc\u63a7\u5236 IP \u5c01\u5305\u662f\u5426\u9700\u8981\u5206\u6bb5</li> <li>Fragment Offset: 13 bits\uff0c\u6307\u5b9a\u5206\u6bb5\u5c01\u5305\u7684\u504f\u79fb\u91cf\u3002\u7528\u65bc\u8fa8\u8b58\u5206\u6bb5\u5c01\u5305\u7684\u9806\u5e8f\uff0c\u4ee5\u53ca\u5c07\u5206\u6bb5\u5c01\u5305\u91cd\u7d44\u6210\u539f\u59cb\u5c01\u5305</li> <li>Time to Live (TTL): 8 bits\uff0c\u8868\u793a IP \u5c01\u5305\u5728\u7db2\u8def\u4e0a\u7684\u751f\u547d\u9031\u671f\uff0c\u6bcf\u7d93\u904e\u4e00\u500b router\uff0cTTL \u5c31\u6703\u6e1b\u5c11 1</li> <li>Protocol: 8 bits\uff0c\u8868\u793a IP \u5c01\u5305\u4e2d\u7684\u8cc7\u6599\u662f\u4f7f\u7528\u54ea\u7a2e\u5354\u5b9a\u50b3\u9001\u7684</li> <li>Header Checksum: 16 bits\uff0c\u9019\u500b\u6578\u503c\u4e3b\u8981\u7528\u4f86\u6aa2\u932f\u7528\u7684\uff0c\u78ba\u4fdd\u5c01\u5305\u88ab\u6b63\u78ba\u7121\u8aa4\u5730\u63a5\u6536\u5230</li> <li>Source IP Address: 32 bits\uff0c\u8868\u793a\u5c01\u5305\u7684\u767c\u9001\u8005 IP \u4f4d\u5740</li> <li>Destination IP Address: 32 bits\uff0c\u8868\u793a\u5c01\u5305\u7684\u63a5\u6536\u8005 IP \u4f4d\u5740</li> </ul> </li> </ul> </li> <li> <p>IPv6</p> <ul> <li>\u70ba\u4e0b\u4e00\u4ee3\u7684 IP address \u898f\u7bc4\uff0c\u63a1 16 \u9032\u5236(hexadecimal)\u8868\u793a</li> <li>IPv6 address \u7684\u7e3d\u9577\u5ea6\u70ba 128 bits</li> <li>IPv6 \u4e2d\u7684\u6bcf\u500b\u5b57\u5143(\u53ef\u80fd\u662f\u6578\u5b57 or \u5b57\u6bcd)\u4ee3\u8868 4 bits</li> <li>\u7e3d\u5171 \u53ef\u5206\u914d\u51fa 2<sup>128</sup> \u500b unique \u7684 IPv6 address</li> <li>\u63a1\u7528\u5206\u865f( <code>:</code> )\u4f86\u5206\u9694\u5404\u5340\u6bb5</li> <li>\u7576 IPv6 address \u4e2d\u6709\u8a31\u591a\u500b 0 \u6642\uff0c\u53ef\u4ee5\u6539\u7528 <code>::</code> \u4ee3\u66ff\uff0c\u4f46\u662f\u4e00\u6bb5 IPv6 address \u4e2d\u53ea\u80fd\u4f7f\u7528\u4e00\u6b21 <code>::</code></li> <li>\u512a\u9ede:<ul> <li>IPv6 \u63d0\u4f9b\u66f4\u5bec\u5ee3\u7684 IP \u5b9a\u5740\u7a7a\u9593</li> <li>IPv6 \u63d0\u4f9b\u50b3\u8f38\u6d41\u91cf\u7b49\u7d1a(Traffic Class)\u7684\u5206\u985e</li> <li>IPv6 \u7c21\u5316\u5c01\u5305\u6a19\u982d</li> <li>IPv6 datagram \u589e\u52a0\u4e86 Flow Label \u6b04\u4f4d\uff0c\u7528\u4f86\u652f\u63f4\u50cf\u8996\u8a0a\u3001\u8a9e\u97f3\u9019\u985e\u5373\u6642\u670d\u52d9\u7684\u9700\u6c42\uff0c\u4ee5\u63d0\u9ad8 QoS \u7684\u54c1\u8cea</li> <li>IPv6 \u9810\u8a2d\u4f7f\u7528 IPsec\uff0c\u4f86\u63d0\u5347\u5b89\u5168\u6027</li> </ul> </li> </ul> </li> <li> <p>IPv4 vs. IPv6</p> <ul> <li>datagram header \u6bd4\u8f03      \u5716\u7247\u4f86\u6e90</li> </ul> \u7279\u8272\\IP \u5354\u5b9a\u7248\u672c IPv4 IPv6 IP address \u9577\u5ea6 32 bits 128 bits \u9593\u9694\u65b9\u5f0f \u53e5\u865f( <code>.</code> ) \u5206\u865f( <code>:</code> ) IP address \u53ef\u4f7f\u7528\u6578\u91cf 2<sup>32</sup> \u500b 2<sup>128</sup> \u500b \u6d41\u91cf\u6a19\u7c64 \u7121 Flow label \u5ee3\u64ad address Host number \u5168\u70ba 1 \u4ee5\u591a\u64ad\u3001\u4efb\u64ad\u4f86\u53d6\u4ee3\u5ee3\u64ad \u81ea\u52d5\u7db2\u8def\u7d44\u614b\u8a2d\u5b9a \u900f\u904e DHCP Server \u9760 Neighbor Discovery \u5354\u5b9a\uff0c\u5f9e\u9130\u8fd1\u7684 router \u4e4b\u8cc7\u8a0a\u53d6\u5f97 \u5b89\u5168\u6027 \u672a\u5f37\u5236\u9700\u4f7f\u7528 IPsec\uff0c\u5b89\u5168\u6027\u8f03\u4f4e \u2193 \u9810\u8a2d\u4f7f\u7528 IPsec\uff0c\u5b89\u5168\u6027\u8f03\u9ad8 \u2191 QoS \u6a5f\u5236 \u8868\u982d\u6b04\u4f4d\u4e0d\u652f\u63f4 \u8868\u982d\u6b04\u4f4d\u652f\u63f4 \u8209\u4f8b <code>210.59.230.150</code> <code>1079:3:6ED4::44:72BE</code> <p>\u8a3b: IPv4 \u2194 IPv6 \u4e4b\u9593\u53ef\u4ee5\u4e92\u76f8\u8f49\u63db </p> </li> <li> <p>\u53c3\u8003\u8cc7\u6599:</p> <ul> <li>IPv4 Addressing and Subnetting</li> <li>iT Home --- IPv4</li> <li>iT Home --- \u8a8d\u8b58 IPv4 \u8207 IPv6 \u7684\u5dee\u7570</li> <li>\u5f71\u7247: IP Address - IPv4 vs IPv6 Tutorial</li> </ul> </li> </ul>"},{"location":"networking/networking/#icmp-internet-control-message-protocol","title":"ICMP (Internet Control Message Protocol)","text":"<ul> <li>\u7528\u9014: ICMP \u662f\u7db2\u8def\u5c64\u7684\u5354\u5b9a\uff0c\u7528\u65bc\u4e3b\u6a5f\u3001\u8def\u7531\u5668\u4e4b\u9593\u50b3\u905e\u7db2\u7d61\u5c64\u8cc7\u8a0a\u3002\u5176\u4e3b\u8981\u529f\u80fd\u5305\u62ec\uff1a<ul> <li>\u932f\u8aa4\u5831\u544a: \u7576\u4e3b\u6a5f, \u7db2\u8def, port, \u5354\u5b9a\u7121\u6cd5\u9001\u9054\u6642\uff0c\u56de\u5831\u932f\u8aa4</li> <li>\u56de\u61c9\u8acb\u6c42: \u4f7f\u7528 Echo Request, Echo Reply \u4f86\u6e2c\u8a66\u7db2\u8def\u9023\u901a\u6027 (e.g <code>ping</code>)</li> </ul> </li> <li>\u91cd\u8981\u89c0\u5ff5:<ul> <li>ICMP \u8207\u50b3\u8f38\u5c64\u901a\u8a0a\u5354\u5b9a\uff08TCP \u6216 UDP\uff09\u6c92\u6709\u95dc\u806f\uff0c\u56e0\u6b64\uff0cICMP \u6210\u70ba\u7121\u9023\u7dda\u7684\u901a\u8a0a\u5354\u5b9a\uff0c\u5728\u50b3\u9001 ICMP \u8a0a\u606f\u4e4b\u524d\uff0c\u4e00\u500b\u88dd\u7f6e\u4e0d\u9700\u8981\u958b\u555f\u8207\u53e6\u4e00\u500b\u88dd\u7f6e\u7684\u9023\u7dda</li> <li>ICMP \u901a\u8a0a\u5354\u5b9a\u4e5f\u4e0d\u5141\u8a31\u7d81\u5b9a\u88dd\u7f6e\u4e0a\u7684\u7279\u5b9a port</li> </ul> </li> <li> <p>ICMP \u5c01\u5305</p> <ul> <li> <p>ICMP \u5c01\u5305\u662f\u4f7f\u7528 ICMP \u901a\u8a0a\u5354\u5b9a\u7684\u5c01\u5305\u3002 ICMP \u5c01\u5305\u542b\u4e00\u822c IP \u6a19\u982d\u4e4b\u5f8c\u7684 ICMP \u6a19\u982d\u3002\u7576\u8def\u7531\u5668 or \u4f3a\u670d\u5668\u9700\u8981\u50b3\u9001\u932f\u8aa4\u8a0a\u606f\u6642\uff0cICMP \u5c01\u5305\u4e3b\u9ad4\u6216\u8cc7\u6599\u5340\u6bb5\u4e00\u5f8b\u6703\u5305\u542b\u9020\u6210\u932f\u8aa4\u4e4b\u5c01\u5305 IP \u6a19\u982d\u7684\u526f\u672c</p> <ul> <li> <p>ICMP packet = IP header + ICMP message(ICMP header + ICMP data)  \u5716\u7247\u51fa\u8655</p> </li> <li> <p>\u5e38\u898b\u7684 ICMP error message</p> <ul> <li>\u985e\u578b (Type): \u8868\u793a ICMP \u8a0a\u606f\u7684\u985e\u578b\uff0c\u5b9a\u7fa9\u4e86\u8a0a\u606f\u7684\u7e3d\u985e<ul> <li>0: Echo Reply</li> <li>3: Destination Unreachable</li> <li>8: Echo Request</li> <li>11: Time Exceeded</li> </ul> </li> <li>\u932f\u8aa4\u4ee3\u78bc (Code): \u7528\u65bc\u9032\u4e00\u6b65\u7d30\u5206 Type \u7684\u5177\u9ad4\u60c5\u6cc1\u3002\u4f8b\u5982: Type 3 (Destination Unreachable) \u4e2d<ul> <li>Code 0: Network Unreachable</li> <li>Code 1: Host Unreachable</li> <li>Code 3: Port Unreachable </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u5e38\u7528\u7684\u7d42\u7aef\u6a5f\u516c\u7528\u7a0b\u5f0f\u5c31\u662f\u4f7f\u7528 ICMP \u4f86\u6e2c\u8a66\u7db2\u8def\u901a\u8a0a\u7684\u53ef\u7528\u6027</p> <ul> <li><code>ping</code>: \u662f traceroute \u7684\u7c21\u5316\u7248\u672c\u3002ping \u5c07\u6e2c\u8a66\u5169\u500b\u88dd\u7f6e\u4e4b\u9593\u7684\u9023\u7dda\u901f\u5ea6\uff0c\u4e26\u6e96\u78ba\u5831\u544a\u5c01\u5305\u5230\u9054\u5176\u76ee\u7684\u5730\u4e26\u8fd4\u56de\u5bc4\u4ef6\u8005\u88dd\u7f6e\u6240\u9700\u7684\u6642\u9593<ul> <li>\u53ef\u7528\u65bc\u8861\u91cf\u7db2\u8def\u5ef6\u9072\u7684\u6307\u6a19</li> </ul> </li> <li><code>traceroute</code>: \u53ef\u7528\u4f86\u986f\u793a\u5169\u500b\u7db2\u969b\u7db2\u8def\u88dd\u7f6e\u4e4b\u9593\u7684\u8def\u7531\u8def\u5f91\u3002\u8def\u7531\u8def\u5f91\u662f\u9023\u63a5\u8def\u7531\u5668\u7684\u5be6\u969b\u7269\u7406\u8def\u5f91\uff0c\u8acb\u6c42\u5728\u5230\u9054\u76ee\u7684\u5730\u4e4b\u524d\u5fc5\u9808\u901a\u904e\u8a72\u8def\u7531\u5668<ul> <li>\u4e00\u500b\u8def\u7531\u5668\u8207\u53e6\u4e00\u500b\u8def\u7531\u5668\u4e4b\u9593\u7684\u65c5\u7a0b\u7a31\u70ba\u300c\u8e8d\u9ede\u300d (hop)\uff0c\u800c traceroute \u4e5f\u6703\u5831\u544a\u6bcf\u500b\u8e8d\u9ede\u6240\u9700\u7684\u6642\u9593\uff0c\u9019\u5c0d\u65bc\u78ba\u5b9a\u7db2\u8def\u5ef6\u9072\u7684\u4f86\u6e90\u5f88\u6709\u7528</li> </ul> </li> </ul> </li> <li> <p>\u5e38\u898b\u7684\u7db2\u8def\u653b\u64ca: ICMP \u56de\u61c9\u8981\u6c42\u548c\u56de\u61c9\u56de\u8986\u8a0a\u606f\u901a\u5e38\u7528\u65bc\u57f7\u884c ping\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u7db2\u8def\u653b\u64ca\u53ef\u4ee5\u5229\u7528\u9019\u500b\u904e\u7a0b\uff0c\u88fd\u9020\u7834\u58de\u624b\u6bb5\uff0c\u4f8b\u5982: ICMP \u6d2a\u6c34\u653b\u64ca\u3001\u6b7b\u4ea1\u4e4b ping \u653b\u64ca</p> <ul> <li> <p>ICMP \u6d2a\u6c34\u653b\u64ca: \u662f\u6307\u653b\u64ca\u8005\u5617\u8a66\u4f7f\u7528 ICMP \u56de\u61c9\u8acb\u6c42\u5c01\u5305\u58d3\u57ae\u76ee\u6a19\u88dd\u7f6e\u3002\u76ee\u6a19\u4e0d\u5f97\u4e0d\u8655\u7406\u548c\u56de\u61c9\u6bcf\u500b\u5c01\u5305\uff0c\u6d88\u8017\u5176\u904b\u7b97\u8cc7\u6e90\uff0c\u76f4\u5230\u5408\u6cd5\u4f7f\u7528\u8005\u7121\u6cd5\u63a5\u6536\u670d\u52d9     </p> </li> <li> <p>\u6b7b\u4ea1\u4e4b Ping \u653b\u64ca: \u662f\u6307\u653b\u64ca\u8005\u5c07\u5927\u65bc\u5c01\u5305\u5141\u8a31\u5927\u5c0f\u7684 ping \u50b3\u9001\u81f3\u76ee\u6a19\u96fb\u8166\uff0c\u9020\u6210\u6a5f\u5668\u5b95\u6a5f\u6216\u5d29\u6f70\u3002\u5c01\u5305\u5728\u5230\u9054\u5176\u76ee\u6a19\u7684\u9014\u4e2d\u88ab\u5206\u6bb5\uff0c\u4f46\u7576\u76ee\u6a19\u5c07\u5c01\u5305\u91cd\u65b0\u7d44\u88dd\u6210\u5176\u8d85\u51fa\u6700\u5927\u503c\u7684\u539f\u59cb\u5927\u5c0f\u6642\uff0c\u5c01\u5305\u7684\u5927\u5c0f\u6703\u5c0e\u81f4\u7de9\u885d\u5340\u6ea2\u4f4d\u3002</p> <ul> <li>\u5982\u4eca\uff0c\u6b7b\u4ea1\u4e4b Ping \u653b\u64ca\u57fa\u672c\u4e0a\u5df2\u6210\u904e\u53bb\u3002\u4f46\u662f\uff0c\u8f03\u820a\u7684\u7db2\u8def\u88dd\u7f6e\u4ecd\u7136\u53ef\u80fd\u53d7\u5230\u5b83\u7684\u5f71\u97ff</li> </ul> </li> <li>\u53c3\u8003\u9023\u7d50:</li> <li>Cloudflare: \u4ec0\u9ebc\u662f\u7db2\u969b\u7db2\u8def\u63a7\u5236\u8a0a\u606f\u901a\u8a0a\u5354\u5b9a (ICMP)\uff1f</li> <li>informIT: ICMP \u8a0a\u606f\u985e\u578b</li> </ul> </li> </ul>"},{"location":"networking/networking/#tools","title":"Tools","text":""},{"location":"networking/networking/#netcat-nc","title":"netcat (nc)","text":"<ul> <li>\u8aaa\u660e: <code>netcat</code> \u662f Linux \u7cfb\u7d71\u4e2d\u4e00\u500b\u591a\u529f\u80fd\u7684\u5de5\u5177\u7a0b\u5f0f\uff0c\u96d6\u7136\u5b83\u53ea\u662f\u4e00\u500b\u5c0f\u7a0b\u5f0f\uff0c\u4f46\u662f\u80fd\u5920\u505a\u7684\u4e8b\u60c5\u5f88\u591a\uff0c\u5c31\u50cf\u745e\u58eb\u5200\u4e00\u6a23\uff0c\u5e7e\u4e4e\u4efb\u4f55\u4f7f\u7528 TCP \u6216 UDP \u5c01\u5305\u7684\u52d5\u4f5c\u90fd\u53ef\u4ee5\u7528\u5b83\u4f86\u9054\u6210\uff0c\u662f\u8a31\u591a\u7cfb\u7d71\u7ba1\u7406\u8005\u5e38\u7528\u7684\u7db2\u8def\u8a3a\u65b7\u5de5\u5177\u4e4b\u4e00</li> <li> <p>\u4e3b\u8981\u529f\u80fd\u5305\u62ec</p> <ul> <li> <p>\u4f3a\u670d\u5668  \u5ba2\u6236\u7aef\u6a21\u5f0f: \u53ef\u6307\u5b9a\u4f3a\u670d\u5668\u7aef\u76e3\u807d\u6307\u5b9a\u7684 port\uff0c\u6216\u662f\u8b93\u5ba2\u6236\u7aef\u9023\u63a5\u5230\u6307\u5b9a port\uff0c\u4ee5\u5be6\u73fe client-server socket communication Bash<pre><code># Server \u76e3\u807d 2389 port \u7684\u8a0a\u606f\nnc localhost 2389\n</code></pre></p> Bash<pre><code># Client\nnc localhost 2389\n\n# \u5728\u7d42\u7aef\u6a5f\u756b\u9762\u4e0a\uff0c\u96a8\u610f\u8f38\u5165\u4e00\u6bb5\u6587\u5b57\nHi, server\n</code></pre> </li> <li> <p>\u6a94\u6848\u50b3\u8f38: \u53ef\u4ee5\u5c07\u6a94\u6848\u5f9e\u4e00\u500b\u88dd\u7f6e\u50b3\u9001\u5230\u53e6\u4e00\u500b\u88dd\u7f6e</p> <p>\u5047\u8a2d\u5728\u4f3a\u670d\u5668\u7aef\u6709\u4e00\u500b\u6a94\u6848\u53eb\u4f5c <code>test</code>\uff0c\u4e14\u5728\u5ba2\u6236\u7aef\u4e0a\u6709\u4e00\u500b\u6a94\u6848\u53eb\u4f5c <code>testfile</code></p> Bash<pre><code># Server: \u76e3\u807d 2389 port\uff0c\u4e26\u5c07\u5176\u5167\u5bb9\u5beb\u5165 test \u6a94\u6848\u4e2d\nnc -l 2389 &gt; test\n</code></pre> Bash<pre><code># Client: \u5c07 testfile \u6a94\u6848\u5167\u5bb9\u50b3\u9001\u5230\u4f3a\u670d\u5668\u7aef\ncat testfile | nc localhost 2389\n</code></pre> </li> <li> <p>\u8a2d\u5b9a\u9023\u7dda\u8d85\u6642\u9650\u5236: \u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u6211\u5011\u4e0d\u5e0c\u671b\u9023\u7dda\u6c38\u9060\u662f\u958b\u653e\u72c0\u614b\uff0c\u56e0\u6b64\u53ef\u4ee5\u900f\u904e <code>w</code> \u9078\u9805\u4f86\u8a2d\u5b9a\u9023\u7dda\u7684\u8d85\u6642\u9650\u5236     Bash<pre><code># Server: \u76e3\u807d 2389 port\nnc -l 2389\n</code></pre></p> Bash<pre><code># Client: \u9023\u63a5\u5230 2389 port\uff0c\u4e26\u8a2d\u5b9a\u9023\u7dda\u8d85\u6642\u9650\u5236\u70ba 10 \u79d2\nnc -w 10 localhost 2389\n</code></pre> <ul> <li>\u9019\u9ebc\u505a\u5f8c\uff0c\u9023\u7dda\u5c07\u6703\u5728 10 \u79d2\u5f8c\u81ea\u52d5\u95dc\u9589 <p>\u8acb\u52ff\u5728\u4f3a\u670d\u5668\u7aef\u4f7f\u7528\u5c07 <code>-w</code>, <code>-l</code> \u53c3\u6578\u4e00\u8d77\u4f7f\u7528\uff0c\u56e0\u70ba\u9019\u6a23 <code>-w</code> \u53c3\u6578\u6703\u88ab\u8996\u70ba\u7121\u6548\uff0c\u9023\u7dda\u5c07\u6703\u4e00\u76f4\u4fdd\u6301\u958b\u653e\u72c0\u614b\uff0c\u9019\u6a23\u6703\u6709\u98a8\u96aa\uff01</p> </li> </ul> </li> <li> <p><code>nc</code> \u53ef\u652f\u63f4 IPv4, IPv6 \u4f4d\u5740\uff0c\u4f7f\u7528 <code>-4</code>, <code>-6</code> \u9078\u9805\u4f86\u6307\u5b9a</p> <ul> <li> <p>IPv4     Bash<pre><code># Server\nnc -4 -l 2389\n</code></pre></p> Bash<pre><code># Client\nnc -4 localhost 2389\n</code></pre> Bash<pre><code>netstat | grep 2389\n</code></pre> Bash Session<pre><code>tcp        0      0 localhost:2389          localhost:50851         ESTABLISHED\ntcp        0      0 localhost:50851         localhost:2389          ESTABLISHED\n</code></pre> </li> <li> <p>IPv6     Bash<pre><code># Server\nnc -4 -l 2389\n</code></pre></p> Bash<pre><code># Client\nnc -4 localhost 2389\n</code></pre> Bash<pre><code>netstat | grep 2389\n</code></pre> Bash Session<pre><code># \u6703\u770b\u5230\u985e\u4f3c\u4ee5\u4e0b\u7684\u7d50\u679c\uff0c\u9019\u662f\u4e00\u500b\u5b8c\u6574\u7684\u96d9\u5411\u9023\u63a5\uff0c\u8868\u660e\u672c\u5730\u4e3b\u6a5f\u4e0a\u7684\u9019\u5169\u500b port \u4e4b\u9593\u7684\u9023\u63a5\u72c0\u614b\u70ba ESTABLISHED\uff0c\u8868\u793a\u9023\u63a5\u5df2\u6210\u529f\u5efa\u7acb\u4e26\u6b63\u5728\u9032\u884c\u901a\u8a0a\ntcp        0      0 localhost:2389          localhost:50851         ESTABLISHED\ntcp        0      0 localhost:50851         localhost:2389          ESTABLISHED\n</code></pre> </li> </ul> </li> <li> <p>\u7981\u7528\u8b80\u53d6 STDIN: \u6709\u6642\u5019\u6211\u5011\u4e0d\u5e0c\u671b <code>netcat</code> \u5f9e STDIN \u8b80\u53d6\u8cc7\u6599\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u5ba2\u6236\u7aef\u4f7f\u7528 <code>-d</code> \u53c3\u6578\u4f86\u7981\u7528 STDIN     Bash<pre><code># Server\nnc -l 2389\n</code></pre></p> Bash<pre><code># Client\nnc -d localhost 2389\n\n# \u5f9e\u9375\u76e4\u8f38\u5165 \"Hi\" (\u5373 STDIN)\nHi\n</code></pre> <ul> <li>\u4f7f\u7528 <code>-d</code> \u9078\u9805\uff0c\u5f9e STDIN \u8b80\u53d6\u7684\u5167\u5bb9\u5c07\u88ab\u7981\u7528\uff0c\u56e0\u6b64 \"Hi\" \u6587\u5b57\u4e0d\u6703\u88ab\u50b3\u9001\u5230\u4f3a\u670d\u5668\u7aef</li> </ul> </li> <li> <p>\u4fdd\u6301\u4f3a\u670d\u5668\u6301\u7e8c\u904b\u884c: \u6709\u6642\u5019\u7576\u5ba2\u6236\u7aef\u65b7\u958b\u9023\u63a5\uff0c\u6211\u5011\u4ecd\u5e0c\u671b\u4f3a\u670d\u5668\u6301\u7e8c\u904b\u884c\uff0c\u53ef\u4f7f\u7528 <code>-k</code> \u9078\u9805\u8b93\u4f3a\u670d\u5668\u6301\u7e8c\u904b\u884c     Bash<pre><code># Server\nnc -k -l 2389\n</code></pre></p> Bash<pre><code># Client\nnc localhost 2389\n\n# \u5728\u9375\u76e4\u4e0a\u6309\u4e0b Ctrl + C \u4f86\u7d50\u675f\u9023\u63a5\n^C\n</code></pre> </li> <li> <p>\u53ef\u8a2d\u5b9a\u7576\u5ba2\u6236\u7aef\u63a5\u6536\u5230 EOF (End of File) \u5f8c\uff0c\u4ecd\u4fdd\u6301\u9023\u7dda\u4e00\u6bb5\u6642\u9593\u3002\u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c<code>nc</code> \u5ba2\u6236\u7aef\u5728\u63a5\u6536\u5230 EOF \u5b57\u7b26\u5f8c\u6703\u7acb\u5373\u7d42\u6b62\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528 <code>-q</code> \u9078\u9805\u4f86\u5ba3\u544a\u8981\u5728\u63a5\u6536\u5230 EOF \u5f8c\u7b49\u5f85\u591a\u5c11\u79d2\uff0c\u518d\u7d42\u6b62\u9023\u63a5     Bash<pre><code># Client: \u7576\u5ba2\u6236\u7aef\u63a5\u6536\u5230 EOF \u5b57\u7b26\u5f8c\uff0c\u5c07\u6703\u7b49\u5f85 5 \u79d2\u5f8c\u518d\u7d42\u6b62\u9023\u63a5\nnc  -q 5  localhost 2389\n</code></pre></p> </li> <li> <p>\u53ef\u4f7f\u7528 UDP \u5354\u5b9a: \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c<code>nc</code> \u4f7f\u7528 TCP \u5354\u5b9a\uff0c\u4f46\u662f\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 <code>-u</code> \u9078\u9805\u4f86\u6307\u5b9a\u8981\u4f7f\u7528 UDP \u5354\u5b9a     Bash<pre><code># Server\nnc -4 -u -l 2389\n</code></pre></p> Bash<pre><code># Client\nnc -4 -u localhost 2389\n</code></pre> Bash<pre><code>netstat | grep 2389\n</code></pre> Bash Session<pre><code># \u6703\u770b\u5230\u985e\u4f3c\u4ee5\u4e0b\u7684\u7d50\u679c\uff0c\u8868\u793a\u7576\u524d\u7684\u9023\u7dda\u662f\u63a1\u7528 UDP \u5354\u5b9a\nudp        0      0 localhost:42634         localhost:2389          ESTABLISHED\n</code></pre> </li> <li> <p>\u53c3\u8003\u9023\u7d50: 8 Practical Linux Netcat NC Command Examples</p> </li> </ul> </li> </ul>"},{"location":"networking/networking/#ping","title":"ping","text":"<ul> <li>\u8aaa\u660e: <code>ping</code> \u5de5\u5177\u6703\u900f\u904e\u767c\u9001 ICMP \u5354\u5b9a\u7684 Echo Request \u5c01\u5305\u7d66\u76ee\u7684\u5730\u8a2d\u5099\uff0c\u4f86\u6e2c\u8a66\u7db2\u8def\u9023\u63a5\u7684\u554f\u984c</li> <li>\u4e3b\u8981\u529f\u80fd: \u80fd\u63d0\u4f9b\u4ee5\u4e0b\u5169\u7a2e\u8cc7\u8a0a<ul> <li>\u56de\u50b3\u7684\u56de\u61c9\u6578\u91cf</li> <li>\u82b1\u8cbb\u591a\u4e45\u6642\u9593\u4f86\u56de\u61c9</li> </ul> </li> <li>\u5e38\u898b\u7684 <code>ping</code> \u6307\u4ee4\u7684\u9078\u9805<ul> <li><code>-a</code>: \u82e5\u80fd\u89e3\u6790\uff0c\u5c31\u6703\u5c07\u76ee\u7684\u5730\u7684 IP \u4f4d\u5740\uff0c\u89e3\u6790\u70ba hostname</li> <li><code>-f</code>: \u9632\u6b62 ICMP Echo Request \u8a0a\u606f\u88ab\u8def\u7531\u5668\u5206\u6bb5</li> <li><code>-i &lt;TTL&gt;</code>: \u8a2d\u5b9a Time To Live\uff08TTL\uff09\u503c\uff0c\u7bc4\u570d\u70ba 1 \uff5e 255</li> <li><code>-s &lt;size&gt;</code>: \u6307\u5b9a\u8981\u50b3\u9001\u7684\u5c01\u5305\u5927\u5c0f\uff0c\u9810\u8a2d\u70ba 32 bytes</li> <li><code>-c &lt;count&gt;</code>: \u6307\u5b9a\u8981\u50b3\u9001\u7684\u5c01\u5305\u6578\u91cf\uff0c\u9810\u8a2d\u70ba 4 \u500b</li> <li><code>-l</code>: \u8a2d\u5b9a\u9810\u5148\u767c\u9001\u7684\u5c01\u5305\u6578\u91cf\u3002\u4ea6\u5373\u5728\u958b\u59cb\u6b63\u5e38\u767c\u9001\u5c01\u5305\u4e4b\u524d\uff0c\u5148\u5feb\u901f\u767c\u9001\u4e00\u4e9b\u5c01\u5305\uff08\u9810\u767c\u9001\uff09\uff0c\u4ee5\u6e2c\u8a66\u7db2\u8def\u7684\u7a69\u5b9a\u6027</li> </ul> </li> <li> <p>\u5e38\u898b\u7528\u6cd5</p> <ul> <li> <p>\u900f\u904e <code>ping</code> \u6307\u4ee4\uff0c\u5411 <code>www.google.com</code> \u767c\u9001 5 \u500b\u5c01\u5305\uff0c\u9810\u5148\u767c\u9001 1500 \u500b\u5c01\u5305\uff0c\u4ee5\u6e2c\u8a66\u7db2\u8def\u7684\u7a69\u5b9a\u6027     Bash<pre><code>sudo ping -c 5 -l 1500 www.google.com\n</code></pre></p> <p> - \u8aaa\u660e: 0% packet loss \u8868\u793a\u767c\u9001\u5230 <code>www.google.com</code> \u7684\u6bcf\u500b ICMP Echo Request \u5c01\u5305\u90fd\u5df2\u56de\u50b3\u6210\u529f\uff0c\u4ee3\u8868\u7db2\u8def\u9023\u63a5\u6b63\u5e38</p> </li> <li> <p>\u900f\u904e <code>ping</code> \u6307\u4ee4\uff0c\u5411 localhost IP \u4f4d\u5740(loopback address)\u767c\u9001\u5c01\u5305\uff0c\u6aa2\u6e2c\u4f5c\u696d\u7cfb\u7d71\u7684\u7db2\u8def\u529f\u80fd\u662f\u5426\u6b63\u5e38 Bash<pre><code>ping 127.0.0.1\n</code></pre></p> </li> <li> <p>\u900f\u904e <code>ping</code> \u6307\u4ee4\uff0c\u67e5\u8a62\u76ee\u6a19 IP \u4f4d\u5740\u7684 hostname\uff0c\u6709\u52a9\u65bc\u8a3a\u65b7\u7db2\u8def\u554f\u984c (\u4f8b\u5982: \u78ba\u8a8d\u67d0\u500b IP \u5730\u5740\u662f\u5426\u6b63\u78ba\u5c0d\u61c9\u5230\u9810\u671f\u7684\u4e3b\u6a5f)     Bash<pre><code>ping -a 192.168.1.22\n</code></pre></p> </li> <li> <p>\u900f\u904e <code>ping</code> \u6307\u4ee4\uff0c\u6e2c\u8a66\u672c\u6a5f\u8207\u8def\u7531\u5668\u4e4b\u9593\u7684\u9023\u7dda\u72c0\u6cc1</p> <p>\u5728\u5167\u7db2\u4e2d\uff0c\u8def\u7531\u5668(router)\u7684\u9810\u8a2d IP \u4f4d\u5740\u901a\u5e38\u662f <code>192.168.2.1</code></p> Bash<pre><code>ping 192.168.2.1\n</code></pre> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50: How to Use the Ping Command for Testing in Windows</p> </li> </ul>"},{"location":"networking/networking/#traceroute","title":"traceroute","text":"<ul> <li>\u8aaa\u660e: <code>traceroute</code> \u662f\u4e00\u500b\u5e38\u7528\u7684\u7db2\u7d61\u8a3a\u65b7\u5de5\u5177\uff0c\u7528\u65bc\u8ffd\u8e64\u5c01\u5305\u5f9e \u4f86\u6e90\u4e3b\u6a5f  \u76ee\u6a19\u4e3b\u6a5f \u6240\u7d93\u904e\u7684\u8def\u5f91</li> <li> <p>\u5b89\u88dd\u65b9\u6cd5:</p> <ul> <li> <p>Ubuntu     Bash<pre><code>sudo apt-get install traceroute\n</code></pre></p> </li> <li> <p>CentOS     Bash<pre><code>sudo yum install traceroute\n</code></pre></p> </li> </ul> </li> <li> <p>\u57fa\u672c\u7528\u6cd5</p> <ul> <li> <p>\u67e5\u8a62\u5c01\u5305\u5230\u9054\u76ee\u6a19 IP address \u6240\u7d93\u904e\u7684\u8def\u7531\u5668\u3001\u5176 IP \u5730\u5740\u3001\u56de\u61c9\u6642\u9593</p> <ul> <li>\u5728 <code>traceroute</code> \u5de5\u5177\u4e2d\uff0c\u53ea\u6709\u76ee\u6a19 IP \u4f4d\u5740\u662f\u5fc5\u586b\u7684\u53c3\u6578 Bash<pre><code>traceroute www.google.com\n</code></pre></li> </ul> <p></p> </li> </ul> </li> <li> <p>\u5e38\u7528\u53c3\u6578</p> <ul> <li><code>-w</code>: \u8a2d\u5b9a\u7b49\u5f85\u6bcf\u500b\u56de\u61c9\u7684\u6642\u9593\uff0c\u9810\u8a2d\u70ba 5 \u79d2</li> <li><code>-q</code>: \u8a2d\u5b9a\u8981\u767c\u9001\u7684\u5c01\u5305\u6578\u91cf\uff0c\u9810\u8a2d\u70ba 3 \u500b</li> <li><code>-m</code>: \u8a2d\u5b9a\u6700\u5927 TTL\uff08Time To Live\uff09\u503c\uff0c\u4e5f\u5c31\u662f\u8df3\u8e8d\u6578(hop)\uff0c\u9810\u8a2d\u70ba 30 \u6b21\u8df3\u8e8d</li> <li><code>-f</code>: \u8a2d\u5b9a\u8d77\u59cb TTL \u503c\uff0c\u9810\u8a2d\u70ba 1</li> <li><code>-s</code>: \u4f7f\u7528\u6307\u5b9a\u7684\u4f86\u6e90 IP \u4f4d\u5740\u4f5c\u70ba\u5c01\u5305\u767c\u9001\u7684\u8d77\u9ede</li> <li><code>-n</code>: \u7981\u6b62\u5c07 IP \u4f4d\u5740\u89e3\u6790\u70ba hostname</li> <li><code>-F</code>: \u7981\u6b62\u5c07\u63a2\u6e2c\u5c01\u5305\uff08ICMP Echo Request\uff09\u5206\u6bb5\u50b3\u9001\uff0c\u78ba\u4fdd\u5c01\u5305\u4e0d\u6703\u88ab\u8def\u7531\u5668\u5206\u6bb5\uff0c\u4ee5\u66f4\u6e96\u78ba\u5730\u6e2c\u8a66\u7db2\u8def\u9023\u7dda\u7684\u72c0\u6cc1</li> </ul> </li> <li><code>ping</code> vs. <code>traceroute</code><ul> <li><code>ping</code>: <ul> <li>\u662f\u4e00\u500b\u6838\u5fc3\u7684\u7db2\u8def\u9023\u7dda\u9664\u932f\u5de5\u5177\uff0c\u5b83\u4f7f\u7528 Echo Request\u3001Echo Reply \u7684 ICMP \u5c01\u5305\u4f86\u5224\u65b7\u67d0\u500b IP \u4f4d\u5740\u662f\u5426\u53ef\u4ee5\u6b63\u78ba\u62b5\u9054\u4e26\u4e14\u6709\u56de\u61c9</li> <li><code>ping</code> \u9084\u6703\u63d0\u4f9b \u4f86\u6e90\u5730\u5740\u3001\u76ee\u6a19\u5730\u5740 \u4e4b\u9593\u7684\u5f80\u8fd4\u6642\u9593 (Round-Trip Time, RTT)\uff0c\u901a\u5e38\u4ee5\u6beb\u79d2\u70ba\u55ae\u4f4d\u6e2c\u91cf</li> </ul> </li> <li><code>traceroute</code>:<ul> <li>\u7528\u65bc\u78ba\u5b9a\u5c01\u5305\u5230\u9054\u5176\u76ee\u7684\u5730\u6240\u7d93\u904e\u7684\u8def\u7531\u8def\u5f91</li> <li><code>traceroute</code> \u4e0d\u50c5\u6703\u8b58\u5225\u5c01\u5305\u7d93\u904e\u7684\u6bcf\u500b\u8def\u7531\u5668\uff0c\u9084\u6703\u6e2c\u91cf\u6bcf\u500b\u8def\u7531\u7bc0\u9ede (hop) \u6240\u7d93\u6b77\u7684\u5ef6\u9072\u6642\u9593</li> </ul> </li> <li>\u7d71\u6574: \u9019\u5169\u500b\u5de5\u5177\u5728\u7db2\u8def\u9023\u63a5\u9664\u932f\u4e2d\u90fd\u5f88\u5e38\u4f7f\u7528<ul> <li><code>ping</code> \u7528\u4f86\u5feb\u901f\u6e2c\u8a66\u76ee\u6a19\u662f\u5426\u53ef\u5230\u9054\uff0c\u4e26\u6aa2\u6e2c\u7db2\u8def\u9023\u63a5\u7684\u5ef6\u9072</li> <li><code>traceroute</code> \u5247\u7528\u4f86\u8ffd\u8e64\u5c01\u5305\u7684\u8def\u5f91\uff0c\u5e6b\u52a9\u8b58\u5225\u7db2\u8def\u8def\u7531\u4e0a\u7684\u554f\u984c</li> </ul> </li> </ul> </li> <li>\u53c3\u8003\u9023\u7d50: Linux manual page: traceroute</li> </ul>"},{"location":"networking/networking/#mtr","title":"mtr","text":"<p><code>ping</code>, <code>traceroute</code>, <code>mtr</code> \u9019\u4e09\u500b\u90fd\u662f\u7528\u4f86\u6e2c\u8a66\u7db2\u8def\u9023\u7dda\u7684\u5de5\u5177\uff0c\u4f46\u662f <code>mtr</code> \u662f <code>ping</code> \u548c <code>traceroute</code> \u7684\u7d50\u5408\u9ad4\uff0c\u5b83\u53ef\u4ee5\u63d0\u4f9b\u66f4\u591a\u7684\u8cc7\u8a0a\uff0c\u4e26\u4e14\u53ef\u4ee5\u6301\u7e8c\u76e3\u63a7\u7db2\u8def\u9023\u7dda\u7684\u72c0\u6cc1</p> <p><code>ping</code>: \u900f\u904e\u767c\u9001 ICMP Echo Request \u5c01\u5305\u4e26\u8a08\u7b97\u5f80\u8fd4\u6642\u9593\u4f86\u6e2c\u8a66\u7db2\u8def\u9023\u7dda\u7684\u72c0\u6cc1</p> <p><code>traceroute</code> \u548c <code>mtr</code>: \u4f7f\u7528 TTL \u4f86\u8ffd\u8e64\u5c01\u5305\u5f9e \u4f86\u6e90\u4e3b\u6a5f  \u76ee\u6a19\u4e3b\u6a5f \u7684\u8def\u7531\u72c0\u6cc1</p> <ul> <li>\u8aaa\u660e: <code>mtr</code> \u662f\u4e00\u500b\u7db2\u8def\u8a3a\u65b7\u5de5\u5177\uff0c\u5b83\u7d50\u5408\u4e86 <code>ping</code> \u548c <code>traceroute</code> \u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u63d0\u4f9b\u66f4\u5b8c\u6574\u7684\u8cc7\u8a0a\uff0c\u4e26\u4e14\u53ef\u4ee5\u6301\u7e8c\u76e3\u63a7\u7db2\u8def\u9023\u7dda\u7684\u72c0\u6cc1</li> <li> <p>\u5b89\u88dd\u65b9\u6cd5:</p> <ul> <li> <p>Ubuntu     Bash<pre><code>apt update &amp;&amp; apt upgrade\napt install mtr-tiny\n</code></pre></p> </li> <li> <p>CentOS     Bash<pre><code>yum update\nyum install mtr\n</code></pre></p> </li> </ul> </li> <li> <p>\u7522\u751f <code>mtr</code> \u5831\u544a     Text Only<pre><code>sudo mtr -rw www.google.com\n</code></pre></p> <ul> <li><code>r</code>: \u7522\u751f\u5831\u544a (\u82e5\u6c92\u6709\u52a0\u4e0a <code>-r</code> \u9078\u9805\uff0c\u5247\u6703\u5728\u4e92\u52d5\u5f0f\u74b0\u5883\u4e0b\uff0c\u6301\u7e8c\u76e3\u63a7)</li> <li><code>w</code>: \u986f\u793a\u6bcf\u500b\u8e8d\u9ede\u7684\u5b8c\u6574\u4e3b\u6a5f\u540d\u7a31</li> </ul> </li> <li> <p>\u95b1\u8b80 <code>mtr</code> \u5831\u544a     </p> <ul> <li><code>mtr</code> \u5831\u544a\u4e2d\u7684\u6bcf\u500b\u7de8\u865f\u884c\u4ee3\u8868\u4e00\u500b\u8e8d\u9ede(hop)<ul> <li>\u8e8d\u9ede\u662f\u5c01\u5305\u5230\u9054\u76ee\u7684\u5730\u6240\u7d93\u904e\u7684\u7db2\u8def\u7bc0\u9ede</li> </ul> </li> <li><code>Loss%</code>: \u8868\u793a\u6bcf\u7d93\u904e\u4e00\u500b\u8e8d\u9ede\uff0c\u6240\u767c\u751f\u7684\u5c01\u5305\u907a\u5931\u767e\u5206\u7387</li> <li><code>Snt</code>: \u8868\u793a\u767c\u9001\u7684\u5c01\u5305\u6578\u91cf (\u9810\u8a2d\u70ba 10 \u500b\u5c01\u5305)</li> <li>\u8861\u91cf\u5ef6\u9072\u7684\u6307\u6a19 (\u4ee5\u6beb\u79d2\u70ba\u55ae\u4f4d)<ul> <li><code>Last</code>: \u8868\u793a\u6700\u5f8c\u4e00\u500b\u5c01\u5305\u7684\u5f80\u8fd4\u6642\u9593</li> <li><code>Avg</code>: \u8868\u793a\u6240\u6709\u5c01\u5305\u7684\u5e73\u5747\u5f80\u8fd4\u6642\u9593</li> <li><code>Best</code>: \u8868\u793a\u6240\u6709\u5c01\u5305\u7684\u6700\u4f4e\u5f80\u8fd4\u6642\u9593 = (\u6700\u4f73)</li> <li><code>Wrst</code>: \u8868\u793a\u6240\u6709\u5c01\u5305\u7684\u6700\u9ad8\u5f80\u8fd4\u6642\u9593 = (\u6700\u5dee)</li> <li><code>StDev</code>: \u63d0\u4f9b\u4e86\u6bcf\u500b\u4e3b\u6a5f\u7684\u5ef6\u9072\u7684\u6a19\u6e96\u5dee\u3002\u7576\u6a19\u6e96\u5dee\u8d8a\u9ad8\uff0c\u5ef6\u9072\u6e2c\u91cf\u4e4b\u9593\u7684\u5dee\u7570\u5c31\u8d8a\u5927</li> </ul> </li> <li>\u901a\u5e38\uff0c<code>mtr</code> \u5831\u544a\u53ef\u5206\u70ba\u4e09\u500b\u90e8\u5206<ul> <li>\u524d 2 ~ 3 \u8e8d\u9ede: \u901a\u5e38\u4ee3\u8868 \u4f86\u6e90\u4e3b\u6a5f\u7684 ISP</li> <li>\u4e2d\u9593\u7684\u8e8d\u9ede: \u901a\u5e38\u4ee3\u8868 \u50b3\u8f38\u904e\u7a0b\u4e2d\u6240\u7d93\u904e\u7684\u8def\u7531\u5668<ul> <li>\u4e0d\u5e78\u7684\u662f\uff0c\u5982\u679c\u662f\u4e2d\u9593\u8e8d\u9ede\u51fa\u73fe\u554f\u984c\uff0c\u5169\u500b ISP \u89e3\u6c7a\u6b64\u554f\u984c\u7684\u80fd\u529b\u90fd\u6709\u9650</li> </ul> </li> <li>\u6700\u5f8c 2 ~ 3 \u8e8d\u9ede: \u901a\u5e38\u4ee3\u8868 \u76ee\u7684\u5730\u4e3b\u6a5f\u7684 ISP</li> </ul> </li> </ul> </li> <li> <p>\u5206\u6790 <code>mtr</code> \u5831\u544a</p> <p>\u5728\u5206\u6790 <code>mtr</code> \u5831\u544a\u6642\uff0c\u6211\u5011\u6700\u9700\u8981\u95dc\u6ce8\u7684\u5169\u4ef6\u4e8b: \u5c01\u5305\u907a\u5931\u7387 \u548c \u5ef6\u9072</p> <p> \u5716\u7247\u51fa\u8655</p> <ul> <li>\u6839\u64da\u4e0a\u5716\uff0c\u82e5\u5728\u4efb\u4e00\u8e8d\u9ede\u4e0a\uff0c\u770b\u5230 <code>Loss</code> \u503c\u7570\u5e38\uff0c\u5247\u53ef\u80fd\u662f\u8a72\u8e8d\u9ede\u7684\u8def\u7531\u5668\u51fa\u73fe\u554f\u984c<ul> <li>\u7136\u800c\uff0c\u56e0\u70ba\u90e8\u5206 ISP \u6703\u5c0d <code>mtr</code> \u5de5\u5177\u6240\u4f7f\u7528\u7684 ICMP \u5354\u5b9a\u9032\u884c\u6d41\u91cf\u9650\u5236\uff0c\u56e0\u6b64\u8981\u89c0\u5bdf\u5f8c\u7e8c\u7684\u8e8d\u9ede\u624d\u80fd\u78ba\u5b9a\u554f\u984c\u6240\u5728\u3002\u82e5\u5f8c\u7e8c\u8e8d\u9ede\u7684 <code>Loss</code> \u503c\u70ba 0%\uff0c\u5247\u8868\u793a ICMP \u5c01\u5305\u53d7\u5230 ISP \u6d41\u91cf\u9650\u5236</li> </ul> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> <ul> <li>\u6839\u64da\u4e0a\u5716\uff0c\u82e5\u5728\u8e8d\u9ede 2 \uff5e \u8e8d\u9ede 3\u3001\u8e8d\u9ede 3 \uff5e \u8e8d\u9ede 4 \u767c\u751f 60 % \u7684\u5c01\u5305\u907a\u5931\u7387\uff0c\u4f46\u662f\u5f8c\u7e8c\u7684\u8e8d\u9ede\u537b\u6c92\u6709\u7e7c\u7e8c\u907a\u5931\u5c01\u5305\uff0c\u5247\u8868\u793a ICMP \u5c01\u5305\u53d7\u5230 ISP \u6d41\u91cf\u9650\u5236\uff0c\u56e0\u70ba\u5f8c\u7e8c\u7684\u5e7e\u500b\u8e8d\u9ede\u50c5\u767c\u751f 40 % \u7684\u5c01\u5305\u907a\u5931\u7387  \u7576 <code>mtr</code> \u5831\u544a\u4e2d\u51fa\u73fe\u4e0d\u540c\u7684\u5c01\u5305\u907a\u5931\u7387\u6642\uff0c\u8acb\u7e3d\u662f\u76f8\u4fe1\u8f03\u5f8c\u9762\u7684\u8e8d\u9ede</li> <li>\u6709\u6642\u5019\uff0c\u5c01\u5305\u907a\u5931\u7684\u60c5\u6cc1\u6703\u767c\u751f\u5728\u5c01\u5305\u56de\u50b3\u7684\u904e\u7a0b\uff0c\u56e0\u70ba\u5c01\u5305\u53ef\u4ee5\u6210\u529f\u5730\u50b3\u9001\u5230\u76ee\u6a19\u4e3b\u6a5f\u4e0a\uff0c\u4f46\u537b\u4e0d\u5bb9\u6613\u56de\u50b3\u5230\u4f86\u6e90\u4e3b\u6a5f\u4e0a  \u56e0\u6b64\uff0c\u5efa\u8b70\u6700\u597d\u96d9\u5411\u6536\u96c6 <code>mtr</code> \u5831\u544a\uff0c\u624d\u80fd\u8f03\u70ba\u6e96\u78ba\u5730\u5224\u65b7\u554f\u984c\u6240\u5728</li> <li>\u5be6\u52d9\u4e0a\uff0c\u5c01\u5305\u5728\u50b3\u8f38\u7684\u904e\u7a0b\u4e2d\u53ef\u80fd\u6703\u9047\u5230\u4e00\u4e9b\u4e0d\u53ef\u907f\u514d\u7684\u554f\u984c (\u4f8b\u5982: \u7db2\u969b\u7db2\u8def\u53ef\u80fd\u5b58\u5728\u7db2\u8def\u9000\u5316\u554f\u984c\u3001\u8def\u7531\u5668\u8ca0\u8f09\u9650\u5236\u3001\u7db2\u8def\u7dad\u8b77\u554f\u984c\u7b49)  \u56e0\u6b64\uff0c<code>Loss</code> \u503c\u5728 10 % \u5de6\u53f3\u7684\u5c11\u91cf\u5c01\u5305\u907a\u5931\u7387\uff0c\u90fd\u662f\u53ef\u63a5\u53d7\u7684\u7bc4\u570d</li> </ul> <p> \u5716\u7247\u51fa\u8655</p> <ul> <li>\u6839\u64da\u4e0a\u5716\uff0c\u5728\u8e8d\u9ede 3 \uff5e \u8e8d\u9ede 4 \u767c\u751f\u660e\u986f\u7684\u7db2\u8def\u5ef6\u9072\uff0c\u4e26\u4e14\u5728\u5f8c\u7e8c\u7684\u8e8d\u9ede\u4e2d\uff0c\u7db2\u8def\u5ef6\u9072\u79d2\u6578\u7121\u660e\u986f\u589e\u52a0\uff0c\u5247\u53ef\u4ee5\u5408\u7406\u5730\u5047\u8a2d\u7b2c\u56db\u500b\u8def\u7531\u5668\u53ef\u80fd\u6709\u554f\u984c</li> </ul> <p> \u5716\u7247\u51fa\u8655</p> <ul> <li>\u6839\u64da\u4e0a\u5716\uff0c\u4e4d\u770b\u4e4b\u4e0b\u96d6\u7136\u8e8d\u9ede 4 \uff5e \u8e8d\u9ede 5 \u4e4b\u9593\u7684\u7db2\u8def\u5ef6\u9072\u79d2\u6578\u8f03\u9ad8\uff0c\u4f46\u662f\u5728\u5f8c\u7e8c\u7684\u8e8d\u9ede\u4e2d\uff0c\u7db2\u8def\u5ef6\u9072\u79d2\u6578\u6025\u5287\u4e0b\u964d\uff0c\u5247\u8868\u793a\u7b2c\u4e94\u500b\u8def\u7531\u5668\u6709 ICMP \u6d41\u91cf\u9650\u5236  \u5728\u8a55\u4f30 <code>mtr</code> \u5831\u544a\u4e2d\uff0c\u95dc\u65bc\u7db2\u8def\u5ef6\u9072\u7684\u554f\u984c\u6642\uff0c\u8acb\u5148\u770b\u6700\u5f8c\u4e00\u500b\u8e8d\u9ede\u7684 <code>Loss</code> \u503c</li> <li>\u5728 <code>mtr</code> \u5831\u544a\u4e2d\u6240\u767c\u751f\u7684\u5e38\u898b\u554f\u984c</li> <li> <p>\u60c5\u6cc1 1: \u76ee\u6a19\u4e3b\u6a5f\u7684\u7db2\u8def\u9023\u7dda\u8a2d\u5b9a\u7570\u5e38      \u5716\u7247\u51fa\u8655</p> <ul> <li>\u6839\u64da\u4e0a\u5716\uff0c\u8e8d\u9ede 8 \u767c\u751f\u4e86 100 % \u7684\u5c01\u5305\u907a\u5931\u7387\uff0c\u4e26\u4e14\u9019\u662f\u6700\u5f8c\u4e00\u500b\u8e8d\u9ede<ul> <li>\u8868\u793a\u96d6\u7136\u6d41\u91cf\u78ba\u5be6\u50b3\u9001\u5230\u76ee\u6a19\u4e3b\u6a5f\u4e86\uff0c\u4f46\u56e0\u70ba\u76ee\u6a19\u4e3b\u6a5f\u672a\u767c\u9001\u56de\u61c9\uff0c\u9019\u53ef\u80fd\u662f\u7531\u65bc\u7db2\u8def or \u9632\u706b\u7246 (iptables) \u898f\u5247\u8a2d\u5b9a\u4e0d\u7576\uff0c\u5c0e\u81f4\u4e3b\u6a5f\u4e1f\u68c4 ICMP \u5c01\u5305</li> </ul> </li> </ul> </li> <li> <p>\u60c5\u6cc1 2: \u5bb6\u7528 or \u5546\u7528\u8def\u7531\u5668\u7684 ICMP \u6d41\u91cf\u9650\u5236</p> <p> \u5716\u7247\u51fa\u8655</p> <ul> <li> <p>\u6839\u64da\u4e0a\u5716\uff0c\u8e8d\u9ede 2 \u96d6\u7136\u767c\u751f\u4e86 100 % \u7684\u5c01\u5305\u907a\u5931\u7387\uff0c\u4f46\u662f\u5728\u5f8c\u7e8c\u7684\u8e8d\u9ede\u4e2d\uff0c\u5c01\u5305\u907a\u5931\u7387\u70ba 0%\uff0c\u9019\u8868\u793a\u8e8d\u9ede 2 \u7684\u8def\u7531\u5668\u53ef\u80fd\u5c0d ICMP \u6d41\u91cf\u9032\u884c\u4e86\u9650\u5236</p> <ul> <li>\u60c5\u6cc1 3: ISP \u7684\u8def\u7531\u5668\u8a2d\u5b9a\u7570\u5e38 </li> </ul> </li> <li> <p>\u7576 <code>mtr</code> \u5831\u544a\u4e2d\u51fa\u73fe ??? \u6642\uff0c\u53ef\u80fd\u8868\u793a\u8def\u7531\u5668\u7684\u8def\u7531\u8a2d\u5b9a\u4e0d\u6b63\u78ba\uff0c\u5c0e\u81f4\u5c01\u5305\u7121\u6cd5\u50b3\u9001\u5230\u76ee\u6a19\u4e3b\u6a5f</p> </li> </ul> <p> \u5716\u7247\u51fa\u8655</p> <ul> <li> <p>\u6839\u64da\u4e0a\u5716\uff0c\u8e8d\u9ede 4 \u7684\u8def\u7531\u5668\u8a2d\u5b9a\u7570\u5e38\uff0c\u5c0e\u81f4\u5c01\u5305\u5728\u8def\u7531\u5668\u4e4b\u9593\u5faa\u74b0\u50b3\u9001\uff0c\u9700\u901a\u77e5\u7db2\u8def\u7ba1\u7406\u54e1\u4f86\u89e3\u6c7a\u6b64\u554f\u984c</p> <ul> <li>\u60c5\u6cc1 4: \u53d7\u5230 ICMP \u5c01\u5305\u7684\u901f\u7387\u9650\u5236\uff0c\u5c0e\u81f4\u5c01\u5305\u907a\u5931  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li> <p>\u6839\u64da\u4e0a\u5716\uff0c\u8e8d\u9ede 5 \u767c\u751f 60 % \u7684\u5c01\u5305\u907a\u5931\u7387\uff0c\u4f46\u662f\u5728\u5f8c\u7e8c\u7684\u8e8d\u9ede\u4e2d\uff0c\u5c01\u5305\u907a\u5931\u7387\u70ba 0%\uff0c\u9019\u8868\u793a\u8e8d\u9ede 5 \u7684\u8def\u7531\u5668\u53ef\u80fd\u5c0d ICMP \u6d41\u91cf\u9032\u884c\u4e86\u9650\u5236</p> <ul> <li>\u60c5\u6cc1 5: \u8d85\u6642\u554f\u984c (timeout)  \u5716\u7247\u51fa\u8655</li> </ul> </li> <li> <p>\u6839\u64da\u4e0a\u5716\uff0c\u6709\u5f88\u591a\u7a2e\u539f\u56e0\u53ef\u80fd\u6703\u5c0e\u81f4\u767c\u751f\u8d85\u6642\u554f\u984c\uff0c\u4f8b\u5982: \u8def\u7531\u5668\u4e1f\u68c4 ICMP \u5c01\u5305, \u5c01\u5305\u8fd4\u56de\u8def\u7531\u7570\u5e38 \u7b49</p> <ul> <li>\u8d85\u6642\u554f\u984c\uff0c\u4e26\u4e0d\u4e00\u5b9a\u6703\u5c0e\u81f4\u5c01\u5305\u907a\u5931\uff0c\u4f46\u662f\u53ef\u80fd\u6703\u5c0e\u81f4\u5ef6\u9072\u589e\u52a0\uff0c\u5c01\u5305\u4ecd\u80fd\u6b63\u78ba\u9001\u9054\u76ee\u6a19\u4e3b\u6a5f</li> <li>\u8d85\u6642\u554f\u984c\u53ef\u80fd\u767c\u751f\u5728\u8def\u7531\u5668\u57fa\u65bc\u670d\u52d9\u54c1\u8cea\uff08QoS\uff09\uff0c\u800c\u4e1f\u68c4 ICMP \u5c01\u5305; \u6216\u662f\u5c01\u5305\u8fd4\u56de\u8def\u7531\u7570\u5e38</li> </ul> </li> <li>\u53c3\u8003\u9023\u7d50: Diagnosing Network Issues with MTR</li> </ul> </li> </ul> </li> </ul>"},{"location":"networking/networking/#tcpdumpwireshark","title":"tcpdump/wireshark","text":""},{"location":"networking/networking/#tcpdump","title":"tcpdump","text":"<ul> <li>\u8aaa\u660e: <code>tcpdump</code> \u662f\u4e00\u500b\u7db2\u8def\u5c01\u5305\u5206\u6790\u5de5\u5177\uff0c\u53ef\u4ee5\u5728 CLI \u4ecb\u9762\u4e0a\u6355\u7372\u4e26\u5206\u6790\u7db2\u8def\u4e0a\u7684\u5c01\u5305\uff0c\u5e38\u7528\u65bc\u7db2\u8def\u7ba1\u7406\u3001\u904e\u6ffe\u6d41\u91cf\u3001\u5b89\u5168\u76e3\u63a7\u3001\u6545\u969c\u6392\u9664\u3002<code>wireshark</code> \u662f <code>tcpdump</code> \u7684 GUI \u7248\u672c\uff0c\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u529f\u80fd\u3001\u66f4\u76f4\u89c0\u7684\u64cd\u4f5c\u4ecb\u9762</li> <li> <p>\u57fa\u672c\u7528\u6cd5</p> <ul> <li> <p>\u67e5\u770b\u7db2\u8def\u4ecb\u9762\u4e0a\u7684\u5c01\u5305     Bash<pre><code># \u67e5\u770b\u6240\u6709\u7db2\u8def\u4ecb\u9762\u4e0a\u7684\u5c01\u5305\nsudo tcpdump -i any\n</code></pre></p> Bash<pre><code># \u67e5\u770b eth0 \u7db2\u8def\u4ecb\u9762\u4e0a\u7684\u5c01\u5305\nsudo tcpdump -i eth0\n</code></pre> </li> <li> <p>\u67e5\u770b HTTPS \u5354\u5b9a\u7684\u5c01\u5305: \u6355\u7372\u6240\u6709\u95dc\u65bc port 443 \u7684\u5c01\u5305     Bash<pre><code>sudo tcpdump -nnSX port 443\n</code></pre></p> <ul> <li><code>nn</code>: \u76f4\u63a5\u986f\u793a port \u865f\uff0c\u800c\u4e0d\u662f\u5c07 port \u865f\u89e3\u6790\u70ba\u670d\u52d9\u540d\u7a31</li> <li><code>-S</code>: \u986f\u793a\u6bcf\u500b TCP \u5c01\u5305\u7684\u7d55\u5c0d\u5e8f\u5217\u865f</li> <li> <p><code>-X</code>: \u4ee5\u5341\u516d\u9032\u4f4d\u548c ASCII \u78bc\u7684\u5f62\u5f0f\u986f\u793a\u5c01\u5305\u5167\u5bb9</p> <ul> <li>\u67e5\u770b tcpdump \u539f\u59cb\u5b8c\u6574\u7684\u8f38\u51fa\u5167\u5bb9 Bash<pre><code>sudo tcpdump -ttnnvvS\n</code></pre></li> </ul> </li> <li> <p><code>tt</code>: \u986f\u793a\u539f\u59cb\u7684\u6642\u9593\u6233\u8a18</p> </li> <li><code>nn</code>: \u76f4\u63a5\u986f\u793a port \u865f\uff0c\u800c\u4e0d\u662f\u5c07 port \u865f\u89e3\u6790\u70ba\u670d\u52d9\u540d\u7a31</li> <li><code>vv</code>: \u986f\u793a\u8a73\u7d30\u7684\u8f38\u51fa\u8cc7\u8a0a</li> <li><code>S</code>: \u986f\u793a\u6bcf\u500b TCP \u5c01\u5305\u7684\u7d55\u5c0d\u5e8f\u5217\u865f</li> </ul> </li> </ul> </li> <li> <p>\u5e38\u898b\u7528\u6cd5</p> <ul> <li> <p>\u64f7\u53d6\u660e\u78bc\u986f\u793a\u7684\u5bc6\u9470\u3001\u6587\u5b57\u3001\u4f7f\u7528\u8005\u540d\u7a31\u3001\u5bc6\u78bc\u7b49     Bash<pre><code>tcpdump -A -i eth0 &lt;port http || ftp || telnet&gt; | grep -i 'user\\|pass\\|login'\n</code></pre></p> </li> <li> <p>\u76e3\u63a7\u53ef\u7591\u57df\u540d\u7684\u6d41\u91cf     Bash<pre><code>tcpdump -i eth0 dst host &lt;suspicious.com&gt;\n</code></pre></p> </li> <li> <p>\u76e3\u63a7\u4f86\u81ea\u7279\u5b9a IP \u7bc4\u570d\u7684\u6d41\u91cf     Bash<pre><code>tcpdump src net &lt;IP_RANGE_OF_COUNTRY&gt;\n</code></pre></p> </li> <li> <p>\u76e3\u63a7\u4f86\u81ea SMB (Service Message Block) \u5354\u5b9a\u7684\u6d41\u91cf</p> <p>SMB \u6d41\u91cf\u53ef\u7528\u4f86\u4f5c\u70ba\u6a94\u6848\u5171\u4eab\u3001\u5370\u8868\u6a5f\u5171\u4eab \u7b49\uff0c\u56e0\u6b64\u9700\u8981\u9810\u9632\u6f5b\u5728\u7684\u5b89\u5168\u554f\u984c\uff0c\u4f8b\u5982: WannyCry \u52d2\u7d22\u75c5\u6bd2</p> Bash<pre><code>tcpdump -nn -i eth0 port 445\n</code></pre> </li> <li> <p>\u76e3\u63a7\u540c\u6642\u5177\u6709 RESET, ACK \u6a19\u8a8c\u7684\u5c01\u5305\uff0c\u6709\u52a9\u65bc\u8b58\u5225\u53ef\u80fd\u7684\u7db2\u8def\u653b\u64ca or \u8a2d\u5b9a\u554f\u984c     Bash<pre><code>tcpdump 'tcp[13] = 41'\n</code></pre></p> <ul> <li><code>tcp[13]</code>: \u8868\u793a TCP \u6a19\u982d\u7684\u7b2c 13 \u500b\u5b57\u7bc0\uff0c\u5176\u4e2d\u5305\u542b TCP \u6a19\u8a8c</li> <li><code>41</code>: \u5341\u516d\u9032\u5236\u6578\u5b57 0x29\uff0c\u8868\u793a\u540c\u6642\u8a2d\u7f6e\u4e86 RESET\uff080x04\uff09, ACK\uff080x10\uff09\u6a19\u8a8c</li> <li>\u7be9\u9078\u6d41\u91cf<ul> <li>\u6839\u64da host, net, port, protocol, src\uff08\u4f86\u6e90\uff09, dst\uff08\u76ee\u6a19\uff09\u4f86\u7be9\u9078\u6d41\u91cf</li> </ul> </li> <li> <p>\u76e3\u63a7\u4f86\u81ea\u6216\u767c\u9001\u5230\u6307\u5b9a\u4e3b\u6a5f\u7684\u6d41\u91cf     Bash<pre><code># host\ntcpdump host 192.168.1.1\n</code></pre></p> </li> <li> <p>\u76e3\u63a7\u4f86\u81ea\u6216\u767c\u9001\u5230\u6307\u5b9a\u7db2\u6bb5\u7684\u6d41\u91cf     Bash<pre><code># net\ntcpdump net 192.168.1.0/24\n</code></pre></p> </li> <li> <p>\u76e3\u63a7\u4f86\u81ea\u6216\u767c\u9001\u5230\u6307\u5b9a port \u7684\u6d41\u91cf\uff0c\u6216\u662f\u4e5f\u53ef\u4ee5\u76e3\u63a7\u6307\u5b9a port \u7bc4\u570d\u7684\u6d41\u91cf     Bash<pre><code># port\ntcpdump port 80\n</code></pre></p> Bash<pre><code># port range\ntcpdump portrange 21-23\n</code></pre> </li> <li> <p>\u76e3\u63a7\u6307\u5b9a\u7684\u5354\u5b9a\u7684\u6d41\u91cf     Bash<pre><code># protocol\ntcpdump tcp\n</code></pre></p> </li> <li> <p>\u76e3\u63a7\u4f86\u81ea\u6307\u5b9a\u4f86\u6e90\u7684\u6d41\u91cf     Bash<pre><code># src\ntcpdump 1.1.1.1\n</code></pre></p> </li> <li> <p>\u76e3\u63a7\u767c\u9001\u5230\u6307\u5b9a\u76ee\u6a19\u7684\u6d41\u91cf     Bash<pre><code># dst\ntcpdump dst 1.0.0.1\n</code></pre></p> </li> </ul> </li> </ul> </li> <li> <p>\u5c07\u6355\u7372\u7684\u5c01\u5305\u5167\u5bb9\uff0c\u5132\u5b58\u70ba PCAP \u6a94\u6848\uff0c\u4f9b\u5176\u4ed6\u61c9\u7528\u7a0b\u5f0f\u9032\u884c\u5206\u6790\uff0c\u4f8b\u5982: \u7db2\u8def\u5206\u6790\u5668\u3001\u5165\u4fb5\u6aa2\u6e2c\u7cfb\u7d71</p> <ul> <li> <p>\u5132\u5b58 PCAP \u6a94\u6848     Bash<pre><code>tcpdump port 80 -w &lt;capture_file.txt&gt;\n</code></pre></p> </li> <li> <p>\u8b80\u53d6 PCAP \u6a94\u6848     Bash<pre><code>tcpdump -r &lt;capture_file.txt&gt;\n</code></pre></p> </li> </ul> </li> <li> <p><code>tcpdump</code> \u5de5\u5177\uff0c\u53ef\u4f7f\u7528\u904b\u7b97\u5b50\u4f86\u66f4\u7cbe\u78ba\u5730\u7be9\u9078\u6d41\u91cf\uff0c\u4f8b\u5982: <code>and</code>, <code>or</code>, <code>not</code></p> <ul> <li> <p><code>and</code>: \u540c\u6642\u7b26\u5408\u5169\u500b\u689d\u4ef6     Bash<pre><code>tcpdump src 192.168.1.1 and dst port 80\n</code></pre></p> </li> <li> <p><code>or</code>: \u7b26\u5408\u5176\u4e2d\u4e00\u500b\u689d\u4ef6     Bash<pre><code>tcpdump src 192.168.1.1 or dst port 443\n</code></pre></p> </li> <li> <p><code>not</code>: \u4e0d\u7b26\u5408\u689d\u4ef6     Bash<pre><code>tcpdump not port 22\n</code></pre></p> </li> </ul> </li> <li> <p>\u9700\u4f7f\u7528\u55ae\u5f15\u865f (<code>' '</code>) \u4f86\u8b93 <code>tcpdump</code> \u5de5\u5177\u80fd\u8df3\u812b\u89e3\u6790\u67d0\u4e9b\u7279\u6b8a\u5b57\u5143\uff08e.g. \u62ec\u865f <code>( )</code>\uff09     Bash<pre><code># \u6355\u7372\u4f86\u81ea IP address \u70ba 10.0.2.4 \u4e26\u4e14\u76ee\u6a19 port \u662f 3389 \u6216 22 \u7684\u5c01\u5305\ntcpdump 'src 10.0.2.4 and (dst port 3389 or 22)'\n</code></pre></p> </li> <li> <p>\u53ef\u4f7f\u7528 <code>grep</code> \u6307\u4ee4\uff0c\u4f86\u9032\u4e00\u6b65\u904e\u6ffe <code>tcpdump</code> \u5de5\u5177\u6240\u6355\u7372\u7684\u5c01\u5305</p> <ul> <li> <p>\u7be9\u9078\u51fa\u6240\u6709\u95dc\u65bc HTTP GET \u8acb\u6c42\u7684\u5c01\u5305     Bash<pre><code>tcpdump -vvAls0 | grep 'GET'\n</code></pre></p> </li> <li> <p>\u7be9\u9078\u51fa\u6240\u6709\u95dc\u65bc HTTP Set-Cookie, Host, Cookie \u7684\u5c01\u5305     Bash<pre><code>tcpdump -vvAls0 | grep 'Set-Cookie|Host:|Cookie:'\n</code></pre></p> </li> <li> <p>\u7be9\u9078\u51fa DNS \u6d41\u91cf\u7684\u5c01\u5305     Bash<pre><code>tcpdump -vvAs0 port 53\n</code></pre></p> </li> </ul> </li> <li> <p>\u6ce8\u610f! \u820a\u7248\u672c\u7684 <code>tcpdump</code> \u5de5\u5177\u6703\u5c07\u5c01\u5305\u622a\u65b7\u5230 68 \uff5e 96 bytes \u7684\u5927\u5c0f\uff0c\u56e0\u6b64\u53ef\u4f7f\u7528 <code>s</code> \u9078\u9805\uff0c\u4f86\u6355\u7372\u5b8c\u6574\u5927\u5c0f\u7684\u5c01\u5305     Bash<pre><code>tcpdump -i &lt;network interface&gt; -s 65535 -w &lt;file&gt;\n</code></pre></p> </li> <li> <p>\u6bd4\u8f03 <code>tcpdump</code>, Wireshark \u5de5\u5177</p> <ul> <li>\u6709\u6642\u5019 <code>tcpdump</code> \u66f4\u9069\u5408\u7528\u65bc\u9060\u7aef\u6355\u7372\u5c01\u5305\uff0c\u56e0\u70ba\u5b83\u53ef\u4ee5\u5728 CLI \u4ecb\u9762\u4e0a\u57f7\u884c\uff0c\u7279\u5225\u662f\u5728\u6c92\u6709 GUI \u4ecb\u9762\uff0c\u6216\u662f\u672a\u5b89\u88dd WireShark \u5de5\u5177\u7684\u60c5\u6cc1\u4e0b</li> </ul> </li> </ul>"},{"location":"networking/networking/#wireshark","title":"WireShark","text":"<ul> <li> <p>\u8aaa\u660e: <code>Wireshark</code> \u662f\u4e00\u500b\u7db2\u8def\u5c01\u5305\u5206\u6790\u5de5\u5177\uff0c\u63d0\u4f9b\u4e86 GUI \u4ecb\u9762\uff0c\u53ef\u4ee5\u6355\u7372\u4e26\u5206\u6790\u7db2\u8def\u4e0a\u7684\u5c01\u5305\uff0c\u4e26\u4e14\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u529f\u80fd\uff0c\u4f8b\u5982: \u986f\u793a\u5c01\u5305\u7684\u5167\u5bb9\u3001\u7d71\u8a08\u8cc7\u8a0a\u3001\u5c01\u5305\u904e\u6ffe\u3001\u5c01\u5305\u91cd\u7d44 \u7b49</p> </li> <li> <p>\u53c3\u8003\u9023\u7d50:</p> <ul> <li>A tcpdump Tutorial with Examples</li> <li>tcpdump: Capturing with \u201ctcpdump\u201d for viewing with Wireshark</li> <li>How to Use Wireshark to Capture, Filter and Inspect Packets?</li> </ul> </li> </ul>"},{"location":"networking/networking/#iperf","title":"iperf","text":"<ul> <li>\u8aaa\u660e: \u6e2c\u8a66\u7db2\u8def\u983b\u5bec\u7684\u5de5\u5177\uff0c\u53ef\u7528\u65bc\u6e2c\u8a66\u7db2\u8def\u7684\u541e\u5410\u91cf\u3001\u5ef6\u9072\u3001\u5c01\u5305\u4e1f\u5931\u7387</li> <li> <p>\u88dc\u5145\u89c0\u5ff5</p> <ul> <li>\u6700\u5927\u50b3\u8f38\u55ae\u5143 (Maximum Transmission Unit, MTU): \u662f\u6307\u5728\u7db2\u8def\u4e0a\u80fd\u5920\u50b3\u8f38\u7684\u6700\u5927\u5c01\u5305\u5927\u5c0f\uff0c\u901a\u5e38\u70ba 1500 bytes<ul> <li>\u7db2\u8def\u9023\u7dda\u7684 MTU \u8d8a\u5927\uff0c\u5247\u53ef\u4ee5\u5728\u55ae\u4e00\u500b\u5c01\u5305\u4e2d\u50b3\u8f38\u7684\u8cc7\u6599\u91cf\u5c31\u8d8a\u591a\u3002Ethernet frames \u7531\u5c01\u5305 (packet) \u6216\u662f\u5be6\u969b\u50b3\u9001\u7684\u8cc7\u6599\uff0c\u4ee5\u53ca\u5176\u4ed6\u7db2\u8def\u8cc7\u8a0a\u6240\u7d44\u6210</li> </ul> </li> <li>\u6296\u52d5 (Jitter): \u662f\u6307\u5728\u8cc7\u6599\u50b3\u8f38\u904e\u7a0b\u4e2d\uff0c\u9023\u7e8c\u5c01\u5305\u5206\u5225\u7684\u5230\u9054\u6642\u9593\u7684\u8b8a\u5316\u6216\u4e0d\u4e00\u81f4\u6027\u3002\u7c21\u55ae\u4f86\u8aaa\uff0c\u5c31\u662f\u5c01\u5305\u50b3\u9001\u5230\u76ee\u7684\u5730\u7684\u6642\u9593\u9593\u9694\u4e0d\u5747\u52fb<ul> <li>\u5728\u7db2\u969b\u7db2\u8def\u4e2d\uff0c\u5c01\u5305\u5728\u8def\u7531\u5668\u3001\u4ea4\u63db\u6a5f\u4e4b\u9593\u50b3\u8f38\u6642\uff0c\u53ef\u80fd\u6703\u7d93\u6b77\u4e0d\u540c\u7684\u8def\u5f91\u548c\u4e0d\u540c\u7684\u5ef6\u9072\u3002\u53ef\u80fd\u6703\u53d7\u5230\u7db2\u8def\u64c1\u585e\u3001\u8def\u7531\u8b8a\u66f4\u3001\u786c\u9ad4\u6027\u80fd\u4e0d\u540c\u7b49\u56e0\u7d20\u7684\u5f71\u97ff\uff0c\u5c0e\u81f4\u5c01\u5305\u7684\u5230\u9054\u6642\u9593\u4e0d\u4e00\u81f4</li> <li>\u6296\u52d5\u901a\u5e38\u4ee5\u6beb\u79d2\uff08ms\uff09\u70ba\u55ae\u4f4d\uff0c\u6296\u52d5\u8d8a\u5c0f\uff0c\u5247\u7db2\u8def\u7684\u7a69\u5b9a\u6027\u5c31\u8d8a\u597d</li> <li>\u5c0d\u65bc\u8b1b\u6c42\u5373\u6642\u6027\u7684\u61c9\u7528\u7a0b\u5f0f\u6703\u5f71\u97ff\u6bd4\u8f03\u5927\uff0c\u4f8b\u5982: \u8a9e\u97f3\u901a\u8a71\uff08VoIP\uff09\u3001\u8996\u8a0a\u6703\u8b70\u3001\u7dda\u4e0a\u904a\u6232</li> </ul> </li> </ul> </li> <li> <p>\u6e2c\u8a66 TCP \u9023\u7dda\u7684\u983b\u5bec</p> <ul> <li> <p>\u4f3a\u670d\u5668\u7aef</p> <ul> <li>\u555f\u52d5 server \u6a21\u5f0f     Bash<pre><code># iperf3 \u9810\u8a2d\u4f7f\u7528 port 5001\nsudo iperf3 -s\n</code></pre></li> </ul> </li> <li> <p>\u5ba2\u6236\u7aef</p> <ul> <li> <p>\u555f\u52d5 client \u6a21\u5f0f\uff0c\u4e26\u6307\u5b9a\u4f3a\u670d\u5668\u7aef\u7684 IP \u4f4d\u5740     Bash<pre><code># iperf3 \u9810\u8a2d\u4f7f\u7528 port 5001\niperf3 -c 172.31.30.41 --parallel 40 -i 1 -t 2\n</code></pre></p> <ul> <li><code>-c</code>: \u6307\u5b9a\u4f3a\u670d\u5668\u7aef\u7684 IP \u4f4d\u5740</li> <li><code>--parallel</code>: \u8a2d\u5b9a\u4f75\u767c\u9023\u7dda\u6578\uff0c\u5373\u540c\u6642\u9032\u884c 40 \u500b\u9023\u63a5\u4f86\u6e2c\u8a66\u983b\u5bec</li> <li><code>-i</code>: \u8a2d\u5b9a\u5831\u544a\u9593\u9694\u6642\u9593\u70ba 1 \u79d2\uff0c\u5373\u6bcf\u79d2\u8f38\u51fa\u4e00\u6b21\u6e2c\u8a66\u5831\u544a</li> <li><code>-t</code>: \u8a2d\u5b9a\u6e2c\u8a66\u6642\u9593\u70ba 2 \u79d2\uff0c\u5373\u6574\u500b\u6e2c\u8a66\u6703\u6301\u7e8c 2 \u79d2\u9418</li> </ul> <p></p> <ul> <li>\u5ba2\u6236\u7aef\u5df2\u9023\u63a5\u5230\u4f3a\u670d\u5668\u7aef\uff08172.31.30.41\uff09\u7684 TCP port 5001</li> <li>TCP window \u5927\u5c0f: 975 KB</li> <li>\u6bcf\u500b\u9023\u7dda\u90fd\u6703\u4f7f\u7528\u4e00\u500b\u552f\u4e00\u7684\u672c\u5730 port\uff08e.g. 49498\u300149506\uff09\uff0c\u4f86\u9023\u7dda\u5230\u4f3a\u670d\u5668\u7684 port 5001</li> <li>Interval: \u6e2c\u8a66\u7684\u6642\u9593\u9593\u9694\uff080.0-2.0 \u79d2\uff09</li> <li>Transfer: \u50b3\u8f38\u7684\u7e3d\u8cc7\u6599\u91cf\uff0822.8 GBytes\uff09</li> <li>Bandwidth: \u9054\u5230\u7684\u7e3d\u983b\u5bec\uff0897.6 Gbits/sec\uff09</li> <li>\u5206\u6790<ul> <li>\u9019\u500b iperf \u6e2c\u8a66\u5831\u544a\u986f\u793a\uff0c\u5728 2 \u79d2\u7684\u6e2c\u8a66\u671f\u9593\uff0c\u7e3d\u5171\u50b3\u8f38\u4e86 22.8 GBytes \u7684\u8cc7\u6599\uff0c\u9054\u5230\u7684\u7e3d\u983b\u5bec\u70ba 97.6 Gbits/sec\u3002\u6e2c\u8a66\u4f7f\u7528\u4e86 40 \u500b\u4f75\u767c\u9023\u63a5\uff0c\u6bcf\u500b\u9023\u7dda\u90fd\u6709\u5176\u552f\u4e00\u7684\u672c\u5730\u7aef port</li> <li>\u4ee3\u8868\u5728\u9ad8\u4f75\u767c\u7684\u60c5\u6cc1\u4e0b\uff0c\u6b64\u7db2\u8def\u80fd\u5920\u4fdd\u6301\u975e\u5e38\u9ad8\u7684\u983b\u5bec\uff0c\u9069\u5408\u9700\u8981\u5927\u898f\u6a21\u8cc7\u6599\u50b3\u8f38\u7684\u61c9\u7528</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u6e2c\u8a66 UDP \u9023\u7dda\u7684\u983b\u5bec</p> <ul> <li> <p>\u4f3a\u670d\u5668\u7aef</p> <ul> <li>\u555f\u52d5 server \u6a21\u5f0f     Bash<pre><code># iperf3 \u9810\u8a2d\u4f7f\u7528 port 5001\nsudo iperf3 -s\n</code></pre></li> </ul> </li> <li> <p>\u5ba2\u6236\u7aef</p> <ul> <li> <p>\u555f\u52d5 client \u6a21\u5f0f\uff0c\u4e26\u6307\u5b9a\u4f3a\u670d\u5668\u7aef\u7684 IP \u4f4d\u5740     Bash<pre><code># iperf3 \u9810\u8a2d\u4f7f\u7528 port 5001\niperf3 -c 172.31.1.152 -u -b 5g\n</code></pre></p> <ul> <li><code>-c</code>: \u6307\u5b9a\u4f3a\u670d\u5668\u7aef\u7684 IP \u4f4d\u5740</li> <li><code>-u</code>: \u4f7f\u7528 UDP \u5354\u5b9a\uff0c\u56e0\u70ba\u9810\u8a2d\u60c5\u6cc1\u4e0b iperf3 \u6703\u63a1\u7528 TCP \u5354\u5b9a</li> <li><code>-b</code>: \u8a2d\u5b9a\u6bcf\u79d2\u50b3\u9001\u7684\u901f\u5ea6\u70ba 5 Gbits/sec</li> </ul> <p></p> <ul> <li>IPG target: 2.35 us (kalman adjust): \u8a2d\u5b9a\u7684 UDP datagram \u7684\u9593\u9694\u6642\u9593\uff08Inter-Packet Gap\uff09\u76ee\u6a19\u70ba 2.35 \u5fae\u79d2\uff0c\u4f7f\u7528 Kalman \u6ffe\u6ce2\u5668\u8abf\u6574</li> <li>\u672c\u5730\u7aef IP \u4f4d\u5740\uff08172.31.20.27\uff09\u4f7f\u7528 port 39022\uff0c\u9023\u7dda\u5230\u4f3a\u670d\u5668\u7aef IP \u4f4d\u5740\uff08172.31.30.41\uff09\u7684 port 5001</li> <li>Interval: \u6e2c\u8a66\u6642\u9593\u7bc4\u570d\uff080.0-10.0 \u79d2\uff09</li> <li>Transfer: \u50b3\u8f38\u7684\u7e3d\u8cc7\u6599\u91cf\uff085.82 GBytes\uff09</li> <li>Bandwidth: \u9054\u5230\u7684\u7e3d\u983b\u5bec\uff085.00 Gbits/sec\uff09</li> <li>Jitter: \u6296\u52d5\uff080.003 \u6beb\u79d2\uff09</li> <li>Lost/Total Datagrams: \u4e1f\u5931\u7684 datagram \u6578\u91cf/\u7e3d datagram \u6578\u91cf\uff081911/4251700\uff09\uff0cdatagram \u907a\u5931\u7387\u70ba 0.045 %</li> <li>\u5206\u6790<ul> <li>\u9019\u4efd iperf3 \u5831\u544a\u986f\u793a\uff0c\u5728 10 \u79d2\u7684\u6e2c\u8a66\u671f\u9593\uff0c\u7e3d\u5171\u50b3\u8f38\u4e86 5.82 GB \u7684\u8cc7\u6599\uff0c\u9054\u5230\u7684\u7e3d\u983b\u5bec\u70ba 5.00 Gbits/sec\u3002\u6e2c\u8a66\u4e2d\u767c\u9001\u4e86 4251700 \u500b datagram\uff0c\u907a\u5931\u4e86 1911 \u500b\uff0cdatagram \u7684\u907a\u5931\u7387\u70ba 0.045 %\u3002\u6296\u52d5\uff08Jitter\uff09\u975e\u5e38\u5c0f\uff0c\u50c5\u70ba 0.003 \u6beb\u79d2</li> <li>\u4ee3\u8868\u6b64\u7db2\u8def\u6027\u80fd\u7a69\u5b9a\uff0c\u9019\u4e9b\u6578\u64da\u53ef\u4ee5\u7528\u4f86\u8a55\u4f30\u7db2\u8def\u5728\u9ad8\u983b\u5bec\u4e0b\u7684\u6027\u80fd\u3001\u7a69\u5b9a\u6027</li> </ul> </li> <li>\u5e38\u898b\u9078\u9805<ul> <li>\u901a\u7528\u53c3\u6578<ul> <li><code>-f</code> [k|m|K|M]: \u5831\u544a\u7d50\u679c\u986f\u793a\u7684\u55ae\u4f4d\uff0c\u4ee5Kbits, Mbits, KBytes, MBytes\uff0c\u4f8b\u5982: <code>iperf -c 192.168.1.3 -f K</code></li> <li><code>-i</code>: \u5831\u544a\u986f\u793a\u7684\u6642\u9593\u9593\u9694(\u4ee5\u79d2\u70ba\u55ae\u4f4d)\uff0c\u4f8b\u5982: <code>iperf -c 192.168.1.3 -i 2</code></li> <li><code>-l</code> [KM]: \u7de9\u885d\u5340\u5927\u5c0f\uff0c\u9810\u8a2d\u662f 8 KB,\u4f8b\u5982: <code>iperf -c 192.168.1.3 -l 16</code></li> <li><code>-m</code>: \u986f\u793aMTU\u6700\u5927\u503c</li> <li><code>-o</code>: \u5c07\u5831\u544a\u8207\u932f\u8aa4\u4fe1\u606f\u8f38\u51fa\u5230\u6a94\u6848\uff0c\u4f8b\u5982: <code>iperf -c 192.168.1.3 -o c:\\iperf-log.txt</code></li> <li><code>-p</code>: server \u7aef\u4f7f\u7528\u7684 port\uff0c\u6216 client \u7aef\u4f7f\u7528\u7684 port\uff0c\u5169\u7aef\u7684 port \u9700\u4e00\u81f4\uff0c\u4f8b\u5982:<code>iperf -s -p 9999</code></li> <li><code>-u</code>: \u4f7f\u7528 UDP \u5354\u5b9a</li> <li><code>-w</code>: \u6307\u5b9a TCP window \u5927\u5c0f\uff0c\u9810\u8a2d\u662f 8 KB</li> <li><code>-B</code>: \u7d81\u5b9a\u4e00\u500b\u4e3b\u6a5f IP \u4f4d\u5740\uff0c\u53ef\u4ee5\u662f\u4ecb\u9762 or \u5ee3\u64ad\u7684 IP \u4f4d\u5740\uff0c\u7576\u4e3b\u6a5f\u7aef\u540c\u6642\u6709\u5f88\u591a IP \u4f4d\u5740\u6642\u624d\u9700\u8981\u7d81\u5b9a</li> <li><code>-C</code>: \u76f8\u5bb9\u820a\u7248\u672c (\u5169\u7aef\u7248\u672c\u4e0d\u4e00\u81f4\u6642\u4f7f\u7528)</li> <li><code>-M</code>: \u8a2d\u5b9a TCP \u5c01\u5305\u7684\u6700\u5927 MTU \u503c</li> <li><code>-N</code>: \u8a2d\u5b9a TCP \u4e0d\u5ef6\u9072\uff0c\u7981\u7528 Nagle \u6f14\u7b97\u6cd5</li> <li><code>-V</code>: \u50b3\u8f38 IPv6 \u5c01\u5305</li> </ul> </li> <li>Server \u7aef\u5c08\u7528<ul> <li><code>-D</code>: \u80cc\u666f\u670d\u52d9\u65b9\u5f0f\u904b\u884c\uff0c\u4f8b\u5982: <code>iperf -s -D</code></li> <li><code>-U</code>: \u4f7f\u7528\u55ae\u4e00\u57f7\u884c\u7dd2\u4f7f\u7528 UDP \u6a21\u5f0f</li> </ul> </li> <li>Client \u7aef\u5c08\u7528<ul> <li><code>-b</code>: UDP \u6e2c\u8a66\u5c08\u7528\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u6bcf\u79d2\u50b3\u9001\u7684\u901f\u5ea6</li> <li><code>c</code>: \u6307\u5b9a server \u7aef\u7684 IP \u4f4d\u5740</li> <li><code>-d</code>: \u540c\u6642\u9032\u884c\u96d9\u5411\u50b3\u8f38\u6e2c\u8a66</li> <li><code>-n</code>: \u6307\u5b9a\u50b3\u8f38\u7684\u5927\u5c0f\uff0c\u4f8b\u5982: <code>iperf -c 192.168.1.3 -n 100000</code></li> <li><code>-r</code>: \u55ae\u7368\u9032\u884c\u96d9\u5411\u50b3\u8f38\u6e2c\u8a66</li> <li><code>F</code>: \u4f7f\u7528\u6307\u5b9a\u6a94\u6848\u4f86\u50b3\u8f38</li> <li><code>-I</code>: \u4f7f\u7528 stdin \u65b9\u5f0f\u7576\u505a\u50b3\u8f38\u5167\u5bb9</li> <li><code>-T</code>: \u6307\u5b9a TTL \u503c</li> </ul> </li> </ul> </li> <li>\u53c3\u8003\u9023\u7d50: How do I benchmark network throughput between Amazon EC2 Linux instances in the same Amazon VPC</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"networking/networking/#curl","title":"curl","text":"<ul> <li>\u8aaa\u660e: \u5168\u540d\u70ba Command Line URL\uff0c\u662f\u4e00\u500b\u7528\u65bc\u50b3\u8f38\u8cc7\u6599\u7684\u5de5\u5177\uff0c\u652f\u63f4\u591a\u7a2e\u5354\u5b9a\uff0c\u4f8b\u5982: HTTP, HTTPS, FTP, FTPS \u7b49</li> <li>\u529f\u80fd: <ul> <li>\u529f\u80fd\u5f37\u5927\uff0c\u4efb\u4f55\u7db2\u8def\u76f8\u95dc\u7684\u64cd\u4f5c\u90fd\u53ef\u4ee5\u900f\u904e curl \u9032\u884c</li> <li>\u53ea\u9700\u8981\u900f\u904e\u77ed\u77ed\u5e7e\u884c\u6307\u4ee4\u5c31\u53ef\u4ee5\u767c\u9001\u51fa request\uff0c\u56e0\u6b64\u5f88\u9069\u5408\u62ff\u4f86\u505a\u6e2c\u8a66\u4f7f\u7528</li> <li>\u652f\u63f4\u6a94\u6848\u7684\u4e0a\u50b3\u3001\u4e0b\u8f09</li> </ul> </li> <li> <p>\u57fa\u672c\u7528\u6cd5: \u7b2c\u4e00\u6b65\u662f\u4f7f\u7528\u4e0d\u5e36\u53c3\u6578\u7684 curl \u6e2c\u8a66\u7db2\u7ad9\u7684\u72c0\u614b\uff0c\u4ee5\u9a57\u8b49\u5b58\u53d6\u662f\u5426\u6b63\u78ba     Bash<pre><code>curl &lt;https://example.com&gt;\n</code></pre></p> </li> <li> <p>\u5e38\u7528\u9078\u9805</p> <ul> <li> <p><code>A</code>: \u6307\u5b9a User-Agent\u3002\u57fa\u65bc\u7db2\u8def\u5b89\u5168\u4e0d\u65b7\u53d7\u5230\u91cd\u8996\uff0c\u6703\u9047\u5230\u67d0\u4e9b\u7db2\u9801\u4e0d\u652f\u63f4 curl \u5de5\u5177\u505a\u9023\u7dda\uff0c\u9700\u8981\u4fee\u6539 User-Agent \u4f86\u5ba3\u544a\u6539\u8b8a\u700f\u89bd\u5668\uff0c     Bash<pre><code>curl -v -A \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36\" https://google.com/\n</code></pre></p> </li> <li> <p><code>c</code>: \u5132\u5b58 cookie\u3002\u7db2\u7ad9\u90fd\u6703\u4f7f\u7528 cookie \u4f86\u505a\u767b\u5165\u4e0a\u7684\u8a8d\u8b49\uff0c\u6216\u662f\u5b58\u53d6\u7db2\u7ad9\u6642\u7528\u4f86\u8fa8\u8a8d\u662f\u5426\u70ba\u6b63\u5e38\u7684\u4f7f\u7528\u8005     Bash<pre><code># \u5c07\u8acb\u6c42\u6642\u7522\u751f\u7684 cookie \u8cc7\u8a0a\u5132\u5b58\u81f3 cookie_file\ncurl -c cookie_file https://www.google.com/\n</code></pre></p> </li> <li> <p><code>b</code>: \u8b80\u53d6 cookie     Bash<pre><code># \u767c\u51fa\u8acb\u6c42\u6642\u5c07 cookie_file \u4e2d\u7684\u8cc7\u8a0a\u5e36\u5165\u81f3\u8acb\u6c42\u4e2d\ncurl -b cookie_file https://www.google.com/\n</code></pre></p> </li> <li> <p><code>e</code>: \u5e36\u5165\u4f86\u6e90\u7db2\u5740\uff08referrer\uff09\u3002\u9019\u500b\u53c3\u6578\u53ef\u4ee5\u5e6b\u52a9\u6a21\u64ec\u4f86\u81ea\u7279\u5b9a\u4f86\u6e90\u7db2\u9801\u7684\u8a2a\u554f\uff0c\u4ee5\u4fbf\u4f3a\u670d\u5668\u53ef\u4ee5\u8b58\u5225\u51fa\u8acb\u6c42\u7684\u4f86\u6e90     Bash<pre><code># \u8a2d\u5b9a\u8acb\u6c42\u4f86\u6e90\u7db2\u5740\u70ba facebook\ncurl -v -e \"https://www.facebook.com\" https://google.com/\n</code></pre></p> </li> <li> <p><code>O</code>\uff08\u5927\u5beb\uff09: \u4e0b\u8f09\u6a94\u6848\uff0c\u4e26\u4f7f\u7528\u539f\u59cb\u6a94\u6848\u540d\u7a31</p> </li> <li> <p><code>o</code>\uff08\u5c0f\u5beb\uff09: \u4e0b\u8f09\u6a94\u6848\u4e26\u91cd\u65b0\u547d\u540d     Bash<pre><code># \u4e0b\u8f09\u6a94\u6848\u4e26\u91cd\u65b0\u547d\u540d\u70ba city_bridge\ncurl -o city_bridge https://cdn.stocksnap.io/img-thumbs/960w/city-bridge_KSM9UIBTQ9.jpg\n</code></pre></p> </li> <li> <p><code>C</code>: \u6a94\u6848\u4e0b\u8f09\u5230\u4e2d\u65b7\u6642\uff0c\u4e0d\u7528\u6574\u500b\u6a94\u6848\u91cd\u65b0\u4e0b\u8f09\uff0c\u53ef\u4f7f\u7528 <code>-C</code> \u9078\u9805\u4f86\u91cd\u65b0\u7e8c\u50b3\u4e0b\u8f09     Bash<pre><code>curl -C -O https://cdn.stocksnap.io/img-thumbs/960w/city-bridge_KSM9UIBTQ9.jpg\n</code></pre></p> </li> <li> <p><code>--limit-rate</code>: \u9650\u5236\u50b3\u8f38\u901f\u5ea6\u3002\u6709\u6642\u5019\u6b32\u6e2c\u8a66\u4e0b\u8f09\u662f\u5426\u6b63\u5e38\uff0c\u53c8\u4e0d\u60f3\u4f54\u6eff\u7db2\u8def\u983b\u5bec\uff0c\u9700\u9650\u5236 <code>curl</code> \u5de5\u5177\u7684\u8cc7\u6599\u50b3\u8f38\u901f\u5ea6\uff0c\u4f7f\u7528 <code>\u2013limit-rate</code> \u53c3\u6578\u4f86\u6307\u5b9a\u50b3\u8f38\u901f\u5ea6\u7684\u4e0a\u9650     Bash<pre><code>curl --limit-rate 100k -O https://cdn.stocksnap.io/img-thumbs/960w/city-bridge_KSM9UIBTQ9.jpg\n</code></pre></p> </li> <li> <p><code>L</code>: \u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c<code>curl</code> \u5de5\u5177\u4e0d\u6703\u96a8\u8457 HTTP 301 \u6216 302 \u91cd\u65b0\u5c0e\u5411\u5230\u65b0\u7684\u7db2\u5740\uff0c\u53ef\u4f7f\u7528 <code>-L</code> \u9078\u9805\u4f86\u5f37\u5236\u91cd\u65b0\u5c0e\u5411     Bash<pre><code>curl -L https://www.google.com/\n</code></pre></p> </li> <li> <p><code>I</code>: \u53ea\u986f\u793a HTTP \u982d\u90e8\u8cc7\u8a0a\uff0c\u4e0d\u986f\u793a\u5167\u5bb9     Bash<pre><code>curl -I https://www.google.com/\n</code></pre></p> </li> <li> <p><code>V</code>\uff08\u5927\u5beb\uff09: \u6aa2\u67e5\u7576\u524d\u7684 <code>curl</code> \u5de5\u5177\u7248\u672c\u865f\u3002\u5076\u723e\u5728\u6bd4\u8f03\u820a\u7684\u7248\u672c\u4e2d\u6703\u6709\u4e9b bug \u6216\u662f\u4e0d\u652f\u63f4\uff0c\u4e0d\u8981\u5fd8\u4e86\u6aa2\u67e5 <code>curl</code> \u7248\u672c\u865f     Bash<pre><code>curl -V\n</code></pre></p> </li> <li> <p><code>v</code>\uff08\u5c0f\u5beb\uff09: \u8f38\u51fa\u5b8c\u6574\u8a0a\u606f\u3002\u4e3b\u8981\u662f\u7528\u4f86\u9664\u932f or \u5b8c\u6574\u986f\u793a\u6574\u500b\u9023\u7dda\u904e\u7a0b\u7684\u5167\u5bb9\uff0c\u6703\u5305\u542b SSL \u63e1\u624b\u8cc7\u8a0a, request \u88e1\u6240\u651c\u5e36\u7684 header     Bash<pre><code>curl -v https://google.com/\n</code></pre></p> </li> <li> <p><code>X</code>\uff08= <code>--request</code>\uff09: \u6307\u5b9a HTTP \u65b9\u6cd5     Bash<pre><code># \u4f7f\u7528 GET \u65b9\u6cd5\u767c\u9001\u8acb\u6c42\ncurl https://reqres.in/api/users/1\n</code></pre></p> Bash<pre><code># \u4f7f\u7528 PATCH \u65b9\u6cd5\uff0c\u90e8\u5206\u66f4\u65b0\u8cc7\u6599\ncurl -X PATCH https://reqres.in/api/users/1 -d \"name=mia&amp;job=leader\"\n</code></pre> Bash<pre><code># \u4f7f\u7528 DELETE \u65b9\u6cd5\uff0c\u522a\u9664\u8cc7\u6599\ncurl -X DELETE -I https://reqres.in/api/users/1\n</code></pre> </li> <li> <p><code>d</code>\uff08= <code>--data</code>\uff09: \u6307\u5b9a POST \u8acb\u6c42\u7684\u8cc7\u6599     Bash<pre><code># \u4f7f\u7528 POST \u65b9\u6cd5\u767c\u9001\u8acb\u6c42\uff0c\u4e26\u63d0\u4f9b request body \u7684\u8cc7\u6599\ncurl https://reqres.in/api/users/ -d \"name=mia&amp;job=leader\"\n</code></pre></p> </li> <li> <p><code>H</code>: \u6307\u5b9a request header     Bash<pre><code>curl https://reqres.in/api/users/ -d '{\"name\"]\" : \"mia\", \"job\": \"leader\"}' -H \"Content-Type: application/json\"\n</code></pre></p> </li> </ul> </li> <li> <p>\u53c3\u8003\u9023\u7d50:</p> <ul> <li>Linux Curl \u8d85\u8a73\u7d30\u6559\u5b78(\u5e38\u7528\u7bc7)</li> <li>Linux curl -v \u5feb\u901f\u5224\u5225\u7121\u6cd5\u8a2a\u554f\u670d\u52d9\u554f\u984c\u9ede\u5728\u54ea\u88e1?</li> </ul> </li> </ul>"},{"location":"networking/networking/#_1","title":"\u5176\u4ed6\u5b78\u7fd2\u8cc7\u6e90","text":"<ul> <li> <p>O'Reilly: High Performance Browser Networking</p> <ul> <li> <p>Chapter 1. Primer on Latency and Bandwidth</p> <ul> <li> <p>\u5ef6\u9072\u624d\u662f\u6548\u80fd\u74f6\u9838; \u800c\u4e0d\u662f\u7db2\u8def\u983b\u5bec         </p> </li> <li> <p>\u8003\u616e\u5230\u6211\u5011\u76ee\u524d\u7684\u901f\u5ea6\u5df2\u7d93\u5728\u5149\u901f\u7684 \u2154 \u4ee5\u5167\uff0c\u6211\u5011\u5c0d\u9019\u9805\u7b56\u7565\u7684\u6700\u5927\u671f\u671b\u53ea\u662f 30% \u7684\u9069\u5ea6\u6539\u5584\uff0c\u5df2\u7d93\u9054\u5230\u7269\u7406\u5b9a\u5f8b\u7684\u6975\u9650\u4e86\u3002\u7531\u65bc\u6211\u5011\u7121\u6cd5\u4f7f\u5149\u50b3\u64ad\u5f97\u66f4\u5feb\uff0c\u6211\u5011\u53ef\u4ee5\u7e2e\u77ed\u8ddd\u96e2\u2014\u2014\u5730\u7403\u4e0a\u4efb\u610f\u5169\u9ede\u4e4b\u9593\u7684\u6700\u77ed\u8ddd\u96e2\u7531\u5b83\u5011\u4e4b\u9593\u7684\u5927\u5713\u8def\u5f91\u5b9a\u7fa9\u3002\u56e0\u6b64\uff0c\u70ba\u4e86\u63d0\u9ad8\u61c9\u7528\u7a0b\u5f0f\u7684\u6548\u80fd\uff0c\u5177\u9ad4\u505a\u6cd5\u6703\u662f</p> <ul> <li>\u512a\u5316\u6211\u5011\u7684\u5354\u5b9a\uff08TLS, TCP \u5354\u5b9a\uff09, \u7db2\u8def\u7a0b\u5f0f\u78bc</li> <li>\u6e1b\u5c11\u5f80\u8fd4\uff08RTT\uff09</li> <li>\u5c07\u8cc7\u6599\u79fb\u52d5\u5230\u66f4\u63a5\u8fd1\u5ba2\u6236\u7aef\u7684\u4f4d\u7f6e\uff0c\u4e26\u5efa\u7acb\u61c9\u7528\u7a0b\u5f0f\u53ef\u4ee5\u900f\u904e\u5feb\u53d6\u3001\u9810\u53d6\u3001\u5404\u7a2e\u985e\u4f3c\u6280\u8853\u4f86\u96b1\u85cf\u5ef6\u9072</li> <li>Chapter 4. Transport Layer Security (TLS)</li> </ul> </li> <li>\u555f\u7528 TLS false start: \u5141\u8a31\u7576 TLS \u63e1\u624b\u50c5\u90e8\u5206\u5b8c\u6210\uff0c\u5c31\u80fd\u958b\u59cb\u767c\u9001\u61c9\u7528\u7a0b\u5f0f\u7684\u8cc7\u6599<ul> <li>\u65b0\u7684 TLS \u9023\u7dda\u9700\u8981 2 \u6b21 RTT \u624d\u80fd\u5be6\u73fe\u5b8c\u5168\u63e1\u624b</li> <li>TLS false start \u4e0d\u6703\u4fee\u6539 TLS \u63e1\u624b\u5354\u8b70\uff0c\u800c\u53ea\u6703\u5f71\u97ff\u50b3\u9001\u61c9\u7528\u7a0b\u5f0f\u8cc7\u6599\u7684\u5354\u8b70\u6642\u9593\u3002\u76f4\u89c0\u5730\u8aaa\uff0c\u4e00\u65e6\u5ba2\u6236\u7aef\u767c\u9001\u4e86 tlsClientKeyExchange \u8a18\u9304\uff0c\u5b83\u5c31\u5df2\u7d93\u77e5\u9053\u52a0\u5bc6\u91d1\u9470\u4e26\u53ef\u4ee5\u958b\u59cb\u50b3\u8f38\u61c9\u7528\u7a0b\u5f0f\u8cc7\u6599\uff0cTLS \u63e1\u624b\u7684\u5176\u9918\u90e8\u5206\u7528\u65bc\u78ba\u8a8d\u6c92\u6709\u4eba\u7be1\u6539\u63e1\u624b\u8a18\u9304\uff0c\u4e26\u4e14\u53ef\u4ee5\u4f75\u884c\u5b8c\u6210\u3002\u56e0\u6b64\uff0cTLS false start \u8b93\u6211\u5011\u53ef\u4ee5\u5728\u4e00\u6b21\u5f80\u8fd4\u4e2d\u4fdd\u6301 TLS \u63e1\u624b\uff0c\u7121\u8ad6\u6211\u5011\u662f\u57f7\u884c\u5b8c\u6574\u63e1\u624b or \u7c21\u77ed\u63e1\u624b </li> </ul> </li> </ul> </li> <li> <p>Chapter 10. Primer on Web Performance</p> <ul> <li> <p>\u700f\u89bd\u5668\u6e32\u67d3\u7db2\u9801\u7684\u6d41\u7a0b     </p> <ul> <li>Web \u61c9\u7528\u7a0b\u5f0f\u7684\u6548\u80fd\uff0c\u5c24\u5176\u662f\u9996\u6b21\u8f09\u5165\u7684\u6e32\u67d3\u6642\u9593\uff0c\u76f4\u63a5\u53d6\u6c7a\u65bc\u5982\u4f55\u89e3\u6790 HTML DOM\u3001CSS \u6a23\u5f0f\u8868\u3001 JavaScript \u4e4b\u9593\u7684\u4f9d\u8cf4\u95dc\u4fc2\u5716</li> <li> <p>\u6240\u4ee5\u624d\u6703\u6709 CSS \u6a23\u5f0f\u5beb\u5728 HTML \u9802\u90e8\uff0cJavascript \u8173\u672c\u5beb\u5728 HTML \u5e95\u90e8 \u7684\u540d\u8a00         - \u904b\u7528 WebPagesTest \u5de5\u5177\uff0c\u4f86\u6e2c\u8a66\u7db2\u9801\u7684\u6548\u80fd\uff0c\u6839\u64da\u7522\u751f\u7684\u8cc7\u6e90\u7011\u5e03\u5716\u8868\uff08resource waterfall\uff09\uff0c\u4f86\u5206\u6790\u7db2\u9801\u7684\u8f09\u5165\u6642\u9593 </p> </li> <li> <p>\u958b\u59cb\u6e32\u67d3\uff08Time to First Byte\uff09: \u767c\u751f\u5728\u6240\u6709\u8cc7\u6e90\u5b8c\u5168\u8f09\u5165\u4ee5\u524d\uff0c\u5141\u8a31\u4f7f\u7528\u8005\u5728\u5efa\u7acb\u9801\u9762\u6642\uff0c\u5c31\u80fd\u958b\u59cb\u8207\u9801\u9762\u4e92\u52d5</p> </li> <li>\u6587\u6a94\u5b8c\u6210 \u4e8b\u4ef6\uff08Content Download\uff09: \u4e5f\u6703\u5728\u5269\u9918\u8cc7\u6e90\u8f09\u5165\u4e4b\u524d\u63d0\u524d\u89f8\u767c<ul> <li>\u63db\u53e5\u8a71\u8aaa\uff0c\u96d6\u7136\u700f\u89bd\u5668\u5df2\u505c\u6b62\u8f49\u52d5\uff0c\u4f7f\u7528\u8005\u53ef\u4ee5\u7e7c\u7e8c\u57f7\u884c\u5176\u4efb\u52d9\uff0c\u4f46 Yahoo! \u4e3b\u9801\u6b63\u5728\u5f8c\u53f0\u9010\u6b65\u586b\u5145\u9644\u52a0\u5167\u5bb9\uff0c\u4f8b\u5982: \u5ee3\u544a\u3001\u793e\u4ea4\u5c0f\u5de5\u5177</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Chapter 13. Optimizing Application Delivery </p> <ul> <li> <p>\u6839\u64da\u4e0a\u5716\uff0c\u6b32\u512a\u5316\u7db2\u9801\u6548\u80fd\uff0c\u53ef\u4ee5\u5206\u6210\u4ee5\u4e0b\u4e09\u500b\u5c64\u7d1a\u7684\u9762\u5411</p> <ul> <li>\u512a\u5316\u61c9\u7528\u7a0b\u5f0f\u5c64\uff08Application Layer\uff09<ul> <li>\u89e3\u6c7a HTTP/1.x \u7684\u9650\u5236\uff0c\u4e26\u5229\u7528 HTTP/2 \u7684\u65b0\u529f\u80fd\u310d</li> <li>\u843d\u5be6 evergreen performance \u7684\u6700\u4f73\u5be6\u8e10<ul> <li>\u57fa\u790e\u539f\u5247<ul> <li>\u6e1b\u5c11 DNS \u67e5\u8a62: \u6bcf\u4e00\u500b\u4e3b\u6a5f\u540d\u89e3\u6790\u9700\u8981\u7db2\u8def\u5f80\u8fd4\uff0c\u53ef\u80fd\u6703\u9020\u6210\u5ef6\u9072</li> <li>\u91cd\u8907\u4f7f\u7528 TCP \u9023\u63a5: \u76e1\u53ef\u80fd\u5229\u7528 keep-alive \u9023\u7dda\uff0c\u4f86\u6d88\u9664 TCP \u63e1\u624b\u3001\u6162\u555f\u52d5\u6240\u9020\u6210\u7684\u7db2\u8def\u5ef6\u9072\u6642\u9593</li> <li>\u6700\u5c0f\u5316 HTTP \u91cd\u5b9a\u5411\u6b21\u6578: HTTP \u91cd\u65b0\u5c0e\u5411\u6703\u9020\u6210\u9ad8\u5ef6\u9072</li> <li>\u6e1b\u5c11\u5f80\u8fd4\u6642\u9593: \u5c07\u4f3a\u670d\u5668\u5b9a\u4f4d\u5728\u66f4\u9760\u8fd1\u4f7f\u7528\u8005\u7684\u4f4d\u7f6e</li> <li>\u522a\u9664\u4e0d\u5fc5\u8981\u7684\u8cc7\u6e90: \u6c92\u6709\u8acb\u6c42\u6bd4\u6c92\u6709\u63d0\u51fa\u8acb\u6c42\u66f4\u5feb\uff0c\u9069\u6642\u522a\u9664\u4e0d\u5fc5\u8981\u7684\u8cc7\u6e90</li> </ul> </li> <li>\u8cc7\u6e90\u512a\u5316<ul> <li>\u5728\u5ba2\u6236\u7aef\u5feb\u53d6\u8cc7\u6e90: \u61c9\u5feb\u53d6\u61c9\u7528\u7a0b\u5f0f\u8cc7\u6e90\uff0c\u4ee5\u907f\u514d\u6bcf\u6b21\u9700\u8981\u8cc7\u6e90\u6642\u91cd\u65b0\u8acb\u6c42\u76f8\u540c\u7684\u8cc7\u6599</li> <li>\u50b3\u8f38\u904e\u7a0b\u4e2d\u58d3\u7e2e\u8cc7\u6599: \u61c9\u5c0d\u6bcf\u500b\u9700\u50b3\u8f38\u7684\u8cc7\u6599\uff0c\u63a1\u7528\u6700\u4f73\u58d3\u7e2e\u65b9\u6cd5</li> <li>\u53bb\u9664\u4e0d\u5fc5\u8981\u7684\u8cc7\u6599\u8acb\u6c42: \u6e1b\u5c11\u50b3\u8f38\u7684 HTTP \u6a19\u982d\u8cc7\u6599\uff08\u4f8b\u5982: HTTP cookie\uff09\u53ef\u4ee5\u7bc0\u7701\u6574\u500b\u5f80\u8fd4\u7684\u7db2\u8def\u5ef6\u9072</li> <li>\u4f75\u884c\u5316\u8acb\u6c42\u3001\u56de\u61c9\u8655\u7406: \u5ba2\u6236\u7aef\u3001\u4f3a\u670d\u5668\u4e0a\u7684\u8acb\u6c42\u3001\u56de\u61c9\u6392\u968a\u5ef6\u9072\u901a\u5e38\u4e0d\u6703\u88ab\u6ce8\u610f\u5230\uff0c\u4f46\u537b\u6703\u9020\u6210\u986f\u8457\u4e14\u4e0d\u5fc5\u8981\u7684\u5ef6\u9072</li> <li>\u63a1\u7528 HTTP/2 \u5354\u5b9a: HTTP/2 \u5354\u5b9a\u652f\u63f4\u591a\u8def\u8acb\u6c42\u3001\u56de\u61c9\uff0c\u4e26\u4e14\u652f\u63f4\u4f3a\u670d\u5668\u63a8\u9001\u8cc7\u6e90</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>\u512a\u5316 TLS \u5354\u5b9a\uff08Presentation Layer\uff09:</p> <ul> <li>\u91cd\u8907\u4f7f\u7528 TCP + TLS \u9023\u7dda: \u8a2d\u5b9a TCP \u9023\u7dda\u70ba keep-alive\uff0c\u4ee5\u6e1b\u5c11 TLS \u63e1\u624b\u7684\u6b21\u6578</li> <li> <p>\u4f7f\u7528 edge proxy server \u4f5c\u70ba CDN \u670d\u52d9: \u904b\u7528 CDN \u8b93\u908a\u7de3\u4f3a\u670d\u5668\u80fd\u66f4\u9760\u8fd1\u4f7f\u7528\u8005\uff0c\u4ee5\u5927\u5e45\u6e1b\u5c11\u5f80\u8fd4\u6642\u9593\uff08RTT\uff09\uff0c\u4ee5\u53ca TCP, TLS \u63e1\u624b\u7684\u7e3d\u6210\u672c     </p> </li> <li> <p>\u555f\u7528\u6703\u8a71\u6062\u5fa9\uff08Session Resumption\uff09: TLS \u6703\u8a71\u6062\u5fa9\u5141\u8a31\u5ba2\u6236\u7aef\u3001\u4f3a\u670d\u5668\u7aef\u4e4b\u9593\u7684 TLS \u9023\u63a5\u5728\u591a\u6b21\u9023\u63a5\u4e4b\u9593\u5171\u4eab\u76f8\u540c\u7684 session \u5bc6\u9470\u8cc7\u8a0a\uff0c\u53ef\u4ee5\u5728\u91cd\u65b0\u9023\u7dda\u6642\u8df3\u904e\u5b8c\u6574\u7684\u63e1\u624b\u904e\u7a0b\uff0c\u4ee5\u52a0\u5feb\u9023\u7dda\u901f\u5ea6</p> </li> <li>\u555f\u7528 TLS false start: \u5141\u8a31\u7576 TLS \u63e1\u624b\u6d41\u7a0b\u50c5\u90e8\u5206\u5b8c\u6210\u6642\uff0c\u5c31\u80fd\u958b\u59cb\u767c\u9001\u61c9\u7528\u7a0b\u5f0f\u7684\u8cc7\u6599             - \u512a\u5316 TCP \u5354\u5b9a\uff08Transport Layer\uff09: \u512a\u5316 TCP \u5354\u5b9a\u7684\u6700\u4f73\u65b9\u6cd5\u662f\u8abf\u6574 TCP \u5982\u4f55\u611f\u77e5\u7576\u524d\u7db2\u8def\u72c0\u6cc1\uff0c\u4e26\u6839\u64da\u5176\u4e0a\u3001\u4e0b\u5c64\u7684\u985e\u578b, \u8981\u6c42\u8abf\u6574\u5176\u884c\u70ba\uff0c\u4f8b\u5982: \u7121\u7dda\u7db2\u8def\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u64c1\u585e\u6f14\u7b97\u6cd5\uff0c\u4e26\u4e14\u67d0\u4e9b\u61c9\u7528\u7a0b\u5f0f\u53ef\u80fd\u9700\u8981\u81ea\u8a02\u670d\u52d9\u54c1\u8cea(QoS) \u4ee5\u63d0\u4f9b\u6700\u4f73\u9ad4\u9a57\u3002\u70ba\u4e86\u8b93\u5404\u500b TCP \u9023\u7dda\u5be6\u73fe\u6700\u4f73\u6548\u80fd - \u66f4\u4f4e\u7684\u5ef6\u9072\u3001\u66f4\u9ad8\u7684\u541e\u5410\u91cf</li> </ul> <p>\u64c1\u585e\u8996\u7a97\uff08cwnd\uff09: cwnd \u7528\u4f86\u9032\u884c TCP \u64c1\u585e\u63a7\u5236\uff0c\u53ef\u6c7a\u5b9a\u5728\u672a\u63a5\u6536\u5230\u78ba\u8a8d\uff08ACK\uff09\u4e4b\u524d\uff0cTCP \u9023\u63a5\u80fd\u5920\u767c\u9001\u7684\u6700\u5927\u8cc7\u6599\u91cf\u3002\u900f\u904e\u52d5\u614b\u8abf\u6574 CWND \u7684\u5927\u5c0f\uff0cTCP \u5354\u5b9a\u80fd\u5920\u9069\u61c9\u7db2\u8def\u72c0\u6cc1\uff0c\u5728\u6700\u5927\u5316\u50b3\u8f38\u6548\u7387\u7684\u540c\u6642\uff0c\u76e1\u91cf\u907f\u514d\u7db2\u8def\u64c1\u585e\u7684\u767c\u751f</p> <p>\u63a5\u6536\u8996\u7a97\uff08rwnd\uff09: rwnd \u662f TCP \u7684\u63a5\u6536\u7a97\u53e3\u5927\u5c0f\uff0c\u5b83\u7531\u63a5\u6536\u7aef\u6c7a\u5b9a\uff0c\u7528\u4f86\u901a\u77e5\u767c\u9001\u7aef\uff0c\u7576\u524d\u63a5\u6536\u7aef\u80fd\u5920\u8655\u7406\u7684\u8cc7\u6599\u91cf\u3002rwnd \u7528\u4f86\u9032\u884c TCP \u6d41\u91cf\u63a7\u5236\uff0c\u78ba\u4fdd\u767c\u9001\u7aef\u4e0d\u6703\u50b3\u9001\u904e\u591a\u7684\u8cc7\u6599\u8d85\u51fa\u63a5\u6536\u7aef\u7684\u8655\u7406\u80fd\u529b\u3002rwnd \u7684\u503c\u6703\u96a8\u8457\u63a5\u6536\u7aef\u7de9\u885d\u5340\u7684\u8b8a\u5316\u800c\u8b8a\u5316\uff0c\u662f\u7531\u63a5\u6536\u7aef\u5728 TCP header \u4e2d\u900f\u904e <code>ACK</code> \u6d88\u606f\u4f86\u544a\u77e5\u767c\u9001\u7aef\u7684</p> <p>\u6162\u555f\u52d5\u91cd\u555f\uff08Slow Start Restart, SSR\uff09: \u70ba\u4e86\u8abf\u7bc0\u65b0 TCP \u9023\u7dda\u7684\u50b3\u8f38\u901f\u7387\uff0cTCP \u9084\u5be6\u73fe\u4e86\u6162\u555f\u52d5\u91cd\u555f\uff08SSR\uff09\u6a5f\u5236\uff0c\u8a72\u6a5f\u5236\u5728\u9023\u63a5\u7a7a\u9592\u4e00\u6bb5\u5b9a\u7fa9\u7684\u6642\u9593\u5f8c\uff0c\u6703\u91cd\u7f6e\u9023\u63a5\u7684\u64c1\u585e\u8996\u7a97\u3002\u7406\u7531\u5f88\u7c21\u55ae --- \u5728\u9023\u63a5\u7a7a\u9592\u6642\u7db2\u8def\u72c0\u6cc1\u53ef\u80fd\u5df2\u7d93\u767c\u751f\u8b8a\u5316\uff0c\u70ba\u4e86\u907f\u514d\u64c1\u585e\uff0c\u8996\u7a97\u88ab\u91cd\u7f6e\u70ba\u300c\u5b89\u5168\u300d\u9810\u8a2d\u503c</p> <p>TCP \u5feb\u901f\u958b\u555f\uff08Fast Open, TFO\uff09: TCP \u5feb\u901f\u958b\u555f (TFO) \u662f\u4e00\u7a2e\u6a5f\u5236\uff0c\u5141\u8a31\u5728\u521d\u59cb <code>SYN</code> \u5c01\u5305\u4e2d\u5c31\u50b3\u9001\u61c9\u7528\u7a0b\u5f0f\u8cc7\u6599\uff0c\u4f86\u6d88\u9664\u5c0d\u65b0 TCP \u9023\u63a5\u9020\u6210\u7684\u5ef6\u9072\u640d\u5931\u3002\u4f46\u662f\uff0c\u5b83\u78ba\u5be6\u6709\u5176\u81ea\u8eab\u7684\u9650\u5236\uff0c\u4f8b\u5982: <code>SYN</code> \u5c01\u5305\u5167\u8cc7\u6599\u6709\u6548\u8ca0\u8f09\u7684\u6700\u5927\u5927\u5c0f\u6709\u9650\u5236\u3001\u53ea\u80fd\u767c\u9001\u67d0\u4e9b\u985e\u578b\u7684 HTTP \u8acb\u6c42\uff0c\u4e26\u4e14\u7531\u65bc\u9700\u8981\u91cd\u8907\u9023\u63a5\uff0c\u56e0\u6b64\u5b83\u50c5\u9069\u7528\u65bc\u91cd\u8907\u9023\u63a5\u52a0\u5bc6 cookie</p> <ul> <li>\u589e\u52a0 TCP \u7684\u521d\u59cb\u64c1\u585e\u8996\u7a97: \u8f03\u5927\u7684\u8d77\u59cb\u64c1\u585e\u8996\u7a97\u5141\u8a31 TCP \u5728\u7b2c\u4e00\u6b21\u5f80\u8fd4\u4e2d\u50b3\u8f38\u66f4\u591a\u6578\u64da\uff0c\u4e26\u986f\u8457\u52a0\u901f cwnd \u8996\u7a97\u6210\u9577<ul> <li>\u9810\u8a2d: 3 \u500b MSS (Maximum Segment Size) \u7684\u64c1\u585e\u8996\u7a97\u5927\u5c0f\u3002\u53ef\u8abf\u6574\u70ba 10 \u500b MSS</li> </ul> </li> <li>\u505c\u7528 TCP \u7684 Slow Start Restart \u529f\u80fd: \u505c\u7528\u9592\u7f6e\u5f8c\u7684 SSR\uff0c\u5c07\u63d0\u9ad8\u4ee5\u9031\u671f\u6027\u7a81\u767c\u65b9\u5f0f\u50b3\u8f38\u8cc7\u6599\u7684\u9577\u671f TCP \u9023\u7dda\u7684\u6548\u80fd</li> <li>\u8abf\u6574 cwnd \u8996\u7a97\u5927\u5c0f: \u555f\u7528\u8996\u7a97\u7e2e\u653e\u53ef\u589e\u52a0\u6700\u5927\u63a5\u6536\u8996\u7a97\u5927\u5c0f\uff0c\u4e26\u5141\u8a31\u9ad8\u5ef6\u9072\u9023\u7dda\u5be6\u73fe\u66f4\u597d\u7684\u541e\u5410\u91cf</li> <li>\u555f\u7528 TCP Fast Open\uff08TFO\uff09: \u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u5141\u8a31\u5728\u521d\u59cb SYN \u5c01\u5305\u4e2d\u767c\u9001\u61c9\u7528\u7a0b\u5f0f\u8cc7\u6599\u3002TFO \u662f\u4e00\u500b\u65b0\u7684\u512a\u5316\uff0c\u9700\u8981\u5ba2\u6236\u7aef\u548c\u670d\u52d9\u7aef\u90fd\u652f\u63f4\uff0c\u9700\u4e8b\u5148\u8abf\u67e5\u60a8\u7684\u61c9\u7528\u7a0b\u5f0f\u662f\u5426\u53ef\u4ee5\u4f7f\u7528\u5b83</li> </ul> </li> <li> <p>\u512a\u5316\u7269\u7406\u5c64\u3001\u50b3\u8f38\u5c64\uff08Physical Layer, Data Link Layer\uff09: \u5149\u901f\u3001\u7528\u6236\u7aef :left_arrow_right: \u4f3a\u670d\u5668\u4e4b\u9593\u7684\u8ddd\u96e2\u6c7a\u5b9a\u4e86\u50b3\u64ad\u5ef6\u9072; \u800c\u50b3\u64ad\u5a92\u4ecb\u7684\u9078\u64c7\uff08\u6709\u7dda\u3001\u7121\u7dda\uff09\u6c7a\u5b9a\u4e86\u6bcf\u500b\u8cc7\u6599\u5c01\u5305\u6240\u7522\u751f\u7684\u8655\u7406\u3001\u50b3\u8f38\u3001\u6392\u968a\u7684\u5ef6\u9072\u6642\u9593</p> <ul> <li>\u5be6\u969b\u4e0a\uff0cWiFi \u7db2\u8def\u901a\u5e38\u662f\u6709\u7dda LAN \u7684\u5ef6\u4f38\uff0c\u800c\u6709\u7dda LAN \u53c8\u900f\u904e DSL\u3001\u96fb\u7e9c\u6216\u5149\u7e96\u9023\u63a5\u5230\u5ee3\u57df\u7db2\u8def\u3002\u5c0d\u65bc\u7f8e\u570b\u7684\u666e\u901a\u7528\u6236\u4f86\u8aaa\uff0c\u9019\u4ee3\u8868\u908a\u7de3\u983b\u5bec\u70ba 8.6 Mbps\uff0c\u5168\u7403\u5e73\u5747\u983b\u5bec\u70ba 3.1 Mbps\u3002\u63db\u53e5\u8a71\u8aaa\uff0c\u5927\u591a\u6578 WiFi \u7528\u6236\u7aef\u4ecd\u7136\u53ef\u80fd\u53d7\u5230\u53ef\u7528 WAN \u983b\u5bec\u7684\u9650\u5236\uff0c\u800c\u4e0d\u662f WiFi \u672c\u8eab\u7684\u9650\u5236</li> <li>\u6839\u64da\u4e0b\u5716\uff0c\u5728\u6700\u597d\u7684\u60c5\u6cc1\u4e0b\uff0c\u7121\u7dda\u96fb\u5df2\u7d93\u8655\u65bc\u9ad8\u529f\u7387\u72c0\u614b\uff0cDNS \u5df2\u9810\u5148\u89e3\u6790\uff0c\u4e26\u4e14\u73fe\u6709 TCP \u9023\u7dda\u53ef\u7528\uff08\u5ba2\u6236\u7aef\u53ef\u4ee5\u91cd\u8907\u4f7f\u7528\u73fe\u6709\u7684 TCP \u9023\u7dda\uff0c\u4e26\u907f\u514d\u5efa\u7acb\u65b0\u9023\u7dda\u7684\u958b\u92b7\uff09\u3002\u4f46\u662f\uff0c\u5982\u679c\u9023\u63a5\u7e41\u5fd9\u6216\u4e0d\u5b58\u5728\uff0c\u5247\u5728\u767c\u9001\u4efb\u4f55\u61c9\u7528\u7a0b\u5f0f\u8cc7\u6599\u4e4b\u524d\uff0c\u6211\u5011\u5fc5\u9808\u9032\u884c\u591a\u6b21\u984d\u5916\u7684\u5f80\u8fd4\uff08RTT\uff09     </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li> <p>High Performance Networking in Google Chrome</p> </li> </ul>"},{"location":"others/others/","title":"\u5176\u5b83","text":"<p>\u91cd\u9ede\u6574\u7406</p> \u76ee\u9304<ul> <li>\u5176\u5b83<ul> <li>Media</li> </ul> </li> </ul>"},{"location":"others/others/#media","title":"Media","text":""},{"location":"programming_language/java/","title":"Java","text":"\u76ee\u9304<ul> <li>Java<ul> <li>\u5b78\u7fd2\u8def\u7dda</li> <li>\u57fa\u672c\u6982\u5ff5<ul> <li>\u8cc7\u6599\u578b\u5225</li> <li>\u8ff4\u5708 (for loop &amp; for-each loop)</li> </ul> </li> <li>String<ul> <li>\u57fa\u672c\u6982\u5ff5</li> <li>\u5efa\u7acb\u5b57\u4e32</li> <li>\u57fa\u672c\u64cd\u4f5c</li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> <li>StringBuffer<ul> <li>\u57fa\u672c\u6982\u5ff5</li> <li>\u5efa\u7acb StringBuffer</li> <li>\u57fa\u672c\u64cd\u4f5c</li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> <li>StringBuilder<ul> <li>\u57fa\u672c\u6982\u5ff5</li> <li>\u5efa\u7acb StringBuilder</li> <li>\u57fa\u672c\u64cd\u4f5c</li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599</li> </ul> </li> </ul>"},{"location":"programming_language/java/#_1","title":"\u5b78\u7fd2\u8def\u7dda","text":"<ul> <li>2024 \u5e74 </li> </ul>"},{"location":"programming_language/java/#_2","title":"\u57fa\u672c\u6982\u5ff5","text":""},{"location":"programming_language/java/#_3","title":"\u8cc7\u6599\u578b\u5225","text":"<ul> <li> <p>\u539f\u751f\u578b\u5225 (Primitive Data Type)</p> <ul> <li> <p>boolean, char, int, short, byte, long, float, and double</p> Data Type Size Default Value boolean 1 bit true, false char 2 bytes 0 ~ 65535 byte 1 byte -128 ~ 127 short 2 bytes -32768 ~ 32767 int 4 bytes \\(-2^{31}\\) ~ \\(2^{31}-1\\) long 8 bytes \\(-2^{63}\\) ~ \\(2^{63}-1\\) float 4 bytes double 8 bytes </li> </ul> </li> <li> <p>\u53c3\u8003\u578b\u5225 (Reference Data Types)</p> <ul> <li>Integer, String, Class, Interface, Array ...\u7b49</li> </ul> <p>Java \u4f7f\u7528 Unicode \u7cfb\u7d71; \u800c\u4e0d\u50cf C++ \u4f7f\u7528 ASCII code \u7cfb\u7d71</p> <ul> <li>\u56e0\u6b64\uff0cJava \u7684 char \u578b\u5225\u9700\u8981 2 bytes \u624d\u8db3\u5920</li> </ul> </li> </ul> <p></p>"},{"location":"programming_language/java/#for-loop-for-each-loop","title":"\u8ff4\u5708 (for loop &amp; for-each loop)","text":"<ul> <li> <p>for loop</p> <ul> <li>\u57fa\u672c\u7bc4\u4f8b     Java<pre><code>for (int i = 0; i &lt; arr.length; i++) {\n    System.out.println(\"Element at index \" + i + \" : \"+ arr[i]);\n}\n</code></pre></li> </ul> </li> <li> <p>for-each loop</p> <ul> <li> <p>\u5e38\u7528\u65bc Array, Collection \u985e\u5225</p> </li> <li> <p>\u512a\u9ede</p> <ul> <li>\u5728 loop body \u4e2d\uff0c\u53ef\u76f4\u63a5\u4f7f\u7528 element\uff0c\u800c\u4e0d\u662f\u7528 index \u4f86\u5b58\u53d6\u5143\u7d20</li> </ul> </li> <li> <p>\u9650\u5236</p> <ul> <li> <p>\u50c5\u80fd \u5f80\u524d\u8fed\u4ee3(iterate forward)\uff0c\u4e14 \u4e00\u6b21\u524d\u9032\u4e00\u683c(single step)</p> Java<pre><code>// cannot be converted to a for-each loop\nfor (int i=numbers.length-1; i&gt;0; i--)\n{\n            System.out.println(numbers[i]);\n}\n</code></pre> </li> <li> <p>\u7121\u6cd5 \u4fee\u6539\u539f\u9663\u5217\u4e2d\u7684\u5143\u7d20\u503c</p> Java<pre><code>for (int num: marks)\n{\n        // only changes num, not the array element\n        num = num*2;\n}\n</code></pre> </li> <li> <p>\u7121\u6cd5 \u8ffd\u8e64 index</p> Java<pre><code>for (int num: numbers)\n{\n        if (num == target)\n        {\n                return ???;   // do not know the index of num\n        }\n}\n</code></pre> </li> <li> <p>\u7121\u6cd5 \u540c\u6642\u5b58\u53d6\u5169\u500b\u4e0d\u540c\u7684 Array (\u56e0\u70ba\u7121\u6cd5\u8ffd\u8e64 index)</p> Java<pre><code>// cannot be easily converted to a for-each loop\nfor (int i=0; i&lt;numbers.length; i++)\n{\n        if (numbers[i] == arr[i])\n        { ...\n        }\n}\n</code></pre> </li> </ul> </li> <li> <p>\u57fa\u672c\u7bc4\u4f8b     Java<pre><code>for (int element: arr) {\n    System.out.println(element);\n}\n</code></pre></p> </li> </ul> </li> </ul>"},{"location":"programming_language/java/#string","title":"String","text":"<ul> <li> <p>String, StringBuffer, StringBuilder \u7686\u5be6\u4f5c\u4e86 CharSequence \u4ecb\u9762</p> <p></p> </li> <li> <p>String vs. StringBuffer vs. StringBuilder</p> \u7279\u8272\\\u5b57\u4e32 String StringBuffer StringBuilder \u5f15\u5165\u7248\u672c JDK 1.0 JDK 1.0 JDK 1.5 \u53ef\u8b8a\u6027(mutable, immutable) \u4e0d\u53ef\u8b8a \u53ef\u8b8a \u53ef\u8b8a thread-safe \u662f \u662f \u5426 \u8a18\u61b6\u9ad4\u4f7f\u7528\u6548\u7387 \u9ad8 \u8f03\u5dee \u8f03\u4f73 \u57f7\u884c\u6548\u80fd \u9ad8 \u8f03\u4f4e (\u56e0\u70ba Synchronization) \u8f03\u9ad8 \u9069\u7528\u60c5\u5883 \u8981\u6c42\u5b57\u4e32\u9700\u70ba\u4e0d\u53ef\u8b8a \u591a\u57f7\u884c\u7dd2 \u55ae\u57f7\u884c\u7dd2 </li> </ul>"},{"location":"programming_language/java/#_4","title":"\u57fa\u672c\u6982\u5ff5","text":"<ul> <li> <p>\u5b57\u4e32 = char[]</p> Java<pre><code>String name = \"Geeks\";\n</code></pre> <p></p> </li> <li> <p>\u4e0d\u53ef\u8b8a\u7684 (immutable): \u4e00\u65e6\u5efa\u7acb\u5b57\u4e32\u7269\u4ef6\u5f8c\uff0c\u8a72\u5b57\u4e32\u7684\u5b57\u5143\u5e8f\u5217\u5c31\u7121\u6cd5\u88ab\u66f4\u6539\u4e86</p> Java<pre><code>String original = \"hello\"; // \u539f\u5b57\u4e32\u7269\u4ef6\nString modified = original.toUpperCase();  // \u5efa\u7acb\u4e00\u500b\u65b0\u7684\u5b57\u4e32\u7269\u4ef6\n\nSystem.out.println(original);  // \"hello\"\nSystem.out.println(modified);  // \"HELLO\"\n</code></pre> </li> <li> <p>thread-safe</p> </li> </ul>"},{"location":"programming_language/java/#_5","title":"\u5efa\u7acb\u5b57\u4e32","text":"<ul> <li> <p>\u57fa\u672c\u7bc4\u4f8b</p> Java<pre><code>// \u6cd5 1: String Literal (\u52d5\u614b\u5206\u914d\u5728 heap memory\uff0c\u800c\u4e0d\u662f\u5728 string pool \u4e2d)\nString str1 = \"hello world\";\n// \u6cd5 2: \u4f7f\u7528 new \u95dc\u9375\u5b57 (\u5132\u5b58\u5728 string pool)\nString string = new String (\"hello world\");\n</code></pre> <p></p> </li> <li> <p>\u5176\u4ed6\u7bc4\u4f8b</p> Java<pre><code>// \u7528 byte array \u5efa\u7acb string\nbyte[] bArr = {71, 101, 101, 107, 115};\nString str = new String(bArr); // Geeks\n\n// \u6307\u5b9a byte array \u7684 index \u7bc4\u570d\uff0c\u5efa\u7acb string\nString s_index = new String(bArr, 1, 3); // eek\n</code></pre> Java<pre><code>// \u7528 character array \u5efa\u7acb string\nchar[] charArr = {'G', 'e', 'e', 'k', 's'};\nString str = new String(charArr); // Geeks\n\n// \u6307\u5b9a character array \u7684 index \u7bc4\u570d\uff0c\u5efa\u7acb string\nString str_index = new String(charArr , 1, 3); // eek\n</code></pre> Java<pre><code>// \u7528 int array \u5c0d\u7167 Unicode (offset: \u6307\u5b9a index \u7684\u8d77\u59cb\u4f4d\u7f6e; count: \u8981\u7522\u751f\u5e7e\u500b\u5143\u7d20\u6578)\n// String(int[] uni_code_points, int offset, int count)\nint[] uni_code = {71, 101, 101, 107, 115};\nString str_index = new String(uni_code, 1, 3); // eek\n</code></pre> Java<pre><code>// \u7528 StringBuffer \u985e\u5225\uff0c\u5efa\u7acb String\nStringBuffer sBuffer = new StringBuffer(\"Geeks\");\nString str = new String(sBuffer); // Geeks\n</code></pre> Java<pre><code>// \u7528 StringBuilder \u985e\u5225\uff0c\u5efa\u7acb String\nStringBuilder sBuilder = new StringBuilder(\"Geeks\");\nString str = new String(sBuilder); // Geeks\n</code></pre> </li> <li> <p>stack \u5132\u5b58\u8b8a\u6578(string object)</p> </li> <li> <p>heap \u5132\u5b58\u8b8a\u6578\u503c(string value)</p> <ul> <li> <p>string pool = \u4f4d\u65bc heap memory \u4e2d\u7684\u4e00\u500b\u5b57\u4e32\u7de9\u5b58\u7a7a\u9593 (\u6df1\u7da0\u8272\u8655)</p> Java<pre><code>// \u60c5\u5883 1: \u5efa\u7acb\u4e00\u500b string object\nString str1 = \"Hello\";\n</code></pre> <p></p> Java<pre><code>// \u60c5\u5883 2: \u5efa\u7acb\u5169\u500b\u4e0d\u540c\u7684 string object\uff0c\u4f46\u56e0\u70ba string pool \u4e2d\u5df2\u5b58\u5728 \"Hello\"\uff0c\u6240\u4ee5 str1, str2 \u6703\u6307\u5411 string pool \u4e2d\u7684\u540c\u4e00\u500b string value\nString str1 = \"Hello\";\nString str2 = \"Hello\"; // \"Hello\" in string pool is reused\n</code></pre> <p></p> Java<pre><code>// \u4f7f\u7528 new \u95dc\u9375\u5b57\uff0c\u6703\u5c07\u8b8a\u6578\u503c\u52d5\u614b\u5206\u914d\u5728 heap memory \u4e2d (\u800c\u4e0d\u662f\u5728 string pool)\nString strObject = new String(\"hello world\");\n// \u4f7f\u7528 String.intern() \u5167\u5efa\u65b9\u6cd5\u5c07\u5b57\u4e32\u503c\u79fb\u52d5\u5230 string pool\nString strLiteral = strObject.intern();\n\nSystem.out.println(strObject == strLiteral); // false\n</code></pre> <p></p> </li> </ul> </li> </ul>"},{"location":"programming_language/java/#_6","title":"\u57fa\u672c\u64cd\u4f5c","text":"<ul> <li> <p>\u8a08\u7b97\u5b57\u4e32\u4e2d\u7684 character \u6578: <code>String.length()</code></p> Java<pre><code>\"abc\".length();  // 3\n</code></pre> </li> <li> <p>\u7372\u53d6\u6307\u5b9a index \u4f4d\u7f6e\u7684 character</p> <ul> <li>\u56de\u50b3 character \u578b\u5225 (\u7528\u55ae\u5f15\u865f ' ')</li> </ul> Java<pre><code>\"abcde\".charAt(3);  // 'd'\n</code></pre> </li> <li> <p>\u79fb\u9664\u7a7a\u767d\u5b57\u5143</p> <ul> <li>\u50c5\u79fb\u9664\u5b57\u4e32\u7684\u9996\u3001\u5c3e\u8655 \u7684\u7a7a\u767d\u5b57\u5143; \u4e0d\u5305\u62ec\u5b57\u4e32\u4e2d\u9593\u7684\u7a7a\u767d\u5b57\u5143</li> </ul> Java<pre><code>String str1 = \" a b c \";\nSystem.out.println(str1.trim()); // \"a b c\"\n</code></pre> </li> <li> <p>\u66ff\u63db\u5b57\u5143</p> <ul> <li>\u6703\u5efa\u7acb\u4e00\u500b\u65b0\u5b57\u4e32 (\u6240\u4ee5 \u4e0d\u6703 \u5f71\u97ff\u5230\u539f\u5b57\u4e32)</li> </ul> Java<pre><code>String str1 = \"aabbcc\";\nString str2 = str1.replace('b', 'f');\n\nSystem.out.println(str1); // \"aabbcc\"\nSystem.out.println(str2); // \"aaffcc\"\n</code></pre> </li> <li> <p>\u5c07\u5b57\u4e32\u8f49\u63db\u6210 char[]</p> Java<pre><code>String str1=\"abcde\";\nchar[] charArr = str1.toCharArray();\n\nSystem.out.println(charArr); // ['a', 'b', 'c', 'd', 'e']\n</code></pre> </li> <li> <p>\u6aa2\u67e5\u5b57\u4e32\u7684\u524d\u7db4</p> Java<pre><code>String str1=\"hello world\";\nString str2=\"hello\";\n\nSystem.out.println(str1.startsWith(str2)); // true\n</code></pre> </li> <li> <p>\u627e\u51fa\u6307\u5b9a substring \u65bc\u5b57\u4e32\u4e2d \u7b2c\u4e00\u6b21\u51fa\u73fe \u7684 index \u4f4d\u7f6e</p> <ul> <li>\u53c3\u6578 substring \u662f case sensitive</li> <li>\u82e5\u672a\u641c\u5c0b\u5230\uff0c\u56de\u50b3 -1</li> </ul> Java<pre><code>String str = \"A learns and B learns\";\nSystem.out.println(str.indexOf(\"learns\"));  // 2\nSystem.out.println(str.indexOf(\"AND\")); // -1\n</code></pre> </li> <li> <p>\u627e\u51fa\u6307\u5b9a substring \u65bc\u5b57\u4e32\u4e2d \u6700\u5f8c\u4e00\u6b21\u51fa\u73fe \u7684 index \u4f4d\u7f6e</p> <ul> <li>\u53c3\u6578 substring \u662f case sensitive</li> <li>\u82e5\u672a\u641c\u5c0b\u5230\uff0c\u56de\u50b3 -1</li> </ul> Java<pre><code>String str = \"abcabc\";\nSystem.out.println(str.lastIndexOf(\"ab\")); // 3\nSystem.out.println(str.lastIndexOf(\"c\")); // 5 (\u6ce8\u610f! \u53c3\u6578\u578b\u5225\u5fc5\u9808\u662f String\uff0c\u56e0\u6b64\u82e5\u8981\u641c\u5c0b character\uff0c\u4ecd\u7136\u5fc5\u9700\u7528\u96d9\u5f15\u865f \"\")\n</code></pre> </li> <li> <p>\u5408\u4f75 substring</p> Java<pre><code>String substr1 = \"abc\";\nString substr2 = \"def\";\nString res = substr1.concat(substr2); // \"abcdef\"\n</code></pre> </li> <li> <p>\u7d66\u5b9a index \u7bc4\u570d\uff0c\u5207\u5272\u51fa substring</p> <ul> <li>index \u5f9e 0 \u958b\u59cb</li> <li>\u4e0d\u5305\u542b\u672b\u9805 index \u7684\u503c</li> </ul> Java<pre><code>\"abcdef\".substring(2, 4); // \"cd\"\n</code></pre> </li> <li> <p>\u6aa2\u67e5\u662f\u5426\u5305\u542b\u67d0\u500b substring</p> <ul> <li>\u53c3\u6578\u50c5\u80fd\u662f substring \uff0c\u800c\u4e0d\u80fd\u662f character</li> </ul> Java<pre><code>String str1 = \"abcdef\";\n\nSystem.out.println(str1.contains(\"bcd\")); // true, \u5b8c\u5168\u9023\u7e8c\u5b58\u5728\nSystem.out.println(str1.contains(\"bcf\")); // false, \u4e0d\u80fd\u6709\u9593\u9694\n</code></pre> </li> <li> <p>\u6bd4\u8f03\u5169\u500b String \u662f\u5426\u5b8c\u5168\u76f8\u540c (\u6bcf\u4e00\u500b character)</p> <ul> <li>\u63a1 case sensitive: <code>str1.equals(str2)</code></li> <li>\u63a1 case insensitive: <code>str1.equalsIgnoreCase(str2)</code></li> </ul> Java<pre><code>// String.equals.()\nBoolean res1 = \"abc\".equals(\"abc\"); // true\nBoolean res2 = \"ABC\".equals(\"abc\"); // false\n\n// String.equalsIgnoreCase.()\nBoolean res3 = \"abc\".equalsIgnoreCase(\"abc\"); // true\nBoolean res4 = \"ABC\".equalsIgnoreCase(\"abc\"); // true\n</code></pre> </li> <li> <p>\u6bd4\u8f03\u5169\u500b String \u7684\u5b57\u7b26\u9806\u5e8f (lexicographically)</p> <ul> <li>\u5b57\u7b26\u9806\u5e8f = (\u6bcf\u500b character \u7684) Unicode \u503c\u7684\u7de8\u78bc\u9806\u5e8f</li> <li>\u7528\u6cd5 1: \u6bd4\u8f03\u5b57\u5178\u9806\u5e8f<ul> <li>\u56de\u50b3 str1, str2 \u4e4b\u9593\u7684\u5b57\u7b26\u9806\u5e8f\u7684\u5dee\u8ddd\uff0c\u6bd4\u8f03 str1, str2 \u4e4b\u9593\u7684\u7b2c\u4e00\u500b\u4e0d\u76f8\u540c\u7684 character \u7684\u5b57\u7b26\u9806\u5e8f<ul> <li>\u82e5 str1 comes before str2: \u56de\u50b3\u8ca0\u503c (&lt; 0)</li> <li>\u82e5 str1 &amp; str2 are same: \u56de\u50b3 0</li> <li>\u82e5 str1 comes after str2: \u56de\u50b3\u6b63\u503c (&gt; 0)</li> </ul> </li> </ul> </li> <li>\u7528\u6cd5 2: \u82e5 str1 \u662f str2 \u7684\u524d\u7db4\u7684\u60c5\u6cc1<ul> <li>\u56de\u50b3 str1, str2 \u5169\u500b\u5b57\u4e32\u9577\u5ea6\u7684\u5dee\u503c: <code>str1.length() - str2.length()</code></li> </ul> </li> <li>\u63a1 case sensitive: <code>str1.compareTo(str2)</code></li> <li>\u63a1 case insensitive: <code>str1.compareToIgnoreCase(str2)</code></li> </ul> Java<pre><code>String str1 = \"hello\";\nString str2 = \"hello\";\nString str3 = \"heck\";\nString str4 = \"hello world\";\n\n// \u7528\u6cd5 1 (\u5b57\u5178\u9806\u5e8f): \u7576\u5169\u500b\u5b57\u4e32\u4e0d\u76f8\u7b49\u6642\uff0c\u6bd4\u8f03\u7684\u662f\u5b57\u5143\u7684 Unicode \u503c\n// \u4f8b\u5982:str1 \u548c str3 \u7684\u6bd4\u8f03\u9996\u5148\u6703\u6bd4\u8f03\u7b2c\u4e00\u500b\u4e0d\u540c\u7684\u5b57\u5143\uff08'l' \u548c 'c'\uff09\uff0c\u7531\u65bc 'l' \u7684 Unicode \u503c\u5927\u65bc 'c' \u7684\uff0c\u56e0\u6b64\u8fd4\u56de\u4e00\u500b\u6b63\u503c\nSystem.out.println(str1.compareTo(str3));  // 9 (\u6b63\u503c)\n\n// \u7528\u6cd5 2 (\u9577\u5ea6\u554f\u984c): \u7576\u4e00\u500b\u5b57\u4e32\u662f\u53e6\u4e00\u500b\u5b57\u4e32\u7684\u524d\u7db4\u6642\uff0c\u6bd4\u8f03\u7d50\u679c\u57fa\u65bc\u9577\u5ea6\u5dee\u7570\n// \u4f8b\u5982: str1 \u548c str4 \u7684\u6bd4\u8f03\u3002str1 \u8f03\u77ed\uff0c\u6240\u4ee5\u8fd4\u56de\u4e00\u500b\u8ca0\u503c\uff0c\u5176\u503c\u901a\u5e38\u662f\u5169\u500b\u5b57\u4e32\u9577\u5ea6\u7684\u5dee\nSystem.out.println(s1.compareTo(s4));  // -6 (\u8ca0\u503c)\n\n// \u56e0\u70ba str1 \u548c str2 \u5b8c\u5168\u76f8\u540c\nSystem.out.println(str1.compareTo(str2));  // 0\n</code></pre> </li> </ul>"},{"location":"programming_language/java/#_7","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>GeeksForGeeks-Strings in Java</li> <li> <p>GeeksForGeeks-String constant pool in Java</p> </li> <li> <p>Java-String intern()</p> </li> <li> <p>GeeksForGeeks-String class in Java</p> </li> <li> <p>GeeksForGeeks-String vs. StringBuffer vs. StringBuilder in Java</p> </li> </ul>"},{"location":"programming_language/java/#stringbuffer","title":"StringBuffer","text":""},{"location":"programming_language/java/#_8","title":"\u57fa\u672c\u6982\u5ff5","text":"<ul> <li>StringBuffer = char[]</li> <li>\u53ef\u8b8a\u7684(mutable): \u65b9\u4fbf\u4fee\u6539\u5b57\u4e32\u503c\uff0c\u800c\u4e0d\u9700\u6bcf\u6b21\u90fd\u8981\u5efa\u7acb\u65b0\u7684\u5b57\u4e32</li> <li>thread-safe: \u56e0\u6b64\uff0c\u5e38\u7528\u65bc multi-threaded \u7a0b\u5f0f</li> </ul>"},{"location":"programming_language/java/#stringbuffer_1","title":"\u5efa\u7acb StringBuffer","text":"Java<pre><code>// \u6cd5 1: \u5efa\u7acb\u4e00\u500b\u7a7a\u7684 StringBuffer\uff0c\u521d\u59cb\u5bb9\u91cf\u70ba 16\nStringBuffer buffer1 = new StringBuffer();\n// \u6cd5 2: \u4f7f\u7528\u5b57\u4e32\u5efa\u7acb StringBuffer\nStringBuffer buffer2 = new StringBuffer(\"Java\");\n// \u6cd5 3: \u5efa\u7acb\u4e00\u500b\u6307\u5b9a\u5bb9\u91cf\u7684 StringBuffer\nStringBuffer buffer3 = new StringBuffer(50);\n</code></pre>"},{"location":"programming_language/java/#_9","title":"\u57fa\u672c\u64cd\u4f5c","text":"<ul> <li> <p>\u53d6\u5f97\u7576\u524d StringBuffer \u7684\u5bb9\u91cf</p> <ul> <li>\u9810\u8a2d\u70ba 16 \u500b character</li> </ul> Java<pre><code>StringBuffer sb = new StringBuffer();\nSystem.out.println(sb.capacity()); // \u9810\u8a2d\u70ba 16 \u500b character \u7684\u5bb9\u91cf\n\nsb.append(\"hello\");\nSystem.out.println(sb.capacity()); // \u5bb9\u91cf\u4e0d\u6703\u53d7\u5230\u5f71\u97ff\n</code></pre> </li> <li> <p>\u8a08\u7b97\u7576\u524d StringBuffer \u7684\u5143\u7d20\u6578</p> <ul> <li>\u9810\u8a2d\u70ba 0</li> </ul> Java<pre><code>StringBuffer sb = new StringBuffer();\nSystem.out.println(sb.length()); // 0\n\nsb.append(\"hello\");\nSystem.out.println(sb.length()); // 5\n</code></pre> </li> <li> <p>\u9644\u52a0\u65b0\u5b57\u4e32\u5230\u539f\u5b57\u4e32\u7684\u6700\u5f8c\u9762</p> <ul> <li>\u6703\u5f71\u97ff\u5230\u539f\u5b57\u4e32</li> </ul> Java<pre><code>StringBuffer sb = new StringBuffer(\"hello \");\nsb.append(\"world\"); // \u6703\u5f71\u97ff\u5230\u539f\u672c\u5b57\u4e32\n\nSystem.out.println(sb); // \"hello world\"\n</code></pre> </li> <li> <p>\u63d2\u5165\u65b0\u5b57\u4e32\u5230\u6307\u5b9a index \u4f4d\u7f6e</p> <ul> <li>\u6703\u5f71\u97ff\u5230\u539f\u5b57\u4e32</li> </ul> Java<pre><code>StringBuffer sb = new StringBuffer(\"hello \");\nsb.insert(1, \"bbb\"); // \u6703\u5f71\u97ff\u5230\u539f\u672c\u5b57\u4e32\n\nSystem.out.println(sb); // \"hbbbello\"\n</code></pre> </li> <li> <p>\u65bc\u6307\u5b9a index \u7bc4\u570d\uff0c\u66ff\u63db\u70ba\u65b0\u5b57\u4e32</p> <ul> <li>\u6703\u5f71\u97ff\u5230\u539f\u5b57\u4e32</li> <li>\u6307\u5b9a index \u7bc4\u570d: beginIndex ~ endIndex (\u5305\u542b beginIndex\uff0c \u4f46\u4e0d\u5305\u542b endIndex)</li> </ul> Java<pre><code>StringBuffer sb = new StringBuffer(\"abcde\");\nsb.replace(1, 3, \"java\"); // \u8868\u793a\u8981\u5c07 'e', 'l' \u7684 index \u4f4d\u7f6e\uff0c\u66ff\u63db\u6210 \"java\"\n\nSystem.out.println(sb); // \"ajavade\"\n</code></pre> </li> <li> <p>\u65bc\u6307\u5b9a index \u7bc4\u570d\uff0c\u522a\u9664 substring</p> <ul> <li>\u6703\u5f71\u97ff\u5230\u539f\u5b57\u4e32</li> <li>\u6307\u5b9a index \u7bc4\u570d: beginIndex ~ endIndex (\u5305\u542b beginIndex\uff0c \u4f46\u4e0d\u5305\u542b endIndex)</li> </ul> Java<pre><code>StringBuffer sb = new StringBuffer(\"abcde\");\nsb.delete(1, 3); // \u8868\u793a\u8981\u522a\u9664 \"bc\"\n\nSystem.out.println(sb); // \"ade\"\n</code></pre> </li> <li> <p>\u53cd\u8f49 StringBuffer</p> <ul> <li>\u6703\u5f71\u97ff\u5230\u539f\u5b57\u4e32</li> </ul> Java<pre><code>StringBuffer sb = new StringBuffer(\"hello\");\nsb.reverse();\n\nSystem.out.println(sb); // olleh\n</code></pre> </li> </ul>"},{"location":"programming_language/java/#_10","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>GeeksForGeeks-StringBuffer class in Java</li> </ul>"},{"location":"programming_language/java/#stringbuilder","title":"StringBuilder","text":""},{"location":"programming_language/java/#_11","title":"\u57fa\u672c\u6982\u5ff5","text":"<ul> <li> <p>\u5f9e Java SE 5.0 \u5f8c\uff0c\u63a8\u51fa StringBuilder \u985e\u5225</p> <ul> <li>\u76f8\u8f03 StringBuffer \u985e\u5225\uff0cStringBuilder \u985e\u5225\u57f7\u884c\u6548\u80fd\u66f4\u5feb\uff0c\u4f46\u4e0d\u4fdd\u8b49\u540c\u6b65\u6027(synchronization)</li> </ul> </li> <li> <p>StringBuilder = char[]</p> </li> <li>\u975e thread-safe: \u56e0\u6b64\uff0c\u5e38\u7528\u65bc single-threaded \u7a0b\u5f0f</li> </ul>"},{"location":"programming_language/java/#stringbuilder_1","title":"\u5efa\u7acb StringBuilder","text":"Java<pre><code>// \u6cd5 1: \u5efa\u7acb\u4e00\u500b\u7a7a\u7684 StringBuilder\uff0c\u521d\u59cb\u5bb9\u91cf\u70ba 16\nStringBuilder sb1 = new StringBuilder();\n// \u6cd5 2: \u4f7f\u7528\u5b57\u4e32\u5efa\u7acb StringBuffer\nStringBuilder sb2 = new StringBuilder(\"Java\");\n// \u6cd5 3: \u5efa\u7acb\u4e00\u500b\u6307\u5b9a\u5bb9\u91cf\u7684 StringBuffer\nStringBuilder sb3 = new StringBuilder(50);\n</code></pre>"},{"location":"programming_language/java/#_12","title":"\u57fa\u672c\u64cd\u4f5c","text":"<ul> <li> <p>\u53d6\u5f97\u7576\u524d StringBuilder \u7684\u5bb9\u91cf</p> <ul> <li>\u9810\u8a2d\u70ba 16 \u500b character</li> </ul> Java<pre><code>StringBuilder sb = new StringBuilder();\nSystem.out.println(sb.capacity()); // \u9810\u8a2d\u70ba 16 \u500b character \u7684\u5bb9\u91cf\n\nsb.append(\"hello\");\nSystem.out.println(sb.capacity()); // \u5bb9\u91cf\u4e0d\u6703\u53d7\u5230\u5f71\u97ff\n</code></pre> </li> <li> <p>\u8a08\u7b97\u7576\u524d StringBuffer \u7684\u5143\u7d20\u6578</p> <ul> <li>\u9810\u8a2d\u70ba 0</li> </ul> Java<pre><code>StringBuilder sb = new StringBuilder();\nSystem.out.println(sb.length()); // 0\n\nsb.append(\"hello\");\nSystem.out.println(sb.length()); // 5\n</code></pre> </li> <li> <p>\u5c07 StringBuilder \u985e\u5225\uff0c\u8f49\u63db\u6210 String \u985e\u5225</p> Java<pre><code>StringBuilder sb = new StringBuilder(\"abc\");\nSystem.out.println(sb.getClass()); // class java.lang.StringBuilder\n\nString str = sb.toString();\nSystem.out.println(str.getClass()); // class java.lang.String\n</code></pre> </li> <li> <p>\u6839\u64da\u6307\u5b9a index \u4f4d\u7f6e\uff0c\u53d6\u5f97 character</p> Java<pre><code>StringBuilder sb = new StringBuilder(\"abcde\");\nSystem.out.println(sb.charAt(2)); // 'c'\n</code></pre> </li> <li> <p>\u627e\u51fa\u6307\u5b9a substring \u65bc\u5b57\u4e32\u4e2d \u7b2c\u4e00\u6b21\u51fa\u73fe \u7684 index \u4f4d\u7f6e</p> <ul> <li>\u53c3\u6578 substring \u662f case sensitive</li> <li>\u82e5\u672a\u641c\u5c0b\u5230\uff0c\u56de\u50b3 -1</li> </ul> Java<pre><code>StringBuilder sb = new StringBuilder(\"A learns and B learns\");\nSystem.out.println(sb.indexOf(\"learns\"));  // 2\nSystem.out.println(sb.indexOf(\"AND\")); // -1\n</code></pre> </li> <li> <p>\u627e\u51fa\u6307\u5b9a substring \u65bc\u5b57\u4e32\u4e2d \u6700\u5f8c\u4e00\u6b21\u51fa\u73fe \u7684 index \u4f4d\u7f6e</p> <ul> <li>\u53c3\u6578 substring \u662f case sensitive</li> <li>\u82e5\u672a\u641c\u5c0b\u5230\uff0c\u56de\u50b3 -1</li> </ul> Java<pre><code>StringBuilder sb = new StringBuilder(\"abcabc\");\nSystem.out.println(sb.lastIndexOf(\"ab\")); // 3\nSystem.out.println(sb.lastIndexOf(\"c\")); // 5 (\u6ce8\u610f! \u53c3\u6578\u578b\u5225\u5fc5\u9808\u662f String\uff0c\u56e0\u6b64\u82e5\u8981\u641c\u5c0b character\uff0c\u4ecd\u7136\u5fc5\u9700\u7528\u96d9\u5f15\u865f \"\")\n</code></pre> </li> <li> <p>\u7d66\u5b9a index \u7bc4\u570d\uff0c\u5207\u5272\u51fa substring</p> <ul> <li>index \u5f9e 0 \u958b\u59cb</li> <li>\u4e0d\u5305\u542b\u672b\u9805 index \u7684\u503c</li> </ul> Java<pre><code>StringBuilder sb = new StringBuilder(\"abcdef\");\nSystem.out.println(sb.substring(2, 4)); // \"cd\"\n</code></pre> </li> <li> <p>\u9644\u52a0\u65b0\u5b57\u4e32\u5230\u539f\u5b57\u4e32\u7684\u6700\u5f8c\u9762</p> <ul> <li>\u6703\u5f71\u97ff\u5230\u539f\u5b57\u4e32</li> </ul> Java<pre><code>StringBuilder sb = new StringBuilder(\"hello \");\nsb.append(\"world\"); // \u6703\u5f71\u97ff\u5230\u539f\u672c\u5b57\u4e32\n\nSystem.out.println(sb); // \"hello world\"\n</code></pre> </li> <li> <p>\u63d2\u5165\u5143\u7d20\u5230\u6307\u5b9a index \u4f4d\u7f6e</p> Java<pre><code>StringBuilder sb = new StringBuilder(\"aaa\");\nsb.insert(1, 'b');\nSystem.out.println(sb); // \"abaa\"\n\nsb.insert(2, \"cd\");\nSystem.out.println(sb); // \"abcdaa\"\n</code></pre> </li> <li> <p>\u65bc\u6307\u5b9a index \u7bc4\u570d\uff0c\u66ff\u63db\u70ba\u65b0\u5b57\u4e32</p> <ul> <li>\u6703\u5f71\u97ff\u5230\u539f\u5b57\u4e32</li> <li>\u6307\u5b9a index \u7bc4\u570d: beginIndex ~ endIndex (\u5305\u542b beginIndex\uff0c \u4f46\u4e0d\u5305\u542b endIndex)</li> </ul> Java<pre><code>StringBuilder sb = new StringBuilder(\"abcdefg\");\nsb.replace(1, 3, \"x\"); // \u8868\u793a\u8981\u5c07 'b', 'c' \u7684 index \u4f4d\u7f6e\uff0c\u66ff\u63db\u6210 \"x\"\n\nSystem.out.println(sb); // \"axdefg\"\n</code></pre> </li> <li> <p>\u65bc\u6307\u5b9a index \u7bc4\u570d\uff0c\u522a\u9664 substring</p> <ul> <li> <p>\u6703\u5f71\u97ff\u5230\u539f\u5b57\u4e32</p> </li> <li> <p>\u6307\u5b9a index \u7bc4\u570d: beginIndex ~ endIndex (\u5305\u542b beginIndex\uff0c \u4f46\u4e0d\u5305\u542b endIndex)</p> </li> </ul> Java<pre><code>StringBuilder sb = new StringBuilder(\"abcde\");\nsb.delete(1, 3); // \u8868\u793a\u8981\u522a\u9664 \"bc\"\n\nSystem.out.println(sb); // \"ade\"\n</code></pre> </li> </ul>"},{"location":"programming_language/java/#_13","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>GeeksForGeeks-StringBuilder class in Java</li> </ul>"},{"location":"programming_language/java/#_14","title":"\u53c3\u8003\u8cc7\u6599","text":"<ul> <li>Developer Roadmaps-Java Developer</li> </ul>"},{"location":"programming_language/nodejs/","title":"Node.js Learn","text":"<p>\u81ea\u4e3b\u5b78\u7fd2 Node.js \u7684\u89c0\u5ff5\u548c\u6307\u4ee4\u5f8c\u505a\u7684\u7d71\u6574 &amp; \u5b78\u7fd2\u7b46\u8a18</p> \u76ee\u9304<ul> <li>Node.js Learn<ul> <li>\u5b89\u88dd\u65b9\u5f0f<ul> <li>Windows \u7cfb\u7d71</li> <li>MacOS \u7cfb\u7d71</li> <li>Linux \u7cfb\u7d71 (\u4ee5 Ubuntu \u70ba\u4f8b)</li> </ul> </li> <li>Node.js \u6838\u5fc3\u89c0\u5ff5<ul> <li>Introduction to Node.js</li> <li>A brief history of Node.js</li> <li>How to install Node.js?</li> <li>How much JavaScript do you need to know to use Node.js?</li> <li>Differences between Node.js and the Browser</li> <li>The V8 JavaScript Engine</li> <li>Run Node.js scripts from the command line</li> <li>How to exit from a Node.js program?</li> <li>How to read environment variables from Node.js?</li> <li>How to use the Node.js REPL?</li> <li>Node.js, accept arguments from the command line</li> <li>Output to the command line using Node.js</li> <li>Accept input from the command line in Node.js</li> <li>Expose functionality from a Node.js file using exports</li> <li>An introduction to the npm package manager</li> <li>Where does npm install the packages?</li> <li>How to use or execute a package installed using npm?</li> <li>The package.json guide</li> <li>The package-lock.json file</li> <li>Find the installed version of an npm package</li> <li>Install an older version of an npm package</li> <li>Update all the Node.js dependencies to their latest version</li> <li>Semantic Versioning using npm</li> <li>Uninstalling npm packages</li> <li>npm global or local packages</li> <li>npm dependencies and devDependencies</li> <li>The npx Node.js Package Runner</li> <li>The Node.js Event Loop</li> <li>Understanding process.nextTick()</li> <li>Understanding setImmediate()</li> <li>Discover JavaScript Timers</li> <li>JavaScript Asynchronous Programming and Callbacks</li> <li>Understanding JavaScript Promises</li> <li>Modern Asynchronous JavaScript with Async and Await</li> <li>The Node.js Event emitter</li> <li>Build an HTTP Server</li> <li>Making HTTP requests with Node.js</li> <li>Make an HTTP POST request using Node.js</li> <li>Get HTTP request body data using Node.js</li> <li>Working with file descriptors in Node.js</li> <li>Node.js file stats</li> <li>Node.js File Paths</li> <li>Reading files with Node.js</li> <li>Writing files with Node.js</li> <li>Working with folders in Node.js</li> <li>The Node.js fs module</li> <li>The Node.js path module</li> <li>The Node.js os module</li> <li>The Node.js events module</li> <li>The Node.js http module</li> <li>Node.js Buffers</li> <li>Node.js Streams</li> <li>Node.js, the difference between development and production</li> <li>Error handling in Node.js</li> <li>How to log an object in Node.js</li> <li>Node.js with TypeScript</li> </ul> </li> <li>Node.js \u6838\u5fc3\u6a21\u7d44<ul> <li>HTTP</li> <li>Process</li> <li>Console</li> <li>Readline</li> <li>CommonJS modules</li> <li>Timers</li> <li>Events</li> <li>Buffers</li> <li>Stream</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599\u4f86\u6e90<ul> <li>\u5b98\u65b9\u6587\u4ef6</li> <li>\u7db2\u8def\u6587\u7ae0</li> <li>\u7db2\u8def\u5f71\u7247</li> </ul> </li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#_1","title":"\u5b89\u88dd\u65b9\u5f0f","text":"<ul> <li>\u5b98\u65b9\u7db2\u7ad9\u6703\u5148\u5206\u6210LTS.Current\u5169\u500b\u7248\u672c</li> <li><code>LTS</code>(Long-term support): Recommended for most users</li> <li><code>Current</code>: Latest features</li> <li>\u5b89\u88ddNode.js\u4e4b\u5f8c,\u4e5f\u6703\u81ea\u52d5\u5b89\u88ddNPM</li> <li>\u82e5\u60f3\u8981\u5b89\u88dd\u6307\u5b9a\u7248\u672c\u7684Node.js,\u53ef\u4ee5\u8f38\u5165\u4ee5\u4e0b\u6307\u4ee4</li> <li>$ <code>brew install node@&lt;specific version&gt;</code><ul> <li>\u4f8b: <code>brew install node@10</code></li> </ul> </li> <li>\u53ef\u53c3\u8003How to install specific NodeJS version</li> <li>\u82e5\u60f3\u8981\u5b89\u88dd\u6307\u5b9a\u7248\u672c\u7684NPM(Node Package Manager),\u53ef\u4ee5\u8f38\u5165\u4ee5\u4e0b\u6307\u4ee4</li> <li>\u5347\u7d1a\u5230Latest version: <code>npm install -g npm@latest</code></li> <li>\u5347\u7d1a\u5230Most recent release version: <code>npm install -g npm@next</code></li> <li>\u53ef\u53c3\u8003Try the latest stable version of npm</li> <li>\u5982\u679c\u60f3\u8981\u5728\u540c\u4e00\u53f0\u96fb\u8166\u4e0a\u9762,\u5207\u63dbNode\u7684\u7248\u672c,\u53ef\u4ee5\u5b89\u88ddNVM(Node Version Manager)</li> <li>MacOS<ul> <li>$ <code>brew install nvm</code></li> </ul> </li> <li>Linux<ul> <li>$ <code>curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh | bash</code></li> </ul> </li> <li>\u63a5\u4e0b\u4f86\u8981\u5230(~/.bash_profile, ~/.zshrc, ~/.profile, or ~/.bashrc)\u7684\u5176\u4e2d\u4e00\u500b\u6a94\u6848,\u65b0\u589e\u4ee5\u4e0b3\u884c\u6307\u4ee4 \u5230\u8a72\u6a94\u6848\u7684\u6700\u4e0b\u9762<ul> <li><code>export NVM_DIR=\"$HOME/.nvm\"</code> <code>[ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"$NVM_DIR/nvm.sh\"</code>  # This loads nvm <code>[ -s \"$NVM_DIR/bash_completion\" ] &amp;&amp; \\. \"$NVM_DIR/bash_completion\"</code>  # This loads nvm bash_completion</li> </ul> </li> <li>\u6aa2\u67e5\u662f\u5426\u6b63\u5e38\u5b89\u88ddNVM<ul> <li>$ <code>command -v nvm</code>: \u5982\u679c\u6709\u6210\u529f\u5b89\u88ddNVM\u7684\u8a71,\u61c9\u8a72\u8981\u56de\u50b3<code>nvm</code></li> </ul> </li> <li>\u6aa2\u67e5\u5b89\u88dd\u7684NVM\u7248\u672c<ul> <li>$ <code>nvm --version</code> </li> </ul> </li> <li>\u53ef\u53c3\u8003Node Version Manager</li> </ul>"},{"location":"programming_language/nodejs/#windows","title":"Windows \u7cfb\u7d71","text":"<ul> <li>\u9023\u7d50: https://nodejs.org/en/download/</li> <li>\u5b89\u88dd\u5b8c\u6210\u5f8c,\u53ef\u4ee5\u7528CLI\u6307\u4ee4\u6aa2\u67e5 Node &amp; NPM \u7684\u7248\u672c<ul> <li>$ <code>node --version</code> </li> <li>$ <code>npm --version</code></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#macos","title":"MacOS \u7cfb\u7d71","text":"<ul> <li>\u9023\u7d50: https://nodejs.org/en/download/package-manager/#macos<ul> <li>\u6307\u4ee4: <code>brew install node</code></li> </ul> </li> <li>\u5b89\u88dd\u5b8c\u6210\u5f8c,\u53ef\u4ee5\u7528CLI\u6307\u4ee4\u6aa2\u67e5 Node &amp; NPM \u7684\u7248\u672c<ul> <li>$ <code>node --version</code> </li> <li>$ <code>npm --version</code></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#linux-ubuntu","title":"Linux \u7cfb\u7d71 (\u4ee5 Ubuntu \u70ba\u4f8b)","text":"<ul> <li>\u9023\u7d50: https://github.com/nodesource/distributions/blob/master/README.md</li> <li>\u6307\u4ee4: <ul> <li>$ <code>sudo apt-get install -y nodejs</code></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#nodejs","title":"Node.js \u6838\u5fc3\u89c0\u5ff5","text":""},{"location":"programming_language/nodejs/#introduction-to-nodejs","title":"Introduction to Node.js","text":"<p><code>\u5148\u5099\u77e5\u8b58</code></p> <p><code>One process</code>: \u4e00\u500b\u5168\u57df\u7684Object,\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u88ab\u57f7\u884c,\u4e26\u4fdd\u6709\u57f7\u884c\u6642\u7684\u8cc7\u6599 <code>One thread</code>: single-thread,\u5728\u4e00\u500b<code>process</code>\u4e2d\u53ea\u80fd\u57f7\u884c\u4e00\u4ef6\u4e8b <code>One event loop</code>: \u4e00\u500b\u4e8b\u4ef6\u8ff4\u5708,\u56e0\u70ba\u5b83\u4f7fNode\u53ef\u4ee5\u662f\u975e\u540c\u6b65(asynchronous) &amp; \u975e\u963b\u585eI/O(non-blocking I/O); \u56e0\u70baNode\u662fsingle-thread\u7684,\u900f\u904ecallback.Promise.async/await\u80fd\u5c07\u5de5\u4f5c\u5206\u6563\u7d66system kernel <code>One JS Engine Instance</code>: \u4e00\u500bJavascript\u5be6\u4f8b,\u7528\u4f86\u57f7\u884cJavascript\u7684\u7a0b\u5f0f\u78bc <code>One Node.js Instance</code>: \u4e00\u500bNode\u5be6\u4f8b,\u7528\u4f86\u57f7\u884cNode\u7684\u7a0b\u5f0f\u78bc</p> <ul> <li>Node\u662f\u4e00\u500b\u514d\u8cbb.\u958b\u6e90.\u8de8\u5e73\u53f0\u7684Javascript\u57f7\u884c\u74b0\u5883,\u8b93\u958b\u767c\u8005\u53ef\u4ee5\u5728\u700f\u89bd\u5668\u4ee5\u5916\u4e5f\u80fd\u4f7f\u7528Javascript</li> <li>\u4e5f\u56e0\u6b64\u8b93\u5ee3\u5927\u7684\u524d\u7aef\u958b\u767c\u8005\u5011,\u53ef\u4ee5\u52a0\u5165\u5f8c\u7aef\u958b\u767c\u7684\u884c\u5217,\u4e26\u4e14\u4e0d\u7528\u56e0\u6b64\u9700\u8981\u591a\u5b78\u4e00\u9580\u7a0b\u5f0f\u8a9e\u8a00 </li> <li>Node\u662f\u57fa\u65bcChrome\u700f\u89bd\u5668\u7684V8\u5f15\u64ce\u4f86\u5efa\u7acb\u51fa\u7684\u57f7\u884c\u74b0\u5883,\u56e0\u6b64\u80fd\u6709\u975e\u5e38\u597d\u7684\u6548\u80fd</li> <li>Node\u662f\u7531\u958b\u6e90\u793e\u7fa4\u4f86\u5171\u540c\u7dad\u8b77,\u4e26\u4e14\u80fd\u4f7f\u7528\u6700\u65b0\u7684ECMAScript\u6a19\u6e96</li> <li>\u56e0\u6b64\u4e0d\u5fc5\u7b49\u5f85\u6240\u6709\u7528\u6236\u66f4\u65b0\u4ed6\u5011\u7684\u700f\u89bd\u5668,\u5c31\u53ef\u4ee5\u9078\u64c7\u8981\u4f7f\u7528\u7684Node\u7248\u672c\u4f86\u9054\u5230\u4f86\u6c7a\u5b9a\u8981\u4f7f\u7528\u54ea\u500bECMAScript\u7248\u672c</li> <li>\u53ef\u53c3\u8003\u5b98\u65b9\u6587\u4ef6ECMAScript 2015 (ES6) and beyond </li> <li>Node\u61c9\u7528\u7a0b\u5f0f\u5728\u55ae\u500b\u9032\u7a0b(single process)\u4e2d\u904b\u884c,\u7121\u9700\u70ba\u6bcf\u500b\u8acb\u6c42\u5efa\u7acb\u65b0\u7dda\u7a0b(thread),\u80fd\u8655\u7406\u6578\u5343\u500b\u4f75\u767c\u9023\u63a5(concurrent connections),\u4e5f\u4e0d\u6703\u56e0\u6b64\u800c\u589e\u52a0\u7ba1\u7406\u7dda\u7a0b(thread)\u4e0a\u7684\u8ca0\u64d4</li> <li>\u540c\u6642Node\u4e5f\u5728\u5176\u6a19\u6e96\u51fd\u5f0f\u5eab\u4e2d\u63d0\u4f9b\u4e86\u4e00\u7d44\u975e\u540c\u6b65I/O\u539f\u8a9e(asynchronous I/O primitives)\u4f86\u9632\u6b62Javascript\u7684\u7a0b\u5f0f\u78bc\u88ab\u963b\u585e\u4f4f,\u56e0\u6b64\u5728Node\u4e2d\u4f7f\u7528\u975e\u963b\u585e\u5f0f\u8a9e\u6cd5(non-blocking paradigms)\u4f86\u958b\u767c\u662f\u6b63\u5e38\u4e14\u666e\u904d\u7684</li> <li>\u7576Node\u57f7\u884c\u6703\u6709I/O\u7684\u64cd\u4f5c(e.g. \u5f9e\u7db2\u8def\u4e0a\u8b80\u53d6\u8cc7\u6599.\u5b58\u53d6\u8cc7\u6599\u5eabor\u6a94\u6848\u7cfb\u7d71)\u6642,Node\u6703\u81ea\u52d5\u5728response\u56de\u50b3\u6642\u624d\u6062\u5fa9\u64cd\u4f5c,\u800c\u4e0d\u662f\u7121\u6548\u5730\u963b\u64cb\u4f4f\u7dda\u7a0b\u548c\u6d6a\u8cbbCPU\u9031\u671f\u7b49\u5f85\u6642\u9593</li> <li>\u53d7\u60e0\u65bcnpm\u7684\u7c21\u55ae\u7d50\u69cb,\u5176\u4fc3\u4f7fNode\u751f\u614b\u7cfb\u53ef\u4ee5\u84ec\u52c3\u5730\u767c\u5c55,\u76ee\u524d\u5728npm\u4e0a\u5df2\u7d93\u6709\u8d85\u904e1,000,000\u500b\u958b\u6e90\u8edf\u9ad4&amp;\u5de5\u5177\u53ef\u4f9b\u4f7f\u7528</li> <li>Node.js\u7b97\u662f\u4e00\u500b\u4f4e\u968e\u7684\u5e73\u53f0,\u7136\u800c\u5728\u793e\u7fa4(community)\u4e0a\u6709\u6578\u5343\u500b\u51fd\u5f0f\u5eab\u8207\u597d\u7528\u7684\u6846\u67b6\u5efa\u69cb\u65bcNode.js\u4e4b\u4e0a</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const http = require('http');\n\nconst hostname = '127.0.0.1';\nconst port = process.env.PORT;\n\nconst server = http.createServer((req, res) =&gt; {\n  res.statusCode = 200\n  res.setHeader('Content-Type', 'text/plain')\n  res.end('Hello World!\\n')\n});\n\nserver.listen(port, hostname, () =&gt; {\n  console.log(`Server running at http://${hostname}:${port}/`)\n});\n</code></pre></li> <li>\u4ee5\u4e0a\u7a0b\u5f0f\u78bc\u6703\u5efa\u7acb\u4e00\u500b\u65b0\u7684http server\u4e26\u56de\u50b3,\u540c\u6642\u9019\u500bserver\u4e5f\u6703\u76e3\u807d\u6307\u5b9a\u7684port &amp; host name</li> <li>\u7576server\u6e96\u5099\u5c31\u7dd2\u6642,\u5c07\u57f7\u884ccallback function,\u5728\u9019\u6642\u4e5f\u6703\u901a\u77e5\u6211\u5011server\u6b63\u5728\u904b\u884c\u4e2d</li> <li>\u6bcf\u7576\u6536\u5230\u4e00\u500b\u65b0\u7684request\u6642,\u90fd\u6703\u547c\u53eb\u8a72request event,\u4e26\u63d0\u4f9b\u5169\u500b\u7269\u4ef6(objects)<ul> <li>\u8acb\u6c42\u7269\u4ef6(request): <code>http.IncomingMessage</code></li> <li>\u5b83\u6703\u63d0\u4f9brequest details </li> <li>\u56de\u61c9\u7269\u4ef6(response): <code>http.ServerResponse</code></li> <li>\u5b83\u6703\u7528\u4f86\u5c07data\u56de\u50b3\u7d66\u547c\u53ebrequest event\u7684\u90a3\u65b9</li> </ul> </li> <li>\u5728\u9019\u7a2e\u72c0\u6cc1\u4e0b, \u6211\u5011\u6703\u5c07\u72c0\u614b\u78bc\u8a2d\u5b9a\u70ba200,\u4ee5\u8868\u793a\u8a72request\u6210\u529f     =&gt; <code>res.statusCode = 200</code></li> <li>\u4e26\u8a2d\u5b9aContent-Type\u6a19\u982d     =&gt; <code>res.setHeader('Content-Type', 'text/plain')</code></li> <li>\u6700\u5f8c,\u6703\u95dc\u9589response,\u4e26\u5c07\u5167\u5bb9\u4f5c\u70ba\u53c3\u6578\u6dfb\u52a0\u5230res.end()\u4e2d     =&gt; <code>res.end('Hello World\\n')</code></li> </ul>"},{"location":"programming_language/nodejs/#a-brief-history-of-nodejs","title":"A brief history of Node.js","text":"<ul> <li>Node.js\u6700\u521d\u662f\u7531Ryan Lienhart Dahl,\u65bc2010/05\u6708\u521d\u6b21\u767c\u8868,\u76f8\u6bd4\u65bcJavascript(1995/12\u6708)\u8207\u7db2\u969b\u7db2\u8def\u7684\u8a95\u751f(1989\u5e74)\u4f86\u8aaa,\u5728\u6280\u8853\u9818\u57df\u4e2d,\u4e26\u4e0d\u7b97\u662f\u5f88\u9577\u7684\u6642\u9593,\u4f46\u76ee\u524d\u770b\u4f86Node\u6703\u6301\u7e8c\u5b58\u5728\u4e0b\u53bb</li> <li></li> <li></li> <li>\u53d7\u60e0\u65bc\u700f\u89bd\u5668\u7684\u6548\u80fd\u7af6\u722d\u6230(2003~2008\u5e74)\u5f8c\u7684\u7d50\u679c,\u5404\u5bb6\u700f\u89bd\u5668\u4f9b\u61c9\u5546\u722d\u76f8\u70ba\u7528\u6236\u63d0\u4f9b\u6700\u4f73\u6027\u80fd,Javscript engine\u7684\u904b\u884c\u6548\u80fd\u4e5f\u8d8a\u4f86\u8d8a\u597d,\u800cNode\u4f7f\u7528\u7684Chrome\u700f\u89bd\u5668\u7684Javascript engine---V8,\u5728\u6027\u80fd\u4e0a\u4e5f\u6709\u5353\u8d8a\u7684\u63d0\u5347</li> <li>\u53e6\u4e00\u500b\u4f7fNode\u5feb\u901f\u5d1b\u8d77\u7684\u95dc\u9375\u56e0\u7d20\u662fWeb2.0\u7684\u8a95\u751f,\u4f8b\u5982Flickr.Gmail\u7b49,\u8b93Javascript\u958b\u59cb\u88ab\u8996\u70ba\u4e00\u500b\u66f4\u70ba\u91cd\u8981\u7684\u7a0b\u5f0f\u8a9e\u8a00</li> <li>Node\u6070\u5de7\u662f\u5728\u6b63\u78ba\u7684\u6642\u9593\u548c\u6b63\u78ba\u7684\u6642\u9593\u69cb\u5efa\u7684,\u5b83\u70baJavaScript\u670d\u52d9\u5668\u7aef\u958b\u767c\u5f15\u5165\u4e86\u8a31\u591a\u5275\u65b0\u601d\u7dad\u548c\u65b9\u6cd5,\u9019\u4e9b\u65b9\u6cd5\u548c\u65b9\u6cd5\u5df2\u7d93\u70ba\u8a31\u591a\u958b\u767c\u4eba\u54e1\u63d0\u4f9b\u4e86\u5e6b\u52a9,\u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u5b83\u958b\u59cb\u6d41\u884c\u7684\u539f\u56e0</li> <li>Node.js \u7c21\u53f2(Change log)</li> <li>\u897f\u51432009\u5e74<ul> <li>Node.js\u8a95\u751f</li> <li>\u6700\u521d\u7248npm\u554f\u4e16</li> </ul> </li> <li>\u897f\u51432010\u5e74<ul> <li>Express.js\u6846\u67b6 \u8a95\u751f</li> <li>socket.io \u8a95\u751f</li> </ul> </li> <li>\u897f\u51432011\u5e74<ul> <li>npm \u767c\u5e031.0\u7248\u672c</li> <li>\u8a31\u591a\u5927\u578b\u516c\u53f8\u958b\u59cb\u63a1\u7528Node.js,\u4f8b:LinkedIn.Uber\u7b49</li> </ul> </li> <li>\u897f\u51432012\u5e74<ul> <li>\u8d8a\u4f86\u8d8a\u591a\u4eba\u958b\u59cb\u63a1\u7528Node.js</li> </ul> </li> <li>\u897f\u51432013\u5e74<ul> <li>\u7b2c\u4e00\u500b\u4f7f\u7528Node.js\u7684\u5927\u578b\u90e8\u843d\u683c\u5e73\u53f0: Ghost</li> <li>koa\u6846\u67b6 \u8a95\u751f</li> </ul> </li> <li>\u897f\u51432014\u5e74<ul> <li>\u91cd\u5927\u4e8b\u4ef6: io.js\u8a95\u751f,\u662fNode.js\u7684\u4e3b\u8981Fork\u51fa\u4f86\u7684\u5c08\u6848,\u76ee\u7684\u662f\u70ba\u4e86\u52a0\u5165Javascript\u7684ES6\u8a9e\u6cd5\u652f\u63f4\u4e26\u63d0\u5347\u4e86\u6548\u80fd </li> </ul> </li> <li>\u897f\u51432015\u5e74<ul> <li>Node.js\u57fa\u91d1\u6703\u8a95\u751f (\u76ee\u524d\u96b8\u5c6c\u65bcOpenJS Foundation\u65d7\u4e0b\u7684\u5176\u4e2d\u4e00\u500b\u5c08\u6848)</li> <li>io.js\u5408\u4f75\u56deNode.js\u5c08\u6848\u4e2d</li> <li>npm\u958b\u59cb\u63a8\u51fa\u79c1\u6709\u6a21\u7d44(private modules)</li> <li>Node.js 4\u767c\u5e03(\u76f4\u63a5\u8df3\u904eNode.js 1,2,3)</li> <li>\u53ef\u53c3\u8003Node_changelog</li> </ul> </li> <li>\u897f\u51432016\u5e74<ul> <li>kik\u6a21\u7d44\u7684left-pad\u4e8b\u4ef6\u7206\u767c,\u5f15\u8d77\u958b\u6e90\u793e\u7fa4\u7684\u4e00\u9663\u9a37\u52d5</li> <li>Yarn\u5957\u4ef6\u7ba1\u7406\u5305\u5de5\u5177 \u8a95\u751f</li> <li>Node.js 6\u767c\u5e03</li> </ul> </li> <li>\u897f\u51432017\u5e74<ul> <li>npm\u958b\u59cb\u66f4\u52a0\u6ce8\u91cd\u5b89\u5168\u6027</li> <li>Node.js 8\u767c\u5e03</li> <li>HTTP/2 \u6838\u5fc3\u6a21\u7d44 \u767c\u5e03</li> <li>V8\u5c07Node\u52a0\u5165\u5b83\u7684\u6e2c\u8a66\u5957\u4ef6\u4e2d,\u4f7fNode\u6210\u70ba\u7e7cChrome\u4e4b\u5f8c\u7684Javascript engine\u6b63\u5f0f\u76ee\u6a19</li> <li>\u9054\u621030\u5104\u6b21/\u9031\u7684\u4e0b\u8f09\u6d41\u91cf\u7d00\u9304</li> </ul> </li> <li>\u897f\u51432018\u5e74<ul> <li>Node.js 10\u767c\u5e03</li> <li>ES modules.mjs\u958b\u59cb\u52a0\u5165\u5be6\u9a57\u6027\u652f\u63f4(experimental support)</li> <li>Node.js 11\u767c\u5e03</li> </ul> </li> <li>\u897f\u51432019\u5e74<ul> <li>Node.js 12\u767c\u5e03  </li> <li>Node.js 13\u767c\u5e03</li> </ul> </li> <li>\u897f\u51432020\u5e74<ul> <li>Node.js 14\u767c\u5e03</li> <li>Node.js 15\u767c\u5e03</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#how-to-install-nodejs","title":"How to install Node.js?","text":"<ul> <li>Node\u6709\u5f88\u591a\u7a2e\u5b89\u88dd\u65b9\u5f0f,\u6700\u5e38\u898b\u7684\u65b9\u5f0f\u662f\u900f\u904e\u5957\u4ef6\u7ba1\u7406\u5305(package manager)\u4e0b\u8f09,\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b,\u6bcf\u500b\u4f5c\u696d\u7cfb\u7d71\u6709\u81ea\u5df1\u7684\u5b89\u88dd\u65b9\u5f0f</li> <li>\u53ef\u53c3\u8003 \u5b89\u88dd\u65b9\u5f0f \u7684\u7ae0\u7bc0</li> <li>NVM(Node Version Manager)\u662f\u4e00\u7a2e\u57f7\u884cNode.js\u7684\u6d41\u884c\u65b9\u6cd5</li> <li>nvm\u8b93\u6211\u5011\u53ef\u4ee5\u8f15\u9b06\u5207\u63dbNode\u7248\u672c</li> <li>\u5047\u5982\u78b0\u5230\u932f\u8aa4\u6642,\u53ef\u4ee5\u5b89\u88dd\u65b0\u7248\u672c\u4ee5\u5617\u8a66\u8f15\u9b06\u5730\u56de\u6efe(rollback)</li> <li>nvm\u4e5f\u662f\u500b\u6709\u6548\u7684\u5de5\u5177\u8b93\u6211\u5011\u53ef\u4ee5\u8f15\u9b06\u5730\u4f7f\u7528Node\u7684\u820a\u7248\u672c\u4f86\u6e2c\u8a66\u6211\u5011\u7684\u7a0b\u5f0f\u78bc</li> <li>\u53ef\u53c3\u8003Node Version Manager(nvm)</li> <li>\u5982\u679c\u4f7f\u7528macOS,\u63a8\u85a6\u4f7f\u7528Homebrew\u4f86\u5b89\u88ddNode</li> <li>\u7576\u5b89\u88dd\u5b8cNode\u4e4b\u5f8c,\u5c31\u53ef\u4ee5\u4f7f\u7528<code>$ node xxx.js</code>\u5728CLI\u4e2d\u57f7\u884cNode\u7a0b\u5f0f</li> </ul>"},{"location":"programming_language/nodejs/#how-much-javascript-do-you-need-to-know-to-use-nodejs","title":"How much JavaScript do you need to know to use Node.js?","text":"<ul> <li>\u8eab\u70ba\u4e00\u500b\u521d\u5b78\u8005,\u6211\u5011\u5e38\u5e38\u96e3\u4ee5\u5224\u65b7\u8981\u5230\u4ec0\u9ebc\u6a23\u7684\u7a0b\u5ea6\u624d\u662f\u5c0d\u7a0b\u5f0f\u8a2d\u8a08\u7684\u80fd\u529b\u8db3\u5920\u6709\u81ea\u4fe1\u7684</li> <li>\u7576\u6211\u5011\u525b\u958b\u59cb\u5b78\u7fd2Javascript,\u6211\u5011\u53ef\u80fd\u6703\u5c0dJavascript\u7684\u7d50\u675f\u4f4d\u7f6e,\u4ee5\u53caNode\u7684\u8d77\u59cb\u4f4d\u7f6e\u8207\u7d50\u675f\u4f4d\u7f6e\u611f\u5230\u5f88\u56f0\u60d1</li> <li>\u5efa\u8b70\u5148\u7406\u89e3Javascript\u7684\u4e3b\u8981\u89c0\u5ff5\u5f8c,\u5728\u958b\u59cb\u6295\u5165\u65bcNode\u7684\u7814\u7a76\u4e2d</li> <li>\u4ee5\u4e0b\u662fJavascript\u76ee\u524d\u7684\u4e3b\u8981\u89c0\u5ff5</li> <li>\u8a5e\u5f59\u7d50\u69cb(Lexcial Structure)</li> <li>\u904b\u7b97\u5f0f(Expressions)</li> <li>\u578b\u5225(Types)</li> <li>\u8b8a\u6578(Variables)</li> <li>\u51fd\u5f0f(Functions)</li> <li><code>this</code> \u95dc\u9375\u5b57</li> <li>\u7bad\u982d\u51fd\u5f0f(Arrow Functions)</li> <li>\u8ff4\u5708(Loops)</li> <li>\u7bc4\u570d(Scopes)</li> <li>\u9663\u5217(Arrays)</li> <li>\u6a21\u677f\u6587\u5b57(Template Literals)</li> <li>\u5206\u865f(Semicolons)</li> <li>\u56b4\u8b39\u6a21\u5f0f(Strict Mode)</li> <li>ECMAScript 6,7,8 (\u624b\u7a3f\u8a9e\u8a00\u898f\u7bc4)</li> <li>\u5982\u679c\u80fd\u5c07\u4ee5\u4e0a\u7684Javascript\u4e3b\u8981\u89c0\u5ff5\u90fd\u638c\u63e1\u5230\u7684\u8a71,\u7121\u8ad6\u662f\u5728\u700f\u89bd\u5668\u9084\u662f\u5728Node\u4e2d,\u60a8\u90fd\u5c07\u6210\u70ba\u4e00\u540d\u719f\u7df4\u7684JavaScript\u958b\u767c\u4eba\u54e1</li> <li>\u4ee5\u4e0b\u662f\u7406\u89e3 \u975e\u540c\u6b65\u7a0b\u5f0f\u8a2d\u8a08 \u7684(asynchronous programming),\u9019\u4e5f\u662fNode.js\u7684\u57fa\u672c\u89c0\u5ff5\u4e4b\u4e00</li> <li>\u975e\u540c\u6b65\u7a0b\u5f0f\u8a2d\u8a08\u8207\u56de\u547c (Asynchronous programming and callbacks)</li> <li>\u8a08\u6642\u5668 (Timers)</li> <li>Promise\u7269\u4ef6 (ES6\u4ee5\u5f8c\u958b\u59cb\u52a0\u5165\u7684\u8a9e\u6cd5)</li> <li>Async &amp; Await</li> <li>\u9589\u5305(Closures)</li> <li>\u4e8b\u4ef6\u8ff4\u5708 (The Event Loop)</li> </ul>"},{"location":"programming_language/nodejs/#differences-between-nodejs-and-the-browser","title":"Differences between Node.js and the Browser","text":"<ul> <li>\u700f\u89bd\u5668\u8207Node.js\u90fd\u662f\u4f7f\u7528Javascript\u7a0b\u5f0f\u8a9e\u8a00\u4f86\u958b\u767c\u7684</li> <li>\u5efa\u69cb\u51fa\u4e00\u500b\u904b\u884c\u5728\u700f\u89bd\u5668\u7684\u61c9\u7528\u7a0b\u5f0f\u8207\u5efa\u69cb\u51fa\u4e00\u500b\u904b\u884c\u5728Node\u7684\u61c9\u7528\u7a0b\u5f0f\u5b8c\u5168\u4e0d\u540c; \u5118\u7ba1\u90fd\u662f\u4f7f\u7528Javascript\u7a0b\u5f0f\u8a9e\u8a00\u4f86\u958b\u767c,\u537b\u4ecd\u5b58\u5728\u4e00\u4e9b\u95dc\u9375\u5dee\u7570,\u4f7f\u9ad4\u9a57\u5b8c\u5168\u4e0d\u540c</li> <li>Node\u6539\u8b8a\u7684\u662f\u6574\u500b\u751f\u614b\u7cfb\u7d71(ecosystem),\u56e0\u70ba\u5b83\u8b93\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u4e00\u7a2e\u7a0b\u5f0f\u8a9e\u8a00-Javascript,\u5c31\u53ef\u4ee5\u5b8c\u6210\u6211\u5011\u6240\u6709\u7684\u7db2\u9801\u958b\u767c\u5de5\u4f5c(\u5305\u542b\u524d\u7aef &amp; \u5f8c\u7aef),\u9019\u662f\u4e00\u500b\u7368\u7279\u7684\u512a\u52e2\u5730\u4f4d</li> <li>\u5728\u700f\u89bd\u5668\u4e2d,\u6211\u5011\u82b1\u8cbb\u5927\u591a\u6578\u7684\u6642\u9593\u5728\u8207DOM\u6216\u662f\u5176\u4ed6\u7db2\u9801\u5e73\u53f0\u7684APIs(\u4f8b: Cookies)\u3002 \u7576\u7136,\u9019\u4e9b\u6771\u897f\u4e26\u4e0d\u5b58\u5728\u65bcNode\u4e4b\u4e2d\u3002Node\u4e5f\u4e0d\u6703\u6709Document\u7269\u4ef6\u8207Window\u7269\u4ef6\u4ee5\u53ca\u5176\u4ed6\u6240\u6709\u900f\u904e\u700f\u89bd\u5668\u63d0\u4f9b\u7684\u7269\u4ef6\u5011</li> <li>\u5728\u700f\u89bd\u5668\u4e2d,\u6211\u5011\u6c92\u6709\u90a3\u4e9bNode\u900f\u904e\u5176\u5167\u5efa\u6a21\u7d44\u6240\u63d0\u4f9b\u7684\u5be6\u7528APIs(\u4f8b: \u6587\u4ef6\u7cfb\u7d71\u8a2a\u554f\u529f\u80fd (filesystem access functionality))</li> <li>\u53e6\u4e00\u500b\u6bd4\u8f03\u5927\u7684\u5dee\u7570\u662f\u5728Node\u4e2d,\u6211\u5011\u63a7\u5236\u7684\u662f \u74b0\u5883,\u9664\u975e\u60a8\u69cb\u5efa\u4e00\u500b\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u90e8\u7f72\u7684\u958b\u6e90\u61c9\u7528\u7a0b\u5f0f,\u5426\u5247\u6211\u5011\u901a\u5e38\u6703\u77e5\u9053\u61c9\u8a72\u5728\u54ea\u500b\u7248\u672c\u7684Node\u4e0a\u904b\u884c\u8a72\u61c9\u7528\u7a0b\u5f0f; \u4f46\u662f\u5728\u700f\u89bd\u5668\u7684\u74b0\u5883\u4e2d,\u6211\u5011\u7121\u6cd5\u9078\u64c7\u4f7f\u7528\u8005\u6703\u4f7f\u7528\u7684\u700f\u89bd\u5668,\u9019\u9ede\u975e\u5e38\u4e0d\u65b9\u4fbf</li> <li>\u9019\u4e5f\u610f\u5473\u8457\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u8a72Node\u7248\u672c\u53ef\u652f\u63f4\u7684\u6240\u6709ECMAScript 6-7-8-9\u7684\u73fe\u4ee3\u5316Javascript\u8a9e\u6cd5</li> <li>\u7531\u65bcJavascript\u7684\u8b8a\u5316\u5982\u6b64\u4e4b\u5feb,\u4f46\u662f\u700f\u89bd\u5668\u8207\u4f7f\u7528\u8005\u6240\u4f7f\u7528\u7684\u700f\u89bd\u5668\u4e26\u6c92\u6709\u9019\u9ebc\u8fc5\u901f\u7684\u5347\u7d1a,\u56e0\u6b64\u6211\u5011\u4e0d\u5f97\u4e0d\u4f7f\u7528\u8f03\u820a\u7684JavaScript/ECMAScript\u7248\u672c</li> <li>\u9019\u6642\u6211\u5011\u53ef\u4ee5\u4f7f\u7528Babel\u4f86\u5c07\u7a0b\u5f0f\u78bc\u8f49\u63db\u6210\u53ef\u8207ES5\u53ef\u76f8\u5bb9\u7684\u8a9e\u6cd5,\u7136\u5f8c\u518d\u4ea4\u7d66\u700f\u89bd\u5668</li> <li>\u7136\u800c\u5728Node\u4e2d,\u6211\u5011\u4e26\u4e0d\u9700\u8981\u9019\u6a23\u505a</li> <li>\u9084\u6709\u4e00\u500b\u91cd\u5927\u7684\u5dee\u7570\u662f\u5728Node\u4e2d,\u6211\u5011\u4f7f\u7528\u7684\u662fCommonJS\u6a21\u7d44\u7cfb\u7d71; \u4f46\u662f\u5728\u700f\u89bd\u5668\u4e2d,\u6211\u5011\u6703\u4f9d\u7167ECMAScript\u7684\u6a21\u7d44\u6a19\u6e96\u4f86\u5be6\u4f5cJavascipt\u8a9e\u6cd5</li> <li>\u5be6\u969b\u4e0a,\u9019\u4ee3\u8868\u6211\u5011\u6703\u5206\u5225\u4f7f\u7528<ul> <li>require() =&gt; \u5728Node.js\u4e2d</li> <li>import =&gt; \u5728\u700f\u89bd\u5668\u4e2d</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-v8-javascript-engine","title":"The V8 JavaScript Engine","text":"<ul> <li>V8\u662f\u7528\u4f86\u652f\u6301Google Chrome\u700f\u89bd\u5668\u7684Javascript engine\u3002\u7576\u6211\u5011\u4f7f\u7528Chrome\u700f\u89bd\u5668\u6642,\u5b83\u9700\u8981\u6211\u5011\u7684Javascript\u7a0b\u5f0f\u78bc\u4e26\u57f7\u884c\u5b83\u5011 </li> <li>V8\u8ca0\u8cac\u63d0\u4f9bJavascript\u57f7\u884c\u6642\u6240\u9700\u8981\u7684\u57f7\u884c\u74b0\u5883(runtime)\u3002<code>DOM</code>\u548c\u5176\u4ed6\u7684Web APIs\u5247\u7531\u700f\u89bd\u5668\u8ca0\u8cac\u63d0\u4f9b</li> <li>Javascript engine\u662f\u80fd\u7368\u7acb\u904b\u4f5c\u7684,\u4e26\u4e0d\u4e00\u5b9a\u9700\u8981\u8ddf\u96a8\u8457\u8a17\u7ba1(hosted)\u5b83\u7684\u700f\u89bd\u5668,\u9019\u4e5f\u4fc3\u4f7fNode\u7684\u8208\u8d77</li> <li>\u897f\u51432009\u5e74\u6642,V8\u88ab\u9078\u70ba\u7528\u4f86\u4f5c\u70baNode.js\u7684Javascript engine,\u4e26\u4e14\u96a8\u8005Node\u7684\u7206\u70b8\u6027\u6210\u9577,V8\u6210\u70ba\u4e86\u73fe\u5728\u70ba\u5927\u91cf\u4f7f\u7528Javascript\u7de8\u5beb\u4f3a\u670d\u5668\u7aef\u7a0b\u5f0f\u78bc(server-side code)\u7684engine</li> <li>Node\u751f\u614b\u7cfb\u975e\u5e38\u9f90\u5927,\u53d7\u60e0\u65bc\u6b64,V8\u4e5f\u652f\u63f4\u684c\u9762\u61c9\u7528\u7a0b\u5f0f(\u4f8b: Electron)</li> <li>\u5176\u4ed6\u700f\u89bd\u5668\u4f7f\u7528\u7684Javascript engine</li> <li>Firefox: SpiderMonkey</li> <li>Safari: JavaScriptCore(\u4e5f\u88ab\u7a31\u70baNitro)</li> <li>Microsoft Edge: \u6700\u521d\u662f\u57fa\u65bcChakraCore\u958b\u767c\u7684,\u5f8c\u4f86\u8f49\u7531\u57fa\u65bcChromium &amp; V8 engine\u4f86\u91cd\u69cb<ul> <li>\u53ef\u53c3\u8003Download the new Microsoft Edge based on Chromium </li> </ul> </li> <li>V8\u5f15\u64ce\u662f\u7531C++\u7a0b\u5f0f\u8a9e\u8a00\u6240\u7de8\u5beb\u3002\u5b83\u662f\u53ef\u651c\u5e36\u5f0f\u7684(portable),\u53ef\u63d0\u4f9b\u8de8\u5e73\u53f0\u652f\u63f4(on macOS &amp;Windows &amp; Linux ...\u7b49\u7b49)</li> <li>V8\u4e5f\u8207\u5176\u4ed6\u7684Javascript engine\u4e00\u6a23,V8\u4e5f\u5728\u6301\u7e8c\u6539\u9032\u4e2d,\u4e5f\u52a0\u901f\u4e86Web\u548cNode\u751f\u614b\u7cfb\u7684\u5feb\u901f\u767c\u5c55; \u591a\u5e74\u4f86,\u5728\u7db2\u8def\u4e0a\u6709\u5f88\u591a\u95dc\u65bc\u6027\u80fd\u8abf\u6821\u7684\u7af6\u8cfd,\u8eab\u70ba\u958b\u767c\u8005\u548c\u4f7f\u7528\u8005\u7684\u6211\u5011\u4e5f\u53d7\u60e0\u65bc\u6b64,\u8b93\u6211\u5011\u80fd\u64c1\u6709\u66f4\u5feb.\u6548\u80fd\u66f4\u597d\u7684\u6a5f\u5668(machines)\u53ef\u4ee5\u4f7f\u7528</li> <li>Javascript\u901a\u5e38\u88ab\u8a8d\u70ba\u662f\u4e00\u7a2e\u76f4\u8b6f\u5f0f\u8a9e\u8a00(interpreted language),\u4f46\u662f\u5728\u73fe\u4ee3\u5316\u7684Javascript engine\u4e2d,\u5df2\u4e0d\u518d\u53ea\u662f\u76f4\u8b6fJavascript,\u5b83\u5011\u4e5f\u7de8\u8b6fJavascript</li> <li>\u5f9e\u897f\u51432009\u5e74\u958b\u59cb,\u7576SpiderMonkey JavaScript compiler\u88ab\u52a0\u5165\u5230Firefox\u700f\u89bd\u5668 v3.5\u4e4b\u4e2d\u4ee5\u5f8c,\u6bcf\u500b\u4eba\u90fd\u958b\u59cb\u8ffd\u96a8\u9019\u7a2e\u505a\u6cd5</li> <li>Javascript\u6703\u88abV8 engine\u9032\u884c\u5167\u90e8\u5373\u6642\u7de8\u8b6f(just-in-time compilation, JIT)\u4ee5\u52a0\u5feb\u57f7\u884c\u901f\u5ea6; \u9019\u53ef\u80fd\u662f\u4e00\u7a2e\u9055\u53cd\u76f4\u89ba\u7684\u65b9\u5f0f,\u4f46\u662f\u5f9e2004\u5e74\u5f15\u5165Google Maps\u4ee5\u4f86,Javascript\u5df2\u7d93\u5f9e\u4e00\u7a2e\u901a\u5e38\u7528\u4f86\u57f7\u884c\u5e7e\u5341\u884c\u7a0b\u5f0f\u78bc\u7684\u5c0f\u578b\u61c9\u7528\u7a0b\u5f0f\u7684\u7a0b\u5f0f\u8a9e\u8a00,\u9010\u6f38\u767c\u5c55\u6210\u53ef\u4ee5\u5728\u700f\u89bd\u5668\u4e2d\u57f7\u884c\u6210\u5343\u4e0a\u842c\u884c\u7684\u5927\u578b.\u5b8c\u6574\u7684\u61c9\u7528\u7a0b\u5f0f\u7684\u7a0b\u5f0f\u8a9e\u8a00</li> <li>\u6f14\u8b8a\u81f3\u4eca,\u6211\u5011\u7684\u61c9\u7528\u7a0b\u5f0f\u5df2\u7d93\u53ef\u4ee5\u5728\u700f\u89bd\u5668\u6301\u7e8c\u57f7\u884c\u6578\u5c0f\u6642,\u800c\u9019\u4e5f\u4e0d\u50c5\u9650\u65bc\u55ae\u7d14\u7684\u8868\u55ae\u9a57\u8b49\u898f\u5247(a few form validation rules)\u6216\u662f\u7c21\u55ae\u7684\u7a0b\u5f0f\u78bc(simple scripts)</li> <li>\u5728\u73fe\u4ee3\u7684\u65b0\u4e16\u754c\u4e2d,\"\u7de8\u8b6f\"Javascript\u662f\u975e\u5e38\u6709\u610f\u7fa9\u7684,\u56e0\u70ba\u96d6\u7136\u7de8\u5bebJavascript\u4ecd\u7136\u9700\u8981\u82b1\u8cbb\u5f88\u591a\u6642\u9593,\u4f46\u662f\u4e00\u65e6\u958b\u767c\u5b8c\u6210\u5f8c,\u5b83\u5c07\u6bd4\u8d77\u7d14\u76f4\u8b6f\u7a0b\u5f0f\u78bc\u4f86\u7684\u64c1\u6709\u66f4\u597d\u7684\u6548\u80fd</li> </ul>"},{"location":"programming_language/nodejs/#run-nodejs-scripts-from-the-command-line","title":"Run Node.js scripts from the command line","text":"<ul> <li>\u7576\u6211\u5011\u5b89\u88dd\u597dNode.js\u5f8c,\u901a\u5e38\u6211\u5011\u6703\u7528\u53ef\u5728\u5168\u57df\u57f7\u884c\u7684<code>node</code>\u6307\u4ee4,\u63a5\u8457\u50b3\u905e\u8981\u57f7\u884c\u7684\u6a94\u540d\u4f5c\u70ba\u53c3\u6578\u5230CLI\u4e0a</li> <li>\u5047\u8a2d\u6211\u5011\u7684\u4e3b\u8981Node\u61c9\u7528\u7a0b\u5f0f\u7684\u6a94\u540d\u53eb\u505a<code>app.js</code> </li> <li>\u4f8b: $ <code>node app.js</code></li> <li>\u63d0\u9192: \u8981\u5728\u5305\u542b<code>app.js</code>\u7684\u6a94\u6848\u8def\u5f91\u4e0b\u57f7\u884c\u8a72\u6307\u4ee4\u624d\u884c</li> </ul>"},{"location":"programming_language/nodejs/#how-to-exit-from-a-nodejs-program","title":"How to exit from a Node.js program?","text":"<ul> <li>\u6709\u591a\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u7d42\u6b62Node\u61c9\u7528\u7a0b\u5f0f</li> <li>CLI: $ <code>ctrl-C</code></li> <li>\u7a0b\u5f0f\u78bc: <code>process.exit()</code></li> <li>\u7a0b\u5f0f\u78bc: <code>process.on('SIGTERM', callback function)</code></li> <li>Node\u7684\u6838\u5fc3\u6a21\u7d44-Process\u63d0\u4f9b\u4e86\u4e00\u500b\u7c21\u4fbf\u7684\u65b9\u6cd5,\u8b93\u6211\u5011\u53ef\u4ee5\u5f9e\u4e00\u500bNode\u61c9\u7528\u7a0b\u5f0f\u9000\u51fa,\u53ef\u57f7\u884c\u4ee5\u4e0b\u7684command</li> <li>$ <code>process.exit()</code></li> <li>\u7576Node\u57f7\u884c\u5230\u9019\u908a\u6642,\u8a72\u9032\u7a0b(process)\u5c31\u6703\u88ab\u7acb\u5373\u5f37\u5236\u7d42\u6b62\u3002\u9019\u4ee3\u8868\u4efb\u4f55\u8655\u65bc<code>pending\u72c0\u614b</code>\u7684<code>callback function</code>\u8207\u4efb\u4f55\u7db2\u8def\u8acb\u6c42(network request)\u4ecd\u7136\u6703\u88ab\u50b3\u9001\u51fa\u53bb; \u7136\u800c\u4efb\u4f55\u8a2a\u554f\u6587\u4ef6\u7cfb\u7d71(<code>filesystem</code>)\u6216\u662f\u9032\u7a0b(<code>process</code>),\u4f8b\u5982: process.stdout() \u6216\u662f process.stderr\u90fd\u5c07\u7acb\u523b\u88ab\u4e0d\u6b63\u5e38\u5730\u7d42\u6b62(ungracefully terminated right away.)</li> <li>\u5982\u679c\u9019\u6a23\u662f\u6211\u5011\u60f3\u8981\u7684\u7d50\u679c,\u90a3\u6211\u5011\u53ef\u4ee5\u50b3\u905e\u4e00\u500b\u6574\u6578,\u4ee5\u6b64\u4f5c\u70ba\u50cf\u4f5c\u696d\u7cfb\u7d71\u767c\u51fa\u7684\u9000\u51fa\u78bc(exit code)<ul> <li>\u4f8b: $ <code>process.exit(1)</code></li> <li>\u88dc\u5145: \u9000\u51fa\u78bc(exit code)</li> <li>\u9810\u8a2d\u503c: <code>0</code> (\u4ee3\u8868\u6210\u529f) </li> <li>\u7576<code>exit code</code> &lt;= 0 \u6642,\u8868\u793a\u6307\u4ee4\u57f7\u884c\u6210\u529f</li> <li>\u7576<code>exit code</code> &gt; 0 \u6642,\u8868\u793a\u6307\u4ee4\u57f7\u884c\u5931\u6557</li> <li>\u4e0d\u540c\u7684\u9000\u51fa\u78bc\u5177\u6709\u4e0d\u540c\u7684\u610f\u7fa9,\u6211\u5011\u53ef\u4ee5\u5229\u7528\u9019\u4e9b\u9000\u51fa\u78bc\u4f86\u8b93\u6211\u5011\u7cfb\u7d71\u4e2d\u7684\"\u7a0b\u5f0f\u8207\u7a0b\u5f0f\"\u4e4b\u9593\u80fd\u4e92\u76f8\u6e9d\u901a</li> <li>\u53ef\u53c3\u8003Node\u6838\u5fc3\u6a21\u7d44-Process\u7684 Exit codes \u7ae0\u7bc0</li> </ul> </li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u8a2d\u5b9aprocess.exitCode\u5c6c\u6027\u4f86\u6307\u5b9a\u7576Node\u61c9\u7528\u7a0b\u5f0f\u9000\u51fa\u6642,\u8981\u56de\u50b3\u4ec0\u9ebc\u9000\u51fa\u78bc<ul> <li>\u4f7f\u7528process.exitCode\u7684\u60c5\u5883,\u9700\u6eff\u8db3\u4ee5\u4e0b\u689d\u4ef6</li> <li>\u7576\u4f7f\u7528process.exit([code]) -&gt; \u4e14\u672a\u6307\u5b9a\u9000\u51fa\u78bc\u6642</li> <li>\u9032\u7a0b(process)\u6b63\u5e38\u5730\u7d42\u6b62(exits gracefully)\u6642</li> <li>\u4f8b: $ <code>process.exitCode = 1</code></li> <li>\u7576Node\u61c9\u7528\u7a0b\u5f0f\u7d42\u6b62\u6642,\u5c07\u6703return\u8a72\u9000\u51fa\u78bc,\u5728\u5b8c\u6210\u8655\u7406\u6240\u6709\u9032\u7a0b(process)\u5f8c,Node\u61c9\u7528\u7a0b\u5f0f\u5c07\u6703\u6b63\u5e38\u5730\u9000\u51fa</li> <li>\u53ef\u4ee5\u5229\u7528<code>process.exit([code])</code>\u4f86\u63a8\u7ffb\u6389(override)\u5148\u524d\u7684<code>process.exitCode</code>\u7684\u8a2d\u5b9a\u503c</li> </ul> </li> <li>\u53e6\u4e00\u7a2e\u5e38\u898b\u7684\u60c5\u6cc1\u662f\u7576\u6211\u5011\u555f\u52d5\u4e00\u500b\u4f3a\u670d\u5668,\u4f8b\u5982: HTTP server       JavaScript<pre><code>const express = require('express')\nconst app = express()\n\napp.get('/', (req, res) =&gt; {\n  res.send('Hi!')\n})\n\napp.listen(3000, () =&gt; console.log('Server ready'))\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u6c38\u9060\u4e0d\u6703\u7d42\u6b62! \u5982\u679c\u6211\u5011\u547c\u53eb<code>process.exit()</code>,\u9019\u6642\u6b63\u5728\u8655\u7406\u7684pending\u8207running request\u90fd\u5c07\u88ab\u7d42\u6b62,\u800c\u9019\u4e0d\u662f\u4e00\u500b\u597d\u7684\u505a\u6cd5</li> <li>\u9019\u6642\u5019\u6bd4\u8f03\u597d\u7684\u89e3\u6c7a\u65b9\u6cd5\u662f\u5c0d\u8a72command\u767c\u51fa<code>SIGTERM</code>\u4fe1\u865f(signal),\u4e26\u4f7f\u7528process\u6a21\u7d44\u7684signal handler\u4f86\u9032\u884c\u8655\u7406</li> <li>\u53ef\u53c3\u8003Signal events JavaScript<pre><code>const express = require('express')\nconst app = express()\napp.get('/', (req, res) =&gt; {\n  res.send('Hi!')\n})\n\nconst server = app.listen(3000, () =&gt; console.log('Server ready'))\n\nprocess.on('SIGTERM', () =&gt; {\n  server.close(() =&gt; {\n    console.log('Process terminated')\n  })\n})\n</code></pre> <p>Q: \u4ec0\u9ebc\u662f\u4fe1\u865f(signals)?   A: \u4fe1\u865f\u662fPOSIX\u7684\u76f8\u4e92\u901a\u8a0a\u7cfb\u7d71: \u7576\u901a\u77e5(notification)\u88ab\u767c\u9001\u5230\u4e00\u500b\u9032\u7a0b(process),\u4ee5\u4fbf\u5c07\u767c\u751f\u7684\u4e8b\u4ef6(event)\u901a\u77e5\u7d66\u9032\u7a0b(process)</p> </li> <li><code>SIGKILL</code>\u662f\u544a\u8a34\u9032\u7a0b(process)\u7acb\u5373\u4e2d\u6b62\u7684\u4fe1\u865f</li> <li><code>SIGTERM</code>\u662f\u544a\u8a34\u9032\u7a0b(process)\u6b63\u5e38\u7d42\u6b62\u7684\u4fe1\u865f\u3002\u9019\u662f\u5f9e\u4f8b\u5982upstart &amp; supervisored\u7b49\u5176\u4ed6\u6d41\u7a0b\u7ba1\u7406\u5de5\u5177\u767c\u51fa\u7684\u4fe1\u865f</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u5728\u61c9\u7528\u7a0b\u5f0f\u4e2d\u7684\u53e6\u4e00\u500b\u51fd\u5f0f\u4e2d,\u767c\u51fa\u9019\u500b\u4fe1\u865f</li> <li>$ <code>process.kill(process.pid, 'SIGTERM')</code></li> <li>\u4e5f\u53ef\u4ee5\u5f9e\u5176\u4ed6\u57f7\u884c\u4e2d\u7684Node\u61c9\u7528\u7a0b\u5f0for\u5176\u4ed6\u5728\u6211\u5011\u7684\u4f5c\u696d\u7cfb\u7d71\u4e2d\u6b63\u5728\u57f7\u884c\u7684\u61c9\u7528\u7a0b\u5f0f,\u4f86\u5f97\u77e5\u6211\u5011\u60f3\u8981\u7d42\u6b62\u7684\u61c9\u7528\u7a0b\u5f0f\u7684ID(process ID, pid)</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#how-to-read-environment-variables-from-nodejs","title":"How to read environment variables from Node.js?","text":"<ul> <li><code>process</code>\u6838\u5fc3\u6a21\u7d44\u63d0\u4f9b\u4e86<code>env</code>\u5c6c\u6027,<code>process.env</code>\u5c6c\u6027\u6703\u8a17\u7ba1\u7576\u555f\u52d5Node\u9032\u7a0b(process)\u7684\u6642\u5019\u7684\u6240\u6709Node\u74b0\u5883\u8b8a\u6578</li> <li>\u4ee5\u4e0b\u662f\u4e00\u500b\u9810\u8a2d\u5728<code>development</code>\u74b0\u5883\u4e0b,\u5b58\u53d6<code>NODE_ENV</code>\u9019\u500b\u74b0\u5883\u8b8a\u6578\u7684\u7bc4\u4f8b</li> <li>\u63d0\u9192: \u56e0\u70ba\u5b83\u662fNode\u7684\u6838\u5fc3\u6a21\u7d44,\u6240\u4ee5<code>process</code>\u6a21\u7d44\u4e0d\u9700\u8981\u4e8b\u5148\u532f\u5165(<code>require()</code>),\u53ef\u4ee5\u76f4\u63a5\u958b\u59cb\u4f7f\u7528     JavaScript<pre><code>process.env.NODE_ENV // \"development\"\n</code></pre></li> <li>\u7576\u5728\u8173\u672c(script)\u57f7\u884c\u4e4b\u524d,\u53ef\u4ee5\u5148\u5c07\u8a72\u5c6c\u6027\u8a2d\u5b9a\u70ba<code>production</code>,\u4f86\u544a\u8a34Node\u9019\u662f\u4e00\u500b<code>production</code>\u7684\u751f\u7522\u74b0\u5883     JavaScript<pre><code>process.env.NODE_ENV // \"production\"\n</code></pre></li> <li>\u7576\u7136\u6211\u5011\u4e5f\u53ef\u4ee5\u5229\u7528\u4e0a\u8ff0\u7684\u65b9\u5f0f\u518d\u8a2d\u5b9a\u6211\u5011\u9700\u8981\u7684\u81ea\u5b9a\u7fa9\u74b0\u5883\u8b8a\u6578</li> </ul>"},{"location":"programming_language/nodejs/#how-to-use-the-nodejs-repl","title":"How to use the Node.js REPL?","text":"<ul> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528$ <code>node</code>\u6307\u4ee4\u4f86\u57f7\u884c\u6211\u5011\u5beb\u597d\u7684Node\u8173\u672c(script)</li> <li>\u4f8b: $ <code>node script.js</code></li> <li>\u5982\u679c\u6211\u5011\u7701\u7565\u8981\u57f7\u884c\u7684\u8173\u672c\u540d\u7a31\u9019\u500b\u53c3\u6578\u7684\u8a71,\u5c31\u6703\u9032\u5165<code>REPL\u6a21\u5f0f</code> <p>\u88dc\u5145: <code>REPL</code>\u53c8\u88ab\u7a31\u70baRead Evaluate Print Loop(\u8b80\u53d6-\u6c42\u503c-\u8f38\u51fa\u5faa\u74b0\u7684\u4e92\u52d5\u5f0f\u4ecb\u9762, REPL),\u662f\u4e00\u7a2e\u7a0b\u5f0f\u8a9e\u8a00\u7684\u74b0\u5883(\u4e3b\u8981\u662f\u5728CLI console\u756b\u9762\u4e2d)\u3002\u4ed6\u6703\u4f7f\u7528\u55ae\u500b\u8868\u9054\u5f0f\u4f5c\u70ba\u4f7f\u7528\u8005\u8f38\u5165,\u4e26\u5728\u57f7\u884c\u5f8c\u5c07\u7d50\u679c\u56de\u50b3\u5230CLI console\u756b\u9762\u4e0a \u88dc\u5145: <code>REPL\u6a21\u5f0f</code>\u56e0\u70ba\u662f\u4e92\u52d5\u5f0f\u4ecb\u9762,\u6240\u4ee5\u652f\u63f4\u53ef\u5229\u7528<code>Tab</code>\u9375\u505a\u81ea\u52d5\u88dc\u5168(autocomplete)\u7684\u529f\u80fd,\u5b83\u6703\u5617\u8a66\u81ea\u52d5\u5b8c\u6210\u6240\u5beb\u7684\u5167\u5bb9,\u4ee5\u5339\u914d\u5df2\u5b9a\u7fa9\u7684\u8b8a\u91cf\u6216\u9810\u5b9a\u7fa9\u7684\u8b8a\u91cf</p> </li> <li>node <code>REPL\u6a21\u5f0f</code>\u7bc4\u4f8b\u60c5\u5883     Bash Session<pre><code>\u276f node\n&gt;\n</code></pre><ul> <li>\u8a72\u6307\u4ee4\u6703\u505c\u7559\u5728\u9592\u7f6e\u6a21\u5f0f(idle mode),\u4e26\u7b49\u5f85\u6211\u5011\u8f38\u5165\u4e9b\u4ec0\u9ebc\u6771\u897f\u3002\u66f4\u7cbe\u78ba\u5730\u8aaa\u662f<code>REPL\u6a21\u5f0f</code>\u6b63\u5728\u7b49\u5f85\u6211\u5011\u8f38\u5165\u4e00\u4e9bJavascript\u7684\u7a0b\u5f0f\u78bc</li> </ul> </li> <li>\u6211\u5011\u5f9e\u7c21\u55ae\u7684\u7bc4\u4f8b\u958b\u59cb\u770b\u770b     Bash Session<pre><code>&gt; console.log('test')\ntest\nundefined\n&gt;\n</code></pre><ul> <li>\u7b2c\u4e00\u500b\u503c<code>test</code>\u662f\u8981\u544a\u8a34CLI console\u8981\u6253\u5370(print)\u51fa\u4ec0\u9ebc\u503c,\u63a5\u8457\u6211\u5011\u6536\u5230<code>undefined</code>,\u5b83\u662f\u57f7\u884c\u4e2d(running)\u7684<code>console.log()</code></li> <li>\u63a5\u8457\u6211\u5011\u53ef\u4ee5\u958b\u59cb\u8f38\u5165\u4e00\u884c\u65b0\u7684Javascript\u7684\u7a0b\u5f0f\u78bc</li> </ul> </li> <li>\u63a2\u7d22Javascript\u7269\u4ef6(Objects)</li> <li>\u6211\u5011\u53ef\u4ee5\u8a66\u8457\u8f38\u5165Javascript\u7684\u985e\u5225(Class),\u50cf\u662f<code>Number</code>,\u4e26\u5728\u5f8c\u9762\u52a0\u4e0a\u4e00\u500b<code>.</code> ,\u518d\u63a5\u8457\u6309\u4e0b<code>Tab</code>\u6309\u9215\u4f86\u81ea\u52d5\u88dc\u5168</li> <li></li> <li>\u63a2\u7d22Javascript\u7684\u5168\u57df\u7269\u4ef6(global)</li> <li>\u6211\u5011\u53ef\u4ee5\u8a66\u8457\u8f38\u5165Javascript\u7684\u985e\u5225(Class),\u50cf\u662f<code>global</code>,\u4e26\u5728\u5f8c\u9762\u52a0\u4e0a\u4e00\u500b<code>.</code> ,\u518d\u63a5\u8457\u6309\u4e0b<code>Tab</code>\u6309\u9215\u4f86\u81ea\u52d5\u88dc\u5168</li> <li></li> <li>\u63a2\u7d22\u7279\u6b8a\u8b8a\u6578(<code>_</code>)</li> <li>\u5982\u679c\u5728\u67d0\u4e9b\u7a0b\u5f0f\u78bc\u5f8c\u9762\u8f38\u5165<code>_</code>,\u5247\u5c07\u56de\u50b3\u4e0a\u4e00\u500b\u64cd\u4f5c\u7684\u7d50\u679c</li> <li>\u63a2\u7d22\u9ede\u547d\u4ee4(Dot commands)</li> <li>REPL\u6a21\u5f0f\u6709\u4e00\u4e9b\u7279\u5225\u7684\u6307\u4ee4,\u9019\u4e9b\u6307\u4ee4\u90fd\u662f\u7531<code>.</code>\u70ba\u958b\u982d\u7684</li> <li>\u8209\u4f8b\u4f86\u8aaa<ul> <li><code>.help</code>: \u986f\u793a\u6240\u6709\u7684\u9ede\u547d\u4ee4(dot commands)\u7684\u5e6b\u52a9(help)</li> <li><code>.editor</code>: \u555f\u7528\u7de8\u8f2f\u6a21\u5f0f,\u53ef\u4ee5\u8f15\u9b06\u5730\u958b\u59cb\u5beb\u591a\u884cJavascript\u7a0b\u5f0f\u78bc\u3002\u4e00\u65e6\u9032\u5165\u9019\u500b\u6a21\u5f0f,\u6211\u5011\u5c07\u8981\u4f7f\u7528<code>ctrl-D</code>\u7684\u7d44\u5408\u9375\u4f86\u57f7\u884c\u6211\u5011\u5beb\u7684Javascript\u591a\u884c\u7a0b\u5f0f\u78bc</li> <li><code>.break</code>: \u7576\u8f38\u5165\u591a\u884c\u8868\u9054\u5f0f(multi-line expression)\u6642,\u8f38\u5165<code>.break</code>\u6307\u4ee4\u5c07\u7d42\u6b62\u9032\u4e00\u6b65\u7684\u8f38\u5165(abort further input)\u3002\u8207<code>ctrl-C</code>\u7d44\u5408\u9375\u7684\u529f\u80fd\u662f\u4e00\u6a23\u7684</li> <li><code>.clear</code>: \u5c07<code>REPL</code>\u6a21\u5f0f\u7684\u5167\u6587\u91cd\u65b0\u8a2d\u5b9a(reset)\u70ba\u4e00\u500b\u7a7a\u7269\u4ef6,\u4e26\u6e05\u9664\u7576\u524d\u6b63\u5728\u8f38\u5165\u7684\u4efb\u4f55\u591a\u884c\u8868\u9054\u5f0f</li> <li><code>.load</code>: \u8b80\u53d6\u7576\u524d\u5de5\u4f5c\u76ee\u9304\u8def\u5f91\u4e0b\u7684Javascript\u6a94\u6848</li> <li><code>.save</code>: \u5c07\u6211\u5011\u5728<code>REPL\u9023\u7dda</code>(session)\u4e2d\u7684\u6240\u6709\u5c0d\u6307\u5b9a\u6a94\u6848\u7684\u8f38\u5165\u5132\u5b58\u8d77\u4f86</li> <li><code>.exit</code>: \u9000\u51fa<code>REPL\u6a21\u5f0f</code>\u3002\u8207\u9023\u7e8c\u6309\u4e0b<code>ctrl-C</code>\u7d44\u5408\u9375 \u5169\u6b21 \u7684\u529f\u80fd\u662f\u4e00\u6a23\u7684</li> </ul> </li> <li>\u5176\u5be6<code>REPL\u6a21\u5f0f</code>\u6703\u77e5\u9053\u4ec0\u9ebc\u6642\u5019\u8981\u8f38\u5165\u591a\u884c\u8868\u9054\u5f0f,\u800c\u4e0d\u9700\u8981\u547c\u53eb<code>.editor</code><ul> <li>\u4ee5\u4e0b\u662f\u7bc4\u4f8b\u7a0b\u5f0f\u78bc      JavaScript<pre><code>  [1, 2, 3].forEach(num =&gt; {\n</code></pre></li> <li>\u9019\u6642\u5019\u7576\u6211\u5011\u6309\u4e0b<code>enter</code>\u9375\u6642,<code>REPL\u6a21\u5f0f</code>\u6703\u5230\u65b0\u7684\u4e0b\u4e00\u884c,\u4e26\u4ee5<code>...</code>\u4f5c\u70ba\u958b\u982d,\u8868\u793a\u6211\u5011\u73fe\u5728\u53ef\u4ee5\u7e7c\u7e8c\u5728\u8a72\u5340\u584a(block)\u5de5\u4f5c</li> <li>\u60c5\u5883\u8aaa\u660e     JavaScript<pre><code>... console.log(num)\n... })\n</code></pre></li> <li>\u5982\u679c\u6211\u5011\u9019\u6642\u5019\u5728\u4e00\u884c\u7684\u53e5\u5c3e\u52a0\u4e0a<code>.break</code>\u6642,\u8a72\u591a\u884c\u8868\u9054\u5f0f\u7684\u6a21\u5f0f\u5c07\u6703\u505c\u6b62\u4e26\u4e0d\u6703\u88ab\u57f7\u884c</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#nodejs-accept-arguments-from-the-command-line","title":"Node.js, accept arguments from the command line","text":"<ul> <li>\u6211\u5011\u53ef\u4ee5\u5c07\u4e0d\u9650\u5236\u6578\u91cf\u7684\u53c3\u6578(arguments)\u50b3\u905e\u7d66Node\u61c9\u7528\u7a0b\u5f0f,\u53c3\u6578\u7684\u5f62\u5f0f\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b2\u7a2e\u5f62\u5f0f</li> <li>\u7368\u7acb\u7684\u53c3\u6578\u503c(standalone)<ul> <li>$ <code>node app.js joe</code></li> </ul> </li> <li>\u9375-&gt;\u503c\u5f62\u5f0f\u7684\u53c3\u6578\u503c(key and value)<ul> <li>$ <code>node app.js name=joe</code></li> </ul> </li> <li>\u9019\u4e5f\u5c07\u6539\u8b8a\u6211\u5011\u5728Node\u61c9\u7528\u7a0b\u5f0f\u7684\u7a0b\u5f0f\u78bc\u4e2d,\u5982\u4f55\u5f97\u5230\u6b64\u503c\u7684\u65b9\u5f0f,\u6211\u5011\u53ef\u4ee5\u900f\u904eNode\u5167\u5efa\u7684\u6838\u5fc3\u6a21\u7d44<code>process</code>\u4f86\u5f97\u5230\u6b64\u503c,\u8a72\u6a21\u7d44\u7684process.argv\u5c6c\u6027\u6703\u516c\u958b(exposes)\u51fa\u4e00\u500b\u9663\u5217(array),\u5176\u4e2d\u5305\u542b\u7576\u555f\u52d5Node\u61c9\u7528\u7a0b\u5f0f\u7684\u9032\u7a0b\u7684\u6642\u5019,\u6574\u500b\u547d\u4ee4\u5217(command-line)\u8981\u50b3\u905e\u7684\u6240\u6709\u53c3\u6578</li> <li>\u7b2c1\u500b\u5143\u7d20\u662fnode\u6307\u4ee4\u7684\u5b8c\u6574\u8def\u5f91(= process.execPath)</li> <li>\u7b2c2\u500b\u5143\u7d20\u6703\u662f\u6b63\u5728\u88ab\u57f7\u884c\u7684Javascript\u6a94\u6848\u7684\u8def\u5f91\u4f4d\u7f6e</li> <li>\u5269\u4e0b\u7684\u5143\u7d20\u5c31\u662f\u4efb\u4f55\u5176\u4ed6\u7684\u547d\u4ee4\u5217\u53c3\u6578(command-line arguments)</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc</li> <li>\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6703\u5229\u7528\u4e00\u500b\u8ff4\u5708\u4f86\u904d\u6b77(iterate over)\u6240\u6709\u7684\u53c3\u6578\u5011(\u4e5f\u5305\u62ecnode\u6307\u4ee4\u7684\u5b8c\u6574\u8def\u5f91\u8207\u6b63\u5728\u88ab\u57f7\u884c\u7684Javascript\u6a94\u6848\u7684\u8def\u5f91\u4f4d\u7f6e)     JavaScript<pre><code>process.argv.forEach((val, index) =&gt; {\n  console.log(`${index}: ${val}`)\n})\n</code></pre></li> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u9663\u5217\u4e26\u5207\u7247(<code>array.slice()</code>\u65b9\u6cd5)\u4f86\u7372\u5f97\u984d\u5916\u7684\u53c3\u6578(\u4e0d\u5305\u542b\u524d\u5169\u500b\u53c3\u6578)     JavaScript<pre><code>const args = process.argv.slice(2)\n</code></pre></li> <li>\u5982\u679c\u6211\u5011\u7684\u53c3\u6578\u6c92\u6709\u7d22\u5f15\u540d\u7a31\u7684\u8a71(without index name)</li> <li>\u4f8b: $ <code>node app.js joe</code> JavaScript<pre><code>const args = process.argv.slice(2)\nconsole.log(args[0])\n</code></pre><ul> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4f86\u5b58\u53d6\u547d\u4ee4\u5217\u53c3\u6578(command-line arguments)</li> </ul> </li> <li>\u53e6\u4e00\u7a2e\u60c5\u6cc1\u662f,\u6211\u5011\u6703\u4ee5\u9375\u503c(key-value)\u5f62\u5f0f\u4f86\u50b3\u905e\u547d\u4ee4\u5217\u53c3\u6578</li> <li>\u4f8b: $ <code>node app.js name=joe</code> JavaScript<pre><code>const args = require('minimist')(process.argv.slice(2))\nargs['name'] //joe\n</code></pre><ul> <li>\u4ee5\u4e0a\u8ff0\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u70ba\u4f8b,<code>args[0]</code>\u662f<code>name=joe</code>,\u9019\u7a2e\u60c5\u6cc1\u6211\u5011\u5c31\u6703\u9700\u8981\u4f86\u89e3\u6790(parse)\u5b83,\u6700\u4f73\u7684\u505a\u6cd5\u662f,\u6211\u5011\u53ef\u4ee5\u5229\u7528npm\u4e0a\u9762\u7684minimist\u5957\u4ef6\u4f86\u8655\u7406\u9019\u4e9b \u9375\u503c\u5f62\u5f0f\u7684\u53c3\u6578</li> </ul> </li> <li>\u9019\u6b21\u6211\u5011\u5c31\u8981\u5728\u6bcf\u500b\u53c3\u6578\u7684\u9375(key)\u4e4b\u524d\u4f7f\u7528\u96d9\u7834\u6298\u865f(double dashes)<ul> <li>\u4f8b: $ <code>node app.js --name=joe</code></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#output-to-the-command-line-using-nodejs","title":"Output to the command line using Node.js","text":"<p>npm\u7684 chalk \u5957\u4ef6---\u53ef\u8a2d\u5b9a\u7d42\u7aef\u6a5f\u8f38\u51fa\u6587\u5b57\u7684\u6a23\u5f0f\u8207\u984f\u8272 npm\u7684progress\u5957\u4ef6---\u53ef\u4ee5\u5728<code>CLI console</code>\u756b\u9762\u4e0a\u5275\u9020\u9032\u5ea6\u689d\u7684\u5957\u4ef6</p> <ul> <li>\u5229\u7528console\u6838\u5fc3\u6a21\u7d44\u7684\u57fa\u672c\u8f38\u51fa(basic output)</li> <li>Node\u6709\u4e00\u500b<code>console</code>\u6838\u5fc3\u6a21\u7d44,\u8a72\u6a21\u7d44\u63d0\u4f9b\u4e86\u8a31\u591a\u8207<code>CLI</code>\u6709\u7528\u7684\u4e92\u52d5\u65b9\u6cd5</li> <li>\u5b83\u57fa\u672c\u4e0a\u8ddf\u6211\u5011\u5728\u700f\u89bd\u5668\u4e0a\u770b\u5230\u7684<code>console</code>\u7269\u4ef6\u662f\u4e00\u6a23\u7684</li> <li>\u6700\u57fa\u672c\u8207\u6700\u6709\u7528\u7684\u65b9\u6cd5\u662fconsole.log([data][, ...args]),\u9019\u500b\u65b9\u6cd5\u6703\u6253\u5370\u51fa(print)\u6211\u5011\u50b3\u905e\u7d66console\u7684\u5b57\u4e32<ul> <li>\u5982\u679c\u6211\u5011\u50b3\u905e\u7269\u4ef6,\u8a72\u65b9\u6cd5\u6703\u81ea\u52d5\u5e6b\u6211\u5011\u8f49\u63db\u6210\u5b57\u4e32</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u50b3\u905e\u591a\u500b\u8b8a\u6578\u7d66<code>console.log()</code></li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>const x = 'x'\nconst y = 'y'\nconsole.log(x, y)\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u78bc,Node\u6703\u5c07\u5169\u500b\u8b8a\u6578\u90fd\u6253\u5370\u51fa\u4f86(print)</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u50b3\u905e\u8b8a\u6578\u7d66\u6a21\u677f\u5b57\u4e32</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc JavaScript<pre><code>console.log('My %s has %d years', 'cat', 2)\n</code></pre></li> <li><code>%s</code>: \u5c07\u8b8a\u6578\u683c\u5f0f\u5316\u70ba\u5b57\u4e32</li> <li><code>%d</code>: \u5c07\u8b8a\u6578\u683c\u5f0f\u5316\u70ba\u6578\u5b57</li> <li><code>%i</code>: \u5c07\u8b8a\u6578\u683c\u5f0f\u5316\u70ba\u5176\u6574\u6578\u90e8\u5206</li> <li><code>%o</code>: \u5c07\u8b8a\u6578\u683c\u5f0f\u5316\u70ba\u7269\u4ef6</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>console.log('%o', Number)\n</code></pre></li> </ul> </li> <li>\u6e05\u9664\u5f8c\u53f0(console)-console.clear()</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>console.clear()\n</code></pre></li> <li>\u8a72\u65b9\u6cd5\u6703\u5c07\u5f8c\u53f0\u6e05\u7a7a(\u8a3b: \u8a72\u65b9\u6cd5\u7684\u884c\u70ba\u4e5f\u6703\u53d6\u6c7a\u65bc\u6211\u5011\u662f\u4f7f\u7528\u54ea\u7a2e\u5f8c\u53f0)</li> <li>\u8a08\u7b97\u5143\u7d20\u6578\u91cf-console.count([label])</li> <li><code>console.count()</code>\u662f\u4e00\u500b\u65b9\u4fbf\u7684\u65b9\u6cd5</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const x = 1\nconst y = 2\nconst z = 3\nconsole.count(\n  'The value of x is ' + x + \n  ' and has been checked .. how many times?'\n)\nconsole.count(\n  'The value of x is ' + x + \n  ' and has been checked .. how many times?'\n)\nconsole.count(\n  'The value of y is ' + y + \n  ' and has been checked .. how many times?'\n)\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u78bc\u6703\u8a08\u7b97\u8a72\u5b57\u4e32\u88ab\u6253\u5370\u51fa(print)\u5e7e\u6b21\u4e86,\u4e26\u5c07\u5176\u6b21\u6253\u5370\u5728\u65c1\u908a</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc<ul> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u53ea\u8a08\u7b97\u860b\u679c\u548c\u6a58\u5b50\u7684\u6578\u91cf   JavaScript<pre><code>const oranges = ['orange', 'orange']\nconst apples = ['just one apple']\noranges.forEach(fruit =&gt; {\n  console.count(fruit)\n})\napples.forEach(fruit =&gt; {\n  console.count(fruit)\n})\n</code></pre></li> </ul> </li> <li>\u6253\u5370\u51fa\u5806\u68e7\u8ffd\u8e64(print stack trace)-console.trace([message][, ...args])</li> <li>\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b,\u6253\u5370\u51fa\u51fd\u6578\u7684\u5806\u68e7\u8abf\u7528\u60c5\u6cc1\u662f\u5f88\u6709\u7528\u7684,\u9019\u4e5f\u8a31\u5c31\u80fd\u56de\u7b54\u6211\u5011\u7684\u4e00\u500b\u554f\u984c---\u6211\u5011\u8a72\u5982\u4f55\u5230\u9054\u7a0b\u5f0f\u78bc\u7684\u5176\u4e2d\u4e00\u500b\u90e8\u5206?</li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528<code>console.trace()</code>\u65b9\u6cd5\u4f86\u5b8c\u6210</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc       JavaScript<pre><code>const function2 = () =&gt; console.trace()\nconst function1 = () =&gt; function2()\nfunction1()\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6703\u6253\u5370\u51fa\u5806\u68e7\u8ffd\u8e64(stack trace)</li> <li>\u5982\u679c\u6211\u5011\u5728Node\u7684<code>REPL\u6a21\u5f0f</code>\u4e2d\u5617\u8a66\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc,\u6703\u5f97\u5230\u4ee5\u4e0b\u7684\u56de\u50b3\u8cc7\u8a0a     Bash Session<pre><code>Trace\n  at function2 (repl:1:33)\n  at function1 (repl:1:25)\n  at repl:1:1\n  at ContextifyScript.Script.runInThisContext (vm.js:44:33)\n  at REPLServer.defaultEval (repl.js:239:29)\n  at bound (domain.js:301:14)\n  at REPLServer.runBound [as eval] (domain.js:314:12)\n  at REPLServer.onLine (repl.js:440:10)\n  at emitOne (events.js:120:20)\n  at REPLServer.emit (events.js:210:7)\n</code></pre></li> </ul> </li> <li>\u8a08\u7b97\u57f7\u884cNode\u7a0b\u5f0f\u78bc\u6240\u82b1\u8cbb\u7684\u6642\u9593-console.time([label]) &amp; console.timeEnd([label])</li> <li>\u6211\u5011\u53ef\u4ee5\u4f7f\u7528<code>console.time()</code> &amp; <code>console.timeEnd()</code></li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const doSomething = () =&gt; console.log('test')\nconst measureDoingSomething = () =&gt; {\n  console.time('doSomething()')\n  //do something, and measure the time it takes\n  doSomething()\n  console.timeEnd('doSomething()')\n}\nmeasureDoingSomething()\n</code></pre></li> <li>\u6a19\u6e96\u8f38\u51fa &amp; \u6a19\u6e96\u932f\u8aa4-console.log([data][, ...args]) &amp; console.error([data][, ...args])</li> <li>\u5982\u6211\u5011\u6240\u898b,<code>console.log()</code>\u975e\u5e38\u9069\u5408\u5728\u5f8c\u53f0(Console)\u6253\u5370\u51fa\u8a0a\u606f,\u9019\u4e5f\u5c31\u662f\u6240\u8b02\u7684\u6a19\u6e96\u8f38\u51fa(standard output, <code>stdout</code>)</li> <li>\u53cd\u4e4b,<code>console.error()</code>\u5247\u6703\u5c07\u8a0a\u606f\u6253\u5370\u5230\u6a19\u6e96\u932f\u8aa4(standard error, <code>stderr</code>)\u6d41(stream)\u4e0a\u9762<ul> <li><code>stderr</code>\u6d41\u4e0d\u6703\u51fa\u73fe\u5728\u5f8c\u53f0(Console)\u4e0a,\u4f46\u662f\u5b83\u6703\u51fa\u73fe\u5728\u932f\u8aa4\u65e5\u8a8c\u4e0a(error log)</li> </ul> </li> <li>\u70ba\u6587\u5b57\u8f38\u51fa\u4e0a\u8272-\u8df3\u812b\u5e8f\u5217(escape sequences) &amp; npm\u7684 chalk package</li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528\u8df3\u812b\u5e8f\u5217(escape sequence)\u5c07\u6587\u5b57\u8f38\u51fa\u4e0a\u8272</li> <li>\u8df3\u812b\u5e8f\u5217\u662f\u4e00\u7d44\u5b57\u7b26\u4ee3\u8868\u4e00\u7a2e\u984f\u8272</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc       JavaScript<pre><code>console.log('\\x1b[33m%s\\x1b[0m', 'hi!')\n</code></pre><ul> <li>\u5728<code>CLI</code>\u4e0a\u9032\u5165Node\u7684<code>REPL\u6a21\u5f0f</code>\u4e2d,\u57f7\u884c\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u78bc\u6703\u770b\u5230<code>hi</code>\u8b8a\u6210\u9ec3\u8272\u7684\u5b57\u9ad4</li> <li></li> <li>\u7136\u800c\u9019\u6a23\u505a\u5176\u5be6\u662f\u4e00\u7a2e\u4f4e\u968e(low-level)\u65b9\u6cd5,\u6700\u7c21\u55ae\u7684\u505a\u6cd5\u662f\u5229\u7528\u5957\u4ef6(library)\u4f86\u5c07\u6587\u5b57\u8f38\u51fa\u4e0a\u8272</li> </ul> </li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528npm\u4e0a\u9762\u7684<code>chalk</code>\u5957\u4ef6,\u8a72\u5957\u4ef6\u4e0d\u50c5\u53ef\u4ee5\u70ba\u6587\u5b57\u8f38\u51fa\u4e0a\u8272,\u4e5f\u53ef\u4ee5\u5c07\u6587\u5b57\u8f38\u51fa\u7684\u5b57\u9ad4\u8b8a\u6210 \u7c97\u9ad4 or \u659c\u9ad4 or \u5e36\u6709\u4e0b\u5283\u7dda<ul> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e<code>CLI</code>\u6307\u4ee4\u4f86\u5b89\u88dd<code>chalk</code>\u9019\u500b\u5957\u4ef6,\u5b89\u88dd\u5b8c\u5f8c\u5c31\u53ef\u4ee5\u7acb\u5373\u4f7f\u7528\u5b83</li> <li>$ <code>npm install chalk</code></li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>const chalk = require('chalk')\nconsole.log(chalk.yellow('hi!'))\n</code></pre></li> <li>\u5f9e\u4e0a\u9762\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u53ef\u4ee5\u770b\u51fa\u6211\u5011\u53ef\u4ee5\u4f7f\u7528<code>chalk.yellow()</code>\u9019\u500b\u65b9\u6cd5\u6703\u6bd4\u8d77\u8df3\u812b\u5e8f\u5217(escape sequences)\u4f86\u5f97\u66f4\u597d\u8a18\u8207\u66f4\u597d\u95b1\u8b80</li> <li>\u66f4\u591a\u76f8\u95dc\u529f\u80fd\u53ef\u4ee5\u53c3\u8003 npm \u7684 chalk \u5957\u4ef6</li> </ul> </li> <li>\u5efa\u7acb\u9032\u5ea6\u689d-npm\u7684progress package</li> <li><code>progress</code>\u662f\u4e00\u500b\u975e\u5e38\u68d2\u7684\u5957\u4ef6\u5728CLI console\u756b\u9762\u4e0a\u5275\u9020 \u9032\u5ea6\u689d \u7684\u5957\u4ef6</li> <li>\u53ef\u4ee5\u5148\u5229\u7528npm\u4f86\u5b89\u88dd<code>progress</code>\u9019\u500b\u5957\u4ef6<ul> <li>$ <code>npm install progress</code></li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const ProgressBar = require('progress')\n\nconst bar = new ProgressBar(':bar', { total: 10 })\nconst timer = setInterval(() =&gt; {\n  bar.tick()\n  if (bar.complete) {\n    clearInterval(timer)\n  }\n}, 100)\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6703\u5efa\u7acb\u4e00\u500b\u542b\u670910\u500b\u6b65\u9a5f(steps)\u7684\u9032\u5ea6\u689d(progress bar),\u6bcf100\u6beb\u79d2\u5c31\u6703\u57f7\u884c\u4e00\u6b21</li> <li>\u7576\u9032\u5ea6\u689d\u5b8c\u6210\u6642,\u5c31\u6703\u6e05\u9664\u9019\u500b\u9593\u9694(clear the interval)</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#accept-input-from-the-command-line-in-nodejs","title":"Accept input from the command line in Node.js","text":"<p>npm\u7684readline-sync\u5957\u4ef6---\u63d0\u4f9b\u4e00\u500b\u80fd\u900f\u904econsole(TTY)\u8207\u4f7f\u7528\u8005\u9032\u884c\u5c0d\u8a71\u7684\u4e92\u52d5\u5f0f\u57f7\u884c\u5730\u540c\u6b65\u8b80\u53d6\u884c(synchronous readline for interactively running) npm\u7684inquirer---\u6536\u96c6\u4e86\u5e38\u898b\u7684<code>CLI</code>\u6307\u4ee4</p> <ul> <li>\u5982\u4f55\u8b93Node\u61c9\u7528\u7a0b\u5f0f\u7684<code>CLI console</code>\u6210\u70ba\u4e92\u52d5\u6027(interactive)\u7684\u63a7\u5236\u53f0</li> <li>\u81ea\u5f9eNode<code>v7.0.0</code>\u7248\u672c\u4e4b\u5f8c,Node\u63d0\u4f9b\u4e86<code>readline</code>\u9019\u500b\u5167\u5efa\u6838\u5fc3\u6a21\u7d44\u4f86\u78ba\u5207\u5730\u57f7\u884c\u4ee5\u4e0b\u9019\u4ef6\u4e8b\u60c5</li> <li>\u5f9e\u4e00\u500b\u53ef\u8b80\u53d6\u7684\u6d41(readable stream),\u4f8b\u5982: <code>process.stdin</code>\u6d41(stream)\u7372\u5f97\u8f38\u5165(get input)</li> <li>\u88dc\u5145: <code>process.stdin</code>\u662f\u5728\u57f7\u884cNode.js\u61c9\u7528\u7a0b\u5f0f\u671f\u9593\u6642,\u7d42\u7aef\u6a5f\u8f38\u5165\u7684\u6d41,\u4e00\u6b21\u50c5\u4e00\u884c</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const readline = require('readline').createInterface({\n  input: process.stdin,\n  output: process.stdout\n})\n\nreadline.question(`What's your name?`, name =&gt; {\n  console.log(`Hi ${name}!`)\n  readline.close()\n})\n</code></pre><ul> <li>\u4ee5\u4e0a\u7247\u6bb5(piece)\u7684\u7a0b\u5f0f\u78bc\u6703\u8a62\u554f\u4f7f\u7528\u8005\u540d\u7a31,\u4e00\u65e6\u4f7f\u7528\u8005\u8f38\u5165\u6587\u5b57\u4e26\u6309\u4e0b<code>enter</code>\u9375\u5f8c,\u6211\u5011\u5c31\u6703\u767c\u9001\u4e00\u500b\u554f\u5019(greeting)</li> <li>\u8aaa\u660e: readline.question()\u65b9\u6cd5\u986f\u793a\u7b2c\u4e00\u500b\u53c3\u6578(\u4f8b: \u4e00\u500b\u554f\u53e5),\u4e26\u7b49\u5f85\u4f7f\u7528\u8005\u8f38\u5165\u3002\u4e00\u65e6\u4f7f\u7528\u8005\u8f38\u5165\u6587\u5b57\u4e26\u6309\u4e0b<code>enter</code>\u9375\u5f8c,\u5c31\u6703\u547c\u53eb\u8a72\u65b9\u6cd5\u7684\u7b2c\u4e8c\u500b\u53c3\u6578---\u56de\u547c\u51fd\u5f0f(callback function)</li> <li>\u5728\u4e0a\u8ff0\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,\u6211\u5011\u7684\u56de\u547c\u51fd\u5f0f\u6703\u95dc\u9589\u8b80\u53d6\u884c\u4ecb\u9762(readline interface)---(readline.close())</li> </ul> </li> <li><code>readline</code>\u6a21\u7d44\u63d0\u4f9b\u4e86\u8a31\u591a\u5176\u4ed6\u7684\u65b9\u6cd5,\u63a5\u4e0b\u4f86\u5c07\u6703\u5728\u5957\u4ef6\u7684\u540d\u7a31\u4e0a\u8a2d\u5b9a\u8d85\u9023\u7d50\u4f86\u8b93\u6211\u5011\u53ef\u4ee5\u53bb\u67e5\u770b\u8a72\u5957\u4ef6\u7684\u6587\u4ef6</li> <li>\u5982\u679c\u6211\u5011\u8981\u6c42\u8f38\u5165\u5bc6\u78bc,\u6211\u5011\u6703\u5e0c\u671b\u6700\u597d\u4e0d\u8981\u4ee5\u660e\u78bc\u986f\u793a\u56de\u50b3\u7684\u5bc6\u78bc,\u800c\u662f\u4f7f\u7528<code>*</code>\u7b26\u865f\u4f86\u66ff\u63db\u986f\u793a\u4f7f\u7528\u8005\u8f38\u5165\u7684\u5bc6\u78bc<ul> <li>\u9019\u6642\u6700\u7c21\u55ae\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u5c31API\u800c\u8a00\u975e\u5e38\u985e\u4f3c\u7684,npm\u4e0a\u7684readline-sync\u5957\u4ef6,\u4e26\u7acb\u5373\u5c0d\u5176\u9032\u884c\u8655\u7406</li> </ul> </li> <li>npm\u7684inquirer\u5957\u4ef6\u63d0\u4f9b\u4e86\u4e00\u500b\u66f4\u5b8c\u6574\u4e14\u66f4\u62bd\u8c61\u7684\u89e3\u6c7a\u65b9\u6848<ul> <li>\u6211\u5011\u9700\u8981\u5148\u900f\u904enpm\u5b89\u88dd<code>inquirer</code>\u5957\u4ef6</li> <li>$ <code>npm install inquirer</code></li> </ul> </li> <li>\u60c5\u5883\u8aaa\u660e     JavaScript<pre><code>const inquirer = require('inquirer')\n\nvar questions = [\n  {\n    type: 'input',\n    name: 'name',\n    message: \"What's your name?\"\n  }\n]\n\ninquirer.prompt(questions).then(answers =&gt; {\n  console.log(`Hi ${answers['name']}!`)\n})\n</code></pre><ul> <li><code>inquirer</code>\u9019\u500b\u5957\u4ef6\u8b93\u6211\u5011\u53ef\u4ee5\u505a\u8a31\u591a\u4e8b\u60c5\u50cf\u662f\u8a62\u554f\u9078\u64c7\u984c(multiple choices),\u63d0\u4f9b\u55ae\u9078\u6309\u9215(radio button),\u78ba\u8a8d(confirmation),...\u7b49\u7b49</li> <li>\u503c\u5f97\u4e00\u63d0\u7684\u662f\u6240\u6709\u7684\u66ff\u4ee3\u65b9\u6848(alternatives),\u5c24\u5176\u662f\u90a3\u4e9bNode\u63d0\u4f9b\u7684\u5167\u5efa\u66ff\u4ee3\u65b9\u6848\u9084\u4e0d\u932f\u3002\u4f46\u5982\u679c\u6211\u5011\u60f3\u8981\u5c07<code>CLI</code>\u4e92\u52d5\u5f0f\u8f38\u5165\u63d0\u4f9b\u5230\u53e6\u4e00\u500b\u66f4\u9ad8\u7684\u6c34\u5e73\u4e0a\u6642,<code>inquirer.js</code>\u662f\u4e00\u500b\u6700\u7406\u60f3(optimal)\u7684\u9078\u64c7</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#expose-functionality-from-a-nodejs-file-using-exports","title":"Expose functionality from a Node.js file using exports","text":"<ul> <li>Node\u64c1\u6709\u5167\u5efa\u7684\u6a21\u7d44\u7cfb\u7d71,\u4e26\u80fd\u900f\u904e\u532f\u5165(import)\u4f86\u4f7f\u7528\u7531\u5176\u5b83Node.js\u7684\u6a94\u6848\u516c\u958b(exposed)\u51fa\u4f86\u7684\u529f\u80fd</li> <li>\u5047\u5982\u6211\u5011\u60f3\u8981\u532f\u5165\u67d0\u4e9b\u6211\u5011\u60f3\u4f7f\u7528\u7684\u6771\u897f</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const library = require('./library')\n</code></pre><ul> <li>\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u78bc\u4f86\u532f\u5165\u5b58\u5728\u65bc(resides)\u7576\u524d\u6a94\u6848\u76ee\u9304\u4e0b\u7684<code>library.js</code>\u6240\u516c\u958b(exposed)\u51fa\u4f86\u7684\u529f\u80fd</li> <li>\u5728<code>library.js</code>\u6a94\u6848\u7684\u7a0b\u5f0f\u78bc\u4e2d\u7684\u6700\u4e0b\u9762,\u9700\u8981\u4e8b\u5148\u516c\u958b(exposed)=&gt; (\u4f7f\u7528<code>module.exports</code>\u7269\u4ef6\u7684API)\u51fa\u4f86\u8a72\u6a94\u6848\u7684\u529f\u80fd,\u624d\u80fd\u5728\u5176\u4ed6\u9700\u8981\u4f7f\u7528\u6642,\u76f4\u63a5\u532f\u5165<code>library.js</code>\u5c31\u53ef\u4ee5\u4f7f\u7528</li> <li>\u56e0\u70ba\u5728\u9810\u8a2d\u60c5\u6cc1\u4e0b,\u6240\u6709\u5728<code>library.js</code>\u4e2d\u5b9a\u7fa9\u7684\u7269\u4ef6or\u8b8a\u6578\u90fd\u662f\u79c1\u6709\u7684(private)\u4e26\u4e14\u6c92\u6709\u5c0d\u5916(to outer world)\u516c\u958b(exposed)</li> <li>\u800c\u9019\u4e5f\u5c31\u662fCommonJS modules\u6a21\u7d44\u63d0\u4f9b\u7684module.exports API,\u6240\u5141\u8a31\u6211\u5011\u9019\u9ebc\u505a\u7684</li> </ul> </li> <li>\u7576\u6211\u5011\u6307\u6d3e(assign)\u4e00\u500b\u7269\u4ef6\u6216\u662f\u4e00\u500b\u51fd\u5f0f\u6210\u70ba<code>exports</code>\u7684\u65b0\u5c6c\u6027\u6642,\u800c\u9019\u5c31\u662f\u6211\u5011\u8981\u516c\u958b(exposed)\u7684\u6771\u897f,\u56e0\u6b64\u6211\u5011\u5c31\u53ef\u4ee5\u5728\u6211\u5011\u7684Node\u61c9\u7528\u7a0b\u5f0f\u4e2d\u7684\u5176\u5b83\u90e8\u5206\u4e2d\u6216\u751a\u81f3\u662f\u5728\u5176\u5b83\u7684Node\u61c9\u7528\u7a0b\u5f0f\u4e2d\u4e5f\u53ef\u4ee5\u4f7f\u7528</li> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b2\u7a2e\u65b9\u5f0f\u4f86\u64cd\u4f5c</li> <li>\u65b9\u6cd5\u4e00: \u6307\u6d3e(assign)\u4e00\u500b\u7269\u4ef6\u7d66<code>module.exports</code>,\u4e5f\u5c31\u662f\u6307\u6d3e\u7d66\u7531Node\u7684<code>CommonJS modules</code>\u6838\u5fc3\u6a21\u7d44\u6240\u63d0\u4f9b\u7684\u7269\u4ef6,\u5982\u6b64\u5c31\u80fd\u5c07\u6211\u5011\u7684\u6a94\u6848\u50c5\u5c0d\u5916\u532f\u51fa(export)\u90a3\u500b\u7269\u4ef6<ul> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>const car = {\n  brand: 'Ford',\n  model: 'Fiesta'\n}\n\nmodule.exports = car\n\n//..in the other file\n\nconst car = require('./car')\n</code></pre></li> </ul> </li> <li>\u65b9\u6cd5\u4e8c: \u5c07\u60f3\u8981\u532f\u51fa(exported)\u7269\u4ef6\u65b0\u589e(add)\u70baexports\u7684\u5c6c\u6027(property),\u9019\u500b\u65b9\u6cd5\u8b93\u6211\u5011\u80fd\u5920\u532f\u51fa\u591a\u500b\u7269\u4ef6(objects),\u51fd\u5f0f(functions),\u8cc7\u6599(data)<ul> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>const car = {\n  brand: 'Ford',\n  model: 'Fiesta'\n}\n\nexports.car = car\n</code></pre></li> <li>\u6216\u662f\u4e5f\u53ef\u4ee5\u76f4\u63a5\u9019\u6a23\u532f\u51fa(export)</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>exports.car = {\n  brand: 'Ford',\n  model: 'Fiesta'\n}\n</code></pre></li> <li>\u63a5\u8457,\u6211\u5011\u5728\u53e6\u4e00\u500b\u6a94\u6848\u4e2d\u5c31\u53ef\u4ee5\u532f\u5165(import)\u4e26\u5f15\u7528(referencing)\u9019\u500b\u5c6c\u6027</li> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b2\u7a2e\u65b9\u5f0f\u4f86\u5f15\u7528\u5b83</li> <li>\u65b9\u6cd5\u4e00:     JavaScript<pre><code>const items = require('./items')\nitems.car\n</code></pre></li> <li>\u65b9\u6cd5\u4e8c:     JavaScript<pre><code>const car = require('./items').car\n</code></pre></li> </ul> </li> <li>module.exports\u8207exports\u4e4b\u9593\u6709\u4ec0\u9ebc\u5340\u5225\u5462?</li> <li><code>module.exports</code>\u6703\u516c\u958b(exposes)\u5b83\u6307\u5411(points to)\u7684\u5c0d\u8c61(object)</li> <li><code>exports</code>\u6703\u516c\u958b(exposes)\u5b83\u6240\u6307\u5411(points to)\u7684\u5c0d\u8c61(object)\u7684\u5c6c\u6027(properties)</li> </ul>"},{"location":"programming_language/nodejs/#an-introduction-to-the-npm-package-manager","title":"An introduction to the npm package manager","text":"<p>npm install - Install a package</p> <ul> <li><code>npm</code>\u4ecb\u7d39</li> <li>npm\u662fNode\u6a19\u6e96\u7684\u5957\u4ef6\u7ba1\u7406\u5de5\u5177(standard package manager)</li> <li>\u57282017\u5e741\u6708,\u6839\u64da\u5831\u544a\u986f\u793a<code>npm registry</code>\u5217\u8868\u4e0a\u5df2\u6709\u8d85\u904e350,000\u500b\u5957\u4ef6(packages),\u4e5f\u4f7f\u5176\u6210\u70ba\u5730\u7403\u4e0a\u55ae\u4e00\u8a9e\u8a00\u7a0b\u5f0f\u78bc\u5132\u5b58\u5eab,\u4e26\u4e14\u6211\u5011\u53ef\u4ee5\u78ba\u5b9a\u5728<code>npm</code>\u4e0a\u6709\u5e7e\u4e4e\u6240\u6709\u7684\u6771\u897f</li> <li><code>npm</code>\u8d77\u521d\u662f\u7528\u4f86\u4e0b\u8f09\u548c\u7ba1\u7406Node\u5957\u4ef6(package)\u7684\u76f8\u4f9d\u6027(dependencies)\u7684\u65b9\u5f0f,\u4f46\u5b83\u6b64\u5f8c\u5df2\u7d93\u6210\u70ba\u524d\u7aef(frontend) Javascript\u7684\u5de5\u5177</li> <li><code>npm</code>\u5e6b\u52a9\u6211\u5011\u5b8c\u6210\u5f88\u591a\u4e8b\u60c5,\u53e6\u5916<code>Yarn</code>\u662f\u4e00\u500b<code>npm</code>\u7684\u66ff\u4ee3\u65b9\u6848(alternative),\u53ef\u4ee5\u5230Yarn\u7684\u5b98\u65b9\u7db2\u7ad9\u53bb\u77a7\u77a7</li> <li>\u4e0b\u8f09</li> <li><code>npm</code>\u6703\u7ba1\u7406\u6211\u5011\u5c08\u6848\u7684\u5957\u4ef6\u76f8\u4f9d\u6027(dependencies)</li> <li>\u5b89\u88dd\u6240\u6709\u8a72\u5c08\u6848\u7684\u5957\u4ef6\u8207\u5176\u76f8\u4f9d\u7684\u5957\u4ef6(all dependencies)<ul> <li>\u5982\u679c\u6211\u5011\u7684\u5c08\u6848\u6709\u4e00\u500b<code>package.json</code>\u6a94\u6848\u7684\u8a71,\u53ea\u8981\u5728\u7d42\u7aef\u6a5f\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4</li> <li>$ <code>npm install</code></li> <li>\u5982\u679c\u6211\u5011\u7684\u5c08\u6848\u4e2d\u4e0d\u5b58\u5728<code>node_modules/</code>\u9019\u500b\u8cc7\u6599\u593e\u7684\u8a71,\u8a72\u6307\u4ee4\u5c31\u6703\u5b89\u88dd\u6240\u6709\u9019\u500b\u5c08\u6848\u6703\u9700\u8981\u7684\u5957\u4ef6,\u4e26\u5c07\u9019\u4e9b\u6771\u897f\u653e\u5728<code>node_modules/</code>\u7684\u8cc7\u6599\u593e</li> </ul> </li> <li>\u5b89\u88dd\u55ae\u4e00\u500b\u5957\u4ef6(package)<ul> <li>\u6211\u5011\u53ea\u60f3\u5b89\u88dd\u6307\u5b9a\u7684\u5957\u4ef6\u7684\u8a71,\u53ef\u4ee5\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4</li> <li>$ <code>npm install &lt;package-name&gt;</code></li> <li>\u901a\u5e38,\u6211\u5011\u6703\u770b\u5230\u95dc\u65bc\u9019\u500b\u6307\u4ee4\u7684\u66f4\u591a\u9078\u9805,\u4f8b\u5982\u4ee5\u4e0b\u5169\u7a2e\u9078\u9805<ul> <li>--save: \u5b89\u88dd\u8a72\u5957\u4ef6\u4e26\u65b0\u589e\u5230<code>package.json</code>\u7684<code>dependencies</code>\u9375\u4e2d</li> <li>--save-dev: \u5b89\u88dd\u8a72\u5957\u4ef6\u4e26\u65b0\u589e\u5230<code>package.json</code>\u7684<code>devDependencies</code>\u9375\u4e2d</li> </ul> </li> <li>\u4ee5\u4e0a\u5169\u7a2e\u5b89\u88dd\u9078\u9805\u7684\u5340\u5225\u4e3b\u8981\u662f<code>devDependencies</code>\u901a\u5e38\u662f\u958b\u767c\u5de5\u5177(development tools),\u50cf\u662f\u6e2c\u8a66\u5957\u4ef6(testing library); \u800c<code>dependencies</code>\u5728\u751f\u7522\u74b0\u5883\u4e2d\u8207\u61c9\u7528\u7a0b\u5f0f\u672c\u8eab\u7d81\u5b9a\u5728\u4e00\u8d77</li> </ul> </li> <li>\u66f4\u65b0\u5957\u4ef6(Updating packages)<ul> <li>\u4f7f\u7528<code>npm</code>\u4e5f\u8b93\u66f4\u65b0\u5957\u4ef6\u66f4\u5bb9\u6613,\u53ef\u4ee5\u900f\u904e\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4</li> <li><code>npm update</code></li> <li><code>npm</code>\u5c07\u6aa2\u67e5\u6240\u6709\u5957\u4ef6\u662f\u5426\u6709\u80fd\u6eff\u8db3\u6211\u5011\u5c08\u6848\u4e2d\u7684<code>package.json</code>\u6a94\u6848\u7248\u672c\u9650\u5236(constraints)\u7684\u6700\u65b0\u7248\u672c</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u6307\u5b9a\u8981\u66f4\u65b0\u55ae\u4e00\u500b\u5957\u4ef6</li> <li>$ <code>npm update &lt;package-name&gt;</code></li> </ul> </li> <li>\u5957\u4ef6\u7684\u7248\u672c\u63a7\u5236</li> <li>\u9664\u4e86\u55ae\u7d14\u7684\u4e0b\u8f09\u4e4b\u5916,<code>npm</code>\u4e5f\u80fd\u7ba1\u7406\u5957\u4ef6\u7684\u7248\u672c,\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u5728\u6211\u5011\u5c08\u6848\u4e2d\u7684<code>package.json</code>\u6a94\u6848\u4e2d,\u5c0d\u5957\u4ef6\u6307\u5b9a\u4efb\u4f55\u4e00\u500b\u7279\u5b9a\u7684\u7248\u672c,\u6216\u662f\u8981\u6c42\u5b89\u88dd\u7684\u7248\u672c\u9700\u8981\u9ad8\u65bc or \u4f4e\u65bc\u6211\u5011\u6240\u9700\u8981\u7684\u7279\u5b9a\u7248\u672c</li> <li>\u5f88\u591a\u6642\u5019\u6703\u767c\u73fe\u4e00\u500b\u51fd\u5f0f\u5eab(library)\u50c5\u8207\u53e6\u4e00\u500b\u51fd\u5f0f\u5eab\u7684\u4e3b\u8981\u7248\u672c(major release)\u6240\u76f8\u5bb9(compatible); \u6216\u662f\u6700\u65b0\u767c\u5e03\u7684\u51fd\u5f0f\u5eab\u7684\u7248\u672c\u4e4b\u4e2d\u6709<code>bug</code>,\u4ecd\u7136\u672a\u4fee\u5fa9,\u4e26\u9020\u6210\u4e86\u4e00\u4e9b\u554f\u984c(issue)</li> <li>\u6307\u5b9a\u4e00\u500b\u660e\u78ba\u7684\u51fd\u5f0f\u5eab(library)\u7248\u672c\u4e5f\u53ef\u4ee5\u5e6b\u52a9\u6bcf\u500b\u4eba\u90fd\u4f7f\u7528\u78ba\u5b9a\u76f8\u540c\u7684\u5957\u4ef6(package)\u7248\u672c,\u56e0\u6b64\u6574\u500b\u5718\u968a\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u7248\u672c\u4f86\u904b\u884c\u7a0b\u5f0f,\u76f4\u5230<code>package.json</code>\u6a94\u6848\u88ab\u66f4\u65b0\u70ba\u6b62</li> <li>\u5728\u4ee5\u4e0a\u7684\u60c5\u6cc1\u4e2d,\u5957\u4ef6\u7684\u7248\u672c\u7ba1\u7406\u90fd\u975e\u5e38\u6709\u7528,<code>npm</code>\u4e5f\u9075\u5faa\u4e86\u8a9e\u610f\u5316\u7248\u672c\u63a7\u5236\u7684\u6a19\u6e96(semantic versioning (semver) standard)<ul> <li>npm Docs---semver: <code>npm</code>\u7684\u8a9e\u610f\u5316\u7248\u672c\u63a7\u5236\u5de5\u5177</li> <li>Semantic Versioning 2.0.0: \u8a9e\u610f\u5316\u7248\u672c\u7684\u5b98\u65b9\u7db2\u7ad9</li> </ul> </li> <li>\u57f7\u884c\u4efb\u52d9(Running Tasks)</li> <li><code>package.json</code>\u652f\u63f4\u900f\u904e\u6307\u5b9a\u683c\u5f0f\u7684\u547d\u4ee4\u4f86\u57f7\u884cNode\u61c9\u7528\u7a0b\u5f0f,\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u6307\u4ee4<ul> <li>$ <code>npm run &lt;task-name&gt;</code></li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>{\n  \"scripts\": {\n    \"start-dev\": \"node lib/server-development\",\n    \"start\": \"node lib/server-production\"\n  },\n}\n</code></pre></li> <li>\u4ee5\u4e0b\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u662f\u5229\u7528\u6b64\u529f\u80fd\u57f7\u884c Webpack \u5e38\u898b\u7684\u65b9\u5f0f     JavaScript<pre><code>{\n  \"scripts\": {\n    \"watch\": \"webpack --watch --progress --colors --config webpack.conf.js\",\n    \"dev\": \"webpack --progress --colors --config webpack.conf.js\",\n    \"prod\": \"NODE_ENV=production webpack -p --config webpack.conf.js\",\n  },\n}\n</code></pre></li> </ul> </li> <li>\u56e0\u6b64,\u6211\u5011\u4e0d\u7528\u518d\u53bb\u8a18\u90a3\u4e9b\u5bb9\u6613\u5fd8\u8a18or\u8f38\u5165\u932f\u8aa4\u7684\u9577\u6307\u4ee4,\u800c\u53ef\u4ee5\u50cf\u662f\u5982\u4e0b\u7c21\u6f54\u7684\u65b9\u5f0f\u4f86\u57f7\u884cNode\u61c9\u7528\u7a0b\u5f0f<ul> <li>$ <code>npm run watch</code></li> <li>$ <code>npm run dev</code></li> <li>$ <code>npm run prod</code></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#where-does-npm-install-the-packages","title":"Where does npm install the packages?","text":"<ul> <li>\u7576\u6211\u5011\u5229\u7528<code>npm</code>\u5957\u4ef6\u7ba1\u7406\u5de5\u5177\u4f86\u5b89\u88dd\u4e00\u500b\u5957\u4ef6\u6642,\u53ef\u4ee5\u9078\u64c7\u57f7\u884c\u4ee5\u4e0b2\u7a2e\u985e\u578b\u7684\u5b89\u88dd\u65b9\u5f0f</li> <li>\u672c\u5730\u7aef\u5b89\u88dd(a local install)</li> <li>\u5168\u57df\u5b89\u88dd(a global install)</li> <li>\u5728\u9810\u8a2d\u60c5\u6cc1\u4e0b,\u6211\u5011\u53ef\u4ee5\u8f38\u5165\u4ee5\u4e0b\u6307\u4ee4\u4f86\u5b89\u88dd\u5957\u4ef6(=&gt; \u672c\u5730\u7aef\u5b89\u88dd)</li> <li>\u4f8b: $ <code>npm install lodash</code></li> <li>\u9019\u6a23<code>npm</code>\u5c31\u6703\u5728\u7576\u524d\u5c08\u6848\u7684\u76ee\u9304\u88e1\u9762\u7684<code>node_modules/</code>\u8cc7\u6599\u593e\u4e2d\u5b89\u88dd\u8a72\u5957\u4ef6</li> <li>\u9019\u6642,<code>npm</code>\u4e5f\u6703\u65b0\u589e<code>lodash</code>\u9019\u500b\u9805\u76ee(entry)\u5230\u7576\u524d\u5c08\u6848\u76ee\u9304\u88e1\u7684<code>package.json</code>\u6a94\u6848\u4e2d\u7684<code>dependencies</code>\u5c6c\u6027\u4e2d</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>-g</code>\u9078\u9805\u4f86\u57f7\u884c\u5168\u57df\u5b89\u88dd</li> <li>\u4f8b: $ <code>npm install -g lodash</code></li> <li>\u9019\u6642,<code>npm</code>\u5c31\u4e0d\u6703\u5728\u7576\u524d\u7684\u8cc7\u6599\u593e\u5b89\u88dd\u8a72\u5957\u4ef6,\u800c\u662f\u6703\u5b89\u88dd\u5230\u4e00\u500b\u5168\u57df\u7684\u4f4d\u7f6e\u4e0a(global location)</li> <li>\u5177\u9ad4\u4f86\u8aaa,\u5168\u57df\u5b89\u88dd\u7684\u8def\u5f91\u4f4d\u7f6e\u5728\u54ea\u88e1\u5462? A: \u6703\u4f9d\u64da\u672c\u5730\u7aef\u96fb\u8166\u7684\u4f5c\u696d\u7cfb\u7d71\u4e0d\u540c\u800c\u5b9a<ul> <li>\u5728Windows\u4f5c\u696d\u7cfb\u7d71\u4e2d\u6703\u662f<code>C:\\Users\\YOU\\AppData\\Roaming\\npm\\node_modules</code></li> <li>\u5728macOS &amp; Linux\u4f5c\u696d\u7cfb\u7d71\u4e2d\u6703\u662f<code>/usr/local/lib/node_modules</code></li> <li></li> </ul> </li> <li>\u7136\u800c,\u5982\u679c\u6211\u5011\u4f7f\u7528<code>nvm</code>\u4f86\u7ba1\u7406Node\u7248\u672c\u7684\u8a71,\u5168\u57df\u5b89\u88dd\u7684\u8def\u5f91\u4f4d\u7f6e\u5c31\u6703\u6709\u6240\u4e0d\u540c</li> <li>\u4ee5\u6211\u4f7f\u7528<code>nvm</code>\u7684\u60c5\u6cc1\u4f86\u8aaa,\u6211\u7684\u5957\u4ef6\u6703\u88ab\u5168\u57df\u5b89\u88dd\u5728<code>/Users/joe/.nvm/versions/node/v8.9.0/lib/node_modules</code></li> </ul>"},{"location":"programming_language/nodejs/#how-to-use-or-execute-a-package-installed-using-npm","title":"How to use or execute a package installed using npm?","text":"<p>npm\u7684cowsay\u5957\u4ef6---\u662f\u4e00\u500b\u7531<code>Perl</code>\u8a9e\u8a00\u6240\u958b\u767c\u7684\u5957\u4ef6,\u80fd\u63d0\u4f9b\u4e00\u500b\u7d42\u7aef\u6a5f\u4ecb\u9762\u7684\u7a0b\u5f0f,\u4e26\u4ee5\u6bcd\u725b(cow)\u7684\u65b9\u5f0f\u8aaa\u8a71</p> <ul> <li>\u7576\u6211\u5011\u900f\u904e<code>npm</code>\u5b89\u88dd\u5957\u4ef6\u5230<code>node_modules/</code>\u8cc7\u6599\u593e\u6642,\u6216\u662f\u5168\u57df\u5b89\u88dd\u6642,\u6211\u5011\u53ef\u4ee5\u900f\u904e<code>require('&lt;package name&gt;')</code>\u7684\u8a9e\u6cd5\u4f86\u5f15\u7528\u8a72\u5957\u4ef6(package)</li> <li>\u5047\u8a2d\u6211\u5011\u5b89\u88dd\u4e86<code>lodash</code>\u9019\u500bJavascript\u4e16\u754c\u4e2d\u6d41\u884c\u4e14\u5be6\u7528\u7684\u51fd\u5f0f\u5eab(library)<ul> <li>\u4f8b: $ <code>npm install lodash</code></li> </ul> </li> <li>\u9019\u6a23<code>npm</code>\u5c07\u6703\u628a<code>lodash</code>\u51fd\u5f0f\u5eab\u5b89\u88dd\u5230\u7576\u524d\u5c08\u6848\u76ee\u9304\u4e2d\u7684<code>node_modules/</code>\u8cc7\u6599\u593e\u4e2d</li> <li>\u7576\u6211\u5011\u60f3\u8981\u4f7f\u7528<code>lodash</code>\u51fd\u5f0f\u5eab\u5728\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u6642,\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u7684\u6307\u4ee4<ul> <li>\u4f8b: $ <code>const _ = require('lodash')</code></li> <li>\u4ee5\u9019\u500b\u7bc4\u4f8b\u70ba\u4f8b \u6703\u5c07\u53ef\u57f7\u884c\u7684\u6a94\u6848(executable file)\u653e\u5728<code>node_modules/.bin/</code>\u8cc7\u6599\u593e\u4e0b\u9762</li> </ul> </li> <li>\u4ee5\u4e0a\u7684\u89c0\u5ff5,\u6211\u5011\u53ef\u4ee5\u5229\u7528<code>npm</code>\u4e0a\u7684cowsay\u5957\u4ef6\u4f86\u505a\u500b\u5c55\u793a</li> <li>cowsay\u5957\u4ef6\u80fd\u63d0\u4f9b\u4e00\u500b\u7d42\u7aef\u6a5f\u4ecb\u9762\u7684\u7a0b\u5f0f,\u4e26\u4ee5\u6bcd\u725b(cow)\u7684\u65b9\u5f0f\u8aaa\u8a71</li> <li>\u7576\u6211\u5011\u900f\u904e<code>npm</code>\u5b89\u88dd<code>cowsay</code>\u5957\u4ef6\u6642, \u8a72\u5957\u4ef6\u5c31\u6703\u5b89\u88dd\u5b83\u81ea\u5df1\u672c\u8eab &amp; \u5176\u6240\u6709\u76f8\u4f9d\u7684\u5957\u4ef6(dependencies)\u5728<code>node_modules/</code>\u8cc7\u6599\u593e\u4e2d<ul> <li></li> </ul> </li> <li>\u5728<code>node_modules/</code>\u8cc7\u6599\u593e\u4e2d\u6703\u6709\u4e00\u500b\u96b1\u85cf\u76ee\u9304<code>.bin/</code>,\u88e1\u9762\u5305\u542b\u6307\u5411<code>cowsay</code>\u5957\u4ef6\u7684\u4e8c\u9032\u5236\u6587\u4ef6(binaries)<ul> <li></li> </ul> </li> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e<code>npx</code>\u4f86\u57f7\u884c<code>cowsay</code>\u5957\u4ef6\u4f86\u8a66\u8a66\u770b,<code>npx</code>\u6703\u81ea\u52d5\u53bb\u627e\u5230\u8a72\u5957\u4ef6\u7684\u8def\u5f91\u4f4d\u7f6e<ul> <li>\u4f8b: $ <code>npx cowsay</code></li> <li></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-packagejson-guide","title":"The package.json guide","text":"<ul> <li>\u5982\u679c\u60a8\u6709\u4f7f\u7528\u904eJavascript,\u6216\u662f\u66fe\u7d93\u6709\u548cJavascript\u5c08\u6848\u4e92\u52d5(interacted)\u904e,\u6216\u662f\u60a8\u662f\u4e00\u4f4dNode.js\u5f8c\u7aef\u958b\u767c\u4eba\u54e1,\u6216\u662f\u524d\u7aef\u958b\u767c\u4eba\u54e1,\u60a8\u80af\u5b9a\u8a8d\u8b58<code>package.json</code>\u9019\u500b\u6a94\u6848</li> <li>\u63a5\u4e0b\u4f86\u6211\u5011\u6703\u8a0e\u8ad6<code>package.json</code>\u9019\u500b\u6a94\u6848\u7684</li> <li>\u6709\u4ec0\u9ebc\u7528\u9014\u5462?</li> <li>\u6211\u5011\u61c9\u8a72\u8981\u5c0d\u65bc\u9019\u500b\u6a94\u6848\u6709\u4ec0\u9ebc\u8a8d\u77e5\u5462?</li> <li>\u6211\u5011\u80fd\u7528\u5b83\u505a\u4ec0\u9ebc\u7279\u5225\u7684\u4e8b\u60c5\u5462?</li> <li><code>package.json</code>\u6709\u9ede\u50cf\u662f\u6211\u5011\u5c08\u6848\u7684\u6e05\u55ae(manifest),\u5b83\u53ef\u4ee5\u7528\u4f86\u505a\u5f88\u591a\u4e8b\u60c5\u3002\u5b83\u662f\u5b89\u88dd\u5de5\u5177(configuration for tools)\u7684\u4e00\u500b\u4e2d\u592e\u5132\u5b58\u5eab(central repository)</li> <li>\u4f8b\u5982: <code>npm</code> &amp; <code>yarn</code>\u90fd\u6703\u5c07\u5957\u4ef6(package)\u7684\u540d\u7a31(names)\u8207\u5c0d\u61c9\u7248\u672c(versions)\u90fd\u5132\u5b58\u5728\u9019\u88e1</li> <li><code>package.json</code>\u7684\u6a94\u6848\u7d50\u69cb(file structure)</li> <li>\u4ee5\u4e0b\u662f\u4e00\u500b<code>package.json</code>\u6a94\u6848\u7684\u7bc4\u4f8b<ul> <li><code>{}</code></li> </ul> </li> <li>\u6211\u5011\u53ef\u4ee5\u770b\u5230\u539f\u59cb\u7684<code>package.json</code>\u6a94\u6848\u5167\u5bb9\u662f\u7a7a\u7684,\u5c0d\u65bc\u61c9\u7528\u7a0b\u5f0f\u4f86\u8aaa,\u5b83\u6c92\u6709\u4ec0\u9ebc\u56fa\u5b9a\u7684\u8981\u6c42,\u552f\u4e00\u7684\u8981\u6c42\u5c31\u662f\u9700\u8981\u662f<code>JSON</code>\u7684\u8cc7\u6599\u683c\u5f0f; \u5426\u5247\u7a0b\u5f0f\u5c07\u7121\u6cd5\u900f\u904e\u7a0b\u5f0f\u7684\u65b9\u5f0f(programmatically)\u4f86\u8b80\u53d6\u5b83</li> <li>\u5982\u679c\u6211\u5011\u5728\u5efa\u69cb(build)\u4e00\u500bNode\u5957\u4ef6,\u4e26\u900f\u904e<code>npm</code>\u4f86\u5206\u767c(distribute over)\u5b83,\u5c07\u767c\u751f\u6839\u672c\u6027\u7684\u8b8a\u5316(things change radically),\u4e26\u4e14\u5fc5\u9808\u6709\u4e00\u7d44\u5c6c\u6027\u4f86\u5e6b\u52a9\u5176\u4ed6\u4eba\u4f86\u4f7f\u7528\u9019\u500b\u5957\u4ef6<ul> <li>\u9019\u662f\u53e6\u4e00\u500b<code>package.json</code>\u6a94\u6848\u7684\u7bc4\u4f8b   JavaScript<pre><code>{\n  \"name\": \"test-project\"\n}\n</code></pre></li> <li>\u5b83\u5b9a\u7fa9\u4e86\u4e00\u500b<code>name</code>\u5c6c\u6027(property),\u8a72\u5c6c\u6027\u6703\u544a\u8a34\u61c9\u7528\u7a0b\u5f0f(application)\u6216\u662f\u5957\u4ef6(package),\u5176\u5c6c\u6027\u4e5f\u6703\u5305\u542b\u65bc\u8a72<code>package.json</code>\u6a94\u6848\u6240\u5c6c\u7684\u5c08\u6848\u76ee\u9304\u4e2d</li> </ul> </li> <li>\u4ee5\u4e0b\u662f\u4e00\u500b\u66f4\u8907\u96dc\u7684\u7bc4\u4f8b,\u9019\u500b\u7bc4\u4f8b\u662f\u5f9eVue.js\u7684\u61c9\u7528\u7a0b\u5f0f\u6240\u63d0\u53d6\u51fa\u4f86\u7684\u4e00\u90e8\u5206       JavaScript<pre><code>{\n  \"name\": \"test-project\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A Vue.js project\",\n  \"main\": \"src/main.js\",\n  \"private\": true,\n  \"scripts\": {\n    \"dev\": \"webpack-dev-server --inline --progress --config build/webpack.dev.conf.js\",\n    \"start\": \"npm run dev\",\n    \"unit\": \"jest --config test/unit/jest.conf.js --coverage\",\n    \"test\": \"npm run unit\",\n    \"lint\": \"eslint --ext .js,.vue src test/unit\",\n    \"build\": \"node build/build.js\"\n  },\n  \"dependencies\": {\n    \"vue\": \"^2.5.2\"\n  },\n  \"devDependencies\": {\n    \"autoprefixer\": \"^7.1.2\",\n    \"babel-core\": \"^6.22.1\",\n    \"babel-eslint\": \"^8.2.1\",\n    \"babel-helper-vue-jsx-merge-props\": \"^2.0.3\",\n    \"babel-jest\": \"^21.0.2\",\n    \"babel-loader\": \"^7.1.1\",\n    \"babel-plugin-dynamic-import-node\": \"^1.2.0\",\n    \"babel-plugin-syntax-jsx\": \"^6.18.0\",\n    \"babel-plugin-transform-es2015-modules-commonjs\": \"^6.26.0\",\n    \"babel-plugin-transform-runtime\": \"^6.22.0\",\n    \"babel-plugin-transform-vue-jsx\": \"^3.5.0\",\n    \"babel-preset-env\": \"^1.3.2\",\n    \"babel-preset-stage-2\": \"^6.22.0\",\n    \"chalk\": \"^2.0.1\",\n    \"copy-webpack-plugin\": \"^4.0.1\",\n    \"css-loader\": \"^0.28.0\",\n    \"eslint\": \"^4.15.0\",\n    \"eslint-config-airbnb-base\": \"^11.3.0\",\n    \"eslint-friendly-formatter\": \"^3.0.0\",\n    \"eslint-import-resolver-webpack\": \"^0.8.3\",\n    \"eslint-loader\": \"^1.7.1\",\n    \"eslint-plugin-import\": \"^2.7.0\",\n    \"eslint-plugin-vue\": \"^4.0.0\",\n    \"extract-text-webpack-plugin\": \"^3.0.0\",\n    \"file-loader\": \"^1.1.4\",\n    \"friendly-errors-webpack-plugin\": \"^1.6.1\",\n    \"html-webpack-plugin\": \"^2.30.1\",\n    \"jest\": \"^22.0.4\",\n    \"jest-serializer-vue\": \"^0.3.0\",\n    \"node-notifier\": \"^5.1.2\",\n    \"optimize-css-assets-webpack-plugin\": \"^3.2.0\",\n    \"ora\": \"^1.2.0\",\n    \"portfinder\": \"^1.0.13\",\n    \"postcss-import\": \"^11.0.0\",\n    \"postcss-loader\": \"^2.0.8\",\n    \"postcss-url\": \"^7.2.1\",\n    \"rimraf\": \"^2.6.0\",\n    \"semver\": \"^5.3.0\",\n    \"shelljs\": \"^0.7.6\",\n    \"uglifyjs-webpack-plugin\": \"^1.1.1\",\n    \"url-loader\": \"^0.5.8\",\n    \"vue-jest\": \"^1.0.2\",\n    \"vue-loader\": \"^13.3.0\",\n    \"vue-style-loader\": \"^3.0.1\",\n    \"vue-template-compiler\": \"^2.5.2\",\n    \"webpack\": \"^3.6.0\",\n    \"webpack-bundle-analyzer\": \"^2.9.0\",\n    \"webpack-dev-server\": \"^2.9.1\",\n    \"webpack-merge\": \"^4.1.0\"\n  },\n  \"engines\": {\n    \"node\": \"&gt;= 6.0.0\",\n    \"npm\": \"&gt;= 3.0.0\"\n  },\n  \"browserslist\": [\"&gt; 1%\", \"last 2 versions\", \"not ie &lt;= 8\"]\n}\n</code></pre><ul> <li>\u9019\u88e1\u6709\u5e7e\u500b\u91cd\u8981\u7684\u5c6c\u6027\u8981\u8aaa\u660e</li> <li><code>version</code>: \u8868\u793a\u76ee\u524d\u7684\u7248\u672c\u865f</li> <li><code>name</code>: \u8a2d\u5b9a\u61c9\u7528\u7a0b\u5f0f(application)/\u5957\u4ef6(package)\u7684\u540d\u7a31</li> <li><code>description</code>: \u7c21\u55ae\u7684\u63cf\u8ff0\u8a72\u61c9\u7528\u7a0b\u5f0f(application)/\u5957\u4ef6(package)</li> <li><code>main</code>: \u8a2d\u5b9a\u61c9\u7528\u7a0b\u5f0f\u7684\u5165\u53e3\u9ede(entry point)</li> <li><code>private</code>: \u5982\u679c\u8a2d\u5b9a\u70ba<code>true</code>,<code>npm</code>\u5c31\u6703\u62d2\u7d55\u767c\u5e03\u8a72\u61c9\u7528\u7a0b\u5f0f(application)/\u5957\u4ef6(package),\u6b64\u5c6c\u6027\u662f\u7528\u4f86\u9632\u6b62\u6211\u5011\u4e0d\u5c0f\u5fc3\u516c\u958b\u5730\u767c\u5e03\u9019\u500b\u61c9\u7528\u7a0b\u5f0f(application)/\u5957\u4ef6(package)</li> <li><code>scripts</code>: \u5b9a\u7fa9\u4e00\u7d44<code>node</code>\u7684<code>CLI</code>\u8173\u672c(scripts)\u6307\u4ee4</li> <li><code>dependencies</code>: \u8a2d\u5b9a\u4e00\u500b<code>npm</code>\u9700\u8981\u5b89\u88dd\u7684\u76f8\u4f9d\u6027\u5957\u4ef6\u6e05\u55ae(list)</li> <li><code>devDependencies</code>: \u8a2d\u5b9a\u4e00\u500b\u5728\u958b\u767c\u74b0\u5883(development)\u4e2d<code>npm</code>\u9700\u8981\u5b89\u88dd\u7684\u76f8\u4f9d\u6027\u5957\u4ef6\u6e05\u55ae(list)</li> <li><code>engines</code>: \u8a2d\u5b9a\u8981\u7528\u54ea\u500bNode\u7684\u7248\u672c\u4f86\u904b\u884c\u8a72\u61c9\u7528\u7a0b\u5f0f(application)/\u5957\u4ef6(package)</li> <li><code>browserslist</code>: \u7528\u4f86\u8072\u660e\u8a72\u61c9\u7528\u7a0b\u5f0f(application)/\u5957\u4ef6(package)\u6709\u652f\u63f4\u54ea\u4e9b\u700f\u89bd\u5668 &amp; \u5176\u700f\u89bd\u5668\u7684\u7248\u672c</li> <li>\u4ee5\u4e0a\u7684\u6240\u6709\u5c6c\u6027,\u90fd\u53ef\u4ee5\u88ab<code>npm</code>\u6216\u662f\u5176\u4ed6\u53ef\u4ee5\u8b80\u53d6<code>package.json</code>\u7684\u6a94\u6848\u6240\u4f7f\u7528</li> </ul> </li> <li><code>package.json</code>\u7684\u5c6c\u6027\u5206\u985e(properties breakdown)</li> <li>\u672c\u7ae0\u7bc0\u6703\u958b\u59cb\u8a73\u7d30\u63cf\u8ff0\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u7684<code>package.json</code>\u6a94\u6848\u7684\u5c6c\u6027\u7d30\u7bc0\u3002\u5728\u9019\u88e1\u6211\u5011\u4e3b\u8981\u8a0e\u8ad6\u7684\u662f\u5957\u4ef6(package),\u4f46\u662f\u540c\u6a23\u7684\u9053\u7406\u4e5f\u9069\u7528\u65bc\u6211\u5011\u672c\u5730\u7aef(local)\u7684\u61c9\u7528\u7a0b\u5f0f</li> <li>\u9019\u4e9b\u5c6c\u6027\u5927\u591a\u6578\u50c5\u6703\u5728npm\u5b98\u7db2\u4e0a\u6240\u7528\u5230\u3002\u53e6\u5916,\u5176\u4ed6\u5c6c\u6027\u5247\u6703\u8207\u6211\u5011\u7684\u7a0b\u5f0f\u78bc(code)\u4e92\u52d5(interact with),\u50cf\u662f<code>npm</code>\u6216\u662f\u5176\u4ed6\u7684\u5957\u4ef6\u7ba1\u7406\u5305\u5de5\u5177</li> <li>\u4ee5\u4e0b\u5217\u8209<code>package.json</code>\u4e2d\u7684\u5e7e\u500b\u5e38\u7528\u4e14\u91cd\u8981\u7684\u5c6c\u6027<ul> <li><code>name</code>: \u8a2d\u5b9a\u5957\u4ef6(package)\u540d\u7a31   JavaScript<pre><code>\"name\": \"test-project\"\n</code></pre></li> <li><code>name</code>\u5c6c\u6027\u7684\u547d\u540d\u898f\u5247\u6709\u4ee5\u4e0b\u5e7e\u9805<ul> <li>\u5fc5\u9808\u5c0f\u65bc214\u5b57\u5143(characters)\u7684\u9577\u5ea6\u9650\u5236</li> <li>\u4e0d\u80fd\u542b\u6709\u7a7a\u683c(spaces)</li> <li>\u50c5\u80fd\u4f7f\u7528 \u5c0f\u5beb \u82f1\u6587\u5b57\u6bcd</li> <li>\u53ef\u4ee5\u4f7f\u7528\u9023\u5b57\u865f(hyphens) &amp; \u5e95\u7dda(underscores)</li> </ul> </li> <li>\u9019\u662f\u56e0\u70ba\u7576\u8a72\u5957\u4ef6(package)\u88ab\u767c\u5e03(publish)\u5230<code>npm</code>\u4e0a\u6642,\u5b83\u6703\u57fa\u65bc<code>name</code>\u5c6c\u6027\u7684\u503c\u4f86\u53d6\u5f97\u4e00\u6bb5\u81ea\u5df1\u7684(own) URL</li> <li>\u5982\u679c\u6211\u5011\u8981\u767c\u5e03\u4e00\u500b\u5957\u4ef6(package)\u5230<code>GitHub</code>\u4e0a\u6642,\u6b64<code>name</code>\u5c6c\u6027\u5c31\u662f\u4e00\u500b\u4f5c\u70baGitHub\u4e0a\u5132\u5b58\u5eab(repository)\u7684\u540d\u7a31</li> <li><code>author</code>: \u5217\u51fa\u8a72\u5957\u4ef6\u7684\u4f5c\u8005\u7684\u76f8\u95dc\u8cc7\u8a0a,\u53ef\u4ee5\u7528\u4ee5\u4e0b2\u7a2e\u5f62\u5f0f\u4f86\u8868\u793a(\u76f4\u63a5\u5217\u8209 or \u7269\u4ef6(object))   JavaScript<pre><code>{\n  \"author\": \"Joe &lt;joe@whatever.com&gt; (https://whatever.com)\"\n}\n</code></pre> JavaScript<pre><code>{\n  \"author\": {\n    \"name\": \"Joe\",\n    \"email\": \"joe@whatever.com\",\n    \"url\": \"https://whatever.com\"\n  }\n}\n</code></pre></li> <li>\u4f5c\u8005(author)\u70ba\u4e00\u500b\u4eba,\u53ef\u4ee5\u7528\u7269\u4ef6(object)\u7684\u5f62\u5f0f\u4f86\u8868\u793a,\u6703\u6709\u4e00\u500b<code>name</code>\u7684\u9375(key)\u503c(value),\u4e26\u4e14\u901a\u5e38\u6703\u6709<code>url</code>\u8207<code>email</code>\u7684\u9375\u503c</li> <li><code>contributors</code>: \u9664\u4e86\u4f5c\u8005(author)\u4ee5\u5916,\u8a72\u61c9\u7528\u7a0b\u5f0f(application)/\u5957\u4ef6(package)\u53ef\u4ee5\u53e6\u5916\u67091~\u591a\u500b\u8ca2\u737b\u8005(contributors),\u53ef\u4ee5\u7528\u9663\u5217(array)\u7684\u5f62\u5f0f\u4f86\u8868\u793a   JavaScript<pre><code>{\n  \"contributors\": [\"Joe &lt;joe@whatever.com&gt; (https://whatever.com)\"]\n}\n</code></pre> JavaScript<pre><code>{\n  \"contributors\": [\n    {\n      \"name\": \"Joe\",\n      \"email\": \"joe@whatever.com\",\n      \"url\": \"https://whatever.com\"\n    }\n  ]\n}\n</code></pre></li> <li><code>bug</code>: \u9023\u7d50\u5230\u8a72\u5957\u4ef6(package)\u7684\u554f\u984c\u8ffd\u8e64\u5340,\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\u6703\u662f\u4e00\u500b<code>GitHub</code>\u7684\u554f\u984c\u8a0e\u8ad6\u9801\u9762(issue page)   JavaScript<pre><code>  {\n    \"bugs\": \"https://github.com/whatever/package/issues\"\n  }\n</code></pre></li> <li><code>homepage</code>: \u8a2d\u5b9a\u4e00\u500b\u8a72\u5957\u4ef6(package)\u7684\u4e3b\u9801(homepage)\u756b\u9762\u9023\u7d50   JavaScript<pre><code>{\n  \"homepage\": \"https://whatever.com/package\"\n}\n</code></pre></li> <li><code>version</code>: \u8868\u793a\u7576\u524d\u7684(current)\u5957\u4ef6\u7248\u672c\u865f   JavaScript<pre><code>\"version\": \"1.0.0\"\n</code></pre></li> <li>\u8a72\u5c6c\u6027\u6703\u9075\u5f9e\u8a9e\u610f\u5316\u7248\u672c\u6a19\u8a18(semantic versioning notation)\u898f\u5247,\u4e5f\u5c31\u662f\u6240\u6709<code>npm</code>\u4e0a\u7684\u5957\u4ef6\u7248\u672c\u865f\u90fd\u6703\u662f x.x.x \u7684\u6578\u5b57\u5f62\u5f0f</li> <li>\u8a9e\u610f\u5316\u7248\u672c\u6a19\u8a18(semantic versioning notation)\u898f\u5247<ul> <li>\u7b2c\u4e00\u500b\u6578\u5b57\u4ee3\u8868\u4e3b\u8981\u7248\u672c\u865f(major version)</li> <li><code>\u4f7f\u7528\u60c5\u5883</code>: \u7576\u60a8\u9032\u884c\u4e0d\u517c\u5bb9\u7684API\u66f4\u6539\u6642\u7684\u4e3b\u8981\u7248\u672c =&gt; \u4e5f\u5c31\u662f\u7576\u8a72\u5957\u4ef6\u7248\u672c \u542b\u6709\u91cd\u5927\u66f4\u6539 \u6642</li> <li>\u7b2c\u4e8c\u500b\u6578\u5b57\u4ee3\u8868\u6b21\u8981\u7248\u672c\u865f(minor version)</li> <li><code>\u4f7f\u7528\u60c5\u5883</code>: \u4ee5\u5411\u4e0b\u517c\u5bb9\u7684\u65b9\u5f0f\u6dfb\u52a0\u529f\u80fd\u6642\u7684MINOR\u7248\u672c =&gt; \u4e5f\u5c31\u662f \u50c5\u5f15\u5165(introduces)\u8207\u904e\u53bb\u76f8\u5bb9\u7684\u5957\u4ef6\u529f\u80fd \u6642</li> <li>\u7b2c\u4e09\u500b\u6578\u5b57\u4ee3\u8868\u4fee\u88dc\u7248\u672c\u865f(patch version)</li> <li>\u5411\u5f8c\u517c\u5bb9\u7684bug\u4fee\u5fa9\u7a0b\u5e8f\u6642\u7684PATCH\u7248\u672c =&gt; \u4e5f\u5c31\u662f \u50c5\u4fee\u6539\u932f\u8aa4 (only fixes bugs)\u6642</li> <li>\u53ef\u53c3\u8003<code>npm</code>\u4e0a\u7684semver\u5957\u4ef6(package)</li> <li>\u53e6\u5916,\u4e5f\u53ef\u4ee5Semantic Versioning 2.0.0\u7684\u5b98\u65b9\u7db2\u7ad9</li> </ul> </li> <li><code>license</code>: \u8868\u793a\u4e00\u500b\u5957\u4ef6\u7684\u6388\u6b0a(license)\u7bc4\u570d   JavaScript<pre><code>\"license\": \"MIT\"\n</code></pre></li> <li>\u53ef\u53c3\u8003\u5e38\u898b\u7684\u4e94\u500b\u958b\u6e90\u5c08\u6848\u6388\u6b0a\u689d\u6b3e,\u4f7f\u7528\u8edf\u9ad4\u66f4\u81ea\u7531</li> <li><code>keywords</code>: \u5305\u542b\u8207\u8a72\u5957\u4ef6(package)\u76f8\u95dc\u7684\u95dc\u9375\u5b57\u7684\u9663\u5217(array)   JavaScript<pre><code>\"keywords\": [\n  \"email\",\n  \"machine learning\",\n  \"ai\"\n]\n</code></pre></li> <li>\u8a72\u5c6c\u6027\u662f\u7528\u4f86\u5e6b\u52a9\u5176\u4ed6\u4eba\u5728\u700f\u89bdnpm\u5b98\u7db2\u4e0a\u5176\u4ed6\u76f8\u4f3c\u7684\u5957\u4ef6\u6642,\u80fd\u900f\u904e\u9019\u4e9b\u95dc\u9375\u5b57\u66f4\u5feb\u5c0e\u5411(navigating)\u5230\u6211\u5011\u7684\u5957\u4ef6</li> <li><code>description</code>: \u5305\u542b\u4e00\u6bb5\u5c0d\u8a72\u5957\u4ef6(package)\u7684\u7c21\u6f54\u7684\u63cf\u8ff0</li> <li>\u8a72\u5c6c\u6027\u662f\u7576\u6211\u5011\u5728<code>npm</code>\u4e0a\u516c\u958b\u767c\u5e03(publish)\u6211\u5011\u7684\u5957\u4ef6(package)\u6642,\b\u80fd\u8b93\u5176\u4ed6\u4eba\u4e86\u89e3\u9019\u500b\u5957\u4ef6\u7684\u7528\u9014\u8207\u4f7f\u7528\u65b9\u6cd5,\u9019\u662f\u7279\u5225\u6709\u7528\u7684     JavaScript<pre><code>\"description\": \"A package to work with strings\"\n</code></pre></li> <li><code>repository</code>: \u6307\u5b9a\u9019\u500b\u5957\u4ef6(package)\u7684\u7a0b\u5f0f\u78bc\u5132\u5b58\u5eab\u5728\u54ea\u88e1     JavaScript<pre><code>\"repository\": \"github:whatever/testing\",\n</code></pre></li> <li> <p>\u6ce8\u610f<code>github</code>\u524d\u7db4(prefix)\u5b57\u6a23,\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u5b83\u6d41\u884c\u7684\u7a0b\u5f0f\u78bc\u5132\u5b58\u5eab,\u50cf\u662f<code>gitlab</code> or <code>bitbucket</code> JavaScript<pre><code>\"repository\": \"gitlab:whatever/testing\",\n</code></pre></p> <p>JavaScript<pre><code>\"repository\": \"bitbucket:whatever/testing\",\n</code></pre>       * \u6211\u5011\u4e5f\u53ef\u4ee5\u660e\u78ba\u5730\u8a2d\u5b9a\u4e00\u500b\u7248\u672c\u63a7\u5236\u7cfb\u7d71(version control system)   JavaScript<pre><code>\"repository\": {\n  \"type\": \"git\",\n  \"url\": \"https://github.com/whatever/testing.git\"\n}\n</code></pre>       * \u4e5f\u53ef\u4ee5\u6307\u5b9a\u5176\u5b83\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7d71,\u50cf\u662f<code>svn</code> JavaScript<pre><code>\"repository\": {\n  \"type\": \"svn\",\n  \"url\": \"...\"\n}\n</code></pre>     * <code>main</code>: \u8a2d\u5b9a\u4e00\u500b\u6b64\u5957\u4ef6\u7684\u9032\u5165\u9ede(entry point)       * \u7576\u6211\u5011\u5728\u61c9\u7528\u7a0b\u5f0f\u4e2d\u532f\u5165(import)\u6b64\u5957\u4ef6\u6642,\u8a72\u5c6c\u6027\u5c31\u6703\u5f9e\u6211\u5011\u61c9\u7528\u7a0b\u5f0f\u7684\u9019\u500b\u9032\u5165\u9ede(entry point)\u8def\u5f91\u88e1\u9762,\u641c\u5c0b(search)\u4e26\u532f\u51fa(export)\u6a21\u7d44 JavaScript<pre><code>\"main\": \"src/main.js\"\n</code></pre>     * <code>private</code>: \u7528\u4f86\u9632\u6b62\u6211\u5011\u5c07\u6b64\u5957\u4ef6\u4e0d\u5c0f\u5fc3\u516c\u958b\u5730\u767c\u5e03\u5230<code>npm</code>\u4e0a       * \u53ef\u4ee5\u5c07\u8a72\u5c6c\u6027\u503c\u8a2d\u5b9a\u70ba<code>true</code>,\u4f86\u9632\u6b62\u6211\u5011\u5c07\u6b64\u5957\u4ef6\u4e0d\u5c0f\u5fc3\u516c\u958b\u5730\u767c\u5e03\u5230<code>npm</code>\u4e0a JavaScript<pre><code>\"private\": true\n</code></pre>     * <code>scripts</code>: \u53ef\u7528\u4f86\u5b9a\u7fa9\u4e00\u7d44\u53ef\u4ee5\u7d66Node\u57f7\u884c\u7684\u8173\u672c(scripts)\u6307\u4ee4 JavaScript<pre><code>\"scripts\": {\n  \"dev\": \"webpack-dev-server --inline --progress --config build/webpack.dev.conf.js\",\n  \"start\": \"npm run dev\",\n  \"unit\": \"jest --config test/unit/jest.conf.js --coverage\",\n  \"test\": \"npm run unit\",\n  \"lint\": \"eslint --ext .js,.vue src test/unit\",\n  \"build\": \"node build/build.js\"\n}\n</code></pre>       * \u9019\u4e9b\u8173\u672c(scripts)\u6307\u4ee4\u662f\u7528\u4f86\u5728<code>CLI</code>\u7d42\u7aef\u6a5f\u4e0a\u57f7\u884c\u7684,\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u6307\u4ee4\u7684\u5f62\u5f0f\u4f86\u57f7\u884c * $ <code>npm run &lt;script name&gt;</code> * \u4f8b: $ <code>npm run dev</code> \u6216\u662f <code>yarn dev</code>     * <code>dependencies</code>: \u8a2d\u5b9a\u4e00\u500b\u6e05\u55ae\u4f86\u8868\u793a\u8a72\u5957\u4ef6\u7684\u76f8\u4f9d\u5957\u4ef6\u540d\u7a31\u8207\u5176\u5206\u5225\u7684\u7248\u672c\u865f\u4e4b\u9593\u7684\u5c0d\u61c9\u95dc\u4fc2       * \u53ef\u4ee5\u7528\u7269\u4ef6(object)\u7684\u5f62\u5f0f\u4f86\u8868\u793a,\u9375=\u76f8\u4f9d\u5957\u4ef6\u7684\u540d\u7a31,\u503c=\u5c0d\u61c9\u7684\u7248\u672c\u865f       * \u6211\u5011\u53ef\u4ee5\u4f7f\u7528<code>npm</code>\u6216\u662f<code>yarn</code>\u4f86\u5b89\u88dd\u6240\u6709\u9019\u4e9b\u76f8\u4f9d\u5957\u4ef6 * \u4f8b: $ <code>npm install &lt;PACKAGENAME&gt;</code> * \u4f8b: $ <code>yarn add &lt;PACKAGENAME&gt;</code>       * \u7576\u900f\u904e<code>npm</code>\u6216\u662f<code>yarn</code>\u4f86\u5b89\u88dd\u9019\u4e9b\u76f8\u4f9d\u5957\u4ef6\u5f8c,<code>package.json</code>\u6a94\u6848\u7684<code>dependencies</code>\u5c6c\u6027\u5c31\u6703\u81ea\u52d5\u5730\u65b0\u589e\u4e00\u689d\u8a72\u5957\u4ef6(package)\u7684\u76f8\u4f9d\u5957\u4ef6(dependencies)\u7684\u9375\u503c JavaScript<pre><code>\"dependencies\": {\n  \"vue\": \"^2.5.2\"\n}\n</code></pre>     * <code>devDependencies</code>: \u8a2d\u5b9a\u4e00\u500b\u6e05\u55ae\u4f86\u8868\u793a \u5728\u958b\u767c\u74b0\u5883(development)\u4e2d \u8a72\u5957\u4ef6\u7684\u76f8\u4f9d\u5957\u4ef6\u540d\u7a31\u8207\u5176\u5206\u5225\u7684\u7248\u672c\u865f\u4e4b\u9593\u7684\u5c0d\u61c9\u95dc\u4fc2       * \u8a72\u5c6c\u6027\u8207\u524d\u4e00\u500b<code>dependencies</code>\u5c6c\u6027\u7684\u5dee\u5225\u662f,<code>devDependencies</code>\u5c6c\u6027\u4e2d\u6240\u5217\u51fa\u7684\u76f8\u4f9d\u5957\u4ef6\u9700\u8981 \u5728\u958b\u767c\u74b0\u5883(development)\u4e2d \u624d\u6703\u88ab\u5b89\u88dd,\u4e26\u4e0d\u6703\u5728\u751f\u7522\u74b0\u5883(production)\u4e2d\u88ab\u5b89\u88dd       * \u6211\u5011\u53ef\u4ee5\u4f7f\u7528<code>npm</code>\u6216\u662f<code>yarn</code>\u4f86\u5b89\u88dd\u6240\u6709\u9019\u4e9b\u76f8\u4f9d\u5957\u4ef6 * \u4f8b: $ <code>npm install --save-dev &lt;PACKAGENAME&gt;</code> * \u4f8b: $ <code>yarn add --dev &lt;PACKAGENAME&gt;</code>       * \u7576\u900f\u904e<code>npm</code>\u6216\u662f<code>yarn</code>\u4f86\u5b89\u88dd\u9019\u4e9b\u76f8\u4f9d\u5957\u4ef6\u5f8c,<code>package.json</code>\u6a94\u6848\u7684<code>dependencies</code>\u5c6c\u6027\u5c31\u6703\u81ea\u52d5\u5730\u65b0\u589e\u4e00\u689d \u5728\u958b\u767c\u74b0\u5883(development)\u4e2d \u8a72\u5957\u4ef6(package)\u7684\u76f8\u4f9d\u5957\u4ef6(devDependencies)\u7684\u9375\u503c JavaScript<pre><code>\"devDependencies\": {\n  \"autoprefixer\": \"^7.1.2\",\n  \"babel-core\": \"^6.22.1\"\n}\n</code></pre>     * <code>engines</code>: \u53ef\u8a2d\u5b9a\u6b64\u61c9\u7528\u7a0b\u5f0f(application)/\u5957\u4ef6(package)\u60f3\u8981\u7528\u4ec0\u9ebc\u7248\u672c\u7684<code>Node</code>, <code>npm</code>, <code>yarn</code>\u4f86\u57f7\u884c or \u5b89\u88dd       * \u53ef\u6307\u5b9a\u4e00\u500b\u660e\u78ba\u7684\u7248\u672c,\u6216\u662f\u7d66\u5b9a\u4e00\u500b\u7248\u672c\u5340\u9593\u7684\u7bc4\u570d JavaScript<pre><code>\"engines\": {\n  \"node\": \"&gt;= 6.0.0\",\n  \"npm\": \"&gt;= 3.0.0\",\n  \"yarn\": \"^0.13.0\"\n}\n</code></pre>     * <code>browserslist</code>: \u7528\u4f86\u8072\u660e\u9019\u500b\u5957\u4ef6(package)\u80fd\u652f\u63f4\u54ea\u4e9b\u700f\u89bd\u5668\u4ee5\u53ca\u5176\u700f\u89bd\u5668\u7684\u5c0d\u61c9\u7248\u672c\u865f       * \u8a72\u5c6c\u6027\u901a\u5e38\u662f\u7d66Babel, Autoprefixer\u4ee5\u53ca\u5176\u4ed6\u7684\u5de5\u5177\u4f86\u8b80\u53d6\u7684       * \u50c5\u6703\u5c07<code>polyfills</code>\u8207<code>fallbacks</code>\u65b0\u589e\u5230\u76ee\u6a19\u700f\u89bd\u5668\u4e2d JavaScript<pre><code>\"browserslist\": [\n  \"&gt; 1%\",\n  \"last 2 versions\",\n  \"not ie &lt;= 8\"\n]\n</code></pre> * \u4ee5\u4e0a\u7684\u7bc4\u4f8b\u8a2d\u5b9a\u8868\u793a\u6211\u5011\u60f3\u8981\u652f\u63f4\u904e\u53bb\u6240\u6709\u700f\u89bd\u5668\u6700\u65b0\u76842\u500b\u4e3b\u8981\u7248\u672c,\u4e26\u4e14\u81f3\u5c11\u8981\u6709\u4f7f\u75281%\u7684\u4f7f\u7528\u7387(\u4f9d\u64daCanIUse.com\u7684\u7d71\u8a08\u6578\u64da\u70ba\u6e96)\u3002\u53e6\u5916,\u4e0d\u652f\u63f4IE8\u4ee5\u53ca\u5176\u66f4\u820a\u7684\u7248\u672c       * \u53ef\u53c3\u8003<code>npm</code>\u4e0a\u7684browserslist\u5957\u4ef6     * \u7279\u6b8a\u547d\u4ee4\u7684\u5c6c\u6027(Command-specific properties)       * \u5176\u5be6<code>package.json</code>\u6a94\u6848\u9084\u53ef\u4ee5\u8a17\u7ba1(host)\u7279\u6b8a\u547d\u4ee4(command-specific)\u7684\u8a2d\u5b9a(configuration),\u50cf\u662feslintConfig, babel...\u7b49\u7b49\u5176\u5b83\u7684\u8a2d\u5b9a       * \u9019\u4e9b\u90fd\u662f\u7279\u6b8a\u547d\u4ee4\u7684\u5c6c\u6027\u8a2d\u5b9a,\u6211\u5011\u53ef\u4ee5\u5230\u5b83\u5011\u5206\u5225\u7684\u5b98\u65b9\u6587\u4ef6\u4e2d\u67e5\u8a62\u8a72\u5982\u4f55\u8a2d\u5b9a\u5b83\u5011(\u4f8b: <code>ESlint</code>, <code>Babel</code>) - \u5957\u4ef6\u7684\u7248\u672c\u865f(Package versions)   + \u6211\u5011\u53ef\u4ee5\u5f9e\u4e0a\u9762\u7684<code>package.json</code>\u7bc4\u4f8b\u4e2d\u770b\u5230\u50cf\u662f<code>~3.0.0</code>\u6216\u662f<code>^0.13.0</code>\u7684\u7248\u672c\u8868\u793a\u65b9\u5f0f,\u9019\u4e9b\u524d\u7db4\u7b26\u865f(symbol)\u4ee3\u8868\u8a72\u5957\u4ef6(package)\u7684\u9019\u4e9b\u76f8\u4f9d\u5957\u4ef6(dependencies)\u53ef\u4ee5\u88ab\u66f4\u65b0(update)\u5230\u54ea\u500b\u7248\u672c   + \u5176\u7248\u672c\u865f\u898f\u5247\u53ef\u53c3\u8003Semantic Versioning using npm\u7ae0\u7bc0\u7684\u8aaa\u660e   + \u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u7d44\u5408\u7bc4\u570d\u7684\u7248\u672c\u8868\u9054\u65b9\u5f0f     * \u4f8b: <code>1.0.0 || &gt;=1.1.0 &lt;1.2.0</code>     * \u4ee5\u4e0a\u7684\u7d44\u5408\u7bc4\u570d\u7684\u7248\u672c\u8868\u9054\u65b9\u5f0f\u5c31\u4ee3\u8868\u6211\u5011\u53ef\u4ee5\u4f7f\u7528<code>1.0.0</code>\u4ee5\u4e0a or \u5f9e<code>1.1.0</code>\u8d77,\u4f46\u4f4e\u65bc<code>1.2.0</code>\u7684\u7248\u672c</p> </li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-package-lockjson-file","title":"The package-lock.json file","text":"<ul> <li>\u5f9e<code>npm</code> v5.0.0\u958b\u59cb, \u5c31\u958b\u59cb\u5f15\u9032(introduced)<code>package-lock.json</code>\u6a94\u6848</li> <li><code>package-lock.json</code>\u6a94\u6848\u4e3b\u8981\u662f\u7528\u4f86\u8ffd\u8e64(track)\u6bcf\u500b\u5957\u4ef6\u5df2\u5b89\u88dd\u7684\u78ba\u5207(exact)\u7248\u672c,\u4ee5\u4fbf\u53ef\u4ee5\u5229\u7528\u76f8\u540c\u7684\u65b9\u5f0f\u4f86\u9054\u5230100%\u7684\u8907\u88fd\u51fa\u540c\u6a23\u7684\u8edf\u9ad4\u7522\u54c1,\u56e0\u6b64\u4e5f\u4e0d\u6703\u53d7\u5230\u5957\u4ef6\u7dad\u8b77\u8005(maintainers)\u66f4\u65b0\u9019\u4e9b\u5957\u4ef6\u6642\u800c\u5f71\u97ff</li> <li>\u9019\u89e3\u6c7a\u4e86\u4e00\u500b<code>package.json</code>\u6a94\u6848\u5c1a\u672a\u89e3\u6c7a\u7684\u4e00\u500b\u5177\u9ad4\u7684\u554f\u984c\u3002\u5728<code>package.json</code>\u4e2d,\u6211\u5011\u53ef\u4ee5\u5229\u7528semver\u4f86\u8a2d\u5b9a(set)\u6211\u5011\u8981\u5347\u7d1a(upgrade)\u5230\u7684\u7248\u672c,\u50cf\u662f\u6b21\u8981(minor)\u6216\u662f\u4fee\u88dc(patch)\u7248\u672c</li> <li>\u7bc4\u4f8b\u8aaa\u660e</li> <li><code>~0.13.0</code>: \u8868\u793a\u53ea\u60f3\u66f4\u65b0(update)\u4fee\u88dc\u7248\u672c,\u4f8b\u5982<code>0.13.1</code>\u53ef\u4ee5,\u4f46\u662f<code>0.14.0</code>\u5c31\u4e0d\u884c</li> <li><code>^0.13.0</code>: \u8868\u793a\u53ea\u60f3\u66f4\u65b0\u6b21\u8981(minor)\u4ee5\u53ca\u4fee\u88dc(patch)\u7248\u672c,\u4f8b\u5982<code>0.13.0</code>\u548c<code>0.14.0</code>...\u7b49\u7b49\u90fd\u662f\u53ef\u4ee5\u7684</li> <li><code>0.13.0</code>: \u8868\u793a\u6211\u5011\u5c07\u59cb\u7d42\u4f7f\u7528\u9019\u500b\u78ba\u5207\u7684\u7248\u672c\u865f</li> <li>\u6b63\u5e38\u4f86\u8aaa,\u6211\u5011 \u4e0d\u6703\u63d0\u4ea4 (commit)<code>node_modules/</code>\u8cc7\u6599\u593e,\u56e0\u70ba\u5b83\u901a\u5e38\u5f88\u5927\u3002\u7576\u6211\u5011\u60f3\u8981\u8907\u88fd\u51fa\u4e00\u4efd\u76f8\u540c\u7684\u5c08\u6848,\u53ef\u4ee5\u900f\u904e $ <code>npm install</code> \u6307\u4ee4,\u8a72\u6307\u4ee4\u5c31\u6703\u53c3\u8003<code>~</code>\u8207<code>^</code>\u8a9e\u6cd5(syntax)\u4f86\u4e0b\u8f09\u76f8\u61c9\u7684\u7248\u672c\u865f</li> <li>\u7576\u7136,\u6211\u5011\u6709\u53ef\u4ee5\u6307\u5b9a\u78ba\u5207\u7684\u7248\u672c\u865f,\u50cf\u662f<code>0.13.0</code></li> <li>\u56e0\u6b64,\u6211\u5011\u7684\u539f\u59cb\u5c08\u6848\u8207\u65b0\u521d\u59cb\u5316\u7684\u5c08\u6848\u5be6\u969b\u4e0a\u662f\u4e0d\u540c\u7684\u3002\u5373\u4f7f\u6b21\u8981(minor)\u6216\u662f\u4fee\u88dc(patch)\u7248\u672c\u4e0d\u61c9\u8a72\u5f15\u5165(introduce)\u91cd\u5927\u66f4\u6539(breaking changes),\u4f46\u662f\u6211\u5011\u90fd\u77e5\u9053\u4ecd\u7136\u53ef\u80fd\u6709<code>bug</code>\u57cb\u85cf\u5728\u5176\u4e2d</li> <li><code>package-lock.json</code>\u6a94\u6848\u6703\u8a2d\u5b9a\u76ee\u524d\u5df2\u5b89\u88dd\u7684\u5957\u4ef6\u7684 \u78ba\u5207\u7248\u672c\u865f ,<code>npm</code>\u5c31\u6703\u900f\u904e $ <code>npm install</code> \u6307\u4ee4\u4f86\u5b89\u88dd; \u5176\u5be6\u9019\u4e0d\u662f\u4e00\u500b\u4e00\u500b\u65b0\u89c0\u5ff5,\u5982\u540c<code>PHP</code>\u7684<code>Composer</code>\u5957\u4ef6\u7ba1\u7406\u5305\u5de5\u5177\u5c31\u5df2\u7d93\u4f7f\u7528\u985e\u4f3c\u7684\u7cfb\u7d71\u5f88\u591a\u5e74\u4e86</li> <li>\u5982\u679c\u8a72\u5c08\u6848\u662f\u516c\u958b\u7684,\u6216\u662f\u6211\u5011\u6709\u5176\u4ed6\u5354\u4f5c\u8005(collaborators),\u6216\u8005\u6211\u5011\u6709\u4f7f\u7528Git\u4f5c\u70ba\u7528\u4f86\u90e8\u7f72\u7684\u8cc7\u6e90,<code>package-lock.json</code>\u6a94\u6848\u90fd\u9700\u8981\u88ab\u63d0\u4ea4(commit)\u5230<code>Git</code>\u7684\u5132\u5b58\u5eab\u4e2d,\u4f7f\u5b83\u80fd\u5920\u88ab\u5176\u4ed6\u4eba\u4e0b\u8f09</li> <li>\u6240\u6709\u7684\u76f8\u4f9d\u5957\u4ef6\u90fd\u6703\u88ab<code>package-lock.json</code>\u66f4\u65b0(updated),\u7576\u6211\u5011\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\u6642</li> <li>$ <code>npm update</code></li> <li>\u4ee5\u4e0b\u662f\u5728\u4e00\u500b\u7a7a\u8cc7\u6599\u593e,\u57f7\u884c $ <code>npm install cowsay</code> \u4f86\u5b89\u88dd<code>package-lock.json</code>\u6240\u5f97\u5230\u7684\u7bc4\u4f8b\u6a94\u6848\u7d50\u69cb     JavaScript<pre><code>{\n  \"requires\": true,\n  \"lockfileVersion\": 1,\n  \"dependencies\": {\n    \"ansi-regex\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/ansi-regex/-/ansi-regex-3.\n0.0.tgz\",\n      \"integrity\": \"sha1-7QMXwyIGT3lGbAKWa922Bas32Zg=\"\n    },\n    \"cowsay\": {\n      \"version\": \"1.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/cowsay/-/cowsay-1.3.1.tgz\"\n,\n      \"integrity\": \"sha512-3PVFe6FePVtPj1HTeLin9v8WyLl+VmM1l1H/5P+BTTDkM\nAjufp+0F9eLjzRnOHzVAYeIYFF5po5NjRrgefnRMQ==\",\n      \"requires\": {\n        \"get-stdin\": \"^5.0.1\",\n        \"optimist\": \"~0.6.1\",\n        \"string-width\": \"~2.1.1\",\n        \"strip-eof\": \"^1.0.0\"\n      }\n    },\n    \"get-stdin\": {\n      \"version\": \"5.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/get-stdin/-/get-stdin-5.0.\n1.tgz\",\n      \"integrity\": \"sha1-Ei4WFZHiH/TFJTAwVpPyDmOTo5g=\"\n    },\n    \"is-fullwidth-code-point\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/is-fullwidth-code-point/-/\nis-fullwidth-code-point-2.0.0.tgz\",\n      \"integrity\": \"sha1-o7MKXE8ZkYMWeqq5O+764937ZU8=\"\n    },\n    \"minimist\": {\n      \"version\": \"0.0.10\",\n      \"resolved\": \"https://registry.npmjs.org/minimist/-/minimist-0.0.10\n.tgz\",\n      \"integrity\": \"sha1-3j+YVD2/lggr5IrRoMfNqDYwHc8=\"\n    },\n    \"optimist\": {\n      \"version\": \"0.6.1\",\n      \"resolved\": \"https://registry.npmjs.org/optimist/-/optimist-0.6.1.tgz\",\n      \"integrity\": \"sha1-2j6nRob6IaGaERwybpDrFaAZZoY=\",\n\n      \"requires\": {\n        \"minimist\": \"~0.0.1\",\n        \"wordwrap\": \"~0.0.2\"\n      }\n    },\n    \"string-width\": {\n      \"version\": \"2.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/string-width/-/string-width-2.1.1.tgz\",\n      \"integrity\": \"sha512-nOqH59deCq9SRHlxq1Aw85Jnt4w6KvLKqWVik6oA9ZklXLNIOlqg4F2yrT1MVaTjAqvVwdfeZ7w7aCvJD7ugkw==\",\n      \"requires\": {\n        \"is-fullwidth-code-point\": \"^2.0.0\",\n        \"strip-ansi\": \"^4.0.0\"\n      }\n    },\n    \"strip-ansi\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/strip-ansi/-/strip-ansi-4.0.0.tgz\",\n      \"integrity\": \"sha1-qEeQIusaw2iocTibY1JixQXuNo8=\",\n      \"requires\": {\n        \"ansi-regex\": \"^3.0.0\"\n      }\n    },\n    \"strip-eof\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/strip-eof/-/strip-eof-1.0.0.tgz\",\n      \"integrity\": \"sha1-u0P/VZim6wXYm1n80SnJgzE2Br8=\"\n    },\n    \"wordwrap\": {\n      \"version\": \"0.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/wordwrap/-/wordwrap-0.0.3.tgz\",\n      \"integrity\": \"sha1-o9XabNXAvAAI03I0u68b7WMFkQc=\"\n    }\n  }\n}\n</code></pre></li> <li><code>npm</code>\u6703\u4f9d\u64da\u4ee5\u4e0b4\u9ede\u4f86\u5b89\u88dd<code>cowsay</code><ul> <li>get-stdin</li> <li>optimist</li> <li>string-width</li> <li>strip-eof</li> </ul> </li> <li>\u53cd\u904e\u4f86\u8aaa,\u4ee5\u4e0a\u90a3\u4e9b\u5957\u4ef6\u4e5f\u9700\u8981\u5176\u5b83\u5957\u4ef6(packages),\u6b63\u5982\u6211\u5011\u5f9e<code>requires</code>\u5c6c\u6027\u6240\u770b\u5230\u7684<ul> <li>ansi-regex</li> <li>is-fullwidth-code-point</li> <li>minimist</li> <li>wordwrap</li> <li>strip-eof</li> </ul> </li> <li>\u5b83\u5011\u90fd\u662f\u6309\u7167\u82f1\u6587\u5b57\u6bcd\u9806\u5e8f\u4f86\u52a0\u5165\u5230<code>package-lock.json</code>\u6a94\u6848\u4e2d\u7684,\u6bcf\u500b\u5957\u4ef6\u90fd\u6703\u6709\u4ee5\u4e0b\u5e7e\u7a2e\u6b04\u4f4d<ul> <li><code>version</code>: \u7248\u672c\u865f</li> <li><code>resolved</code>: \u6307\u5411\u8a72\u5957\u4ef6(package)\u7684\u4e0b\u8f09\u4f4d\u7f6e</li> <li><code>integrity</code>: \u53ef\u4ee5\u7528\u4f86\u9a57\u8b49(verify)\u8a72\u5957\u4ef6\u7684\u4e00\u6bb5\u6587\u5b57(\u901a\u5e38\u6703\u662f<code>SHA512</code>\u5f62\u5f0f\u7684\u503c)</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#find-the-installed-version-of-an-npm-package","title":"Find the installed version of an npm package","text":"<p>npm list - List installed packages npm view - View registry info</p> <ul> <li>\u5982\u679c\u6211\u5011\u60f3\u8981\u6aa2\u8996\u6240\u6709\u5df2\u7d93\u5b89\u88dd\u7684\u5957\u4ef6\u7684\u6700\u65b0\u7248\u672c\u7684\u8a71(\u4e5f\u5305\u542b\u5b83\u5011\u6240\u76f8\u4f9d\u7684\u5957\u4ef6\u5011),\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4</li> <li>$ <code>npm list</code><ul> <li><code>-g</code>: \u5217\u51fa\u6240\u6709\u5df2\u7d93\u5b89\u88dd\u7684\u5168\u57df\u5957\u4ef6\u7684\u6700\u65b0\u7248\u672c</li> </ul> </li> <li></li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u6253\u958b<code>package-lock.json</code>\u6a94\u6848\u4f86\u505a\u4e00\u4e9b\u8996\u89ba\u4e0a\u7684\u6383\u63cf(visual scanning)</li> <li>\u5982\u679c\u6211\u5011\u53ea\u60f3\u8981\u5217\u51fa\u7b2c\u4e00(\u6700\u9ad8)\u968e\u5c64\u7684\u5957\u4ef6(\u57fa\u672c\u4e0a\u5c31\u662f\u6211\u5011\u5229\u7528<code>npm</code>\u4f86\u5b89\u88dd<code>package.json</code>\u4e2d\u5217\u51fa\u7684\u90a3\u4e9b\u5957\u4ef6\u5011),\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4<ul> <li>$ <code>npm list --depth=0</code></li> <li><code>--depth</code>: \u60f3\u8981\u5c55\u793a\u51fa\u7684\u5957\u4ef6\u76f8\u4f9d\u6027\u6a39\u72c0\u5716\u7684\u6700\u5927\u6df1\u5ea6</li> <li></li> </ul> </li> <li>\u6211\u5011\u6709\u53ef\u4ee5\u900f\u904e\u6307\u5b9a\u5957\u4ef6\u540d\u7a31\u4f86\u5f97\u5230\u5176\u7248\u672c\u865f<ul> <li>$ <code>npm list &lt;package&gt;</code></li> <li></li> </ul> </li> <li>\u9019\u4e5f\u9069\u7528\u65bc\u6211\u5011\u5b89\u88dd\u7684\u5957\u4ef6(package)\u7684\u76f8\u4f9d\u5957\u4ef6(dependencies)<ul> <li></li> </ul> </li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u67e5\u770b\u8a72\u5957\u4ef6\u5728<code>npm</code>\u5132\u5b58\u5eab(repository)\u4e0a\u7684 \u6700\u65b0\u7248\u672c<ul> <li>$ <code>npm view &lt;package_name&gt; version</code></li> <li></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#install-an-older-version-of-an-npm-package","title":"Install an older version of an npm package","text":"<ul> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e<code>@</code>\u8a9e\u6cd5(syntax)\u4f86\u5b89\u88dd\u8f03\u820a\u7248\u672c\u7684<code>npm</code>\u5957\u4ef6(package)</li> <li>$ <code>npm install &lt;package&gt;@&lt;version&gt;</code></li> <li>\u4f8b: $ <code>npm install cowsay@1.2.0</code></li> <li>\u4f8b: $ <code>npm install -g webpack@4.16.4</code></li> <li>\u6211\u5011\u53ef\u80fd\u6703\u5c0d\u67d0\u500b\u5957\u4ef6\u7684 \u6240\u6709\u7248\u672c \u6709\u8208\u8da3,\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u6307\u4ee4\u4f86\u6aa2\u8996</li> <li>$ <code>npm view &lt;package&gt; versions</code></li> <li>\u4f8b: $ <code>npm view cowsay versions</code><ul> <li></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#update-all-the-nodejs-dependencies-to-their-latest-version","title":"Update all the Node.js dependencies to their latest version","text":"<p>npm update - Update a package npm outdated - Check for outdated packages npm\u7684check updates\u5957\u4ef6---upgrades your package.json dependencies to the latest versions, ignoring specified versions.</p> <ul> <li>\u7576\u6211\u5011\u900f\u904e$ <code>npm install &lt;package-name&gt;</code>\u4f86\u5b89\u88dd\u6642,\u8a72\u5957\u4ef6\u7684\u6700\u65b0(latest)\u53ef\u7528(available)\u7248\u672c\u5c31\u6703\u88ab\u4e0b\u8f09\u5230<code>node_modules/</code>\u8cc7\u6599\u593e\u4e2d,\u4e26\u4e14\u5c07\u76f8\u5c0d\u61c9\u7684(corresponding)\u9805\u76ee(entry)\u65b0\u589e\u5230\u7576\u524d\u8cc7\u6599\u593e\u88e1\u9762\u7684<code>package.json</code>\u6a94\u6848 &amp; <code>package-lock.json</code>\u6a94\u6848\u4e2d</li> <li><code>npm</code>\u6703\u81ea\u52d5\u8a08\u7b97(calculates)\u8a72\u5957\u4ef6\u7684\u76f8\u4f9d\u5957\u4ef6\u5011(dependencies),\u4e26\u5b89\u88dd\u6700\u65b0\u53ef\u7528\u7684\u76f8\u4f9d\u5957\u4ef6\u5011</li> <li>\u6bd4\u5982\u8aaa,\u7576\u6211\u5011\u5b89\u88dd<code>cowsay</code>\u9019\u500b\u5957\u4ef6,\u5b83\u662f\u4e00\u500b\u53ef<code>CLI</code>\u4ecb\u9762\u7684\u5de5\u5177\u53ef\u4ee5\u8b93\u4e00\u96bb\u725b\u8aaa\u4e9b\u8a71</li> <li>\u7576\u6211\u5011\u4f7f\u7528$ <code>npm install</code>\u6307\u4ee4\u6642,\u8a72\u9805\u76ee(entry)\u5c31\u6703\u88ab\u65b0\u589e\u5230<code>package.json</code>\u6a94\u6848\u4e2d     JavaScript<pre><code>  {\n    \"dependencies\": {\n      \"cowsay\": \"^1.3.1\"\n    }\n  }\n</code></pre></li> <li>\u4ee5\u4e0b\u662f\u5f9e<code>package-lock.json</code>\u6a94\u6848\u4e2d,\u63d0\u53d6(extract)\u51fa\u7684\u7247\u6bb5\u3002\u70ba\u4e86\u6e05\u695a\u8d77\u898b,\u6211\u5011\u79fb\u9664\u4e86\u5de2\u72c0\u76f8\u4f9d\u5957\u4ef6\u7684\u5167\u5bb9     JavaScript<pre><code>  {\n    \"requires\": true,\n    \"lockfileVersion\": 1,\n    \"dependencies\": {\n      \"cowsay\": {\n        \"version\": \"1.3.1\",\n        \"resolved\": \"https://registry.npmjs.org/cowsay/-/cowsay-1.3.1.tgz\",\n        \"integrity\": \"sha512-3PVFe6FePVtPj1HTeLin9v8WyLl+VmM1l1H/5P+BTTDkMAjufp+0F9eLjzRnOHzVAYeIYFF5po5NjRrgefnRMQ==\",\n        \"requires\": {\n          \"get-stdin\": \"^5.0.1\",\n          \"optimist\": \"~0.6.1\",\n          \"string-width\": \"~2.1.1\",\n          \"strip-eof\": \"^1.0.0\"\n        }\n      }\n    }\n  }\n</code></pre></li> <li>\u4ee5\u4e0a\u5169\u500b\u6a94\u6848\u544a\u8a34\u6211\u5011\u8981\u5b89\u88dd<code>cowsay</code>\u5957\u4ef6\u7684<code>v1.3.1</code>\u7248\u672c,\u4e26\u4e14\u6211\u5011\u7684\u66f4\u65b0(updates\u898f\u5247\u662f<code>^1.3.1</code>,\u9019\u4ee3\u8868<code>npm</code>\u53ef\u4ee5\u66f4\u65b0\u6b21\u8981(minor)\u8207\u4fee\u88dc(patch)\u7248\u672c,\u50cf\u662f<code>v1.3.2</code>,<code>v1.4.0</code>, ...\u7b49\u7b49<ul> <li>\u4e5f\u5c31\u662f\u8aaa,\u7576\u6709\u6b21\u8981(minor)\u8207\u4fee\u88dc(patch)\u7248\u672c\u767c\u5e03\u6642,\u6211\u5011\u53ef\u4ee5\u900f\u904e$ <code>npm update</code>\u4f86\u66f4\u65b0\u5957\u4ef6\u7248\u672c\u3002\u9019\u6a23\u4e00\u4f86,\u6211\u5011\u5df2\u5b89\u88dd\u7684\u5957\u4ef6\u5c31\u6703\u662f\u6700\u65b0\u7248\u672c</li> <li>\u540c\u6642<code>package-lock.json</code>\u6a94\u6848\u4e5f\u6703\u52e4\u596e\u5730(diligently)\u586b\u4e0a(filled with)\u65b0\u7248\u672c; \u800c<code>package.json</code>\u6a94\u6848\u7dad\u6301\u4e0d\u8b8a</li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u6307\u4ee4,\u767c\u73fe(discover)\u662f\u5426\u6709\u5957\u4ef6\u6709\u767c\u5e03\u65b0\u7248\u672c</li> <li>$ <code>npm oudated</code><ul> <li></li> <li>\u4e0a\u8ff0\u7684\u90e8\u5206\u5957\u4ef6\u9700\u8981\u66f4\u65b0\u4e3b\u8981\u7248\u672c(major),\u9019\u6642\u5019\u5982\u679c\u6211\u5011\u57f7\u884c$ <code>npm update</code>\u5c31 \u4e0d\u6703 \u66f4\u65b0\u5230\u9019\u4e9b\u5957\u4ef6\u3002\u82e5\u8981\u66f4\u65b0\u5957\u4ef6\u7684\u4e3b\u8981(major)\u7248\u672c,\u7d55\u4e0d\u6703\u7528\u9019\u7a2e\u65b9\u5f0f,\u56e0\u70ba\u4f9d\u64da\u8a9e\u610f\u5316\u7248\u672c\u898f\u5247\u7684\u5b9a\u7fa9,\u4e3b\u8981\u7248\u672c\u7684\u66f4\u65b0\u4ee3\u8868\u6709\u91cd\u5927\u66f4\u6539(breaking changes),\u800c<code>npm</code>\u60f3\u8981\u5e6b\u6211\u5011\u7701\u4e0b\u9ebb\u7169</li> </ul> </li> <li>\u5982\u679c\u6211\u5011\u78ba\u5b9a\u60f3\u8981\u66f4\u65b0\u5957\u4ef6\u7684 \u4e3b\u8981(major)\u7248\u672c \u7684\u8a71,\u53ef\u4ee5\u5148 \u5168\u57df \u5b89\u88dd<code>check-updates</code>\u9019\u500b\u5957\u4ef6<ul> <li>$ <code>npm install -g npm-check-updates</code></li> <li>\u63a5\u8457\u57f7\u884c\u5b83(\u8a72\u5957\u4ef6)</li> <li>$ <code>ncu -u</code></li> <li>\u9019\u6a23\u5b83\u5c31\u6703\u5347\u7d1a(upgrade)\u6240\u6709\u5728<code>package.json</code>\u6a94\u6848\u4e2d<code>dependencies</code>\u8207<code>devDependencies</code>\u7684\u7248\u672c\u63d0\u793a(version hints),\u56e0\u6b64<code>npm</code>\u5c31\u53ef\u4ee5\u5b89\u88dd\u5957\u4ef6\u65b0\u7684\u4e3b\u8981\u7248\u672c</li> </ul> </li> <li>\u5982\u679c\u6211\u5011\u53ea\u662f\u4e0b\u8f09\u9060\u7aef\u5132\u5b58\u5eab\u4e0a\u7684\u5c08\u6848,\u800c\u4e0d\u5305\u542b\u5176<code>node_modules/</code>\u8cc7\u6599\u593e\u4e2d\u7684\u76f8\u4f9d\u5957\u4ef6\u7684\u8a71,\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u6307\u4ee4,\u4f86\u5b89\u88dd\u6700\u65b0\u7684\u5957\u4ef6\u7248\u672c</li> <li>$ <code>npm install</code></li> </ul>"},{"location":"programming_language/nodejs/#semantic-versioning-using-npm","title":"Semantic Versioning using npm","text":"<p>npm\u7684semver\u5957\u4ef6---The semantic versioner for npm</p> <ul> <li>\u5728Node.js\u5957\u4ef6\u7684\u4e16\u754c\u4e2d,\u6709\u4e00\u4ef6\u5f88\u68d2\u7684\u4e8b\u60c5,\u90a3\u5c31\u662f\u5b83\u5011\u7686\u540c\u610f\u4f7f\u7528\u8a9e\u610f\u5316\u7248\u672c\u898f\u5247(using Semantic Versionin)\u4f86\u4f5c\u70ba\u4ed6\u5011\u7684\u7248\u672c\u7de8\u865f</li> <li>\u8a9e\u610f\u5316\u7248\u672c\u898f\u5247\u7684\u89c0\u5ff5\u5176\u5be6\u5f88\u7c21\u55ae---&gt;\u6240\u6709\u7684\u90fd\u7531\u4e09\u500b\u6578\u5b57(digits)\u7d44\u5408\u800c\u6210</li> <li>\u7bc4\u4f8b: <code>x.y.z</code><ul> <li>\u7b2c1\u500b\u6578\u5b57<code>x</code>\u662f\u4e3b\u8981\u7248\u672c(major)</li> <li>\u7b2c2\u500b\u6578\u5b57<code>y</code>\u662f\u6b21\u8981\u7248\u672c(minor)</li> <li>\u7b2c3\u500b\u6578\u5b57<code>z</code>\u662f\u4fee\u88dc\u7248\u672c(patch)</li> </ul> </li> <li>\u7576\u6211\u5011\u767c\u5e03\u4e00\u500b\u65b0\u7684\u5957\u4ef6(package)\u7248\u672c\u6642,\u6211\u5011\u4e0d\u50c5\u53ef\u4ee5\u81ea\u5df1\u9078\u64c7\u8981\u589e\u52a0\u7684\u6578\u5b57\u4e4b\u5916,\u4e5f\u4ecd\u9808\u9075\u5b88\u4ee5\u4e0b\u898f\u5247</li> <li><code>major</code>: \u7576\u6211\u5011\u9032\u884c\u4e0d\u517c\u5bb9(incompatible)\u7684API\u4fee\u6539(changes)\u6642,\u53ef\u4ee5\u63d0\u5347(up)\u4e3b\u8981\u7248\u672c\u865f</li> <li><code>minor</code>: \u7576\u6211\u5011\u65b0\u589e\u4e00\u500b\u80fd\u5411\u5f8c\u517c\u5bb9(backward-compatible, =&gt; \u4e5f\u5c31\u662f\u80fd\u8207\u904e\u53bb\u76f8\u5bb9)\u7684\u529f\u80fd\u6642,\u53ef\u4ee5\u63d0\u5347(up)\u6b21\u8981\u7248\u672c\u865f</li> <li><code>patch</code>: \u7576\u6211\u5011\u4fee\u5fa9(fix)\u4e00\u500b\u80fd\u5411\u5f8c\u517c\u5bb9(backward-compatible bug fixes)\u7684\u932f\u8aa4(bug)\u6642,\u53ef\u4ee5\u63d0\u5347(up)\u4fee\u88dc\u7248\u672c\u865f</li> <li>\u9019\u6a23\u7684\u7248\u672c\u865f\u6163\u4f8b(convention)\u4e5f\u88ab\u6240\u6709\u7684\u7a0b\u5f0f\u8a9e\u8a00\u6240\u63a1\u7528(adopted),\u800c<code>npm</code>\u7684\u6bcf\u500b\u5957\u4ef6(package)\u6709\u90fd\u6703\u9075\u5b88(adheres to)\u6b64\u7248\u672c\u865f\u898f\u7bc4,\u6240\u4ee5\u6b64\u4e00\u7248\u672c\u865f\u898f\u7bc4\u662f\u975e\u5e38\u91cd\u8981\u7684</li> <li>\u56e0\u70ba<code>npm</code>\u8a2d\u5b9a\u4e86\u4e00\u4e9b\u898f\u5247,\u8b93\u6211\u5011\u53ef\u4ee5\u900f\u904e<code>package.json</code>\u6a94\u6848\u4f86\u9078\u64c7\u7576\u6211\u5011\u5229\u7528$ <code>npm update</code>\u6307\u4ee4\u4f86\u66f4\u65b0\u6211\u5011\u7684\u5957\u4ef6\u6642,\u8981\u66f4\u65b0\u5230\u7684\u54ea\u500b\u7248\u672c\u865f</li> <li>\u4ee5\u4e0b\u662f<code>npm</code>\u8a2d\u5b9a\u7d66<code>package.json</code>\u6a94\u6848\u7684\u7248\u672c\u865f\u898f\u7bc4\u8a9e\u6cd5<ul> <li><code>^</code>(Tilde Ranges)</li> <li>\u53ea\u6703\u66f4\u65b0(updates),\u4f46\u4e0d\u6703\u66f4\u6539\u6700\u5de6\u908a(leftmost)\u975e\u96f6(non-zero)\u7684\u6578\u5b57</li> <li>\u8209\u4f8b\u4f86\u8aaa,\u7576\u6211\u5011\u57f7\u884c$ <code>npm update</code>\u6307\u4ee4\u6642<ul> <li>\u4f8b1: <code>^0.13.0</code> =&gt; \u53ef\u4ee5\u66f4\u65b0(update)\u5230<code>0.13.1</code>\u6216<code>0.13.2</code>...\u7b49\u7b49</li> <li>\u4f8b2: <code>^1.13.0</code> =&gt; \u53ef\u4ee5\u66f4\u65b0(update)\u5230<code>1.13.1</code>\u6216<code>1.14.0</code>,\u4f46\u662f \u4e0d\u80fd \u66f4\u65b0\u5230<code>2.0.0</code>\u6216\u662f\u518d\u5176\u66f4\u4e4b\u4e0a\u7684\u7248\u672c</li> </ul> </li> <li><code>~</code> (Caret Ranges)</li> <li>\u5982\u679c\u6b21\u8981\u7248\u672c\u5728<code>package.json</code>\u4e2d\u5df2\u7d93\u6307\u5b9a\u4e86\u7684\u8a71,\u5141\u8a31\u4fee\u88dc\u5c64\u7d1a\u7684\u66f4\u6539(patch-level changes); \u82e5\u4e0d\u5141\u8a31\u4fee\u88dc\u5c64\u7d1a\u7684\u4fee\u6539\u7684\u8a71,\u5247\u5141\u8a31\u6b21\u8981\u7248\u672c\u5c64\u7d1a\u7684\u4fee\u6539(minor-level changes)</li> <li>\u8209\u4f8b\u4f86\u8aaa,\u7576\u6211\u5011\u57f7\u884c$ <code>npm update</code>\u6307\u4ee4\u6642<ul> <li>\u4f8b1: <code>~0.13.0</code> =&gt; \u53ef\u4ee5\u66f4\u65b0\u5230<code>0.13.1</code>,\u4f46\u662f \u4e0d\u80fd \u66f4\u65b0\u5230<code>0.14.0</code></li> </ul> </li> <li><code>&gt;</code></li> <li>\u53ef\u4ee5\u63a5\u53d7\u6bd4\u6211\u5011\u6307\u5b9a\u7684\u7248\u672c\u9084\u8981\u9ad8\u7684\u4efb\u4f55\u4e00\u500b\u7248\u672c</li> <li><code>&gt;=</code></li> <li>\u53ef\u4ee5\u63a5\u53d7\u8207\u6211\u5011\u6307\u5b9a\u7684\u7248\u672c\u76f8\u540cor\u9084\u8981\u9ad8\u7684\u4efb\u4f55\u4e00\u500b\u7248\u672c</li> <li><code>&lt;</code></li> <li>\u53ef\u4ee5\u63a5\u53d7\u6bd4\u6211\u5011\u6307\u5b9a\u7684\u7248\u672c\u9084\u8981\u4f4e\u7684\u4efb\u4f55\u4e00\u500b\u7248\u672c</li> <li><code>&lt;=</code></li> <li>\u53ef\u4ee5\u63a5\u53d7\u8207\u6211\u5011\u6307\u5b9a\u7684\u7248\u672c\u76f8\u540cor\u9084\u8981\u4f4e\u7684\u4efb\u4f55\u4e00\u500b\u7248\u672c</li> <li><code>=</code></li> <li>\u53ef\u4ee5\u63a5\u53d7\u8207\u6211\u5011\u6307\u5b9a\u7684\u78ba\u5207\u7248\u672c \u5b8c\u5168\u76f8\u540c \u7684\u7248\u672c</li> <li><code>-</code> (Hyphen Ranges)</li> <li>\u53ef\u4ee5\u63a5\u53d7\u4e00\u500b\u6307\u5b9a\u7bc4\u570d\u5167\u7684\u6240\u6709\u7248\u672c\u865f</li> <li>\u8209\u4f8b\u4f86\u8aaa,\u7576\u6211\u5011\u57f7\u884c$ <code>npm update</code>\u6307\u4ee4\u6642<ul> <li>\u4f8b1: <code>1.2.3 - 2.3.4</code> =&gt; \u8868\u793a\u53ef\u4ee5\u66f4\u65b0\u5230 <code>&gt;=1.2.3 &amp;&amp; &lt;=2.3.4</code>\u7684\u7248\u672c\u865f</li> </ul> </li> <li><code>||</code> (combine sets)</li> <li>\u53ef\u4ee5\u63a5\u53d7\u4e00\u500b\u7d44\u5408\u7684\u6307\u5b9a\u7bc4\u570d\u5167\u7684\u6240\u6709\u7248\u672c\u865f</li> <li>\u8209\u4f8b\u4f86\u8aaa,\u7576\u6211\u5011\u57f7\u884c$ <code>npm update</code>\u6307\u4ee4\u6642<ul> <li>\u4f8b1: <code>1.0.0 || &gt;=1.1.0 &lt;1.2.0</code> =&gt; \u53ef\u4ee5\u66f4\u65b0\u70ba<code>1.0.0</code>\u7684\u9019\u500b\u78ba\u5207\u7248\u672c,\u6216\u662f\u4e5f\u53ef\u4ee5\u66f4\u65b0\u5230<code>1.1.0</code>\u6216\u662f\u518d\u5176\u66f4\u4e4b\u4e0a\u7684\u7248\u672c,\u4f46\u662f \u4e0d\u80fd \u66f4\u65b0\u70ba<code>1.2.0</code>\u6216\u662f\u518d\u5176\u66f4\u4e4b\u4e0a\u7684\u7248\u672c</li> <li>\u4f8b2: <code>1.2.7 || &gt;=1.2.9 &lt;2.0.0</code> =&gt; \u53ef\u4ee5\u66f4\u65b0\u70ba<code>1.2.7</code>\u7684\u9019\u500b\u78ba\u5207\u7248\u672c,\u6216\u662f\u4e5f\u53ef\u4ee5\u66f4\u65b0\u5230<code>1.2.9</code>\u6216\u662f\u518d\u5176\u66f4\u4e4b\u4e0a\u7684\u7248\u672c,\u4f46\u662f \u4e0d\u80fd \u66f4\u65b0\u70ba<code>1.2.8</code>\u6216\u662f<code>2.0.0</code>\u7684\u7248\u672c</li> </ul> </li> </ul> </li> <li>\u8a9e\u610f\u5316\u7248\u672c\u898f\u5247\u4e5f\u6709\u5176\u4ed6\u7279\u6b8a\u898f\u5247</li> <li>\u7121\u4efb\u4f55\u7b26\u865f(no symbol): \u53ea\u80fd\u63a5\u53d7\u6307\u5b9a\u7684\u8a72\u660e\u78ba\u7248\u672c<ul> <li>\u4f8b: <code>1.2.1</code></li> </ul> </li> <li><code>latest</code>: \u76f4\u63a5\u6307\u5b9a\u53ef\u7528(available)\u4e14\u6700\u65b0(latest)\u7684\u8a72\u5957\u4ef6\u7248\u672c\u865f</li> </ul>"},{"location":"programming_language/nodejs/#uninstalling-npm-packages","title":"Uninstalling npm packages","text":"<p>npm uninstall - Remove a package</p> <ul> <li>\u8981\u5728\u672c\u5730\u74b0\u5883(locally)\u89e3\u9664\u5b89\u88dd(uninstall)\u4e4b\u524d\u5df2\u5b89\u88dd\u904e,\u4e26\u4e14\u5132\u5b58\u5728<code>node_modules/</code>\u8cc7\u6599\u593e\u4e2d\u7684\u5957\u4ef6(packages)\u3002\u53ef\u4ee5\u5728\u8a72\u5c08\u6848\u7684\u6839\u76ee\u9304(project root folder, =&gt; \u4e5f\u5c31\u662f\u5305\u542b<code>node_modules/</code>\u8cc7\u6599\u593e\u7684\u5c08\u6848\u6839\u76ee\u9304),\u4e26\u900f\u904e\u4ee5\u4e0b\u6307\u4ee4</li> <li>$ <code>npm uninstall &lt;package-name&gt;</code></li> <li>\u82e5\u60f3\u8981\u9023\u540c<code>package.json</code>\u6a94\u6848\u4e2d\u7684\u53c3\u8003(reference)\u4e5f\u522a\u9664\u6389\u7684\u8a71,\u53ef\u4ee5\u4f7f\u7528<code>-S</code>\u6216\u662f<code>--save</code>\u9078\u9805</li> <li>$ <code>npm uninstall --save &lt;package-name&gt;</code><ul> <li><code>--save</code>(=&gt; <code>-S</code>): <code>npm</code>\u6703\u5c07\u8a72\u5957\u4ef6(package)\u5f9e<code>package.json</code>\u6a94\u6848\u4e2d\u7684<code>dependencies</code>\u9375\u4e4b\u4e2d\u79fb\u9664</li> </ul> </li> <li>\u82e5\u6b64\u5957\u4ef6(package)\u70ba\u958b\u767c\u74b0\u5883\u6240\u4f7f\u7528\u7684\u5957\u4ef6\u7684\u8a71,\u53ef\u4ee5\u4f7f\u7528<code>-D</code>\u6216\u662f<code>--save-dev</code>\u9078\u9805</li> <li>$ <code>npm uninstall --save-dev &lt;package-name&gt;</code><ul> <li><code>--save-dev</code>(=&gt; <code>-D</code>): <code>npm</code>\u6703\u5c07\u8a72\u5957\u4ef6(package)\u5f9e<code>package.json</code>\u6a94\u6848\u4e2d\u7684<code>devDependencies</code>\u9375\u4e4b\u4e2d\u79fb\u9664</li> </ul> </li> <li>\u82e5\u6b64\u5957\u4ef6(package)\u662f\u5728\u5168\u57df\u74b0\u5883\u5b89\u88dd\u7684\u8a71,\u53ef\u4ee5\u4f7f\u7528<code>-g</code>\u6216\u662f<code>--global</code>\u9078\u9805</li> <li>$ <code>npm uninstall -g &lt;package-name&gt;</code><ul> <li><code>--global</code>(=&gt; <code>-g</code>): <code>npm</code>\u6703\u5c07\u8a72\u5957\u4ef6(package)\u5f9e\u5168\u57df\u74b0\u5883\u79fb\u9664\u6389,\u800c\u9019\u6642\u5019\u4e5f\u7121\u9700\u5728\u610f\u6211\u5011\u662f\u5728\u7cfb\u7d71\u4e0a\u7684\u54ea\u500b\u76ee\u9304\u4e0b\u57f7\u884c\u8a72\u6307\u4ee4,\u56e0\u70ba\u6211\u5011\u662f\u8981 \u5168\u57df \u89e3\u9664\u5b89\u88dd\u6b64\u5957\u4ef6</li> </ul> </li> <li>\u4f8b: $ <code>npm uninstall -g webpack</code></li> </ul>"},{"location":"programming_language/nodejs/#npm-global-or-local-packages","title":"npm global or local packages","text":"<p>npx - Run a command from a local or remote npm package</p> <ul> <li>\u672c\u5730(local)\u8207\u5168\u57df(global)\u5957\u4ef6(package)\u7684\u4e3b\u8981\u5dee\u5225\u662f</li> <li>\u672c\u5730(local)\u5957\u4ef6\u6703\u5b89\u88dd\u5728\u6211\u5011\u57f7\u884c$ <code>npm install &lt;package-name&gt;</code>\u6307\u4ee4\u6642\u7684\u90a3\u500b\u76ee\u9304\u4e0b,\u4e26\u5c07<code>node_modules/</code>\u8cc7\u6599\u593e\u653e\u5728\u9019\u500b\u8cc7\u6599\u593e\u7684\u88e1\u9762</li> <li>\u5168\u57df(global)\u5957\u4ef6\u5247\u6703\u5b89\u88dd\u5728\u4f5c\u696d\u7cfb\u7d71\u4e2d\u7684\u55ae\u4e00\u500b\u8def\u5f91\u4e0b(\u78ba\u5207\u4f86\u8aaa\u8981\u8996\u5404\u4f5c\u696d\u7cfb\u7d71\u800c\u5b9a),\u9019\u6642\u5c31\u4e0d\u6703\u7ba1\u6211\u5011\u662f\u5728\u54ea\u88e1\u57f7\u884c$ <code>npm install -g &lt;package-name&gt;</code>\u6307\u4ee4\u4e86</li> <li>\u5728\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u4e2d,\u6211\u5011 \u50c5\u80fd\u5f15\u5165(require)\u672c\u5730(local)\u5b89\u88dd\u7684\u5957\u4ef6(package)</li> <li>\u4f8b: <code>require('package-name')</code></li> <li>\u6240\u4ee5\u4ec0\u9ebc\u6642\u5019\u9700\u8981\u672c\u5730\u5b89\u88dd,\u800c\u4ec0\u9ebc\u6642\u5019\u9700\u8981\u5168\u57df\u5b89\u88dd\u5957\u4ef6\u5462?</li> <li>\u4e00\u822c\u4f86\u8aaa,\u6240\u6709\u7684\u5957\u4ef6\u90fd\u61c9\u8a72\u8981\u7528 \u672c\u5730\u5b89\u88dd (locally)<ul> <li>\u9019\u6a23\u53ef\u4ee5\u78ba\u4fdd\u5728\u6211\u5011\u7684\u96fb\u8166\u4e2d\u6709\u8a31\u591a\u7684(dozens of)\u61c9\u7528\u7a0b\u5f0f(application),\u800c\u9019\u4e9b\u5957\u4ef6\u4e5f\u5206\u5225\u9700\u8981\u7528\u5230\u4e0d\u540c\u7248\u672c\u7684\u76f8\u4f9d\u5957\u4ef6\u6642,\u4e0d\u6703\u6df7\u4e82\u6389</li> </ul> </li> <li>\u66f4\u65b0\u5168\u57df\u5b89\u88dd\u7684\u5957\u4ef6\u6703\u8b93\u6211\u5011\u6574\u53f0\u96fb\u8166\u7684\u6240\u6709\u5c08\u6848\u90fd\u88ab\u8feb\u9700\u8981\u7528\u6700\u65b0\u7248\u672c\u7684\u5957\u4ef6\u3002\u800c\u9019\u4e5f\u8b93\u6211\u5011\u53ef\u4ee5\u60f3\u50cf\u5230,\u5c0d\u65bc\u7dad\u904b\u9762\u4f86\u8aaa,\u9019\u6703\u662f\u591a\u5927\u7684\u4e00\u5834\u60e1\u5922\u3002\u56e0\u70ba\u67d0\u4e9b\u5957\u4ef6\u53ef\u80fd\u6703\u7834\u58de(break)\u8207\u5176\u4ed6\u76f8\u4f9d\u5957\u4ef6(dependencies)\u4e4b\u9593\u7684\u76f8\u5bb9\u6027(compatibility)</li> <li>\u6240\u6709\u7684\u5c08\u6848\u90fd\u6709\u5b83\u5011\u81ea\u5df1\u7684\u672c\u5730\u5b89\u88dd(local)\u7684\u5957\u4ef6\u7248\u672c,\u5373\u4f7f\u9019\u6a23\u53ef\u80fd\u770b\u4f3c\u662f\u4e00\u7a2e\u6d6a\u8cbb\u8cc7\u6e90\u7684\u884c\u70ba,\u4f46\u8207\u5176\u53ef\u80fd\u9020\u6210\u7684\u8ca0\u9762\u5f71\u97ff(negative consequences)\u76f8\u6bd4,\u9019\u6a23\u7b97\u662f\u975e\u5e38\u5c0f\u7684\"\u6d6a\u8cbb\"</li> <li>\u53ea\u6709\u5728\u6211\u5011\u9700\u8981\u4e00\u500b\u53ef\u57f7\u884c(executable)\u5728<code>CLI</code>\u4ecb\u9762\u4e0a\u7684\u6307\u4ee4(command),\u4e26\u4e14\u9019\u500b\u53ef\u57f7\u884c\u547d\u4ee4\u662f\u80fd\u8de8\u5c08\u6848\u4e4b\u9593(across project)\u80fd\u88ab\u91cd\u8907\u4f7f\u7528\u7684(reused),\u90a3\u9019\u6642\u5019\u5c31\u6703\u9700\u8981 \u5168\u57df\u5b89\u88dd\u5957\u4ef6 (global)</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u672c\u5730(locally)\u5b89\u88dd\u53ef\u57f7\u884c\u547d\u4ee4(executable commands),\u4e26\u900f\u904e<code>npx</code>\u4f86\u57f7\u884c\u3002\u4f46\u662f\u6709\u4e9b\u7279\u5b9a\u7684\u5957\u4ef6(package),\u9084\u662f\u6703\u5efa\u8b70\u7528\u5168\u57df(globally)\u7684\u65b9\u5f0f\u4f86\u5b89\u88dd<ul> <li>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u6d41\u884c\u4e14\u5efa\u8b70\u9700\u8981\u5168\u57df\u5b89\u88dd\u7684\u5957\u4ef6</li> <li>npm</li> <li>create-react-app</li> <li>vue-cli</li> <li>grunt-cli</li> <li>mocha</li> <li>react-native-cli</li> <li>gatsby-cli</li> <li>forever</li> <li>nodemon</li> </ul> </li> <li>\u53ef\u53c3\u8003\u5b98\u65b9\u6587\u4ef6---npx VS npm exec\u7ae0\u7bc0\u7684\u8aaa\u660e</li> <li>\u5982\u679c\u6211\u5011\u60f3\u77e5\u9053\u76ee\u524d\u5728\u6211\u5011\u7cfb\u7d71\u4e2d\u5df2\u7d93\u5168\u57df\u5b89\u88dd\u7684\u5957\u4ef6\u6709\u54ea\u4e9b\u7684\u8a71,\u53ef\u4ee5\u900f\u904e\u57f7\u884c\u4ee5\u4e0b\u7684\u6307\u4ee4<ul> <li>$ <code>npm list -g --depth 0</code></li> <li></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#npm-dependencies-and-devdependencies","title":"npm dependencies and devDependencies","text":"<ul> <li>\u7576\u6211\u5011\u900f\u904e$ <code>npm install &lt;package-name&gt;</code>\u6307\u4ee4\u4f86\u5b89\u88dd\u4e00\u500b<code>npm</code>\u4e0a\u7684\u5957\u4ef6\u6642,\u9019\u5c31\u662f\u5c07\u5176\u5b89\u88dd\u70ba\u76f8\u4f9d\u5957\u4ef6(dependency)</li> <li>\u9019\u500b\u88ab\u5b89\u88dd\u7684\u76f8\u4f9d\u5957\u4ef6\u6703\u81ea\u52d5\u5730\u88ab\u5217\u51fa\u5728<code>package.json</code>\u6a94\u6848\u4e2d</li> <li>\u5982\u679c\u6211\u5011\u52a0\u4e0a<code>-D</code>\u6216\u662f<code>--save-dev</code>\u9078\u9805\u7684\u8a71,<code>npm</code>\u5c31\u6703\u8996\u70ba\u8981\u5b89\u88dd\u4f5c\u70ba\u958b\u767c\u74b0\u5883\u4f7f\u7528\u7684\u76f8\u4f9d\u5957\u4ef6(development dependency),\u540c\u6642\u4e5f\u6703\u81ea\u52d5\u5730\u65b0\u589e\u5230<code>package.json</code>\u6a94\u6848\u4e2d\u7684<code>devDependencies</code>\u9375\u4e2d</li> <li>\u958b\u767c\u74b0\u5883\u7684\u76f8\u4f9d\u5957\u4ef6(development dependency)\u65e8\u5728\u50c5\u7528\u5728\u958b\u767c\u74b0\u5883\u6240\u4f7f\u7528\u7684\u5957\u4ef6(development-only packages),\u800c\u9019\u4e9b\u5957\u4ef6\u4e5f\u4e0d\u6703\u5728\u751f\u7522\u74b0\u5883(production)\u4e2d\u6240\u4f7f\u7528</li> <li>\u4f8b: <code>testing packages</code> or <code>webpack</code> or <code>Babel</code></li> <li>\u7576\u6211\u5011\u5728\u751f\u7522\u74b0\u5883(production)\u4e2d,\u5982\u679c\u6211\u5011\u8f38\u5165$ <code>npm install</code>\u6307\u4ee4,\u4e26\u4e14\u5728\u8a72\u76ee\u9304\u4e2d\u5df2\u7d93\u6709\u4e00\u500b<code>package.json</code>\u6a94\u6848\u7684\u8a71,\u5247\u6703\u5b89\u88dd<code>package.json</code>\u6a94\u6848\u4e2d<code>dependencies</code>\u5c6c\u6027\u88e1\u9762\u7684\u6240\u6709\u5957\u4ef6,\u56e0\u70ba<code>npm</code>\u9810\u8a2d\u6703\u5047\u5b9a\u9019\u662f\u4e00\u500b\u958b\u767c\u90e8\u7f72(development deploy)</li> <li>\u9019\u6642\u5c31\u5fc5\u9808\u8981\u52a0\u4e0a<code>--production</code>\u9078\u9805\u4f86\u907f\u514d\u5b89\u88dd\u5230\u90a3\u4e9b\u958b\u767c\u74b0\u5883\u7684\u76f8\u4f9d\u5957\u4ef6(development dependencies)<ul> <li>$ <code>npm install --production &lt;package-name&gt;</code></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-npx-nodejs-package-runner","title":"The npx Node.js Package Runner","text":"<p>npm\u7684npx\u5957\u4ef6---execute npm package binaries nvm---nvm is a version manager for node.js, designed to be installed per-user, and invoked per-shell</p> <ul> <li><code>npx</code>\u662f\u4e00\u500b\u5f37\u5927\u7684\u5de5\u5177,\u662f\u5f9e<code>npm</code>\u7684<code>v5.2.0</code>(\u7d04\u65bc2017/06\u6708)\u767c\u5e03\u4ee5\u5f8c,\u5c31\u5df2\u7d93\u958b\u59cb\u53ef\u4ee5\u4f7f\u7528</li> <li>\u5982\u679c\u6211\u5011\u4e0d\u60f3\u4e0b\u8f09<code>npm</code>,\u53ef\u4ee5\u900f\u904einstall npx as a standalone package</li> <li><code>npx</code>\u8b93\u6211\u5011\u53ef\u4ee5\u5728Node\u74b0\u5883\u4e2d\u57f7\u884c\u7a0b\u5f0f\u78bc,\u4e26\u900f\u904e<code>npm registry</code>\u4f86\u767c\u5e03</li> <li>\u8f15\u9b06\u5730\u57f7\u884c\u672c\u5730\u6307\u4ee4(local commands)</li> <li>\u904e\u53bb,Node\u7684\u958b\u767c\u8005\u5011\u901a\u5e38\u5c07\u53ef\u57f7\u884c\u547d\u4ee4(executable commands)\u767c\u5e03\u70ba\u4e00\u500b\u5168\u57df\u5957\u4ef6(global package),\u4ee5\u4f7f\u5b83\u5011\u7acb\u5373\u4f4d\u65bc\u8def\u5f91(path)\u4e2d,\u4e26\u4e14\u662f\u7acb\u5373\u53ef\u4ee5\u88ab\u57f7\u884c\u7684<ul> <li>\u9019\u6a23\u5176\u5be6\u5f88\u75db\u82e6,\u56e0\u70ba\u6211\u5011\u78ba\u5be6\u7121\u6cd5\u5728\u540c\u4e00\u500b\u6307\u4ee4\u4e2d\u5b89\u88dd\u4e0d\u540c\u7684\u7248\u672c</li> </ul> </li> <li>\u57f7\u884c$ <code>npx &lt;command-name&gt;</code>\u6307\u4ee4\u6703\u81ea\u52d5\u5730\u627e\u51fa\u5728\u8a72\u5c08\u6848\u76ee\u9304\u4e2d\u7684<code>node_modules/</code>\u8cc7\u6599\u593e\u4e2d\u7684\u6b64\u6307\u4ee4\u7684\u78ba\u5207\u53c3\u8003\u4f4d\u7f6e(correct reference of the command),\u800c\u7121\u9700\u77e5\u9053\u78ba\u5207\u7684\u8def\u5f91,\u4e5f\u4e0d\u9700\u8981\u5728\u5168\u57df(global)\u8def\u5f91\u548c\u7528\u6236\u8def\u5f91\u4e2d(user's path)\u5b89\u88dd\u5957\u4ef6</li> <li>\u7121\u9700\u5148\u5b89\u88dd,\u5c31\u80fd\u76f4\u63a5\u57f7\u884c\u7684\u6307\u4ee4</li> <li><code>npx</code>\u5957\u4ef6\u7684\u7684\u53e6\u4e00\u500b\u91cd\u8981\u7684\u529f\u80fd\u662f\u6211\u5011\u80fd\u76f4\u63a5\u57f7\u884c\u6307\u4ee4(run commands),\u800c\u4e0d\u9700\u8981\u4e8b\u5148\u5b89\u88dd\u5b83\u5011<ul> <li>\u9019\u500b\u529f\u80fd\u662f\u975e\u5e38\u6709\u7528\u7684,\u4e3b\u8981\u662f\u56e0\u70ba</li> <li>\u6211\u5011\u4e0d\u9700\u8981\u4e8b\u5148\u5b89\u88dd\u8a72\u5957\u4ef6</li> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e<code>syntax @version</code>\u7684\u65b9\u5f0f\u4f86\u57f7\u884c\u540c\u4e00\u500b\u6307\u4ee4\u7684\u4e0d\u540c\u7248\u672c</li> </ul> </li> <li>\u6211\u5011\u7528<code>npm</code>\u7684<code>cowsay</code>\u5957\u4ef6\u4f86\u505a\u500b\u5c55\u793a\u900f\u904e<code>npx</code>\u4f86\u547c\u53eb<code>cowsay</code>\u5957\u4ef6\u7684\u6307\u4ee4\u3002\u8a72\u5957\u4ef6\u6703\u6253\u5370(print)\u51fa\u4e00\u96bb\u725b\u4e26\u8aaa\u51fa\u6211\u5011\u5728<code>CLI</code>\u4ecb\u9762\u4e0a\u8f38\u5165\u7684\u6307\u4ee4<ul> <li>\u8209\u4f8b\u4f86\u8aaa,\u7576\u6211\u5011\u5728<code>CLI</code>\u4ecb\u9762\u4e0a\u8f38\u5165$ <code>cowsay \"Hello\"</code></li> <li></li> <li>\u4ee5\u4e0a\u7684\u65b9\u5f0f,\u50c5\u6703\u5728\u6211\u5011\u6709\u900f\u904e<code>npm</code>\u5168\u57df(globally)\u5b89\u88dd<code>cowsay</code>\u5957\u4ef6\u6642\u624d\u80fd\u4f7f\u7528,\u5426\u5247\u7576\u6211\u5011\u57f7\u884c\u8a72\u6307\u4ee4\u6642,\u6703\u5f97\u5230\u932f\u8aa4(error)</li> <li><code>npx</code>\u53ef\u4ee5\u4f7f\u6211\u5011\u4e0d\u5fc5\u4e8b\u5148\u672c\u5730(locally)\u5b89\u88dd,\u5c31\u80fd\u57f7\u884c\u8a72\u6307\u4ee4</li> <li>\u4f8b: $ <code>npx cowsay \"Hello\"</code></li> </ul> </li> <li>\u7136\u800c,\u9019\u662f\u4e00\u500b\u6709\u8da3\u4f46\u6c92\u6709\u7528\u7684\u7bc4,\u5176\u4ed6\u60c5\u5883\u5305\u62ec<ul> <li>\u57f7\u884c<code>vue CLI</code>\u5de5\u5177</li> <li>\u4f8b: $ <code>npx @vue/cli create my-vue-app</code></li> <li>\u900f\u904e<code>npm</code>\u7684<code>create-react-app</code>\u4f86\u5efa\u7acb\u4e00\u500b\u65b0\u7684React app</li> <li>\u4f8b: $ <code>npx create-react-app my-react-app</code></li> </ul> </li> <li>\u900f\u904e\u4e0d\u540c\u7684Node\u7248\u672c\u4f86\u57f7\u884c\u7a0b\u5f0f\u78bc</li> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e<code>@</code>\u8a9e\u6cd5\u4f86\u6307\u5b9a\u4e00\u500b\u7279\u5b9a\u7684Node\u7248\u672c,\u4e26\u8207<code>npm</code>\u7684node\u5957\u4ef6\u4e00\u8d77\u642d\u914d\u4f86\u4f7f\u7528<ul> <li>\u4f8b: $ <code>npx node@10 -v</code> #v10.18.1</li> <li>\u4f8b: $ <code>npx node@12 -v</code> #v12.14.1</li> </ul> </li> <li>\u9019\u9ebc\u505a\u80fd\u8b93\u6211\u5011\u80fd\u4e0d\u7528\u7279\u5225\u53bb\u4f7f\u7528\u50cf\u662f<code>nvm</code>\u6216\u662f\u5176\u4ed6Node\u7684\u7248\u672c\u7ba1\u7406\u5de5\u5177(Node.js version management tools)</li> <li>\u53ef\u4ee5\u76f4\u63a5\u5f9e<code>URL</code>\u4e0a\u57f7\u884c\u4e00\u6bb5\u7a0b\u5f0f\u78bc\u7684\u7247\u6bb5(snippets)</li> <li><code>npx</code>\u4e26\u4e0d\u6703\u9650\u5236\u6211\u5011\u4f7f\u7528<code>npm</code>\u4e0a\u9762\u767c\u5e03\u7684\u5957\u4ef6</li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u7684\u65b9\u5f0f\u4f86\u76f4\u63a5\u57f7\u884c<code>GitHub gist</code>\u4e0a\u7684\u7a0b\u5f0f\u78bc\u7247\u6bb5<ul> <li>\u4f8b: $ <code>npx https://gist.github.com/zkat/4bc19503fe9e9309e2bfaa2c58074d32</code></li> <li>\u7576\u6211\u5011\u9700\u8981\u57f7\u884c\u6211\u5011\u7121\u6cd5\u63a7\u5236\u7684\u7a0b\u5f0f\u78bc\u6642,\u9700\u8981\u66f4\u5c0f\u5fc3\u5730\u4f7f\u7528<code>npx</code>\u5de5\u5177\u3002\u56e0\u70ba\u8d8a\u5f37\u5927\u7684\u529f\u80fd,\u5e36\u4f86\u8d8a\u5927\u7684\u8cac\u4efb</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-nodejs-event-loop","title":"The Node.js Event Loop","text":"<ul> <li>\u4e8b\u4ef6\u8ff4\u5708(Event loop)\u662f\u8981\u7406\u89e3Node\u7684\u5176\u4e2d\u4e00\u500b\u6700\u91cd\u8981\u7684\u5c64\u9762</li> <li>\u4e8b\u4ef6\u8ff4\u5708(Event loop)\u80fd\u89e3\u91cbNode\u5982\u4f55\u9054\u5230 \u975e\u540c\u6b65(=&gt; asynchronous) \u8207 \u975e\u963b\u585eI/O(=&gt; non-blocking I/O) \u3002\u9019\u4e5f\u662f\u8b93Node\u80fd\u6210\u70ba\u6bba\u624b\u7d1a\u61c9\u7528\u7a0b\u5f0f(killer app),\u4e26\u4e14\u80fd\u5982\u6b64\u6210\u529f\u7684\u539f\u56e0</li> <li>Node\u662f\u7528 \u55ae\u57f7\u884c\u7dd2(single thread)  \u5728\u57f7\u884cJavascript\u7684\u7a0b\u5f0f\u78bc,\u5728\u540c\u4e00\u500b\u6642\u9593\u53ea\u6703\u767c\u751f\u4e00\u4ef6\u4e8b</li> <li>\u9019\u500b\u9650\u5236\u5176\u5be6\u662f\u5f88\u6709\u7528\u7684,\u56e0\u70ba\u5b83\u80fd\u5927\u5927\u5730\u7c21\u5316\u6211\u5011\u5728\u958b\u767c\u7a0b\u5f0f\u7684\u5fc3\u529b,\u800c\u4e0d\u7528\u53bb\u64d4\u5fc3\u4f75\u767c(concurrency)\u7684\u554f\u984c(issues)</li> <li>\u6211\u5011\u53ea\u8981\u5c08\u6ce8\u5728\u5982\u4f55\u5beb\u7a0b\u5f0f\u78bc,\u4e26\u907f\u514d\u4efb\u4f55\u53ef\u80fd\u963b\u585e(block)\u7dda\u7a0b(thread)\u7684\u4e8b\u60c5,\u50cf\u662f\u4ee5\u4e0b2\u7a2e\u60c5\u6cc1<ul> <li>\u540c\u6b65\u7db2\u8def\u547c\u53eb(synchronous network calls)</li> <li>\u7121\u9650\u8ff4\u5708(infinite loops)</li> </ul> </li> <li>\u901a\u5e38\u5728\u5927\u591a\u6578\u700f\u89bd\u5668\u4e2d,\u6bcf\u500b\u700f\u89bd\u5668\u9801\u7c64(browser tab)\u90fd\u6703\u6709\u4e00\u500b\u4e8b\u4ef6\u5faa\u74b0,\u4ee5\u4f7f\u6bcf\u500b\u9032\u7a0b(process)\u90fd\u88ab\u9694\u96e2\u958b,\u4e26\u907f\u514d\u7db2\u9801\u756b\u9762\u843d\u5165\u7121\u9650\u8ff4\u5708(infinite loops)\u6216\u662f\u7e41\u91cd\u7684\u8655\u7406\u5de5\u4f5c,\u4ee5\u81f3\u65bc\u963b\u585e(block)\u6574\u500b\u700f\u89bd\u5668</li> <li>\u8a72\u74b0\u5883\u7ba1\u7406\u591a\u500b\u4f75\u767c\u4e8b\u4ef6\u8ff4\u5708(multiple concurrent event loops),\u4ee5\u8655\u7406\u50cf\u662f<code>API</code>\u547c\u53eb\u7684\u5de5\u4f5c\u3002\u7db2\u9801\u5de5\u4f5c(Web Workers)\u4e5f\u6703\u5728\u5176\u81ea\u5df1\u7684\u4e8b\u4ef6\u8ff4\u5708(event loops)\u4e2d\u57f7\u884c</li> <li>\u6211\u5011\u6700\u9700\u8981\u95dc\u5fc3\u7684\u662f\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u6703\u5728\u55ae\u4e00\u4e8b\u4ef6\u8ff4\u5708(single event loop)\u4e0a\u88ab\u57f7\u884c,\u4e26\u4e14\u8981\u7262\u8a18\u9019\u4e00\u9ede\u5728\u5fc3\u4e2d,\u4ee5\u907f\u514d\u9020\u6210\u963b\u585e(blocking)</li> <li>\u963b\u64cb\u4e8b\u4ef6\u8ff4\u5708(Blocking the event loop)</li> <li>\u4efb\u4f55\u82b1\u8cbb\u592a\u591a\u6642\u9593\u624d\u5c07\u63a7\u5236\u6b0a\u4ea4\u9084(return back control )\u7d66\u4e8b\u4ef6\u8ff4\u5708(event loop)\u7684Javascript\u7a0b\u5f0f\u78bc,\u90fd\u5c07\u963b\u64cb(block)\u4efb\u4f55\u8a72\u9801\u9762\u4e0a\u57f7\u884c\u7684Javascript\u7a0b\u5f0f\u78bc,\u751a\u81f3\u662f\u963b\u585eUI\u7dda\u7a0b(UI thread),\u4e26\u4e14\u7528\u6236\u7121\u6cd5\u9ede\u64ca\u6309\u9215.\u6ed1\u52d5\u9801\u9762...\u7b49\u7b49</li> <li>\u5728Javascript\u4e2d,\u5e7e\u4e4e\u6240\u6709\u7684 I/O\u539f\u8a9e(=&gt; I/O primitives) \u90fd\u662f \u975e\u963b\u585eI/O(=&gt; non-blocking I/O) \u7684,\u4f8b\u5982\u4ee5\u4e0b2\u7a2e\u60c5\u5883<ul> <li>\u7db2\u8def\u8acb\u6c42(Network requests)</li> <li>\u6a94\u6848\u7cfb\u7d71\u64cd\u4f5c(filesystem operations)</li> <li>...\u7b49\u7b49</li> </ul> </li> <li>\u88ab\u963b\u585e\u662f\u4e00\u7a2e\u4f8b\u5916,\u9019\u4e5f\u5c31\u662f\u70ba\u4ec0\u9ebcJavascript\u6703\u6709\u9019\u9ebc\u591a\u57fa\u65bc\u56de\u547c\u51fd\u5f0f(<code>callbacks</code>)\u7684\u6771\u897f,\u800c\u8fd1\u5e74\u4f86\u4e5f\u958b\u59cb\u6709<code>Promise</code>\u8207<code>async/await</code></li> <li>\u547c\u53eb\u5806\u758a(The call stack)</li> <li>\u547c\u53eb\u5806\u758a\u662f\u4e00\u7a2e<code>LIFO</code>\u968a\u5217(queue),\u4e5f\u5c31\u662f\u5f8c\u9032-&gt;\u5148\u51fa(Last in, First out)\u7684\u6a21\u5f0f</li> <li>\u4e8b\u4ef6\u8ff4\u5708(event loop)\u6703\u6301\u7e8c\u5730\u6aa2\u67e5\u662f\u5426\u5728\u547c\u53eb\u5806\u758a(call stack)\u4e2d\u4ecd\u6709\u4efb\u4f55\u51fd\u5f0f(function)\u9700\u8981\u88ab\u57f7\u884c</li> <li>\u9019\u6a23\u505a\u6642,\u5b83\u6703\u5c07\u4efb\u4f55\u6240\u6709\u80fd\u627e\u5230\u7684\u51fd\u5f0f\u90fd\u52a0\u5165\u5230\u547c\u53eb\u5806\u758a(call stack)\u4e2d,\u4e26\u4f9d\u5e8f\u57f7\u884c\u6bcf\u500b\u51fd\u5f0f</li> <li>\u6211\u5011\u6703\u77e5\u9053\u81ea\u5df1\u5c0d\u65bc\u9664\u932f\u5668(debugger)\u6216\u662f\u700f\u89bd\u5668\u63a7\u5236\u53f0(browser console)\u4e2d,\u6703\u6bd4\u8f03\u719f\u6089\u7528\u54ea\u500b\u65b9\u5f0f\u4f86\u8ffd\u8e64\u932f\u8aa4\u5806\u758a(error stack trace)<ul> <li>\u700f\u89bd\u5668\u6703\u5728\u547c\u53eb\u5806\u758a(call stack)\u4e2d\u67e5\u8a62\u51fd\u5f0f(function)\u7684\u540d\u7a31,\u4ee5\u901a\u77e5\u6211\u5011\u662f\u54ea\u500b\u51fd\u5f0f\u7522\u751f(originates)\u4e86\u7576\u524d\u7684\u547c\u53eb(current call)</li> <li></li> </ul> </li> <li>\u4e00\u500b\u7c21\u55ae\u7684\u4e8b\u4ef6\u8ff4\u5708\u8aaa\u660e\u7bc4\u4f8b   JavaScript<pre><code>const bar = () =&gt; console.log('bar')\n\nconst baz = () =&gt; console.log('baz')\n\nconst foo = () =&gt; {\n  console.log('foo')\n  bar()\n  baz()\n}\n\nfoo()\n</code></pre></li> <li>\u7576\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u78bc\u88ab\u57f7\u884c\u6642<ul> <li>\u9996\u5148,\u662f<code>foo()</code>\u88ab\u547c\u53eb</li> <li>\u63a5\u8457,\u5728<code>foo()</code>\u4e2d,\u6703\u547c\u53eb<code>bar()</code></li> <li>\u6700\u5f8c,\u6703\u547c\u53eb<code>baz()</code></li> </ul> </li> <li>\u6b64\u6642,\u547c\u53eb\u5806\u758a(call stack)\u6703\u770b\u8d77\u4f86\u5982\u4e0b\u5716\u6240\u793a<ul> <li></li> </ul> </li> <li>\u6bcf\u6b21\u8fed\u4ee3\u4e2d\u7684\u4e8b\u4ef6\u8ff4\u5708\u90fd\u6703\u67e5\u770b\u5728\u547c\u53eb\u5806\u758a(call stack)\u4e2d\u662f\u5426\u6709\u6771\u897f,\u4e26\u57f7\u884c\u5b83,\u76f4\u5230\u547c\u53eb\u5806\u758a(call stack)\u8b8a\u6210\u7a7a\u7684(empty)\u70ba\u6b62<ul> <li></li> </ul> </li> <li>\u51fd\u5f0f\u57f7\u884c\u968a\u5217(Queuing function execution)</li> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u770b\u8d77\u4f86\u5f88\u6b63\u5e38,\u4e26\u6c92\u6709\u4ec0\u9ebc\u7279\u5225\u4e4b\u8655\u3002Javascript\u6703\u5c0b\u627e\u8981\u57f7\u884c\u7684\u6771\u897f,\u4e26\u4e14\u4f9d\u5e8f\u57f7\u884c\u5b83\u5011</li> <li>\u8b93\u6211\u5011\u4f86\u770b\u770b\u53e6\u4e00\u500b\u7bc4\u4f8b,\u5982\u4f55\u5c07\u51fd\u5f0f(function)\u63a8\u9072(defer)\u5230\u5806\u758a(stack)\u88ab\u6e05\u9664\u6389\u4e4b\u524d       JavaScript<pre><code>  const bar = () =&gt; console.log('bar')\n\n  const baz = () =&gt; console.log('baz')\n\n  const foo = () =&gt; {\n    console.log('foo')\n    setTimeout(bar, 0)\n    baz()\n  }\n\n  foo()\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d\u7684<code>setTimeout(() =&gt; {}, 0)</code>\u6703\u53bb\u547c\u53eb\u4e00\u500b\u51fd\u5f0f(function),\u4e00\u65e6\u9019\u6bb5\u7a0b\u5f0f\u78bc\u4e2d\u7684\u6bcf\u500b\u5176\u5b83\u51fd\u5f0f\u57f7\u884c\u4e00\u6b21,\u4fbf\u6703\u57f7\u884c\u4e00\u6b21\u8a72\u51fd\u5f0f</li> <li>\u9019\u500b\u7bc4\u4f8b\u6253\u5370(print)\u51fa\u4f86\u7684\u7d50\u679c\u4e5f\u8a31\u6703\u4ee4\u6211\u5011\u975e\u5e38\u9a5a\u8a1d     JavaScript<pre><code>  foo\n  baz\n  bar\n</code></pre></li> <li>\u8aaa\u660e: \u7576\u9019\u6bb5\u7a0b\u5f0f\u78bc\u88ab\u57f7\u884c\u6642</li> <li>\u9996\u5148,\u662f<code>foo()</code>\u88ab\u547c\u53eb</li> <li>\u63a5\u8457,\u5728<code>foo()</code>\u5167\u90e8\u6703\u5148\u547c\u53eb<code>setTimeout()</code>,\u4e26\u5c07<code>bar</code>\u4f5c\u70ba\u53c3\u6578(argument),\u4e26\u6307\u793a(instruct)\u5b83\u76e1\u5feb\u5730\u57f7\u884c,\u4e26\u50b3\u905e<code>0</code>\u4f5c\u70ba\u8a08\u6642\u5668(timer)</li> <li>\u6700\u5f8c,\u6703\u547c\u53eb<code>baz()</code></li> <li>\u6b64\u6642,\u547c\u53eb\u5806\u758a(call stack)\u6703\u770b\u8d77\u4f86\u5982\u4e0b\u5716\u6240\u793a</li> <li></li> <li>\u4ee5\u4e0b\u662f\u7a0b\u5f0f(program)\u4e2d\u7684\u6240\u6709\u51fd\u5f0f\u7684\u57f7\u884c\u9806\u5e8f</li> <li></li> </ul> </li> <li>\u70ba\u4ec0\u9ebc\u6703\u9019\u6a23\u5462? \u6211\u5011\u63a5\u8457\u770b\u4e0b\u53bb</li> <li>\u8a0a\u606f\u968a\u5217(Message Queue)</li> <li>\u7576<code>setTimeout()</code>\u51fd\u5f0f\u88ab\u547c\u53eb\u6642,\u700f\u89bd\u5668\u8207Node\u6703\u555f\u52d5\u4e00\u500b\u8a08\u6642\u5668\u3002\u7576\u8a08\u6642\u5668\u5230\u671f\u6642,\u4e5f\u5c31\u662f\u8aaa\u5728\u9019\u500b\u60c5\u6cc1\u4e0b,\u6211\u5011\u5c07\u5ef6\u9072(delay)\u53c3\u6578\u8a2d\u5b9a\u70ba<code>0</code>,\u6b64\u6642\"\u5ef6\u9072(delay)\"\u5c31\u6703\u7acb\u5373\u5230\u671f,\u4e5f\u6703\u5c07\u56de\u547c\u51fd\u5f0f(callback function)\u653e\u5165\u8a0a\u606f\u968a\u5217(Message Queue)\u4e2d</li> <li>\u5728\u8a0a\u606f\u968a\u5217(Message Queue)\u4e2d,\u4f7f\u7528\u8005\u521d\u59cb\u5316\u7684\u4e8b\u4ef6(user-initiated events)\u50cf\u662f\u6ed1\u9f20\u9ede\u64ca(click),\u9375\u76e4\u4e8b\u4ef6(keyboard events),\u7372\u53d6\u56de\u61c9(fetch responses)\u90fd\u5c07\u5728\u6b64\u6392\u968a(queued)\u3002\u7136\u5f8c\u6211\u5011\u624d\u6709\u6a5f\u6703\u5c0d\u5176\u505a\u51fa\u53cd\u61c9(react),\u6216\u50cf\u662f<code>DOM\u4e8b\u4ef6</code>---&gt;<code>window.onLoad</code></li> <li>\u4e8b\u4ef6\u8ff4\u5708(event loop)\u5c07\u6703\u512a\u5148\u8655\u7406\u547c\u53eb\u5806\u758a(call stack),\u4e26\u9996\u5148\u8655\u7406(processes)\u5728\u547c\u53eb\u5806\u758a\u4e2d\u627e\u5230\u7684\u6240\u6709\u5167\u5bb9\u3002\u4e00\u65e6\u547c\u53eb\u5806\u758a\u4e2d\u6c92\u6709\u4efb\u4f55\u5167\u5bb9\u4e86,\u5b83\u5c31\u6703\u958b\u59cb\u5230\u8a0a\u606f\u968a\u5217(message queue)\u4e2d\u8655\u7406\u5167\u5bb9<ul> <li>\u6211\u5011\u4e0d\u5fc5\u7b49\u5f85\u50cf\u662f<code>setTimeout()</code>\u51fd\u5f0f,\u6293\u53d6\u8cc7\u6599(fetch),\u6216\u662f\u5176\u5b83\u51fd\u5f0f\u4f86\u5b8c\u6210\u5b83\u5011\u81ea\u5df1\u7684\u5de5\u4f5c,\u56e0\u70ba\u5b83\u5011\u662f\u7531\u700f\u89bd\u5668\u6240\u63d0\u4f9b\u7684,\u800c\u4e14\u5b83\u5011\u90fd\u4f4d\u65bc\u81ea\u5df1\u7684\u7dda\u7a0b\u4e2d(threads)</li> <li>\u8209\u4f8b\u4f86\u8aaa,\u5982\u679c\u5c07<code>setTimeout(function[, delay])</code>\u51fd\u5f0f\u7684<code>delay</code>(\u5ef6\u9072)-&gt;\u9019\u500b\u53c3\u6578\u8a2d\u5b9a\u70ba<code>2</code>\u79d2,\u6211\u5011\u4e0d\u9700\u8981\u771f\u7684\u53bb\u7b49\u5f852\u79d2,\u5b83\u6703\u5728\u5176\u5b83\u5730\u65b9\u767c\u751f</li> </ul> </li> <li>ES6\u5de5\u4f5c\u968a\u5217(ES6 Job Queue)</li> <li>ES6(= ECMAScript 2015)\u5f15\u9032(introduced)\u4e86\u5de5\u4f5c\u968a\u5217(job queue)\u7684\u89c0\u5ff5,\u4e26\u4e14\u900f\u904e<code>Promise</code>\u7269\u4ef6\u4f86\u4f7f\u7528\u5de5\u4f5c\u968a\u5217(job queue)<ul> <li>\u88dc\u5145: Promise\u7269\u4ef6\u4e5f\u662f\u5f9eES6\u958b\u59cb\u5f15\u9032\u7684</li> <li>Promise\u7269\u4ef6 \u662f\u4e00\u7a2e\u76e1\u5feb\u5730\u57f7\u884c \u975e\u540c\u6b65\u51fd\u5f0f(async function) \u7684\u4e00\u7a2e\u65b9\u5f0f,\u800c\u4e0d\u662f(rather than)\u653e\u5728\u547c\u53eb\u5806\u758a(call stack)\u7684\u6700\u5f8c\u9762</li> <li>\u90a3\u4e9b\u5728\u7576\u524d\u51fd\u5f0f\u7d50\u675f\u4e4b\u524d\u5df2\u7d93\u89e3\u6c7a(resolve)\u7684<code>Promise</code>\u7269\u4ef6, \u5c07\u5728\u7576\u524d\u51fd\u5f0f\u4e4b\u5f8c\u7acb\u5373\u88ab\u57f7\u884c</li> <li>\u6211\u767c\u73fe\u53ef\u4ee5\u7528\u904a\u6a02\u5712\u7684\u904e\u5c71\u8eca\u8a2d\u65bd\u4f86\u505a\u500b\u6bd4\u55bb\u6703\u66f4\u597d,\u8a0a\u606f\u968a\u5217(message queue)\u6703\u5c07\u6211\u5011\u653e\u5728\u968a\u5217(queue)\u7684\u5f8c\u9762,\u5728\u6240\u6709\u5176\u4ed6\u4eba\u7684\u5f8c\u9762,\u800c\u6211\u5011\u6703\u56e0\u6b64\u9700\u8981\u7b49\u5230\u8f2a\u5230\u6211\u5011\u70ba\u6b62\u3002\u7136\u800c,\u5de5\u4f5c\u968a\u5217(job queue)\u5c31\u662f\u5feb\u901f\u901a\u95dc\u5238\u8b93\u6211\u5011\u80fd\u5920\u642d\u4e58\u5b8c\u4e00\u500b\u904a\u6a02\u8a2d\u65bd\u4e4b\u5f8c \u7dca\u63a5\u8457 \u518d\u642d\u4e58\u4e0b\u4e00\u500b\u904a\u6a02\u8a2d\u65bd</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>const bar = () =&gt; console.log('bar')\n\nconst baz = () =&gt; console.log('baz')\n\nconst foo = () =&gt; {\n  console.log('foo')\n  setTimeout(bar, 0)\n  new Promise((resolve, reject) =&gt;\n    resolve('should be right after baz, before bar')\n  ).then(resolve =&gt; console.log(resolve))\n  baz()\n}\n\nfoo()\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u5c07\u6703\u56de\u50b3   JavaScript<pre><code>foo\nbaz\nshould be right after baz, before bar\nbar\n</code></pre></li> </ul> </li> <li>\u9019\u662f<code>Promises</code>(\u548c\u57fa\u65bc<code>Promise</code>\u5efa\u69cb\u7684<code>Async/ await</code>)\u2194\u8207\u900f\u904e<code>setTimeout()</code>\u6216\u5176\u5b83\u5e73\u53f0API\u7684\u666e\u901a,\u820a\u7684\u975e\u540c\u6b65\u51fd\u6578(asynchronous functions)\u4e4b\u9593\u7684\u5de8\u5927\u5340\u5225</li> </ul>"},{"location":"programming_language/nodejs/#understanding-processnexttick","title":"Understanding process.nextTick()","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Process</code>\u4e2d\u7684process.nextTick(callback[, ...args])---process.nextTick() adds callback to the \"next tick queue\". This queue is fully drained after the current operation on the JavaScript stack runs to completion and before the event loop is allowed to continue. It's possible to create an infinite loop if one were to recursively call process.nextTick()</p> <ul> <li>\u7576\u6211\u5011\u5617\u8a66\u7406\u89e3Node\u7684\u4e8b\u4ef6\u8ff4\u5708(event loop)\u6642,<code>process.nextTick()</code>\u65b9\u6cd5\u5c31\u662f\u5b83\u4e00\u500b\u91cd\u8981\u7684\u90e8\u5206</li> <li>\u6bcf\u6b21\u4e8b\u4ef6\u8ff4\u5708\u7d93\u904e\u5b8c\u6574\u7684\u4e00\u8d9f(full trip)\u6642,\u6211\u5011\u7a31\u5176\u70ba<code>tick</code></li> <li>\u7576\u6211\u5011\u50b3\u905e\u4e00\u500b\u51fd\u5f0f(function)\u7d66<code>process.nextTick()</code>\u65b9\u6cd5\u6642,\u6703\u6307\u793a(instruct)\u5f15\u64ce(engine)\u65bc\u7576\u524d\u64cd\u4f5c\u7d50\u675f\u4e4b\u5f8c,\u4e26\u4e14\u65bc\u4e0b\u4e00\u500b\u4e8b\u4ef6\u8ff4\u5708(event loop)<code>tick</code>\u958b\u59cb\u4e4b\u524d,\u547c\u53eb(invoke)\u6b64\u65b9\u6cd5(<code>process.nextTick()</code>)</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>process.nextTick(() =&gt; {\n  //do something\n})\n</code></pre><ul> <li>\u8a72\u4e8b\u4ef6\u8ff4\u5708(event loop)\u6b63\u5fd9\u65bc\u8655\u7406\u7576\u524d\u7684\u7a0b\u5f0f\u78bc</li> <li>\u7576\u8a72\u64cd\u4f5c\u7d50\u675f\u5f8c,Javascript\u5f15\u64ce(engine)\u6703\u4ee5\u975e\u540c\u6b65(asynchronouly)\u7684\u65b9\u5f0f\u4f86\u8655\u7406\u51fd\u5f0f(function)</li> </ul> </li> <li>\u547c\u53eb<code>setTimeout(() =&gt; {}, 0)</code>\u65b9\u6cd5\u6703\u5728\u4e0b\u4e00\u500b<code>tick</code>\u7d50\u675f\u4e4b\u5f8c\u624d\u57f7\u884c\u51fd\u5f0f,\u6bd4\u8d77\u4f7f\u7528<code>nextTick()</code>\u65b9\u6cd5\u9700\u8981\u5728\u4e0b\u4e00\u500b<code>tick</code>\u958b\u59cb\u4e4b\u524d,\u512a\u5148\u547c\u53eb\u548c\u57f7\u884c\u5b83,\u76f8\u5c0d\u6162\u5f88\u591a</li> <li>\u5efa\u8b70\u4f7f\u7528<code>process.nextTick()</code>\u65b9\u6cd5\u4f86\u78ba\u4fdd\u5728\u4e0b\u4e00\u6b21\u4e8b\u4ef6\u8ff4\u5708(event loop)\u8fed\u4ee3(iteration)\u4e2d,\u5df2\u7d93\u57f7\u884c\u4e86\u7a0b\u5f0f\u78bc</li> </ul>"},{"location":"programming_language/nodejs/#understanding-setimmediate","title":"Understanding setImmediate()","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Timers</code>\u4e2d\u7684setImmediate(callback[, ...args])---Schedules the \"immediate\" execution of the callback after I/O events' callbacks. Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Timers</code>\u4e2d\u7684setTimeout(callback[, delay[, ...args]])---Schedules execution of a one-time callback after delay milliseconds.</p> <ul> <li>\u7576\u6211\u5011\u60f3\u8981\u8b93\u67d0\u500b\u7247\u6bb5\u7684\u7a0b\u5f0f\u78bc\u7acb\u5373\u88ab\u57f7\u884c\u6642,\u5176\u4e2d\u4e00\u500b\u9078\u64c7\u662f\u53ef\u4ee5\u4f7f\u7528Node\u63d0\u4f9b\u7684<code>setImmediate()</code>\u65b9\u6cd5     JavaScript<pre><code>setImmediate(() =&gt; {\n  //run something\n})\n</code></pre><ul> <li>\u4efb\u4f55\u51fd\u5f0f\u4f5c\u70ba\u53c3\u6578\u50b3\u905e\u7d66<code>setImmediate()</code>\u65b9\u6cd5,\u90fd\u6703\u5728\u4e0b\u4e00\u6b21\u4e8b\u4ef6\u8ff4\u5708(event loop)\u8fed\u4ee3(iteration)\u88ab\u7576\u4f5c\u56de\u547c\u51fd\u5f0f(callback)\u57f7\u884c</li> </ul> </li> <li><code>setImmediate()</code>\u8207<code>setTimeout(() =&gt; {}, 0)</code>\u8207<code>process.nextTick()</code>\u4e09\u8005\u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?<ul> <li>\u7576\u50b3\u905e\u4e00\u500b\u51fd\u5f0f(function)\u7d66<code>process.nextTick()</code>\u65b9\u6cd5\u6642,\u8a72\u51fd\u5f0f\u6703\u5728\u7576\u524d\u64cd\u4f5c(current operation)\u4e4b\u5f8c,\u4e26\u65bc\u7576\u524d\u4e8b\u4ef6\u8ff4\u5708(event loop)\u7684\u8fed\u4ee3\u4e2d(current iteration)\u88ab\u57f7\u884c</li> <li>\u9019\u4e5f\u610f\u5473\u8457<code>process.nextTick()</code>\u65b9\u6cd5\u7e3d\u662f\u6703\u5728<code>setTimeout()</code>\u65b9\u6cd5 &amp; <code>setImmediate()</code>\u65b9\u6cd5\u4e4b\u524d\u88ab\u57f7\u884c</li> <li>\u7576\u8a2d\u5b9a<code>setTimeout(callback[, delay[, ...args]])</code>\u65b9\u6cd5\u7684\u5ef6\u9072(<code>delay</code>)\u53c3\u6578\u70ba<code>0</code>\u6beb\u79d2\u6642,\u9019\u6642\u8a72\u65b9\u6cd5\u6703\u975e\u5e38\u985e\u4f3c\u65bc<code>setImmediate()</code>\u65b9\u6cd5\u3002\u57f7\u884c\u9806\u5e8f\u5c07\u53d6\u6c7a\u65bc\u4e0d\u540c\u7684\u56e0\u7d20\u6240\u5f71\u97ff,\u4f46\u5b83\u5011\u90fd\u6703\u5728\u4e0b\u4e00\u6b21\u4e8b\u4ef6\u8ff4\u5708(event loop)\u7684\u8fed\u4ee3\u4e2d(current iteration)\u88ab\u57f7\u884c</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#discover-javascript-timers","title":"Discover JavaScript Timers","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Timers</code>\u4e2d\u7684setTimeout(callback[, delay[, ...args]])---Schedules execution of a one-time callback after delay milliseconds. Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Timers</code>\u4e2d\u7684setInterval(callback[, delay[, ...args]])---Schedules repeated execution of callback every delay milliseconds. Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Timers</code>\u4e2d\u7684clearTimeout(timeout)---Cancels a Timeout object created by setTimeout(). Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Timers</code>\u4e2d\u7684setImmediate(callback[, ...args])---Schedules the \"immediate\" execution of the callback after I/O events' callbacks.</p> <ul> <li><code>setTimeout()</code>\u65b9\u6cd5</li> <li>\u7576\u6211\u5011\u5728\u64b0\u5bebJavascript\u7a0b\u5f0f\u78bc\u6642,\u6709\u6642\u6211\u5011\u6703\u5e0c\u671b\u5ef6\u9072(delay)\u67d0\u4e9b\u51fd\u5f0f\u7684\u57f7\u884c</li> <li>\u9019\u5c31\u662f<code>setTimeout()</code>\u65b9\u6cd5\u5728\u505a\u7684\u4e8b\u60c5\u3002\u6211\u5011\u53ef\u4ee5\u6307\u5b9a\u4e00\u500b\u8981\u5ef6\u9072\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback function),\u4e26\u4e14\u6307\u5b9a\u4e00\u500b\u60f3\u8981\u5ef6\u9072\u57f7\u884c\u7684\u6642\u9593(\u4ee5\u6beb\u79d2\u70ba\u55ae\u4f4d)       JavaScript<pre><code>setTimeout(() =&gt; {\n  // runs after 2 seconds\n}, 2000)\n\nsetTimeout(() =&gt; {\n  // runs after 50 milliseconds\n}, 50)\n</code></pre><ul> <li>\u9019\u500b\u8a9e\u6cd5\u5b9a\u7fa9\u4e86\u4e00\u500b\u65b0\u7684\u51fd\u5f0f,\u8b93\u6211\u5011\u53ef\u4ee5\u64b0\u5beb\u4efb\u4f55\u6211\u5011\u60f3\u8981\u57f7\u884c\u7684\u51fd\u5f0f,\u6216\u662f\u586b\u5165\u6211\u5011\u60f3\u8981\u547c\u53eb\u7684\u51fd\u5f0f\u4e26\u7d66\u4e00\u7d44\u53c3\u6578(a set of parameters)   JavaScript<pre><code>const myFunction = (firstParam, secondParam) =&gt; {\n  // do something\n}\n\n// runs after 2 seconds\nsetTimeout(myFunction, 2000, firstParam, secondParam)\n</code></pre></li> <li><code>setTimeout()</code>\u65b9\u6cd5\u6703\u56de\u50b3\u4e00\u500b\u8a08\u6642\u5668ID(Timer ID),\u901a\u5e38\u6211\u5011\u4e0d\u6703\u7528\u5230\u9019\u500b\u8a08\u6642\u5668ID,\u4f46\u662f\u6211\u5011\u4ecd\u7136\u53ef\u4ee5\u5c07\u9019\u500b\u8a08\u6642\u5668ID\u8a18\u4e0b\u4f86   JavaScript<pre><code>const id = setTimeout(() =&gt; {\n  // should run after 2 seconds\n}, 2000)\n\n// I changed my mind\nclearTimeout(id)\n</code></pre></li> <li>\u7576\u6211\u5011\u60f3\u8981\u5c07\u9019\u500b\u6392\u5b9a\u8981\u57f7\u884c\u7684\u51fd\u5f0f\u53d6\u6d88\u6642,\u5c31\u6703\u9700\u8981\u7528\u5230\u9019\u500b\u8a08\u6642\u5668ID</li> </ul> </li> <li>\u96f6\u5ef6\u9072\u57f7\u884c(Zero delay)<ul> <li>\u7576\u6211\u5011\u6307\u5b9a\u8981\u5ef6\u9072\u7684\u6642\u9593\u70ba<code>0</code>\u6beb\u79d2\u6642,\u8a72\u56de\u547c\u51fd\u5f0f\u5c31\u6703\u76e1\u5feb\u5730\u7acb\u5373\u88ab\u57f7\u884c,\u4e26\u4e14\u5728\u7576\u524d\u7684\u56de\u547c\u51fd\u5f0f(callback function)\u57f7\u884c\u5b8c\u5f8c   JavaScript<pre><code>setTimeout(() =&gt; {\n  console.log('after ')\n}, 0)\n\nconsole.log(' before ')\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u6703\u6253\u5370(print)\u51fa<code>before after</code></li> <li>\u9019\u500b\u505a\u6cd5( \u5c07\u51fd\u5f0f\u52a0\u5165\u8abf\u5ea6\u5668(scheduler)\u7684\u6392\u968a(queuing)\u4e2d )\u5c0d\u65bc\u5728\u5bc6\u96c6\u4efb\u52d9\u6642,\u7528\u4f86\u907f\u514dCPU\u8cc7\u6e90\u7684\u963b\u585e or \u5c0d\u65bc\u8981\u57f7\u884c\u7e41\u91cd\u7684\u8a08\u7b97\u6642,\u80fd\u8b93\u5176\u4ed6\u51fd\u5f0f\u5148\u88ab\u57f7\u884c\u662f\u975e\u5e38\u6709\u7528\u7684</li> </ul> </li> <li>\u6709\u4e9b\u700f\u89bd\u5668(\u4f8b\u5982: <code>IE</code>\u6216\u662f<code>Edge</code>)\u6703\u5be6\u4f5c<code>setImmediate()</code>\u65b9\u6cd5\u4e5f\u80fd\u9054\u5230\u76f8\u540c\u7684\u529f\u80fd,\u4f46\u90a3\u6a23\u505a\u4e0d\u7b97\u662f\u6a19\u6e96\u7684,\u800c\u4e14\u4e5f\u7121\u6cd5\u5728\u5176\u5b83\u700f\u89bd\u5668\u4e2d\u4f7f\u7528\u3002\u4f46\u662f\u9019\u7b97\u662fNode\u7684\u6a19\u6e96\u529f\u80fd\u4e4b\u4e00<ul> <li>\u95dc\u65bc<code>setImmediate()</code>\u65b9\u6cd5\u5c0d\u65bc\u5404\u700f\u89bd\u5668\u7684\u652f\u63f4,\u53ef\u53c3\u8003Efficient Script Yielding: setImmediate()</li> </ul> </li> <li><code>setInterval()</code>\u65b9\u6cd5</li> <li><code>setInterval()</code>\u65b9\u6cd5\u8207<code>setTimeout()</code>\u65b9\u6cd5\u5f88\u985e\u4f3c,\u5169\u8005\u7684\u5dee\u5225\u662f<ul> <li><code>setInterval()</code>\u65b9\u6cd5\u6703\u6c38\u9060\u57f7\u884c\u4e0b\u53bb,\u800c\u4e0d\u662f\u53ea\u57f7\u884c\u4e00\u6b21,\u4e26\u4e14\u6211\u5011\u53ef\u4ee5\u6307\u5b9a\u60f3\u8981\u7684\u9593\u9694\u57f7\u884c\u6642\u9593(\u4ee5\u6beb\u79d2\u70ba\u55ae\u4f4d)   JavaScript<pre><code>setInterval(() =&gt; {\n  // runs every 2 seconds\n}, 2000)\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc,\u6703\u6301\u7e8c\u6bcf2\u79d2\u57f7\u884c\u4e00\u6b21,\u76f4\u5230\u6211\u5011\u5229\u7528<code>clearInterval()</code>\u65b9\u6cd5\u4f86\u505c\u6b62(stop)\u5b83   JavaScript<pre><code>const id = setInterval(() =&gt; {\n  // runs every 2 seconds\n}, 2000)\n\nclearInterval(id)\n</code></pre></li> <li>\u800c\u8981\u505c\u6b62<code>clearInterval()</code>\u65b9\u6cd5,\u9700\u8981\u50b3\u905e\u7d66\u8a72\u65b9\u6cd5\u9593\u9694\u5668ID(interval ID, =&gt; \u7531<code>setInterval()</code>\u65b9\u6cd5\u6240\u56de\u50b3\u7684)</li> <li>\u5e38\u898b\u7684\u505a\u6cd5\u6703\u662f\u5728<code>setInterval()</code>\u56de\u547c\u51fd\u5f0f\u4e2d\u547c\u53eb<code>clearInterval()</code>\u65b9\u6cd5,\u4f86\u8b93<code>setInterval()</code>\u65b9\u6cd5\u81ea\u5df1\u81ea\u52d5\u5730\u6c7a\u5b9a\u662f\u5426\u8981\u518d\u57f7\u884c\u4e00\u6b21(again)\u6216\u662f\u505c\u6b62(stop)   JavaScript<pre><code>const interval = setInterval(() =&gt; {\n  if (App.somethingIWait === 'arrived') {\n    clearInterval(interval)\n    return\n  }\n  // otherwise do things\n}, 100)\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc,\u6703\u5728\u57f7\u884c\u67d0\u4e9b\u6771\u897f\u5f8c,\u76f4\u5230<code>App.somethingIWait</code>\u9019\u500b\u5c6c\u6027\u7684\u503c\u7b49\u65bc<code>'arrived'</code>\u5b57\u4e32\u6642,\u624d\u6703\u505c\u6b62</li> </ul> </li> <li>\u905e\u8ff4\u8a08\u6642\u5668(Recursive Timeout)<ul> <li><code>setInterval()</code>\u65b9\u6cd5\u6703\u555f\u52d5\u4e00\u500b\u6bcf<code>n</code>\u8c6a\u79d2\u57f7\u884c\u4e00\u6b21\u7684\u51fd\u5f0f,\u800c\u7121\u9808\u8003\u616e\u8a72\u51fd\u5f0f\u4f55\u6642\u6703\u57f7\u884c\u5b8c\u7562</li> <li>\u5982\u679c\u6709\u4e00\u500b\u51fd\u5f0f,\u6bcf\u6b21\u90fd\u6703\u82b1\u76f8\u540c\u7684\u6642\u9593\u624d\u6703\u57f7\u884c\u5b8c\u7562,\u90a3\u5c31\u4e0d\u6703\u6709\u554f\u984c</li> <li></li> <li>\u4e5f\u6709\u53ef\u80fd\u8a72\u51fd\u5f0f\u6bcf\u6b21\u6703\u56e0\u70ba\u7db2\u8def\u901f\u5ea6\u7684\u60c5\u6cc1(network conditions),\u82b1\u8cbb\u4e0d\u540c\u7684\u6642\u9593\u624d\u6703\u57f7\u884c\u5b8c\u7562</li> <li></li> <li>\u4e5f\u56e0\u6b64\u53ea\u8981\u4efb\u4f55\u4e00\u6b21\u9700\u8981\u82b1\u8cbb\u6bd4\u8f03\u9577\u7684\u6642\u9593\u624d\u6703\u57f7\u884c\u5b8c\u7562\u7684\u56de\u547c\u51fd\u5f0f\u5c31\u6703\u8207\u4e0b\u4e00\u6b21\u8981\u57f7\u884c\u7684\u6642\u9593 \u91cd\u758a (overlaps)</li> <li></li> <li>\u70ba\u4e86\u907f\u514d\u4e0a\u8ff0 \u91cd\u758a \u7684\u60c5\u6cc1,\u6211\u5011\u53ef\u4ee5\u5728\u56de\u547c\u51fd\u5f0f(callback function)\u57f7\u884c\u5b8c\u7562\u5f8c,\u518d\u5b89\u6392\u4e00\u500b\u905e\u8ff4\u8a08\u6642\u5668(recursive timeout)       JavaScript<pre><code>const myFunction = () =&gt; {\n  // do something\n\n  setTimeout(myFunction, 1000)\n}\n\nsetTimeout(myFunction, 1000)\n</code></pre></li> <li>\u7576\u9054\u6210(achieve)\u9019\u500b\u905e\u8ff4\u8a08\u6642\u5668(recursive timeout)\u7684\u60c5\u5883(scenario),\u6703\u5982\u4e0b\u5716\u6240\u793a<ul> <li></li> </ul> </li> </ul> </li> <li><code>setTimeout()</code>\u8207<code>setInterval()</code>\u7686\u70baNode\u7684\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Timers\u7684\u65b9\u6cd5</li> <li>Node\u4e5f\u63d0\u4f9b<code>setImmediate()</code>\u65b9\u6cd5,\u9019\u500b\u65b9\u6cd5\u5c31\u76f8\u7576\u65bc\u4f7f\u7528<code>setTimeout(() =&gt; {}, 0)</code>,\u4e3b\u8981\u7528\u4f86\u642d\u914dNode\u7684\u4e8b\u4ef6\u8ff4\u5708(event loop)\u4f7f\u7528</li> </ul>"},{"location":"programming_language/nodejs/#javascript-asynchronous-programming-and-callbacks","title":"JavaScript Asynchronous Programming and Callbacks","text":"<ul> <li>\u7a0b\u5f0f\u8a9e\u8a00\u7684\u975e\u540c\u6b65\u6027(asynchronicity)</li> <li>\u96fb\u8166\u90fd\u662f\u8a2d\u8a08\u53ef\u4ee5\u975e\u540c\u6b65\u7684,\u975e\u540c\u6b65(asynchronous)\u610f\u5473\u8457\u4e8b\u4ef6\u53ef\u4ee5\u7368\u7acb\u65bc(independently)\u4e3b\u7a0b\u5f0f\u6d41(the main program flow)\u767c\u751f(happen)</li> <li>\u5728\u7576\u524d\u7684\u6d88\u8cbb\u8005\u96fb\u8166(consumer computers)\u4e2d,\u6bcf\u500b\u7a0b\u5f0f\u90fd\u6703\u904b\u884c\u4e00\u500b\u7279\u5b9a\u7684\u6642\u9593\u6bb5(time slot)\u5f8c,\u7136\u5f8c\u505c\u6b62\u904b\u884c,\u4ee5\u8b93\u5176\u5b83\u7a0b\u5f0f\u53ef\u4ee5\u7e7c\u7e8c\u57f7\u884c\u3002\u9019\u500b\u5faa\u74b0\u904b\u884c\u5f97\u5f88\u5feb,\u4ee5\u81f3\u65bc\u6211\u5011\u901a\u5e38\u4e0d\u6703\u6ce8\u610f\u5230,\u6211\u5011\u6703\u4ee5\u70ba\u662f\u6211\u5011\u7684\u96fb\u8166\u80fd\u540c\u6642(simultaneously)\u57f7\u884c\u591a\u500b\u7a0b\u5f0f,\u4e8b\u5be6\u4e0a\u9019\u53ea\u662f\u4e00\u500b\u5e7b\u89ba(illusion)</li> <li>\u6211\u5011\u9019\u908a\u4e0d\u6703\u6df1\u5165\u63a2\u8a0e\u9019\u500b\u89c0\u5ff5,\u4f46\u662f\u6211\u5011\u5fc5\u9808\u8981\u628a\u9019\u500b\u89c0\u5ff5\u8996\u70ba\u4e00\u500b\u6b63\u5e38\u7684\u60c5\u6cc1,\u4e5f\u5c31\u662f\u7a0b\u5f0f\u53ef\u4ee5\u662f\u975e\u540c\u6b65(asynchronous)\u57f7\u884c\u7684,\u76f4\u5230\u4ed6\u5011\u9700\u8981\u88ab\u6ce8\u610f\u6642\u624d\u6703\u505c\u6b62(halt),\u9019\u4e5f\u80fd\u8b93\u96fb\u8166\u80fd\u540c\u6642(in the meantime)\u57f7\u884c\u5176\u5b83\u4e8b\u60c5<ul> <li>\u7576\u7a0b\u5f0f\u6b63\u5728\u7b49\u5f85\u4f86\u81ea\u7db2\u8def\u7684\u56de\u61c9(response from the network)\u6642,\u8a72\u7a0b\u5f0f\u662f\u7121\u6cd5\u5728\u8acb\u6c42\u5b8c\u6210\u4e4b\u524d\u505c\u6b62(halt)\u8655\u7406\u5668(processor)\u7684</li> </ul> </li> <li>\u6b63\u5e38\u4f86\u8aaa,\u7a0b\u5f0f\u8a9e\u8a00\u662f\u540c\u6b65\u7684(synchronous),\u5176\u4e2d\u6709\u4e9b\u7a0b\u5f0f\u8a9e\u8a00\u6709\u63d0\u4f9b\u65b9\u6cd5\u4f86\u7ba1\u7406\u975e\u540c\u6b65\u6027(asynchronicity)\u6216\u662f\u900f\u904e\u51fd\u5f0f\u5eab(library)\u4f86\u8655\u7406<ul> <li>\u9810\u8a2d\u60c5\u6cc1\u4e0b,<code>C</code>\u3001<code>Java</code>\u3001<code>C#</code>\u3001<code>PHP</code>\u3001<code>Go</code>\u3001<code>Ruby</code>\u3001<code>Swift</code>\u3001<code>Python</code>\u90fd\u662f\u975e\u540c\u6b65(asynchronous)\u7684</li> <li>\u5176\u4e2d\u4e00\u4e9b\u7a0b\u5f0f\u8a9e\u8a00 \u900f\u904e\u7dda\u7a0b(thread)\u4f86\u8655\u7406\u975e\u540c\u6b65(async)\u884c\u70ba,\u5f9e\u800c\u7522\u751f(spawning)\u4e00\u500b\u65b0\u7684\u9032\u7a0b(process)</li> </ul> </li> <li>Javascript</li> <li>Javascript\u7a0b\u5f0f\u8a9e\u8a00,\u9810\u8a2d\u662f\u540c\u6b65(synchronous)\u4e14\u55ae\u57f7\u884c\u7dd2(single threaded)\u7684 \u3002\u9019\u610f\u5473\u8457\u7a0b\u5f0f\u78bc\u4e0d\u80fd\u5275\u9020\u65b0\u7684\u7dda\u7a0b(threads),\u4e26\u5e73\u884c(parallel)\u57f7\u884c     JavaScript<pre><code>const a = 1\nconst b = 2\nconst c = a * b\nconsole.log(c)\ndoSomething()\n</code></pre><ul> <li>\u96d6\u7136\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\"\u770b\u8d77\u4f86\"\u662f\u4f9d\u5e8f\u57f7\u884c\u7684,\u4f46\u662fJavascript\u9019\u500b\u7a0b\u5f0f\u8a9e\u8a00,\u8d77\u521d\u662f\u8a95\u751f\u65bc\u700f\u89bd\u5668(browser)\u7684,\u5b83\u4e00\u958b\u59cb\u7684\u5de5\u4f5c\u662f\u7528\u4f86\u56de\u61c9(response)\u4f7f\u7528\u8005\u7684\u884c\u70ba(user actions),\u50cf\u662f<code>onClick</code>\u3001<code>onMouseOver</code>\u3001<code>OnChange</code>\u3001<code>OnSubmit</code>...\u7b49\u7b49\u3002\u8a72\u5982\u4f55\u4f7f\u7528\u540c\u6b65\u7a0b\u5f0f\u8a2d\u8a08\u6a21\u578b(synchronous programming model)\u4f86\u505a\u5230\u9019\u4e9b\u4e8b\u60c5\u5462?</li> <li>\u7b54\u6848\u662f\u5b83\u7684\"\u74b0\u5883\"(environment)\u3002\u700f\u89bd\u5668(browser)\u6703\u900f\u904e\u63d0\u4f9b\u4e00\u7d44\u80fd\u5920\u8655\u7406\u9019\u7a2e\u529f\u80fd\u7684APIs\u4f86\u5b8c\u6210\u9019\u4e00\u9ede</li> <li>\u6700\u8fd1,Node\u5f15\u9032(introduced)\u4e86\u4e00\u500b\u975e\u963b\u585eI/O\u74b0\u5883(non-blocking I/O environment)\u4f86\u5c07\u8a72\u6982\u5ff5(concept)\u5ef6\u4f38(extend)\u5230\u6587\u4ef6\u5b58\u53d6(file access)\u3001\u7db2\u8def\u547c\u53eb(network calls)...\u7b49\u7b49</li> </ul> </li> <li>\u56de\u547c\u51fd\u5f0f(Callbacks)</li> <li>\u56e0\u70ba\u6211\u5011\u7121\u6cd5\u5f97\u77e5\u4f7f\u7528\u8005\u4f55\u6642\u6703\u9ede\u64ca\u6309\u9215,\u6240\u4ee5\u6211\u5011\u53ef\u4ee5\u5c0d\u8a72\u9ede\u64ca\u4e8b\u4ef6(click event)\u5b9a\u7fa9(define)\u4e00\u500b\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u3002\u9019\u500b\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u6703\u63a5\u53d7(accepts)\u4e00\u500b\u51fd\u5f0f(function),\u800c\u9019\u500b\u51fd\u5f0f\u6703\u5728\u8a72\u4e8b\u4ef6\u88ab\u89f8\u767c(triggered)\u6642\u547c\u53eb       JavaScript<pre><code>document.getElementById('button').addEventListener('click', () =&gt; {\n  //item clicked\n})\n</code></pre><ul> <li>\u800c\u9019\u4e5f\u5c31\u662f\u6240\u8b02\u7684\"\u56de\u547c\u51fd\u5f0f\"(callback)</li> </ul> </li> <li>\u56de\u547c\u51fd\u5f0f(callback function)\u662f\u4e00\u500b\u7c21\u55ae\u7684\u51fd\u5f0f,\u80fd\u5920\u4f5c\u70ba\u503c\u50b3\u905e\u7d66\u53e6\u4e00\u500b\u51fd\u5f0f,\u4e26\u4e14\u50c5\u5728\u4e8b\u4ef6\u88ab\u89f8\u767c\u6642\u624d\u6703\u57f7\u884c<ul> <li>\u6211\u5011\u53ef\u4ee5\u9019\u6a23\u505a\u7684\u539f\u56e0\u662f,\u5728Javascript\u9019\u500b\u7a0b\u5f0f\u8a9e\u8a00\u4e2d,\u6709\u4e00\u7d1a\u51fd\u5f0f(first-class functions)\u9019\u7a2e\u6771\u897f,\u4e5f\u5c31\u662f\u51fd\u5f0f\u80fd\u4f5c\u70ba\u503c\u4e26\u6307\u6d3e\u7d66\u8b8a\u6578,\u518d\u50b3\u905e\u7d66\u5176\u4ed6\u51fd\u5f0f(=&gt; \u9019\u7a2e\u51fd\u5f0f\u88ab\u7a31\u4f5c\"\u9ad8\u968e\u51fd\u5f0f\", (higher-order functions))</li> <li>\u5e38\u898b\u7684\u505a\u6cd5\u662f\u5c07\u5ba2\u6236\u7aef\u7684\u7a0b\u5f0f\u78bc\u5305\u88dd\u5728<code>window</code>\u7269\u4ef6\u7684<code>load</code>\u4e8b\u4ef6\u76e3\u807d\u5668(event listener),\u5b83\u53ea\u6703\u5728\u9801\u9762\u6e96\u5099\u597d\u6642\u624d\u6703\u57f7\u884c\u56de\u547c\u51fd\u5f0f     JavaScript<pre><code>window.addEventListener('load', () =&gt; {\n  //window loaded\n  //do what you want\n})\n</code></pre></li> <li>\u56de\u547c\u51fd\u5f0f(Callbacks)\u9084\u6709\u7528\u5728\u5f88\u591a\u5730\u65b9,\u800c\u4e0d\u53ea\u662f\u5728<code>DOM</code>\u4e8b\u4ef6\u4e2d</li> <li>\u53e6\u4e00\u500b\u5e38\u898b\u7684\u505a\u6cd5\u662f\u4f7f\u7528\u8a08\u6642\u5668(timers)     JavaScript<pre><code>setTimeout(() =&gt; {\n  // runs after 2 seconds\n}, 2000)\n</code></pre></li> <li>\u53e6\u5916,<code>XHR</code>\u8acb\u6c42(requests)\u4e5f\u80fd\u63a5\u53d7\u56de\u547c\u51fd\u5f0f(callback function),\u5728\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,\u900f\u904e\u6307\u5b9a\u4e00\u500b\u51fd\u5f0f\u7d66\u7576\u4e00\u500b\u7279\u5b9a\u7684\u4e8b\u4ef6(particular event)\u767c\u751f(occur)\u6642\u6703\u547c\u53eb\u7684\u5c6c\u6027(property)</li> <li>\u5728\u9019\u6b21\u7684\u7bc4\u4f8b\u4e2d,\u6240\u8b02\u7279\u5b9a\u7684\u4e8b\u4ef6\u5c31\u662f\u4ee3\u8868\u8acb\u6c42\u7684\u72c0\u614b\u767c\u751f\u6539\u8b8a\u6642(the state of the request changes)     JavaScript<pre><code>const xhr = new XMLHttpRequest()\nxhr.onreadystatechange = () =&gt; {\n  if (xhr.readyState === 4) {\n    xhr.status === 200 ? console.log(xhr.responseText) : console.error('error')\n  }\n}\nxhr.open('GET', 'https://yoursite.com')\nxhr.send()\n</code></pre></li> </ul> </li> <li>\u5728\u56de\u547c\u51fd\u5f0f\u4e2d\u8655\u7406\u932f\u8aa4(Handling errors in callbacks)</li> <li>\u6211\u5011\u5e73\u5e38\u6703\u5982\u4f55\u8655\u7406(handle)\u56de\u547c\u51fd\u5f0f(callbacks)\u7684\u932f\u8aa4(errors)\u5462?<ul> <li>\u4e00\u500b\u5f88\u5e38\u898b\u7684\u7b56\u7565(strategy)\u662f\u5229\u7528Node\u6240\u63a1\u53d6\u7684\u65b9\u6cd5,\u4e5f\u5c31\u662f\u5728\u4efb\u4f55\u4e00\u500b\u56de\u547c\u51fd\u5f0f\u4e2d\u7684\u7b2c\u4e00\u500b\u53c3\u6578(first parameter)\u5c31\u662f\u932f\u8aa4(<code>error</code>)\u7269\u4ef6: error-first callbacks</li> <li>\u5982\u679c\u6c92\u6709\u767c\u751f\u932f\u8aa4(<code>error</code>)\u7684\u8a71,\u8a72\u7269\u4ef6\u7684\u503c\u5c31\u662f<code>null</code>; \u800c\u5982\u679c\u6709\u767c\u751f\u932f\u8aa4(<code>error</code>)\u7684\u8a71,\u8a72\u932f\u8aa4(<code>error</code>)\u7269\u4ef6\u5c31\u6703\u5305\u62ec\u95dc\u65bc\u9019\u500b\u932f\u8aa4(<code>error</code>)\u7684\u4e00\u4e9b\u63cf\u8ff0(description)\u4ee5\u53ca\u5176\u4ed6\u8cc7\u8a0a(information)   JavaScript<pre><code>fs.readFile('/file.json', (err, data) =&gt; {\n  if (err !== null) {\n    //handle error\n    console.log(err)\n    return\n  }\n\n  //no errors, process data\n  console.log(data)\n})\n</code></pre></li> </ul> </li> <li>\u56de\u547c\u51fd\u5f0f\u7684\u554f\u984c(The problem with callbacks)</li> <li>\u56de\u547c\u51fd\u5f0f(Callbacks)\u5f88\u9069\u5408\u7528\u65bc\u7c21\u55ae\u7684\u60c5\u5883\u4e2d</li> <li>\u7136\u800c\u6bcf\u4e00\u500b\u56de\u547c\u51fd\u5f0f\u90fd\u6703\u589e\u52a0\u4e00\u5c64\u5de2\u72c0(nesting),\u9019\u6642\u5019\u5982\u679c\u6211\u5011\u6709\u5f88\u591a\u7684\u56de\u547c\u51fd\u5f0f(callbacks),\u7a0b\u5f0f\u78bc\u5f88\u5feb\u5730\u5c31\u6703\u958b\u59cb\u8b8a\u5f97\u8907\u96dc       JavaScript<pre><code>window.addEventListener('load', () =&gt; {\n  document.getElementById('button').addEventListener('click', () =&gt; {\n    setTimeout(() =&gt; {\n      items.forEach(item =&gt; {\n        //your code here\n      })\n    }, 2000)\n  })\n})\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u53ea\u662f4\u5c64\u7684\u7a0b\u5f0f\u78bc,\u4f46\u662f\u53ef\u80fd\u6703\u6709\u66f4\u591a\u5c64\u7684\u7a0b\u5f0f\u78bc,\u9019\u6a23\u5c31\u4e0d\u597d\u73a9\u4e86</li> <li>\u90a3\u6211\u5011\u8a72\u600e\u9ebc\u89e3\u6c7a\u9019\u500b\u554f\u984c\u5462?</li> </ul> </li> <li>\u56de\u547c\u51fd\u5f0f\u7684\u66ff\u4ee3\u65b9\u6848(Alternatives to callbacks)</li> <li>\u5f9eES6\u958b\u59cb ,Javascript\u7a0b\u5f0f\u8a9e\u8a00\u958b\u59cb\u5f15\u9032(introduced)\u4e86\u8a31\u591a\u80fd\u5920\u4e0d\u6d89\u53ca(do not involve)\u4f7f\u7528\u56de\u547c\u51fd\u5f0f(callbacks)\u4f86\u8655\u7406\u975e\u540c\u6b65(asynchronous)\u7a0b\u5f0f\u78bc\u7684\u529f\u80fd,\u4f8b\u5982\u4ee5\u4e0b2\u7a2e\u529f\u80fd<ul> <li><code>Promise</code>\u7269\u4ef6 (ES6)</li> <li><code>Async/Await</code>\u8a9e\u6cd5 (ES8)</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#understanding-javascript-promises","title":"Understanding JavaScript Promises","text":"<p>Promise\u7269\u4ef6 (by MDN\u5b98\u65b9\u6587\u4ef6) --- The Promise object represents the eventual completion (or failure) of an asynchronous operation and its resulting value. \u5982\u4f55\u4f7f\u7528Promise\u7269\u4ef6 (by MDN\u5b98\u65b9\u6587\u4ef6) Fetch API (by MDN\u5b98\u65b9\u6587\u4ef6) --- The Fetch API provides an interface for fetching resources (including across the network). It will seem familiar to anyone who has used XMLHttpRequest, but the new API provides a more powerful and flexible feature set.</p> <ul> <li>Promise\u7269\u4ef6\u7684\u4ecb\u7d39     JavaScript<pre><code>let done = true\n\nconst isItDoneYet = new Promise((resolve, reject) =&gt; {\n  if (done) {\n    const workDone = 'Here is the thing I built'\n    resolve(workDone)\n  } else {\n    const why = 'Still working on something else'\n    reject(why)\n  }\n})\n\nconst checkIfItsDone = () =&gt; {\n  isItDoneYet\n    .then(ok =&gt; {\n      console.log(ok)\n    })\n    .catch(err =&gt; {\n      console.error(err)\n    })\n}\n\ncheckIfItsDone()\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6703\u6253\u5370\u51fa<code>Here is the thing I built</code></li> </ul> </li> <li><code>Promise</code>\u7269\u4ef6\u901a\u5e38\u6703\u88ab\u5b9a\u7fa9\u70ba\u4e00\u500b\u6700\u7d42(eventually)\u5c07\u6703\u8b8a\u6210\u4e00\u500b\u53ef\u7528\u7684(available)\u4ee3\u7406\u503c(a proxy for a value)</li> <li><code>Promise</code>\u7269\u4ef6\u662f\u4e00\u7a2e\u80fd\u8655\u7406\u975e\u540c\u6b65(asynchronous)\u7a0b\u5f0f\u78bc\u7684\u65b9\u6cd5,\u800c\u4e0d\u7528\u9677\u5165\u56de\u547c\u5730\u7344(callback hell)<ul> <li>\u53ef\u53c3\u8003callback hell</li> </ul> </li> <li>\u81ea\u5f9e2015\u5e74(ES6\u7684\u6a19\u6e96\u5316\u8207\u5f15\u5165)\u958b\u59cb\u5f8c,<code>Promise</code>\u7269\u4ef6\u5df2\u7d93\u6210\u70baJavascript\u7a0b\u5f0f\u8a9e\u8a00\u7684\u4e00\u90e8\u5206\u4e86,\u4e26\u4e14\u5728\u8fd1\u5e74\u4f86\u66f4\u8207ES8\u7684<code>Async/Await</code>\u8a9e\u6cd5\u6574\u5408\u5f97\u66f4\u597d<ul> <li>\u975e\u540c\u6b65\u51fd\u5f0f(Async functions)\u6703\u5728\u80cc\u666f\u4e2d(behind the scenes)\u4f7f\u7528<code>Promise</code>\u7269\u4ef6,\u6240\u4ee5\u4e86\u89e3<code>Promise</code>\u7269\u4ef6\u904b\u4f5c\u7684\u539f\u7406 &amp; \u7406\u89e3<code>Async/Await</code>\u8a9e\u6cd5\u662f\u5982\u4f55\u4f5c\u7528\u7684\u662f\u975e\u5e38\u91cd\u8981\u7684</li> </ul> </li> <li><code>Promise</code>\u7269\u4ef6\u7c21\u55ae\u4f86\u8aaa\u662f\u5982\u4f55\u904b\u4f5c\u7684\u5462?<ul> <li>\u4e00\u65e6<code>Promise</code>\u7269\u4ef6\u88ab\u547c\u53eb\u5f8c,\u5b83\u5c07\u6703\u4ee5\u5f85\u8655\u7406\u72c0\u614b(pending state)\u958b\u59cb\u3002\u9019\u610f\u5473\u8457\u88ab\u547c\u53eb\u7684\u51fd\u5f0f(calling function)\u5c07\u6703\u7e7c\u7e8c\u57f7\u884c,\u7136\u800c<code>Promise</code>\u7269\u4ef6\u4ecd\u7136\u8655\u65bc\u5f85\u8655\u7406\u72c0\u614b(<code>pending</code>),\u76f4\u5230\u88ab\u89e3\u6c7a(<code>resolves</code>)\u70ba\u6b62,\u9032\u800c\u5c07\u6240\u8acb\u6c42\u5230\u7684\u4efb\u4f55\u6578\u64da\u50b3\u905e\u7d66\u5176\u547c\u53eb\u7684\u51fd\u5f0f(calling function)</li> <li>\u5efa\u7acb\u51fa\u4f86\u7684<code>Promise</code>\u7269\u4ef6\u6700\u7d42(eventually)\u5c07\u6703 \u5df2\u89e3\u6c7a\u7684\u72c0\u614b(resolved state) \u6216\u662f \u88ab\u62d2\u7d55\u7684\u72c0\u614b(rejected state) \u7d50\u675f(end in),\u4e26\u547c\u53eb\u5404\u81ea\u5c0d\u61c9\u7684(respective)\u56de\u547c\u51fd\u5f0f(callback functions),\u518d\u50b3\u905e\u7d66<code>then()</code>\u8207<code>catch()</code>\u4e4b\u5f8c\u5c31\u6703\u7acb\u5373\u7d50\u675f(upon finishing)</li> </ul> </li> <li>\u6709\u54ea\u4e9bJavascript\u7684APIs\u6703\u4f7f\u7528\u5230<code>Promise</code>\u7269\u4ef6\u5462?<ul> <li>\u5728\u6211\u5011\u81ea\u5df1\u7684\u7a0b\u5f0f\u78bc\u6216\u662f\u51fd\u5f0f\u5eab(library)\u7684\u7a0b\u5f0f\u78bc\u4e2d,\u6a19\u6e96\u7684\u73fe\u4ee3\u5316Web APIs\u4e5f\u6703\u4f7f\u7528\u5230<code>Promise</code>\u7269\u4ef6,\u50cf\u662f\u4ee5\u4e0b3\u7a2eWeb APIs</li> <li>the Battery API</li> <li>the Fetch API</li> <li>Service Workers</li> <li>\u5728\u73fe\u4ee3\u5316\u7684Javascript\u4e2d,\u6211\u5011\u4e0d\u592a\u53ef\u80fd\u6703\u767c\u73fe\u81ea\u5df1\u6c92\u6709\u5728\u4f7f\u7528<code>Promise</code>\u7269\u4ef6,\u6240\u4ee5\u8b93\u6211\u5011\u958b\u59cb\u6df1\u5165\u947d\u7814\u5b83\u5427!</li> </ul> </li> <li>\u5275\u9020\u4e00\u500b\u627f\u8afe\u7269\u4ef6</li> <li><code>Promise</code>\u7269\u4ef6API\u6703\u516c\u958b(exposes)\u4e00\u500b\u5efa\u69cb\u5b50(constructor),\u6211\u5011\u53ef\u4ee5\u4f7f\u7528<code>new Promise()</code>\u7684\u8a9e\u6cd5\u4f86\u521d\u59cb\u5316\u4e00\u500b<code>Promise</code>\u7269\u4ef6       JavaScript<pre><code>let done = true\n\nconst isItDoneYet = new Promise((resolve, reject) =&gt; {\n  if (done) {\n    const workDone = 'Here is the thing I built'\n    resolve(workDone)\n  } else {\n    const why = 'Still working on something else'\n    reject(why)\n  }\n})\n</code></pre><ul> <li>\u5982\u6211\u5011\u6240\u898b,\u9019\u500b<code>Promise</code>\u7269\u4ef6\u6703\u6aa2\u67e5\u5168\u57df\u7684<code>done</code>\u5e38\u6578(global constant),\u800c\u5982\u679c<code>done</code>\u9019\u500b\u5168\u57df\u5e38\u6578\u7684\u503c\u70ba<code>true</code>\u7684\u8a71,\u5247<code>Promise</code>\u7269\u4ef6\u5c31\u6703\u9032\u5165\u5df2\u89e3\u6c7a\u7684\u72c0\u614b(resolved state) (\u7531\u65bc<code>resolve</code>\u56de\u547c\u51fd\u5f0f\u5df2\u7d93\u88ab\u547c\u53eb); \u5426\u5247,<code>reject</code>\u56de\u547c\u51fd\u5f0f\u5c31\u6703\u88ab\u57f7\u884c,\u4e26\u5c07<code>Promise</code>\u7269\u4ef6\u8b8a\u6210\u88ab\u62d2\u7d55\u7684\u72c0\u614b(rejected state)<ul> <li>\u800c\u5982\u679c\u4e0a\u8ff0\u76842\u7a2e\u51fd\u5f0f(<code>resolve</code> callback function &amp; <code>reject</code> callback function)\u90fd\u6c92\u6709\u88ab\u547c\u53eb\u7684\u8a71,<code>Promise</code>\u7269\u4ef6\u5c31\u6703\u7dad\u6301\u70ba\u5f85\u8655\u7406\u72c0\u614b(<code>pending</code> state)</li> </ul> </li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528<code>resolve</code>\u8207<code>reject</code>\u5169\u500b\u8a9e\u6cd5\u4f86\u5c07<code>Promise</code>\u7269\u4ef6\u7684\u7d50\u679c\u72c0\u614b(resulting state) &amp; \u5c07\u5982\u4f55\u8655\u7406\u7684\u65b9\u6cd5 \u56de\u50b3\u7d66\u547c\u53eb\u65b9(caller)\u3002\u5728\u4e0a\u8ff0\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,\u6211\u5011\u50c5\u56de\u50b3\u4e00\u500b\u5b57\u4e32(string),\u4f46\u5176\u5be6\u4e5f\u53ef\u4ee5\u56de\u50b3\u4e00\u500b\u7269\u4ef6(object)\u6216\u751a\u81f3\u662f<code>null</code></li> <li>\u56e0\u70ba\u6211\u5011\u5df2\u7d93\u5728\u4e0a\u8ff0\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6458\u9304(snippet)\u4e2d,\u5efa\u7acb\u4e86\u4e00\u500b<code>Promise</code>\u7269\u4ef6,\u56e0\u6b64\u5b83\u5df2\u7d93\u958b\u59cb\u57f7\u884c\u4e86\u3002\u9019\u5c07\u6703\u6709\u52a9\u65bc\u6211\u5011\u4e86\u89e3\u4ee5\u4e0b\u7684\"\u5982\u4f55\u4f7f\u7528<code>Promise</code>\u7269\u4ef6\"\u7ae0\u7bc0</li> </ul> </li> <li>\u53e6\u4e00\u500b\u6211\u5011\u53ef\u80fd\u6703\u78b0\u5230\u7684\u66f4\u5e38\u898b\u505a\u6cd5\u662f\u4e00\u7a2e\u88ab\u7a31\u70ba Promisifying \u7684\u6280\u8853\u3002\u9019\u7a2e\u6280\u8853\u662f\u4e00\u500b\u80fd\u5920\u4f7f\u7528\u53e4\u5178\u7684Javascript\u51fd\u5f0f\u4f86\u63a5\u6536(takes)\u4e00\u500b\u56de\u547c\u51fd\u5f0f(callback),\u4e26\u4f7f\u5176\u56de\u50b3\u4e00\u500b<code>Promise</code>\u7269\u4ef6     JavaScript<pre><code>const fs = require('fs')\n\nconst getFile = (fileName) =&gt; {\n  return new Promise((resolve, reject) =&gt; {\n    fs.readFile(fileName, (err, data) =&gt; {\n      if (err) {\n        reject (err)  // calling `reject` will cause the promise to fail with or without the error passed as an argument\n        return        // and we don't want to go any further\n      }\n      resolve(data)\n    })\n  })\n}\n\ngetFile('/etc/passwd')\n.then(data =&gt; console.log(data))\n.catch(err =&gt; console.error(err))\n</code></pre></li> <li>\u88dc\u5145: \u5728\u6700\u8fd1\u7684Node\u7248\u672c\u4e2d,\u6211\u5011\u4e0d\u9700\u8981\u70ba\u8a31\u591a\u7684API\u9032\u884c\u624b\u52d5\u8f49\u63db(manual conversion)\u3002\u5047\u8a2d\u6211\u5011\u8981\u4f7f\u7528\u7684 Promisifying \u6280\u8853\u6709\u6b63\u78ba\u7684\u7c3d\u540d(correct signature)\u7684\u8a71,\u5728Node\u7684\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Util</code>\u4e2d\u6709\u4e00\u500b\u65b9\u6cd5\u53eb\u505autil.promisify(original)\u53ef\u4ee5\u4f7f\u7528,\u4f86\u5e6b\u52a9\u6211\u5011\u5be6\u73fe Promisifying \u6280\u8853</li> <li>\u4f7f\u7528<code>Promise</code>\u7269\u4ef6</li> <li>\u5728\u4e0a\u4e00\u500b\u7ae0\u7bc0\u4e2d,\u6211\u5011\u4ecb\u7d39\u4e86\u4e00\u500b<code>Promise</code>\u7269\u4ef6\u662f\u5982\u4f55\u88ab\u5efa\u7acb\u7684?</li> <li>\u73fe\u5728,\u6211\u5011\u8981\u4f86\u770b\u4e00\u500b<code>Promise</code>\u7269\u4ef6\u662f\u5982\u4f55\u88ab\u4f7f\u7528\u7684(used)   JavaScript<pre><code>const isItDoneYet = new Promise(/* ... as above ... */)\n//...\n\n//no errors, process data\nconsole.log(data)\n</code></pre></li> <li>\u56de\u547c\u51fd\u5f0f\u7684\u554f\u984c(The problem with callbacks)</li> <li>\u56de\u547c\u51fd\u5f0f(Callbacks)\u5f88\u9069\u5408\u7528\u65bc\u7c21\u55ae\u7684\u60c5\u5883\u4e2d</li> <li>\u7136\u800c\u6bcf\u4e00\u500b\u56de\u547c\u51fd\u5f0f\u90fd\u6703\u589e\u52a0\u4e00\u5c64\u5de2\u72c0(nesting),\u9019\u6642\u5019\u5982\u679c\u6211\u5011\u6709\u5f88\u591a\u7684\u56de\u547c\u51fd\u5f0f(callbacks),\u7a0b\u5f0f\u78bc\u5f88\u5feb\u5730\u5c31\u6703\u958b\u59cb\u8b8a\u5f97\u8907\u96dc     JavaScript<pre><code>window.addEventListener('load', () =&gt; {\n  document.getElementById('button').addEventListener('click', () =&gt; {\n    setTimeout(() =&gt; {\n      items.forEach(item =&gt; {\n        //your code here\n      })\n    }, 2000)\n  })\n})\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u53ea\u662f4\u5c64\u7684\u7a0b\u5f0f\u78bc,\u4f46\u662f\u53ef\u80fd\u6703\u6709\u66f4\u591a\u5c64\u7684\u7a0b\u5f0f\u78bc,\u9019\u6a23\u5c31\u4e0d\u597d\u73a9\u4e86</li> <li>\u90a3\u6211\u5011\u8a72\u600e\u9ebc\u89e3\u6c7a\u9019\u500b\u554f\u984c\u5462?</li> </ul> </li> <li>\u56de\u547c\u51fd\u5f0f\u7684\u66ff\u4ee3\u65b9\u6848(Alternatives to callbacks)</li> <li>\u5f9eES6\u958b\u59cb ,Javascript\u7a0b\u5f0f\u8a9e\u8a00\u958b\u59cb\u5f15\u9032(introduced)\u4e86\u8a31\u591a\u80fd\u5920\u4e0d\u6d89\u53ca(do not involve)\u4f7f\u7528\u56de\u547c\u51fd\u5f0f(callbacks)\u4f86\u8655\u7406\u975e\u540c\u6b65(asynchronous)\u7a0b\u5f0f\u78bc\u7684\u529f\u80fd,\u4f8b\u5982\u4ee5\u4e0b2\u7a2e\u529f\u80fd<ul> <li><code>Promise</code>\u7269\u4ef6 (ES6)</li> <li><code>Async/Await</code>\u8a9e\u6cd5 (ES8)   JavaScript<pre><code>const checkIfItsDone = () =&gt; {\n  isItDoneYet\n    .then(ok =&gt; {\n      console.log(ok)\n    })\n    .catch(err =&gt; {\n      console.error(err)\n    })\n}\n</code></pre></li> <li>\u57f7\u884c<code>checkIfItsDone()</code>\u65b9\u6cd5\u5c07\u6703\u6307\u5b9a(specify),\u7576<code>isItDoneYet</code>\u9019\u500b<code>Promise</code>\u7269\u4ef6\u5728</li> <li>\u5df2\u89e3\u6c7a\u7684\u72c0\u614b(resolves)\u6642,\u6703\u57f7\u884c<code>then()</code>\u65b9\u6cd5\u88e1\u9762\u7684\u51fd\u5f0f</li> <li>\u6216\u662f</li> <li>\u88ab\u62d2\u7d55\u7684\u72c0\u614b(rejects)\u6642,\u6703\u57f7\u884c<code>catch()</code>\u65b9\u6cd5\u88e1\u9762\u7684\u51fd\u5f0f</li> </ul> </li> <li>\u9023\u9396<code>Promise</code>\u7269\u4ef6(Chaining promises)</li> <li>\u4e00\u500b<code>Promise</code>\u7269\u4ef6\u53ef\u4ee5\u88ab\u56de\u50b3\u7d66\u53e6\u4e00\u500b<code>Promise</code>\u7269\u4ef6,\u4f86\u5275\u9020\u51fa\u4e00\u4e32\u9023\u9396<code>Promise</code>\u7269\u4ef6(a chain of promises)</li> <li>Fetch API\u5c31\u662f\u4e00\u500b\u5f88\u597d\u7684\u9023\u9396<code>Promise</code>\u7269\u4ef6\u7684\u4f8b\u5b50\u3002<code>Fetch API</code>\u80fd\u8b93\u6211\u5011\u7372\u53d6\u8cc7\u6e90(get a resource)\u4e26\u4e14\u7576\u8cc7\u6e90\u88ab\u7372\u53d6(fetched)\u6642,\u5c07\u9023\u9396<code>Promise</code>\u7269\u4ef6(a chain of promises)\u6392\u968a(queue)\u5f8c\u57f7\u884c(execute)<ul> <li><code>Fetch API</code>\u662f\u4e00\u500b\u57fa\u65bc<code>Promise</code>\u7269\u4ef6\u7684\u6a5f\u5236(mechanism),\u547c\u53eb<code>fetch()</code>\u65b9\u6cd5\u76f8\u7576\u65bc\u900f\u904e<code>new Promise()</code>\u5efa\u69cb\u5b50\u4f86\u5efa\u7acb\u51fa\u4e00\u500b\u5c6c\u65bc\u6211\u5011\u81ea\u5b9a\u7fa9\u7684<code>Promise</code>\u7269\u4ef6   JavaScript<pre><code>const status = response =&gt; {\n  if (response.status &gt;= 200 &amp;&amp; response.status &lt; 300) {\n    return Promise.resolve(response)\n  }\n  return Promise.reject(new Error(response.statusText))\n}\n\nconst json = response =&gt; response.json()\n\nfetch('/todos.json')\n  .then(status)    // note that the `status` function is actually **called** here, and that it **returns a promise**\n  .then(json)      // likewise, the only difference here is that the `json` function here returns a promise that resolves with `data`\n  .then(data =&gt; {  // ... which is why `data` shows up here as the first parameter to the anonymous function\n    console.log('Request succeeded with JSON response', data)\n  })\n  .catch(error =&gt; {\n    console.log('Request failed', error)\n  })\n</code></pre></li> <li>\u5728\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,\u6211\u5011\u547c\u53eb\u4e86<code>fetch()</code>\u65b9\u6cd5,\u5f9e\u6839\u76ee\u9304\u4e2d\u7684<code>todos.json</code>\u9019\u500b\u6a94\u6848\u4e2d\u4f86\u7372\u5f97\u4e00\u500b\u5f85\u8fa6\u6e05\u55ae(a list of TODO items),\u63a5\u8457\u6211\u5011\u5c31\u5efa\u7acb\u51fa\u4e00\u4e32\u9023\u9396<code>Promise</code>\u7269\u4ef6(a chain of promises)</li> <li>\u57f7\u884c<code>fetch()</code>\u65b9\u6cd5\u6703\u56de\u50b3\u4e00\u500bresponse\u7269\u4ef6,\u5b83\u5177\u6709\u8a31\u591a\u5c6c\u6027(properties),\u6211\u5011\u6709\u53c3\u8003(reference)\u7684\u5c6c\u6027\u6709\u4ee5\u4e0b2\u7a2e<ul> <li><code>reponse.status</code>: \u4e00\u500b\u4ee3\u8868HTTP\u72c0\u614b\u78bc(status code)\u7684\u6578\u503c(numeric value)</li> <li><code>response.statusText</code>: \u4e00\u500b\u72c0\u614b\u8a0a\u606f,\u5982\u679c\u662f<code>'OK'</code>\u5247\u8868\u793a\u8a72\u8acb\u6c42\u6210\u529f(request succeeded)</li> </ul> </li> <li>\u81ea\u5b9a\u7fa9\u7684: <code>response</code>\u7269\u4ef6\u4e5f\u6709<code>response.json()</code>\u65b9\u6cd5,\u53ef\u4ee5\u56de\u50b3\u4e00\u500b<code>Promise</code>\u7269\u4ef6,\u9019\u500b\u65b9\u6cd5\u53ef\u4ee5\u7528\u4f86\u8655\u7406\u5167\u6587(the content of the body),\u4e26\u8f49\u63db\u6210<code>JSON</code>\u683c\u5f0f</li> <li>\u6240\u4ee5\u8003\u616e\u5230\u9019\u4e9b\u524d\u63d0(premises),\u5c31\u6703\u767c\u751f\u9019\u7a2e\u60c5\u6cc1,\u4e00\u4e32\u9023\u9396<code>Promise</code>\u7269\u4ef6\u4e2d\u7684\u7b2c\u4e00\u500b<code>Promise</code>\u7269\u4ef6\u662f\u6211\u5011\u5b9a\u7fa9\u7684<code>status()</code>\u51fd\u5f0f,\u8a72\u51fd\u5f0f\u7528\u4f86\u6aa2\u67e5\u56de\u61c9\u7684\u72c0\u614b(reponse status),\u82e5\u9019\u500b\u56de\u61c9\u72c0\u614b\u78bc\u4e0d\u662f\u6210\u529f\u7684(= <code>200</code>~<code>299</code>),\u8a72\u51fd\u5f0f\u5c31\u6703\u62d2\u7d55(rejects)\u9019\u500b<code>Promise</code>\u7269\u4ef6<ul> <li>\u6b64\u64cd\u4f5c(operation)\u5c07\u6703\u5c0e\u81f4\u6574\u500b\u8a72<code>Promise</code>\u7269\u4ef6\u6703\u8df3\u904e\u5217\u51fa\u7684(listed)\u6240\u6709\u9023\u9396<code>Promise</code>\u7269\u4ef6\u93c8,\u4e26\u76f4\u63a5\u8df3\u5230\u4e0b\u9762\u7684<code>catch()</code>\u9673\u8ff0\u53e5,\u8a72\u51fd\u5f0f\u6703\u8a18\u9304\u8acb\u6c42\u5931\u6557(<code>Request failed</code>)\u7684\u6587\u672c(text) &amp; \u932f\u8aa4\u8a0a\u606f(error message)</li> </ul> </li> <li>\u5982\u679c\u6211\u5011\u81ea\u5b9a\u7fa9\u7684<code>status()</code>\u51fd\u5f0f\u56de\u50b3\u7684\u56de\u61c9\u72c0\u614b\u78bc\u662f\u6210\u529f\u7684\u8a71,\u5b83\u6703\u547c\u53eb\u6211\u5011\u81ea\u5b9a\u7fa9\u7684<code>repsonse.json()</code>\u51fd\u5f0f\u3002\u7531\u65bc\u524d\u4e00\u500b(previous)<code>Promise</code>\u7269\u4ef6\u5728\u8acb\u6c42\u6210\u529f(successful)\u5f8c\u6703\u56de\u50b3\u4e00\u500b<code>response</code>\u7269\u4ef6,\u6211\u5011\u6703\u5c07\u9019\u500b<code>response</code>\u7269\u4ef6\u4f5c\u70ba\u4e0b\u4e00\u500b<code>Promise</code>\u7269\u4ef6\u7684\u8f38\u5165(input)</li> <li>\u5728\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,\u6211\u5011\u6703\u56de\u50b3\u4e00\u500b\u7d93\u904e<code>response.json()</code>\u51fd\u5f0f\u8655\u7406\u904e(<code>JSON</code> processed)\u7684\u8cc7\u6599(data),\u56e0\u6b64\u7b2c\u4e09\u500b<code>Promise</code>\u7269\u4ef6\u5c31\u80fd\u76f4\u63a5\u6536\u5230(receives)\u9019\u500b<code>JSON</code>\u7269\u4ef6<ul> <li><code>js     .then((data) =&gt; {       console.log('Request succeeded with JSON response', data)     })</code></li> <li>\u63a5\u4e0b\u4f86,\u6211\u5011\u53ea\u8981\u5c07\u9019\u500b\u8a18\u9304\u5230\u63a7\u5236\u53f0(console)\u5373\u53ef</li> </ul> </li> </ul> </li> <li>\u8655\u7406\u932f\u8aa4(Handling errors)</li> <li>\u5728\u4e0a\u4e00\u7bc0\u7684\u7bc4\u4f8b\u4e2d,\u6211\u5011\u5728\u9023\u9396<code>Promise</code>\u7269\u4ef6\u93c8\u4e2d\u9644\u52a0\u4e86<code>catch()</code>\u51fd\u5f0f       JavaScript<pre><code>.catch(error =&gt; {\n  console.log('Request failed', error)\n})\n</code></pre></li> <li>\u5982\u679c\u5728\u6574\u500b\u9023\u9396<code>Promise</code>\u7269\u4ef6\u93c8\u4e2d\u6709\u4efb\u4f55\u7684\u5931\u6557(fails)\u4e26\u5f15\u8d77(raises)\u4e00\u500b\u932f\u8aa4(error)\u6216\u662f\u88ab\u62d2\u7d55\u7684<code>Promise</code>\u7269\u4ef6,\u7a0b\u5f0f\u78bc\u7684\u6d41\u7a0b\u63a7\u5236\u6b0a(control)\u5c07\u6703\u8f49\u79fb\u5230\u6574\u500b\u9023\u9396<code>Promise</code>\u7269\u4ef6\u93c8\u4e0b\u9762\u4e14\u6700\u8fd1\u7684(nearest)<code>catch()</code>\u9673\u8ff0\u53e5       JavaScript<pre><code>new Promise((resolve, reject) =&gt; {\n  throw new Error('Error')\n}).catch(err =&gt; {\n  console.error(err)\n})\n\n// or\n\nnew Promise((resolve, reject) =&gt; {\n  reject('Error')\n}).catch(err =&gt; {\n  console.error(err)\n})\n</code></pre></li> <li>\u4e32\u93c8\u932f\u8aa4(Cascading errors)<ul> <li>\u5982\u679c\u5728<code>catch()</code>\u9673\u8ff0\u53e5\u88e1\u9762,\u53c8\u5f15\u8d77(raises)\u4e86\u4e00\u500b\u932f\u8aa4(error),\u6211\u5011\u53ef\u4ee5\u518d\u9644\u52a0\u7b2c2\u500b<code>catch()</code>\u51fd\u5f0f\u4f86\u8655\u7406\u8a72\u932f\u8aa4(error),\u4ee5\u6b64\u985e\u63a8   JavaScript<pre><code>new Promise((resolve, reject) =&gt; {\n  throw new Error('Error')\n})\n  .catch(err =&gt; {\n    throw new Error('Error')\n  })\n  .catch(err =&gt; {\n    console.error(err)\n  })\n</code></pre></li> </ul> </li> <li>\u7de8\u6392<code>Promise</code>\u7269\u4ef6(Orchestrating promises)</li> <li>Promise.all(iterable)<ul> <li>\u5982\u679c\u6211\u5011\u60f3\u8981\u540c\u6b65\u5316(synchronize)\u4e0d\u540c\u7684<code>Promise</code>\u7269\u4ef6,<code>Promise.all()</code>\u65b9\u6cd5\u53ef\u4ee5\u5b9a\u7fa9\u4e00\u500b<code>Promise</code>\u7269\u4ef6\u7684\u6e05\u55ae(list),\u4e26\u5728\u5168\u90e8\u7684<code>Promise</code>\u7269\u4ef6\u90fd\u88ab\u89e3\u6c7a(all resolved)\u5f8c,\u57f7\u884c\u4e00\u4e9b\u64cd\u4f5c JavaScript<pre><code>const f1 = fetch('/something.json')\nconst f2 = fetch('/something2.json')\n\nPromise.all([f1, f2])\n  .then(res =&gt; {\n    console.log('Array of results', res)\n  })\n  .catch(err =&gt; {\n    console.error(err)\n  })\n</code></pre></li> <li>\u6211\u5011\u53ef\u4ee5\u4f7f\u7528ES6(= ES2015)\u5f15\u9032\u7684\u89e3\u69cb\u6307\u6d3e\u8a9e\u6cd5(destructuring assignment syntax)\u4f86\u9019\u6a23\u505a     JavaScript<pre><code>Promise.all([f1, f2]).then(([res1, res2]) =&gt; {\n  console.log('Results', res1, res2)\n})\n</code></pre></li> <li>\u7576\u7136,\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528fetch() API\u4f86\u5be6\u4f5c, \u4efb\u4f55<code>Promise</code>\u7269\u4ef6\u90fd\u53ef\u4ee5\u4f7f\u7528<code>Promise.all()</code>\u65b9\u6cd5</li> </ul> </li> <li>Promise.race(iterable)<ul> <li>\u7576\u6211\u5011\u5c07\u50b3\u905e\u7d66<code>Promise.race()</code>\u65b9\u6cd5\u7684\u7b2c1\u500b<code>Promise</code>\u7269\u4ef6\u88ab\u89e3\u6c7a(resolved)\u6642,\u6703\u57f7\u884c\u8a72\u65b9\u6cd5,\u4e26\u4e14\u5b83\u53ea\u6703\u57f7\u884c\u5176\u9644\u52a0\u7684\u56de\u547c\u51fd\u5f0f(attached callback)\"\u4e00\u6b21\",\u4e26\u89e3\u6c7a\u7b2c1\u500b<code>Promise</code>\u7269\u4ef6\u7684\u7d50\u679c JavaScript<pre><code>const first = new Promise((resolve, reject) =&gt; {\n  setTimeout(resolve, 500, 'first')\n})\nconst second = new Promise((resolve, reject) =&gt; {\n  setTimeout(resolve, 100, 'second')\n})\n\nPromise.race([first, second]).then(result =&gt; {\n  console.log(result) // second\n})\n</code></pre></li> </ul> </li> <li>\u5e38\u898b\u7684\u932f\u8aa4(Common errors)</li> <li>\u672a\u6355\u7372\u7684\u578b\u5225\u932f\u8aa4: <code>undefined</code>\u4e0d\u662f\u4e00\u500b<code>Promise</code>\u7269\u4ef6(Uncaught TypeError: undefined is not a promise)<ul> <li>\u5982\u679c\u5728\u63a7\u5236\u53f0(console)\u5f97\u5230\u6b64\u932f\u8aa4(error)\u6642,\u53ef\u4ee5\u53bb\u78ba\u8a8d\u4e00\u4e0b\u6211\u5011\u662f\u4f7f\u7528<code>new Promise()</code>\u8a9e\u6cd5\u4f86\u5efa\u7acb\u4e00\u500b\u65b0\u7684<code>Promise</code>\u7269\u4ef6,\u800c\"\u4e0d\u662f\"\u4f7f\u7528<code>Promise()</code>\u8a9e\u6cd5</li> </ul> </li> <li>\u672a\u8655\u7406\u7684\u88ab\u62d2\u7d55\u7684<code>Promise</code>\u7269\u4ef6\u8b66\u544a(UnhandledPromiseRejectionWarning)<ul> <li>\u9019\u500b\u932f\u8aa4\u8868\u793a\u6211\u5011\u547c\u53eb\u7684<code>Promise</code>\u7269\u4ef6\u88ab\u62d2\u7d55(rejected)\u4e86,\u4f46\u9019\u6642\u5019\u627e\u4e0d\u5230\u4efb\u4f55\u4e00\u500b<code>catch()</code>\u9673\u8ff0\u5f0f\u4f86\u8655\u7406\u9019\u500b\u932f\u8aa4(error)\u3002\u9019\u6642,\u6211\u5011\u53ef\u4ee5\u65b0\u589e\u4e00\u500b<code>catch()</code>\u9673\u8ff0\u5f0f\u5728\u5f15\u8d77\u554f\u984c(offending)\u7684<code>then()</code>\u65b9\u6cd5\u7684\u5f8c\u9762\u4f86\u9069\u7576\u5730(properly)\u8655\u7406\u9019\u500b\u932f\u8aa4(error)</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#modern-asynchronous-javascript-with-async-and-await","title":"Modern Asynchronous JavaScript with Async and Await","text":"<ul> <li>\u4ecb\u7d39</li> <li>Javascript\u5728\u5f88\u77ed\u7684\u6642\u9593\u5167\u5f9e\u56de\u547c\u51fd\u5f0f(callbacks)\u767c\u5c55\u6210<code>Promise</code>\u7269\u4ef6(=&gt; \u5f9eES6\u5f15\u5165\u7684),\u518d\u6f14\u8b8a\u6210<code>async/await</code>\u8a9e\u6cd5(=&gt; \u5f9eES8\u5f15\u5165\u7684),\u4f86\u4f7fJavascript\u7684\u975e\u540c\u6b65(asynchronous)\u8a9e\u6cd5\u66f4\u7c21\u5316\u4e86</li> <li>\u975e\u540c\u6b65\u51fd\u5f0f(Async functions)\u662f\u7531<code>Promise</code>\u7269\u4ef6\u5011 &amp; \u751f\u6210\u5668(generators)\u7684\u7d50\u5408(combination)\u3002\u57fa\u672c\u4e0a,\u5b83\u5011\u7b97\u662f\u4e00\u7a2e\u66f4\u9ad8\u968e\u7684<code>Promise</code>\u7269\u4ef6\u7684\u62bd\u8c61(abstraction)</li> <li>\u8b93\u6211\u518d\u91cd\u8907\u4e00\u6b21,<code>async/await</code>\u8a9e\u6cd5\u662f\u5efa\u7acb\u5728<code>Promise</code>\u7269\u4ef6\u7684\u57fa\u790e\u4e4b\u4e0a\u7684</li> <li>\u70ba\u4ec0\u9ebc<code>async/await</code>\u8a9e\u6cd5\u6703\u88ab\u5f15\u9032(introduced)\u5462?</li> <li><code>async/await</code>\u8a9e\u6cd5\u80fd\u6e1b\u5c11\u95dc\u65bc<code>Promise</code>\u7269\u4ef6\u7684\u6a23\u677f(boilerplate),\u4e26\u4e14\u53ef\u4ee5\u6253\u7834(break) \"\u4e0d\u80fd\u7834\u58de<code>Promise</code>\u7269\u4ef6\u93c8\" \u7684\u9019\u500b\u9650\u5236(limitation)</li> <li>\u7576<code>Promise</code>\u7269\u4ef6\u5728ES6\u958b\u59cb\u5f15\u5165(introduced)\u6642,\u5b83\u5011\u65e8\u5728\u89e3\u6c7a\u975e\u540c\u6b65\u7a0b\u5f0f\u78bc(asynchronous code)\u7684\u554f\u984c,\u7576\u7136<code>Promise</code>\u7269\u4ef6\u6709\u5b8c\u6210\u9019\u500b\u76ee\u6a19\u4e86\u3002\u4f46\u662f\u5728\u63a5\u4e0b\u4f86\u76842\u5e74\u5167(=&gt; ES6~ES8),<code>Promise</code>\u7269\u4ef6\u5f88\u660e\u986f\u5730,\u4e0d\u80fd\u4f5c\u70ba\u6700\u5f8c\u7684\u89e3\u6c7a\u65b9\u6848(final solution)</li> <li><code>Promise</code>\u7269\u4ef6\u7684\u5f15\u5165(introduced)\u662f\u7528\u4f86\u89e3\u6c7a(solve)\u8457\u540d\u7684\u56de\u547c\u5730\u7344(callback hell)\u554f\u984c\u3002\u4f46\u662f<code>Promise</code>\u7269\u4ef6\u81ea\u5df1\u672c\u8eab\u4e5f\u5f15\u5165\u4e86\u8907\u96dc\u6027\u8207\u8a9e\u6cd5\u8907\u96dc\u6027(syntax complexity)<ul> <li>\u5b83\u5011\u662f\u5f88\u597d\u7684\u539f\u8a9e(primitives),\u53ef\u4ee5\u5411\u958b\u767c\u4eba\u54e1\u516c\u958b\u66f4\u597d\u7684\u8a9e\u6cd5\u3002\u56e0\u6b64,\u7576\u6642\u6a5f\u5408\u9069\u6642,\u6211\u5011\u5c31\u80fd\u958b\u59cb\u4f7f\u7528<code>async/await</code>\u8a9e\u6cd5</li> </ul> </li> <li><code>async/await</code>\u8a9e\u6cd5\u80fd\u8b93\u7a0b\u5f0f\u78bc\"\u770b\u8d77\u4f86\"\u662f\u540c\u6b65\u7684(synchronous), \u4f46\u662f\u5728\u80cc\u666f\u4e2d(behind the scenes)\u5b83\u5011\u662f\u975e\u540c\u6b65\u7684(asynchronous)\u4e14\u975e\u963b\u585e\u7684(non-blocking)</li> <li>\u9019\u662f\u5982\u4f55\u904b\u4f5c\u7684\u5462?</li> <li>\u4e00\u500b\u975e\u540c\u6b65\u51fd\u5f0f(async function)\u6703\u56de\u50b3\u4e00\u500b<code>Promise</code>\u7269\u4ef6,\u5982\u540c\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const doSomethingAsync = () =&gt; {\n  return new Promise(resolve =&gt; {\n    setTimeout(() =&gt; resolve('I did something'), 3000)\n  })\n}\n</code></pre><ul> <li>\u5982\u679c\u6211\u5011\u60f3\u8981\u547c\u53eb\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u51fd\u5f0f\u7684\u8a71,\u5c31\u8981\u524d\u7f6e(prepend) <code>await</code>\u8a9e\u6cd5\u4f86\u547c\u53eb,\u4e26\u4e14\u547c\u53eb\u7684\u7a0b\u5f0f\u78bc\u6703\u76f4\u5230\u7576\u8a72<code>Promise</code>\u7269\u4ef6\u88ab\u89e3\u6c7a(resolved)\u6216\u662f\u88ab\u62d2\u7d55(rejected)\u5f8c\u624d\u6703\u505c\u6b62</li> </ul> </li> <li>\u8b66\u544a(caveat): \u5ba2\u6236\u7aef\u51fd\u5f0f(client function)\u5fc5\u9808\u5b9a\u7fa9\u70ba(defined as)\u975e\u540c\u6b65\u51fd\u5f0f(async function) JavaScript<pre><code>const doSomething = async () =&gt; {\n  console.log(await doSomethingAsync())\n}\n</code></pre></li> <li>\u4e00\u500b\u5feb\u901f\u7684\u7bc4\u4f8b</li> <li>\u4ee5\u4e0b\u662f\u4e00\u500b\u95dc\u65bc<code>async/await</code>\u8a9e\u6cd5\u7684\u5feb\u901f\u7bc4\u4f8b,\u4ee5\u975e\u540c\u6b65(asynchronous)\u7684\u65b9\u5f0f\u4f86\u57f7\u884c\u51fd\u5f0f(function)     JavaScript<pre><code>const doSomethingAsync = () =&gt; {\n  return new Promise(resolve =&gt; {\n    setTimeout(() =&gt; resolve('I did something'), 3000)\n  })\n}\n\nconst doSomething = async () =&gt; {\n  console.log(await doSomethingAsync())\n}\n\nconsole.log('Before')\ndoSomething()\nconsole.log('After')\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6703\"\u4f9d\u5e8f\"\u56de\u50b3</li> <li>Before</li> <li>After</li> <li>I did something</li> </ul> </li> <li>Promise all the things</li> <li>\u5728\u4efb\u4f55\u51fd\u5f0f\u524d\u7f6e(prepending) <code>async</code>\u95dc\u9375\u5b57(keyword)\u8868\u793a\u8a72\u51fd\u5f0f(function)\u6703\u56de\u50b3\u4e00\u500b<code>Promise</code>\u7269\u4ef6<ul> <li>\u5373\u4f7f<code>async function</code>\u770b\u8d77\u4f86\u6c92\u6709\u660e\u78ba\u5730\u9019\u9ebc\u505a,\u4f46\u662f\u5728\u5176\u5167\u90e8(internally)\u6703\u56de\u50b3\u4e00\u500b<code>Promise</code>\u7269\u4ef6</li> </ul> </li> <li>\u9019\u4e5f\u5c31\u662f\u70ba\u4ec0\u9ebc\u4ee5\u4e0b\u7684\u9019\u6bb5\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u662f\u6709\u6548\u7684(valid)     JavaScript<pre><code>const aFunction = async () =&gt; {\n  return 'test'\n}\n\naFunction().then(alert) // This will alert 'test'\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e5f\u76f8\u7576\u65bc\u4e0b\u9762\u9019\u6bb5\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>const aFunction = () =&gt; {\n  return Promise.resolve('test')\n}\n\naFunction().then(alert) // This will alert 'test'\n</code></pre></li> </ul> </li> <li>\u7a0b\u5f0f\u78bc\u4e5f\u6703\u8b8a\u5f97\u66f4\u5bb9\u6613\u95b1\u8b80</li> <li>\u5982\u540c\u4e0a\u4e00\u500b\u7ae0\u7bc0\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc,\u9019\u6b21\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u770b\u8d77\u4f86\u975e\u5e38\u7c21\u55ae\u3002\u5f9e\u7a0b\u5f0f\u78bc\u7684\u6bd4\u8f03\u4e2d\u53ef\u4ee5\u770b\u51fa,\u4f7f\u7528<code>Promise</code>\u7269\u4ef6,\u4e26\u642d\u914d<code>Promise</code>\u7269\u4ef6\u93c8\u8207\u56de\u547c\u51fd\u5f0f(callback functions)\u53ef\u4ee5\u8b93\u7a0b\u5f0f\u78bc\u8b8a\u5f97\u66f4\u7c21\u6f54</li> <li>\u4ee5\u4e0b\u662f2\u500b\u975e\u5e38\u7c21\u55ae\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u7684\u6bd4\u8f03,\u7576\u7a0b\u5f0f\u78bc\u958b\u59cb\u8b8a\u5f97\u8907\u96dc\u7684\u6642\u5019,\u4f7f\u7528<code>async/await</code>\u8a9e\u6cd5\u80fd\u5e36\u4f86\u5f88\u591a\u597d\u8655<ul> <li>\u9019\u662f\u5229\u7528<code>Promise</code>\u7269\u4ef6\u7372\u5f97\u4e00\u500b<code>JSON</code>\u8cc7\u6e90,\u89e3\u6790(parse)\u5b83   JavaScript<pre><code>const getFirstUserData = () =&gt; {\n  return fetch('/users.json') // get users list\n    .then(response =&gt; response.json()) // parse JSON\n    .then(users =&gt; users[0]) // pick first user\n    .then(user =&gt; fetch(`/users/${user.name}`)) // get user data\n    .then(userResponse =&gt; userResponse.json()) // parse JSON\n}\n\ngetFirstUserData()\n</code></pre></li> <li>\u9019\u662f\u5229\u7528<code>async/await</code>\u8a9e\u6cd5\u63d0\u4f9b\u7684\u76f8\u540c\u529f\u80fd   JavaScript<pre><code>const getFirstUserData = async () =&gt; {\n  const response = await fetch('/users.json') // get users list\n  const users = await response.json() // parse JSON\n  const user = users[0] // pick first user\n  const userResponse = await fetch(`/users/${user.name}`) // get user data\n  const userData = await userResponse.json() // parse JSON\n  return userData\n}\n\ngetFirstUserData()\n</code></pre></li> </ul> </li> <li>\u591a\u500b\u975e\u540c\u6b65\u51fd\u5f0f\u7684\u4e32\u9023(Multiple async functions in series)</li> <li>\u975e\u540c\u6b65\u51fd\u5f0f(async function)\u53ef\u4ee5\u5f88\u7c21\u55ae\u5730\u88ab\u4e32\u9023,\u4e26\u4e14\u8a9e\u6cd5\u4e0a\u6bd4\u8d77\u55ae\u7d14\u7684(plain)<code>Promise</code>\u7269\u4ef6\u7684\u8a9e\u6cd5\u66f4\u5bb9\u6613\u95b1\u8b80(much more readable)     JavaScript<pre><code>const promiseToDoSomething = () =&gt; {\n  return new Promise(resolve =&gt; {\n    setTimeout(() =&gt; resolve('I did something'), 10000)\n  })\n}\n\nconst watchOverSomeoneDoingSomething = async () =&gt; {\n  const something = await promiseToDoSomething()\n  return something + '\\nand I watched'\n}\n\nconst watchOverSomeoneWatchingSomeoneDoingSomething = async () =&gt; {\n  const something = await watchOverSomeoneDoingSomething()\n  return something + '\\nand I watched as well'\n}\n\nwatchOverSomeoneWatchingSomeoneDoingSomething().then(res =&gt; {\n  console.log(res)\n})\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6703\"\u4f9d\u5e8f\"\u56de\u50b3</li> <li>I did something</li> <li>and I watched</li> <li>and I watched as well</li> </ul> </li> <li>\u66f4\u5bb9\u6613\u5730\u9664\u932f(Easier debugging)</li> <li>\u8981\u9664\u932f(debugging)<code>Promise</code>\u7269\u4ef6\u662f\u56f0\u96e3\u7684,\u56e0\u70ba\u9664\u932f\u5668(debugger)\u4e0d\u6703\u8df3\u904e(step over)\u975e\u540c\u6b65\u7a0b\u5f0f\u78bc(asynchronous code)</li> <li><code>async/await</code>\u8a9e\u6cd5\u8b93\u9664\u932f(debug)\u8b8a\u5f97\u66f4\u5bb9\u6613,\u56e0\u70ba\u5c0d\u65bc\u7de8\u8b6f\u5668(compiler)\u4f86\u8aaa,\u9019\u5c31\u50cf\u662f\u540c\u6b65\u7a0b\u5f0f\u78bc(synchronous code)</li> </ul>"},{"location":"programming_language/nodejs/#the-nodejs-event-emitter","title":"The Node.js Event emitter","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Events</p> <ul> <li>\u5982\u679c\u6211\u5011\u5728\u700f\u89bd\u5668\u4f7f\u7528Javascript\u5de5\u4f5c,\u5c31\u6703\u77e5\u9053\u900f\u904e\u591a\u5c11\u4e8b\u4ef6(through events)\u4f86\u8ddf\u4f7f\u7528\u8005\u9032\u884c\u4e92\u52d5(interaction),\u50cf\u662f<code>mouse click</code>, <code>keyboard button presses</code>, <code>reacting to mouse movements</code>, ...\u7b49\u7b49</li> <li>\u5728\u5f8c\u7aef(backend),Node\u70ba\u6211\u5011\u63d0\u4f9b(offer)\u4e86\u5229\u7528<code>Events</code>\u5167\u5efa\u6838\u5fc3\u6a21\u7d44\u4f86\u5efa\u69cb\u51fa\u4e00\u500b\u985e\u4f3c\u7684\u7cfb\u7d71(similar system)\u7684\u9078\u9805(option)</li> <li>\u7279\u5225\u7684\u662f,\u9019\u500b\u6a21\u7d44\u63d0\u4f9b\u4e86\u4e00\u500bEventEmitter Class\u985e\u5225,\u7528\u4f86\u8655\u7406(handle)\u6211\u5011\u7684\u4e8b\u4ef6(events)</li> <li>\u6211\u5011\u521d\u59cb\u5316\u53ef\u4ee5\u9019\u6a23\u4f7f\u7528     JavaScript<pre><code>const EventEmitter = require('events')\nconst eventEmitter = new EventEmitter()\n</code></pre><ul> <li>\u9019\u6a23\u505a\u7684\u8a71,\u8a72<code>EventEmitter</code>\u7269\u4ef6,\u9664\u4e86\u5176\u4ed6\u7684\u6771\u897f\u4e4b\u5916,\u6211\u5011\u5148\u4ecb\u7d39<code>eventEmitter.on()</code>\u65b9\u6cd5\u8207<code>eventEmitter.emit()</code>\u65b9\u6cd5</li> <li>emitter.emit(eventName[, ...args])\u65b9\u6cd5: \u53ef\u4ee5\u88ab\u7528\u4f86\u89f8\u767c(trigger)\u4e00\u500b\u4e8b\u4ef6(event)</li> <li>emitter.on(eventName, listener)\u65b9\u6cd5: \u53ef\u4ee5\u88ab\u7528\u4f86\u65b0\u589e\u4f5c\u70ba,\u7576\u4e8b\u4ef6(event)\u88ab\u89f8\u767c(triggered)\u6642,\u8981\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback function)</li> </ul> </li> <li>\u8209\u500b\u4f8b\u5b50\u4f86\u8aaa,\u6211\u5011\u5efa\u7acb\u4e00\u500b<code>start</code>\u4e8b\u4ef6(event),\u4f5c\u70ba\u4e00\u500b\u7bc4\u4f8b\u800c\u8a00,\u6211\u5011\u5c0d\u8a72\u4e8b\u4ef6\u7684\u53cd\u61c9(react)\u5c31\u662f\u628a\u5b57\u4e32\u8a18\u9304(logging)\u5230\u63a7\u5236\u53f0(console)\u4e0a       JavaScript<pre><code>eventEmitter.on('start', () =&gt; {\n  console.log('started')\n})\n</code></pre></li> <li>\u9019\u6642,\u7576\u6211\u5011\u57f7\u884c       JavaScript<pre><code>eventEmitter.emit('start')\n</code></pre><ul> <li>\u8a72\u4e8b\u4ef6\u7684\u8655\u7406\u51fd\u5f0f(the event handler function )\u5c31\u6703\u88ab\u89f8\u767c(triggered),\u4e26\u4e14\u6211\u5011\u6703\u5f97\u5230\u63a7\u5236\u53f0\u7684\u8a18\u9304(console log)</li> <li>\u6211\u5011\u5c07\u4ee5\u4e0a\u7684\u6771\u897f\u4f5c\u70ba\u984d\u5916\u7684\u53c3\u6578(additional arguments),\u50b3\u905e(passing)\u7d66\u4e8b\u4ef6\u8655\u7406\u5668(event handler),\u4e5f\u5c31\u662f\u6307\u50b3\u905e\u7d66<code>emit()</code>\u65b9\u6cd5     JavaScript<pre><code>eventEmitter.on('start', number =&gt; {\n  console.log(`started ${number}`)\n})\n\neventEmitter.emit('start', 23)\n</code></pre></li> <li>\u591a\u500b\u53c3\u6578(multiple arguments)\u7684\u60c5\u6cc1     JavaScript<pre><code>eventEmitter.on('start', (start, end) =&gt; {\n  console.log(`started from ${start} to ${end}`)\n})\n\neventEmitter.emit('start', 1, 100)\n</code></pre></li> </ul> </li> <li><code>EventEmitter</code>\u7269\u4ef6(object)\u4e5f\u516c\u958b(exposes)\u4e86\u8a31\u591a\u5176\u5b83\u7684\u65b9\u6cd5(method),\u4f86\u8ddf\u4e8b\u4ef6(events)\u505a\u4e92\u52d5(interact),\u50cf\u662f\u4ee5\u4e0b3\u7a2e\u65b9\u6cd5</li> <li>emitter.once(eventName, listener): \u65b0\u589e(add)\u4e00\u500b\u4e00\u6b21\u6027(one-time)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(listener)</li> <li>emitter.removeListener(eventName, listener): \u5f9e\u6307\u5b9a\u7684\u4e8b\u4ef6\u4e2d\u79fb\u9664\u6307\u5b9a\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(remove an event listener from an event)<ul> <li>\u7b49\u540c\u65bcemitter.off(eventName, listener)</li> </ul> </li> <li>emitter.removeAllListeners([eventName]): \u522a\u9664\u6307\u5b9a\u7684\u4e8b\u4ef6\u4e2d\u6240\u6709\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(remove all listeners for an event)</li> </ul>"},{"location":"programming_language/nodejs/#build-an-http-server","title":"Build an HTTP Server","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44HTTP</p> <ul> <li>\u9019\u662f\u4e00\u500bHello World\u7bc4\u4f8b\u7684HTTP web server     JavaScript<pre><code>const http = require('http')\n\nconst port = process.env.PORT\n\nconst server = http.createServer((req, res) =&gt; {\n  res.statusCode = 200\n  res.setHeader('Content-Type', 'text/html')\n  res.end('&lt;h1&gt;Hello, World!&lt;/h1&gt;')\n})\n\nserver.listen(port, () =&gt; {\n  console.log(`Server running at port ${port}`)\n})\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6703\u6253\u5370\u51fa<code>Hello, World!</code>\u5b57\u4e32</li> </ul> </li> <li>\u8b93\u6211\u5011\u4f86\u7c21\u55ae\u5730\u5206\u6790\u4e00\u4e0b\u9019\u6bb5\u7bc4\u4f8b\u7a0b\u5f0f\u78bc,\u5305\u62ecNode\u7684<code>HTTP</code>\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<ul> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528<code>HTTP</code>\u6a21\u7d44(module)\u4f86\u5efa\u7acb\u4e00\u500bHTTP \u4f3a\u670d\u5668(server)</li> <li>\u9019\u500b<code>HTTP server</code>\u88ab\u8a2d\u5b9a\u7528\u4f86\u76e3\u807d\u6307\u5b9a\u7684<code>3000</code> port\u3002\u7576\u4f3a\u670d\u5668\u6e96\u5099\u597d\u5f8c,\u5c31\u6703\u547c\u53ebserver.listen()\u9019\u500b\u56de\u547c\u51fd\u5f0f(callback function)</li> <li>\u6211\u5011\u50b3\u905e\u7684\u56de\u547c\u51fd\u5f0f\u662f\u5c07\u5728\u6536\u5230\u6bcf\u500b\u8acb\u6c42(every request)\u6642,\u7acb\u5373(upon)\u8981\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback function)</li> <li>\u6bcf\u7576(whenever)\u6536\u5230(received)\u4e00\u500b\u65b0\u7684\u8acb\u6c42(new request)\u6642,\u5c31\u6703\u547c\u53ebrequest\u4e8b\u4ef6(event),\u4e26\u63d0\u4f9b2\u500b\u7269\u4ef6(objects)</li> <li>\u8acb\u6c42\u7269\u4ef6(request): \u6703\u662f\u4e00\u500bhttp.IncomingMessage\u7269\u4ef6<ul> <li>\u8a72\u7269\u4ef6\u6703\u63d0\u4f9b\u95dc\u65bc\u8acb\u6c42\u7684\u7d30\u7bc0(request details)\u3002\u900f\u904e\u9019\u500b\u7269\u4ef6,\u6211\u5011\u53ef\u4ee5\u7528\u4f86\u5b58\u53d6(access)\u8acb\u6c42\u6a19\u982d(request headers)\u8207\u8acb\u6c42\u8cc7\u6599(request data)</li> </ul> </li> <li>\u56de\u61c9\u7269\u4ef6(response): \u6703\u662f\u4e00\u500bhttp.ServerResponse\u7269\u4ef6<ul> <li>\u8a72\u7269\u4ef6\u662f\u88ab\u7528\u4f86\u7522\u751f(populate)\u51fa\u6211\u5011\u5c07\u8981\u56de\u50b3\u7d66\u5ba2\u6236\u7aef(client)\u7684\u8cc7\u6599(data)</li> </ul> </li> <li>\u5728\u9019\u6b21\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,\u6211\u5011\u6709\u8a2d\u5b9a\u4e86\u56de\u61c9\u7269\u4ef6(response)\u7684\u72c0\u614b\u78bc(statusCode)\u7684\u5c6c\u6027(property)\u503c\u70ba<code>200</code>,\u4f86\u8868\u793a\u9019\u662f\u4e00\u500b\u6210\u529f\u7684\u8acb\u6c42(successful response)     JavaScript<pre><code>res.statusCode = 200\n</code></pre></li> <li>\u5728\u9019\u6b21\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,\u6211\u5011\u4e5f\u6709\u8a2d\u5b9a\u4e86\u56de\u61c9\u7269\u4ef6(response)\u7684\u5167\u6587\u6a19\u984c\u5f62\u5f0f(<code>Content-Type header</code>)     JavaScript<pre><code>res.setHeader('Content-Type', 'text/plain')\n</code></pre></li> <li>\u5728\u9019\u6b21\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u7684\u7d50\u5c3e,\u6211\u5011\u4e5f\u95dc\u9589\u4e86\u56de\u61c9\u7269\u4ef6(response),\u4e26\u5c07\u5167\u5bb9\u4f5c\u70ba\u53c3\u6578(argument)\u50b3\u905e\u7d66<code>response.end()</code>\u65b9\u6cd5     JavaScript<pre><code>res.end('Hello World\\n')\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#making-http-requests-with-nodejs","title":"Making HTTP requests with Node.js","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44HTTPS</p> <ul> <li>\u5b8c\u6210\u4e00\u500b<code>GET</code>\u8acb\u6c42(Perform a <code>GET</code> Request)     JavaScript<pre><code>const https = require('https')\nconst options = {\n  hostname: 'whatever.com',\n  port: 443,\n  path: '/todos',\n  method: 'GET'  // \u5b8c\u6210\u4e00\u500bGET\u8acb\u6c42\n}\n\nconst req = https.request(options, res =&gt; {\n  console.log(`statusCode: ${res.statusCode}`)\n\n  res.on('data', d =&gt; {\n    process.stdout.write(d)\n  })\n})\n\nreq.on('error', error =&gt; {\n  console.error(error)\n})\n\nreq.end()\n</code></pre></li> <li>\u5b8c\u6210\u4e00\u500b<code>POST</code>\u8acb\u6c42(Perform a <code>POST</code> Request)     JavaScript<pre><code>const https = require('https')\n\nconst data = JSON.stringify({\n  todo: 'Buy the milk'\n})\n\nconst options = {\n  hostname: 'whatever.com',\n  port: 443,\n  path: '/todos',\n  method: 'POST',  // \u5b8c\u6210\u4e00\u500bPOST\u8acb\u6c42 \n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length\n  }\n}\n\nconst req = https.request(options, res =&gt; {\n  console.log(`statusCode: ${res.statusCode}`)\n\n  res.on('data', d =&gt; {\n    process.stdout.write(d)\n  })\n})\n\nreq.on('error', error =&gt; {\n  console.error(error)\n})\n\nreq.write(data)\nreq.end()\n</code></pre></li> <li>\u5b8c\u6210\u4e00\u500b<code>PUT</code>\u8207<code>DELETE</code>\u8acb\u6c42(<code>PUT</code> and <code>DELETE</code>)</li> <li><code>PUT</code>\u8207<code>DELETE</code>\u8acb\u6c42\u8ddf<code>POST</code>\u8acb\u6c42(request)\u7684\u683c\u5f0f(format)\u76f8\u540c,\u53ea\u8981\u4fee\u6539<code>options.method</code>\u9019\u500b\u5c6c\u6027\u503c\u5c31\u53ef\u4ee5\u7528\u4e86</li> </ul>"},{"location":"programming_language/nodejs/#make-an-http-post-request-using-nodejs","title":"Make an HTTP POST request using Node.js","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44HTTP Axios\u5957\u4ef6-Make http requests from node.js</p> <ul> <li>\u6839\u64da(depending on)\u6211\u5011\u60f3\u8981\u4f7f\u7528\u7684\u62bd\u8c61\u5c64\u7d1a(abstraction level),\u6709\u591a\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u5b8c\u6210\u4e00\u500b<code>HTTP</code>\u7684<code>POST</code>\u8acb\u6c42(request)</li> <li>\u6700\u7c21\u55ae\u7684\u65b9\u5f0f\u4f86\u5b8c\u6210\u4e00\u500b<code>HTTP</code>\u8acb\u6c42(request)\u5c31\u662f\u5229\u7528Node\u4f86\u642d\u914d\u4f7f\u7528Axios\u5957\u4ef6 JavaScript<pre><code>const axios = require('axios')\n\naxios\n  .post('https://whatever.com/todos', {\n    todo: 'Buy the milk'\n  })\n  .then(res =&gt; {\n    console.log(`statusCode: ${res.statusCode}`)\n    console.log(res)\n  })\n  .catch(error =&gt; {\n    console.error(error)\n  })\n</code></pre></li> <li><code>axios</code>\u5957\u4ef6\u8981\u6c42(require)\u4f7f\u7528\u7b2c\u4e09\u65b9\u51fd\u5f0f\u5eab(3<sup>rd</sup> party library)</li> <li>\u5176\u5be6\u4e00\u500b<code>POST</code>\u8acb\u6c42(request)\u50c5\u55ae\u7d14\u4f7f\u7528Node\u7684\u5167\u5efa\u6a19\u6e96\u51fd\u5f0f\u5eab(standard modules)\u662f\u53ef\u884c\u7684,\u4f46\u6703\u6bd4\u5148\u524d(preceding)\u76842\u500b\u9078\u9805(options)\u4f86\u7684\u5197\u9577(verbose)     JavaScript<pre><code>const https = require('https')\n\nconst data = JSON.stringify({\n  todo: 'Buy the milk'\n})\n\nconst options = {\n  hostname: 'whatever.com',\n  port: 443,\n  path: '/todos',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length\n  }\n}\n\nconst req = https.request(options, res =&gt; {\n  console.log(`statusCode: ${res.statusCode}`)\n\n  res.on('data', d =&gt; {\n    process.stdout.write(d)\n  })\n})\n\nreq.on('error', error =&gt; {\n  console.error(error)\n})\n\nreq.write(data)\nreq.end()\n</code></pre></li> </ul>"},{"location":"programming_language/nodejs/#get-http-request-body-data-using-nodejs","title":"Get HTTP request body data using Node.js","text":"<p>Express\u6846\u67b6</p> <ul> <li>\u9019\u662f\u4ee5<code>JSON</code>\u683c\u5f0f\u4f86\u63d0\u53d6(extract)\u8acb\u6c42\u5167\u6587(request body)\u7684\u8cc7\u6599(data)\u7684\u65b9\u5f0f</li> <li>\u5982\u679c\u6211\u5011\u6b63\u5728\u4f7f\u7528Express\u6846\u67b6,\u90a3\u5f88\u7c21\u55ae,\u53ea\u8981\u4f7f\u7528Node\u7684<code>body-parser</code>\u6a21\u7d44</li> <li>\u8209\u4f8b\u4f86\u8aaa,\u5047\u5982\u6211\u5011\u60f3\u8981\u7372\u5f97\u8acb\u6c42\u7684\u5167\u6587(request body)       JavaScript<pre><code>const axios = require('axios')\n\naxios.post('https://whatever.com/todos', {\n  todo: 'Buy the milk'\n})\n</code></pre></li> <li>\u9019\u6703\u8207\u4f3a\u670d\u5668\u7aef\u7684\u7a0b\u5f0f\u78bc(server-side code)\u76f8\u5c0d\u61c9(matching)       JavaScript<pre><code>const express = require('express')\nconst app = express()\n\napp.use(\n  express.urlencoded({\n    extended: true\n  })\n)\n\napp.use(express.json())\n\napp.post('/todos', (req, res) =&gt; {\n  console.log(req.body.todo)\n})\n</code></pre></li> <li>\u5982\u679c\u6211\u5011\u6c92\u6709\u5728\u4f7f\u7528<code>Express</code>\u6846\u67b6,\u53ea\u60f3\u8981\u4f7f\u7528\u666e\u901a\u7684Node\u4f86\u5b8c\u6210\u6b64\u64cd\u4f5c\u7684\u8a71,\u90a3\u9ebc\u5c31\u6703\u9700\u8981\u505a\u66f4\u591a\u7684\u5de5\u4f5c\u3002\u7576\u7136,\u9019\u662f\u56e0\u70ba<code>Express</code>\u6846\u67b6\u5df2\u7d93\u5e6b\u6211\u5011\u62bd\u8c61(abstracts)\u4e86\u5f88\u591a\u6b64\u985e\u7684\u6771\u897f\u4e86<ul> <li>\u8981\u7406\u89e3\u7684\u95dc\u9375\u662f,\u7576\u6211\u5011\u5229\u7528<code>http.creatServer()</code>\u65b9\u6cd5\u4f86\u521d\u59cb\u5316\u4e00\u500b<code>HTTP</code>\u4f3a\u670d\u5668(server)\u7684\u8a71,\u9019\u6642\u7576\u4f3a\u670d\u5668\u7372\u5f97(get)\u6240\u6709\u7684<code>HTTP</code>\u8acb\u6c42\u6a19\u982d(request headers)\u6642,\u800c\u4e0d\u662f\u8acb\u6c42\u6b63\u6587(request body)</li> <li>\u8acb\u6c42\u7269\u4ef6(request object)\u50b3\u905e\u7d66\u56de\u547c\u51fd\u5f0f(callback)\u7684\u95dc\u4fc2(connection)\u662f\u4e00\u7a2e\u4e32\u6d41(stream)</li> <li>\u56e0\u6b64\u6211\u5011\u5fc5\u9808\u76e3\u807d(listen)\u8981\u8655\u7406(processed)\u7684\u8acb\u6c42\u6b63\u6587\u7684\u5167\u5bb9(body content),\u4e26\u4e14\u9019\u500b\u8acb\u6c42\u6b63\u6587\u7684\u5167\u5bb9\u662f\u6210\u584a\u8655\u7406\u7684(processed in chunks)</li> <li>\u9996\u5148,\u6211\u5011\u6703\u900f\u904e\u76e3\u807d(listening)<code>data</code>\u9019\u500b\u4e8b\u4ef6\u6d41(event stream),\u7136\u5f8c\u7576<code>data</code>\u9019\u500b\u4e8b\u4ef6\u6d41\u7d50\u675f(<code>data</code> ends)\u6642,\u5c31\u6703\u547c\u53eb<code>end</code>\u9019\u500b\u4e8b\u4ef6\u6d41(event stream)\u4e00\u6b21(once)     JavaScript<pre><code>const server = http.createServer((req, res) =&gt; {\n  // we can access HTTP headers\n  req.on('data', chunk =&gt; {\n    console.log(`Data chunk available: ${chunk}`)\n  })\n  req.on('end', () =&gt; {\n    //end of data\n  })\n})\n</code></pre></li> <li>\u56e0\u6b64,\u70ba\u4e86\u8981\u5b58\u53d6\u8cc7\u6599(access data),\u5047\u8a2d\u6211\u5011\u9810\u671f(expect)\u6703\u6536\u5230(receive)\u4e00\u500b\u5b57\u4e32(string),\u6211\u5011\u5fc5\u9808\u5c07\u5176\u653e\u5165(put into)\u9663\u5217(array)\u4e2d     JavaScript<pre><code>const server = http.createServer((req, res) =&gt; {\n  let data = '';\n  req.on('data', chunk =&gt; {\n    data += chunk;\n  })\n  req.on('end', () =&gt; {\n    JSON.parse(data).todo // 'Buy the milk'\n  })\n})\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#working-with-file-descriptors-in-nodejs","title":"Working with file descriptors in Node.js","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44File system</p> <ul> <li>\u5728\u6211\u5011\u80fd\u5920\u4ee3\u7406(sits in)\u6a94\u6848\u7cfb\u7d71(file system)\u4f86\u8207\u6a94\u6848(file)\u4e92\u52d5(interact)\u4e4b\u524d,\u6211\u5011\u5fc5\u9808\u5148\u7372\u5f97\u4e00\u500b\u6a94\u6848\u63cf\u8ff0\u7b26\u865f(file descriptor)</li> <li>\u4e00\u500b\u6a94\u6848\u63cf\u8ff0\u7b26\u865f(file descriptor)\u5c31\u662f\u900f\u904eNode\u5167\u5efa\u7684<code>File system</code>\u6838\u5fc3\u6a21\u7d44\u4e2d\u7684fs.open()\u65b9\u6cd5\u4f86\u958b\u555f\u6a94\u6848(opening the file)\u6642,\u6240\u56de\u50b3(returned)\u7684\u6771\u897f     JavaScript<pre><code>const fs = require('fs')\n\nfs.open('/Users/joe/test.txt', 'r', (err, fd) =&gt; {\n  //fd is our file descriptor\n})\n</code></pre><ul> <li>\u6ce8\u610f\u5230\u5728<code>fs.open()</code>\u65b9\u6cd5\u6240\u4f7f\u7528\u7684\u7b2c2\u500b\u53c3\u6578,\u4e5f\u5c31\u662f<code>r</code>\u53c3\u6578\u3002\u9019\u500b\u65d7\u5e5f(flag)\u610f\u5473\u8457(means)\u6211\u5011\u662f\u7528\u8b80\u53d6\u6a21\u5f0f(reading)\u958b\u555f(open)\u9019\u500b\u6a94\u6848(file),\u5176\u5b83\u53ef\u80fd\u6703\u5e38\u7528\u5230\u7684\u65d7\u5e5f(flags)\u6703\u6709\u4ee5\u4e0b\u5e7e\u7a2e</li> <li><code>r+</code>: \u4ee5\u8b80\u53d6(reading)+\u5beb\u5165(writing)\u6a21\u5f0f\u4f86\u958b\u555f\u9019\u500b\u6a94\u6848</li> <li><code>w+</code>: \u4ee5\u8b80\u53d6(reading)+\u5beb\u5165(writing)\u6a21\u5f0f\u4f86\u958b\u555f\u9019\u500b\u6a94\u6848,\u4e26\u4e14\u5c07\u4e32\u6d41(stream)\u653e\u5728(positioning)\u6a94\u6848\u7684 \u6700\u524d\u9762(beginning)\u3002\u7576\u8a72\u6a94\u6848\u4e0d\u5b58\u5728\u6642,\u5c31\u6703\u5efa\u7acb\u4e00\u4efd\u9019\u500b\u6a94\u6848</li> <li><code>a</code>: \u4ee5\u5beb\u5165(writing)\u6a21\u5f0f\u4f86\u958b\u555f\u9019\u500b\u6a94\u6848,\u4e26\u4e14\u5c07\u4e32\u6d41(stream)\u653e\u5728(positioning)\u6a94\u6848\u7684 \u6700\u5f8c\u9762 (end)\u3002\u7576\u8a72\u6a94\u6848\u4e0d\u5b58\u5728\u6642,\u5c31\u6703\u5efa\u7acb\u4e00\u4efd\u9019\u500b\u6a94\u6848</li> <li><code>a+</code>: \u4ee5\u8b80\u53d6(reading)+\u5beb\u5165(writing)\u6a21\u5f0f\u4f86\u958b\u555f\u9019\u500b\u6a94\u6848,\u4e26\u4e14\u5c07\u4e32\u6d41(stream)\u653e\u5728(positioning)\u6a94\u6848\u7684 \u6700\u5f8c\u9762(end)\u3002\u7576\u8a72\u6a94\u6848\u4e0d\u5b58\u5728\u6642,\u5c31\u6703\u5efa\u7acb\u4e00\u4efd\u9019\u500b\u6a94\u6848</li> </ul> </li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u900f\u904efs.openSync()\u65b9\u6cd5\u4f86\u958b\u555f\u6a94\u6848,\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(returns)\u4e00\u500b\u6a94\u6848\u63cf\u8ff0\u7b26\u865f(file descriptor),\u800c\u4e0d\u662f(instead of)\u63d0\u4f9b(providing)\u4e00\u500b\u56de\u547c\u51fd\u5f0f(callback)     JavaScript<pre><code>const fs = require('fs')\n\ntry {\n  const fd = fs.openSync('/Users/joe/test.txt', 'r')\n} catch (err) {\n  console.error(err)\n}\n</code></pre><ul> <li>\u4e00\u65e6(once)\u7372\u5f97\u90a3\u500b\u6a94\u6848\u63cf\u8ff0\u7b26\u865f(file descriptor),\u6211\u5011\u4fbf\u80fd\u904b\u7528\u4efb\u4f55(whatever)\u6211\u5011\u9078\u64c7\u4f7f\u7528\u7684\u65b9\u5f0f(way)\u4f86\u5b8c\u6210(perform)\u6240\u6709(all)\u9700\u8981(require)\u6a94\u6848\u63cf\u8ff0\u7b26\u865f(file descriptor)\u7684\u64cd\u4f5c(operations),\u50cf\u662f\u547c\u53eb(calling)<code>fs.open()</code>\u65b9\u6cd5,\u4ee5\u53ca\u8a31\u591a\u5176\u5b83\u7528\u4f86\u8ddf\u6a94\u6848\u7cfb\u7d71(file system)\u4e92\u52d5(interact with)\u7684\u64cd\u4f5c</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#nodejs-file-stats","title":"Node.js file stats","text":"<ul> <li>\u6bcf\u500b\u6a94\u6848(file)\u90fd\u6703\u5e36\u6709(comes with)\u4e00\u7d44\u7d30\u7bc0(a set of details),\u53ef\u63d0\u4f9b\u7d66Node\u7528\u4f86\u6aa2\u67e5(inspect)\u5b83\u5011\u6240\u4f7f\u7528</li> <li>\u7279\u5225\u662f\u4f7f\u7528Node\u5167\u5efa\u7684<code>File system</code>\u6838\u5fc3\u6a21\u7d44\u4e2d\u7684fs.stat(path[, options], callback)\u65b9\u6cd5\u3002\u6211\u5011\u547c\u53eb\u9019\u500b\u65b9\u6cd5\u6642,\u53ef\u4ee5\u50b3\u905e(pass)\u4e00\u500b\u6a94\u6848\u8def\u5f91(file path)\u4f5c\u70ba\u53c3\u6578,\u4e4b\u5f8c\u4e00\u65e6Node\u7372\u5f97(get)\u6a94\u6848\u8cc7\u8a0a\u7684\u7d30\u7bc0(file details)\u5f8c,\u8a72\u65b9\u6cd5\u5c31\u6703\u547c\u53eb(call)\u6211\u5011\u6307\u5b9a\u7684\u56de\u547c\u51fd\u5f0f(callback function, \u4e5f\u5c31\u662f\u8a72\u65b9\u6cd5\u7684<code>callback</code>\u53c3\u6578),\u4e26\u4e14\u518d\u63d0\u4f9b\u7d66\u9019\u500b\u56de\u547c\u51fd\u5f0f\u4ee5\u4e0b\u76842\u500b\u53c3\u6578(parameters)<ul> <li>\u4e00\u6bb5\u932f\u8aa4\u8a0a\u606f(an error message)</li> <li>\u6a94\u6848\u72c0\u614b(the file states) JavaScript<pre><code>const fs = require('fs')\nfs.stat('/Users/joe/test.txt', (err, stats) =&gt; {\n  if (err) {\n    console.error(err)\n    return\n  }\n  //we have access to the file stats in `stats`\n})\n</code></pre></li> </ul> </li> <li>Node\u4e5f\u63d0\u4f9b(provides)\u4e86\u4e00\u500b\u540c\u6b65\u5730\u65b9\u6cd5(sync method, \u4e5f\u5c31\u662ffs.statSync(path[, options])\u65b9\u6cd5),\u7528\u4f86\u5728\u76f4\u5230(until)\u6a94\u6848\u72c0\u614b(file states)\u6e96\u5099\u597d(ready)\u4e4b\u524d,\u963b\u64cb\u7dda\u7a0b(block the thread)     JavaScript<pre><code>const fs = require('fs')\ntry {\n  const stats = fs.statSync('/Users/joe/test.txt')\n} catch (err) {\n  console.error(err)\n}\n</code></pre></li> <li>\u6a94\u6848\u8cc7\u8a0a(file information)\u5c31\u6703\u88ab\u5305\u62ec(included in)\u5728\u4e0a\u8ff0\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d\u7684<code>stats</code>\u9019\u500b\u8b8a\u6578(variable)\u4e2d\u3002\u90a3\u9ebc,\u6211\u5011\u80fd\u5f9e\u9019\u500b<code>stats</code>\u9019\u500b\u8b8a\u6578\u4e2d\u63d0\u53d6(extract)\u51fa\u54ea\u4e9b\u8cc7\u8a0a(information)\u5462?<ul> <li>\u7b54\u6848\u662f\u975e\u5e38\u591a(a lot),\u5305\u62ec(including)\u4e86</li> <li>\u5982\u679c\u662f\u4e00\u500b\u8cc7\u6599\u593e\u6216\u662f\u6a94\u6848\u6642,\u8acb\u4f7f\u7528stats.isFile()\u65b9\u6cd5 &amp; stats.isDirectory()\u65b9\u6cd5</li> <li>\u5982\u679c\u662f\u4e00\u500b\u7b26\u865f\u9023\u7d50(symbolic link)\u6642,\u8acb\u4f7f\u7528stats.isSymbolicLink\u65b9\u6cd5</li> <li>\u5982\u679c\u662f\u6a94\u6848\u5927\u5c0f(\u4ee5<code>bytes</code>\u70ba\u55ae\u4f4d)\u7684\u8a71,\u8acb\u4f7f\u7528stats.size\u5c6c\u6027</li> <li>\u5176\u5be6\u9084\u6709\u8a31\u591a\u9032\u968e\u65b9\u6cd5(advanced method),\u4f46\u662f\u5927\u90e8\u5206(the bulk of)\u6211\u5011\u5728\u65e5\u5e38(day-to-day)\u7a0b\u5f0f\u958b\u767c(programming)\u4e2d\u53ea\u6703\u4f7f\u7528\u5230\u9019\u4e9b\u800c\u5df2     JavaScript<pre><code>const fs = require('fs')\nfs.stat('/Users/joe/test.txt', (err, stats) =&gt; {\n  if (err) {\n    console.error(err)\n    return\n  }\n\n  stats.isFile() //true\n  stats.isDirectory() //false\n  stats.isSymbolicLink() //false\n  stats.size //1024000 //= 1MB\n})\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#nodejs-file-paths","title":"Node.js File Paths","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Path</p> <ul> <li>\u7cfb\u7d71(system)\u4e2d\u7684\u6bcf\u500b\u6a94\u6848(every file)\u90fd\u6709\u4e00\u500b\u8def\u5f91(path)</li> <li>\u5728<code>Linux</code>\u6216\u662f<code>macOS</code>\u4f5c\u696d\u7cfb\u7d71(Unix-like operating system)\u6642,\u6a94\u6848\u8def\u5f91\u770b\u8d77\u4f86\u6703\u50cf\u662f\u4ee5\u4e0b\u9019\u6a23</li> <li><code>/users/joe/file.txt</code></li> <li>\u7136\u800c,<code>Windows</code>\u4f5c\u696d\u7cfb\u7d71\u537b\u662f\u4e0d\u540c\u7684,\u5b83\u7684\u6a94\u6848\u8def\u5f91\u7d50\u69cb(structure)\u6703\u50cf\u662f</li> <li><code>C:\\users\\joe\\file.txt</code></li> <li>\u56e0\u6b64,\u6211\u5011\u6703\u9700\u8981\u6ce8\u610f(pay attention),\u7576\u6211\u5011\u5728\u61c9\u7528\u7a0b\u5f0f(application)\u4e2d\u4f7f\u7528\u8def\u5f91(paths)\u6642,\u9700\u8981\u5c07\u9019\u500b\u8def\u5f91\u7d50\u69cb\u7684\u5dee\u7570(difference)\u8003\u616e\u9032\u53bb(taken into account)</li> <li>\u6211\u5011\u53ef\u4ee5\u5c07Node\u5167\u5efa\u7684<code>Path</code>\u9019\u500b\u6838\u5fc3\u6a21\u7d44,\u5305\u62ec(include)\u5230\u6211\u5011\u7684\u6a94\u6848\u4e2d,\u4e26\u4e14\u958b\u59cb\u4f7f\u7528\u9019\u500b\u6a21\u7d44\u7684\u76f8\u95dc\u65b9\u6cd5(method)     JavaScript<pre><code>const path = require('path')\n</code></pre></li> <li>\u5229\u7528\u8def\u5f91\u4f86\u4f5c\u70ba\u8cc7\u8a0a(Getting information out of a path)</li> <li>\u5047\u5982(Given)\u7d66\u5b9a\u4e00\u500b\u8def\u5f91(path),\u6211\u5011\u80fd\u900f\u904e\u9019\u500b\u9019\u500b\u8def\u5f91\u4f86\u63d0\u53d6(extract)\u8cc7\u8a0a,\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u7684\u5e7e\u7a2e\u65b9\u6cd5\u4f86\u5b8c\u6210<ul> <li>path.dirname(path): \u7372\u5f97(get)\u7236\u76ee\u9304(parent folder)\u7684\u6a94\u6848(file)</li> <li>path.basename(path[, ext]): \u7372\u5f97(get)\u8a72\u6a94\u6848\u540d\u7a31(filename part)</li> <li>path.extname(path): \u7372\u5f97(get)\u8a72\u6a94\u6848\u7684\u526f\u6a94\u540d(file extension) JavaScript<pre><code>const notes = '/users/joe/notes.txt'\n\npath.dirname(notes) // /users/joe\npath.basename(notes) // notes.txt\npath.extname(notes) // .txt\n</code></pre></li> </ul> </li> <li>\u5982\u679c\u6211\u5011\u60f3\u8981\u5f97\u5230 \u4e0d\u5305\u542b \u526f\u6a94\u540d(file extension)\u7684\u6a94\u6848\u540d\u7a31(filename)\u7684\u8a71,\u53ef\u4ee5\u5229\u7528<code>path.basename()</code>\u65b9\u6cd5,\u4e26\u7d66\u5b9a\u9019\u500b\u65b9\u6cd5\u7684\u7b2c\u4e8c\u500b\u53c3\u6578<code>ext</code>\u7684\u503c,\u4ee5\u904e\u6ffe\u6389\u5176\u526f\u6a94\u540d       JavaScript<pre><code>path.basename(notes, path.extname(notes)) //notes\n</code></pre></li> <li>\u5229\u7528Node\u5167\u5efa\u7684<code>path</code>\u6838\u5fc3\u6a21\u7d44\u4f86\u5b8c\u6210\u5de5\u4f5c(Working with paths)</li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528path.join([...paths])\u65b9\u6cd5\u4f86\u5c07\u5169\u500b\u6216\u662f\u591a\u500b\u8def\u5f91\u7247\u6bb5(parts of a path)\u7d44\u5408\u8d77\u4f86     JavaScript<pre><code>const name = 'joe'\npath.join('/', 'users', name, 'notes.txt') //'/users/joe/notes.txt'\n</code></pre></li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528path.resolve([...paths])\u65b9\u6cd5\u4f86\u628a\u76f8\u5c0d\u8def\u5f91(relative path)\u8a08\u7b97(calculation)\u6210\u70ba\u7d55\u5c0d\u8def\u5f91(absolute path)     JavaScript<pre><code>path.resolve('joe.txt') //'/Users/joe/joe.txt' if run from my home folder\n</code></pre><ul> <li>\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b(In this case),Node\u6703\u7c21\u55ae\u5730(simply)\u5c07<code>/joe.txt</code>\u9019\u500b\u6a94\u6848\u9644\u52a0(append)\u5230\u7576\u524d\u7684\u5de5\u4f5c\u76ee\u9304\u4e2d(current working directory)\u3002\u9019\u6642,\u5982\u679c\u6211\u5011\u6307\u5b9a\u4e86\u7b2c2\u500b\u76ee\u9304\u53c3\u6578(second parameter folder),<code>path.resolve()</code>\u65b9\u6cd5\u6703\u5c07\u7b2c1\u500b\u76ee\u9304(first)\u53c3\u6578\u4f5c\u70ba\u57fa\u5e95(as a base)   JavaScript<pre><code>path.resolve('tmp', 'joe.txt') //'/Users/joe/tmp/joe.txt' if run from my home folder\n</code></pre></li> <li>\u5982\u679c\u7b2c1\u500b\u53c3\u6578\u662f\u4ee5\u659c\u7dda(slash, \u4e5f\u5c31\u662f<code>/</code>)\u958b\u982d(starts with)\u7684\u8a71,\u90a3\u5c31\u4ee3\u8868\u8a72\u8def\u5f91\u662f\u4e00\u500b\"\u7d55\u5c0d\u8def\u5f91\"</li> </ul> </li> <li>path.normalize(path)\u65b9\u6cd5\u662f\u53e6\u4e00\u7a2e\u6709\u7528(useful)\u7684\u51fd\u5f0f(function)\u3002\u7576<code>path.normalize(path)</code>\u65b9\u6cd5\u4e2d\u7684<code>path</code>\u53c3\u6578\u503c\u5305\u542b\u4e86<code>.</code>or<code>..</code>or<code>//</code>...\u7b49\u7b49\u6642,\u8a72\u65b9\u6cd5\u5c31\u6703\u5617\u8a66(try)\u53bb\u8a08\u7b97(calculate)\u51fa\u771f\u5be6\u7684\u8def\u5f91\u4f4d\u7f6e(actual path)     JavaScript<pre><code>path.normalize('/users/joe/..//test.txt') //'/users/test.txt'\n</code></pre></li> <li>\u63d0\u9192! <code>path.resolve([...paths])</code>\u65b9\u6cd5\u8207<code>path.normalize(path)</code>\u65b9\u6cd5\u7686\u4e0d\u6703\u6aa2\u67e5\u5176\u5404\u81ea\u7684<code>path</code>\u53c3\u6578\u503c\u662f\u5426\u5b58\u5728\u3002\u5b83\u5011\u50c5\u6703(just)\u6839\u64da(based on)\u5b83\u5011\u5404\u81ea\u7372\u5f97\u7684\u8def\u5f91\u53c3\u6578\u8cc7\u8a0a(information)\u4f86\u505a\u8a08\u7b97(calculate)\u51fa\u4e00\u500b\u8def\u5f91(path)\u7684\u503c\u800c\u5df2</li> </ul>"},{"location":"programming_language/nodejs/#reading-files-with-nodejs","title":"Reading files with Node.js","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44File system</p> <ul> <li>\u5728Node\u4e2d,\u8981\u8b80\u53d6\u4e00\u500b\u6a94\u6848\u80fd\u4f7f\u7528\u7684\u6700\u7c21\u55ae\u7684\u65b9\u6cd5\u662ffs.readFile(path[, options], callback) ,\u4e26\u50b3\u905e\u7d66\u9019\u500b\u65b9\u6cd5</li> <li>\u4e00\u500b\u6307\u5b9a\u8981\u8b80\u53d6\u6a94\u6848\u7684\u8def\u5f91\u4f4d\u7f6e(file path)</li> <li>\u6587\u5b57\u7de8\u78bc\u898f\u5247(encoding)</li> <li>\u4e00\u500b\u5c07\u6703\u8207\u6a94\u6848\u8cc7\u6599(file data)\u4e00\u8d77\u88ab\u547c\u53eb(called with)\u7684\u56de\u547c\u51fd\u5f0f(callback function)\u8207\u932f\u8aa4(<code>error</code>)     JavaScript<pre><code>const fs = require('fs')\n\nfs.readFile('/Users/joe/test.txt', 'utf8' , (err, data) =&gt; {\n  if (err) {\n    console.error(err)\n    return\n  }\n  console.log(data)\n})\n</code></pre></li> <li>\u6216\u8005(Alternatively),\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528fs.readFileSync(path[, options])\u9019\u500b\u540c\u6b65\u5316(synchronous)\u5730\u8b80\u53d6\u6a94\u6848\u7684\u7248\u672c(version)     JavaScript<pre><code>const fs = require('fs')\n\ntry {\n  const data = fs.readFileSync('/Users/joe/test.txt', 'utf8')\n  console.log(data)\n} catch (err) {\n  console.error(err)\n}\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u5169\u7a2e\u8b80\u53d6\u6a94\u6848\u7684\u65b9\u6cd5(<code>fs.readFile()</code>\u8207<code>fs.readFileSync()</code>)\u90fd\u6703\u5728\u56de\u50b3\u8cc7\u6599(returning the data)\u4e4b\u524d,\u5c07\u6574\u500b\u6a94\u6848\u5167\u5bb9(full content of the file)\u8b80\u53d6(read)\u5230\u8a18\u61b6\u9ad4\u4e4b\u4e2d(in memory)</li> <li>\u9019\u4e5f\u5c31\u610f\u5473(means)\u8457,\u5927\u6a94\u6848\u5c07\u6703\u5c0d\u6211\u5011\u7684\u8a18\u61b6\u9ad4\u6d88\u8017(memory consumption)\u8207\u7a0b\u5f0f\u7684\u57f7\u884c\u901f\u5ea6(speed of execution of the program)\u5e36\u4f86\u91cd\u5927\u7684\u5f71\u97ff(major impact)<ul> <li>\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b(In this case),\u66f4\u597d\u7684\u9078\u64c7(better option)\u662f\u900f\u904e\u4e32\u6d41(<code>streams</code>)\u4f86\u8b80\u53d6\u6a94\u6848\u5167\u5bb9(read the file content)</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#writing-files-with-nodejs","title":"Writing files with Node.js","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44File system</p> <ul> <li>\u5728Node\u4e2d,\u8981\u5beb\u5165\u6a94\u6848\u7684\u6700\u7c21\u55ae\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528fs.writeFile(file, data[, options], callback)\u9019\u500bAPI     JavaScript<pre><code>const fs = require('fs')\n\nconst content = 'Some content!'\n\nfs.writeFile('/Users/joe/test.txt', content, err =&gt; {\n  if (err) {\n    console.error(err)\n    return\n  }\n  //file written successfully\n})\n</code></pre></li> <li>\u6216\u8005(Alternatively),\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528fs.writeFileSync(file, data[, options])\u9019\u500b\u540c\u6b65\u5316(synchronous)\u5730\u5beb\u5165\u6a94\u6848\u7684\u7248\u672c(version)     JavaScript<pre><code>const fs = require('fs')\n\nconst content = 'Some content!'\n\ntry {\n  const data = fs.writeFileSync('/Users/joe/test.txt', content)\n  //file written successfully\n} catch (err) {\n  console.error(err)\n}\n</code></pre></li> <li>\u9810\u8a2d\u60c5\u6cc1(By default),\u7576\u7d66\u5b9a\u7684\u6307\u5b9a\u8def\u5f91\u4e0b\u7684\u6a94\u6848\u5df2\u7d93\u5b58\u5728(already exist)\u6642,\u9019\u500bAPI\u5c31\u6703\u53d6\u4ee3\u6389\u9019\u500b\u6a94\u6848\u7684\u5167\u5bb9(replace the contents of the file)<ul> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904e\u6307\u5b9a(specifying)\u4e00\u500b\u65d7\u5e5f(flag)\u4f86\u4fee\u6539(modify)\u9019\u500b\u9810\u8a2d\u6a21\u5f0f(the default)   JavaScript<pre><code>fs.writeFile('/Users/joe/test.txt', content, { flag: 'a+' }, err =&gt; {})\n</code></pre></li> <li>\u4ee5\u4e0b\u662f\u6211\u5011\u53ef\u80fd\u6703\u7528\u5230\u7684\u65d7\u5e5f(flags)</li> <li><code>r+</code>: \u4ee5\u8b80\u53d6(reading)+\u5beb\u5165(writing)\u6a21\u5f0f\u4f86\u958b\u555f\u9019\u500b\u6a94\u6848</li> <li><code>w+</code>: \u4ee5\u8b80\u53d6(reading)+\u5beb\u5165(writing)\u6a21\u5f0f\u4f86\u958b\u555f\u9019\u500b\u6a94\u6848,\u4e26\u4e14\u5c07\u4e32\u6d41(stream)\u653e\u5728(positioning)\u6a94\u6848\u7684 \u6700\u524d\u9762(beginning)\u3002\u7576\u8a72\u6a94\u6848\u4e0d\u5b58\u5728\u6642,\u5c31\u6703\u5efa\u7acb\u4e00\u4efd\u9019\u500b\u6a94\u6848</li> <li><code>a</code>: \u4ee5\u5beb\u5165(writing)\u6a21\u5f0f\u4f86\u958b\u555f\u9019\u500b\u6a94\u6848,\u4e26\u4e14\u5c07\u4e32\u6d41(stream)\u653e\u5728(positioning)\u6a94\u6848\u7684 \u6700\u5f8c\u9762 (end)\u3002\u7576\u8a72\u6a94\u6848\u4e0d\u5b58\u5728\u6642,\u5c31\u6703\u5efa\u7acb\u4e00\u4efd\u9019\u500b\u6a94\u6848</li> <li><code>a+</code>: \u4ee5\u8b80\u53d6(reading)+\u5beb\u5165(writing)\u6a21\u5f0f\u4f86\u958b\u555f\u9019\u500b\u6a94\u6848,\u4e26\u4e14\u5c07\u4e32\u6d41(stream)\u653e\u5728(positioning)\u6a94\u6848\u7684 \u6700\u5f8c\u9762(end)\u3002\u7576\u8a72\u6a94\u6848\u4e0d\u5b58\u5728\u6642,\u5c31\u6703\u5efa\u7acb\u4e00\u4efd\u9019\u500b\u6a94\u6848</li> <li>\u53ef\u53c3\u8003File system flags</li> </ul> </li> <li>\u9644\u52a0\u5230\u6a94\u6848\u4e2d(Append to a file)</li> <li>\u6709\u4e00\u500b\u4fbf\u5229(handy)\u7684\u65b9\u6cd5(method)\u80fd\u5c07\u5167\u5bb9(content)\u9644\u52a0(append)\u5230\u6a94\u6848(file)\u7684\u6700\u5f8c\u9762(end),\u5c31\u662f\u5229\u7528fs.appendFile(path, data[, options], callback)\u4ee5\u53ca\u5b83\u5c0d\u61c9\u7684fs.appendFileSync(path, data[, options])\u9019\u5169\u7a2e\u65b9\u6cd5,     JavaScript<pre><code>const content = 'Some content!'\n\nfs.appendFile('file.log', content, err =&gt; {\n  if (err) {\n    console.error(err)\n    return\n  }\n  //done!\n})\n</code></pre></li> <li>\u4f7f\u7528\u4e32\u6d41(Using streams)</li> <li>\u6240\u6709\u7684\u9019\u4e9b\u65b9\u6cd5\u5011(methods)\u7686\u6703\u5148\u5c07\u6240\u6709\u7684\u5167\u5bb9(full content)\u5beb\u5165(wrtie)\u5230\u6a94\u6848(file)\u4e2d,\u7136\u5f8c\u518d\u5c07\u63a7\u5236\u6b0a(control back)\u4ea4\u9084(returning)\u7d66\u7a0b\u5f0f(program)<ul> <li>\u5728\u975e\u540c\u6b65\u5316\u7248\u672c(async version, \u4e5f\u5c31\u662f\u6307<code>fs.writeFile()</code>\u8207<code>fs.appendFile()</code>\u9019\u5169\u7a2e\u65b9\u6cd5)\u7684\u65b9\u6cd5\u4e2d,\u9019\u610f\u5473(means)\u8457\u57f7\u884c(executing)\u56de\u547c\u51fd\u5f0f(callback)</li> <li>\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b(In this case),\u4e00\u500b\u66f4\u597d\u7684\u9078\u64c7(better option)\u662f\u900f\u904e \u4e32\u6d41 (streams)\u4f86\u5beb\u5165(write)\u5230\u6a94\u6848\u5167\u5bb9(file content)\u4e2d</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#working-with-folders-in-nodejs","title":"Working with folders in Node.js","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44File system</p> <ul> <li>Node\u5167\u5efa\u6838\u5fc3(core)\u7684<code>File system</code>\u6a21\u7d44(module)\u6709\u63d0\u4f9b(provides)\u4e86\u8a31\u591a\u4fbf\u5229(handy)\u7684\u65b9\u6cd5(methods),\u8b93\u6211\u5011\u53ef\u4ee5\u8655\u7406\u6a94\u6848\u76ee\u9304(folders)</li> <li>\u6aa2\u67e5\u6a94\u6848\u76ee\u9304\u662f\u5426\u5b58\u5728(Check if a folder exists)</li> <li>\u53ef\u5229\u7528fs.access(path[, mode], callback)\u65b9\u6cd5\u4f86\u6aa2\u67e5\u6a94\u6848\u76ee\u9304\u662f\u5426\u5b58\u5728</li> <li>\u5efa\u7acb\u65b0\u7684\u6a94\u6848\u76ee\u9304(Create a new folder)</li> <li>\u53ef\u5229\u7528fs.mkdir(path[, options], callback)\u8207fs.mkdirSync(path[, options])2\u7a2e\u65b9\u6cd5\u4f86\u5efa\u7acb\u65b0\u7684\u6a94\u6848\u76ee\u9304     JavaScript<pre><code>const fs = require('fs')\n\nconst folderName = '/Users/joe/test'\n\ntry {\n  if (!fs.existsSync(folderName)) {\n    fs.mkdirSync(folderName)\n  }\n} catch (err) {\n  console.error(err)\n}\n</code></pre></li> <li>\u8b80\u53d6\u6a94\u6848\u76ee\u9304\u7684\u5167\u5bb9(Read the content of a directory)</li> <li>\u53ef\u5229\u7528fs.readdir(path[, options], callback)\u8207fs.readdirSync(path[, options])2\u7a2e\u65b9\u6cd5\u4f86\u8b80\u53d6\u6a94\u6848\u76ee\u9304\u7684\u5167\u5bb9</li> <li>\u4ee5\u4e0b\u9019\u6bb5\u7a0b\u5f0f\u78bc\u6703\u8b80\u53d6\u6a94\u6848\u76ee\u9304\u7684\u5167\u5bb9(\u5305\u542b\u5176\u4e2d\u7684\u6240\u6709\u6a94\u6848(files)\u8207\u5b50\u76ee\u9304(subfolders))       JavaScript<pre><code>const fs = require('fs')\nconst path = require('path')\n\nconst folderPath = '/Users/joe'\n\nfs.readdirSync(folderPath)\n</code></pre></li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u7372\u5f97\u5b8c\u6574(full)\u7684\u7d55\u5c0d\u8def\u5f91(path)       JavaScript<pre><code>fs.readdirSync(folderPath).map(fileName =&gt; {\n  return path.join(folderPath, fileName)\n})\n</code></pre></li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u5c07\u7d50\u679c(results)\u505a\u904e\u6ffe(filter),\u50c5\u56de\u50b3(return)\u6a94\u6848(files)\u800c\u4e0d(exclude)\u56de\u50b3\u6a94\u6848\u76ee\u9304(folders)       JavaScript<pre><code>const isFile = fileName =&gt; {\n  return fs.lstatSync(fileName).isFile()\n}\n\nfs.readdirSync(folderPath).map(fileName =&gt; {\n  return path.join(folderPath, fileName)\n})\n.filter(isFile)\n</code></pre></li> <li>\u5c07\u6a94\u6848\u76ee\u9304\u91cd\u65b0\u547d\u540d(Rename a folder)</li> <li>\u53ef\u5229\u7528fs.rename(oldPath, newPath, callback)\u8207fs.renameSync(oldPath, newPath)2\u7a2e\u65b9\u6cd5\u4f86\u5c07\u6a94\u6848\u76ee\u9304\u91cd\u65b0\u547d\u540d<ul> <li>\u90192\u500b\u65b9\u6cd5\u7684\u7b2c1\u500b\u53c3\u6578(first parameter)\u662f\u7576\u524d\u7684\u8def\u5f91(current path),\u800c\u7b2c2\u500b\u53c3\u6578(second parameter)\u662f\u65b0\u7684\u8def\u5f91   JavaScript<pre><code>const fs = require('fs')\n\nfs.rename('/Users/joe', '/Users/roger', err =&gt; {\n  if (err) {\n    console.error(err)\n    return\n  }\n  //done\n})\n</code></pre></li> </ul> </li> <li><code>fs.renameSync()</code>\u65b9\u6cd5\u662f\u540c\u6b65\u5316(synchronous)\u65b9\u6cd5\u7684\u7248\u672c(version)       JavaScript<pre><code>const fs = require('fs')\n\ntry {\n  fs.renameSync('/Users/joe', '/Users/roger')\n} catch (err) {\n  console.error(err)\n}\n</code></pre></li> <li>\u522a\u9664\u6a94\u6848\u76ee\u9304(Remove a folder)</li> <li>\u53ef\u5229\u7528fs.rmdir(path[, options], callback)\u8207fs.rmdirSync(path[, options])2\u7a2e\u65b9\u6cd5\u4f86\u522a\u9664\u6a94\u6848\u76ee\u9304</li> <li>\u56e0\u70ba\u522a\u9664\u4e00\u500b\u542b\u6709\u6a94\u6848\u7684\u76ee\u9304(a folder that has content)\u53ef\u80fd\u6bd4\u6211\u5011\u9700\u8981\u7684\u8907\u96dc(complicated)</li> <li>\u9019\u6642\u5019,\u6700\u4f73\u7684\u505a\u6cd5\u662f\u5b89\u88ddnpm\u4e0a\u7684fs-extra\u5957\u4ef6,\u5b83\u662f\u4e00\u500b\u975e\u5e38\u71b1\u9580\u4e14\u7dad\u8b77\u826f\u597d\u7684\u5957\u4ef6\u3002<code>fs-extra</code>\u5957\u4ef6\u662f\u4e00\u500b\u53ef\u7528\u4f86\u81e8\u6642\u66ff\u63db(drop-in replacement)Node\u5167\u5efa\u7684<code>File system</code>\u6a21\u7d44\u7684\u5957\u4ef6,\u5b83\u80fd\u57fa\u65bc<code>File system</code>\u6a21\u7d44\u4e4b\u4e0a(on top of it)\u4f86\u63d0\u4f9b\u66f4\u591a\u7684\u529f\u80fd(features)<ul> <li>\u4ee5\u9019\u6b21\u7684\u7bc4\u4f8b\u4f86\u8aaa,\u6211\u5011\u60f3\u8981\u4f7f\u7528\u7684\u529f\u80fd\u5c31\u662f<code>remove()</code>\u65b9\u6cd5\u3002\u9019\u6642\u5019,\u6211\u5011\u9700\u8981\u5148\u5b89\u88dd<code>fs-extra</code>\u5957\u4ef6</li> <li>\u5b89\u88dd\u6307\u4ee4: $ <code>npm install fs-extra</code></li> <li>\u4f7f\u7528\u5b83\u7684<code>remove()</code>\u65b9\u6cd5       JavaScript<pre><code>const fs = require('fs-extra')\n\nconst folder = '/Users/joe'\n\nfs.remove(folder, err =&gt; {\n  console.error(err)\n})\n</code></pre></li> <li>\u5b83\u4e5f\u80fd\u8207<code>Promise</code>\u7269\u4ef6\u4e00\u8d77\u4f7f\u7528       JavaScript<pre><code>fs.remove(folder)\n  .then(() =&gt; {\n    //done\n  })\n  .catch(err =&gt; {\n    console.error(err)\n  })\n</code></pre></li> <li>\u6216\u662f\u642d\u914d<code>async/await</code>\u8a9e\u6cd5\u4f86\u4f7f\u7528       JavaScript<pre><code>async function removeFolder(folder) {\n  try {\n    await fs.remove(folder)\n    //done\n  } catch (err) {\n    console.error(err)\n  }\n}\n\nconst folder = '/Users/joe'\nremoveFolder(folder)\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-nodejs-fs-module","title":"The Node.js fs module","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44File system</p> <ul> <li><code>fs</code>\u6a21\u7d44\u63d0\u4f9b(provides)\u4e86\u8a31\u591a\u975e\u5e38\u6709\u7528(useful)\u7684\u529f\u80fd(functionality)\u4f86\u5b58\u53d6(access) &amp; \u8207\u6a94\u6848\u7cfb\u7d71(file system)\u4e92\u52d5(interact)</li> <li>\u56e0\u70ba<code>fs</code>\u6a21\u7d44\u662fNode\u672c\u8eab\u5167\u5efa\u7684\u6838\u5fc3\u6a21\u7d44,\u56e0\u6b64\u6211\u5011\u4e0d\u7528\u4e8b\u5148\u5b89\u88dd\u5b83,\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u7684\u65b9\u6cd5\u4f86\u7c21\u55ae\u5730\u5f15\u7528\u5b83     JavaScript<pre><code>const fs = require('fs')\n</code></pre></li> <li>\u4e00\u65e6(Once)\u9019\u6a23\u505a,\u6211\u5011\u5c31\u53ef\u4ee5\u958b\u59cb\u5b58\u53d6(access)<code>fs</code>\u6a21\u7d44\u7684\u5176\u5b83\u65b9\u6cd5(methods)<ul> <li>fs.access(path[, mode], callback): \u6703\u6aa2\u67e5(check)\u8a72\u8def\u5f91\u5167\u7684\u6a94\u6848\u662f\u5426\u5b58\u5728(exists),\u4e26\u4e14Node\u6709\u6b0a\u9650(permissions)\u4f86\u5b58\u53d6(access)\u5b83</li> <li>fs.appendFile(path, data[, options], callback): \u9644\u52a0(append)\u8cc7\u6599(data)\u5230\u6a94\u6848(file)\u4e2d\u3002\u82e5\u8a72\u8def\u5f91\u5167\u7684\u6a94\u6848\u4e0d\u5b58\u5728(exist)\u7684\u8a71,\u5c31\u6703\u5efa\u7acb(created)\u4e00\u500b</li> <li>fs.chmod(path, mode, callback): \u66f4\u6539(change)\u6307\u5b9a(specified)\u7684\u6a94\u6848(file)\u7684\u6b0a\u9650(permissions)\u8a2d\u5b9a(\u900f\u904e\u6307\u5b9a\u4e00\u500b\u6a94\u6848\u540d\u7a31\u4f86\u5b8c\u6210\u7684)</li> <li>fs.lchmod(path, mode, callback): \u50c5<code>macOS</code>\u4f5c\u696d\u7cfb\u7d71\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5</li> <li>fs.fchmod(fd, mode, callback)</li> <li>fs.chown(path, uid, gid, callback): \u66f4\u6539(change)\u6307\u5b9a(specified)\u7684\u6a94\u6848(file)\u7684\u64c1\u6709\u8005(owner) &amp; \u7fa4\u7d44(group)\u8a2d\u5b9a(\u900f\u904e\u6307\u5b9a\u4e00\u500b\u6a94\u6848\u540d\u7a31\u4f86\u5b8c\u6210\u7684)</li> <li>fs.lchown(path, uid, gid, callback)</li> <li>fs.fchown(fd, uid, gid, callback)</li> <li>fs.close(fd, callback): \u95dc\u9589\u4e00\u500b\u6a94\u6848\u63cf\u8ff0\u7b26\u865f(file descriptor)</li> <li>fs.copyFile(src, dest[, mode], callback): \u8907\u88fd(copies)\u4e00\u500b\u6a94\u6848(file)</li> <li>fs.createReadStream(path[, options]): \u5efa\u7acb(create)\u4e00\u500b\u53ef\u8b80\u53d6(readable)\u7684\u6a94\u6848\u4e32\u6d41(file stream)</li> <li>fs.createWriteStream(path[, options]): \u5efa\u7acb(create)\u4e00\u500b\u53ef\u5beb\u5165(writable)\u7684\u6a94\u6848\u4e32\u6d41(file stream)</li> <li>fs.link(existingPath, newPath, callback): \u5efa\u7acb(create)\u4e00\u500b\u786c\u9023\u7d50(hard link)\u7d66\u4e00\u500b\u6307\u5b9a\u7684\u6a94\u6848(file)</li> <li>fs.mkdir(): \u5efa\u7acb(create)\u4e00\u500b\u65b0\u7684\u6a94\u6848\u76ee\u9304(folder)</li> <li>fs.mkdtemp(prefix[, options], callback): \u5efa\u7acb(create)\u4e00\u500b\u81e8\u6642(temporary)\u7684\u6a94\u6848\u76ee\u9304(directory)</li> <li>fs.open(path[, flags[, mode]], callback): \u8a2d\u5b9a(set)\u6a94\u6848\u6a21\u5f0f(file mode)</li> <li>fs.readdir(path[, options], callback): \u8b80\u53d6(read)\u8a72\u6a94\u6848\u76ee\u9304(directory)\u7684\u5167\u5bb9(contents)</li> <li>fs.readFile(): \u8b80\u53d6(read)\u8a72\u6a94\u6848(file)\u7684\u5167\u5bb9(content)</li> <li>fs.read(fd, buffer, offset, length, position, callback)</li> <li>fs.readlink(path[, options], callback): \u8b80\u53d6(read)\u7b26\u865f\u9023\u7d50(symbolic link)\u7684\u503c(value)</li> <li>fs.realpath(path[, options], callback): \u5c07\u76f8\u5c0d(relative)\u7684\u6a94\u6848\u8def\u5f91(file path)\u89e3\u6790(resolve)\u70ba\u5b8c\u6574\u8def\u5f91(full path)=&gt; \u4e5f\u5c31\u662f\u5c07<code>./</code>, <code>../</code> \u7b49\u7b49\u4e4b\u985e\u7684\u8655\u7406\u6389</li> <li>fs.rename(oldPath, newPath, callback): \u5c07\u6a94\u6848(file)\u6216\u662f\u6a94\u6848\u76ee\u9304(folder)\u91cd\u65b0\u547d\u540d(rename)</li> <li>fs.rmdir(path[, options], callback): \u79fb\u9664(remove)\u6307\u5b9a\u7684\u6a94\u6848\u76ee\u9304(folder)</li> <li>fs.stat(path[, options], callback): \u56de\u50b3(returns)\u6a94\u6848(file)\u7684\u72c0\u614b(status)</li> <li>fs.fstat(fd[, options], callback)</li> <li>fs.lstat(path[, options], callback)</li> <li>fs.symlink(target, path[, type], callback): \u5efa\u7acb(create)\u4e00\u500b\u65b0\u7684\u7b26\u865f\u9023\u7d50(symbolic link)\u7d66\u6307\u5b9a\u7684\u6a94\u6848(file)</li> <li>fs.truncate(path[, len], callback): \u5c07\u6307\u5b9a\u7684\u6a94\u6848\u540d\u7a31\u7e2e\u77ed\u70ba\u6307\u5b9a\u7684\u9577\u5ea6( specified length)=&gt; (\u900f\u904e\u6307\u5b9a\u4e00\u500b\u6a94\u6848\u540d\u7a31\u4f86\u5b8c\u6210\u7684)</li> <li>fs.ftruncate(fd[, len], callback)</li> <li>fs.unlink(path, callback): \u79fb\u9664\u4e00\u500b\u6a94\u6848\u7684\u7b26\u865f\u9023\u7d50(symbolic link)</li> <li>fs.unwatchFile(filename[, listener]): \u505c\u6b62(stop)\u67e5\u770b(watching)\u4e00\u500b\u6a94\u6848(file)\u7684\u4fee\u6539(changes)</li> <li>fs.utimes(path, atime, mtime, callback): \u66f4\u6539(change)\u4e00\u500b\u6a94\u6848\u7684\u6642\u9593\u6233\u8a18=&gt; (\u900f\u904e\u6307\u5b9a\u4e00\u500b\u6a94\u6848\u540d\u7a31\u4f86\u5b8c\u6210\u7684)(timestamp)</li> <li>fs.futimes(fd, atime, mtime, callback)</li> <li>fs.watchFile(filename[, options], listener): \u958b\u59cb(start)\u67e5\u770b(watching)\u4e00\u500b\u6a94\u6848(file)\u7684\u4fee\u6539(changes)</li> <li>fs.watch(filename[, options][, listener])</li> <li>fs.writeFile(file, data[, options], callback): \u5c07\u8cc7\u6599(data)\u5beb\u5165(write)\u6a94\u6848(file)\u4e2d</li> <li>fs.write(fd, buffer[, offset[, length[, position]]], callback)</li> </ul> </li> <li>\u95dc\u65bc<code>fs</code>\u6a21\u7d44\u6709\u4e00\u4ef6\u5947\u602a\u7684\u4e8b\u60c5\u662f\u6240\u6709\u65b9\u6cd5 \u9810\u8a2d \u90fd\u662f \u975e\u540c\u6b65\u7684 (asynchronous),\u7136\u800c\u9019\u4e9b\u65b9\u6cd5\u4e5f\u90fd\u80fd\u540c\u6b65\u5316\u5730(synchronously)\u4f7f\u7528(=&gt; \u53ea\u8981\u5728\u5404\u65b9\u6cd5\u5f8c\u9762\u52a0\u4e0a<code>Sync</code>\u8a9e\u6cd5\u5c31\u53ef\u4ee5\u4e86)</li> <li>\u4ee5\u4e0b\u7bc4\u4f8b\u8aaa\u660e</li> <li><code>fs.rename()</code><ul> <li><code>fs.renameSync()</code></li> </ul> </li> <li><code>fs.write()</code><ul> <li><code>fs.writeSync()</code></li> </ul> </li> <li>\u9019\u9ebc\u505a\u6703\u9020\u6210(makes)\u6211\u5011\u7684\u61c9\u7528\u7a0b\u5f0f(application)\u7684\u5de5\u4f5c\u6d41(flow)\u6709\u6975\u5927(huge)\u7684\u5dee\u7570(difference)     &gt; Node <code>v10.0.0</code>\u958b\u59cb,<code>fs</code>\u6a21\u7d44\u958b\u59cb\u5f15\u5165\u4e86fs Promises API<ul> <li>\u8209\u4f8b\u4f86\u8aaa,\u6211\u5011\u4f86\u6aa2\u67e5(check)\u4e00\u4e0b<code>fs.rename()</code>\u65b9\u6cd5,\u5229\u7528\u56de\u547c\u51fd\u5f0f(callback)\u7684\u65b9\u6cd5\u4f86\u4f7f\u7528\u975e\u540c\u6b65\u5316(asynchronous)\u7684API     JavaScript<pre><code>const fs = require('fs')\n\nfs.rename('before.json', 'after.json', err =&gt; {\n  if (err) {\n    return console.error(err)\n  }\n\n  //done\n})\n</code></pre></li> <li>\u540c\u6b65\u5316(synchronous)\u7684API\u53ef\u4ee5\u9019\u6a23\u4f86\u4f7f\u7528,\u4e26\u642d\u914d<code>try/catch</code>\u5340\u584a(block)\u4f86\u8655\u7406(handle)\u932f\u8aa4(error)     JavaScript<pre><code>const fs = require('fs')\n\ntry {\n  fs.renameSync('before.json', 'after.json')\n  //done\n} catch (err) {\n  console.error(err)\n}\n</code></pre></li> <li>\u4ee5\u4e0a\u9019\u5169\u7a2e\u7bc4\u4f8b\u7684\u4e3b\u8981(key)\u5dee\u5225(difference)\u662f, \u7b2c2\u500b\u7bc4\u4f8b \u8173\u672c(script)\u7684 \u57f7\u884c(execution)\u5c07\u6703\u88ab\u963b\u585e(block) ,\u76f4\u5230\u6a94\u6848(file)\u64cd\u4f5c(operation)\u6210\u529f(succeeded)</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-nodejs-path-module","title":"The Node.js path module","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Path</p> <ul> <li>Node\u7684Path\u5167\u5efa\u6838\u5fc3\u6a21\u7d44,\u63d0\u4f9b(provides)\u4e86\u8a31\u591a\u975e\u5e38\u6709\u7528(useful)\u7684\u529f\u80fd(functionality),\u4f86\u5b58\u53d6(access) &amp; \u8207\u6a94\u6848\u7cfb\u7d71(file system)\u4e92\u52d5(interact)</li> <li><code>path</code>\u6a21\u7d44\"\u4e0d\u9700\u8981\"(no need to)\u4e8b\u5148\u5b89\u88dd(install it),\u624d\u80fd\u4f7f\u7528\u3002\u56e0\u70ba\u5b83\u672c\u8eab\u5df2\u7d93\u662fNode\u7684\u6838\u5fc3\u6a21\u7d44(core)\u7684\u4e00\u90e8\u5206(part of)\u4e86,\u5b83\u80fd\u5920\u7c21\u55ae\u5730(simply)\u900f\u904e\u5f15\u7528(=&gt; <code>require</code>\u8a9e\u6cd5)\u4f86\u4f7f\u7528<code>path</code>\u6a21\u7d44     JavaScript<pre><code>const path = require('path')\n</code></pre></li> <li><code>path</code>\u6a21\u7d44\u6709\u63d0\u4f9bpath.sep\u5c6c\u6027,\u4f86\u4f5c\u70ba\u8def\u5f91\u7684\u5206\u9694\u7b26\u865f(path segment separator)<ul> <li>\u4e5f\u5c31\u662f\u8aaa,\u5728Windows\u4f5c\u696d\u7cfb\u7d71\u6703\u662f<code>\\</code>; \u800c\u5728Linux/macOS\u4f5c\u696d\u7cfb\u7d71\u6703\u662f<code>/</code></li> </ul> </li> <li><code>path</code>\u6a21\u7d44\u6709\u63d0\u4f9bpath.delimiter\u5c6c\u6027,\u4f86\u4f5c\u70ba\u8def\u5f91\u7684\u5b9a\u754c\u7b26(path delimiter)<ul> <li>\u4e5f\u5c31\u662f\u8aaa,\u5728Windows\u4f5c\u696d\u7cfb\u7d71\u6703\u662f<code>;</code>; \u800c\u5728Linux/macOS\u4f5c\u696d\u7cfb\u7d71\u6703\u662f<code>:</code></li> </ul> </li> <li>\u4ee5\u4e0b\u662f<code>path</code>\u6a21\u7d44\u5e38\u6703\u7528\u5230\u7684\u65b9\u6cd5(methods)</li> <li>path.basename(path[, ext])<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u6574\u500b\u8def\u5f91(path)\u7684\u6700\u5f8c\u4e00\u500b(last)\u90e8\u5206(portion); \u800c\u8a72\u65b9\u6cd5\u7684\u7b2c2\u500b\u53c3\u6578(parameter)\u53ef\u4ee5\u7528\u4f86\u904e\u6ffe\u6389(filter out)\u526f\u6a94\u540d(file extension)   JavaScript<pre><code>require('path').basename('/test/something') //something\nrequire('path').basename('/test/something.txt') //something.txt\nrequire('path').basename('/test/something.txt', '.txt') //something\n</code></pre></li> </ul> </li> <li>path.dirname(path)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u5176\u6a94\u6848\u8def\u5f91(path)\u53c3\u6578(parameter)\u7684\u6a94\u6848\u76ee\u9304(directory)\u7684\u90e8\u5206(part)   JavaScript<pre><code>require('path').dirname('/test/something') // /test\nrequire('path').dirname('/test/something/file.txt') // /test/something\n</code></pre></li> </ul> </li> <li>path.extname(path)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u5176\u6a94\u6848\u8def\u5f91(path)\u53c3\u6578(parameter)\u7684\u526f\u6a94\u540d(file extension)\u7684\u90e8\u5206(part)   JavaScript<pre><code>require('path').extname('/test/something') // ''\nrequire('path').extname('/test/something/file.txt') // '.txt'\n</code></pre></li> </ul> </li> <li>path.isAbsolute(path)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u5176\u6a94\u6848\u8def\u5f91(path)\u53c3\u6578(parameter)\u662f\u5426\u70ba\u4e00\u7a2e\"\u7d55\u5c0d\u8def\u5f91\"\u7684\u5f62\u5f0f   JavaScript<pre><code>require('path').isAbsolute('/test/something') // true\nrequire('path').isAbsolute('./test/something') // false\n</code></pre></li> </ul> </li> <li>path.join([...paths])<ul> <li>\u8a72\u65b9\u6cd5\u6703\u7d50\u5408\u8def\u5f91(path)\u76842\u500bor\u591a\u500b\u90e8\u5206(part)   JavaScript<pre><code>const name = 'joe'\nrequire('path').join('/', 'users', name, 'notes.txt') //'/users/joe/notes.txt'\n</code></pre></li> </ul> </li> <li>path.normalize(path)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u5617\u8a66(tries to)\u53bb\u8a08\u7b97(calculate)\u5176\u6a94\u6848\u8def\u5f91(path)\u53c3\u6578(parameter)\u7684\u771f\u5be6\u8def\u5f91(actual path) (=&gt; \u7576\u9019\u500b\u6a94\u6848\u8def\u5f91\u53c3\u6578(<code>path</code>)\u6709\u5305\u542b(contains)\u4e86<code>.</code> or <code>..</code> or <code>//</code>... \u7b49\u7b49\u4e4b\u985e\u7684\u76f8\u5c0d\u8aaa\u660e\u7b26(relative specifiers))</li> </ul> </li> <li>path.parse(path)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u4ee5\u4e00\u500b\u7269\u4ef6(object)\u7684\u5f62\u5f0f,\u5c07\u5176\u6a94\u6848\u8def\u5f91(path)\u53c3\u6578(parameter)\u89e3\u6790(parses)\u70ba\u591a\u500b\u91cd\u8981\u7247\u6bb5(segments),\u4f86\u7d44\u6210(compose)\u51fa\u9019\u500b\u8def\u5f91\u7269\u4ef6</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>require('path').parse('/users/test.txt')\n</code></pre></li> <li>\u4e0a\u8ff0\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc,\u5c07\u6703\u56de\u50b3   JavaScript<pre><code>  {\n    root: '/',\n    dir: '/users',\n    base: 'test.txt',\n    ext: '.txt',\n    name: 'test'\n  }\n</code></pre></li> <li><code>root</code>: \u6839\u76ee\u9304(root)</li> <li><code>dir</code>: \u5f9e\u6839\u76ee\u9304(root)\u958b\u59cb(starting from)\u7684\u6a94\u6848\u76ee\u9304\u7684\u8def\u5f91(folder path)</li> <li><code>base</code>: \u6a94\u6848\u540d\u7a31(file name)+\u526f\u6a94\u540d(file extension)</li> <li><code>name</code>: \u6a94\u6848\u540d\u7a31(file name)</li> <li><code>ext</code>: \u6a94\u6848\u7684\u526f\u6a94\u540d(file extension)</li> </ul> </li> <li>path.relative(from, to)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u63a5\u53d7(accepts)2\u500b\u6a94\u6848\u8def\u5f91(paths)\u4f5c\u70ba\u53c3\u6578(arguments),\u4e26\u4ee5(based on)\u7576\u524d(current)\u5de5\u4f5c\u76ee\u9304(working directory)\u7684\u4f4d\u7f6e\u7684\u89d2\u5ea6,\u56de\u50b3(returns)\u4e00\u500b\u5f9e\u7b2c1\u500b\u53c3\u6578(=&gt; <code>from</code>)\u5230\u7b2c2\u500b\u53c3\u6578(=&gt; <code>to</code>)\u7684\u76f8\u5c0d\u8def\u5f91(relative path)   JavaScript<pre><code>require('path').relative('/Users/joe', '/Users/joe/test.txt') //'test.txt'\nrequire('path').relative('/Users/joe', '/Users/joe/something/test.txt') //'something/test.txt'\n</code></pre></li> </ul> </li> <li>path.resolve([...paths])<ul> <li>\u6211\u5011\u5229\u7528\u6b64\u65b9\u6cd5,\u4f86\u5c07\u76f8\u5c0d\u8def\u5f91(relative path)\u8a08\u7b97(calculation)\u51fa\u7d55\u5c0d\u8def\u5f91(absolute path)     JavaScript<pre><code>path.resolve('joe.txt') //'/Users/joe/joe.txt' if run from my home folder\n</code></pre></li> <li>\u900f\u904e\u6307\u5b9a\u7b2c2\u500b\u53c3\u6578(parameter),<code>path.resolve()</code>\u65b9\u6cd5\u6703\u4f7f\u7528\u7b2c1\u500b\u53c3\u6578\u70ba\u57fa\u790e\u4f86\u89e3\u6790(resolve)\u7b2c2\u500b\u53c3\u6578     JavaScript<pre><code>path.resolve('tmp', 'joe.txt') //'/Users/joe/tmp/joe.txt' if run from my home folder\n</code></pre></li> <li>\u5982\u679c\u7b2c\u4e00\u500b\u53c3\u6578(parameter)\u662f\u4ee5\u659c\u7dda(slash)\u958b\u982d(starts with)\u7684\u8a71,\u5c31\u8868\u793a(means)\u9019\u662f\u4e00\u500b\u7d55\u5c0d\u8def\u5f91(absolute path)     JavaScript<pre><code>path.resolve('/etc', 'joe.txt') //'/etc/joe.txt'\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-nodejs-os-module","title":"The Node.js os module","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44OS</p> <ul> <li>\u9019\u500b\u6a21\u7d44\u6703\u63d0\u4f9b(provides)\u8a31\u591a\u529f\u80fd(functions)\u8b93\u6211\u5011\u80fd\u5920\u8ddf\u5e95\u5c64\u4f5c\u696d\u7cfb\u7d71(underlying operating system) &amp; \u8a72\u7a0b\u5f0f\u904b\u884c\u6642\u6240\u5728\u7684\u96fb\u8166(the computer the program runs on)\u505a\u4e92\u52d5(interact)\u4e26\u6aa2\u7d22\u5176\u8cc7\u8a0a(retrieve information)</li> <li><code>js     const os = require('os')</code></li> <li>\u5728<code>os</code>\u6a21\u7d44\u4e4b\u4e2d,\u6709\u4e00\u4e9b\u6709\u7528(useful)\u7684\u5c6c\u6027(properties)\u80fd\u544a\u8a34\u6211\u5011\u4e00\u4e9b\u8207\u8655\u7406\u6a94\u6848(handling files)\u6709\u95dc\u7684(related to)\u91cd\u8981\u7684\u4e8b\u60c5(key things),\u50cf\u662f\u4ee5\u4e0b\u5c6c\u6027\u5011<ul> <li>os.EOL</li> <li>\u8a72\u5c6c\u6027\u6703\u7d66\u51fa(gives)\u5b9a\u754c\u7b26(delimiter)\u5e8f\u5217(sequence)\u3002\u5728Linux/macOS\u4f5c\u696d\u7cfb\u7d71\u4e2d\u5c31\u662f<code>\\n</code>,\u800c\u5728Windows\u4f5c\u696d\u7cfb\u7d71\u4e2d\u6703\u662f<code>\\r\\n</code></li> <li>os.constants.signal</li> <li>\u8a72\u5c6c\u6027\u6703\u544a\u8a34\u6211\u5011\u6240\u6709\u8ddf\u8655\u7406(handling)\u9032\u7a0b(process)\u4fe1\u865f(signals)\u6709\u95dc(releated to)\u7684\u5e38\u6578(constants),\u50cf\u662f<code>SIGHUP</code>, <code>SIGKILL</code>, ...\u7b49\u7b49\u4e4b\u985e\u7684</li> <li>os.constants.errorno</li> <li>\u8a72\u5c6c\u6027\u6703\u8a2d\u5b9a(sets)\u932f\u8aa4\u5831\u544a(error reporting)\u7684\u5e38\u6578(constants),\u50cf\u662f<code>EADDRINUSE</code>, <code>EOVERFLOW</code>, ...\u7b49\u7b49\u4e4b\u985e\u7684</li> </ul> </li> <li>\u63a5\u4e0b\u4f86,\u6211\u5011\u4f86\u770b\u770b<code>os</code>\u6a21\u7d44\u4e2d\u4e3b\u8981\u6703\u7528\u5230\u7684\u65b9\u6cd5(methods)</li> <li>os.arch()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u5b57\u4e32(string)\u4f86\u8868\u793a(identifies)\u6b64\u5e95\u5c64\u4f5c\u696d\u7cfb\u7d71( underlying)\u7684\u67b6\u69cb(architecture),\u50cf\u662f<code>arm</code>, <code>x64</code>, <code>arm64</code></li> </ul> </li> <li>os.cpus()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u9663\u5217(array)\u4f86\u8868\u793a\u6211\u5011\u7684\u4f5c\u696d\u7cfb\u7d71(system)\u4e0a\u6709\u591a\u5c11\u53ef\u7528(available)\u7684\u4e2d\u592e\u8655\u7406\u5668\u5011(CPUs)\u7684\u8cc7\u6e90\u7684\u8cc7\u8a0a(information)</li> <li><code>js   [     {       model: 'Intel(R) Core(TM)2 Duo CPU     P8600  @ 2.40GHz',       speed: 2400,       times: {         user: 281685380,         nice: 0,         sys: 187986530,         idle: 685833750,         irq: 0       }     },     {       model: 'Intel(R) Core(TM)2 Duo CPU     P8600  @ 2.40GHz',       speed: 2400,       times: {         user: 282348700,         nice: 0,         sys: 161800480,         idle: 703509470,         irq: 0       }     }   ]</code></li> </ul> </li> <li>os.endianness()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u5b57\u4e32(string)\u4f86\u8868\u793a(identifying)\u6b64\u4f5c\u696d\u7cfb\u7d71\u7684\u4e2d\u592e\u8655\u7406\u5668(CPU)\u8cc7\u6e90\u7684\u5b57\u7bc0\u5e8f(endianness),\u50c5\u6703\u56de\u50b3<code>BE</code>\u6216\u662f<code>LE</code></li> <li>\u53ef\u53c3\u8003\u7dad\u57fa\u767e\u79d1\u7684Big Endian or Little Endian</li> </ul> </li> <li>os.freemem<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u6574\u6578(integer, =&gt; \u4ee5<code>bytes</code>\u70ba\u55ae\u4f4d)\u4f86\u4ee3\u8868(represent)\u6b64\u4f5c\u696d\u7cfb\u7d71\u7684\u8a18\u61b6\u9ad4(memory)\u8cc7\u6e90</li> </ul> </li> <li>os.homedir()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u5b57\u4e32(string)\u4f86\u8868\u793a\u7576\u524d(current)\u4f7f\u7528\u8005(user)\u7684\u5bb6\u76ee\u9304(home directory)</li> <li><code>bash     '/Users/joe'</code></li> </ul> </li> <li>os.hostname()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u5b57\u4e32(string)\u4f86\u8868\u793a\u8a72\u4f5c\u696d\u7cfb\u7d71(operating system)\u7684\u4e3b\u6a5f\u540d\u7a31(host name)</li> </ul> </li> <li>os.loadavg()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u9663\u5217(array)\u4f86\u8868\u793a\u8a72\u4f5c\u696d\u7cfb\u7d71(operating system)\u65bc\u7b2c<code>1</code>, <code>5</code>, <code>15</code>\u5206\u9418(\u9019\u4e09\u500b\u6642\u6bb5\u7684\u6642\u5019),\u8a08\u7b97(calculation)\u51fa\u8f09\u5165(load)\u6240\u82b1\u8cbb\u7684\u5e73\u5747\u6642\u9593(average)   JavaScript<pre><code>[3.68798828125, 4.00244140625, 11.1181640625]\n</code></pre></li> <li>\u6ce8\u610f! <code>load average</code>\u9019\u500b\u503c\u53ea\u5c0dLinux/macOS\u4f5c\u696d\u7cfb\u7d71\u624d\u6709\u7528</li> </ul> </li> <li>os.networkInterfaces()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(returns)\u4e00\u500b\u7269\u4ef6(object),\u5305\u542b\u6b64\u4f5c\u696d\u7cfb\u7d71(system)\u4e2d\u53ef\u7528(available)\u7684\u7db2\u8def\u4ecb\u9762(network interfaces)\u7684\u7d30\u7bc0\u8cc7\u8a0a(details)   JavaScript<pre><code>{ lo0:\n  [ { address: '127.0.0.1',\n      netmask: '255.0.0.0',\n      family: 'IPv4',\n      mac: 'fe:82:00:00:00:00',\n      internal: true },\n    { address: '::1',\n      netmask: 'ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff',\n      family: 'IPv6',\n      mac: 'fe:82:00:00:00:00',\n      scopeid: 0,\n      internal: true },\n    { address: 'fe80::1',\n      netmask: 'ffff:ffff:ffff:ffff::',\n      family: 'IPv6',\n      mac: 'fe:82:00:00:00:00',\n      scopeid: 1,\n      internal: true } ],\n  en1:\n  [ { address: 'fe82::9b:8282:d7e6:496e',\n      netmask: 'ffff:ffff:ffff:ffff::',\n      family: 'IPv6',\n      mac: '06:00:00:02:0e:00',\n      scopeid: 5,\n      internal: false },\n    { address: '192.168.1.38',\n      netmask: '255.255.255.0',\n      family: 'IPv4',\n      mac: '06:00:00:02:0e:00',\n      internal: false } ],\n  utun0:\n  [ { address: 'fe80::2513:72bc:f405:61d0',\n      netmask: 'ffff:ffff:ffff:ffff::',\n      family: 'IPv6',\n      mac: 'fe:80:00:20:00:00',\n      scopeid: 8,\n      internal: false } ] \n}\n</code></pre></li> </ul> </li> <li>os.platform()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u5b57\u4e32(string)\u4f86\u8868\u793a(identifying)\u6b64\u4f5c\u696d\u7cfb\u7d71(operating system)\u7684\u88ab\u7de8\u8b6f(compiled for)\u7684\u5e73\u53f0(platform)\u3002\u4ee5\u4e0b\u662f\u53ef\u80fd\u7684\u56de\u50b3\u503c</li> <li><code>darwin</code></li> <li><code>freebsd</code></li> <li><code>linux</code></li> <li><code>openbsd</code></li> <li><code>win32</code></li> <li>...\u7b49\u7b49\u4e4b\u985e\u7684</li> </ul> </li> <li>os.release()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u5b57\u4e32(string)\u4f86\u8868\u793a(identifying)\u6b64\u4f5c\u696d\u7cfb\u7d71(operating system)\u8207\u5176\u7248\u672c\u865f(release number)</li> </ul> </li> <li>os.tmpdir()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u5b57\u4e32(string)\u4f86\u8868\u793a(identifying)\u6b64\u4f5c\u696d\u7cfb\u7d71\u7684\u81e8\u6642\u6a94\u6848\u6703\u5b58\u653e\u5728\u54ea\u500b\u6a94\u6848\u76ee\u9304(temp folder)</li> </ul> </li> <li>os.totalmem()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u6574\u6578(string)\u4f86\u4ee3\u8868(represent)\u6b64\u4f5c\u696d\u7cfb\u7d71(operating system)\u4e2d\u53ef\u7528(available)\u7684\u7e3d\u8a18\u61b6\u9ad4\u91cf(total memory, =&gt; \u4ee5<code>bytes</code>\u70ba\u55ae\u4f4d\u4f86\u8868\u793a)</li> </ul> </li> <li>os.type()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u5b57\u4e32(string)\u4f86\u8868\u793a(identifying)\u76ee\u524d\u6240\u5728\u7684\u4f5c\u696d\u7cfb\u7d71\u540d\u7a31(operating system name)\u662f\u4ec0\u9ebc\u3002\u4ee5\u4e0b\u662f\u6700\u5e38\u898b\u76843\u7a2e\u4f5c\u696d\u7cfb\u7d71\u5206\u5225\u5c0d\u61c9\u7684\u503c</li> <li><code>Linux</code>\u4f5c\u696d\u7cfb\u7d71: Linux</li> <li><code>macOS</code>\u4f5c\u696d\u7cfb\u7d71: Darwin</li> <li><code>Windows</code>\u4f5c\u696d\u7cfb\u7d71: Windows_NT</li> </ul> </li> <li>os.uptime()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u6574\u6578(integer)\u4f86\u8868\u793a\u81ea\u5f9e(since)\u4e0a\u6b21\u96fb\u8166\u91cd\u958b\u6a5f(last rebooted)\u5230\u73fe\u5728,\u5df2\u7d93\u904b\u884c(running)\u4e86\u591a\u4e45(=&gt; \u4ee5\"\u79d2\"\u70ba\u55ae\u4f4d)</li> </ul> </li> <li>os.userInfo([options])<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(returns)\u4e00\u500b\u7269\u4ef6(object)\u5305\u542b\u4e86\u7576\u524d\u7684\u4f7f\u7528\u8005\u540d\u7a31(username), \u4f7f\u7528\u8005ID(uid), \u7fa4\u7d44ID(gid), shell, \u5bb6\u76ee\u9304(homedir), ...\u7b49\u7b49\u4e4b\u985e\u7684</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-nodejs-events-module","title":"The Node.js events module","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Events</p> <ul> <li><code>event</code>\u6a21\u7d44(module)\u6703\u63d0\u4f9b(provides)\u6211\u5011EventEmitter\u985e\u5225(class),\u9019\u662f\u5728Node\u4e2d\u8655\u7406\u4e8b\u4ef6\u5011(events)\u7684\u95dc\u9375(key) JavaScript<pre><code>const EventEmitter = require('events')\nconst door = new EventEmitter()\n</code></pre></li> <li>\u4e8b\u4ef6\u76e3\u807d\u5668(Event listener)\u6703\u5403(eats)\u5b83\u81ea\u5df1(its own)\u7684\u72d7\u98df(dog food),\u4e26\u4f7f\u7528(uses)\u4ee5\u4e0b\u7684\u4e8b\u4ef6(events)<ul> <li><code>newListener</code>: \u7576\u4e8b\u4ef6\u76e3\u807d\u5668(event listener)\u88ab\u65b0\u589e(added)\u6642</li> <li><code>removeListener</code>: \u7576\u4e8b\u4ef6\u76e3\u807d\u5668(event listener)\u88ab\u79fb\u9664(removed)\u6642</li> </ul> </li> <li>\u4ee5\u4e0b\u662f<code>event</code>\u6a21\u7d44(module)\u4e2d\u5e38\u7528\u7684\u65b9\u6cd5(methods)</li> <li>emitter.addListener(eventName, listener)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u65b0\u589e(adds)\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668\u51fd\u5f0f(<code>listener</code> function)\u5230\u4e8b\u4ef6\u76e3\u807d\u5668\u9663\u5217(<code>listeners</code> array)\u7684\u6700\u5f8c\u9762(end)</li> <li>\u7b49\u540c\u65bcemitter.on(eventName, listener)</li> </ul> </li> <li>emitter.emit(eventName[, ...args])<ul> <li>\u767c\u51fa(Emits)\u4e00\u500b\u4e8b\u4ef6(event)\u3002\u8a72\u65b9\u6cd5\u6703 \u540c\u6b65\u5730 (synchronously)\u4f9d\u7167\u88ab\u8a3b\u518a(registered)\u7684\u9806\u5e8f(in the order)\u4f86 \u547c\u53eb (calls) \u6bcf\u4e00\u500b (every) \u4e8b\u4ef6\u76e3\u807d\u5668 (event listener)</li> <li><code>js     door.emit(\"slam\") // emitting the event \"slam\"</code></li> </ul> </li> <li>emitter.eventNames()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u9663\u5217(array)\u4f86\u4ee3\u8868(represent)\u6709\u8a3b\u518a(registered)\u5728\u76ee\u524d(current)\u7684<code>EventEmitter</code>\u7269\u4ef6(object)\u4e0a\u7684\u4e8b\u4ef6\u5011(events)   JavaScript<pre><code>door.eventNames()\n</code></pre></li> </ul> </li> <li>emitter.getMaxListeners()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(returns)\u4e00\u500b\u6574\u6578(integer)\u4f86\u4ee3\u8868\u7576\u524d\u7684<code>EventEmitter</code>\u7269\u4ef6(object)\"\u6700\u591a\"(maximum)\u80fd\u88ab\u65b0\u589e(add)\u5e7e\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)\u5728\u5176\u4e0a\u9762</li> <li>\u9810\u8a2d\u503c(default): <code>10</code></li> <li>\u4e26\u53ef\u4ee5\u900f\u904eemitter.setMaxListeners(n)\u65b9\u6cd5\u4f86\u8a2d\u5b9a\u6307\u5b9a\u7684<code>EventEmitter</code>\u7269\u4ef6(object)\"\u6700\u591a\"(maximum)\u80fd\u88ab\u65b0\u589e(add)\u5e7e\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)\u5230\u5176\u4e0a\u9762</li> </ul> </li> <li>emitter.listenerCount(eventName)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(returns)\u4e00\u500b\u6574\u6578(integer)\u4f86\u4ee3\u8868\u7576\u524d\u7684<code>EventEmitter</code>\u7269\u4ef6(object)\"\u4e0a\u6709\u5e7e\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)   JavaScript<pre><code>door.listenerCount('open')\n</code></pre></li> </ul> </li> <li>emitter.listeners(eventName)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(returns)\u4e00\u500b\u9663\u5217(array)\u4f86\u4ee3\u8868\u7576\u524d\u7684<code>EventEmitter</code>\u7269\u4ef6(object)\"\u4e0a\u6709\u54ea\u4e9b\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)   JavaScript<pre><code>door.listeners('open')\n</code></pre></li> </ul> </li> <li>emitter.removeListener(eventName, listener)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u5f9e\u4e8b\u4ef6\u76e3\u807d\u5668\u9663\u5217(<code>listener</code> array)\u4e0a\u79fb\u9664(removes)\u6307\u5b9a(specified)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(<code>listener</code>)</li> <li>\u5f9eNode <code>v10.0.0</code>\u7248\u672c\u958b\u59cb,\u7b49\u540c\u65bcemitter.off(eventName, listener)</li> </ul> </li> <li>emitter.on(eventName, listener)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u65b0\u589e(adds)\u4e00\u500b\u56de\u547c\u51fd\u5f0f(callback function)\u7d66\u7576\u524d\u88ab\u767c\u51fa(emitted)\u7684\u4e8b\u4ef6(event)   JavaScript<pre><code>door.on('open', () =&gt; {\n  console.log('Door was opened')\n})\n</code></pre></li> </ul> </li> <li>emitter.once(eventName, listener)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u65b0\u589e(adds)\u4e00\u500b\u56de\u547c\u51fd\u5f0f(callback function)\u5728\u88ab\u8a3b\u518a(registered)\u4ee5\u5f8c(after),\u800c\u7b2c1\u6b21(first)\u88ab\u767c\u51fa(emitted)\u7684\u7684\u4e8b\u4ef6(event)\u3002\u9019\u500b\u65b9\u6cd5\u53ea\u6703\u88ab\u547c\u53eb(called)\u4e00\u6b21(once),\u4e0d\u6703(never)\u518d\u88ab\u547c\u53eb\u4e00\u6b21(again)   JavaScript<pre><code>const EventEmitter = require('events')\nconst ee = new EventEmitter()\n\nee.once('my-event', () =&gt; {\n  //call callback function once\n})\n</code></pre></li> </ul> </li> <li>emitter.prependListener(eventName, listener)<ul> <li>\u7576\u6211\u5011\u4f7f\u7528<code>emitter.on()</code>\u6216\u662f<code>emitter.addListener()</code>\u90192\u7a2e\u65b9\u6cd5\u4f86\u65b0\u589e(add)\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u6642,\u5b83\u5011\u6703\u628a\u4e8b\u4ef6\u76e3\u807d\u5668\u65b0\u589e\u5230\u6574\u500b\u76e3\u807d\u5668(listeners)\u968a\u5217(queue)\u7684\u6700\u5f8c\u9762(last),\u4e26\u4e14\u6700\u5f8c(last)\u4e00\u500b\u547c\u53eb(called)\u3002\u6b64\u6642,\u5982\u679c\u6211\u5011\u60f3\u8981\u65b0\u589e\u4e8b\u4ef6\u76e3\u807d\u5668\u5230\u6574\u500b\u76e3\u807d\u5668\u968a\u5217\u7684\u6700\u524d\u9762(before)\u6642,\u5c31\u53ef\u4ee5\u900f\u904e<code>emitter.prependListener()</code>\u65b9\u6cd5\u4f86\u9054\u6210,\u4e26\u4e14\u7b2c1\u500b\u547c\u53eb(called)\u5176\u65b0\u589e\u7684\u4e8b\u4ef6\u76e3\u807d\u5668</li> </ul> </li> <li>emitter.prependOnceListener(eventName, listener)<ul> <li>\u7576\u6211\u5011\u4f7f\u7528<code>emitter.once()</code>\u65b9\u6cd5\u4f86\u65b0\u589e\u4e8b\u4ef6\u76e3\u807d\u5668\u6642,\u5b83\u6703\u628a\u4e8b\u4ef6\u76e3\u807d\u5668\u65b0\u589e\u5230\u6574\u500b\u76e3\u807d\u5668(listeners)\u968a\u5217(queue)\u7684\u6700\u5f8c\u9762(last),\u4e26\u4e14\u6700\u5f8c(last)\u4e00\u500b\u547c\u53eb(called)\u3002\u6b64\u6642,\u5982\u679c\u6211\u5011\u60f3\u8981\u65b0\u589e\u4e8b\u4ef6\u76e3\u807d\u5668\u5230\u6574\u500b\u76e3\u807d\u5668\u968a\u5217\u7684\u6700\u524d\u9762(before)\u6642,\u5c31\u53ef\u4ee5\u900f\u904e<code>emitter.prependOnceListener()</code>\u65b9\u6cd5\u4f86\u9054\u6210,\u4e26\u4e14\u7b2c1\u500b\u547c\u53eb(called)\u5176\u65b0\u589e\u7684\u4e8b\u4ef6\u76e3\u807d\u5668</li> </ul> </li> <li>emitter.removeAllListeners([eventName])<ul> <li>\u8a72\u65b9\u6cd5\u6703\u5f9e<code>EventEmitter</code>\u7269\u4ef6(object)\u4e2d\u79fb\u9664(removes) \u6307\u5b9a\u4e8b\u4ef6(specific event)\u4e2d \u6240\u6709(all)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)</li> <li><code>js     door.removeAllListeners('open')</code></li> </ul> </li> <li>emitter.removeListener(eventName, listener)<ul> <li>\u8a72\u65b9\u6cd5\u6703 \u79fb\u9664(remove)\u4e00\u500b\u6307\u5b9a(specific)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(listener) \u3002\u6211\u5011\u53ef\u4ee5\u5c07\u8a72\u65b9\u6cd5\u7684\u56de\u547c\u51fd\u5f0f(callback function)\u53c3\u6578\u5132\u5b58(saving)\u70ba\u4e00\u500b\u8b8a\u6578(variable),\u4ee5\u8b93\u4e4b\u5f8c(later)\u7576\u6211\u5011\u9700\u8981\u53c3\u8003(reference)\u6642,\u53ef\u4ee5\u900f\u904e\u6b64\u8b8a\u6578\u4f86\u547c\u53eb<code>emitter.removeListener()</code>\u65b9\u6cd5   JavaScript<pre><code>const doSomething = () =&gt; {}\ndoor.on('open', doSomething)\ndoor.removeListener('open', doSomething)\n</code></pre></li> </ul> </li> <li>emitter.setMaxListeners(n)<ul> <li>\u8a72\u65b9\u6cd5\u53ef\u4ee5\u8a2d\u5b9a(set) \u6700\u591a(maximum) \u80fd\u65b0\u589e\u5e7e\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)\u5230<code>EventEmitter</code>\u7269\u4ef6(object)\u4e0a\u9762\u3002\u9810\u8a2d\u503c(defaults)\u70ba<code>10</code>\u500b\u4e8b\u4ef6\u76e3\u807d\u5668,\u4f46\u80fd\u8a2d\u5b9a\u8981\u589e\u52a0(increased) or \u6e1b\u5c11(lowered)   JavaScript<pre><code>door.setMaxListeners(50)\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#the-nodejs-http-module","title":"The Node.js http module","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44HTTP</p> <ul> <li><code>HTTP</code>\u6838\u5fc3\u6a21\u7d44(core module)\u662fNode\u7db2\u8def(networking)\u7684\u95dc\u9375\u6a21\u7d44(key module)</li> <li><code>HTTP</code>\u6a21\u7d44\u53ef\u4ee5\u900f\u904e\u5f15\u7528(require)\u4f86\u4f7f\u7528   JavaScript<pre><code>const http = require('http')\n</code></pre></li> <li>\u8a72\u6a21\u7d44\u6703\u63d0\u4f9b\u4e00\u4e9b\u5c6c\u6027(properties), \u65b9\u6cd5(methods), \u548c\u4e00\u4e9b\u985e\u5225(classes)</li> <li>\u5c6c\u6027(Properties)</li> <li>http.METHODS<ul> <li>\u8a72\u5c6c\u6027\u6703\u5217\u51fa(lists)\u6240\u6709\u80fd\u652f\u63f4(supported)\u7684HTTP\u65b9\u6cd5(methods) JavaScript<pre><code>&gt; require('http').METHODS\n[ 'ACL',\n  'BIND',\n  'CHECKOUT',\n  'CONNECT',\n  'COPY',\n  'DELETE',\n  'GET',\n  'HEAD',\n  'LINK',\n  'LOCK',\n  'M-SEARCH',\n  'MERGE',\n  'MKACTIVITY',\n  'MKCALENDAR',\n  'MKCOL',\n  'MOVE',\n  'NOTIFY',\n  'OPTIONS',\n  'PATCH',\n  'POST',\n  'PROPFIND',\n  'PROPPATCH',\n  'PURGE',\n  'PUT',\n  'REBIND',\n  'REPORT',\n  'SEARCH',\n  'SUBSCRIBE',\n  'TRACE',\n  'UNBIND',\n  'UNLINK',\n  'UNLOCK',\n  'UNSUBSCRIBE' \n]\n</code></pre></li> </ul> </li> <li>http.STATUS_CODES<ul> <li>\u8a72\u5c6c\u6027\u6703\u5217\u51fa(lists)\u6240\u6709\u7684HTTP\u72c0\u614b\u78bc(status code)\u4ee5\u53ca\u5b83\u5011\u5206\u5225\u7684\u63cf\u8ff0(description) JavaScript<pre><code>&gt; require('http').STATUS_CODES\n{ '100': 'Continue',\n  '101': 'Switching Protocols',\n  '102': 'Processing',\n  '200': 'OK',\n  '201': 'Created',\n  '202': 'Accepted',\n  '203': 'Non-Authoritative Information',\n  '204': 'No Content',\n  '205': 'Reset Content',\n  '206': 'Partial Content',\n  '207': 'Multi-Status',\n  '208': 'Already Reported',\n  '226': 'IM Used',\n  '300': 'Multiple Choices',\n  '301': 'Moved Permanently',\n  '302': 'Found',\n  '303': 'See Other',\n  '304': 'Not Modified',\n  '305': 'Use Proxy',\n  '307': 'Temporary Redirect',\n  '308': 'Permanent Redirect',\n  '400': 'Bad Request',\n  '401': 'Unauthorized',\n  '402': 'Payment Required',\n  '403': 'Forbidden',\n  '404': 'Not Found',\n  '405': 'Method Not Allowed',\n  '406': 'Not Acceptable',\n  '407': 'Proxy Authentication Required',\n  '408': 'Request Timeout',\n  '409': 'Conflict',\n  '410': 'Gone',\n  '411': 'Length Required',\n  '412': 'Precondition Failed',\n  '413': 'Payload Too Large',\n  '414': 'URI Too Long',\n  '415': 'Unsupported Media Type',\n  '416': 'Range Not Satisfiable',\n  '417': 'Expectation Failed',\n  '418': 'I\\'m a teapot',\n  '421': 'Misdirected Request',\n  '422': 'Unprocessable Entity',\n  '423': 'Locked',\n  '424': 'Failed Dependency',\n  '425': 'Unordered Collection',\n  '426': 'Upgrade Required',\n  '428': 'Precondition Required',\n  '429': 'Too Many Requests',\n  '431': 'Request Header Fields Too Large',\n  '451': 'Unavailable For Legal Reasons',\n  '500': 'Internal Server Error',\n  '501': 'Not Implemented',\n  '502': 'Bad Gateway',\n  '503': 'Service Unavailable',\n  '504': 'Gateway Timeout',\n  '505': 'HTTP Version Not Supported',\n  '506': 'Variant Also Negotiates',\n  '507': 'Insufficient Storage',\n  '508': 'Loop Detected',\n  '509': 'Bandwidth Limit Exceeded',\n  '510': 'Not Extended',\n  '511': 'Network Authentication Required' \n}\n</code></pre></li> </ul> </li> <li>http.globalAgent<ul> <li>\u8a72\u5c6c\u6027\u6703\u6307\u5411(points to)\u5168\u57df\u7684\u4ee3\u7406\u5668(<code>Agent</code>)\u7269\u4ef6(object)\u7684\u5be6\u4f8b(instance),\u4e5f\u5c31\u662fhttp.Agent\u985e\u5225(class)\u7684\u5be6\u4f8b(instance)</li> <li>\u8a72\u5c6c\u6027\u88ab\u7528\u4f86\u7ba1\u7406(manage)\u8207<code>HTTP</code>\u5ba2\u6236\u7aef(clients)\u7684\u9023\u63a5(connections)\u6301\u4e45\u6027(persistence) &amp; \u91cd\u7528(reuse)\u3002\u56e0\u6b64\u8a72\u5c6c\u6027\u662fNode\u7684<code>HTTP</code>\u7db2\u8def(networking)\u7684\u95dc\u9375\u5143\u4ef6(key component)</li> <li>\u95dc\u65bc<code>http.Agent</code>\u985e\u5225(class),\u5728\u7a0d\u5f8c(later on)\u7684\u63cf\u8ff0(description)\u4e2d\u6703\u6709\u66f4\u591a\u4ecb\u7d39</li> </ul> </li> <li>\u65b9\u6cd5(Methods)</li> <li>http.createServer([options][, requestListener])<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3(return)\u4e00\u500b\u65b0\u7684http.Server\u985e\u5225(class)\u7684\u5be6\u4f8b(instance)   JavaScript<pre><code>const server = http.createServer((req, res) =&gt; {\n  //handle every single request with this callback\n})\n</code></pre></li> </ul> </li> <li>http.request(url[, options][, callback])<ul> <li>\u8a72\u65b9\u6cd5\u6703\u5411\u4f3a\u670d\u5668\u7aef\u767c\u51fa<code>HTTP</code>\u7684\u8acb\u6c42(<code>request</code>),\u4e26\u5efa\u7acb(creating)\u4e00\u500bhttp.ClientRequest\u985e\u5225(class)\u7684\u5be6\u4f8b(instance)</li> </ul> </li> <li>http.get(url[, options][, callback])<ul> <li>\u8207<code>http.request()</code>\u65b9\u6cd5\u985e\u4f3c(similar),\u4f46\u6703\u81ea\u52d5\u5730(automatically)\u8a2d\u5b9a(sets)<code>HTTP</code>\u7684\u8acb\u6c42(<code>request</code>)\u65b9\u6cd5\u70ba<code>GET</code>\u65b9\u6cd5,\u4e26\u4e14\u6703\u81ea\u52d5\u547c\u53ebrequest.end([data[, encoding]][, callback])\u65b9\u6cd5</li> </ul> </li> <li>\u985e\u5225(Classes)</li> <li><code>HTTP</code>\u6a21\u7d44(module)\u6703\u63d0\u4f9b\u4ee5\u4e0b5\u7a2e\u985e\u5225(classes)<ul> <li><code>http.Agent</code></li> <li><code>http.ClientRequest</code></li> <li><code>http.Server</code></li> <li><code>http.ServerResponse</code></li> <li><code>http.IncomingMessage</code></li> </ul> </li> <li>http.Agent<ul> <li>Node\u6703\u5efa\u7acb\u4e00\u500b\u5168\u57df\u7684\u4ee3\u7406\u5668(<code>Agent</code>)\u985e\u5225(class)\u7684\u5be6\u4f8b(instance),\u4ee5\u7528\u4f86\u7ba1\u7406(manage)\u8207<code>HTTP</code>\u5ba2\u6236\u7aef(clients)\u7684\u9023\u63a5(connections)\u6301\u4e45\u6027(persistence) &amp; \u91cd\u7528(reuse)\u3002\u56e0\u6b64<code>http.Agent</code>\u985e\u5225(class)\u662fNode\u7684<code>HTTP</code>\u7db2\u8def(networking)\u7684\u95dc\u9375\u5143\u4ef6(key component)</li> <li>\u9019\u500b\u7269\u4ef6\u6703\u78ba\u4fdd(make sure)\u5c0d\u65bc\u4f3a\u670d\u5668\u7aef(server)\u7684\u6bcf\u500b\u8acb\u6c42(every request)\u90fd\u662f\u6392\u968a(queued)\u7684,\u4e26\u4e14\u4efb\u4f55\u55ae\u4e00(single)\u63d2\u5ea7(socket)\u90fd\u662f\u6709\u88ab\u91cd\u8907\u4f7f\u7528(reused)\u7684</li> <li>\u6b64\u985e\u5225(class)\u4e5f\u6703\u7dad\u8b77(maintains)\u63d2\u5ea7\u6c60(a pool of sockets)\u3002\u9019\u4e5f\u5c31\u662fNode\u6548\u80fd(performance)\u597d\u7684\u95dc\u9375(key)\u539f\u56e0(reason)\u4e4b\u4e00</li> </ul> </li> <li>http.ClientRequest<ul> <li>\u7576\u547c\u53eb(called)http.request\u6216\u662fhttp.get()\u90192\u7a2e\u65b9\u6cd5\u4e4b\u4e00\u6642,\u7686\u6703\u5efa\u7acb(created)\u4e00\u500b<code>http.ClientRequest</code>\u7269\u4ef6(object)</li> <li>\u7576\u6536\u5230(received)\u56de\u61c9(response)\u6642,\u5c07\u6703\u4ee5\u4e00\u500b<code>http.IncomingMessage</code>\u5be6\u4f8b(instance)\u4f5c\u70ba\u53c3\u6578(argument),\u4f86\u547c\u53eb<code>response</code>\u4e8b\u4ef6(event)\u4f86\u4f5c\u70ba\u56de\u61c9(response)</li> <li>\u8a72\u985e\u5225(class)\u6240\u56de\u50b3(returned)\u7684\u56de\u61c9\u8cc7\u6599(data of a response),\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b2\u7a2e\u65b9\u5f0f\u4f86\u8b80\u53d6</li> <li>\u6211\u5011\u53ef\u4ee5\u547c\u53eb<code>response.read()</code>\u65b9\u6cd5</li> <li>\u5728<code>response</code>\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u4e2d,\u6211\u5011\u53ef\u4ee5\u8a2d\u5b9a(setup)\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(event listener)\u7d66<code>data</code>\u4e8b\u4ef6(event),\u56e0\u6b64\u6211\u5011\u5c31\u80fd\u76e3\u807d(listen)\u4e32\u6d41\u9032\u53bb(streamed into)\u7684\u8cc7\u6599\u6d41(data)</li> </ul> </li> <li>http.Server<ul> <li>\u7576\u900f\u904e<code>http.createServer()</code>\u65b9\u6cd5(method)\u4f86\u5efa\u7acb(creating)\u4e00\u500b\u65b0\u7684\u4f3a\u670d\u5668(new server)\u6642,\u901a\u5e38(commonly)\u6703\u5be6\u4f8b\u5316(instantiated)\u4e26\u4e14\u56de\u50b3(returned)\u6b64\u985e\u5225(=&gt; \u4e5f\u5c31\u662f<code>http.Server</code>\u985e\u5225(class))</li> <li>\u4e00\u65e6(Once)\u6211\u5011\u64c1\u6709(have)\u4e00\u500b\u4f3a\u670d\u5668\u7269\u4ef6(server object)\u6642,\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b2\u7a2e\u65b9\u6cd5(methods)\u4f86\u5b58\u53d6(access)\u9019\u500b\u4f3a\u670d\u5668\u7269\u4ef6</li> <li>server.close([callback]): \u963b\u6b62(stop)\u4f3a\u670d\u5668(server)\u7e7c\u7e8c\u63a5\u53d7(accepting)\u65b0\u7684\u9023\u63a5(new connections)</li> <li>server.listen(): \u555f\u52d5(starts)HTTP\u4f3a\u670d\u5668(server),\u4e26\u76e3\u807d(listens)\u9023\u63a5(connections)</li> </ul> </li> <li>http.ServerResponse<ul> <li>\u6b64\u985e\u5225\u662f\u900f\u904e<code>http.Server</code>\u985e\u5225(class)\u6240\u5efa\u7acb\u7684,\u4e26\u50b3\u905e(passed)\u7d66\u4f5c\u70ba\u89f8\u767c(fires)<code>request</code>\u4e8b\u4ef6(event)\u7684\u7b2c2\u500b\u53c3\u6578(parameter)</li> <li>\u5e38\u898b(Commonly)\u4e14\u77e5\u540d(known)\u7684\u505a\u6cd5\u662f\u5728\u7a0b\u5f0f\u78bc\u4e2d\u7528\u4f5c<code>res</code> JavaScript<pre><code>const server = http.createServer((req, res) =&gt; {\n  //res is an http.ServerResponse object\n})\n</code></pre></li> <li>\u5728\u4e8b\u4ef6\u8655\u7406\u5668(handler)\u4e2d,\u6211\u5011\u5e38\u6703\u547c\u53eb(call)\u7684\u6703\u662fresponse.end([data[, encoding]][, callback])\u65b9\u6cd5(method),<code>response.end()</code>\u65b9\u6cd5\u6703\u95dc\u9589(close)<code>response</code>\u7269\u4ef6,\u540c\u6642\u8a0a\u606f(message)\u5df2\u7d93\u5b8c\u6210(complete)\u4e86,\u4f3a\u670d\u5668(server)\u4e5f\u80fd\u5c07\u6b64\u8a0a\u606f\u767c\u9001(send)\u7d66\u5ba2\u6236\u7aef(client)\u3002<code>response.end()</code>\u65b9\u6cd5\u5c07\u6703\u5728\u6bcf\u6b21\u56de\u61c9(each response)\u6642,\u90fd\u6703\u88ab\u547c\u53eb(called)\u5230</li> <li>\u4ee5\u4e0b\u7684\u65b9\u6cd5(methods)\u5011\u5c07\u6703\u88ab\u7528\u4f86\u8207HTTP\u6a19\u982d(headers)\u505a\u4e92\u52d5(interact)</li> <li>response.getHeaderNames()<ul> <li>\u6b64\u65b9\u6cd5\u6703\u5f97\u5230(get)\u4e00\u500b\u5df2\u7d93(already)\u8a2d\u5b9a(set)\u597d\u7684HTTP\u6a19\u982d(headers)\u7684\u540d\u7a31\u6e05\u55ae(the list of names)</li> </ul> </li> <li>response.getHeaders()<ul> <li>\u6b64\u65b9\u6cd5\u6703\u5f97\u5230(get)\u4e00\u500b\u5df2\u7d93(already)\u8a2d\u5b9a(set)\u597d\u7684HTTP\u6a19\u982d(headers)\u7684\u62f7\u8c9d(copy, =&gt; \u6703\u4ee5\u7269\u4ef6(object)\u7684\u5f62\u5f0f\u4f86\u5c55\u793a)</li> </ul> </li> <li>response.setHeader('headername', value)<ul> <li>\u6b64\u65b9\u6cd5\u6703\u8a2d\u5b9a\u4e00\u500b(set)HTTP\u6a19\u982d(header)\u7684\u503c(value)</li> </ul> </li> <li>response.getHeader('headername')<ul> <li>\u6b64\u65b9\u6cd5\u6703\u5f97\u5230(get)\u4e00\u500b\u5df2\u7d93(already)\u8a2d\u5b9a(set)\u597d\u7684HTTP\u6a19\u982d(header)\u7684\u503c(value)</li> </ul> </li> <li>response.removeHeader('headername')<ul> <li>\u6b64\u65b9\u6cd5\u6703\u79fb\u9664(remove)\u4e00\u500b\u5df2\u7d93(already)\u8a2d\u5b9a(set)\u597d\u7684HTTP\u6a19\u982d(header)</li> </ul> </li> <li>response.hasHeader('headername')<ul> <li>\u7576\u6307\u5b9a\u7684HTTP\u6a19\u982d(header)\u5df2\u7d93(already)\u6709\u8a2d\u5b9a(set)\u904e\u7684\u503c\u6642\u5019,\u5c31\u6703\u56de\u50b3<code>true</code></li> </ul> </li> <li>response.headersSent<ul> <li>\u7576\u6307\u5b9a\u7684HTTP\u6a19\u982d(header)\u5df2\u7d93(already)\u50b3\u9001(sent)\u7d66\u5ba2\u6236\u7aef(client)\u7684\u6642\u5019,\u5c31\u6703\u56de\u50b3<code>true</code></li> </ul> </li> <li>\u5728\u8655\u7406\u5b8cHTTP\u6a19\u982d(header)\u4ee5\u5f8c,\u6211\u5011\u5c31\u53ef\u4ee5\u900f\u904eresponse.writeHead(statusCode[, statusMessage][, headers])\u65b9\u6cd5\u4f86\u5c07HTTP\u6a19\u982d(header)\u50b3\u9001\u7d66\u5ba2\u6236\u7aef(client)\u3002<code>response.writeHead()</code>\u65b9\u6cd5\u6703\u63a5\u53d7\u72c0\u614b\u78bc(statusCode)\u4f5c\u70ba\u7b2c1\u500b\u53c3\u6578(parameter),\u63a5\u8457\u662f\u9078\u64c7\u6027(optional)\u7684\u53c3\u6578(=&gt; \u72c0\u614b\u8a0a\u606f(status message)),\u6700\u5f8c\u662fHTTP\u6a19\u982d(headers)\u7269\u4ef6(object)</li> <li>\u82e5\u60f3\u8981\u5c07\u8cc7\u6599(data)\u50b3\u9001(send)\u7d66\u5ba2\u6236\u7aef(client)\u7684\u5167\u6587(<code>response body</code>)\u7684\u8a71,\u6211\u5011\u6703\u9700\u8981\u900f\u904eresponse.write(chunk[, encoding][, callback])\u65b9\u6cd5,\u800c<code>response.write()</code>\u65b9\u6cd5\u5c07\u6703\u50b3\u9001(send)\u7de9\u5b58\u8cc7\u6599(buffered data)\u7d66HTTP\u56de\u61c9\u4e32\u6d41(response stream)</li> <li>\u5982\u679c\u5c1a\u672a(not yet)\u5148\u4f7f\u7528<code>response.writeHead()</code>\u65b9\u6cd5\u4f86\u50b3\u9001(sent)HTTP\u6a19\u982d(header)\u51fa\u53bb\u7684\u8a71,\u5b83\u5c07\u6703\u5148(first)\u50b3\u9001(send)\u4f9d\u7167\u50b3\u904e\u4f86\u7684HTTP\u8acb\u6c42(<code>response</code>)\u7684\u72c0\u614b\u78bc(status code) &amp; \u72c0\u614b\u8a0a\u606f(status message)\u4f86\u50b3\u9001\u56de\u53bbHTTP\u6a19\u982d(header)\u7d66\u5ba2\u6236\u7aef(client)\u3002\u6211\u5011\u4e5f\u53ef\u4ee5\u900f\u904eresponse.statusCode\u8207response.statusMessage\u90192\u7a2e\u5c6c\u6027(properties)\u4f86\u8a2d\u5b9a\u8981\u56de\u50b3\u7d66\u5ba2\u6236\u7aef\u7684HTTP\u6a19\u982d(header)\u7684\u72c0\u614b\u78bc(status code) &amp; \u72c0\u614b\u8a0a\u606f(status message)</li> </ul> </li> <li>http.IncomingMessage<ul> <li>\u6b64\u4e00\u7269\u4ef6(object)\u53ef\u900f\u904e\u4ee5\u4e0b2\u7a2e\u65b9\u5f0f\u4f86\u5efa\u7acb(created)\u51fa\u4f86</li> <li>\u7576<code>http.Server</code>\u7269\u4ef6\u5728\u76e3\u807d(listening)<code>request</code>\u4e8b\u4ef6(event)\u6642</li> <li>\u7576<code>http.ClientRequest</code>\u7269\u4ef6\u5728\u76e3\u807d(listening)<code>response</code>\u4e8b\u4ef6(event)\u6642</li> <li><code>http.IncomingMessage</code>\u7269\u4ef6\u53ef\u4ee5\u88ab\u7528\u4f86\u5b58\u53d6\u56de\u61c9\u7269\u4ef6(<code>response</code>)</li> <li>\u5229\u7528\u5b83\u81ea\u5df1\u7684message.statusCode\u8207message.statusMessage\u90192\u7a2e\u5c6c\u6027</li> <li>\u5229\u7528\u4ed6\u81ea\u5df1\u7684HTTP\u6a19\u982d(headers)\u65b9\u6cd5\u6216\u662fmessage.rawHeaders\u5c6c\u6027</li> <li>HTTP\u65b9\u6cd5(method)\u53ef\u4ee5\u5229\u7528\u5b83\u81ea\u5df1\u7684message.method\u5c6c\u6027</li> <li>HTTP\u7248\u672c(version)\u53ef\u4ee5\u5229\u7528\u5b83\u81ea\u5df1\u7684message.httpVersion\u5c6c\u6027</li> <li><code>URL</code>\u53ef\u4ee5\u5229\u7528\u5b83\u81ea\u5df1\u7684message.url\u5c6c\u6027</li> <li>\u5e95\u5c64\u63d2\u5ea7(underlying socket)\u53ef\u4ee5\u5229\u7528\u5b83\u81ea\u5df1\u7684message.socket\u5c6c\u6027</li> <li>\u7531\u65bc(since)<code>http.IncomingMessage</code>\u7269\u4ef6\u5be6\u73fe(implements)\u4e86\u53ef\u8b80\u53d6(readable)\u4e32\u6d41(stream)\u4ecb\u9762(interface),\u56e0\u6b64\u53ef\u900f\u904e\u4e32\u6d41(streams)\u4f86\u5b58\u53d6(accessed)\u8cc7\u6599(data)</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#nodejs-buffers","title":"Node.js Buffers","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Buffer</p> <ul> <li><code>Buffer</code>\u662f\u4ec0\u9ebc? (What is a buffer?)</li> <li><code>buffer</code>(\u7de9\u5b58)\u662f\u8a18\u61b6\u9ad4(memory)\u7684\u4e00\u500b\u5340\u57df(area)\u3002Javascript\u7684\u958b\u767c\u8005(developers)\u53ef\u80fd\u6703\u4e0d\u592a\u719f\u6089\u9019\u500b\u89c0\u5ff5,\u800c\u4e0d\u50cf\u662f\u4f7f\u7528\u5176\u4ed6<code>C</code>, <code>C++</code>, <code>Go</code>\u7a0b\u5f0f\u8a9e\u8a00(\u6216\u662f\u5176\u4ed6\u4e5f\u5728\u4f7f\u7528\u7cfb\u7d71\u7a0b\u5f0f\u8a9e\u8a00(system programming language)\u7684\u4eba),\u6bcf\u5929\u9700\u8981\u8207\u8a18\u61b6\u9ad4\u4e92\u52d5(interact)\u7684\u958b\u767c\u8005,\u4f86\u5f97\u719f\u6089</li> <li><code>buffer</code>(\u7de9\u5b58)\u4ee3\u8868\u4e00\u500b\u5f9e<code>V8</code>\u9019\u500bJavascript\u5f15\u64ce(engine)\u6240\u5206\u914d(allocated)\u51fa\u4f86\u7684\u56fa\u5b9a\u5927\u5c0f(a fixed-size chunk)\u7684\u8a18\u61b6\u9ad4(memory),\u4e26\u4e14\u4e0d\u80fd\u518d\u88ab\u8abf\u6574\u5927\u5c0f(resized)</li> <li>\u6211\u5011\u53ef\u4ee5\u628a<code>buffer</code>(\u7de9\u5b58)\u60f3\u50cf(think of)\u6210\u662f\u4e00\u500b\u985e\u4f3c\u6b63\u6574\u6578\u9663\u5217(an array of integer),\u5176\u4e2d\u7684\u6bcf\u500b(each)\u6578\u5b57\u90fd\u4ee3\u8868(represent)\u8cc7\u6599\u7684\u4e00\u500b\u4f4d\u5143\u7d44(a byte of data)</li> <li><code>buffer</code>(\u7de9\u5b58)\u662f\u900f\u904eNode\u7684Buffer\u985e\u5225(class)\u4f86\u5be6\u4f5c(implemented)\u7684</li> <li>\u6211\u5011\u70ba\u4ec0\u9ebc\u6703\u9700\u8981<code>buffer</code>(\u7de9\u5b58)? (Why do we need buffer?)</li> <li>\u76f8\u6bd4\u65bc\u50b3\u7d71\u4e0a\u50c5\u8655\u7406\u5b57\u4e32(string)\u800c\u4e0d\u662f\u4e8c\u9032\u5236\u6578\u64da(binaries)\u7684\u751f\u614b\u5708(ecosystem),Node\u7684<code>Buffer</code>\u985e\u5225(class)\u662f\u88ab\u5f15\u9032(introduced)\u4f86\u5e6b\u52a9\u958b\u767c\u8005\u8655\u7406(dealt with)\u4e8c\u9032\u5236\u7684\u8cc7\u6599(binary data)</li> <li><code>Buffer</code>(\u7de9\u5b58)\u8207<code>Stream</code>(\u4e32\u6d41)\u662f\u7dca\u5bc6\u76f8\u9023(deeply linked)\u7684\u3002\u7576\u4e32\u6d41\u8655\u7406\u5668(stream processor)\u6536\u5230(receives)\u8cc7\u6599(data)\u7684\u901f\u5ea6\u6bd4\u8d77\u5b83\u80fd\u6d88\u5316(digest)\u7684\u901f\u5ea6\u5feb(faster)\u6642,\u4e32\u6d41\u8655\u7406\u5668\u5c31\u6703\u5c07\u8cc7\u6599\u653e\u5230<code>buffer</code></li> <li>\u5c0d\u65bc<code>buffer</code>(\u7de9\u5b58)\u7684\u4e00\u500b\u7c21\u55ae\u8996\u89ba\u5316(visualization)\u7684\u65b9\u5f0f\u5c31\u662f\u7576\u6211\u5011\u5728\u89c0\u770bYouTube\u5f71\u7247\u6642,\u7d05\u7dda(red line)\u6703\u8d85\u904e(beyond)\u6211\u5011\u7684\u89c0\u770b\u9ede(visualization point)---\u9019\u5c31\u4ee3\u8868YoutTube\u4e0b\u8f09\u8cc7\u6599(downloading data)\u7684\u901f\u5ea6\u6bd4\u6211\u5011\u89c0\u770b(viewing)\u5f71\u7247\u7684\u901f\u5ea6\u4f86\u5f97\u5feb(faster),\u4e26\u4e14\u7531\u6211\u5011\u7684\u700f\u89bd\u5668(browser)\u8ca0\u8cac\u8655\u7406<code>buffer</code>(\u7de9\u5b58)</li> <li>\u5982\u4f55\u5efa\u7acb<code>buffer</code>(\u7de9\u5b58)? (How to create a buffer)</li> <li><code>buffer</code>(\u7de9\u5b58)\u662f\u900f\u904eBuffer.from(), Buffer.alloc(), and Buffer.allocUnsafe()\u65b9\u6cd5\u5011\u4f86\u5efa\u7acb(created)\u7684       JavaScript<pre><code>const buf = Buffer.from('Hey!')\n</code></pre><ul> <li>Buffer.from(array)</li> <li>Buffer.from(arrayBuffer[, byteOffset[, length]])</li> <li>Buffer.from(buffer)</li> <li>Buffer.from(string[, encoding])</li> </ul> </li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u50c5\u50b3\u905e(passing)\u4e00\u500b\u5927\u5c0f(size)\u4f86\u521d\u59cb\u5316(initialize)\u4e00\u500b<code>buffer</code>(\u7de9\u5b58)\u3002\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u6703\u5efa\u7acb\u4e00\u500b1<code>KB</code>\u5927\u5c0f\u7684<code>buffer</code> JavaScript<pre><code>const buf = Buffer.alloc(1024)\n//or\nconst buf = Buffer.allocUnsafe(1024)\n</code></pre><ul> <li>\u5118\u7ba1(While)\u4ee5\u4e0a\u76842\u7a2e\u65b9\u6cd5(=&gt; \u4e5f\u5c31\u662fBuffer.alloc()\u8207Buffer.allocUnsafe())\u7686\u5206\u914d\u7d66<code>buffer</code>(\u7de9\u5b58)\u4e00\u500b\u6307\u5b9a(specified)\u5927\u5c0f(size)\u7684\u4f4d\u5143\u7d44(bytes),\u4f46\u662f\u7531<code>Buffer.alloc()</code>\u65b9\u6cd5\u6240\u5efa\u7acb\u7684<code>buffer</code>\u6703\u88ab\u521d\u59cb\u5316(initialized)\u70ba<code>0</code>,\u800c\u7531<code>Buffer.allocUnsafe()</code>\u65b9\u6cd5\u6240\u5efa\u7acb\u7684<code>buffer</code>\u5c07\"\u4e0d\u6703\"\u88ab\u521d\u59cb\u5316(uninitialized)\u3002\u9019\u4e5f\u610f\u5473\u8457\u5118\u7ba1\u7531<code>Buffer.allocUnsafe()</code>\u65b9\u6cd5\u6240\u5efa\u7acb\u7684<code>buffer</code>\u5c07\u6703\u6bd4\u7531<code>Buffer.alloc()</code>\u65b9\u6cd5\u6240\u5efa\u7acb\u7684<code>buffer</code>\u4f86\u5f97\u5feb\u5f88\u591a(quite fast),\u4f46\u662f\u7531<code>Buffer.allocUnsafe()</code>\u65b9\u6cd5\u6240\u5efa\u7acb\u7684<code>buffer</code>\u88ab\u5206\u914d(allocated)\u5230\u7684\u8a18\u61b6\u9ad4(memory)\u7247\u6bb5(segment)\u53ef\u80fd\u6703\u5305\u542b(contain)\u820a\u8cc7\u6599(old data),\u800c\u9019\u4e9b\u820a\u8cc7\u6599\u5c07\u6709\u53ef\u80fd\u662f\u654f\u611f\u6027(sensitive)\u8cc7\u6599</li> <li>\u7576\u8a18\u61b6\u9ad4(memory)\u4e2d\u5b58\u5728\u820a\u8cc7\u6599(older data),\u5c31\u53ef\u4ee5\u5728<code>buffer</code>(\u7de9\u5b58)\u8a18\u61b6\u9ad4\u88ab\u8b80\u53d6(read) or \u6d29\u6f0f(leaked)\u6642\u53ef\u4ee5\u88ab\u5b58\u53d6(accessed)\u3002\u6b63\u4e5f\u56e0\u70ba\u9019\u6a23,<code>Buffer.allocUnsafe()</code>\u65b9\u6cd5\u624d\u6703\u88ab\u547d\u540d\u70ba\u4e0d\u5b89\u5168(unsafe)\u7684,\u4e26\u4e14\u5728\u4f7f\u7528\u6b64\u65b9\u6cd5\u6642\u9700\u8981\u66f4\u52a0\u6ce8\u610f(extra care)</li> </ul> </li> <li>\u4f7f\u7528<code>buffer</code>(\u7de9\u5b58) (Using a buffer)</li> <li>\u5b58\u53d6<code>buffer</code>(\u7de9\u5b58)\u7684\u5167\u5bb9 (Access the content of a buffer)<ul> <li><code>buffer</code>(\u7de9\u5b58)\u662f\u4e00\u500b\u7531\u4e8c\u9032\u5236\u8cc7\u6599(bytes)\u7d44\u6210\u7684\u9663\u5217(array),\u53ef\u4ee5\u7528\u5982\u540c\u9663\u5217(array)\u4e00\u6a23\u7684\u65b9\u5f0f\u4f86\u5b58\u53d6(accessed)     JavaScript<pre><code>const buf = Buffer.from('Hey!')\nconsole.log(buf[0]) //72\nconsole.log(buf[1]) //101\nconsole.log(buf[2]) //121\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u6578\u5b57\u662f\u842c\u570b\u78bc(Unicode Code),\u8868\u793a\u5b57\u5143(character)\u5728\u7de9\u885d\u5340(<code>buffer</code>)\u7684\u4f4d\u7f6e(position)\u3002<code>H</code>=&gt; 72, <code>e</code>=&gt; 101, <code>y</code>=&gt; 121</li> </ul> </li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528buf.toString()\u65b9\u6cd5\u4f86\u5c07<code>buffer</code>(\u7de9\u5b58)\u7684\u5b8c\u6574\u5167\u5bb9(full content)\u6253\u5370(print)\u51fa\u4f86       JavaScript<pre><code>console.log(buf.toString())\n</code></pre></li> <li>\u7576\u6211\u5011\u5728\u521d\u59cb\u5316(initialize)\u4e00\u500b<code>buffer</code>(\u7de9\u5b58)\u6642,\u6709\u8a2d\u5b9a(sets)\u597d\u5b83\u7684\u5927\u5c0f(size)\u7684\u8a71,\u5247\u6211\u5011\u5c07\u80fd\u5b58\u53d6\u6703\u5305\u542b(contain)\u96a8\u6a5f\u6578\u64da(random data)\u800c\u4e0d\u662f\u7a7a(empty)\u7684<code>buffer</code>(\u7de9\u5b58)\u7684\u9810\u521d\u59cb\u5316\u8a18\u61b6\u9ad4(pre-initialized memory)</li> </ul> </li> <li>\u53d6\u5f97<code>buffer</code>(\u7de9\u5b58)\u7684\u9577\u5ea6 (Get the length of a buffer)<ul> <li>\u53ef\u5229\u7528buf.length\u5c6c\u6027   JavaScript<pre><code>const buf = Buffer.from('Hey!')\nconsole.log(buf.length)\n</code></pre></li> </ul> </li> <li>\u904d\u6b77<code>buffer</code>(\u7de9\u5b58)\u7684\u5167\u5bb9 (Iterate over the contents of a buffer)       JavaScript<pre><code>const buf = Buffer.from('Hey!')\nfor (const item of buf) {\n  console.log(item) //72 101 121 33\n}\n</code></pre></li> <li>\u66f4\u6539<code>buffer</code>(\u7de9\u5b58)\u7684\u5167\u5bb9 (Changing the content of a buffer)<ul> <li>\u53ef\u5229\u7528buf.write(string[, offset[, length]][, encoding])\u65b9\u6cd5\u4f86\u6574\u500b(whole)\u8cc7\u6599\u5b57\u4e32(string of data)\u5beb\u5165(write)\u5230<code>buffer</code>(\u7de9\u5b58)\u4e4b\u4e2d     JavaScript<pre><code>const buf = Buffer.alloc(4)\nbuf.write('Hey!')\n</code></pre></li> <li>\u5c31\u5982\u540c\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9663\u5217(array)\u8a9e\u6cd5(syntax)\u4f86\u5b58\u53d6(access)<code>buffer</code>(\u7de9\u5b58),\u6211\u5011\u4e5f\u80fd\u5229\u7528\u540c\u6a23\u7684\u65b9\u5f0f(in the same way)\u4f86\u8a2d\u5b9a(set)<code>buffer</code>(\u7de9\u5b58)\u7684\u5167\u5bb9(contents)     JavaScript<pre><code>const buf = Buffer.from('Hey!')\nbuf[1] = 111 //o\nconsole.log(buf.toString()) //Hoy!\n</code></pre></li> </ul> </li> <li>\u8907\u88fd\u4e00\u500b<code>buffer</code>(\u7de9\u5b58) (Copy a buffer)<ul> <li>\u53ef\u5229\u7528buf.copy(target[, targetStart[, sourceStart[, sourceEnd]]])\u65b9\u6cd5\u4f86\u8907\u88fd\u4e00\u500b<code>buffer</code>(\u7de9\u5b58)     JavaScript<pre><code>const buf = Buffer.from('Hey!')\nlet bufcopy = Buffer.alloc(4) //allocate 4 bytes\nbuf.copy(bufcopy)\n</code></pre></li> <li>\u5728\u9810\u8a2d\u7684\u60c5\u6cc1\u4e0b,\u6211\u5011\u5c07\u8907\u88fd\u6574\u500b<code>buffer</code>(\u7de9\u5b58)\u3002<code>buffer.copy()</code>\u65b9\u6cd5\u5167\u76843\u500b\u53c3\u6578(parameters)\u53ef\u4ee5\u8b93\u6211\u5011\u5b9a\u7fa9(define)</li> <li>\u8d77\u59cb\u4f4d\u7f6e(starting position)</li> <li>\u7d50\u675f\u4f4d\u7f6e(ending position)</li> <li>\u65b0\u7684<code>buffer</code>\u9577\u5ea6(the new buffer length)     JavaScript<pre><code>const buf = Buffer.from('Hey!')\nlet bufcopy = Buffer.alloc(2) //allocate 2 bytes\nbuf.copy(bufcopy, 0, 0, 2)\nbufcopy.toString() //'He'\n</code></pre></li> </ul> </li> <li>\u5c07<code>buffer</code>(\u7de9\u5b58)\u5207\u7247 (Slice a buffer)<ul> <li>\u5982\u679c\u6211\u5011\u60f3\u5efa\u7acb(create)\u4e00\u500b\u90e8\u5206(partial)\u53ef\u8996\u5316(visualization)\u7684<code>buffer</code>(\u7de9\u5b58),\u6211\u5011\u53ef\u4ee5\u5efa\u7acb\u4e00\u500b\u5207\u7247(slice)\u3002 \u5207\u7247(slice)\"\u4e26\u4e0d\u662f\"\u8907\u88fd(copy): \u539f\u59cb(original)<code>buffer</code>(\u7de9\u5b58)\u4ecd\u7136\u662f\u4e8b\u5be6\u4f86\u6e90(the source of truth),\u4f46\u5982\u679c\u539f\u59cb\u7de9\u5b58\u88ab\u6539\u8b8a\u6642,\u6211\u5011\u6240\u5efa\u7acb\u7684<code>buffer</code>\u5207\u7247(slice)\u4e5f\u6703\u88ab\u6539\u8b8a</li> <li>\u53ef\u5229\u7528buf.slice([start[, end]])\u65b9\u6cd5\u4f86\u5efa\u7acb\u4e00\u500b<code>buffer</code>(\u7de9\u5b58)\u5207\u7247,\u6b64\u65b9\u6cd5\u7684\u7b2c1\u500b\u53c3\u6578(parameter)\u4ee3\u8868\u8d77\u59cb\u4f4d\u7f6e(starting position),\u4ee5\u53ca\u53ef\u6307\u5b9a(specify)\u7b2c2\u500b\u9078\u64c7\u6027(optional)\u7684\u53c3\u6578(parameter)\u4f5c\u70ba\u7d50\u675f\u4f4d\u7f6e(ending position)     JavaScript<pre><code>const buf = Buffer.from('Hey!')\nbuf.slice(0).toString() //Hey!\nconst slice = buf.slice(0, 2)\nconsole.log(slice.toString()) //He\nbuf[1] = 111 //o\nconsole.log(slice.toString()) //Ho\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#nodejs-streams","title":"Node.js Streams","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Stream</p> <ul> <li>\u4ec0\u9ebc\u662f<code>streams</code>(\u4e32\u6d41)? (What are streams?)</li> <li><code>Streams</code>(\u4e32\u6d41)\u662f\u5176\u4e2d\u4e00\u500b\u70baNode\u61c9\u7528\u7a0b\u5f0f(applications)\u63d0\u4f9b\u52d5\u529b(power)\u7684\u57fa\u672c(fundamental)\u89c0\u5ff5(concept)\u4e4b\u4e00</li> <li><code>Streams</code>(\u4e32\u6d41)\u662f\u4e00\u500b\u7528\u4f86\u8655\u7406(handle)\u8b80\u5beb(reading/writing)\u6a94\u6848(files)\u3001\u7db2\u8def\u901a\u8a0a(network communications)\u3001\u6216\u662f\u4efb\u4f55(any kind of)\u7aef\u5c0d\u7aef(end-to-end)\u7684\u8cc7\u8a0a\u4ea4\u6d41(information exchange)\u7684\u4e00\u7a2e\u6709\u6548\u7387(efficient)\u7684\u65b9\u5f0f(way)</li> <li><code>Streams</code>(\u4e32\u6d41)\u4e26\u4e0d\u662fNode\u7279\u6709(unique)\u7684\u6982\u5ff5(concept)\u3002\u65e9\u5728\u5e7e\u5341\u5e74(decades)\u4ee5\u524d\u5de6\u53f3,<code>Streams</code>(\u4e32\u6d41)\u5c31\u5df2\u7d93\u88ab<code>Unix</code>\u4f5c\u696d\u7cfb\u7d71(operating system)\u6240\u5f15\u9032(introduced)\u4e86,\u56e0\u6b64\u7a0b\u5f0f(program)\u5c31\u80fd\u900f\u904e\u7ba1\u9053\u904b\u7b97\u5b50(pipe operator, =&gt; \u4e5f\u5c31\u662f<code>|</code>)\u4f86\u8207\u6bcf\u4e00\u500b\u901a\u904e(passing)\u7684<code>streams</code>(\u4e32\u6d41)\u505a\u4e92\u52d5</li> <li>\u8209\u4f8b\u4f86\u8aaa,\u82e5\u662f\u50b3\u7d71(traditional)\u7684\u65b9\u6cd5(way),\u7576\u6211\u5011\u544a\u8a34\u7a0b\u5f0f(program)\u8981\u8b80\u53d6(read)\u4e00\u500b\u6a94\u6848(file)\u6642,\u6a94\u6848\u6703\u88ab\u8b80\u53d6\u5230\u8a18\u61b6\u9ad4(memory)\u4e2d,\u5f9e\u958b\u59cb(start)\u5230\u7d50\u675f(finish),\u7136\u5f8c\u6211\u5011\u5c31\u80fd\u8655\u7406(process)\u5b83</li> <li>\u900f\u904e<code>streams</code>(\u4e32\u6d41)\u4f86\u5c07\u6a94\u6848\u5167\u5bb9\u4e00\u90e8\u5206\u4e00\u90e8\u5206(piece by piece)\u5730\u8b80\u53d6(read),\u800c\u4e0d\u7528\u5728\u8655\u7406\u8a72\u6a94\u6848\u5167\u5bb9\u6642,\u9700\u8981\u5148\u628a\u6574\u500b(all)\u6a94\u6848\u5167\u5bb9\u4e8b\u5148\u8b80\u53d6\u5230\u8a18\u61b6\u9ad4(memory)\u4e2d</li> <li>Node\u7684Stream\u5167\u5efa\u6838\u5fc3\u6a21\u7d44\u63d0\u4f9b(provides)\u4e86\u80fd\u5efa\u69cb(built)\u51fa\u6240\u6709<code>streams</code>(\u4e32\u6d41)API\u7684\u57fa\u790e(foundation)</li> <li>\u6240\u6709\u7684<code>streams</code>(\u4e32\u6d41)\u90fd\u662fEventEmitter\u985e\u5225(class)\u7684\u5be6\u4f8b(instances)</li> <li>\u70ba\u4ec0\u9ebc\u8981\u4f7f\u7528<code>streams</code>(\u4e32\u6d41)? (Why streams?)</li> <li>\u5728\u8cc7\u6599\u8655\u7406(data handling)\u7684\u65b9\u6cd5(methods)\u9019\u65b9\u9762,<code>Streams</code>(\u4e32\u6d41)\u57fa\u672c\u4e0a\u63d0\u4f9b\u4e86\u4ee5\u4e0b2\u500b\u4e3b\u8981(major)\u7684\u512a\u9ede(advantages)<ul> <li>\u8a18\u61b6\u9ad4\u6548\u7387(Memory efficiency): \u7576\u6211\u5011\u8655\u7406(process)\u8cc7\u6599\u6642,\u4e0d\u9700\u8981\u4e8b\u5148(before)\u5c07\u5927\u91cf\u7684\u8cc7\u6599(large amounts of data)\u8b80\u53d6(load)\u5230\u8a18\u61b6\u9ad4\u4e2d(in memory)</li> <li>\u6642\u9593\u6548\u7387(Time efficiency): \u958b\u59cb\u8655\u7406(processing)\u8cc7\u6599(data)\u7684\u524d\u7f6e\u6642\u9593\u7e2e\u77ed(less time)\u3002\u5f9e(since)\u6211\u5011\u64c1\u6709\u8cc7\u6599\u5f8c,\u6211\u5011\u5c31\u53ef\u4ee5\u76f4\u63a5\u9032\u884c\u8655\u7406,\u800c\u4e0d\u662f(rather than)\u7b49\u5f85\u6574\u500b\u8cc7\u6599\u8ca0\u8f09(data payload)\u70ba\u53ef\u7528(available)\u7684\u6642\u5019\u624d\u80fd\u958b\u59cb\u8655\u7406</li> </ul> </li> <li>\u4e00\u500b<code>streams</code>(\u4e32\u6d41)\u7684\u7bc4\u4f8b (An example of stream)</li> <li>\u6709\u4e00\u500b\u5178\u578b\u7684\u7bc4\u4f8b\u5c31\u662f\u5f9e\u786c\u789f(disk)\u8b80\u53d6\u8cc7\u6599(reading file)</li> <li>\u5229\u7528Node\u7684<code>fs</code>\u6a21\u7d44,\u6211\u5011\u53ef\u4ee5\u8b80\u53d6\u4e00\u500b\u6a94\u6848,\u4e26\u5728\u7576\u6709\u65b0\u88ab\u5efa\u7acb(established)\u7684\u9023\u7dda(connection)\u8207\u6211\u5011\u7684HTTP\u4f3a\u670d\u5668(server)\u9023\u7dda\u6642,\u63d0\u4f9b\u6587\u4ef6(serve it)       JavaScript<pre><code>const http = require('http')\nconst fs = require('fs')\n\nconst server = http.createServer(function(req, res) {\n  fs.readFile(__dirname + '/data.txt', (err, data) =&gt; {\n    res.end(data)\n  })\n})\nserver.listen(3000)\n</code></pre><ul> <li>fs.readFile(path[, options], callback): \u6b64\u65b9\u6cd5\u6703\u8b80\u53d6(reads)\u6574\u500b\u6a94\u6848\u5167\u5bb9(full contents of the file),\u7576\u6b64\u65b9\u6cd5\u5b8c\u6210\u6642,\u6703\u547c\u53eb(invokes)\u56de\u547c\u51fd\u5f0f(callback)</li> <li>response.end([data[, encoding]][, callback]): \u6b64\u65b9\u6cd5\u6703\u56de\u50b3(return)\u6574\u500b\u6a94\u6848\u5167\u5bb9(full contents)\u7d66HTTP\u5ba2\u6236\u7aef(client)</li> <li>\u5982\u679c\u9019\u500b\u6a94\u6848\u5f88\u5927\u7684\u8a71,\u6b64\u64cd\u4f5c\u6703\u5c07\u82b1\u8cbb\u5927\u91cf\u7684\u6642\u9593</li> </ul> </li> <li>\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u662f\u7528<code>streams</code>(\u4e32\u6d41)\u4f86\u5b8c\u6210\u540c\u6a23\u7684\u4e8b\u60c5       JavaScript<pre><code>const http = require('http')\nconst fs = require('fs')\n\nconst server = http.createServer((req, res) =&gt; {\n  const stream = fs.createReadStream(__dirname + '/data.txt')\n  stream.pipe(res)\n})\nserver.listen(3000)\n</code></pre><ul> <li>\u6211\u5011\u6c92\u6709\u7b49\u5f85\u6574\u500b\u6a94\u6848\u88ab\u5b8c\u5168\u8b80\u53d6(fully read),\u800c\u662f\u7576\u6211\u5011\u6709\u5df2\u7d93\u6e96\u5099\u597d(ready)\u7684\u5927\u91cf\u6578\u64da(a chunk of data)\u8981\u88ab\u50b3\u9001\u6642,\u5c31\u53ef\u4ee5\u7acb\u5373\u958b\u59cb\u5229\u7528\u4e32\u6d41(streaming)\u7684\u65b9\u5f0f\u50b3\u8f38\u5230HTTP\u5ba2\u6236\u7aef(client)</li> </ul> </li> <li>readable.pipe(destination[, options])\u65b9\u6cd5\u7684\u4ecb\u7d39</li> <li>\u4e0a\u9762\u7684\u7bc4\u4f8b\u4f7f\u7528<code>stream.pipe(res)</code>\u65b9\u6cd5,\u800c\u9019\u500b\u65b9\u6cd5(method)\u6703\u5728\u6a94\u6848\u4e32\u6d41(file stream)\u4e0a\u88ab\u547c\u53eb(called)</li> <li>\u9019\u500b\u65b9\u6cd5\u662f\u7528\u4f86\u505a\u4ec0\u9ebc\u7684? \u5b83\u6703\u7372\u5f97(takes)\u6d88\u606f\u4f86\u6e90(source),\u4e26\u7528\u7ba1\u9053(<code>pipe</code>)\u7684\u65b9\u5f0f\u4f86\u50b3\u9001\u5230\u76ee\u7684\u5730(destination)</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u5728\u6d88\u606f\u4f86\u6e90\u4e32\u6d41(source stream)\u4e0a\u547c\u53eb(call)<code>stream.pipe(res)</code>\u9019\u500b\u65b9\u6cd5,\u56e0\u6b64\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b,\u6a94\u6848\u901a\u5e38\u6703\u88ab\u7528\u7ba1\u9053(<code>pipe</code>)\u7684\u65b9\u5f0f\u4f86\u50b3\u9001\u5230HTTP\u7684\u56de\u61c9\u7269\u4ef6(<code>response</code>)\u4e2d</li> <li><code>stream.pipe(res)</code>\u9019\u500b\u65b9\u6cd5\u56de\u50b3\u7684\u503c\u5c31\u662f\u76ee\u7684\u5730\u4e32\u6d41(destination stream),\u800c\u5b83\u662f\u4e00\u500b\u975e\u5e38\u65b9\u4fbf(convenient)\u7684\u6771\u897f\u4f86\u8b93\u6211\u5011\u53ef\u4ee5\u4e32\u9023(chain)\u591a\u500b(multiple)\u7ba1\u9053(<code>pipe</code>)\u547c\u53eb(calls)       JavaScript<pre><code>src.pipe(dest1).pipe(dest2)\n</code></pre><ul> <li>\u4ee5\u4e0a\u505a\u6cd5\u7684\u69cb\u60f3(construct)\u6703\u8ddf\u4ee5\u4e0b\u9019\u7a2e\u65b9\u5f0f\u662f\u76f8\u540c\u7684   JavaScript<pre><code>src.pipe(dest1)\ndest1.pipe(dest2)\n</code></pre></li> </ul> </li> <li>\u5229\u7528\u4e32\u6d41\u9a45\u52d5\u7684Node APIs (Streams-powered Node.js APIs)</li> <li>\u56e0\u70ba\u9019\u4e9b\u512a\u9ede(advantages),\u8a31\u591aNode\u7684\u5167\u5efa\u6838\u5fc3\u6a21\u7d44(core module)\u90fd\u6709\u63d0\u4f9b(provide)\u539f\u751f(native)\u7684\u4e32\u6d41(<code>stream</code>)\u8655\u7406(handling)\u80fd\u529b(capabilities),\u5c24\u5176(notably)\u662f\u4ee5\u4e0b\u5e7e\u7a2e\u65b9\u5f0f<ul> <li>process.stdin: \u6b64\u5c6c\u6027\u6703\u56de\u50b3(returns)\u4e00\u500b<code>streams</code>(\u4e32\u6d41)\u4f86\u9023\u63a5(connected)\u5230\u6a19\u6e96\u8f38\u5165(<code>stdin</code>)</li> <li>process.stdout: \u6b64\u5c6c\u6027\u6703\u56de\u50b3(returns)\u4e00\u500b<code>streams</code>(\u4e32\u6d41)\u4f86\u9023\u63a5(connected)\u5230\u6a19\u6e96\u8f38\u51fa(<code>stdout</code>)</li> <li>process.stderr: \u6b64\u5c6c\u6027\u6703\u56de\u50b3(returns)\u4e00\u500b<code>streams</code>(\u4e32\u6d41)\u4f86\u9023\u63a5(connected)\u5230\u6a19\u6e96\u932f\u8aa4(<code>stderr</code>)</li> <li>fs.createReadStream(path[, options]): \u6b64\u65b9\u6cd5\u6703\u5efa\u7acb(creates)\u4e00\u500b\u53ef\u8b80\u53d6(readable)\u7684\u6a94\u6848\u4e32\u6d41(stream to a file)</li> <li>fs.createWriteStream(path[, options]): \u6b64\u65b9\u6cd5\u6703\u5efa\u7acb(creates)\u4e00\u500b\u53ef\u5beb\u5165(writable)\u7684\u6a94\u6848\u4e32\u6d41(stream to a file)</li> <li>net.connect(): \u6b64\u65b9\u6cd5\u6703\u958b\u59cb(initiates)\u4e00\u500b\u4ee5<code>streams</code>\u70ba\u57fa\u790e(stream-based)\u7684\u9023\u7dda(connection)</li> <li>http.request(url[, options][, callback]): \u6b64\u65b9\u6cd5\u6703\u56de\u50b3(returns)\u4e00\u500b<code>http.ClientRequest</code>\u985e\u5225(class)\u7684\u5be6\u4f8b(instance),\u800c\u9019\u500b\u5be6\u4f8b\u6703\u662f\u4e00\u500b\u53ef\u5beb\u5165(writable)\u7684\u4e32\u6d41(<code>stream</code>)</li> <li>zlib.createGzip([options]): \u6b64\u65b9\u6cd5\u6703\u5229\u7528<code>gzip</code>\u9019\u7a2e\u58d3\u7e2e\u6f14\u7b97\u6cd5(compress algorithm)\u4f86\u5c07\u8cc7\u6599(data)\u58d3\u7e2e(compress)\u9032<code>streams</code>(\u4e32\u6d41)\u88e1\u9762(into)</li> <li>zlib.createGunzip([options]): \u6b64\u65b9\u6cd5\u6703\u89e3\u58d3\u7e2e(decompress)\u4e00\u500b<code>gzip</code>\u4e32\u6d41(<code>stream</code>)</li> <li>zlib.createDeflate([options]): \u6b64\u65b9\u6cd5\u6703\u5229\u7528<code>deflate</code>\u9019\u7a2e\u58d3\u7e2e\u6f14\u7b97\u6cd5(compress algorithm)\u4f86\u5c07\u8cc7\u6599(data)\u58d3\u7e2e(compress)\u9032<code>streams</code>(\u4e32\u6d41)\u88e1\u9762(into)</li> <li>zlib.createInflate([options]): \u6b64\u65b9\u6cd5\u6703\u89e3\u58d3\u7e2e(decompress)\u4e00\u500b<code>deflate</code>\u4e32\u6d41(<code>stream</code>)</li> </ul> </li> <li>\u4e0d\u540c\u985e\u578b\u7684\u4e32\u6d41(<code>stream</code>) (Different types of streams)</li> <li>\u4e32\u6d41(<code>stream</code>)\u6703\u6709\u4ee5\u4e0b4\u7a2e\u985e\u5225(classes)<ul> <li><code>Readable</code>: \u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u662f\u4e00\u500b\u6211\u5011\u53ef\u4ee5\u900f\u904e\u7ba1\u9053\u50b3\u51fa(pipe from),\u800c\u4e0d\u80fd\u50b3\u5165(pipe into)\u7684<code>stream</code>(\u4e32\u6d41); \u4e5f\u5c31\u662f\u8aaa,\u6211\u5011\u53ef\u4ee5\u5229\u7528\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u4f86\u63a5\u6536\u8cc7\u6599(receive data),\u800c\u4e0d\u80fd\u50b3\u9001\u8cc7\u6599(send data)\u7d66\u5b83\u3002\u7576\u6211\u5011\u63a8\u9001(push)\u8cc7\u6599(data)\u9032\u5165(into)\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u6642,\u9019\u4e9b\u8cc7\u6599\u662f\u7de9\u5b58(buffered)\u7684,\u76f4\u5230(until)\u4f7f\u7528\u8005(consumer)\u958b\u59cb\u8b80\u53d6(starts to read)\u9019\u4e9b\u8cc7\u6599(data)</li> <li><code>Writable</code>: \u53ef\u5beb\u5165\u4e32\u6d41(writable stream)\u662f\u4e00\u500b\u6211\u5011\u53ef\u4ee5\u900f\u904e\u7ba1\u9053\u50b3\u5165(pipe into),\u800c\u4e0d\u80fd\u50b3\u51fa(pipe from)\u7684<code>stream</code>(\u4e32\u6d41); \u4e5f\u5c31\u662f\u8aaa,\u6211\u5011\u53ef\u4ee5\u5229\u7528\u53ef\u5beb\u5165\u4e32\u6d41(writable stream)\u4f86\u50b3\u9001\u8cc7\u6599(send data),\u800c\u4e0d\u80fd\u50b3\u5165\u8cc7\u6599(receive data)\u7d66\u5b83\u3002</li> <li><code>Duplex</code>: \u96d9\u5411\u4e32\u6d41(duplex stream)\u662f\u4e00\u500b\u65e2\u80fd\u63a5\u53d7\u6211\u5011\u900f\u904e\u7ba1\u9053\u50b3\u5165(pipe into),\u4e5f\u80fd\u63a5\u53d7\u6211\u5011\u900f\u904e\u7ba1\u9053\u50b3\u51fa(pipe from)\u3002\u57fa\u672c\u4e0a\u4f86\u8aaa(basically),\u5c31\u662f\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream) &amp; \u53ef\u5beb\u5165\u4e32\u6d41(writable stream)\u7684\u7d50\u5408(combination)</li> <li><code>Transform</code>: \u8f49\u63db\u4e32\u6d41(transform stream)\u985e\u4f3c\u65bc\u96d9\u5411\u4e32\u6d41(duplex stream),\u4f46\u662f\u8f49\u63db\u4e32\u6d41(transform stream)\u7684\u8f38\u51fa(output)\u662f\u5b83\u7684\u8f38\u5165(its input)\u7684\u8f49\u63db(transform)</li> </ul> </li> <li>\u5982\u4f55\u5efa\u7acb\u4e00\u500b\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)? (How to create a readable stream)</li> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904eNode\u7684<code>Stream</code>\u5167\u5efa\u6838\u5fc3\u6a21\u7d44\u4f86\u7372\u5f97(get)\u4e00\u500b\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream),\u63a5\u8457\u6211\u5011\u518d\u521d\u59cb\u5316(initialize)\u5b83\u4e26\u4e14\u5be6\u4f5c(implement)\u5b83\u7684readable._read(size)\u65b9\u6cd5(method)</li> <li>\u9996\u5148,\u6211\u5011\u5148\u5efa\u7acb(create)\u4e00\u500b\u4e32\u6d41\u7269\u4ef6(stream object)       JavaScript<pre><code>const Stream = require('stream')\nconst readableStream = new Stream.Readable()\n</code></pre></li> <li>\u63a5\u8457,\u5be6\u4f5c(implement)\u5b83\u7684readable._read(size)\u65b9\u6cd5(method)       JavaScript<pre><code>readableStream._read = () =&gt; {}\n</code></pre></li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u5229\u7528<code>read</code>\u9019\u500b\u9078\u9805(option)\u4f86\u5be6\u4f5c(implement)<code>readable._read(size)</code>\u65b9\u6cd5(method)       JavaScript<pre><code>const readableStream = new Stream.Readable({\n  read() {}\n})\n</code></pre></li> <li>\u73fe\u5728(Now),<code>stream</code>(\u4e32\u6d41)\u662f\u88ab\u521d\u59cb\u5316\u904e\u5f8c(initialized)\u7684,\u6211\u5011\u53ef\u4ee5\u50b3\u9001\u8cc7\u6599(send data)\u7d66\u5b83       JavaScript<pre><code>readableStream.push('hi!')\nreadableStream.push('ho!')\n</code></pre></li> <li>\u5982\u4f55\u5efa\u7acb\u4e00\u500b\u53ef\u5beb\u5165\u4e32\u6d41(writable stream)? (How to create a writable stream)</li> <li>\u70ba\u4e86\u5efa\u7acb(create)\u51fa\u4e00\u500b\u53ef\u5beb\u5165\u4e32\u6d41(writable stream),\u6211\u5011\u5148\u7e7c\u627f(extend)\u57fa\u790e(base)Writable\u7269\u4ef6(object),\u63a5\u8457\u6211\u5011\u6703\u5be6\u4f5c(implement)\u9019\u500b<code>Writable</code>\u7269\u4ef6\u7684writable._write(chunk, encoding, callback)\u65b9\u6cd5(method)</li> <li>\u9996\u5148,\u6211\u5011\u5148\u5efa\u7acb(create)\u4e00\u500b\u4e32\u6d41\u7269\u4ef6(stream object)       JavaScript<pre><code>const Stream = require('stream')\nconst writableStream = new Stream.Writable()\n</code></pre></li> <li>\u63a5\u8457,\u5be6\u4f5c(implement)\u5b83\u7684writable._write(chunk, encoding, callback)\u65b9\u6cd5(method)       JavaScript<pre><code>writableStream._write = (chunk, encoding, next) =&gt; {\n  console.log(chunk.toString())\n  next()\n}\n</code></pre></li> <li>\u73fe\u5728(Now),\u6211\u5011\u5c31\u53ef\u4ee5\u900f\u904e\u7ba1\u9053\u50b3\u5165(pipe into)\u4e00\u500b\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u9032\u53bb       JavaScript<pre><code>process.stdin.pipe(writableStream)\n</code></pre></li> <li>\u5982\u4f55\u5f9e\u53ef\u8b80\u53d6\u4e32\u6d41\u4e2d(readable stream)\u7372\u5f97\u8cc7\u6599? (How to get data from a readable stream?)</li> <li><code>Question</code>: \u6211\u5011\u8a72\u5982\u4f55\u5f9e\u53ef\u8b80\u53d6\u4e32\u6d41\u4e2d(readable stream)\u7372\u5f97\u8cc7\u6599\u5462?<ul> <li><code>Answer</code>: \u5229\u7528\u53ef\u5beb\u5165\u4e32\u6d41(writable stream)   JavaScript<pre><code>const Stream = require('stream')\n\nconst readableStream = new Stream.Readable({\n  read() {}\n})\nconst writableStream = new Stream.Writable()\n\nwritableStream._write = (chunk, encoding, next) =&gt; {\n  console.log(chunk.toString())\n  next()\n}\n\nreadableStream.pipe(writableStream)\n\nreadableStream.push('hi!')\nreadableStream.push('ho!')\n</code></pre></li> </ul> </li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5730(directly)\u6d88\u8017(consume)\u4e00\u500b\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream),\u53ef\u5229\u7528<code>readable</code>\u4e8b\u4ef6(event)       JavaScript<pre><code>readableStream.on('readable', () =&gt; {\n  console.log(readableStream.read())\n})\n</code></pre></li> <li>\u5982\u4f55\u50b3\u9001\u8cc7\u6599\u7d66\u53ef\u5beb\u5165\u4e32\u6d41(writable stream)? (How to send data to a writable stream)</li> <li>\u53ef\u5229\u7528writable.write(chunk[, encoding][, callback])\u65b9\u6cd5(method)       JavaScript<pre><code>writableStream.write('hey!\\n')\n</code></pre></li> <li>\u7576\u6211\u5011\u7d50\u675f\u5beb\u5165\u64cd\u4f5c\u6642,\u8a72\u5982\u4f55\u5c0d\u53ef\u5beb\u5165\u4e32\u6d41(writable stream)\u767c\u9001\u4e00\u500b\u4fe1\u865f\u5462? (Signaling a writable stream that you ended writing)</li> <li>\u53ef\u5229\u7528writable.end([chunk[, encoding]][, callback])\u65b9\u6cd5(method)       JavaScript<pre><code>const Stream = require('stream')\n\nconst readableStream = new Stream.Readable({\n  read() {}\n})\nconst writableStream = new Stream.Writable()\n\nwritableStream._write = (chunk, encoding, next) =&gt; {\n  console.log(chunk.toString())\n  next()\n}\n\nreadableStream.pipe(writableStream)\n\nreadableStream.push('hi!')\nreadableStream.push('ho!')\n\nwritableStream.end()\n</code></pre></li> </ul>"},{"location":"programming_language/nodejs/#nodejs-the-difference-between-development-and-production","title":"Node.js, the difference between development and production","text":"<ul> <li>\u6211\u5011\u53ef\u4ee5\u5c0d\u751f\u7522\u74b0\u5883(production environment)\u3001\u958b\u767c\u74b0\u5883(development environment)\u505a\u4e0d\u540c\u7684\u8a2d\u5b9a(configurations)</li> <li>Node\u6703\u5047\u8a2d(assumes)\u6211\u5011\u7e3d\u662f\u5728\u958b\u767c\u74b0\u5883\u4e2d(development environment)\u57f7\u884c\u3002\u9019\u6642,\u6211\u5011\u53ef\u4ee5\u900f\u904e\u8a2d\u5b9aNode\u7684\u74b0\u5883\u8b8a\u6578(environment variable)\u70ba\"\u751f\u7522\u74b0\u5883(production environment)\",\u4f86\u5411Node\u767c\u51fa\u6211\u5011\u5728\u751f\u7522\u74b0\u5883\u57f7\u884c(running)\u61c9\u7528\u7a0b\u5f0f\u7684\u4fe1\u865f(signal)</li> <li><code>bash       export NODE_ENV=production</code><ul> <li>\u4ee5\u4e0a\u7684\u6307\u4ee4\u662f\u5728<code>shell</code>\u4e2d\u57f7\u884c\u7684,\u4f46\u662f\u6700\u597d\u5c07\u9019\u500b\u6307\u4ee4\u52a0\u5230\u6211\u5011\u7684<code>shell</code>\u8a2d\u5b9a\u6a94(\u4f8b: <code>.bash_profile</code>)\u4e2d,\u5426\u5247\u7576\u6211\u5011\u91cd\u958b\u6a5f(system restart)\u6642,\u5728\u7d42\u7aef\u6a5f\u4e0a\u57f7\u884c\u6307\u4ee4\u6240\u7522\u751f\u7684Node\u74b0\u5883\u8b8a\u6578\u8a2d\u5b9a\u5c31\"\u4e0d\u6703\"\u88ab\u4fdd\u7559(not persist)</li> </ul> </li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u7684\u53e6\u4e00\u7a2e\u65b9\u5f0f\u4f86\u8a2d\u5b9aNode\u74b0\u5883\u8b8a\u6578(environment variable),\u5c31\u662f\u5728\u57f7\u884cNode\u61c9\u7528\u7a0b\u5f0f\u521d\u59cb\u5316(initialization)\u7684\u6307\u4ee4(command)\u524d\u9762,\u524d\u7db4(prepending)Node\u74b0\u5883\u8b8a\u6578</li> <li><code>console       NODE_ENV=production node app.js</code></li> <li>Node\u74b0\u5883\u8b8a\u6578\u7684\u8a2d\u5b9a\u662f\u4e00\u7a2e\u6163\u4f8b(convention),\u4e5f\u88ab\u5ee3\u6cdb(widely)\u5730\u88ab\u4f7f\u7528(used in)\u5728\u5916\u90e8\u51fd\u5f0f\u5eab(external libraries)\u4e2d</li> <li>\u5c07Node\u74b0\u5883\u8b8a\u6578\u8a2d\u5b9a\u70ba \u751f\u7522\u74b0\u5883 ,\u901a\u5e38(generally)\u53ef\u78ba\u4fdd(ensures)\u4ee5\u4e0b2\u4ef6\u4e8b\u60c5</li> <li>\u65e5\u8a8c\u8a18\u9304(logging)\u4fdd\u6301(kept)\u5728\u6700\u5c11(minimum)\u3001\u6700\u5fc5\u8981(essential)\u7684\u6c34\u5e73(level)</li> <li>\u6703\u767c\u751f(take place)\u66f4\u591a\u7684\u7de9\u5b58\u7d1a\u5225(caching levels),\u4ee5\u512a\u5316(optimize)\u6548\u80fd(performance)</li> <li>\u8209\u4f8b\u4f86\u8aaa,Express\u6240\u4f7f\u7528\u7684\u6a21\u677f\u51fd\u5f0f\u5eab(templating library)---&gt;pug,\u6703\u5728\u7576Node\u74b0\u5883\u8b8a\u6578 \u4e0d\u662f \u88ab\u8a2d\u5b9a\u70ba\u751f\u7522\u74b0\u5883(<code>production</code>)\u6642,\u5c31\u6703\u4ee5\u9664\u932f\u6a21\u5f0f(in debug mode)\u4f86\u7de8\u8b6f(compiles)</li> <li>\u5728\u958b\u767c\u6a21\u5f0f(development mode)\u4e2d,<code>Express</code>\u7684<code>views</code>\u6703\u5728\u6bcf\u6b21(every)\u8acb\u6c42(<code>request</code>)\u6642\u88ab\u7de8\u8b6f(compiled); \u7136\u800c\u7576\u5728\u751f\u7522\u6a21\u5f0f(production mode)\u4e2d,\u5247\u6703\u5c07\u5176\u7de9\u5b58(cached)\u3002\u4ee5\u4e0b\u6703\u6709\u66f4\u591a\u7684\u7bc4\u4f8b(examples)</li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528\u689d\u4ef6\u9673\u8ff0\u53e5(conditional statements)\u4f86\u5207\u63db\u5728\u4e0d\u540c\u74b0\u5883(in different environments)\u4e2d\u57f7\u884c(execute)\u7a0b\u5f0f\u78bc       JavaScript<pre><code>if (process.env.NODE_ENV === \"development\") {\n  //...\n}\nif (process.env.NODE_ENV === \"production\") {\n  //...\n}\nif(['production', 'staging'].indexOf(process.env.NODE_ENV) &gt;= 0) {\n  //...\n})\n</code></pre></li> <li>\u8209\u4f8b\u4f86\u8aaa,\u5728<code>Express</code>\u6846\u67b6\u61c9\u7528\u7a0b\u5f0f(app)\u4e2d,\u6211\u5011\u53ef\u4ee5\u5229\u7528\u689d\u4ef6\u9673\u8ff0\u53e5(conditional statements)\u4f86\u91dd\u5c0d\u6bcf\u500b\u74b0\u5883(per environment)\u8a2d\u5b9a(set)\u4e0d\u540c\u7684\u932f\u8aa4\u8655\u7406\u5668(error handler)       JavaScript<pre><code>if (process.env.NODE_ENV === \"development\") {\n  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }))\n})\n\nif (process.env.NODE_ENV === \"production\") {\n  app.use(express.errorHandler())\n})\n</code></pre></li> </ul>"},{"location":"programming_language/nodejs/#error-handling-in-nodejs","title":"Error handling in Node.js","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Errors</p> <ul> <li>\u5728Node\u4e2d,\u662f\u900f\u904e(through)\u4f8b\u5916(<code>exceptions</code>)\u4f86\u8655\u7406(handled)\u932f\u8aa4(errors)\u7684</li> <li>\u5efa\u7acb\u4e00\u500b\u4f8b\u5916 (Creating exceptions)</li> <li>\u8981\u5efa\u7acb\u4e00\u500b\u4f8b\u5916,\u53ef\u4ee5\u900f\u904e\u62cb\u51fa(<code>throw</code>)\u95dc\u9375\u5b57(keyword)       JavaScript<pre><code>throw value\n</code></pre></li> <li>\u4e00\u65e6Javascript\u57f7\u884c(executes)\u5230\u6b64\u884c(this line)\u6307\u4ee4,\u6b63\u5e38(normal)\u7684\u7a0b\u5f0f\u6d41\u7a0b(program flow)\u5c31\u6703\u88ab\u505c\u6b62(halted),\u4e26\u4e14\u7a0b\u5f0f\u7684\u63a7\u5236\u6b0a(control)\u6703\u88ab\u4fdd\u7559(held back)\u7d66\u6700\u8fd1(nearest)\u7684\u4f8b\u5916\u8655\u7406\u5668(<code>exception handler</code>)<ul> <li>\u901a\u5e38,\u5728\u5ba2\u6236\u7aef(client-side)\u7684\u7a0b\u5f0f\u78bc(code)\u4e2d,\u4ee5\u4e0a\u7bc4\u4f8b\u4e2d\u7684<code>value</code>\u53ef\u4ee5\u662f\u4efb\u4f55(any)Javascript\u7684\u503c,\u5305\u542b\u4e00\u500b\u5b57\u4e32(<code>string</code>)\u3001\u6578\u5b57(<code>number</code>)\u3001\u6216\u662f\u7269\u4ef6(<code>object</code>)</li> <li>\u5728Node\u4e2d,\u6211\u5011\"\u4e0d\u6703\"\u62cb\u51fa(throw)\u5b57\u4e32(strings),\u6211\u5011\u53ea\u6703\u62cb\u51fa(throw)\u932f\u8aa4\u7269\u4ef6(<code>Error</code> objects)</li> </ul> </li> <li>\u932f\u8aa4\u7269\u4ef6 (Error objects)</li> <li>\u5728Node\u4e2d,\u932f\u8aa4\u7269\u4ef6(<code>error</code> object)\u53ef\u4ee5\u662f\u4e00\u500b\u932f\u8aa4\u7269\u4ef6(<code>Error</code> object)\u7684\u5be6\u4f8b(instance),\u6216\u662f\u7e7c\u627f(extends)\u81eaNode\u7684<code>Errors</code>\u5167\u5efa\u6838\u5fc3\u6a21\u7d44\u5167\u6240\u63d0\u4f9b(provided)\u7684\u932f\u8aa4\u985e\u5225(<code>Error</code> class)\u7684\u7269\u4ef6(object)       JavaScript<pre><code>throw new Error('Ran out of coffee')\n</code></pre><ul> <li>\u6216\u662f   JavaScript<pre><code>class NotEnoughCoffeeError extends Error {\n  //...\n}\nthrow new NotEnoughCoffeeError()\n</code></pre></li> </ul> </li> <li>\u8655\u7406\u4f8b\u5916 (Handling exceptions)</li> <li>\u4e00\u500b\u4f8b\u5916\u8655\u7406\u5668(exception handler)\u5c31\u662f<code>try/catch</code>\u9673\u8ff0\u53e5(statement)</li> <li>\u4efb\u4f55\u5305\u5728(included)<code>try</code>\u5340\u584a(block)\u5167\u7684\u7a0b\u5f0f\u78bc\u6240\u5f15\u767c(raised in)\u7684\u4f8b\u5916(exception),\u90fd\u6703\u5728\u5176\u76f8\u5c0d\u61c9(corresponding)\u7684<code>catch</code>\u5340\u584a(block)\u4e2d\u88ab\u8655\u7406(handled)       JavaScript<pre><code>try {\n  //lines of code\n} catch (e) {}\n</code></pre><ul> <li>\u5728\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,<code>e</code>\u5c31\u662f\u4f8b\u5916\u503c(<code>exception</code> value)\u3002\u6211\u5011\u53ef\u4ee5\u5728<code>catch</code>\u5340\u584a(block)\u4e2d\u65b0\u589e(add)\u591a\u500b(multiple)\u932f\u8aa4\u8655\u7406\u5668(handlers),\u9019\u4e9b\u932f\u8aa4\u8655\u7406\u5668\u5c31\u53ef\u4ee5\u7528\u4f86\u6355\u7372(<code>catch</code>)\u5404\u7a2e\u4e0d\u540c\u7684\u932f\u8aa4(different kinds of errors)</li> </ul> </li> <li>\u6355\u7372\u672a\u6355\u7372\u7684\u4f8b\u5916 (Catching uncaught exceptions)</li> <li>\u7576\u7a0b\u5f0f(program)\u6b63\u5728\u57f7\u884c\u4e2d\u6642,\u5982\u679c\u5728\u7a0b\u5f0f\u4e2d\u6709\u672a\u6355\u7372\u7684\u4f8b\u5916(uncaught exception)\u88ab\u62cb\u51fa(thrown)\u6642,\u6211\u5011\u7684\u7a0b\u5f0f\u5c07\u6703\u5d29\u6f70(crash)</li> <li>\u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c,\u6211\u5011\u53ef\u4ee5\u76e3\u807d<code>process</code>\u7269\u4ef6\u4e0a\u7684uncaughtException\u4e8b\u4ef6       JavaScript<pre><code>process.on('uncaughtException', err =&gt; {\n  console.error('There was an uncaught error', err)\n  process.exit(1) //mandatory (as per the Node.js docs)\n})\n</code></pre><ul> <li>\u6211\u5011\u4e0d\u9700\u8981\u70ba\u6b64\u4e8b\u5148\u532f\u5165(import)Node\u7684<code>process</code>\u5167\u5efa\u6838\u5fc3\u6a21\u7d44(core module),\u56e0\u70ba<code>process</code>\u6a21\u7d44\u662fNode\u6703\u81ea\u52d5(automatically)\u6ce8\u5165(injected)\u7684</li> </ul> </li> <li><code>Promise</code>\u7269\u4ef6\u7684\u4f8b\u5916 (Exceptions with promises)</li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528<code>Promise</code>\u7269\u4ef6\u4f86\u4e32\u9023(chain)\u4e0d\u540c\u7684\u64cd\u4f5c(different operations),\u4e26\u4e14\u5728\u6700\u5f8c(at the end)\u8655\u7406\u932f\u8aa4(handle errors) JavaScript<pre><code>doSomething1()\n  .then(doSomething2)\n  .then(doSomething3)\n  .catch(err =&gt; console.error(err))\n</code></pre></li> <li>\u90a3\u6211\u5011\u8a72\u600e\u9ebc\u77e5\u9053\u932f\u8aa4(<code>error</code>)\u662f\u5728\u54ea\u88e1\u767c\u751f(occured)\u7684\u5462? \u5176\u5be6\u6211\u5011\u4e26\u4e0d\u9700\u8981\u771f\u7684(really)\u77e5\u9053\u9019\u4ef6\u4e8b,\u6211\u5011\u53ef\u4ee5\u5728\u6bcf\u500b(each)\u88ab\u547c\u53eb(call)\u7684\u51fd\u5f0f(functions)\u4e2d,\u90fd\u8655\u7406(handle)\u932f\u8aa4(error)(=&gt; \u4e5f\u5c31\u662f\u4ee5\u4e0a\u7bc4\u4f8b\u4e2d\u7684<code>doSomethingX</code>),\u4e26\u4e14\u5728\u932f\u8aa4\u8655\u7406\u5668\u4e2d(inside the <code>error</code> handler)\u62cb\u51fa(throw)\u4e00\u500b\u932f\u8aa4(<code>error</code>),\u800c\u9019\u500b\u88ab\u62cb\u51fa\u7684\u932f\u8aa4\u6703\u88ab\u7528\u4f86\u547c\u53eb(call)\u5916\u9762(outside)\u7684<code>catch</code>\u932f\u8aa4\u8655\u7406\u5668(handler)       JavaScript<pre><code>const doSomething1 = () =&gt; {\n  //...\n  try {\n    //...\n  } catch (err) {\n    //... handle it locally\n    throw new Error(err.message)\n  }\n  //...\n}\n</code></pre></li> <li>\u70ba\u4e86\u80fd\u5920(be able to)\u5728\u672c\u5730(locally)\u8655\u7406\u932f\u8aa4(handler <code>errors</code>)\u800c\u4e0d\u7528(without)\u5728\u6211\u5011\u547c\u53eb(call)\u51fd\u5f0f(function)\u6642\u624d\u8655\u7406(handling),\u6211\u5011\u53ef\u4ee5\u8df3\u51fa(break)\u4e32\u9023(chain),\u4e26\u4e14\u900f\u904e\u5728\u6bcf\u500b(each)<code>then()</code>\u51fd\u5f0f\u5f8c\u9762\u5efa\u7acb(create)\u4e00\u500b\u51fd\u5f0f(function)\u4f86\u8655\u7406(process)\u4f8b\u5916(exception)       JavaScript<pre><code>doSomething1()\n  .then(() =&gt; {\n    return doSomething2().catch(err =&gt; {\n      //handle error\n      throw err //break the chain!\n    })\n  })\n  .then(() =&gt; {\n    return doSomething2().catch(err =&gt; {\n      //handle error\n      throw err //break the chain!\n    })\n  })\n  .catch(err =&gt; console.error(err))\n</code></pre></li> <li>\u5229\u7528<code>async/await</code>\u8a9e\u6cd5\u4f86\u8655\u7406\u4f8b\u5916 (Error handling with async/await)</li> <li>\u6211\u5011\u53ef\u4ee5\u5229\u7528<code>async/await</code>\u8a9e\u6cd5\u4f86\u8655\u7406\u4f8b\u5916(exceptions),\u4f46\u6211\u5011\u4ecd\u7136\u9700\u8981\u6355\u6293(catch)\u932f\u8aa4(<code>errors</code>),\u6211\u5011\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u7684\u65b9\u5f0f(way)\u4f86\u5b8c\u6210     JavaScript<pre><code>async function someFunction() {\n  try {\n    await someOtherFunction()\n  } catch (err) {\n    console.error(err.message)\n  }\n}\n</code></pre></li> </ul>"},{"location":"programming_language/nodejs/#how-to-log-an-object-in-nodejs","title":"How to log an object in Node.js","text":"<p>Node\u5167\u5efa\u6838\u5fc3\u6a21\u7d44Console</p> <ul> <li>\u7576\u6211\u5011\u5728\u700f\u89bd\u5668(in the browser)\u7684Javascript\u7a0b\u5f0f\u78bc\u4e2d\u8f38\u5165(type)<code>console.log()</code>\u8a9e\u6cd5\u6642,\u5c31\u6703\u5728\u700f\u89bd\u5668\u5f8c\u53f0(browser console)\u5efa\u7acb(create)\u4e00\u500b\u6f02\u4eae(nice)\u7684\u689d\u76ee(entry)</li> <li></li> <li>\u7576\u6211\u5011\u9ede\u64ca(click)\u7bad\u982d(arrow)\u6642,\u65e5\u8a8c(log)\u5c31\u6703\u88ab\u5c55\u958b(expanded),\u9019\u6642\u6211\u5011\u5c31\u53ef\u4ee5\u6e05\u695a\u5730(clearly)\u770b\u5230\u7269\u4ef6(object)\u7684\u5c6c\u6027\u5011(properties)</li> <li></li> <li>\u5728Node\u4e2d,\u4e5f\u6703\u767c\u751f(happens)\u76f8\u540c(same)\u7684\u4e8b\u60c5</li> <li>\u7576\u6211\u5011\u8981\u8a18\u9304(log)\u67d0\u4e9b\u5167\u5bb9\u5230\u5f8c\u53f0(console)\u6642,\u4e26\u4e0d\u80fd\u90a3\u9ebc\u5962\u4f88\u7684(luxury)\u3002\u56e0\u70ba\u5982\u679c\u6211\u5011\u662f\u624b\u52d5(manually)\u57f7\u884c(run)Node\u7a0b\u5f0f(program)\u7684\u8a71,\u5b83\u5c07\u6703\u8f38\u51fa(output)\u65e5\u8a8c\u7269\u4ef6(object)\u5230<code>shell</code>\u6216\u662f\u5230\u65e5\u8a8c\u6a94\u6848(log file)\u4e2d\u3002\u9019\u6642,\u6211\u5011\u5c07\u6703\u5f97\u5230\u7269\u4ef6\u7684\u5b57\u4e32\u8868\u73fe\u5f62\u5f0f(string representation of the object)</li> <li>\u73fe\u5728,\u76f4\u5230(until)\u4e00\u5b9a\u7684(certain)\u5de2\u72c0\u7a0b\u5ea6\u7d1a\u5225(level of nesting)\u4e4b\u524d,\u4e00\u5207\u90fd\u662f\u5f88\u597d\u7684(fine)\u3002\u4f46\u662f,\u5f9e\u7b2c\u4e8c\u5c64(two levels of)\u7684\u5de2\u72c0\u7269\u4ef6\u7d50\u69cb(nesting)\u4ee5\u5f8c(after),Node\u5c31\u6703\u653e\u68c4(gives up)\u4e26\u4e14\u6253\u5370(print)\u51fa<code>[Object]</code>\u4f5c\u70ba\u4f54\u4f4d\u7b26(placeholder)     JavaScript<pre><code>const obj = {\n  name: 'joe',\n  age: 35,\n  person1: {\n    name: 'Tony',\n    age: 50,\n    person2: {\n      name: 'Albert',\n      age: 21,\n      person3: {\n        name: 'Peter',\n        age: 23\n      }\n    }\n  }\n}\nconsole.log(obj)\n\n\n{\n  name: 'joe',\n  age: 35,\n  person1: {\n    name: 'Tony',\n    age: 50,\n    person2: {\n      name: 'Albert',\n      age: 21,\n      person3: [Object]\n    }\n  }\n}\n</code></pre></li> <li>\u90a3\u9ebc,\u6211\u5011\u8a72\u5982\u4f55\u6253\u5370(print)\u51fa\u6574\u500b\u7269\u4ef6(whole object)\u5462?<ul> <li>\u6700\u4f73\u7684\u505a\u6cd5(best way)\u6703\u662f\u5728(while)\u7dad\u6301(preserving)\u6f02\u4eae\u7684\u6253\u5370(pretty print)\u8f38\u51fa\u7d50\u679c\u6642,\u540c\u6642\u4f7f\u7528Javascript\u53ef\u652f\u63f4\u7684JSON.stringify()\u65b9\u6cd5(method)     JavaScript<pre><code>console.log(JSON.stringify(obj, null, 2))\n</code></pre><ul> <li>\u9019\u500b<code>2</code>\u662f\u7528\u4f86\u4f5c\u70ba\u6307\u5b9a\u7e2e\u6392(indentation)\u7684\u7a7a\u683c\u6578(number of spaces)</li> </ul> </li> <li>\u53e6\u4e00\u500b\u53ef\u4f9b\u9078\u64c7(option)\u7684\u505a\u6cd5\u662f\b\u5229\u7528Node\u7684Utilities\u5167\u5efa\u6838\u5fc3\u6a21\u7d44\u4e2d\u7684util.inspect(object[, showHidden[, depth[, colors]]])\u65b9\u6cd5(method)</li> <li>\u9019\u500b\u65b9\u6cd5(method)\u53ef\u4ee5\u6307\u5b9a\u4ee5\u4e0b\u7684\u53c3\u6578\u5011<ul> <li><code>depth</code>(\u6df1\u5ea6): \u8981\u5c55\u958b\u5230\u9019\u500b\u7269\u4ef6\u7684\u7b2c\u5e7e\u5c64</li> <li>\u9810\u8a2d\u503c: <code>2</code></li> <li><code>colors</code>: \u53ef\u4ee5\u5ba2\u88fd\u5316\u5730\u8a2d\u5b9a\u6587\u5b57\u8f38\u51fa\u7684\u984f\u8272</li> </ul> </li> <li>\u4f46<code>util.inspect()</code>\u9019\u500b\u65b9\u6cd5\u6703\u9047\u5230\u7684\u554f\u984c\u662f,\u8d85\u904e(after)2\u5c64(level)\u4ee5\u4e0a\u7684\u5de2\u72c0\u7269\u4ef6(nested objects)\u6703\u88ab\u6524\u5e73(flattened),\u9019\u4e5f\u6703\u4f7f\u539f\u672c\u6709\u5c31\u6bd4\u8f03\u8907\u96dc(complex)\u7d50\u69cb\u7684\u7269\u4ef6(objects)\u6703\u8b8a\u5f97\u66f4\u8907\u96dc</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#nodejs-with-typescript","title":"Node.js with TypeScript","text":"<ul> <li>\u4ec0\u9ebc\u662f<code>Typescript</code>? (What is TypeScript)</li> <li><code>Typescript</code>\u662f\u4e00\u500b\u7531Microsoft\u958b\u767c\u8207\u7dad\u8b77\u7684\u958b\u6e90\u3001\u71b1\u9580\u7684\u7a0b\u5f0f\u8a9e\u8a00,\u5b83\u53d7\u5230\u5168\u4e16\u754c\u8a31\u591a\u8edf\u9ad4\u958b\u767c\u8005\u7684\u559c\u611b\u548c\u4f7f\u7528</li> <li>\u57fa\u672c\u4e0a(Basically), <code>Typescript</code>\u662fJavascript\u9019\u500b\u7a0b\u5f0f\u8a9e\u8a00\u7684\u4e00\u500b\u8d85\u96c6(<code>superset</code>) ,\u4e26\u65b0\u589e\u4e86\u4e00\u4e9b\u80fd\u529b(capabilities)\u7d66\u9019\u500b\u7a0b\u5f0f\u8a9e\u8a00\u3002\u6700\u8457\u540d(notable)\u7684\u65b0\u589e(addition)\u529f\u80fd\u5c31\u662f \u975c\u614b\u578b\u5225\u5b9a\u7fa9(static type definitions) ,\u800c\u9019\u662f\u4e00\u822c(plain)\u7684Javascript\u6240\u6c92\u6709\u7684\u529f\u80fd\u3002\u53d7\u578b\u5225(types)\u6240\u60e0,\u6211\u5011\u53ef\u4ee5\u5ba3\u544a(declare) \u6211\u5011\u9810\u671f\u4ec0\u9ebc\u5f62\u5f0f\u7684\u53c3\u6578 (what kind of arguments we are expecting)\u3001 \u51fd\u5f0f\u78ba\u5207\u6703\u56de\u50b3\u4ec0\u9ebc\u6771\u897f (what is returned exactly in our functions)\u3001 \u6211\u5011\u5efa\u7acb\u7684\u7269\u4ef6\u7684\u78ba\u5207\u6a23\u5b50 (what's the exact shape of the object that we are creating)</li> <li><code>Typescript</code>\u662f\u4e00\u500b\u975e\u5e38\u5f37\u5927(powerful)\u7684\u5de5\u5177(tool),\u4e26\u4e14\u5b83\u958b\u555f(opens)\u4e86Javascript\u5c08\u6848(project)\u53ef\u80fd\u6027(possibilites)\u7684\u65b0\u4e16\u754c(new world)\u3002\u5b83\u8b93\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u80fd\u5728\u63d0\u4ea4(before code is even shipped)\u4e4b\u524d\u66f4\u5b89\u5168(secure)\u3001\u7a69\u56fa(robust),\u7576(during)\u6211\u5011\u5728\u64b0\u5beb\u7a0b\u5f0f\u78bc\u6642,<code>Typescript</code>\u6703\u6355\u6293\u554f\u984c(catches problems),\u4e26\u6975\u597d\u5730(wonderfully)\u6574\u5408(integrates)\u5230\u7a0b\u5f0f\u78bc\u7de8\u8f2f\u5668(code editors)\u4e2d(\u4f8b: <code>Visual Studio Code</code>)</li> <li>\u6211\u5011\u53ef\u4ee5\u5728\u4e4b\u5f8c\u518d\u4f86\u8a0e\u8ad6(talk about)<code>Typescript</code>\u7684\u597d\u8655(benefits),\u73fe\u5728\u5148\u8b93\u6211\u5011\u5148\u770b\u770b\u4e00\u4e9b\u7bc4\u4f8b(examples)\u7a0b\u5f0f\u78bc\u5427</li> <li>\u77a7\u77a7\u4ee5\u4e0b\u7684\u7a0b\u5f0f\u78bc\u7247\u6bb5(code snippet),\u63a5\u8457\u6211\u5011\u5c31\u53ef\u4ee5\u5c07\u5b83\u5011\u62c6\u89e3(unpack)\u518d\u4e00\u8d77(together)\u4e86       JavaScript<pre><code>type User = {\n  name: string;\n  age: number;\n};\n\nfunction isAdult(user: User): boolean {\n  return user.age &gt;= 18;\n}\n\nconst justine: User = {\n  name: 'Justine',\n  age: 23,\n};\n\nconst isJustineAnAdult: boolean = isAdult(justine);\n</code></pre><ul> <li>\u9996\u5148,<code>type</code>\u95dc\u9375\u5b57\u7684\u7b2c\u4e00\u90e8\u4efd\u8ca0\u8cac(responsible)\u5ba3\u544a(declaring)\u4ee3\u8868(representing)\u4f7f\u7528\u8005\u81ea\u5df1\u5ba2\u88fd\u5316(custom)\u7684\u7269\u4ef6\u578b\u5225</li> <li>\u4e4b\u5f8c,\u6211\u5011\u6703\u5229\u7528(utilize)\u9019\u500b\u65b0(newly)\u5efa\u7acb\u7684\u578b\u5225\u4f86\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u51fd\u5f0f(function)<code>isAdult()</code>,\u8a72\u51fd\u5f0f\u80fd\u63a5\u53d7(accpets)\u4e00\u500b<code>User</code>\u578b\u5225\u7684<code>user</code>\u53c3\u6578(argument),\u4e26\u56de\u50b3(returns)\u4e00\u500b\u5e03\u6797\u503c(<code>boolean</code>)</li> <li>\u63a5\u8457,\u6211\u5011\u5efa\u7acb\u4e86<code>justine</code>\u9019\u500b<code>user</code>,\u5b83\u6703\u662f\u6211\u5011\u7684\u7bc4\u4f8b\u8cc7\u6599\u4ee5\u7528\u4f86\u547c\u53eb(calling)\u4e4b\u524d(previously)\u5b9a\u7fa9(defined)\u7684\u51fd\u5f0f(function)</li> <li>\u6700\u5f8c,\u6211\u5011\u6703\u5efa\u7acb(create)\u4e00\u500b\u65b0\u7684\u5e36\u6709\u662f\u5426<code>justine</code>\u70ba\u6210\u5e74\u4eba(adult)\u7684\u9019\u500b\u8cc7\u8a0a(information)\u7684\u8b8a\u6578(vaiable)</li> <li>\u9019\u500b\u7bc4\u4f8b\u9084\u6709\u4e00\u4e9b\u6211\u5011\u4e5f\u61c9\u8a72\u9700\u8981\u984d\u5916(additional)\u77e5\u9053\u7684\u4e8b\u60c5<ul> <li>\u9996\u5148,\u5982\u679c\u6211\u5011\u6c92\u6709\u9075\u5b88(comply with)\u5ba3\u544a(declared)\u597d\u7684\u578b\u5225(types)\u6642,<code>Typescript</code>\u6703\u8b66\u544a(alarm)\u6211\u5011\u5c31\u6703\u8b66\u544a\u6211\u5011\u6709\u4e9b\u6771\u897f\u51fa\u932f(wrong)\u4e86,\u4ee5\u9632\u6b62(prevent)\u8aa4\u7528(misuse)</li> <li>\u7b2c\u4e8c\u9ede\u662f,\u4e0d\u662f\u6bcf\u500b\u6771\u897f\u90fd\u9700\u8981\u660e\u78ba\u5730(explicitly)\u5b9a\u7fa9\u578b\u5225(typed)---<code>Typescript</code>\u662f\u975e\u5e38\u8070\u660e(smart)\u7684,\u4e26\u4e14\u80fd\u70ba\u6211\u5011\u63a8\u65b7(deduce)\u578b\u5225(types)\u3002\u4f8b\u5982: \u5373\u4f7f(even if)\u6211\u5011\u6c92\u6709\u660e\u78ba\u5730(explicitly)\u8f38\u5165(type),<code>isJustineAnAdult</code>\u4e5f\u6703\u662f\u4e00\u500b\u5e03\u6797(<code>boolean</code>)\u578b\u5225,\u6216\u8005\u5373\u4f7f(even if)\u6211\u5011\u6c92\u6709\u5ba3\u544a(declare)<code>justine</code>\u70ba<code>User</code>\u578b\u5225(type),\u5b83\u4e5f\u6703\u8b8a\u6210\u4e00\u500b\u5c0d\u65bc\u51fd\u5f0f(function)\u4f86\u8aaa\u6709\u6548(valid)\u7684\u53c3\u6578(argument)</li> </ul> </li> </ul> </li> <li>Okay! \u6240\u4ee5\u6211\u5011\u5df2\u7d93\u6709\u4e00\u4e9b<code>Typescript</code>\u7a0b\u5f0f\u78bc\u4e86\u3002\u90a3\u9ebc,\u8a72\u600e\u9ebc\u4f7f\u7528\u5462?<ul> <li>\u9996\u5148,\u6211\u5011\u9700\u8981\u5728\u6211\u5011\u7684\u5c08\u6848\u4e2d\u5148\u5b89\u88ddnpm\u4e0a\u7684typescript</li> <li>$ <code>npm install typescript</code></li> <li>\u73fe\u5728,\u6211\u5011\u53ef\u4ee5\u5728\u7d42\u7aef\u6a5f(terminal)\u5229\u7528<code>tsc</code>\u6307\u4ee4\u4f86\u5c07<code>Typescript</code>\u7a0b\u5f0f\u78bc\u7de8\u8b6f(compile)\u6210Javascript\u7a0b\u5f0f\u78bc\u3002\u8b93\u6211\u5011\u958b\u59cb\u4f86\u52d5\u624b\u505a\u5427</li> <li>\u5047\u8a2d\u6211\u5011\u6709\u500b\u6a94\u6848\u7684\u540d\u7a31\u53eb\u505a<code>example.ts</code>,\u90a3\u9ebc\u5728\u7d42\u7aef\u6a5f\u7684\u6307\u4ee4\u6703\u50cf\u662f<ul> <li>$ <code>tsc example.ts</code></li> <li>\u9019\u500b\u6307\u4ee4\u6703\u5c0e\u81f4(result in)\u4e00\u500b\u65b0(new)\u7684\u6a94\u6848(file)\u53eb\u505a<code>example.js</code>,\u9019\u6a23\u6211\u5011\u5c31\u53ef\u4ee5\u4f7f\u7528Node\u4f86\u57f7\u884c\u4e86</li> </ul> </li> <li>\u73fe\u5728,\u7576\u6211\u5011\u77e5\u9053\u5982\u4f55\u7de8\u8b6f(how to compile) &amp; \u5982\u4f55\u57f7\u884c<code>Typescript</code>\u7a0b\u5f0f\u78bc(run TypeScript code)\u4e86\u4ee5\u5f8c,\u90a3\u5c31\u8b93\u6211\u5011\u4f86\u770b\u770b<code>Typescript</code>\u7684\u9632\u6b62\u932f\u8aa4\u529f\u80fd(bug-preventing capabilities)</li> <li>\u4ee5\u4e0b\u662f\u6211\u5011\u5982\u4f55\u4fee\u6539(modify)\u6211\u5011\u539f\u672c\u7684\u7a0b\u5f0f\u78bc(code)       JavaScript<pre><code>type User = {\n  name: string;\n  age: number;\n};\n\nfunction isAdult(user: User): boolean {\n  return user.age &gt;= 18;\n}\n\nconst justine: User = {\n  name: 'Justine',\n  age: 'Secret!',\n};\n\nconst isJustineAnAdult: string = isAdult(justine, \"I shouldn't be here!\");\n</code></pre></li> <li>\u63a5\u4e0b\u4f86,\u4ee5\u4e0b\u6703\u662f<code>Typescript</code>\u6703\u56de\u5831\u6211\u5011\u7684\u4e8b\u60c5     JavaScript<pre><code>example.ts:12:3 - error TS2322: Type 'string' is not assignable to type 'number'.\n\n12   age: \"Secret!\",\n    ~~~\n\n  example.ts:3:3\n    3   age: number;\n        ~~~\n    The expected type comes from property 'age' which is declared here on type 'User'\n\nexample.ts:15:7 - error TS2322: Type 'boolean' is not assignable to type 'string'.\n\n15 const isJustineAnAdult: string = isAdult(justine, \"I shouldn't be here!\");\n        ~~~~~~~~~~~~~~~~\n\nexample.ts:15:51 - error TS2554: Expected 1 arguments, but got 2.\n\n15 const isJustineAnAdult: string = isAdult(justine, \"I shouldn't be here!\");\n                                                    ~~~~~~~~~~~~~~~~~~~~~~\n\n\nFound 3 errors.\n</code></pre></li> <li>\u6b63\u5982\u540c\u6211\u5011\u6240\u770b\u5230(As you can see)\u7684,<code>Typescript</code>\u6210\u529f\u5730(successfully)\u9632\u6b62(prevent)\u6211\u5011\u4ea4\u4ed8(shipping)\u7684\u7a0b\u5f0f\u78bc(code)\u7121\u6cd5\u5982\u9810\u671f\u5730(unexpectedly)\u904b\u4f5c(work)\u3002\u9019\u771f\u662f\u592a\u68d2\u4e86!</li> </ul> </li> <li>\u95dc\u65bc<code>Typescript</code>\u7684\u66f4\u591a\u4e8b\u60c5 (More about TypeScript)</li> <li><code>Typescript</code>\u63d0\u4f9b(offers)\u4e86\u5927\u91cf(a whole lot of )\u5176\u4ed6(others)\u5f88\u68d2\u7684\u6a5f\u5236(mechanisms),\u4f8b\u5982: \u4ecb\u9762(<code>interfaces</code>)\u3001\u985e\u5225(<code>classes</code>)\u3001\u5be6\u7528\u7a0b\u5e8f\u578b\u5225(<code>utility types</code>)...\u7b49\u7b49\u3002\u6b64\u5916,\u5728\u8f03\u5927\u7684\u5c08\u6848(on bigger projects)\u4e2d,\u6211\u5011\u53ef\u4ee5\u5728\u4e00\u500b\u55ae\u7368\u7684\u6a94\u6848(a separate file)\u4e2d\u5ba3\u544a(declare)\u6211\u5011\u81ea\u5df1\u7684<code>Typescript</code>\u7de8\u8b6f\u5668\u8a2d\u5b9a(compiler configuration),\u4e26\u7d30\u5316(granularly)\u8abf\u6574(adjust)\u5176\u5de5\u4f5c\u65b9\u5f0f,\u50cf\u662f\u56b4\u683c\u7a0b\u5ea6(how strict) &amp; \u6703\u5c07\u5df2\u7de8\u8b6f\u6a94\u6848\u5132\u5b58\u5728\u54ea\u88e1(where it stores compiled files for example)<ul> <li>\u6211\u5011\u53ef\u4ee5\u5230Typescript\u7684\u5b98\u65b9\u6587\u4ef6\u4ee5\u95b1\u8b80\u66f4\u591a(read more about)\u9019\u500b\u4ee4\u4eba\u9a5a\u5606(awesome)\u7684\u6771\u897f(stuff)</li> </ul> </li> <li><code>Typescript</code>\u6709\u4e00\u4e9b\u5176\u5b83\u7684\u597d\u8655(other benefits)\u662f\u503c\u5f97\u4e00\u63d0\u7684(worth mentioning),\u50cf\u662f<code>Typescript</code>\u53ef\u4ee5\u88ab\u6f38\u9032\u5f0f\u5730(progressively)\u63a1\u7528(adopted),\u5b83\u80fd\u8b93\u7a0b\u5f0f\u78bc\u8b8a\u5f97\u66f4\u6613\u8b80(readable) &amp; \u66f4\u597d\u7406\u89e3\u7684(understandable),\u4e26\u4e14\u5b83\u4e5f\u5141\u8a31(allows)\u958b\u767c\u8005(developer)\u5728\u8f03\u820a\u7684Node\u7248\u672c\u4e2d\u4ecd\u80fd\u4f7f\u7528\u73fe\u4ee3\u5316(modern)\u7684\u8a9e\u8a00\u529f\u80fd(language features)</li> <li>\u5728Node\u4e16\u754c\u4e2d\u7684<code>Typescript</code> (TypeScript in the Node.js world)</li> <li>\u5728Node\u7684\u4e16\u754c\u4e2d,<code>Typescript</code>\u5df2\u7d93\u6a39\u7acb\u4e86\u826f\u597d\u7684\u5178\u7bc4,\u4e26\u4e14\u5df2\u7d93\u88ab\u8a31\u591a\u516c\u53f8\u3001\u958b\u6e90\u8edf\u9ad4\u5c08\u6848\u3001\u5de5\u5177\u3001\u6846\u67b6...\u7b49\u7b49\u6240\u63a1\u7528</li> <li>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u8457\u540d\u7684\u958b\u6e90\u8edf\u9ad4\u5c08\u6848\u4f8b\u5b50,\u6709\u4f7f\u7528\u5230<code>Typescript</code>\u7684<ul> <li>NestJS: \u5b83\u662f\u4e00\u500b\u5065\u5168(robust)\u4e14\u529f\u80fd\u5b8c\u5584(fully-featured)\u7684\u6846\u67b6(framework),\u4e26\u4e14\u80fd\u5920\u8f15\u9b06(easy)\u3001\u6109\u5feb(pleasant)\u5730\u5efa\u7acb\u53ef\u64f4\u5c55\u7684(scalable) &amp; \u7d50\u69cb\u5b8c\u5584(well-architected)\u7684\u7cfb\u7d71(systems)</li> <li>TypeORM: \u512a\u79c0(great)\u7684<code>ORM</code>,\u5b83\u6709\u53d7\u5230\u5176\u5b83\u8a9e\u8a00(other languages)\u4f7f\u7528\u7684\u77e5\u540d\u5de5\u5177(well-known tools)(\u50cf\u662f: Java\u7684Hibernate\u3001PHP\u7684Doctrine\u3001.NET\u7684Entity Framework)\u7684\u5f71\u97ff(influenced)</li> <li>RxJS: \u5ee3\u6cdb\u5730(widely)\u88ab\u904b\u7528(used)\u5728\u4e92\u52d5\u5f0f(reactive)\u7a0b\u5f0f\u8a2d\u8a08(programming)\u7684\u51fd\u5f0f\u5eab(library)</li> <li>\u4ee5\u53ca\u8a31\u8a31\u591a\u591a\u7684\u512a\u79c0\u7684\u958b\u6e90\u8edf\u9ad4\u5c08\u6848\u4e4b\u4e2d,\u751a\u81f3(even)\u53ef\u80fd\u6211\u5011\u7684\u5c08\u6848\u5c31\u6703\u6210\u70ba\u4e0b\u4e00\u500b</li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#nodejs_1","title":"Node.js \u6838\u5fc3\u6a21\u7d44","text":""},{"location":"programming_language/nodejs/#http","title":"HTTP","text":"<ul> <li>\u8981\u4f7f\u7528HTTP server &amp; client,\u5fc5\u9808\u8981\u5148<code>require('http')</code></li> <li>Node\u7684HTTP\u4ecb\u9762(interfaces)\u65e8\u5728\u652f\u63f4HTTP\u5354\u5b9a\u7684\u8a31\u591a\u529f\u80fd ,\u56e0\u70ba\u9019\u4e9b\u529f\u80fd\u50b3\u7d71\u4e0a\u8f03\u96e3\u4f7f\u7528,\u5c24\u5176\u662f\u5728\u5927\u91cf.\u5927\u584a(chunk-encoded)\u7684\u8a0a\u606f</li> <li>\u8a72\u4ecb\u9762\u975e\u5e38\u5730\u5c0f\u5fc3,\u6c38\u9060\u4e0d\u6703\u7de9\u885d(buffer)\u6574\u500b\u8acb\u6c42(requests)\u548c\u56de\u61c9(responses),\u6240\u4ee5\u4f7f\u7528\u8005\u53ef\u4ee5\u50b3\u9001\u5be6\u6642\u8cc7\u6599\u6d41(stream data)</li> <li>HTTP\u8a0a\u606f\u6a19\u982d(message headers)\u901a\u5e38\u7528\u7269\u4ef6(object)\u4f86\u8868\u793a</li> <li>\u7bc4\u4f8b<code>HTTP message header</code>     ``` js     { 'content-length': '123',       'content-type': 'text/plain',       'connection': 'keep-alive',       'host': 'mysite.com',       'accept': '/'      }</li> <li>\u9375(keys)\u8981\u7528\u5c0f\u5beb\u8868\u793a,\u503c(values)\u662f\u6309\u7167\u539f\u672c\u7684\u4e0d\u8b8a</li> <li>\u70ba\u4e86\u80fd\u652f\u63f4\u6240\u6709\u53ef\u80fd\u7684HTTP\u61c9\u7528\u7a0b\u5f0f,Node\u7684HTTP API\u662f\u5c6c\u65bc\u975e\u5e38\u5e95\u5c64\u7684,\u5b83\u53ea\u8655\u7406\u8cc7\u6599\u6d41(stream handling),\u4f46\u662f\u4e0d\u89e3\u6790\u5be6\u969b\u7684\u6a19\u982d(headers)\u6216\u662f\u6b63\u6587(context)</li> <li>\u53ef\u53c3\u8003message.headers\u4ee5\u4e86\u89e3\u8a72\u5982\u4f55\u8655\u7406\u91cd\u8907\u6a19\u982d(duplicate headers)\u7684\u7d30\u7bc0</li> <li>\u6536\u5230\u7684\u539f\u59cb\u6a19\u982d\u6703\u4fdd\u7559\u5728message.rawHeaders\u5c6c\u6027\u503c\u4e2d,\u4e26\u4ee5\u9663\u5217(array)\u7684\u5f62\u5f0f\u4f86\u5132\u5b58\u8a72\u8cc7\u8a0a,\u50cf\u662f<code>[key, value, key2, value2, ...]</code></li> <li>\u4ee5\u4e0a\u8ff0\u7684<code>HTTP message header</code>\u70ba\u4f8b,\u5b83\u7684<code>message.rawHeaders</code>\u7684\u503c\u6703\u50cf\u662f\u4ee5\u4e0b\u7684\u9663\u5217(array)\u5f62\u5f0f     JavaScript<pre><code>[ 'ConTent-Length', '123456',\n  'content-LENGTH', '123',\n  'content-type', 'text/plain',\n  'CONNECTION', 'keep-alive',\n  'Host', 'mysite.com',\n  'accepT', '*/*'\n]\n</code></pre> <p>method</p> </li> <li>http.createServer([options][, requestListener])<ul> <li>\u6703\u56de\u50b3\u4e00\u500b http.Server \u5be6\u4f8b</li> <li>options</li> <li>http.IncomingMessage</li> <li>ServerResponse</li> <li>insecureHTTPParser (Default: false)</li> <li>maxHeaderSize (Default: 16384 (16KB)</li> <li>requestListener (Function) <p>Class</p> </li> </ul> </li> <li>Class: http.IncomingMessage<ul> <li>\u9019\u500bClass\u7269\u4ef6\u6703\u7531http.server\u8207http.ClientRequest\u6240\u5efa</li> <li>\u5b83\u662f\u7528\u4f86\u4f5c\u70ba\u88ab\u50b3\u7d66request event &amp; response event\u7684\u7b2c1\u500b\u53c3\u6578</li> <li>\u5b83\u6703\u88ab\u7528\u4f86\u5b58\u53d6\u56de\u61c9\u7269\u4ef6\u7684\u72c0\u614b(response status),\u6a19\u982d(response headers),\u8cc7\u6599(response data)</li> </ul> </li> <li>Class: http.ServerResponse<ul> <li>\u9019\u500bClass\u7269\u4ef6\u6703\u7531HTTP server\u5167\u90e8\u81ea\u52d5\u5efa\u7acb,\u800c\u4e0d\u662f\u900f\u904euser\u4f86\u5efa\u7acb\u7684</li> <li>\u5b83\u662f\u7528\u4f86\u4f5c\u70ba\u88ab\u50b3\u7d66request event\u7684\u7b2c2\u500b\u53c3\u6578 <p>property</p> </li> <li>response.statusCode<ul> <li>\u7576\u4f7f\u7528\u96b1\u5f0f\u6a19\u982d(implicit headers)\u6642,\u4e5f\u5c31\u662f\u7576\u6c92\u6709\u660e\u78ba\u5730\u4f7f\u7528response.writeHead()\u6642,\u9019\u500b\u5c6c\u6027\u6703\u5728headers\u88ab\u66f4\u65b0\u6642\u6c7a\u5b9a\u8981\u50b3\u7d66client\u7aef\u4ec0\u9ebc\u72c0\u614b\u78bc(status code)</li> <li>\u7576\u56de\u61c9\u6a19\u982d(response header)\u5df2\u7d93\u50b3\u5230client\u7aef\u4e4b\u5f8c,\u9019\u500b\u5c6c\u6027\u6703\u6307\u51fa\u5df2\u7d93\u767c\u9001\u51fa\u53bb\u7684\u72c0\u614b\u78bc</li> <li>\u9810\u8a2d\u662f200 (number\u578b\u5225)</li> <li>\u4f8b: <code>response.statusCode = 404;</code> <p>method</p> </li> </ul> </li> <li>response.setHeader(name, value)<ul> <li>args</li> <li>name: (string)</li> <li>value: (any)</li> <li>Returns: http.ServerResponse </li> <li>\u56de\u50b3\u4e00\u500b\u56de\u61c9\u7269\u4ef6(response object)</li> <li>\u70ba\u96b1\u5f0f\u6a19\u982d(implicit header)\u8a2d\u5b9a\u4e00\u7b46\u55ae\u4e00\u7684\u503c,\u82e5\u6b64\u6a19\u982d\u5df2\u7d93\u5b58\u5728\u65bc\u5f85\u767c\u9001\u7684header\u4e2d,\u90a3\u9ebc\u5f85\u767c\u9001header\u7684\u503c\u5c31\u6703\u88ab\u53d6\u4ee3\u6389</li> <li>\u82e5\u8981\u767c\u9001\u70ba\u540c\u4e00\u500b\u540d\u7a31\u7684\u591a\u500bheader\u6642,\u53ef\u4ee5\u7528\u4e00\u500bArray['xxx', 'yyy']\u4f86\u5305\u4f4f\u6240\u6709\u7684header\u503c</li> <li>\u5982\u679c\u8f38\u5165\u975e\u5b57\u4e32\u578b\u5225\u7684\u503c,\u5c07\u81ea\u52d5\u88ab\u5132\u5b58\u4e0b\u4f86,\u800c\u7121\u9808\u591a\u505a\u4fee\u6539</li> <li>\u7576header\u7684name\u6216\u662fvalue\u5305\u542b\u7121\u6548\u7684\u5b57\u5143\u6642,\u5c31\u6703\u5f15\u767cTypeError\u932f\u8aa4</li> <li>\u4f8b: <code>response.setHeader('Content-Type', 'text/html');</code></li> <li>\u4f8b: <code>response.setHeader('Set-Cookie', ['type=ninja', 'language=javascript']);</code></li> <li>\u7576headers\u88ab\u8a2d\u5b9a\u70ba\u4f7f\u7528response.setHeader(),\u5b83\u5011\u5c07\u6703\u88ab\u5408\u4f75\u5230\u5176\u4ed6\u6240\u6709\u8981\u50b3\u7d66 response.writeHead()\u7684headers,\u4e26\u4e14\u6703\u81ea\u52d5\u5c07\u8981\u50b3\u7d66response.writeHead()\u7684headers\u5217\u70ba\u512a\u5148</li> <li>\u82e5\u9700\u8981\u9010\u6b65\u65b0\u589eheaders,\u8b93\u672a\u4f86\u6709\u9700\u8981\u7684\u8a71\u53ef\u4ee5\u6aa2\u7d22\u548c\u4fee\u6539,\u8acb\u4f7f\u7528response.setHeader(),\u800c\u4e0d\u8981\u4f7f\u7528response.writeHead()   JavaScript<pre><code>// Returns content-type = text/plain\nconst server = http.createServer((req, res) =&gt; {\n  res.setHeader('Content-Type', 'text/html');\n  res.setHeader('X-Foo', 'bar');\n  res.writeHead(200, { 'Content-Type': 'text/plain' });\n  res.end('ok');\n});\n</code></pre></li> </ul> </li> <li>response.end()<ul> <li>\u5b8c\u6574\u7248: response.end([data[, encoding]][, callback]) </li> <li>args</li> <li>data: (string || Buffer)</li> <li>encoding: (string)</li> <li>callback: (Function)</li> <li>Returns: (this)</li> <li>\u9019\u500b\u65b9\u6cd5\u6703\u5411server\u767c\u9001\u4fe1\u865f,\u8868\u793a\u6240\u6709\u7684\u56de\u61c9\u6a19\u982d(response header)\u548c\u5167\u6587(body)\u7686\u5df2\u767c\u9001\u51fa\u53bb,\u9019\u6642server\u61c9\u8a8d\u5b9a\u8a72\u8acb\u6c42\u6d88\u606f\u5df2\u5b8c\u6210</li> <li>response.end()\u9700\u8981\u5728\u6bcf\u500b\u56de\u61c9\u7684 \u7d50\u5c3e \u90fd\u4f7f\u7528\u5b83</li> <li>\u5982\u679cdata\u53c3\u6578\u6709\u7d66\u5b9a\u7684\u8a71,\u5b83\u5be6\u969b\u4e0a\u662f\u53bb\u547c\u53ebresponse.write(data, encoding),\u4e26\u63a5\u8457\u57f7\u884cres.end(callback)</li> <li>\u5982\u679ccallback\u51fd\u5f0f\u6709\u7d66\u5b9a\u7684\u8a71,\u8a72callback\u51fd\u5f0f\u6703\u5728\u56de\u61c9\u4e32\u6d41(response stream)\u7d50\u675f\u4e4b\u5f8c\u624d\u6703\u88ab\u547c\u53eb\u4e26\u57f7\u884c</li> </ul> </li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#process","title":"Process","text":"<ul> <li><code>process</code>\u662f\u4e00\u500b\u5168\u57df\u7684\u7269\u4ef6,\u91dd\u5c0d\u7576\u524d\u7684Node\u61c9\u7528\u7a0b\u5e8f\u7684\u9032\u7a0b(process),\u63d0\u4f9b\u8cc7\u8a0a\u8207\u63a7\u5236</li> <li>\u8b80: \u7372\u53d6process\u8cc7\u8a0a(\u8cc7\u6e90\u4f7f\u7528\u3001\u57f7\u884c\u74b0\u5883\u3001\u57f7\u884c\u72c0\u614b)</li> <li>\u5beb: \u57f7\u884cprocess\u64cd\u4f5c(\u76e3\u807d\u4e8b\u4ef6\u3001\u6392\u7a0b\u4efb\u52d9\u3001\u767c\u51fa\u8b66\u543f)</li> <li>\u56e0\u70ba<code>process</code>\u8eab\u70baglobal\u7269\u4ef6,\u6240\u4ee5\u53ef\u4ee5\u5728Node\u61c9\u7528\u7a0b\u5f0f\u4e2d\u76f4\u63a5\u4f7f\u7528,\u800c\u7121\u9700\u4e8b\u5148require()\u3002</li> <li>\u4f46\u5b83\u4e5f\u9084\u662f\u80fd\u900f\u904erequire()\u4f86\u532f\u5165\u4e26\u4f7f\u7528\u9019\u500b\u6a21\u7d44</li> <li>\u4f8b: $ <code>const process = require('process');</code> <p>Process events</p> </li> <li>Event: exit<ul> <li>args</li> <li>code: (integer)</li> <li>\u7531\u65bc\u4ee5\u4e0b\u7684\u4efb\u4e00\u500b\u539f\u56e0\u800c\u5c0e\u81f4Node\u61c9\u7528\u7a0b\u5f0f\u5373\u5c07\u9000\u51fa\u6642,\u5c07\u767c\u51fa(emitted)\u8a72\u4e8b\u4ef6</li> <li>\u660e\u78ba\u5730\u547c\u53eb<code>process.exit()</code>\u65b9\u6cd5\u6642</li> <li>Node\u7684\u4e8b\u4ef6\u5faa\u74b0(event loop)\u4e0d\u518d\u9700\u8981\u57f7\u884c\u5176\u4ed6\u984d\u5916\u7684\u5de5\u4f5c\u6642</li> <li>\u76ee\u524d\u6c92\u6709\u65b9\u6cd5\u53ef\u4ee5\u9632\u6b62\u5728\u9019\u500b\u6642\u9593\u9ede\u8981\u9000\u51fa\u4e8b\u4ef6\u5faa\u74b0(event loop),\u4e00\u65e6\u6240\u6709\u7684 exit \u76e3\u807d\u5668(listener)\u57f7\u884c\u7d50\u675f\u5f8c,\u5c31\u6703\u7d42\u6b62Node\u7684\u9032\u7a0b</li> <li>\u53ea\u8981\u6709\u7d66\u5b9a\u9000\u51fa\u78bc(\u4e0d\u7ba1\u662f\u900f\u904e<code>process.exitCode</code>\u5c6c\u6027\u6216\u662f\u73fe\u5728\u9019\u500b exit\u4e8b\u4ef6 \u7684<code>exitCode</code>\u53c3\u6578)\u4e26\u50b3\u905e\u7d66<code>process.exit()</code>\u65b9\u6cd5\u6642,\u8a72\u4e8b\u4ef6\u76e3\u807d\u56de\u547c\u51fd\u5f0f(listener callback function)\u5c31\u6703\u88ab\u547c\u53eb</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc      JavaScript<pre><code>process.on('exit', (code) =&gt; {\n  console.log(`About to exit with code: ${code}`);\n});\n</code></pre></li> <li>\u76e3\u807d\u529f\u80fd \u5fc5\u9808\u53ea \u57f7\u884c \u540c\u6b65\u5316\u7684\u64cd\u4f5c ,\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc,\u8a72Node\u9032\u7a0b\u6703\u5728\u547c\u53eb<code>exit</code>\u4e8b\u4ef6\u76e3\u807d\u5668(event listeners)\u5f8c \u5c31\u7acb\u5373\u9000\u51fa ,\u56e0\u800c\u5c0e\u81f4\u4efb\u4f55\u4ecd\u5728\u4e8b\u4ef6\u8ff4\u5708(event loop)\u4e2d\u7684\u4f47\u5217(queued)\u4e2d\u7684\u984d\u5916\u7684\u5de5\u4f5c\u90fd\u6703\u88ab\u62cb\u68c4(abandoned)</li> <li>\u4ee5\u4e0b\u7684\u7a0b\u5f0f\u78bc\u70ba\u4f8b,<code>setTimeout()</code>\u9019\u500b\u51fd\u5f0f \u6c38\u9060\u4e0d\u6703 \u88ab\u57f7\u884c\u5230</li> <li>\u60c5\u5883\u8aaa\u660e( \u932f\u8aa4\u793a\u7bc4 )       JavaScript<pre><code>process.on('exit', (code) =&gt; {\n  setTimeout(() =&gt; {\n    console.log('This will not run');\n  }, 0);\n});\n</code></pre></li> </ul> </li> <li>Event: Signal events<ul> <li>\u4fe1\u865f\u4e8b\u4ef6(Signal events)\u6703\u5728Node\u9032\u7a0b(process)\u6536\u5230\u4fe1\u865f\u6642\u767c\u51fa(emitted)</li> <li>\u4fe1\u865f(Signals)\u4e0d\u80fd\u7528\u5728Worker threads</li> <li>\u4fe1\u865f\u8655\u7406\u5668(signal handler)\u6703\u5c07\u6536\u5230\u7684\u4fe1\u865f\u540d\u7a31(signal's name)\u505a\u70ba\u7b2c\u4e00\u500b\u53c3\u6578</li> <li>\u4f8b: <code>SIGINT</code>, <code>SIGTERM</code></li> <li>\u6bcf\u500b\u4e8b\u4ef6(event)\u7684\u540d\u7a31\u5c07\u6703\u662f\u5927\u5beb\u7684\u5e38\u7528\u4fe1\u865f\u540d\u7a31</li> <li>\u4f8b: <code>SIGINT</code> =&gt; SIGINT \u4fe1\u865f\u5011   JavaScript<pre><code>// Begin reading from stdin so the process does not exit.\nprocess.stdin.resume();\n\nprocess.on('SIGINT', () =&gt; {\n  console.log('Received SIGINT. Press Control-D to exit.');\n});\n\n// Using a single function to handle multiple signals\nfunction handle(signal) {\n  console.log(`Received ${signal}`);\n}\n\nprocess.on('SIGINT', handle);\nprocess.on('SIGTERM', handle);\n</code></pre></li> <li><code>SIGTERM</code>\u8207<code>SIGINT</code>\u5728\u975eWindows\u4f5c\u696d\u7cfb\u7d71\u7684\u74b0\u5883\u4e2d,\u64c1\u6709\u9810\u8a2d\u8655\u7406\u5668\u53ef\u4ee5\u5728\u9000\u51fa\u7a0b\u5f0f\u78bc\u4e4b\u524d,\u91cd\u7f6e\u7d42\u7aef\u6a5f\u6a21\u5f0f\u70ba 128 + signal number\u3002\u5982\u679c\u9019\u4e9b\u4fe1\u865f\u4e4b\u4e00\u5df2\u5b89\u88dd\u4e86\u76e3\u807d\u5668(listener),\u5247\u5c07\u522a\u9664\u5176\u9ed8\u8a8d\u884c\u70ba(Node\u61c9\u7528\u7a0b\u5f0f\u4e5f\u4e0d\u518d\u9000\u51fa)</li> <li><code>SIGTERM</code>: \u5728Windows\u4f5c\u696d\u7cfb\u7d71\u7684\u74b0\u5883\u4e2d\u4e0d\u652f\u63f4,\u4f46\u53ef\u4ee5\u76e3\u807d\u5b83(listened on)</li> <li><code>SIGINT</code>: \u5728\u7d42\u7aef\u6a5f\u4e2d\u662f\u53ef\u88ab\u6240\u6709\u4f5c\u696d\u7cfb\u7d71\u6240\u652f\u63f4\u7684,\u5b83\u901a\u5e38\u53ef\u4ee5\u7528<code>ctrl-C</code>\u4f86\u7522\u751f</li> <li><code>SIGKILL</code>: \u4e0d\u80fd\u5b89\u88dd\u76e3\u807d\u5668(listener),\u5b83\u5c07\u7121\u689d\u4ef6\u7d42\u6b62Node\u61c9\u7528\u7a0b\u5f0f,\u7121\u8ad6\u6211\u5011\u5728\u54ea\u500b\u4f5c\u696d\u7cfb\u7d71\u7684\u74b0\u5883\u4e2d</li> <li>\u88dc\u5145: \u56e0\u70baWindows\u4f5c\u696d\u7cfb\u7d71\u4e26\u4e0d\u652f\u63f4\u4fe1\u865f(signals),\u6240\u4ee5\u4e0d\u80fd\u8aaa\u662f\u7b49\u540c\u65bc\u4fe1\u865f\u7d42\u6b62,\u4f46\u662fNode\u6709\u63d0\u4f9b\u4e86\u4e00\u4e9b\u4eff\u6548\u7684\u505a\u6cd5,\u4f8b\u5982: process.kill()\u8207subprocess.kill()</li> <li>\u767c\u9001<code>SIGINT</code>,<code>SIGTERM</code>,<code>SIGKILL</code>\u5c07\u5c0e\u81f4\u76ee\u6a19\u9032\u7a0b(target process)\u7121\u689d\u4ef6\u88ab\u7d42\u6b62\u3002\u6b64\u5f8c,\u5b50\u9032\u7a0b(subprocess)\u5c07\u56de\u5831\u8a72\u9032\u7a0b(process)\u5df2\u88ab\u4fe1\u865f(signal)\u7d42\u6b62\u4e86</li> <li>\u767c\u9001\u4fe1\u865f(signal) <code>0</code> \u53ef\u4ee5\u7528\u4f86\u505a\u70ba\u4e00\u7a2e\u7368\u7acb\u7684\u5e73\u53f0\u4ee5\u6e2c\u8a66\u9032\u7a0b(process)\u7684\u5b58\u5728   <p>method</p> </li> </ul> </li> <li>process.cpuUsage([previousValue])</li> <li>args<ul> <li>previousValue: (Object)</li> <li>\u4e0a\u4e00\u6b21\u547c\u53ebprocess.cpuUsage()\u7684\u56de\u50b3\u503c</li> </ul> </li> <li>Returns: (Object)<ul> <li>user: (integer)</li> <li>system: (integer)</li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3\u4e00\u500b\u5177\u6709<code>user</code>, <code>system</code>\u7684\u7269\u4ef6(<code>Object</code>),\u4f86\u8868\u793a\u7576\u524d\u7684\u9032\u7a0b(current process)\u7684<code>user</code>\u548c<code>system</code>\u7684\u6642\u9593\u4f7f\u7528\u7387<ul> <li>\u9019\u4e9b\u503c\u90fd\u662f\u4ee5\u767e\u842c\u5206\u4e4b\u4e00\u79d2\u70ba\u55ae\u4f4d(\u5fae\u79d2)---&gt;\u6642\u9593\u55ae\u4f4d</li> <li>\u9019\u4e9b\u503c\u5206\u5225\u7528\u4f86\u6e2c\u91cf\u82b1\u5728\u4f7f\u7528\u8005\u7aef\u7684\u7a0b\u5f0f\u78bc\uff06\u7cfb\u7d71\u7aef\u7684\u7a0b\u5f0f\u78bc\u7684\u6642\u9593</li> <li>\u7576\u6709\u591a\u500bCPU\u5167\u6838\u5728\u70ba\u9019\u500b\u9032\u7a0b(process)\u57f7\u884c\u5de5\u4f5c\u6642,\u5247\u9019\u4e9b\u503c\u6700\u7d42\u53ef\u80fd\u6703\u5927\u65bc\u5be6\u969b\u7d93\u904e\u7684\u6642\u9593</li> </ul> </li> <li>\u4e0a\u4e00\u6b21\u547c\u53eb<code>process.cpuUsage()</code>\u7684\u7d50\u679c\u53ef\u4ee5\u4f5c\u70ba\u53c3\u6578\u50b3\u905e\u7d66\u51fd\u5f0f,\u4ee5\u5f97\u77e5\u5dee\u7570\u8b80\u6578(diff reading)     JavaScript<pre><code>const startUsage = process.cpuUsage();\n// { user: 38579, system: 6986 }\n\n// spin the CPU for 500 milliseconds\nconst now = Date.now();\nwhile (Date.now() - now &lt; 500);\n\nconsole.log(process.cpuUsage(startUsage));\n// { user: 514883, system: 11226 }\n</code></pre></li> <li>process.memoryUsage()</li> <li>Returns: (Object)<ul> <li>rss: (integer)</li> <li>rss =&gt; (\u5e38\u99d0\u96c6\u7684\u5927\u5c0f,Resident Set Size),\u4ee3\u8868\u8a72\u9032\u7a0b(process)\u5728\u4e3b\u8a18\u61b6\u9ad4\u88dd\u7f6e\u4e2d\u5df2\u88ab\u4f7f\u7528\u6389\u7684\u5167\u5b58\u8a18\u61b6\u9ad4\u7a7a\u9593(\u5373\u7e3d\u5206\u914d\u5167\u5b58\u7684\u5b50\u96c6); \u5305\u62ec\u6240\u6709\u7684<code>C++</code>\u8207<code>Javascript</code>\u7684\u7269\u4ef6\u548c\u7a0b\u5f0f\u78bc</li> <li>heapTotal: (integer)</li> <li>\u53c3\u8003V8 engine\u7684\u5167\u5b58\u8a18\u61b6\u9ad4\u4f7f\u7528\u60c5\u6cc1 </li> <li>heapUsed: (integer)</li> <li>\u53c3\u8003V8 engine\u7684\u5167\u5b58\u8a18\u61b6\u9ad4\u4f7f\u7528\u60c5\u6cc1 </li> <li>external: (integer)</li> <li>\u53c3\u8003\u7531V8 engine\u7ba1\u7406\u7684<code>C++\u7269\u4ef6</code>\u7d81\u5b9a\u5230<code>Javascript\u7269\u4ef6</code>\u7684\u5167\u5b58\u8a18\u61b6\u9ad4\u4f7f\u7528\u91cf </li> <li>arrayBuffers: (integer)</li> <li>\u53c3\u8003\u5206\u914d\u5230<code>ArrayBuffers</code> &amp; <code>SharedArrayBuffers</code>,\u4e5f\u5305\u542b\u6240\u6709Node\u61c9\u7528\u7a0b\u5f0f\u7684Buffer\u7269\u4ef6</li> <li><code>arrayBuffers</code>\u4e5f\u5305\u542b\u5728<code>external</code>\u7684\u503c\u4e2d</li> <li>\u7576Node\u61c9\u7528\u7a0b\u5f0f\u88ab\u7528\u4f5c\u5d4c\u5165\u5f0f\u51fd\u5f0f\u5eab\u6642,\u8a72\u503c\u53ef\u80fd\u70ba0,\u662f\u56e0\u70ba\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b<code>arrayBuffers</code>\u53ef\u80fd\u4e0d\u6703\u88ab\u8ffd\u8e64\u5230</li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3\u4e00\u500b\u7269\u4ef6(<code>Object</code>)\u4f86\u63cf\u8ff0Node\u61c9\u7528\u7a0b\u5f0f\u7684\u5167\u5b58\u8a18\u61b6\u9ad4(memory)\u7528\u91cf<ul> <li>\u9019\u500b\u503c\u6703\u4ee5<code>bytes</code>\u70ba\u55ae\u4f4d\u4f86\u8868\u793a</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc<ul> <li>\u4ee5\u4e0b\u9762\u7684\u7a0b\u5f0f\u78bc\u70ba\u4f8b     JavaScript<pre><code>console.log(process.memoryUsage());\n</code></pre></li> <li>\u6703\u7522\u751f\u4e00\u500b\u7269\u4ef6</li> <li><code>{         rss: 4935680,         heapTotal: 1826816,         heapUsed: 650472,         external: 49879,         arrayBuffers: 9386       }</code></li> </ul> </li> <li>\u7576\u4f7f\u7528Worker threads\u6642,<code>rss</code>\u5c07\u6703\u662f\u4e00\u500b\u5c0d\u65bc\u6574\u500b\u9032\u7a0b(entire process)\u6709\u6548\u7684\u503c(valid),\u800c\u5176\u4ed6\u53c3\u6578\u50c5\u6703\u53c3\u8003\u5230\u7576\u524d\u7684\u9032\u7a0b</li> <li>process.resourceUsage()</li> <li>Returns: (Object)<ul> <li>userCPUTime: (integer)</li> <li>\u5c0d\u61c9\u5230<code>ru_utime</code>\u7684\u503c,\u4e26\u4ee5\u5fae\u79d2\u70ba\u55ae\u4f4d\u8868\u793a</li> <li>\u8207process.cpuUsage().user\u7684\u503c\u76f8\u540c</li> <li>systemCPUTime: (integer)</li> <li>\u5c0d\u61c9\u5230<code>ru_stime</code>\u7684\u503c,\u4e26\u4ee5\u5fae\u79d2\u70ba\u55ae\u4f4d\u8868\u793a</li> <li>\u8207process.cpuUsage().system\u7684\u503c\u76f8\u540c</li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3\u4e00\u500b\u7269\u4ef6(<code>Object</code>)\u4f86\u8868\u793a\u7576\u524d\u9032\u7a0b(current process)\u7684\u8cc7\u6e90\u4f7f\u7528\u7387(resource usage); \u4ee5\u4e0a\u6240\u6709\u8a72\u65b9\u6cd5\u7684\u56de\u50b3\u503c\u90fd\u662f\u4f86\u81ea\u65bc\u547c\u53ebuv_rusage_t struct\u7684uv_getrusage()\u65b9\u6cd5\u7684\u56de\u50b3\u503c     &gt; uv_getrusage(): Gets the resource usage measures for the current process.</li> <li>process.cwd()</li> <li>Returns: (string)<ul> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3\u7576\u524d\u9032\u7a0b(current process)\u6240\u5728\u7684\u5de5\u4f5c\u76ee\u9304\u7684\u8def\u5f91(working directory)</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc       JavaScript<pre><code>console.log(Current directory:  {process.cwd()});\n</code></pre></li> <li>process.exit([code])</li> <li>args<ul> <li>code: (integer)</li> <li>\u8868\u793a\u8981\u6307\u5b9a\u7684\u9000\u51fa\u78bc</li> <li>\u9810\u8a2d\u503c: 0 (\u4ee3\u8868\u6210\u529f)</li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6307\u793aNode\u61c9\u7528\u7a0b\u5f0f\u4ee5\u540c\u6b65\u5730\u65b9\u5f0f(synchronously)\u4f86\u7d42\u6b62\u9032\u7a0b(terminate the process)\u4e26\u986f\u793a\u9000\u51fa\u78bc<ul> <li>\u82e5[code]\u53c3\u6578\u88ab\u7701\u7565,\u5247\u6703\u4ee5<code>0</code>\u70ba\u9000\u51fa\u78bc\u6216\u662f<code>process.exitCode</code>\u7684\u503c\u70ba\u6e96(\u7576\u8a72\u5c6c\u6027\u5728\u4e4b\u524d\u6709\u88ab\u8a2d\u5b9a\u904e\u7684\u8a71)</li> <li>Node\u61c9\u7528\u7a0b\u5f0f\u4e0d\u6703\u5728\u6240\u6709\u7684Event: 'exit'\u4e8b\u4ef6\u76e3\u807d\u5668(event listeners)\u88ab\u547c\u53eb\u4e4b\u524d\u5c31\u7d42\u6b62\u6389</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc<ul> <li>\u4ee5\u5931\u6557(failure)\u7684\u72c0\u614b\u78bc\u4f86\u9000\u51faNode\u61c9\u7528\u7a0b\u5f0f </li> <li>$ <code>process.exit(1);</code></li> <li>\u5728\u57f7\u884c\u8a72Node\u61c9\u7528\u7a0b\u5f0f\u7684shell\u4e0a,\u6211\u5011\u6703\u770b\u5230\u9000\u51fa\u78bc(exit code)\u70ba<code>1</code></li> </ul> </li> <li>\u7576\u6211\u5011\u547c\u53eb<code>process.exit()</code>\u65b9\u6cd5\u6642,\u6703\u5f37\u8febNode\u61c9\u7528\u7a0b\u5f0f\u76e1\u5feb\u5730\u7d42\u6b62\u8a72\u9032\u7a0b,\u5373\u4fbf\u662f\u9084\u6709pending\u72c0\u614b\u4e2d\u7684\u975e\u540c\u6b65\u64cd\u4f5c\u5c1a\u672a\u5b8c\u5168\u5b8c\u6210\u7684\u60c5\u6cc1,\u5305\u62ecI/O\u64cd\u4f5c,\u50cf\u662f<code>process.stdout</code> &amp; <code>process.stderr</code><ul> <li>\u5728\u5927\u591a\u6578\u7684\u60c5\u6cc1\u4e0b,\u5176\u5be6\u6211\u5011\u4e26\u4e0d\u9700\u8981\u660e\u78ba\u5730\u547c\u53eb<code>process.exit()</code>\u65b9\u6cd5\u3002\u56e0\u70ba\u5728\u4e8b\u4ef6\u5faa\u74b0(event loop)\u7576\u4e2d\u6c92\u6709\u984d\u5916pending\u72c0\u614b\u4e2d\u7684\u5de5\u4f5c\u7684\u8a71,Node\u61c9\u7528\u7a0b\u5f0f\u5c31\u6703\u81ea\u884c\u9000\u51fa</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u900f\u904e\u8a2d\u5b9a\u597d<code>process.exitCode</code>\u5c6c\u6027\u7684\u503c,\u4f86\u544a\u77e5\u9032\u7a0b\u5728\u6b63\u5e38\u9000\u51fa\u6642,\u8981\u4f7f\u7528\u54ea\u500b\u9000\u51fa\u78bc</li> </ul> </li> <li>\u60c5\u5883\u8aaa\u660e( \u932f\u8aa4\u793a\u7bc4 )       JavaScript<pre><code>// This is an example of what *not* to do:\nif (someConditionNotMet()) {\n  printUsageToStdout();\n  process.exit(1);\n}\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u78bc\u662f\u4e00\u500b\u4f7f\u7528<code>process.exit()</code>\u7684 \u932f\u8aa4\u793a\u7bc4 ,\u53ef\u80fd\u6703\u56e0\u6b64\u5c0e\u81f4\u8981print\u5230stdout\u7684\u8cc7\u6599\u88ab\u622a\u65b7\u6216\u907a\u5931</li> <li>\u9019\u6a23\u505a\u4e4b\u6240\u4ee5\u6709\u554f\u984c\u7684\u539f\u56e0\u662f\u56e0\u70ba\u5728Node\u7684\u4e16\u754c\u4e2d\u8981\u5beb\u5165\u5230<code>process.stdout</code>\u6709\u6642\u5019\u662f\u975e\u540c\u6b65\u7684(asynchronous),\u4e5f\u53ef\u80fd\u6703\u5728Node\u7684\u4e8b\u4ef6\u8ff4\u5708(event loop)\u4e2d\u591a\u6b21\u767c\u751f</li> <li>\u6240\u4ee5\u6211\u5011\u9700\u8981\u5728\u984d\u5916\u5beb\u5165\u5230stdout\u4e4b\u5f8c,\u624d\u80fd\u547c\u53ebprocess.exit()\u4f86\u5f37\u5236\u5c07\u8a72\u9032\u7a0b\u9000\u51fa</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc( \u6b63\u78ba\u505a\u6cd5 )       JavaScript<pre><code>// How to properly set the exit code while letting\n// the process exit gracefully.\nif (someConditionNotMet()) {\n  printUsageToStdout();\n  process.exitCode = 1;\n}\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u78bc\u662f\u6b63\u78ba\u7684\u89e3\u6c7a\u65b9\u6cd5,\u6211\u5011\u61c9\u8a72\u8981\u5148\u8a2d\u5b9a\u597d<code>process.exitCode</code>\u5c6c\u6027\u7684\u503c,\u800c\u4e0d\u662f\u76f4\u63a5\u547c\u53eb<code>process.exit()</code>\u65b9\u6cd5,\u4e26\u907f\u514d\u70ba\u4e8b\u4ef6\u8ff4\u5708(event loop)\u5b89\u6392\u984d\u5916\u7684\u5de5\u4f5c\u4f86\u5141\u8a31\u8a72\u9032\u7a0b\u80fd\u81ea\u7136\u5730\u9000\u51fa</li> <li>\u5982\u679c\u662f\u56e0\u70ba\u9047\u5230\u932f\u8aa4\u60c5\u6cc1\u800c\u6709\u5fc5\u8981\u5f37\u5236\u7d42\u6b62\u8a72\u9032\u7a0b\u7684\u8a71,\u53ef\u4ee5\u62cb\u51fa\u4e00\u500b<code>uncaught error</code>,\u4e26\u6839\u64da\u9019\u500b\u932f\u8aa4\u4f86\u7d42\u6b62\u8a72\u9032\u7a0b,\u4e5f\u6703\u6bd4\u76f4\u63a5\u547c\u53eb<code>process.exit()</code>\u4f86\u5f97\u66f4\u5b89\u5168</li> </ul> </li> <li>\u5728Worker threads\u4e2d,<code>process.exit()</code>\u6703\u505c\u6b62\u7576\u524d\u7684\u7dda\u7a0b(current thread),\u800c\u4e0d\u662f\u7576\u524d\u7684\u9032\u7a0b(current process)</li> <li>process.kill(pid[ ,signal])</li> <li>args<ul> <li>pid: (number)</li> <li>\u7d66\u5b9a\u4e00\u500b\u9032\u7a0b(process) ID</li> <li>signal: (string || number)</li> <li>\u4ee5\u5b57\u4e32\u6216\u662f\u6578\u503c\u7684\u5f62\u5f0f\u4f86\u767c\u9001\u4fe1\u865f</li> <li>\u9810\u8a2d\u503c: <code>SIGTERM</code></li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u5c07\u4fe1\u865f(signal)\u767c\u9001\u7d66\u6307\u5b9a<code>pid</code>\u7684\u9032\u7a0b(process)</li> <li>\u4fe1\u865f\u7684\u540d\u7a31\u70ba\u5b57\u4e32\u578b\u5225,\u5e38\u898b\u7684\u50cf\u662f<code>SIGINT</code>, <code>SIGHUP</code></li> <li>\u7576\u7d66\u5b9a\u7684\u76ee\u6a19<code>pid</code>\u4e0d\u5b58\u5728\u6642,\u8a72\u65b9\u6cd5\u6703\u62cb\u51fa\u932f\u8aa4\u3002\u4f5c\u70ba\u7279\u6b8a\u60c5\u6cc1\u6642,\u53ef\u4ee5\u5229\u7528<code>0</code>\u4f5c\u70ba\u4fe1\u865f\u4f86\u6e2c\u8a66\u67d0\u500b<code>pid</code>\u7684\u9032\u7a0b\u662f\u5426\u5b58\u5728<ul> <li>\u7576\u5728Windows\u4f5c\u696d\u7cfb\u7d71\u6642,\u60f3\u780d\u6389\u4e00\u500b\u9032\u7a0b\u7fa4\u7d44(kill a process group)\u6703\u62cb\u51fa\u4e00\u500b\u932f\u8aa4</li> </ul> </li> <li>\u5176\u5be6<code>process.kill()</code>\u9019\u500b\u65b9\u6cd5\u53ea\u662f\u4e00\u500b\u4fe1\u865f\u767c\u9001\u5668(signal sender),\u5c31\u5982\u540c $<code>kill</code> \u7684\u7cfb\u7d71\u6307\u4ee4\u4e00\u6a23<ul> <li>\u6bd4\u8d77\u55ae\u7d14\u7684\u7cfb\u7d71\u6307\u4ee4 $<code>kill</code>,\u767c\u9001\u4fe1\u865f\u7684\u9019\u500b\u65b9\u6cd5\u53ef\u80fd\u6703\u984d\u5916\u505a\u4e00\u4e9b\u5176\u4ed6\u7684\u4e8b,\u800c\u4e0d\u55ae\u7d14\u53ea\u662f\u780d\u6389\u76ee\u6a19\u9032\u7a0b(kill the target process)</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc       JavaScript<pre><code>process.on('SIGHUP', () =&gt; {\n  console.log('Got SIGHUP signal.');\n});\n\nsetTimeout(() =&gt; {\n  console.log('Exiting.');\n  process.exit(0);\n}, 100);\n\nprocess.kill(process.pid, 'SIGHUP');\n</code></pre><ul> <li>\u7576Node\u61c9\u7528\u7a0b\u5f0f\u7684\u9032\u7a0b\u6536\u5230<code>SIGUSR1</code>\u7684\u4fe1\u865f\u6642,Node\u6703\u555f\u52d5\u4e00\u500b\u5075\u932f\u5668(debugger)</li> <li>\u53ef\u53c3\u8003Signal events</li> </ul> </li> <li>process.nextTick(callback[ ,...args])</li> <li>args<ul> <li>callback: (Function)</li> <li>\u56de\u547c\u51fd\u5f0f </li> <li>...args: (any)</li> <li>\u7576\u6709\u547c\u53ebcallback function\u6642,\u8981\u9644\u52a0\u7d66\u8a72\u56de\u547c\u51fd\u5f0f\u7684\u53c3\u6578\u5011</li> <li>\u8a72\u65b9\u6cd5\u6703\u65b0\u589e\u4e00\u500b<code>callback function</code>\u5230\"next tick queue\"\u3002\u7576Javascript\u5806\u758a(stack)\u7576\u524d\u7684\u64cd\u4f5c\u57f7\u884c\u5b8c\u6210\u4e26\u5141\u8a31\u4e8b\u4ef6\u8ff4\u5708(event loop)\u7e7c\u7e8c\u4e4b\u524d,\u8a72\u4f47\u5217(queue)\u6703\u5b8c\u5168\u8017\u76e1(fully drained)</li> <li>\u5982\u679c\u8981\u5faa\u74b0\u5730\u91cd\u8907\u547c\u53eb<code>process.nextTick()</code>,\u53ef\u80fd\u6703\u5efa\u7acb\u4e00\u500b\u7121\u9650\u5faa\u74b0\u7684\u8ff4\u5708(infinite loop)</li> <li>\u76f8\u95dc\u80cc\u666f\u77e5\u8b58\u53ef\u53c3\u8003Event Loop\u7ae0\u7bc0\u7684\u4ecb\u7d39</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc       JavaScript<pre><code>console.log('start');\nprocess.nextTick(() =&gt; {\n  console.log('nextTick callback');\n});\nconsole.log('scheduled');\n// Output:\n// start\n// scheduled\n// nextTick callback\n</code></pre></li> <li>process.nextTick()\u65b9\u6cd5\u5728\u958b\u767cAPI\u6642\u5f88\u91cd\u8981,\u4ee5\u4fbf\u7d66\u7528\u6236\u5728\u7269\u4ef6\u88ab\u69cb\u5efa(constructed) \u4e4b\u5f8c ,\u4f46\u662f\u5728\u4efb\u4f55I/O\u76f8\u95dc\u64cd\u4f5c\u767c\u751f \u4e4b\u524d ,\u4f86\u6307\u6d3e\u4e8b\u4ef6\u8655\u7406\u5668(assign event handlers)       JavaScript<pre><code>function MyThing(options) {\n  this.setupOptions(options);\n\n  process.nextTick(() =&gt; {\n    this.startDoingStuff();\n  });\n}\n\nconst thing = new MyThing();\nthing.getReadyForStuff();\n\n// thing.startDoingStuff() gets called now, not before.\n</code></pre></li> <li>\u5c0d\u65bcAPI\u4f86\u8aaa,\u8981\u99ac 100%\u540c\u6b65 or 100%\u975e\u540c\u6b65,\u662f\u5f88\u91cd\u8981\u7684\u4e8b\u60c5<ul> <li>\u60c5\u5883\u8aaa\u660e( \u932f\u8aa4\u793a\u7bc4 )     JavaScript<pre><code>// WARNING!  DO NOT USE!  BAD UNSAFE HAZARD!\nfunction maybeSync(arg, cb) {\n  if (arg) {\n    cb();\n    return;\n  }\n\n  fs.stat('file', cb);\n}\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u662f\u5192\u96aa\u7684(hazardous),\u56e0\u70ba\u5047\u8a2d\u6211\u5011\u9047\u5230\u4ee5\u4e0b\u7684\u60c5\u6cc1</li> <li>\u63a5\u4e0b\u4f86\u7684\u60c5\u6cc1\u6703\u9020\u6210\u4e0d\u6e05\u695a\u5230\u5e95\u662ffoo() \u6216\u662f bar()\u5148\u88ab\u547c\u53eb</li> <li>\u60c5\u5883\u8aaa\u660e( \u932f\u8aa4\u793a\u7bc4 )     JavaScript<pre><code>const maybeTrue = Math.random() &gt; 0.5;\n\nmaybeSync(maybeTrue, () =&gt; {\n  foo();\n});\n\nbar();\n</code></pre></li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc( \u6b63\u78ba\u505a\u6cd5 )</li> <li>\u4ee5\u4e0b\u7684\u505a\u6cd5\u6703\u6bd4\u8f03\u597d      JavaScript<pre><code>function definitelyAsync(arg, cb) {\n  if (arg) {\n    process.nextTick(cb);\n    return;\n  }\n\n  fs.stat('file', cb);\n}\n</code></pre></li> </ul> </li> <li>process.send(message[, sendHandle[, options]][, callback])</li> <li>args<ul> <li>message: (Object)</li> <li>sendHandle ([net.Server])(https://nodejs.org/api/net.html#net_class_net_server) || net.Socket)</li> <li>options: (Object)</li> <li>\u88ab\u7528\u4f5c\u5c07\u7279\u5b9a\u64cd\u4f5c\u985e\u578b\u7684\u767c\u9001\u53c3\u6578\u5316</li> <li><code>options</code>\u4e5f\u652f\u63f4\u4ee5\u4e0b\u7684\u5c6c\u6027<ul> <li><code>keepOpen</code>: (boolean)</li> <li>\u7576\u5728\u50b3\u905e<code>net.Socket</code>\u7684\u5be6\u4f8b\u5011(instances)\u6642,\u53ef\u4ee5\u7528\u4f86\u50b3\u905e\u7684\u503c</li> <li>\u9810\u8a2d\u503c: false</li> <li>\u7576<code>keepOpen</code>=true\u6642, <code>socket</code>\u6703\u5728\u767c\u9001\u904e\u7a0b(sending process)\u4e2d\u4fdd\u6301\u958b\u653e</li> </ul> </li> </ul> </li> <li>Returns: (boolean)<ul> <li>\u5982\u679c\u662f\u5229\u7528<code>IPC channel</code>\u4f86\u7522\u751fNode\u61c9\u7528\u7a0b\u5f0f\u7684\u8a71,<code>process.send()</code>\u65b9\u6cd5\u53ef\u4ee5\u7528\u4f86\u50b3\u905e\u8a0a\u606f\u7d66\u7236\u9032\u7a0b(parent process)</li> <li>\u6d88\u606f(message)\u6703\u88abparent's ChildProcess\u7269\u4ef6\u4f5c\u70bamessage event\u4f86\u63a5\u6536</li> <li>\u5982\u679c\u672a\u4f7f\u7528<code>IPC channel</code>\u4f86\u7522\u751fNode\u61c9\u7528\u7a0b\u5f0f\u7684\u8a71,\u5247<code>process.send()</code>\u56de\u50b3\u7684\u7d50\u679c\u5c07\u6703\u662f<code>undefined</code></li> <li>\u8a72\u8a0a\u606f(message)\u5df2\u7d93\u6b77\u904e\u5e8f\u5217\u5316(serialization)\u8207\u89e3\u6790(parsing)</li> <li>\u7d50\u679c\u6d88\u606f(resulting message)\u53ef\u80fd\u6703\u8ddf\u6700\u521d\u767c\u9001\u7684\u6d88\u606f\u4e0d\u592a\u4e00\u6a23</li> </ul> </li> <li>process.uptime()</li> <li>Returns: (number)</li> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3\u7576\u524dNode\u61c9\u7528\u7a0b\u5f0f\u5df2\u7d93\u904b\u884c\u591a\u4e45\u7684\u79d2\u6578<ul> <li>\u56de\u50b3\u503c\u6703\u5305\u62ec\u542b\u6709\u5c0f\u6578\u9ede\u7684\u79d2\u6578,\u53ef\u4ee5\u5229\u7528Math.floor()\u4f86\u7b97\u51fa\u5c0f\u65bc\u7b49\u65bc\u6240\u7d66\u6578\u5b57\u7684\u6700\u5927\u6574\u6578</li> <li>\u4f8b: $ <code>Math.floor(5.95)</code> =&gt; <code>5</code> <p>property</p> </li> </ul> </li> <li>process.argv</li> <li>Type: (string) </li> <li>\u8a72\u5c6c\u6027\u6703\u56de\u50b3\u4e00\u500b\u9663\u5217(array),\u8a72\u9663\u5217\u6703\u5305\u542b\u7576\u555f\u52d5Node\u61c9\u7528\u7a0b\u5f0f\u7684\u9032\u7a0b\u7684\u6642\u5019,\u6574\u500b\u547d\u4ee4\u5217(command-line)\u8981\u50b3\u905e\u7684\u6240\u6709\u53c3\u6578<ul> <li>\u5176\u4e2d\u7684\u7b2c\u4e00\u500b\u5143\u7d20\u6703\u662fprocess.execPath</li> <li>\u7b2c\u4e8c\u500b\u5143\u7d20\u6703\u662f\u6b63\u5728\u88ab\u57f7\u884c\u7684Javascript\u6a94\u6848\u7684\u8def\u5f91\u4f4d\u7f6e</li> <li>\u5269\u4e0b\u7684\u5143\u7d20\u5c31\u662f\u4efb\u4f55\u5176\u4ed6\u7684\u547d\u4ee4\u5217\u53c3\u6578(command-line arguments)</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc<ul> <li>\u5047\u8a2d\u4ee5\u4e0b\u7bc4\u4f8b\u7a0b\u5f0f\u7684\u6a94\u6848\u540d\u7a31\u662f<code>process-args.js</code> JavaScript<pre><code>// print process.argv\nprocess.argv.forEach((val, index) =&gt; {\n  console.log(`${index}: ${val}`);\n});\n</code></pre></li> <li>\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u7684\u65b9\u5f0f\u4f86\u555f\u52d5Node\u61c9\u7528\u7a0b\u5f0f\u7684\u9032\u7a0b(process)</li> <li>$ <code>node process-args.js one two=three four</code></li> <li>\u5c07\u6703\u56de\u50b3\u4ee5\u4e0b\u7684\u503c     JavaScript<pre><code>0: /usr/local/bin/node\n1: /Users/mjr/work/node/process-args.js\n2: one\n3: two=three\n4: four\n</code></pre></li> </ul> </li> <li>process.debugPort</li> <li>Type: (number)</li> <li>\u8a72\u5c6c\u6027\u503c\u4ee3\u8868\u7576\u555f\u7528(enabled)Node\u61c9\u7528\u7a0b\u5f0f\u7684\u9664\u932f\u5668\u6642(dubugger),\u6240\u4f7f\u7528\u7684\u57e0\u865f(port)</li> <li>process.env</li> <li>Type: (Object) </li> <li>\u8a72\u5c6c\u6027\u6703\u56de\u50b3\u4e00\u500b\u7269\u4ef6,\u5305\u542b\u4f7f\u7528\u8005\u7684\u74b0\u5883\u8b8a\u6578<ul> <li>\u50cf\u662f\u4ee5\u4e0b\u7684<code>Object</code> JavaScript<pre><code>{\n  TERM: 'xterm-256color',\n  SHELL: '/usr/local/bin/bash',\n  USER: 'maciej',\n  PATH: '~/.bin/:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin',\n  PWD: '/Users/maciej',\n  EDITOR: 'vim',\n  SHLVL: '1',\n  HOME: '/Users/maciej',\n  LOGNAME: 'maciej',\n  _: '/usr/local/bin/node'\n} \n</code></pre></li> <li>\u53ef\u4ee5\u4fee\u6539\u9019\u500b\u74b0\u5883\u8b8a\u6578\u7684\u7269\u4ef6,\u4f46\u50c5\u9650\u65bc\u8a72Node\u61c9\u7528\u7a0b\u5f0f\u9032\u7a0b(process),\u6216\u8005\u9664\u975e\u660e\u78ba\u5730\u8981\u6c42\u4e0d\u6703\u53cd\u61c9\u5230\u5176\u4ed6Worker threads\u4e0a</li> <li>\u63db\u53e5\u8a71\u8aaa,\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u4e26\u4e0d\u6703\u5982\u9810\u671f\u5730\u904b\u4f5c</li> <li>$ <code>node -e 'process.env.foo = \"bar\"' &amp;&amp; echo $foo</code></li> <li>\u96d6\u7136\u5c07\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c     JavaScript<pre><code>process.env.foo = 'bar';\nconsole.log(process.env.foo);\n</code></pre></li> </ul> </li> <li>\u5f9eNode v10.0.0\u7684\u7248\u672c\u4ee5\u5f8c\u958b\u59cb,\u6307\u6d3e\u7d66<code>process.env</code>\u7684\u74b0\u5883\u8b8a\u6578\u7684\u503c \u4e0d\u6703 \u518d\u505a\u96b1\u6027\u8f49\u63db\u578b\u5225<ul> <li>\u6240\u4ee5\u4ee5\u4e0b\u7684\u65b9\u5f0f \u4e0d\u5efa\u8b70 \u518d\u4f7f\u7528</li> <li>\u60c5\u5883\u8aaa\u660e( \u932f\u8aa4\u793a\u7bc4 ) JavaScript<pre><code>process.env.test = null;\nconsole.log(process.env.test);\n// =&gt; 'null'\nprocess.env.test = undefined;\nconsole.log(process.env.test);\n// =&gt; 'undefined'\n</code></pre></li> </ul> </li> <li>\u5982\u679c\u8981\u5f9e<code>process.env</code>\u7684\u5c6c\u6027\u503c\u4e2d,\u522a\u9664Node\u61c9\u7528\u7a0b\u5f0f\u7684\u74b0\u5883\u8b8a\u6578\u7684\u8a71,\u53ef\u4ee5\u5229\u7528Javascript\u7684<code>delete</code>\u6307\u4ee4\u4f86\u5b8c\u6210<ul> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>process.env.TEST = 1;\ndelete process.env.TEST;\nconsole.log(process.env.TEST);\n// =&gt; undefined\n</code></pre></li> </ul> </li> <li>\u5728Windows\u4f5c\u696d\u7cfb\u7d71\u4e2d,\u74b0\u5883\u8b8a\u6578\u6c92\u6709\u5340\u5206\u5927\u5c0f\u5beb(case-insensitive)<ul> <li>\u4ee5\u4e0b\u7bc4\u4f8b\u7a0b\u5f0f\u78bc \u50c5\u9650\u65bcWindows\u4f5c\u696d\u7cfb\u7d71\u4e2d \u53ef\u4ee5\u9019\u6a23\u4f7f\u7528   JavaScript<pre><code>process.env.TEST = 1;\nconsole.log(process.env.test);\n// =&gt; 1\n</code></pre></li> </ul> </li> <li>\u9664\u975e\u5728\u5efa\u7acbWorker\u5be6\u4f8b\u6642\u6709\u660e\u78ba\u6307\u5b9a\u74b0\u5883\u8b8a\u6578,\u4e0d\u7136\u6bcf\u500b<code>Worker thread</code>\u90fd\u6709\u81ea\u5df1\u7684\u4e00\u4efd<code>process.env</code>\u526f\u672c(copy),\u662f\u57fa\u65bc\u5b83\u5011\u5404\u81ea\u7684\u7236\u7dda\u7a0b(parent thread)\u7684\u74b0\u5883\u8b8a\u6578(<code>process.env</code>),\u6216\u662f\u4efb\u4f55\u88ab\u4f5c\u70ba<code>env</code>\u9078\u9805\u4e26\u7d66\u5b9a\u5230<code>Worker constructor</code><ul> <li><code>Worker threads</code>\u4e4b\u9593\u4e26\u7121\u6cd5\u770b\u5230<code>process.env</code>\u7684\u4fee\u6539,\u53ea\u6709\u4e3b\u7dda\u7a0b(main thread)\u624d\u80fd\u9032\u884c\u5c0d\u4f5c\u696d\u7cfb\u7d71\u6216\u662f\u672c\u6a5f\u52a0\u8f09\u9805(native add-ons)\u505a\u770b\u5f97\u898b\u7684\u4fee\u6539</li> </ul> </li> <li>process.execArgv</li> <li>Type: (string [set])</li> <li>\u8a72\u5c6c\u6027\u6703\u56de\u50b3\u7576Node\u61c9\u7528\u7a0b\u5f0f\u7684\u9032\u7a0b\u88ab\u555f\u52d5\u6642,\u5728Node.js\u547d\u4ee4\u5217\u4e0a\u9762\u7684\u7279\u5b9a\u9078\u9805\u7684\u96c6\u5408(the set of Node.js-specific command-line options)<ul> <li>\u9019\u908a\u6240\u6307\u7684\u7279\u5b9a\u9078\u9805(options)\u4e26\u4e0d\u6703\u51fa\u73fe\u5728<code>process.argv</code>\u7684\u5c6c\u6027\u503c\u4e4b\u4e2d,\u800c\u4e14\u4e5f\u4e0d\u5305\u62ec\u53ef\u57f7\u884c\u7684(executable),\u8a72\u6e96\u5099\u8981\u57f7\u884c\u7684\u6a94\u6848\u540d\u7a31,\u4ee5\u53ca\u8a72\u6e96\u5099\u8981\u57f7\u884c\u7684\u6a94\u6848\u540d\u7a31 \u5f8c\u9762 \u7684\u4efb\u4f55\u9078\u9805(options)</li> <li>\u9019\u4e9b\u9078\u9805\u5c0d\u65bc\u4ee5\u8207\u7236\u7d1a\u76f8\u540c\u57f7\u884c\u74b0\u5883\u7684\u5b50\u9032\u7a0b(child process)\u662f\u5f88\u6709\u7528\u7684</li> <li>\u5728\u7d42\u7aef\u6a5f(CLI)\u57f7\u884c\u8a72\u4ee5\u4e0b\u7684\u6307\u4ee4\u5f8c</li> <li>\u4f8b: $ <code>node --harmony script.js --version</code></li> <li>\u6aa2\u8996<code>process.execArgv</code>\u7684\u5c6c\u6027\u503c\u6703\u5f97\u5230<ul> <li>=&gt; <code>['--harmony']</code></li> </ul> </li> <li>\u5c0d\u7167\u6aa2\u8996<code>process.argv</code>\u7684\u5c6c\u6027\u503c\u6703\u5f97\u5230<ul> <li>=&gt; <code>['/usr/local/bin/node', 'script.js', '--version']</code></li> </ul> </li> <li>\u53ef\u53c3\u8003\u6709\u95dcWorker constructor\u4e2d\u7684<code>execArgv</code>\u5c6c\u6027\u4ee5\u4e86\u89e3\u66f4\u591a\u7684\u8a0a\u606f</li> </ul> </li> <li>process.execPath</li> <li>Type: (string)</li> <li>\u8a72\u5c6c\u6027\u503c\u6703\u56de\u50b3Node\u61c9\u7528\u7a0b\u5f0f\u7684\u9032\u7a0b\u4e2d\u7684\u53ef\u57f7\u884c\u6587\u4ef6(executable)\u7684\u7d55\u5c0d\u8def\u5f91<ul> <li>\u4f8b: <code>'/usr/local/bin/node'</code> </li> <li>\u5982\u679c\u9047\u5230\u53ef\u57f7\u884c\u6587\u4ef6\u7684\u8def\u5f91\u662f<code>symbolic link</code>,\u6703\u81ea\u52d5\u89e3\u6c7a\u6389\u8a72\u554f\u984c </li> </ul> </li> <li>process.exitCode</li> <li>\u578b\u5225: (integer)</li> <li>\u7576\u9032\u7a0b\u88ab\u6b63\u5e38\u5730\u9000\u51fa\u6642,\u6216\u662f\u900f\u904e<code>process.exit()</code>\u65b9\u6cd5\u9000\u51fa\u6642\u4f46\u6c92\u6709\u7d66\u5b9a\u9000\u51fa\u78bc\u6642,<code>process.exitCode</code>\u7684\u5c6c\u6027\u503c\u4ee3\u8868\u8a72\u9032\u7a0b\u7684\u9000\u51fa\u78bc</li> <li>\u7576\u6211\u5011\u7d66\u5b9aprocess.exit([code])\u65b9\u6cd5\u7684\u9000\u51fa\u78bc\u53c3\u6578\u503c\u6642,\u6703\u63a8\u7ffb(override)\u4e4b\u524d\u7684<code>process.exitCode</code>\u7684\u5c6c\u6027\u503c\u8a2d\u5b9a</li> <li>process.pid</li> <li>Type: (integer)</li> <li>\u8a72\u5c6c\u6027\u6703\u56de\u50b3\u8a72\u9032\u7a0b\u7684ID(process ID, pid)<ul> <li>$ <code>console.log(</code>This process is pid ${process.pid}<code>);</code> </li> </ul> </li> <li>A note on process I/O</li> <li>process.stdin</li> <li>process.stdout</li> <li>process.stderr</li> <li>process.title</li> <li>Type: (string)</li> <li>\u8a72\u5c6c\u6027\u6703\u56de\u50b3\u7576\u524d\u7684\u9032\u7a0b\u6a19\u984c(current process title) =&gt; \u4e5f\u5c31\u662f\u6703\u56de\u50b3\u7576\u524d<code>ps</code>\u7684\u503c</li> <li>\u7576\u6307\u6d3e\u65b0\u7684\u503c\u7d66<code>process.title</code>\u5c6c\u6027\u6642,\u6703\u4fee\u6539\u6389\u7576\u524d<code>ps</code>\u7684\u503c</li> <li>process.version</li> <li>Type: (string)</li> <li>\u8a72\u5c6c\u6027\u503c\u4ee3\u8868Node.js\u7684\u7248\u672c\u865f(version)       JavaScript<pre><code>console.log(`Version: ${process.version}`);\n// Version: v14.8.0\n</code></pre><ul> <li>\u5982\u679c\u60f3\u8981\u53d6\u5f97\u4e0d\u5e36\u6709\u524d\u7db4v\u958b\u982d\u7684\u7248\u672c\u865f\u5b57\u4e32\u7684\u8a71,\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u7684\u5c6c\u6027\u503c</li> <li>$ <code>process.versions.node</code> </li> </ul> </li> </ul> <p>Exit codes(\u9000\u51fa\u78bc) - \u5728\u6c92\u6709\u5176\u4ed6\u984d\u5916\u7684 \u975e\u540c\u6b65\u64cd\u4f5c \u8655\u65bc<code>pending\u72c0\u614b</code>\u5f8c,Node\u61c9\u7528\u7a0b\u5f0f\u901a\u5e38\u6703\u4ee5<code>0</code>\u7684\u9000\u51fa\u78bc\u4f86\u6b63\u5e38\u9000\u51fa - \u4ee5\u4e0b\u662f\u5e38\u898b\u7684\u9000\u51fa\u78bc   + <code>0</code>: \u6b63\u5e38\u9000\u51fa (\u9810\u8a2d\u503c)   + <code>1</code>: \u672a\u6355\u7372\u7684\u81f4\u547d\u932f\u8aa4(Uncaught Fatal Exception),\u4e26\u4e14\u6c92\u6709\u53d7\u5230<code>domain</code>\u6216\u662funcaughtException\u4e8b\u4ef6\u8655\u7406\u5668\u4f86\u8655\u7406   + \u4ee5\u4e0b\u7565...</p>"},{"location":"programming_language/nodejs/#console","title":"Console","text":"<ul> <li><code>console</code>\u6a21\u7d44\u63d0\u4f9b\u4e86\u4e00\u7d44\u7c21\u55ae\u7684\u9664\u932f\u63a7\u5236\u53f0(debugging console),\u985e\u4f3c\u65bc\u7db2\u9801\u700f\u89bd\u5668\u6240\u63d0\u4f9b\u7684Javascript\u63a7\u5236\u53f0\u6a5f\u5236</li> <li><code>console</code>\u6a21\u7d44\u6703\u532f\u51fa(export)\u5169\u500b\u7279\u5b9a\u7684\u5143\u4ef6(specific components)<ul> <li>\u7b2c\u4e00\u500b\u7279\u5b9a\u7684\u5143\u4ef6\u662f: Console\u985e\u5225(class)\u7684\u65b9\u6cd5,\u50cf\u662f<code>console.log()</code>&amp;<code>console.error()</code>&amp;<code>console.warn()</code>,\u5b83\u5011\u53ef\u4ee5\u88ab\u7528\u4f86\u5beb\u5165\u5230Node\u6d41(stream)\u4e2d</li> <li>\u7b2c\u4e8c\u500b\u7279\u5b9a\u7684\u539f\u4ef6\u662f: \u4e00\u500b\u5168\u57df(global)\u7684<code>console</code>\u5be6\u4f8b(instance)\u6703\u5beb\u5165\u5230process.stdout\u8207process.stderr\u3002\u5168\u57df\u7684<code>console</code>\u7269\u4ef6\u53ef\u4ee5\u76f4\u63a5\u88ab\u4f7f\u7528,\u800c \u4e0d\u7528 \u4e8b\u5148\u532f\u5165( require('console') )</li> </ul> </li> <li>\u6ce8\u610f : \u5168\u57df\u7684<code>console</code>\u7269\u4ef6\u65b9\u6cd5\u65e2\u4e0d\u80fd\u50cf\u985e\u4f3c\u5b83\u5011\u7684\u700f\u89bd\u5668API\u4e00\u6a23\u59cb\u7d42\u540c\u6b65(consistently synchronous),\u4e5f\u4e0d\u80fd\u50cfNode\u6d41(streams)\u4e00\u6a23\u59cb\u7d42\u975e\u540c\u6b65(consistently asynchronous)<ul> <li>\u53ef\u53c3\u8003<code>process</code>\u6a21\u7d44\u7684 A note on process I/O \u7ae0\u7bc0</li> </ul> </li> <li>\u4f7f\u7528\u5168\u57df\u7684<code>console\u7269\u4ef6</code>\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc       JavaScript<pre><code>console.log('hello world');\n// Prints: hello world, to stdout\nconsole.log('hello %s', 'world');\n// Prints: hello world, to stdout\nconsole.error(new Error('Whoops, something bad happened'));\n// Prints error message and stack trace to stderr:\n//   Error: Whoops, something bad happened\n//     at [eval]:5:15\n//     at Script.runInThisContext (node:vm:132:18)\n//     at Object.runInThisContext (node:vm:309:38)\n//     at node:internal/process/execution:77:19\n//     at [eval]-wrapper:6:22\n//     at evalScript (node:internal/process/execution:76:60)\n//     at node:internal/main/eval_string:23:3\n\nconst name = 'Will Robinson';\nconsole.warn(`Danger ${name}! Danger!`);\n// Prints: Danger Will Robinson! Danger!, to stderr\n</code></pre></li> <li>\u4f7f\u7528<code>Console\u985e\u5225</code>\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc       JavaScript<pre><code>const out = getStreamSomehow();\nconst err = getStreamSomehow();\nconst myConsole = new console.Console(out, err);\n\nmyConsole.log('hello world');\n// Prints: hello world, to out\nmyConsole.log('hello %s', 'world');\n// Prints: hello world, to out\nmyConsole.error(new Error('Whoops, something bad happened'));\n// Prints: [Error: Whoops, something bad happened], to err\n\nconst name = 'Will Robinson';\nmyConsole.warn(`Danger ${name}! Danger!`);\n// Prints: Danger Will Robinson! Danger!, to err\n</code></pre> <p>Class</p> </li> <li>Class: Console</li> <li><code>Console</code>\u985e\u5225\u53ef\u4ee5\u7528\u4f86\u5efa\u7acb\u7c21\u55ae\u4e14\u53ef\u914d\u7f6e(configurable)\u7684\u8f38\u51fa\u6d41(output streams)\u7d00\u9304\u5668(logger),\u4e26\u4e14\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u5169\u7a2e\u65b9\u5f0f\u4f86\u5b58\u53d6,\u6216\u662f\u7528\u5b83\u5011\u76f8\u4eff\u7684\u89e3\u69cb\u5c0d\u61c9\u7269\u4ef6(destructured counterparts)\u4f86\u5b58\u53d6<ul> <li>\u5b58\u53d6\u65b9\u5f0f\u4e00: <code>require('console').Console</code></li> <li>\u4f8b: <code>const { Console } = require('console');</code></li> <li>\u5b58\u53d6\u65b9\u5f0f\u4e8c: <code>console.Console</code></li> <li>\u4f8b: <code>const { Console } = console;</code> <p>method</p> </li> <li>console.clear()</li> <li>\u7576\u6a19\u6e96\u8f38\u51fa(<code>stdout</code>)\u662f<code>TTY</code>\u6642,\u547c\u53eb<code>console.clear()</code>\u7684\u6642\u5019,\u6703\u5617\u8a66\u6e05\u9664<code>TTY</code>; \u7576\u6a19\u6e96\u8f38\u51fa(<code>stdout</code>)\u4e0d\u662f<code>TTY</code>\u6642,\u5247\u8a72\u65b9\u6cd5\u4e0d\u6703\u505a\u4efb\u4f55\u4e8b\u60c5</li> <li>\u4f7f\u7528\u7279\u5b9a\u7684<code>console.clear()</code>\u64cd\u4f5c\u6642,\u6703\u56e0\u70ba\u4f7f\u7528\u7684\u4f5c\u696d\u7cfb\u7d71\u4e0d\u540cor\u7d42\u7aef\u6a5f\u985e\u578b\u4e0d\u540c,\u800c\u6709\u6240\u5dee\u7570\u3002\u5728\u5927\u90e8\u5206\u7684Linux\u4f5c\u696d\u7cfb\u7d71\u4e2d,<code>console.clear()</code>\u65b9\u6cd5\u6703\u57f7\u884c\u8207<code>clear</code>\u6307\u4ee4\u5dee\u4e0d\u591a\u7684\u64cd\u4f5c; \u5728Windows\u4f5c\u696d\u7cfb\u7d71\u4e2d,<code>console.clear()</code>\u5c07\u50c5\u6703\u6e05\u9664\u6389\u5728\u7576\u524d(current)\u7684\u7d42\u7aef\u6a5f\u8996\u53e3(terminal viewport)\u4e2d\u7684Node\u61c9\u7528\u7a0b\u5f0f\u7684\u4e8c\u9032\u5236(binary)\u6587\u4ef6\u7684\u8f38\u51fa(output)</li> <li>console.count([label])</li> <li>args<ul> <li>label: (string)</li> <li>\u53ef\u4ee5\u7d66\u5b9a\u8981\u986f\u793a\u7684\u8a08\u6578\u5668\u7684\u6a19\u7c64\u503c</li> <li>\u9810\u8a2d\u503c: <code>default</code></li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u56de\u50b3\u4e00\u500b\u5167\u90e8\u8a08\u6578\u5668(internal counter)\u7dad\u6301\u986f\u793a\u4e00\u7d44<code>\u6a19\u7c64</code>(label) &amp; <code>\u6b21\u6578</code>(times)<ul> <li><code>\u6a19\u7c64</code>(label): \u53ef\u4ee5\u900f\u904e\u547c\u53eb<code>console.count()</code>\u65b9\u6cd5\u6642,\u7531\u958b\u767c\u8005\u7d66\u5b9a\u6a19\u7c64\u503c</li> <li><code>\u6b21\u6578</code>(times): \u6307\u5b9a\u7d66\u6a19\u7c64,\u547c\u53eb<code>console.count()</code>\u65b9\u6cd5\u4e26\u8f38\u51fa\u7d66<code>stdout</code>\u7684\u6b21\u6578</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc</li> <li><code>console     &gt; console.count()     default: 1     undefined     &gt; console.count('default')     default: 2     undefined     &gt; console.count('abc')     abc: 1     undefined     &gt; console.count('xyz')     xyz: 1     undefined     &gt; console.count('abc')     abc: 2     undefined     &gt; console.count()     default: 3     undefined     &gt;</code></li> </ul> </li> <li>console.error([data][, ...args])</li> <li>args<ul> <li>data: (any)</li> <li>...args: (any)</li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u7528\u65b0\u7684\u4e00\u884c(newline)\u6253\u5370(print)\u51fa\u6a19\u6e96\u932f\u8aa4(<code>stderr</code>)</li> <li>\u8a72\u65b9\u6cd5\u53ef\u4ee5\u50b3\u905e\u591a\u500b\u53c3\u6578<ul> <li>\u7b2c\u4e00\u500b\u53c3\u6578\u6703\u88ab\u7528\u4f86\u7576\u4f5c\u4e3b\u8981\u8a0a\u606f(primary message)</li> <li>\u5176\u4ed6\u984d\u5916\u7684\u53c3\u6578(additional arguments)\u6703\u88ab\u7528\u4f5c\u66ff\u63db\u503c(substitution),\u985e\u4f3c\u65bcprintf(3)</li> <li>\u5176\u4ed6\u984d\u5916\u7684\u53c3\u6578\u90fd\u6703\u88ab\u50b3\u905e\u7d66<code>util.format()</code>\u65b9\u6cd5</li> <li>\u76f8\u95dc\u8cc7\u8a0a\u53ef\u53c3\u8003util.format()\u65b9\u6cd5</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const code = 5;\nconsole.error('error #%d', code);\n// Prints: error #5, to stderr\nconsole.error('error', code);\n// Prints: error 5, to stderr\n</code></pre><ul> <li>\u82e5\u683c\u5f0f\u5316\u5143\u7d20(formatted elements),\u4f8b\u5982: <code>%d</code>\u6c92\u6709\u5728\u65b0\u7684\u4e00\u884c\u4e2d\u88ab\u767c\u73fe,\u5247util.inspect()\u65b9\u6cd5\u6703\u88ab\u547c\u53eb,\u4e26\u5728\u6bcf\u500b\u53c3\u6578\u4e0a\u547c\u53eb\u8a72\u5143\u7d20(<code>%d</code>),\u4e26\u5c07\u7d50\u679c\u7684\u5b57\u4e32\u503c\u9023\u63a5\u8d77\u4f86</li> </ul> </li> <li>console.log([data][, ...args])</li> <li>args<ul> <li>data: (any)</li> <li>...args: (any)</li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u7528\u65b0\u7684\u4e00\u884c(newline)\u6253\u5370(print)\u51fa\u6a19\u6e96\u8f38\u51fa(<code>stdout</code>)</li> <li>\u8a72\u65b9\u6cd5\u53ef\u4ee5\u50b3\u905e\u591a\u500b\u53c3\u6578<ul> <li>\u7b2c\u4e00\u500b\u53c3\u6578\u6703\u88ab\u7528\u4f86\u7576\u4f5c\u4e3b\u8981\u8a0a\u606f(primary message)</li> <li>\u5176\u4ed6\u984d\u5916\u7684\u53c3\u6578(additional arguments)\u6703\u88ab\u7528\u4f5c\u66ff\u63db\u503c(substitution),\u985e\u4f3c\u65bcprintf(3)</li> <li>\u5176\u4ed6\u984d\u5916\u7684\u53c3\u6578\u90fd\u6703\u88ab\u50b3\u905e\u7d66<code>util.format()</code>\u65b9\u6cd5</li> <li>\u76f8\u95dc\u8cc7\u8a0a\u53ef\u53c3\u8003util.format()\u65b9\u6cd5</li> </ul> </li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const count = 5;\nconsole.log('count: %d', count);\n// Prints: count: 5, to stdout\nconsole.log('count:', count);\n// Prints: count: 5, to stdout\n</code></pre></li> <li>console.time([label])</li> <li>args<ul> <li>label: (string)</li> <li>\u53ef\u4ee5\u7d66\u5b9a\u8a72\u8a08\u6642\u5668\u7684\u6a19\u7c64\u503c,\u4ee5\u4f5c\u70ba\u8a08\u6642\u5668\u8b58\u5225\u7528</li> <li>\u9810\u8a2d\u503c: <code>default</code></li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u555f\u52d5\u4e00\u500b\u8a08\u6642\u5668(timer)\u88ab\u7528\u4f86\u8a08\u7b97\u8a72\u64cd\u4f5c(operation)\u7684\u6301\u7e8c\u6642\u9593</li> <li>\u8a08\u6642\u5668\u6703\u7528\u7368\u4e00\u7121\u4e8c(unique)\u7684\u6a19\u7c64(label)\u4f86\u8b58\u5225</li> <li>\u8a08\u6642\u5668\u6703\u547c\u53eb\u540c\u6a19\u7c64(same label)\u7684<code>console.timeEnd()</code>\u65b9\u6cd5\u4f86\u505c\u6b62\u8a08\u6642\u5668,\u4e26\u5c07\u7d93\u904e\u7684\u6642\u9593\u4ee5\u5408\u9069\u7684\u6642\u9593\u55ae\u4f4d\u8f38\u51fa\u5230\u6a19\u6e96\u8f38\u51fa(<code>stdout</code>)\u4e2d<ul> <li>\u8209\u4f8b\u4f86\u8aaa,\u5982\u679c\u7d93\u904e\u7684\u6642\u9593\u662f3869\u6beb\u79d2(ms),\u90a3\u9ebc<code>console.timeEnd()</code>\u65b9\u6cd5\u6703\u986f\u793a\"3.869\"\u79d2</li> </ul> </li> <li>console.timeEnd([label])</li> <li>args<ul> <li>label: (string)</li> <li>\u53ef\u4ee5\u7d66\u5b9a\u8a72\u8a08\u6642\u5668\u7684\u6a19\u7c64\u503c,\u4ee5\u4f5c\u70ba\u8a08\u6642\u5668\u8b58\u5225\u7528</li> <li>\u9810\u8a2d\u503c: <code>default</code></li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u505c\u6b62\u4e4b\u524d\u900f\u904e\u547c\u53eb<code>console.time()</code>\u65b9\u6cd5\u8a2d\u5b9a\u597d\u7684\u8a08\u6642\u5668,\u4e26\u5c07\u7d50\u679c\u6253\u5370(print)\u5230\u6a19\u6e96\u8f38\u51fa(<code>stdout</code>)\u4e2d</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>console.time('100-elements');\nfor (let i = 0; i &lt; 100; i++) {}\nconsole.timeEnd('100-elements');\n// prints 100-elements: 225.438ms\n</code></pre></li> <li>console.trace([message][, ...args])</li> <li>args<ul> <li>message: (any)</li> <li>...args: (any)</li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u5c07<code>Trace:</code>\u9019\u6bb5\u5b57\u4e32\u6253\u5370(print)\u5230\u6a19\u6e96\u932f\u8aa4(<code>stderr</code>)\u4e2d,\u63a5\u8457\u900f\u904eutil.format()\u65b9\u6cd5\u6253\u5370\u51fa\u683c\u5f0f\u5316\u904e\u7684\u5b57\u4e32(formatted message),\u4e26\u5806\u68e7\u8ffd\u8e64(stack trace)\u5230\u7a0b\u5f0f\u78bc\u4e2d\u7684\u7576\u524d\u4f4d\u7f6e</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>console.trace('Show me');\n// Prints: (stack trace will vary based on where trace is called)\n//  Trace: Show me\n//    at repl:2:9\n//    at REPLServer.defaultEval (repl.js:248:27)\n//    at bound (domain.js:287:14)\n//    at REPLServer.runBound [as eval] (domain.js:300:12)\n//    at REPLServer.&lt;anonymous&gt; (repl.js:412:12)\n//    at emitOne (events.js:82:20)\n//    at REPLServer.emit (events.js:169:7)\n//    at REPLServer.Interface._onLine (readline.js:210:10)\n//    at REPLServer.Interface._line (readline.js:549:8)\n//    at REPLServer.Interface._ttyWrite (readline.js:826:14)\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#readline","title":"Readline","text":"<ul> <li><code>Readline</code>\u6a21\u7d44\u63d0\u4f9b\u4e00\u500b\u4ecb\u9762\u80fd\u5f9eReadable stream\u4e00\u6b21\u4e00\u884c\u5730\u8b80\u53d6\u6578\u64da,\u5b83\u53ef\u4ee5\u7528\u4ee5\u4e0b\u7684\u65b9\u5f0f\u4f86\u5b58\u53d6     JavaScript<pre><code>const readline = require('readline');\n</code></pre></li> <li>\u4ee5\u4e0b\u662f<code>readline</code>\u6a21\u7d44\u7684\u7c21\u6613\u7bc4\u4f8b\u7684\u5716\u89e3\u8aaa\u660e     JavaScript<pre><code>const readline = require('readline');\n\nconst rl = readline.createInterface({\n  input: process.stdin,\n  output: process.stdout\n});\n\nrl.question('What do you think of Node.js? ', (answer) =&gt; {\n  // TODO: Log the answer in a database\n  console.log(`Thank you for your valuable feedback: ${answer}`);\n\n  rl.close();\n});\n</code></pre><ul> <li>\u4e00\u65e6\u4ee5\u4e0a\u7684\u7a0b\u5f0f\u78bc\u88ab\u547c\u53eb\u5f8c,Node\u61c9\u7528\u7a0b\u5f0f\u5c31\u4e0d\u6703\u7d42\u6b62,\u76f4\u5230readline.Interface\u9019\u500b\u4ecb\u9762\u88ab\u95dc\u9589\u70ba\u6b62,\u56e0\u70ba\u9019\u500b\u4ecb\u9762\u6703\u7b49\u5f85\u8f38\u5165\u6d41(input stream)\u63a5\u6536\u5230\u6578\u64da\u70ba\u6b62 <p>Class</p> </li> </ul> </li> <li>Class: Interface<ul> <li>\u7e7c\u627f(Extends): (EventEmitter)</li> </ul> </li> <li><code>reader.Interface</code>\u7684\u5be6\u4f8b(instances)\u662f\u900f\u904ereadline.createInterface()\u65b9\u6cd5\u5efa\u9020\u7684<ul> <li>\u6bcf\u4e00\u500b\u5be6\u4f8b\u90fd\u6703\u8207\u55ae\u4e00\u7684\u8f38\u5165\u53ef\u8b80\u53d6\u6d41(input Readable stream) &amp; \u55ae\u4e00\u7684\u8f38\u51fa\u53ef\u5beb\u5165\u6d41(output Writable stream)</li> <li>\u8f38\u51fa\u6d41\u6703\u88ab\u7528\u4f86\u5f9e\u8f38\u5165\u6d41(input stream)\u4e2d\u8b80\u53d6\u4f7f\u7528\u8005\u7684\u8f38\u5165(input)\u4e26\u6253\u5370\u51fa\u63d0\u793a(prompts) <p>method</p> </li> <li>readline.question(query, callback)<ul> <li>args</li> <li>query (string)<ul> <li>\u8981\u5beb\u5165\u5230\u8f38\u51fa(<code>output</code>)\u7684\u9673\u8ff0\u53e5(statement)\u6216\u662f\u67e5\u8a62\u8a9e\u53e5(<code>query</code>),\u4f4d\u65bc\u63d0\u793a\u4e4b\u524d(prepended to the prompt)</li> </ul> </li> <li>callback (Function)<ul> <li>\u900f\u904e\u4f7f\u7528\u8005\u5c0d\u67e5\u8a62\u8a9e\u53e5(<code>query</code>)\u7684\u56de\u61c9(response)\u4f86\u547c\u53eb\u7684\u56de\u547c\u51fd\u5f0f</li> </ul> </li> <li>\u8a72\u65b9\u6cd5\u6703\u900f\u904e\u5beb\u5165\u8f38\u51fa(<code>output</code>)\u4f86\u5c55\u793a\u67e5\u8a62\u8a9e\u53e5(<code>query</code>),\u4e26\u7b49\u5f85\u4f7f\u7528\u8005\u8f38\u5165\u5f8c\u4e26\u5c07\u8a72\u8f38\u5165\u63d0\u4f9b\u7d66\u8f38\u5165(<code>input</code>)\u3002\u63a5\u8457\u6703\u5c07\u63d0\u4f9b\u7684\u8f38\u5165(provided input)\u4f5c\u70ba\u7b2c\u4e00\u500b\u53c3\u6578,\u50b3\u905e\u7d66\u56de\u547c\u51fd\u5f0f</li> <li>\u7576\u8f38\u5165\u6d41\u88ab\u66ab\u505c(paused)\u6642,\u547c\u53eb<code>readline.question()</code>\u65b9\u6cd5\u6642,\u6703\u7e7c\u7e8c(resume)\u8f38\u5165\u6d41</li> <li>\u82e5<code>readline.createInterface()</code>\u88ab\u5efa\u7acb\u6642,\u8a72\u8f38\u51fa(<code>output</code>)\u88ab\u8a2d\u5b9a\u70ba<code>null</code>\u6216\u662f<code>undefined</code>,\u8a72\u67e5\u8a62\u8a9e\u53e5(<code>query</code>)\u4e0d\u6703\u88ab\u5beb\u5165(written)</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc</li> <li><code>js     rl.question('What is your favorite food? ', (answer) =&gt; {       console.log(`Oh, so your favorite food is ${answer}`);     });</code></li> <li>\u50b3\u905e\u7d66<code>readline.question()</code>\u7684\u56de\u547c\u51fd\u5f0f\u4e0d\u6703\u9075\u5f9e\u4e00\u822c\u63a5\u53d7<code>Error</code>\u7269\u4ef6\u6216\u662f<code>null</code>\u4f5c\u70ba\u7b2c\u4e00\u500b\u53c3\u6578\u7684\u6a21\u5f0f\u3002\u56de\u547c\u51fd\u5f0f\u6703\u4ee5\u88ab\u63d0\u4f9b\u7684\u7b54\u6848(provided answer)\u4f5c\u70ba\u552f\u4e00\u7684\u53c3\u6578</li> </ul> </li> <li>readline.close()<ul> <li>\u8a72\u65b9\u6cd5\u6703\u95dc\u9589<code>readline.createInterface()</code>\u5be6\u4f8b,\u4e26\u653e\u68c4\u5c0d\u8f38\u5165\u6d41(<code>input</code> streams)\u8207\u8f38\u51fa\u6d41(<code>output</code> streams)\u7684\u63a7\u5236(control over)\u3002\u7576\u88ab\u547c\u53eb\u6642,close\u4e8b\u4ef6\u5c31\u6703\u88ab\u767c\u51fa(emitted)</li> <li>\u547c\u53eb<code>readline.close()</code>\u65b9\u6cd5\u4e0d\u6703\u7acb\u5373\u505c\u6b62\u5176\u5b83\u88ab<code>readline.Interface</code>\u5be6\u4f8b\u6240\u767c\u51fa\u7684\u5176\u5b83\u4e8b\u4ef6(\u5305\u542bline\u4e8b\u4ef6)</li> </ul> </li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#commonjs-modules","title":"CommonJS modules","text":"<ul> <li>\u5728Node\u7684\u6a21\u7d44\u7cfb\u7d71(module system)\u4e2d,\u6bcf\u500b\u6a94\u6848\u90fd\u88ab\u8996\u70ba\u4e00\u500b\u5206\u958b\u7684\u6a21\u7d44(separate module)</li> <li>\u4ee5\u4e0b\u7684\u60c5\u5883\u8aaa\u660e,\u6211\u5011\u5047\u8a2d\u6709\u4e00\u500b\u6a94\u6848,\u5176\u6a94\u6848\u540d\u7a31\u70ba<code>foo.js</code> JavaScript<pre><code>const circle = require('./circle.js');\nconsole.log(`The area of a circle of radius 4 is ${circle.area(4)}`);\n</code></pre><ul> <li>\u5728\u9019\u500b\u6a94\u6848\u7684\u7b2c\u4e00\u884c\u4e2d,<code>foo.js</code>\u6a94\u6848\u6703\u8f09\u5165(loads) <code>circle.js</code>\u6a21\u7d44,\u9019\u5169\u500b\u6a94\u6848\u90fd\u662f\u5728\u540c\u4e00\u500b\u6a94\u6848\u76ee\u9304(directory)\u4e2d</li> </ul> </li> <li>\u4ee5\u4e0b\u662f<code>circle.js</code>\u7684\u6a94\u6848\u5167\u5bb9     JavaScript<pre><code>const { PI } = Math;\n\nexports.area = (r) =&gt; PI * r ** 2;\n\nexports.circumference = (r) =&gt; 2 * PI * r;\n</code></pre><ul> <li><code>circle.js</code>\u6a21\u7d44\u5df2\u532f\u51fa\u4e86<code>area()</code>\u8207<code>circumference()</code>\u9019\u5169\u500b\u51fd\u5f0f,\u900f\u904e\u5728\u7279\u6b8a\u7684<code>exports</code>\u7269\u4ef6\u4e0a\u6307\u5b9a(specifying)\u984d\u5916\u7684(additional)\u5c6c\u6027\u53ef\u4ee5\u5c07\u51fd\u5f0f\u8207\u7269\u4ef6\u65b0\u589e\u5230\u6a21\u7d44\u7684\u6700\u4e0a\u5c64(root of a module)</li> <li>\u9019\u6642\u8a72\u6a21\u7d44(= <code>circle.js</code>)\u7684\u5340\u57df\u8b8a\u6578\u6703\u662f\u79c1\u6709\u7684(private),\u56e0\u70baNode\u6703\u5c07\u6a21\u7d44(module)\u5305\u88dd(wrapped)\u6210\u70ba\u4e00\u500b\u51fd\u5f0f</li> <li>\u8a73\u60c5\u53ef\u53c3\u8003module wrapper</li> <li>\u5728\u4e0a\u8ff0\u7684<code>PI</code>\u7bc4\u4f8b\u4e2d,<code>PI</code>\u8b8a\u6578\u5c31\u662f<code>circle.js</code>\u7684\u79c1\u6709(private)\u8b8a\u6578</li> </ul> </li> <li><code>module.exports</code>\u5c6c\u6027\u53ef\u4ee5\u88ab\u6307\u6d3e(assigned)\u4e00\u500b\u65b0\u7684\u503c,\u50cf\u662f\u51fd\u5f0for\u7269\u4ef6</li> <li>\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc,<code>bar.js</code>\u6a94\u6848\u6703\u4f7f\u7528\u5230<code>square</code>\u6a21\u7d44,\u8a72\u6a21\u7d44\u6703\u532f\u51fa(exports)\u4e00\u500b<code>Square</code>\u985e\u5225(class)     JavaScript<pre><code>const Square = require('./square.js');\nconst mySquare = new Square(2);\nconsole.log(`The area of mySquare is ${mySquare.area()}`);\n</code></pre><ul> <li><code>square</code>\u6a21\u7d44\u662f\u5728<code>square.js</code>\u9019\u500b\u6a94\u6848\u4e2d\u5b9a\u7fa9\u7684   JavaScript<pre><code>// Assigning to exports will not modify module, must use module.exports\nmodule.exports = class Square {\n  constructor(width) {\n    this.width = width;\n  }\n\n  area() {\n    return this.width ** 2;\n  }\n};\n</code></pre></li> </ul> </li> <li>\u6a21\u7d44\u7cfb\u7d71(module system)\u6703\u5728<code>require('module')</code>\u9019\u500b\u6a21\u7d44\u4e2d\u5be6\u4f5c(implemented) <p>Core modules</p> </li> <li>Node\u6709\u8a31\u591a\u88ab\u7de8\u8b6f(compiled)\u6210\u4e8c\u9032\u5236\u6587\u4ef6(binary)\u7684\u6a21\u7d44,\u9019\u4e9bNode\u5167\u5efa\u7684\u6838\u5fc3\u6a21\u7d44\u5728\u5b98\u65b9\u6587\u4ef6\u7684\u5176\u5b83\u5730\u65b9\u90fd\u6709\u66f4\u8a73\u7d30\u7684\u4ecb\u7d39</li> <li><code>require()</code>\u65b9\u6cd5\u6703\u512a\u5148\u8b80\u53d6Node\u5167\u5efa\u7684\u6838\u5fc3\u6a21\u7d44,\u7576\u5b83\u5011\u7684\u6a19\u8b58\u7b26(identifier)\u88ab\u4f5c\u70ba\u53c3\u6578\u50b3\u5165\u7d66<code>require()</code>\u65b9\u6cd5\u6642       JavaScript<pre><code>require('http')\n</code></pre><ul> <li>\u4ee5\u4e0a\u7684\u5f15\u7528\u65b9\u5f0f\u6703\u512a\u5148\u5f15\u7528Node\u5167\u5efa\u7684\u6838\u5fc3\u6a21\u7d44-<code>HTTP</code>\u6a21\u7d44 (\u5373\u4f7f\u6709\u540c\u540d\u7a31\u7684\u6a94\u6848\u5728\u76ee\u9304\u4e2d) <p>Folders as modules</p> </li> </ul> </li> <li>\u5c07\u7a0b\u5f0f(programs)\u8207\u5957\u4ef6(libraries)\u6574\u7406\u5230\u4e00\u500b\u81ea\u7d66\u81ea\u8db3\u7684(self-contained)\u76ee\u9304\u4e2d,\u7136\u5f8c\u70ba\u9019\u4e9b\u76ee\u9304\u63d0\u4f9b\u55ae\u4e00\u500b\u5165\u53e3(single entry point)\u662f\u5f88\u65b9\u4fbf\u7684</li> <li>\u4ee5\u4e0b\u67093\u7a2e\u65b9\u5f0f\u53ef\u4ee5\u5c07\u8cc7\u6599\u593e(folder)\u4f5c\u70ba\u53c3\u6578\u50b3\u905e\u7d66<code>require()</code>\u65b9\u6cd5<ul> <li>\u65b9\u6cd5\u4e00: \u5728\u8a72\u8cc7\u6599\u593e\u7684\u6700\u4e0a\u5c64(root)\u5efa\u7acb\u4e00\u500bpackage.json\u6a94\u6848,\u4e26\u6307\u5b9a\u4e00\u500b<code>main</code>\u5c6c\u6027\u503c\u4f86\u8868\u793a\u7576\u8f09\u5165\u6b64\u5957\u4ef6(package)\u6642,\u9810\u8a2d\u8981\u5f15\u5165\u54ea\u500b\u6a21\u7d44     JavaScript<pre><code>{ \"name\" : \"some-library\",\n  \"main\" : \"./lib/some-library.js\" \n}\n</code></pre></li> <li>\u4e0a\u8ff0\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,\u5982\u679c\u5728<code>./some-library/</code>\u76ee\u9304\u4e2d\u6709<code>./some-library/lib/some-library.js</code>\u9019\u500b\u6a94\u6848\u7684\u8a71,Node\u5c31\u6703\u5617\u8a66\u8b80\u53d6\u5b83</li> <li>\u5982\u679c\u8a72\u76ee\u9304\u4e2d\u6c92\u6709\u8a72\u6587\u4ef6,\u6216\u662fmain\u76ee\u9304\u5df2\u4e0d\u898b\u4e86(missing)\u6216\u662f\u7121\u6cd5\u627e\u5230(cannot be resolved),\u9019\u6642Node\u5c31\u6703\u5617\u8a66\u53bb\u8b80\u53d6name\u6a94\u6848\u4e2d\u7684<code>index.js</code>\u6216\u662f<code>index.node</code></li> <li>\u60c5\u5883\u8aaa\u660e( \u7576\u8a72\u76ee\u9304\u6c92\u6709package.json\u9019\u500b\u6a94\u6848,\u4e14\u53c8\u627e\u4e0d\u5230.xxx/lib/xxx.js\u6a94\u6848\u6642 ),\u7576\u6211\u5011\u5f15\u7528<code>require('./some-library')</code>\u7684\u6642\u5019,\u6703\u5617\u8a66\u53bb\u8b80\u53d6\u4ee5\u4e0b2\u7a2e\u8def\u5f91\u4e0b\u7684\u6a94\u6848</li> <li>\u7b2c1\u7a2e: <code>./some-library/index.js</code></li> <li>\u7b2c2\u7a2e: <code>./some-library/index.node</code><ul> <li>\u5982\u679c\u4ee5\u4e0a\u7684\u5617\u8a66\u90fd\u5931\u6557\u7684\u8a71,Node\u5c31\u6703\u5c07\u6574\u500b\u6a21\u7d44(entire module)\u56de\u5831(report)\u70ba\u907a\u5931(missing),\u4e26\u986f\u793a\u4e00\u500b\u9810\u8a2d\u7684\u932f\u8aa4</li> <li>\u9810\u8a2d: <code>Error: Cannot find module 'some-library'</code></li> </ul> </li> <li>\u4ee5\u4e0a\u5c31\u662f\u5c0dNode\u7684<code>package.json</code>\u6a94\u6848\u6709\u6240\u9ad4\u8a8d\u7684\u7a0b\u5ea6(the extent of the awareness)</li> <li>\u65b9\u6cd5\u4e8c: \u5982\u679c\u50b3\u905e\u7d66<code>require()</code>\u65b9\u6cd5\u7684\u6a21\u7d44\u6a19\u8b58\u7b26(module identifier)\u4e0d\u662f\u4e00\u500bNode\u5167\u5efa\u7684\u6838\u5fc3\u6a21\u7d44\u540d\u7a31,\u800c\u4e14\u4e0d\u662f\u4ee5<code>/</code>, <code>../</code>, <code>./</code> \u7684\u8def\u5f91\u958b\u982d\u7684\u8a71,Node\u5c31\u6703\u5f9e\u7576\u524d\u6a21\u7d44\u7684\u7236\u76ee\u9304(\u4e5f\u5c31\u662f\u524d\u4e00\u5c64\u76ee\u9304, parent directory)\u958b\u59cb,\u63a5\u8457\u65b0\u589e\u4e00\u500b<code>node_modules/</code>\u8cc7\u6599\u593e,\u4e26\u5617\u8a66\u5f9e\u8a72\u4f4d\u7f6e\u8b80\u53d6\u6a21\u7d44</li> <li>\u5982\u679c\u5728\u8a72\u76ee\u9304\u4e0b\u6c92\u6709\u627e\u5230\u8a72\u6a21\u7d44\u540d\u7a31\u7684\u8a71,\u5247Node\u5c07\u6703\u5f80\u524d\u4e00\u5c64\u76ee\u9304\u67e5\u770b,\u76f4\u5230\u5230\u9054\u6a94\u6848\u7cfb\u7d71(file system)\u7684\u6839\u76ee\u9304(root)\u70ba\u6b62</li> <li>\u60c5\u5883\u8aaa\u660e(\u82e5\u5728<code>/home/ry/projects/foo.js</code>\u7684\u6a94\u6848\u70ba<code>require('bar.js')</code>,\u5247Node\u6703\u6839\u64da\u4ee5\u4e0b\u7684\u9806\u5e8f\u4f9d\u5e8f\u67e5\u770b\u63a5\u4e0b\u4f86\u7684\u6a94\u6848\u8def\u5f91)<ul> <li><code>/home/ry/projects/node_modules/bar.js</code></li> <li><code>/home/ry/node_modules/bar.js</code></li> <li><code>/home/node_modules/bar.js</code></li> <li><code>/node_modules/bar.js</code></li> </ul> </li> <li>\u9019\u6a23\u505a\u4e5f\u6703\u8b93\u7a0b\u5f0f\u672c\u5730\u5316(localize)\u5b83\u5011\u81ea\u5df1\u7684\u76f8\u4f9d\u6027(dependencies),\u800c\u4e0d\u6703\u4e92\u76f8\u62b5\u89f8(clash)</li> <li>\u6211\u5011\u4e5f\u53ef\u4ee5\u900f\u904e\u660e\u78ba\u7684\u6a94\u6848\u8def\u5f91or\u8207\u8a72\u6a21\u7d44\u4e00\u8d77\u5206\u767c(distributed)\u7684\u5b50\u6a21\u7d44(sub modules)\u8def\u5f91,\u4ee5\u5f8c\u7db4(suffix)\u7684\u65b9\u5f0f\u52a0\u5728\u8a72\u6a21\u7d44\u540d\u7a31\u7684\u5f8c\u9762,\u4f86\u5f15\u7528\u5230\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u4e2d<ul> <li>\u4f8b: <code>require('example-module/path/to/file')</code></li> <li>\u8a3b: \u5f8c\u7db4\u8def\u5f91\u6703\u9075\u5f9e\u8207\u8a72\u6a21\u7d44\u76f8\u540c\u7684\u6a21\u7d44\u89e3\u6790\u8a9e\u610f(module resolution semantics)</li> </ul> </li> <li>\u65b9\u6cd5\u4e09: \u5982\u679c<code>NODE_PATH</code>\u9019\u500b\u74b0\u5883\u8b8a\u6578\u8a2d\u5b9a\u70ba\u4ee5\u5192\u865f\u5340\u9694(colon-delimited)\u7684\u7d55\u5c0d\u8def\u5f91\u7684\u8a71,\u5247Node\u5c07\u6703\u641c\u5c0b\u8a72\u6a21\u7d44\u7684\u9019\u4e9b\u7d55\u5c0d\u8def\u5f91(\u5982\u679c\u5728\u5176\u4ed6\u4f4d\u7f6e\u6c92\u6709\u627e\u5230\u7684\u8a71)</li> <li>\u5728Windows\u4f5c\u696d\u7cfb\u7d71\u4e2d,NODE_PATH\u6703\u7528\u5206\u865f(semicolon)\u505a\u5340\u9694</li> <li><code>NODE_PATH</code>\u8d77\u521d\u662f\u70ba\u4e86\u5728\u7576\u524d\u7684\u6a21\u7d44\u89e3\u6790(module resolution)\u6f14\u7b97\u6cd5\u88ab\u5b9a\u7fa9\u4e4b\u524d,\u80fd\u5920\u652f\u63f4\u5f9e\u4e0d\u540c\u8def\u5f91\u4f86\u8f09\u5165\u6a21\u7d44\u800c\u5efa\u7acb\u7684<ul> <li>\u81f3\u4eca,<code>NODE_PATH</code>\u4ecd\u7136\u652f\u63f4,\u4f46\u662fNode\u751f\u614b\u7cfb\u7d71\u5df2\u7d93\u6c7a\u5b9a\u4e86\u5b9a\u4f4d\u51fa\u6a21\u7d44\u76f8\u4f9d\u6027\u7684\u898f\u7bc4,\u800c\u986f\u5f97<code>NODE_PATH</code>\u4e0d\u518d\u662f\u90a3\u9ebc\u5fc5\u8981\u4e86</li> <li>\u6709\u6642\u5019,\u7576\u5176\u4ed6\u4eba\u4e0d\u77e5\u9053\u9019\u6b21\u7684\u90e8\u7f72(deployments)\u9700\u8981\u4f9d\u8cf4(rely on)<code>NODE_PATH</code>\u74b0\u5883\u8b8a\u6578\u6642,\u6703\u767c\u751f\u51fa\u4e4e\u610f\u6599\u7684\u884c\u70ba</li> <li>\u6709\u6642\u5019,\u4e00\u500b\u6a21\u7d44\u7684\u76f8\u4f9d\u6027\u6539\u8b8a\u4e86,\u6703\u5c0e\u81f4<code>NODE_PATH</code>\u74b0\u5883\u8b8a\u6578\u641c\u5c0b\u6642\u6703\u8f09\u5165\u5230\u4e0d\u540c\u7684\u8a72\u6a21\u7d44\u7684\u4e0d\u540c\u7248\u672c(\u751a\u81f3\u662f\u4e0d\u540c\u7684\u6a21\u7d44)</li> </ul> </li> <li>\u6b64\u5916,Node\u6703\u6839\u64da\u4ee5\u4e0b\u7684\u9806\u5e8f\u4f86\u641c\u5c0b<code>GLOBAL_FOLDERS</code>\u6e05\u55ae<ul> <li><code>$HOME/.node_modules</code></li> <li><code>$HOME/.node_libraries</code></li> <li><code>$PREFIX/lib/node</code></li> <li>\u8a3b: <code>$HOME</code>\u8868\u793a\u4f7f\u7528\u8005\u7684\u5bb6\u76ee\u9304; <code>$PREFIX</code>\u8868\u793aNode\u5df2\u5b89\u88dd<code>node_prefix</code></li> </ul> </li> <li>\u9019\u4e9b\u505a\u6cd5\u4e3b\u8981\u662f\u57fa\u65bc\u5177\u6709\u6b77\u53f2\u610f\u7fa9\u7684\u539f\u56e0</li> <li>\u5efa\u8b70 : \u5f37\u70c8\u9f13\u52f5\u5c07\u76f8\u4f9d\u7684\u6a94\u6848\u653e\u5728\u672c\u5730\u7aef\u7684<code>node_modules</code>\u8cc7\u6599\u593e,\u9019\u6703\u4f7f\u8f09\u5165\u6a21\u7d44\u7684\u901f\u5ea6\u66f4\u5feb &amp; \u66f4\u53ef\u9760(reliably) <p>The module scope</p> </li> </ul> </li> <li>__dirname<ul> <li>Returns: (string)</li> <li>\u8a72\u5c6c\u6027\u6703\u56de\u50b3\u7576\u524d\u6a21\u7d44\u7684\u8cc7\u6599\u593e\u540d\u7a31(\u4e5f\u5c31\u662f\u6240\u5728\u8def\u5f91, directory name)</li> <li>\u9019\u500b\u5c6c\u6027\u8ddfpath.dirname(path)\u8207__filename\u662f\u4e00\u6a23\u7684</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc(\u5f9e<code>/Users/mjr</code>\u7684\u5bb6\u76ee\u9304\u4e2d,\u57f7\u884c<code>node example.js</code>)   JavaScript<pre><code>console.log(__dirname);\n// Prints: /Users/mjr\nconsole.log(path.dirname(__filename));\n// Prints: /Users/mjr\n</code></pre></li> </ul> </li> <li>__filename<ul> <li>Returns: (string)</li> <li>\u8a72\u5c6c\u6027\u6703\u56de\u50b3\u7576\u524d\u6a21\u7d44\u7684\u6a94\u6848\u540d\u7a31(file name),\u4e5f\u5c31\u662f\u7576\u524d\u6a21\u7d44\u7684\u7d55\u5c0d\u8def\u5f91(\u5982\u679c\u5b58\u5728\u9023\u7d50(symlink)\u7684\u8a71,\u5df2\u89e3\u6790\u904e\u7684)</li> <li>\u5c0d\u65bc\u4e3b\u7a0b\u5f0f,<code>__filename</code>\u4e0d\u4e00\u5b9a\u8981\u8207<code>CLI</code>\u4e2d\u7684\u6a94\u6848\u540d\u7a31\u76f8\u540c</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc(\u5f9e<code>/Users/mjr</code>\u7684\u5bb6\u76ee\u9304\u4e2d,\u57f7\u884c<code>node example.js</code>)     JavaScript<pre><code>console.log(__filename);\n// Prints: /Users/mjr/example.js\nconsole.log(__dirname);\n// Prints: /Users/mjr\n</code></pre></li> <li>\u5047\u5982\u6709\u5169\u500b\u6a21\u7d44--- <code>a</code> &amp; <code>b</code>,\u7136\u5f8c<code>b</code>\u6a21\u7d44\u662f<code>a</code>\u6a21\u7d44\u7684\u76f8\u4f9d\u9805\u76ee(dependency),\u4e26\u4e14\u8cc7\u6599\u593e\u7d50\u69cb\u5982\u4e0b</li> <li><code>/Users/mjr/app/a.js</code></li> <li><code>/Users/mjr/app/node_modules/b/b.js</code></li> <li>\u95dc\u65bc\u4ee5\u4e0a\u7684\u7bc4\u4f8b,<code>b.js</code>\u6a94\u6848\u7684<code>__filename</code>\u5c6c\u6027\u503c\u6703\u662f<code>/Users/mjr/app/node_modules/b/b.js</code>; \u53e6\u5916,<code>a.js</code>\u6a94\u6848\u7684<code>__filename</code>\u5c6c\u6027\u503c\u6703\u662f<code>/Users/mjr/app/a.js</code> <p>The module object</p> </li> </ul> </li> <li>\u5728\u6bcf\u500b\u6a21\u7d44\u4e2d,<code>module</code>\u7269\u4ef6\u4e2d\u9592\u7f6e\u7684(free)\u8b8a\u6578\u4ee3\u8868\u5c0d\u65bc\u7576\u524d\u6a21\u7d44\u7269\u4ef6\u7684\u53c3\u8003\u3002\u70ba\u4e86\u65b9\u4fbf\u8d77\u898b,<code>module.exports</code>\u4e5f\u53ef\u4ee5\u900f\u904eexports\u9019\u500b\u5168\u57df\u7269\u4ef6\u4f86\u5b58\u53d6\u3002module\u7269\u4ef6\u5c0d\u65bc\u6bcf\u4e00\u500b\u6a21\u7d44\u4f86\u8aaa,\u5be6\u969b\u4e0a\u662f\u4e00\u500b\u5340\u57df\u7269\u4ef6,\u800c\u4e0d\u662f\u5168\u57df\u7269\u4ef6     &gt; object<ul> <li>module.exports<ul> <li>\u8a72\u7269\u4ef6\u662f\u7531Module system\u6240\u5efa\u7acb\u7684,\u6709\u4e9b\u6642\u5019\u9019\u6a23\u662f\u4e0d\u80fd\u88ab\u63a5\u53d7(not acceptable)\u7684,\u8a31\u591a\u4eba\u5e0c\u671b\u4ed6\u5011\u7684\u6a21\u7d44\u662f\u67d0\u500b\u985e\u5225(class)\u7684\u5be6\u4f8b(instance)</li> <li>\u70ba\u6b64,\u53ef\u4ee5\u5c07\u6240\u9700\u532f\u51fa\u7684\u7269\u4ef6\u6307\u6d3e\u7d66<code>module.exports</code>\u7269\u4ef6</li> <li>\u5c07\u6240\u9700\u7684\u7269\u4ef6\u6307\u6d3e\u7d66<code>exports</code>\u6703\u7c21\u55ae\u5730\u91cd\u65b0\u7d81\u5b9a(simply rebind)<code>exports</code>\u5340\u57df\u8b8a\u6578,\u7136\u800c\u9019\u53ef\u80fd\u4e0d\u662f\u6211\u5011\u6240\u60f3\u8981\u7684\u7d50\u679c</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc(\u5047\u8a2d\u6211\u5011\u6b63\u5728\u88fd\u4f5c\u4e00\u500b\u6a21\u7d44,\u53eb\u505a<code>a.js</code>)     JavaScript<pre><code>const EventEmitter = require('events');\n\nmodule.exports = new EventEmitter();\n\n// Do some work, and after some time emit\n// the 'ready' event from the module itself.\nsetTimeout(() =&gt; {\n  module.exports.emit('ready');\n}, 1000);\n</code></pre></li> <li>\u9019\u6642\u6211\u5011\u5c31\u53ef\u4ee5\u5728\u53e6\u5916\u4e00\u500b\u6a94\u6848\u4e2d\u5f15\u5165\u4e0a\u8ff0\u7684\u6a21\u7d44     JavaScript<pre><code>const a = require('./a');\na.on('ready', () =&gt; {\n  console.log('module \"a\" is ready');\n});\n</code></pre></li> <li>\u60c5\u5883\u8aaa\u660e( \u932f\u8aa4\u793a\u7bc4 )---\u4e0d\u6703\u88ab\u57f7\u884c</li> <li>\u56e0\u70ba\u6307\u6d3e\u7d66<code>module.exports</code>\u7269\u4ef6\u9700\u8981\u7acb\u5373\u5b8c\u6210\u5b83,\u4e26\u4e14\u4e0d\u80fd\u5728\u4efb\u4f55\u56de\u547c\u51fd\u5f0f(callbacks)\u4e2d\u5b8c\u6210</li> <li><code>x.js</code> JavaScript<pre><code>setTimeout(() =&gt; {\n  module.exports = { a: 'hello' };\n}, 0);\n</code></pre></li> <li><code>y.js</code> JavaScript<pre><code>const x = require('./x');\nconsole.log(x.a);\n</code></pre></li> </ul> </li> <li>exports shortcut<ul> <li>\u8a72\u8b8a\u6578\u53ea\u6709\u5728\u6a21\u7d44\u6a94\u6848\u5c64\u7d1a(module's file-level)\u7684\u7bc4\u570d(scope)\u624d\u53ef\u7528,\u4e26\u4e14\u5728\u6a21\u7d44\u88ab\u8a55\u4f30\u4e4b\u524d(evaluated)\u5c31\u6703\u88ab<code>module.exports</code>\u7269\u4ef6\u6307\u6d3e\u5176\u503c</li> <li>\u8a72\u8b8a\u6578\u5141\u8a31\u4e00\u500b\u6377\u5f91,\u56e0\u6b64<code>module.exports.f = ...</code>\u53ef\u4ee5\u88ab\u66f4\u7c21\u6f54\u5730\u5beb\u6210<code>exports.f = ...</code></li> <li>\u7136\u800c,\u8acb\u6ce8\u610f!\u5c31\u5982\u540c\u4efb\u4f55\u7684\u8b8a\u6578\u4e00\u6a23,\u5982\u679c\u6709\u65b0\u7684\u503c\u88ab\u6307\u6d3e\u7d66<code>exports</code>\u8b8a\u6578,\u5247\u5b83\u5c31\u4e0d\u518d\u88ab\u91cd\u65b0\u7d81\u5b9a\u5230<code>module.exports</code>\u7269\u4ef6\u4e0a</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     <code>js     module.exports.hello = true; // Exported from require of module     exports = { hello: false };  // Not exported, only available in the module</code></li> <li>\u7576<code>module.exports</code>\u5c6c\u6027\u5b8c\u5168\u88ab\u4e00\u500b\u7269\u4ef6\u53d6\u4ee3(replaced)\u6642,\u901a\u5e38\u4e5f\u6703\u91cd\u65b0\u6307\u6d3e\u7d66<code>exports</code>\u8b8a\u6578</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc   JavaScript<pre><code>module.exports = exports = function Constructor() {\n  // ... etc.\n};\n</code></pre></li> <li>\u70ba\u4e86\u8aaa\u660e\u4ee5\u4e0a\u7684\u9019\u7a2e\u884c\u70ba,\u8acb\u60f3\u50cf\u6709\u4e00\u500b\u5047\u8a2d\u7684(hypothetical)<code>require()</code>\u65b9\u6cd5\u5be6\u4f5c(implementation),\u8a72\u884c\u70ba\u8207\u5be6\u969b\u7684<code>require()</code>\u65b9\u6cd5\u76f8\u7576\u985e\u4f3c</li> <li>\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>function require(/* ... */) {\n  const module = { exports: {} };\n  ((module, exports) =&gt; {\n    // Module code here. In this example, define a function.\n    function someFunc() {}\n    exports = someFunc;\n    // At this point, exports is no longer a shortcut to module.exports, and\n    // this module will still export an empty default object.\n    module.exports = someFunc;\n    // At this point, the module will now export someFunc, instead of the\n    // default object.\n  })(module, module.exports);\n  return module.exports;\n}\n</code></pre></li> </ul> </li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#timers","title":"Timers","text":"<ul> <li><code>timer</code>\u6a21\u7d44\u6703\u516c\u958b(exposes)\u4e00\u500b\u5168\u57df\u7684API,\u7528\u4f86\u5b89\u6392\u5728\u5c07\u4f86\u7684\u67d0\u500b\u6642\u6bb5\u547c\u53eb\u8a72\u51fd\u5f0f\u6240\u4f7f\u7528\u7684\u3002\u56e0\u70ba<code>timer</code>\u6a21\u7d44\u4e2d\u7684\u65b9\u6cd5\u90fd\u662f\u5168\u57df\u7684,\u6240\u4ee5\u4e0d\u7528\u4e8b\u5148\u5f15\u7528(<code>require('timers')</code>)\u6a21\u7d44\u5f8c\u624d\u80fd\u4f7f\u7528\u9019\u4e9bAPI</li> <li>Node\u7684<code>timer</code>\u6a21\u7d44\u4e2d\u7684\u65b9\u6cd5\u6703\u5be6\u4f5c(implement)\u985e\u4f3c\u65bc\u7db2\u9801\u700f\u89bd\u5668(web browsers)\u4e2d<code>timers</code>API,\u4f46\u6703\u4f7f\u7528\u4e0d\u540c\u7684\u5be6\u4f5c\u65b9\u6cd5</li> <li>\u800cNode\u7684<code>timer</code>\u6a21\u7d44\u6703\u570d\u7e5e\u5728\u4e8b\u4ef6\u8ff4\u5708(event loop)\u7684\u57fa\u790e\u4e4b\u4e0a\u4f86\u5be6\u4f5c\u4e0d\u540c\u7684\u65b9\u6cd5 <p>method</p> </li> <li>setImmediate(callback[, ...args])<ul> <li>args</li> <li>callback: (Function)<ul> <li>\u5728\u672c\u6b21\u7684\u4e8b\u4ef6\u8ff4\u5708\u7d50\u675f\u6642,\u8981\u547c\u53eb\u7684\u51fd\u5f0f</li> </ul> </li> <li>...args: (any)<ul> <li>\u7576\u56de\u547c\u51fd\u5f0f(callback)\u88ab\u547c\u53eb\u6642,\u53ef\u4ee5\u9078\u64c7\u6027\u5730(optional)\u50b3\u905e\u53c3\u6578(arguments)</li> </ul> </li> <li>Returns: \u53ef\u4ee5\u50b3\u905e\u7d66clearImmediate()\u65b9\u6cd5\u6240\u4f7f\u7528\u7684<code>Timeout\u7269\u4ef6</code></li> <li>\u5b89\u6392\u5728<code>callback I/O\u4e8b\u4ef6</code>\u7684\u7acb\u5373\u57f7\u884c(immediate execution)\u56de\u547c\u51fd\u5f0f</li> <li>\u7576\u6709\u591a\u500b<code>setImmediate()</code>\u65b9\u6cd5\u88ab\u4f7f\u7528\u6642,\u9019\u4e9b\u56de\u547c\u51fd\u5f0f\u6703\u4f9d\u7167\u88ab\u5efa\u7acb\u7684\u9806\u5e8f\u6392\u968a\u7b49\u5f85\u88ab\u57f7\u884c(queued for execution)\u3002\u6574\u500b\u56de\u547c\u968a\u5217(callback queue)\u6703\u8655\u7406\u6bcf\u6b21\u7684\u4e8b\u4ef6\u8ff4\u5708\u8fed\u4ee3(event loop iteration)</li> <li>\u5982\u679c\u6709\u4e00\u500b\u7acb\u5373\u57f7\u884c\u8a08\u6642\u5668(immediate timer)\u6b63\u5728\u4e00\u500b\u56de\u547c\u57f7\u884c(execution callback)\u4e2d\u7684\u968a\u5217(queue)\u4e2d,\u8a72\u7acb\u5373\u57f7\u884c\u8a08\u6642\u5668(immediate timer)\u5c31\u4e0d\u6703\u88ab\u89f8\u767c,\u76f4\u5230\u4e0b\u6b21\u4e8b\u4ef6\u8ff4\u5708\u8fed\u4ee3(the next event loop iteration)\u4ee5\u524d</li> <li>\u5982\u679c<code>setImmediate()</code>\u65b9\u6cd5\u7684<code>callback</code>\u53c3\u6578\u4e0d\u662f\u4e00\u500b\u51fd\u5f0f(function)\u7684\u8a71,\u6703\u62cb\u51fa\u4e00\u500bTypeError\u932f\u8aa4</li> <li><code>setImmediate()</code>\u65b9\u6cd5\u6709\u4e00\u500b\u5ba2\u88fd\u5316\u7684<code>promises</code>\u8b8a\u5f62(custom variant for promises),\u53ef\u4ee5\u5229\u7528Node\u7684\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Util</code>\u4e2d\u7684util.promisify()\u65b9\u6cd5     JavaScript<pre><code>const util = require('util');\nconst setImmediatePromise = util.promisify(setImmediate);\n\nsetImmediatePromise('foobar').then((value) =&gt; {\n  // value === 'foobar' (passing values is optional)\n  // This is executed after all I/O callbacks.\n});\n\n// Or with async function\nasync function timerExample() {\n  console.log('Before I/O callbacks');\n  await setImmediatePromise();\n  console.log('After I/O callbacks');\n}\ntimerExample();\n</code></pre></li> </ul> </li> <li>setInterval(callback[, delay[, ...args]])<ul> <li>args</li> <li>callback: (Function)<ul> <li>\u8a2d\u5b9a\u7576\u8a08\u6642\u5668(timer)\u7d93\u904e\u8a2d\u5b9a\u597d\u7684\u9593\u9694\u6642\u9593(elapses)\u5f8c,\u8981 \u91cd\u8907\u57f7\u884c \u7684\u56de\u547c\u51fd\u5f0f(callback function)</li> </ul> </li> <li>delay: (number)<ul> <li>\u547c\u53eb\u56de\u547c\u51fd\u5f0f(callback)\u4e4b\u524d\u8981\u9593\u9694\u7684\u6beb\u79d2\u6578</li> <li>\u9810\u8a2d\u503c: <code>1</code></li> <li>\u7576\u8a72\u53c3\u6578\u7684\u503c\u5927\u65bc<code>2147483647</code>\u6216\u662f\u5c0f\u65bc<code>1</code>\u6642,\u90fd\u6703\u88ab\u8a2d\u5b9a\u70ba<code>1</code>; \u82e5\u8a72\u53c3\u6578\u70ba\u975e\u6574\u6578\u7684\u503c,\u6703\u88ab\u7121\u689d\u4ef6\u6368\u53bb\u5f8c,\u8b8a\u6210\u6574\u6578</li> </ul> </li> <li><code>...args</code>: (any)<ul> <li>\u7576\u56de\u547c\u51fd\u5f0f(callback)\u88ab\u547c\u53eb\u6642,\u53ef\u4ee5\u9078\u64c7\u6027\u5730(optional)\u50b3\u905e\u53c3\u6578(arguments)</li> </ul> </li> <li>Returns: \u53ef\u4ee5\u50b3\u905e\u7d66clearInterval()\u65b9\u6cd5\u6240\u4f7f\u7528\u7684<code>Timeout\u7269\u4ef6</code></li> <li>\u5b89\u6392\u4e00\u500b\u6703\u6bcf<code>n</code>\u6beb\u79d2\u5f8c,\u91cd\u8907(repeated)\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback function)</li> <li>\u5982\u679c<code>setInterval()</code>\u65b9\u6cd5\u7684<code>callback</code>\u53c3\u6578\u4e0d\u662f\u4e00\u500b\u51fd\u5f0f(function)\u7684\u8a71,\u6703\u62cb\u51fa\u4e00\u500bTypeError\u932f\u8aa4</li> </ul> </li> <li>setTimeout(callback[, delay[, ...args]])<ul> <li>args</li> <li>callback: (function)<ul> <li>\u8a2d\u5b9a\u7576\u8a08\u6642\u5668(timer)\u7d93\u904e\u8a2d\u5b9a\u597d\u7684\u9593\u9694\u6642\u9593(elapses)\u5f8c,\u8981 \u57f7\u884c\u4e00\u6b21 \u7684\u56de\u547c\u51fd\u5f0f(callback function)</li> </ul> </li> <li>delay: (number)<ul> <li>\u547c\u53eb\u56de\u547c\u51fd\u5f0f(callback)\u4e4b\u524d\u8981\u7d93\u904e\u7684\u6beb\u79d2\u6578</li> <li>\u9810\u8a2d\u503c: <code>1</code></li> <li>\u7576\u8a72\u53c3\u6578\u7684\u503c\u5927\u65bc<code>2147483647</code>\u6216\u662f\u5c0f\u65bc<code>1</code>\u6642,\u90fd\u6703\u88ab\u8a2d\u5b9a\u70ba<code>1</code>; \u82e5\u8a72\u53c3\u6578\u70ba\u975e\u6574\u6578\u7684\u503c,\u6703\u88ab\u7121\u689d\u4ef6\u6368\u53bb\u5f8c,\u8b8a\u6210\u6574\u6578</li> </ul> </li> <li>...args: (any)<ul> <li>\u7576\u56de\u547c\u51fd\u5f0f(callback)\u88ab\u547c\u53eb\u6642,\u53ef\u4ee5\u9078\u64c7\u6027\u5730(optional)\u50b3\u905e\u53c3\u6578(arguments)</li> </ul> </li> <li>Returns: \u53ef\u4ee5\u50b3\u905e\u7d66clearTimeout()\u65b9\u6cd5\u6240\u4f7f\u7528\u7684<code>Timeout\u7269\u4ef6</code></li> <li>\u5b89\u6392\u4e00\u500b\u7576\u7d93\u904e<code>n</code>\u6beb\u79d2\u5f8c,\u6703\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback function)</li> <li>\u6ce8\u610f: <code>setTimeout()</code>\u65b9\u6cd5\u8981\u547c\u53eb\u7684\u56de\u547c\u51fd\u5f0f\u53ef\u80fd\u4e0d\u6703\u5728\u8a2d\u5b9a\u597d\u7684\u6beb\u79d2\u6578\u5f8c,\u88ab\u7cbe\u78ba\u5730(precisely)\u547c\u53eb\u3002Node \u4e0d\u80fd\u4fdd\u8b49 \u56de\u547c\u51fd\u5f0f\u88ab\u547c\u53eb\u7684\u7cbe\u78ba\u6642\u9593(exact timing)\u4ee5\u53ca\u9806\u5e8f(ordering)\u3002\u53ea\u80fd\u76e1\u91cf\u8b93\u8981\u547c\u53eb\u7684\u56de\u547c\u51fd\u5f0f(callback)\u5728\u8a2d\u5b9a\u597d\u7684\u6642\u9593\u5f8c\u88ab\u89f8\u767c</li> <li>\u5982\u679c<code>setTimeout()</code>\u65b9\u6cd5\u7684<code>callback</code>\u53c3\u6578\u4e0d\u662f\u4e00\u500b\u51fd\u5f0f(function)\u7684\u8a71,\u6703\u62cb\u51fa\u4e00\u500bTypeError\u932f\u8aa4</li> <li><code>setTimeout()</code>\u65b9\u6cd5\u6709\u4e00\u500b\u5ba2\u88fd\u5316\u7684<code>promises</code>\u8b8a\u5f62(custom variant for promises),\u53ef\u4ee5\u5229\u7528Node\u7684\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<code>Util</code>\u4e2d\u7684util.promisify()\u65b9\u6cd5     JavaScript<pre><code>const util = require('util');\nconst setTimeoutPromise = util.promisify(setTimeout);\n\nsetTimeoutPromise(40, 'foobar').then((value) =&gt; {\n  // value === 'foobar' (passing values is optional)\n  // This is executed after about 40 milliseconds.\n});\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#events","title":"Events","text":"<ul> <li>\u5927\u90e8\u5206Node\u4e2d\u7684\u6838\u5fc3API\u90fd\u662f\u57fa\u65bc\u6163\u7528\u7684(idiomatic)\u975e\u540c\u6b65(asynchronous)\u4e8b\u4ef6\u9a45\u52d5(event-driven)\u67b6\u69cb(architecture)\u3002\u5728\u9019\u7a2e\u67b6\u69cb\u4e2d,\u67d0\u4e9b\u985e\u578b\u7684\u7269\u4ef6(\u88ab\u7a31\u70ba<code>emitters</code>)\u6703\u767c\u51fa(emit)\u88ab\u547d\u540d\u7684\u4e8b\u4ef6(named events),\u5c0e\u81f4(cause)\u51fd\u5f0f\u7269\u4ef6(<code>Function</code> object, =&gt; \u4e5f\u5c31\u662f\u76e3\u807d\u5668(listeners))\u88ab\u547c\u53eb(to be called)</li> <li>\u8209\u4f8b\u4f86\u8aaa,\u6bcf\u7576\u6709\u540c\u7d1a\u9023\u63a5(peer connects)\u6642,\u90fd\u6703\u767c\u51fa(emit)\u4e00\u6b21\u4e8b\u4ef6(event)\u5230\u4e00\u500bnet.Server\u7269\u4ef6(object); \u7576\u6a94\u6848\u88ab\u958b\u555f(opened)\u6642,\u6703\u6709\u4e00\u500bfs.ReadStream\u5be6\u4f8b(instance)\u6703\u767c\u51fa(emit)\u4e00\u500b\u4e8b\u4ef6(event); \u6bcf\u7576(whenever)\u6709\u8cc7\u6599\u53ef\u4ee5\u88ab\u8b80\u53d6\u6642,\u5c31\u6703\u767c\u51fa(emit)\u4e00\u500bstream\u4e8b\u4ef6(event)</li> <li>\u767c\u51fa\u7684\u4e8b\u4ef6(emit events)\u4e2d\u7684\u6240\u6709\u7269\u4ef6(objects)\u90fd\u662fEventEmitter\u985e\u5225(class)\u7684\u5be6\u4f8b(instances)\u3002\u9019\u4e9b\u7269\u4ef6\u6703\u516c\u958b(expose)\u4e00\u500b<code>emitter.on()</code>\u51fd\u5f0f(function),\u9019\u500b\u51fd\u5f0f\u5141\u8a31(allows)\u4e00\u500b\u6216\u591a\u500b\u51fd\u5f0f\u9644\u52a0\u5230(attached)\u7531\u8a72\u7269\u4ef6(by object)\u6240\u767c\u51fa(emitted)\u7684\u88ab\u547d\u540d\u7684\u4e8b\u4ef6(named events)\u4e0a\u3002 \u901a\u5e38,\u4e8b\u4ef6\u540d\u7a31\u90fd\u662f\u7528\u99dd\u5cf0\u547d\u540d\u6cd5(camel-cased)\u4f86\u547d\u540d\u7684\u5b57\u4e32(strings),\u4f46\u662f\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u6709\u6548\u7684(valid)Javascript\u5c6c\u6027\u9375(property key)</li> <li>\u7576<code>EventEmitter</code>\u7269\u4ef6\u767c\u51fa(emits)\u4e00\u500b\u4e8b\u4ef6(event),\u6240\u6709\u88ab\u9644\u52a0\u5230(attached)\u90a3\u500b\u7279\u5b9a\u7684(specific)\u4e8b\u4ef6\u4e0a\u7684\u51fd\u5f0f(functions)\u90fd\u6703\u88ab\u540c\u6b65\u5730\u547c\u53eb(called synchronously)\u3002\u88ab\u547c\u53eb\u7684\u76e3\u807d\u5668(the called listeners)\u6240\u8fd4\u56de(returned)\u7684\u4efb\u4f55\u503c\u90fd\u6703\u88ab\u5ffd\u7565(ignored)\u548c\u4e1f\u68c4(discarded)\u6389</li> <li>\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u6703\u5c55\u793a(shows)\u5177\u6709\u55ae\u4e00\u500b(single)\u76e3\u807d\u5668(listener)\u7684\u7c21\u55ae<code>EventEmitter</code>\u7269\u4ef6\u5be6\u4f8b(instance)\u3002<code>eventEmitter.on()</code>\u65b9\u6cd5\u662f\u7528\u4f86\u8a3b\u518a\u76e3\u807d\u5668(register listeners),\u800c<code>eventEmitter.emit()</code>\u65b9\u6cd5\u5247\u662f\u7528\u4f86\u89f8\u767c(trigger)\u4e00\u500b\u4e8b\u4ef6(event)     JavaScript<pre><code>const EventEmitter = require('events');\n\nclass MyEmitter extends EventEmitter {}\n\nconst myEmitter = new MyEmitter();\nmyEmitter.on('event', () =&gt; {\n  console.log('an event occurred!');\n});\nmyEmitter.emit('event');\n</code></pre> <p>\u50b3\u905e\u53c3\u6578\u8207<code>this</code>\u7d66\u4e8b\u4ef6\u76e3\u807d\u5668(Passing arguments and this to listeners)</p> </li> <li><code>eventEmitter.emit()</code>\u65b9\u6cd5\u5141\u8a31\u5c07\u4efb\u610f\u4e00\u7d44\u53c3\u6578(arguments)\u50b3\u905e\u7d66\u4e8b\u4ef6\u76e3\u807d\u5668\u51fd\u5f0f(listener functions)\u3002</li> <li>\u8acb\u8a18\u4f4f! \u5728\u547c\u53eb\u666e\u901a\u7684(ordinary)\u4e8b\u4ef6\u76e3\u807d\u5668\u51fd\u5f0f(listener function)\u6642,<code>this</code>\u9019\u500b\u95dc\u9375\u5b57\u6703\u88ab\u523b\u610f\u5730(intentionally)\u88ab\u8a2d\u5b9a\u4f5c\u70ba\u5f15\u7528(reference)\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u6240\u9644\u52a0\u7684<code>EventEmitter</code>\u5be6\u4f8b(instance)       JavaScript<pre><code>const myEmitter = new MyEmitter();\nmyEmitter.on('event', function(a, b) {\n  console.log(a, b, this, this === myEmitter);\n  // Prints:\n  //   a b MyEmitter {\n  //     domain: null,\n  //     _events: { event: [Function] },\n  //     _eventsCount: 1,\n  //     _maxListeners: undefined } true\n});\nmyEmitter.emit('event', 'a', 'b');\n</code></pre></li> <li>\u53ef\u4ee5\u4f7f\u7528ES6\u7684\u7bad\u982d\u51fd\u5f0f(Arrow Functions)\u4f86\u4f5c\u70ba\u4e8b\u4ef6\u76e3\u807d\u5668(listeners),\u7136\u800c\u7576\u9019\u9ebc\u505a\u6642,<code>this</code>\u95dc\u9375\u5b57\u5c31\u4e0d\u6703\u518d\u5f15\u7528(reference)<code>EventEmitter</code>\u5be6\u4f8b(instance)       JavaScript<pre><code>const myEmitter = new MyEmitter();\nmyEmitter.on('event', (a, b) =&gt; {\n  console.log(a, b, this);\n  // Prints: a b {}\n});\nmyEmitter.emit('event', 'a', 'b');\n</code></pre> <p>\u975e\u540c\u6b65\u8207\u540c\u6b65(Asynchronous vs. synchronous)</p> </li> <li><code>Eventemitter</code>\u5be6\u4f8b(instance)\u6703\u540c\u6b65\u5730(synchronously)\u4f9d\u64da\u6240\u6709\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)\u7684\u7167\u5e8f(in the order)\u547c\u53eb,\u9019\u6a23\u53ef\u4ee5\u78ba\u4fdd(ensures)\u4e8b\u4ef6\u7684\u6b63\u78ba\u6392\u5e8f(proper sequencing),\u4e26\u4e14\u80fd\u907f\u514d\u722d\u7528\u689d\u4ef6(race conditions)\u8207\u908f\u8f2f\u932f\u8aa4(logic error)<ul> <li>\u7b49\u5230\u9069\u7576\u6642\u6a5f(appropriate)\u6642,\u4e8b\u4ef6\u76e3\u807d\u5668\u51fd\u5f0f(listener functions)\u53ef\u4ee5\u5229\u7528<code>setImmediate()</code>\u65b9\u6cd5 &amp; <code>process.nextTick()</code>\u65b9\u6cd5\u4f86\u5207\u63db\u5230\u975e\u540c\u6b65\u64cd\u4f5c\u6a21\u5f0f(asynchronous mode of operation) JavaScript<pre><code>const myEmitter = new MyEmitter();\nmyEmitter.on('event', (a, b) =&gt; {\n  setImmediate(() =&gt; {\n    console.log('this happens asynchronously');\n  });\n});\nmyEmitter.emit('event', 'a', 'b');\n</code></pre> <p>\u50c5\u8655\u7406\u4e8b\u4ef6\"1\u6b21\"(Handling events only once)</p> </li> </ul> </li> <li>\u82e5\u5229\u7528<code>eventEmitter.on()</code>\u65b9\u6cd5\u4f86\u8a3b\u518a(registered)\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u6642,\u5247\u7576\u6bcf\u6b21(every time)\u767c\u51fa(emitted)\u88ab\u547d\u540d\u7684\u4e8b\u4ef6(named event)\u6642,\u90fd\u6703\u547c\u53eb(invoked)\u8a72\u4e8b\u4ef6\u76e3\u807d\u5668(listener)       JavaScript<pre><code>const myEmitter = new MyEmitter();\nlet m = 0;\nmyEmitter.on('event', () =&gt; {\n  console.log(++m);\n});\nmyEmitter.emit('event');\n// Prints: 1\nmyEmitter.emit('event');\n// Prints: 2\n</code></pre></li> <li>\u82e5\u5229\u7528<code>eventEmitter.once()</code>\u65b9\u6cd5\u7684\u8a71,\u53ef\u4ee5\u8a3b\u518a(register)\u4e00\u500b\u91dd\u5c0d\u7279\u5b9a\u4e8b\u4ef6(particular event)\u624d\u6703 \u6700\u591a\u88ab\u547c\u53eb\u4e00\u6b21(called at most once)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u3002\u800c\u4e00\u65e6\u9019\u500b\u7279\u5b9a\u4e8b\u4ef6\u88ab\u767c\u51fa(emitted)\u6642,\u8a72\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u5c31\u6703\u88ab\u53d6\u6d88\u8a3b\u518a(unregistered)\u5f8c,\u518d\u547c\u53eb(called)\u8a72\u4e8b\u4ef6\u76e3\u807d\u5668(listener)       JavaScript<pre><code>const myEmitter = new MyEmitter();\nlet m = 0;\nmyEmitter.once('event', () =&gt; {\n  console.log(++m);\n});\nmyEmitter.emit('event');\n// Prints: 1\nmyEmitter.emit('event');\n// Ignored\n</code></pre> <p>\u932f\u8aa4\u4e8b\u4ef6(Error events)</p> </li> <li>\u7576\u67d0\u500b<code>EventEmitter</code>\u5be6\u4f8b(instance)\u767c\u751f\u932f\u8aa4(error occurs)\u6642,\u5178\u578b\u7684\u52d5\u4f5c(typical action)\u662f\u767c\u51fa(emitted)\u4e00\u500b<code>error</code>\u4e8b\u4ef6(event)\u3002\u800c\u9019\u4e9b<code>error</code>\u4e8b\u4ef6(event)\u6703\u5728Node\u4e2d\u88ab\u8996\u70ba(treated as)\u7279\u6b8a\u60c5\u6cc1(special cases)</li> <li>\u82e5\u4e00\u500b<code>Eventemitter</code>\u5be6\u4f8b(instance)\u4e4b\u4e2d,\u4e0d\u5b58\u5728\u81f3\u5c11(at least)\u4e00\u500b\u7528\u4f86\u8a3b\u518a(registered)\u7d66<code>error</code>\u4e8b\u4ef6(event)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u7684\u8a71,\u540c\u6642\u4e5f\u5df2\u7d93\u767c\u51fa(emitted)\u4e86\u4e00\u500b<code>error</code>\u4e8b\u4ef6(event),\u9019\u6642\u8a72<code>error</code>\u4e8b\u4ef6(event)\u5c31\u6703\u88ab\u62cb\u51fa(thrown),\u4e26\u4e14\u5806\u758a\u8ffd\u8e64(stack trace)\u5c31\u6703\u88ab\u6253\u5370(printed)\u51fa,\u6700\u5f8cNode\u7684\u9032\u7a0b(process)\u5c31\u6703\u9000\u51fa(exits)       JavaScript<pre><code>const myEmitter = new MyEmitter();\nmyEmitter.emit('error', new Error('whoops!'));\n// Throws and crashes Node.js\n</code></pre></li> <li>\u70ba\u4e86\u9632\u6b62(To guard against) Node\u7684\u9032\u7a0b(process)\u5d29\u6f70(crashing),\u53ef\u4ee5\u4f7f\u7528Node\u7684Domain\u5167\u5efa\u6838\u5fc3\u6a21\u7d44<ul> <li>\u8acb\u6ce8\u610f! <code>Domain</code>\u6a21\u7d44\u5df2\u68c4\u7f6e(deprecated)</li> </ul> </li> <li>\u4f5c\u70ba\u6700\u4f73\u7684\u5be6\u8e10\u505a\u6cd5(As a best practice),\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)\u61c9\u8a72\u7e3d\u662f\u88ab\u65b0\u589e\u5230<code>error</code>\u4e8b\u4ef6(event)\u4e0a       JavaScript<pre><code>const myEmitter = new MyEmitter();\nmyEmitter.on('error', (err) =&gt; {\n  console.error('whoops! there was an error');\n});\nmyEmitter.emit('error', new Error('whoops!'));\n// Prints: whoops! there was an error\n</code></pre></li> <li>\u6211\u5011\u53ef\u4ee5\u900f\u904eevents.errorMonitor\u7b26\u865f(symbol)\u4f86\u5b89\u88dd\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listener),\u4ee5\u7528\u4f86\u76e3\u6e2c<code>error</code>\u4e8b\u4ef6(event),\u800c\u4e0d\u7528(without)\u6d88\u8017(consuming)\u767c\u51fa\u7684\u932f\u8aa4(emitted error)       JavaScript<pre><code>const { EventEmitter, errorMonitor } = require('events');\n\nconst myEmitter = new EventEmitter();\nmyEmitter.on(errorMonitor, (err) =&gt; {\n  MyMonitoringTool.log(err);\n});\nmyEmitter.emit('error', new Error('whoops!'));\n// Still throws and crashes Node.js\n</code></pre> <p>Class</p> </li> <li>EventEmitter<ul> <li><code>EventEmitter</code>\u985e\u5225(class)\u662f\u88ab\u7528\u4f86\u5b9a\u7fa9 &amp; \u516c\u958b<code>Events</code>\u6a21\u7d44(module)\u7684</li> <li>\u53ef\u4ee5\u9019\u6a23\u5f15\u7528<code>EvenEmitter</code>\u985e\u5225(class)     JavaScript<pre><code>const EventEmitter = require('events');\n</code></pre></li> <li>\u7576\u65b0\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(new listeners)\u88ab\u65b0\u589e\u6642,\u6240\u6709\u7684<code>EvenEmitter</code>\u985e\u5225(class)\u90fd\u6703\u767c\u51fanewListener\u9019\u500b\u4e8b\u4ef6(event); \u4e26\u4e14\u7576\u5df2\u7d93\u5b58\u5728\u7684(existed)\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)\u88ab\u79fb\u9664\u6642(removed),\u6703\u767c\u51faremoveListener\u9019\u500b\u4e8b\u4ef6</li> <li><code>EventEmitter</code>\u985e\u5225(class)\u53ef\u4ee5\u652f\u63f4captureRejections\u9019\u500b\u9078\u9805(option)</li> <li><code>captureRejections</code>: (boolean)<ul> <li>\u9019\u500b\u9078\u9805\u80fd\u5920\u81ea\u52d5\u5730(automatic)\u6355\u6293(capturing)\u88ab\u62d2\u7d55(rejection)\u7684<code>Promise</code>\u7269\u4ef6</li> <li>\u9810\u8a2d\u503c: <code>false</code></li> </ul> </li> </ul> </li> <li> <p>Event</p> <ul> <li>newListener</li> <li>args<ul> <li>eventName: (string) | (symbol)</li> <li>\u6b63\u5728\u76e3\u807d\u7684\u4e8b\u4ef6(event)\u7684\u540d\u7a31</li> <li>listener: (Function)</li> <li>\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u51fd\u5f0f(function)</li> </ul> </li> <li><code>EventEmitter</code>\u5be6\u4f8b(instance)\u6703\u5728\u7576\u6709\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u88ab\u52a0\u5165\u5230\u81ea\u8eab\u5167\u90e8\u7684(internal)\u4e8b\u4ef6\u76e3\u807d\u5668\u5011(listeners)\u9663\u5217(array)\u4e4b\u524d,\u5148\u767c\u51fa(emit)\u4e00\u500b\u81ea\u8eab(own)\u7684<code>newListener</code>\u4e8b\u4ef6(event)</li> <li>\u70ba\u4e86<code>newListener</code>\u4e8b\u4ef6(event)\u800c\u8a3b\u518a(registered)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668\u5011(listeners)\u5c07\u6703\u50b3\u905e(passed)\u4e8b\u4ef6\u540d\u7a31\u8207\u8981\u65b0\u589e(being added)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u7684\u53c3\u8003(reference)</li> <li>\u4e8b\u5be6\u4e0a,\u5728\u65b0\u589e\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u4e4b\u524d\u89f8\u767c(triggered)\u7684\u4e8b\u4ef6\u4e2d\u6709\u4e00\u500b\u5fae\u5999(subtle)\u537b\u5f88\u91cd\u8981(important)\u7684\u526f\u4f5c\u7528(side effect)</li> <li>\u4efb\u4f55\u7528\u4f86\u8a3b\u518a(registered)\u7d66\u540c\u540d(same <code>name</code>)\u7684<code>newListener</code>\u56de\u547c\u51fd\u5f0f(callback)\u4e4b\u5167(within)\u7684\u984d\u5916(additional)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668\u5011(listeners),\u90fd\u6703\u5728\u90a3\u4e9b\u88ab\u65b0\u589e(added)\u5230\u9032\u7a0b\u4e2d(process)\u7684\u4e8b\u4ef6\u76e3\u807d\u5668\"\u4e4b\u524d\"\u5c31\u6703\u88ab\u63d2\u5165     JavaScript<pre><code>class MyEmitter extends EventEmitter {}\n\nconst myEmitter = new MyEmitter();\n// Only do this once so we don't loop forever\nmyEmitter.once('newListener', (event, listener) =&gt; {\n  if (event === 'event') {\n    // Insert a new listener in front\n    myEmitter.on('event', () =&gt; {\n      console.log('B');\n    });\n  }\n});\nmyEmitter.on('event', () =&gt; {\n  console.log('A');\n});\nmyEmitter.emit('event');\n// Prints:\n//   B\n//   A\n</code></pre></li> <li>removeListener</li> <li>args<ul> <li>eventName: (string) | (symbol)</li> <li>\u4e8b\u4ef6(event)\u7684\u540d\u7a31</li> <li>listener: (Function)</li> <li>\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u51fd\u5f0f(function)</li> </ul> </li> <li>\u7576\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u88ab\u79fb\u9664(removed)\u5f8c,\u6703\u767c\u51fa(emitted)\u4e00\u500b<code>removeListener</code>\u4e8b\u4ef6(event)</li> </ul> </li> <li>emitter.on(eventName, listener)<ul> <li>args</li> <li>eventName: (string) | (symbol)<ul> <li>\u4e8b\u4ef6(event)\u7684\u540d\u7a31</li> </ul> </li> <li>listener: (Function)<ul> <li>\u8a72\u4e8b\u4ef6\u76e3\u807d\u5668\u8981\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback function)</li> </ul> </li> <li>Returns: (<code>EventEmitter</code>)\u985e\u5225(class)</li> <li>\u5728\u6307\u5b9a\u7684\u4e8b\u4ef6(event, \u4e5f\u5c31\u662f<code>eventName</code>\u53c3\u6578\u7684\u503c)\u4e2d\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)\u9663\u5217(array)\u7684\u7d50\u5c3e(end)\u4e0a\u65b0\u589e\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668\u51fd\u5f0f(<code>listener</code> function, \u4e5f\u5c31\u662f<code>listener</code>\u53c3\u6578\u7684\u503c)</li> <li>\u4e0d\u6703\u53bb\u6aa2\u67e5\u662f\u5426\u6709\u8a72\u4e8b\u4ef6\u76e3\u807d\u5668\u8981\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback function)\u5df2\u7d93\u88ab\u65b0\u589e\u4e86</li> <li>\u82e5\u591a\u6b21\u547c\u53eb(Multiple calls)\u4e26\u50b3\u905e\u76f8\u540c\u7684<code>eventName</code>\u8207<code>listener</code>\u5169\u500b\u53c3\u6578\u503c\u7684\u7d44\u5408(combination)\u7684\u8a71,\u5c07\u5c0e\u81f4(result in)\u6b64\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u6703\u88ab\u591a\u6b21(multiple times)\u547c\u53eb(called) &amp; \u65b0\u589e(added)   JavaScript<pre><code>server.on('connection', (stream) =&gt; {\n  console.log('someone connected!');\n});\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u53ef\u4ee5\u770b\u51fa\u4f86,<code>emitter.on()</code>\u65b9\u6cd5\u5c07\u6703\u56de\u50b3(returns)\u4e00\u500b\u5c0d<code>EventEmitter</code>\u985e\u5225(class)\u7684\u53c3\u8003(reference),\u4ee5\u4fbf\u8b93\u9019\u500b\u547c\u53eb(calls)\u53ef\u4ee5\u88ab\u4e32\u9023\u4f7f\u7528(chained)</li> <li>\u9810\u8a2d\u60c5\u6cc1\u4e0b,\u4e8b\u4ef6\u76e3\u807d\u5668(event listeners)\u5011\u6703\u4f9d\u7167\u5b83\u5011\u88ab\u65b0\u589e\u7684\u9806\u5e8f(in the order they are added)\u547c\u53eb(invoked)</li> <li>\u53e6\u4e00\u500b\u66ff\u4ee3\u65b9\u6848(alternative)\u662f\u5229\u7528emitter.prependListener(eventName, listener)\u65b9\u6cd5\u4f86\u5c07\u4e00\u500b\u6307\u5b9a\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(event listener)\u65b0\u589e\u5230\u6574\u500b\u4e8b\u4ef6\u76e3\u807d\u5668\u9663\u5217(the listeners array)\u7684\u6700\u524d\u9762(beginning)     JavaScript<pre><code>const myEE = new EventEmitter();\nmyEE.on('foo', () =&gt; console.log('a'));\nmyEE.prependListener('foo', () =&gt; console.log('b'));\nmyEE.emit('foo');\n// Prints:\n//   b\n//   a\n</code></pre></li> </ul> </li> <li>emitter.emit(eventName[, ...args])<ul> <li>args</li> <li>eventName: (string) | (symbol)</li> <li>...args: (any)</li> <li>Returns: (boolean)<ul> <li>\u7576\u8a72\u6307\u5b9a\u7684\u4e8b\u4ef6\u540d\u7a31(event, \u4e5f\u5c31\u662f<code>eventName</code>\u53c3\u6578\u7684\u503c)\u6709\u4e8b\u4ef6\u76e3\u807d\u5668(listeners)\u6642,\u56de\u50b3<code>true</code>; \u53cd\u4e4b,\u5247\u56de\u50b3<code>false</code></li> </ul> </li> <li>\u540c\u6b65\u5730(Synchronously)\u547c\u53eb(calls)\u88ab\u8a3b\u518a(registered)\u7d66\u6307\u5b9a\u7684\u4e8b\u4ef6(event, \u4e5f\u5c31\u662f<code>eventName</code>\u53c3\u6578\u7684\u503c)\u4e2d\u7684\u6bcf\u4e00\u500b(each of)\u4e8b\u4ef6\u76e3\u807d\u5668(listeners),\u4e26\u4f9d\u7167\u5b83\u5011\u88ab\u8a3b\u518a(registered)\u7684\u9806\u5e8f(in the order),\u50b3\u905e(passing)\u7d66\u6bcf\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(to each)\u9700\u8981\u7684\u53c3\u6578(supplied arguments)</li> </ul> </li> <li>emitter.once(eventName, listener)<ul> <li>args</li> <li>eventName: (string) | (symbol)<ul> <li>\u4e8b\u4ef6(event)\u7684\u540d\u7a31</li> </ul> </li> <li>listener: (Function)<ul> <li>\u8a72\u4e8b\u4ef6\u76e3\u807d\u5668\u8981\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback function)</li> </ul> </li> <li>Returns: (<code>EventEmitter</code>)\u985e\u5225(class)</li> <li>\u65b0\u589e\u4e00\u500b \u4e00\u6b21\u6027(one-time) \u7684\u4e8b\u4ef6\u76e3\u807d\u5668\u51fd\u5f0f(<code>listener</code> function, \u4e5f\u5c31\u662f<code>listener</code>\u53c3\u6578\u7684\u503c)\u7d66\u6307\u5b9a\u7684\u4e8b\u4ef6(event, \u4e5f\u5c31\u662f<code>eventName</code>\u53c3\u6578\u7684\u503c)</li> <li>\u7576\u4e0b\u4e00\u6b21\u8a72\u6307\u5b9a\u7684<code>eventName</code>\u4e8b\u4ef6\u88ab\u89f8\u767c(triggered)\u6642,\u9019\u500b \u4e00\u6b21\u6027(one-time) \u7684\u4e8b\u4ef6\u76e3\u807d\u5668\u51fd\u5f0f(listener)\u5c31\u6703\u88ab\u547c\u53eb(invoked)\u4e26\u79fb\u9664(removed)   JavaScript<pre><code>server.once('connection', (stream) =&gt; {\n  console.log('Ah, we have our first user!');\n});\n</code></pre></li> <li>\u4ee5\u4e0a\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u53ef\u4ee5\u770b\u51fa\u4f86,<code>emitter.on()</code>\u65b9\u6cd5\u5c07\u6703\u56de\u50b3(returns)\u4e00\u500b\u5c0d<code>EventEmitter</code>\u985e\u5225(class)\u7684\u53c3\u8003(reference),\u4ee5\u4fbf\u8b93\u9019\u500b\u547c\u53eb(calls)\u53ef\u4ee5\u88ab\u4e32\u9023\u4f7f\u7528(chained)</li> <li>\u9810\u8a2d\u60c5\u6cc1\u4e0b,\u4e8b\u4ef6\u76e3\u807d\u5668(event listeners)\u5011\u6703\u4f9d\u7167\u5b83\u5011\u88ab\u65b0\u589e\u7684\u9806\u5e8f(in the order they are added)\u547c\u53eb(invoked)</li> <li>\u53e6\u4e00\u500b\u66ff\u4ee3\u65b9\u6848(alternative)\u662f\u5229\u7528emitter.prependListener(eventName, listener)\u65b9\u6cd5\u4f86\u5c07\u4e00\u500b\u6307\u5b9a\u7684\u4e8b\u4ef6\u76e3\u807d\u5668(event listener)\u65b0\u589e\u5230\u6574\u500b\u4e8b\u4ef6\u76e3\u807d\u5668\u9663\u5217(the listeners array)\u7684\u6700\u524d\u9762(beginning)     JavaScript<pre><code>const myEE = new EventEmitter();\nmyEE.once('foo', () =&gt; console.log('a'));\nmyEE.prependOnceListener('foo', () =&gt; console.log('b'));\nmyEE.emit('foo');\n// Prints:\n//   b\n//   a\n</code></pre></li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#buffers","title":"Buffers","text":"<ul> <li><code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u88ab\u7528\u4f86\u4ee3\u8868(represent)\u4e00\u500b\u56fa\u5b9a\u9577\u5ea6(fixed-length)\u7684\u5b57\u7bc0\u5e8f\u5217(sequence of bytes)\u3002\u6709\u8a31\u591aNode\u7684\u5b98\u65b9API\u90fd\u6709\u652f\u63f4<code>Buffer</code>(\u7de9\u5b58)</li> <li><code>Buffer</code>(\u7de9\u5b58)\u985e\u5225(Class)\u662fJavascript\u7684Uint8Array\u985e\u5225\u7684\u5b50\u985e\u5225(subclass),\u4e26\u4e14<code>Buffer</code>\u985e\u5225\u6709\u7e7c\u627f(extends)\u4e86\u5b83\u7684\u8a31\u591a\u65b9\u6cd5(methods),\u9019\u4e9b\u65b9\u6cd5\u5011\u90fd\u6709\u6db5\u84cb(cover)\u4e86\u984d\u5916(additional)\u7684\u8a31\u591a\u4f7f\u7528\u60c5\u5883(use cases)</li> <li>\u56e0\u70baNode\u7684\u5b98\u65b9API\u80fd\u63a5\u53d7(accept)\u666e\u901a(plain)\u7684<code>Uint8Array</code>\u985e\u5225,\u6240\u4ee5\u5230\u4e0d\u8ad6\u5728\u54ea\u88e1(wherever)\u4e5f\u90fd\u6703\u652f\u6301(supported)<code>`Buffer</code>(\u7de9\u5b58)\u985e\u5225</li> <li><code>Buffer</code>(\u7de9\u5b58)\u985e\u5225(Class)\u662f\u5728\u5168\u57df\u7684(global)\u7bc4\u570d(scope)\u4e4b\u5167,\u56e0\u6b64\u4e0d\u592a\u53ef\u80fd(unlikely)\u6703\u9700\u8981\u5229\u7528<code>require('buffer').Buffer</code>\u7684\u8a9e\u6cd5\u4f86\u532f\u5165\u6b64\u6a21\u7d44</li> <li><code>Buffer</code>\u7de9\u5b58\u7269\u4ef6(object)\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>// Creates a zero-filled Buffer of length 10.\nconst buf1 = Buffer.alloc(10);\n\n// Creates a Buffer of length 10,\n// filled with bytes which all have the value `1`.\nconst buf2 = Buffer.alloc(10, 1);\n\n// Creates an uninitialized buffer of length 10.\n// This is faster than calling Buffer.alloc() but the returned\n// Buffer instance might contain old data that needs to be\n// overwritten using fill(), write(), or other functions that fill the Buffer's\n// contents.\nconst buf3 = Buffer.allocUnsafe(10);\n\n// Creates a Buffer containing the bytes [1, 2, 3].\nconst buf4 = Buffer.from([1, 2, 3]);\n\n// Creates a Buffer containing the bytes [1, 1, 1, 1] \u2013 the entries\n// are all truncated using `(value &amp; 255)` to fit into the range 0\u2013255.\nconst buf5 = Buffer.from([257, 257.5, -255, '1']);\n\n// Creates a Buffer containing the UTF-8-encoded bytes for the string 't\u00e9st':\n// [0x74, 0xc3, 0xa9, 0x73, 0x74] (in hexadecimal notation)\n// [116, 195, 169, 115, 116] (in decimal notation)\nconst buf6 = Buffer.from('t\u00e9st');\n\n// Creates a Buffer containing the Latin-1 bytes [0x74, 0xe9, 0x73, 0x74].\nconst buf7 = Buffer.from('t\u00e9st', 'latin1');\n</code></pre> <p><code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6\u5011\u8207\u5b57\u5143\u7de8\u78bc (Buffers and character encodings)</p> </li> <li>\u82e5\u8981\u5c07<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u8f49\u63db(converting)\u70ba\u5b57\u4e32(string)\u6216\u662f\u53cd\u904e\u4f86\u8f49\u63db\u7684\u8a71,\u53ef\u80fd\u6703\u9700\u8981\u6307\u5b9a(specified)\u4e00\u500b\u7de8\u78bc\u65b9\u5f0f\u3002\u82e5\u9019\u6642\u5019\u6c92\u6709\u6307\u5b9a\u4e00\u500b\u7de8\u78bc\u65b9\u5f0f(character encoding)\u7684\u8a71,\u9810\u8a2d(default)\u6703\u4f7f\u7528(used)<code>utf-8</code>\u9019\u500b\u7de8\u78bc\u65b9\u5f0f\u4f86\u9032\u884c       JavaScript<pre><code>const buf = Buffer.from('hello world', 'utf8');\n\nconsole.log(buf.toString('hex'));\n// Prints: 68656c6c6f20776f726c64\nconsole.log(buf.toString('base64'));\n// Prints: aGVsbG8gd29ybGQ=\n\nconsole.log(Buffer.from('fhqwhgads', 'utf8'));\n// Prints: &lt;Buffer 66 68 71 77 68 67 61 64 73&gt;\nconsole.log(Buffer.from('fhqwhgads', 'utf16le'));\n// Prints: &lt;Buffer 66 00 68 00 71 00 77 00 68 00 67 00 61 00 64 00 73 00&gt;\n</code></pre></li> <li>\u4ee5\u4e0b\u662f\u76ee\u524d(currently)Node\u6709\u652f\u63f4(supported)\u7684\u5b57\u5143\u7de8\u78bc(character encodings)\u65b9\u5f0f<ul> <li><code>utf8</code>: \u591a\u5b57\u7bc0(Multi-byte)\u7de8\u78bc(encoded)\u7684\u842c\u570b\u78bc(Unicode)\u5b57\u5143\u5011(characters)\u3002\u6709\u8a31\u591a\u7684\u7db2\u9801(web pages) &amp; \u5176\u5b83\u7684\u6587\u4ef6(document)\u683c\u5f0f(formats)\u90fd\u662f\u4f7f\u7528utf-8\u9019\u500b\u7de8\u78bc\u65b9\u5f0f</li> <li>\u9019\u662f<code>Buffer</code>\u7269\u4ef6\u6240\u9810\u8a2d(default)\u7684\u7de8\u78bc\u65b9\u5f0f(character encoding)</li> <li>\u82e5\u5c07<code>Buffer</code>\u7269\u4ef6\u89e3\u78bc\u6210(decoding)\u5b57\u4e32\u6642,\u4e26\u4e0d\u6703\u50c5\u50c5(exclusively)\u5305\u542b(contain)\u6709\u6548\u7684(valid)<code>UTF-8</code>\u7de8\u78bc\u683c\u5f0f\u7684\u8cc7\u6599(data),\u6709\u932f\u8aa4(errors)\u7684\u842c\u570b\u78bc\u8cc7\u6599\u6703\u88ab\u4ee5<code>U+FFFD \ufffd</code>\u9019\u500b\u842c\u570b\u78bc(Unicode)\u53d6\u4ee3\u5b57\u5143(replacement character)\u4f86\u8868\u793a(represent)</li> <li><code>utf16le</code>: \u591a\u5b57\u7bc0(Multi-byte)\u7de8\u78bc(encoded)\u7684\u842c\u570b\u78bc(Unicode)\u5b57\u5143\u5011(characters)\u3002\u4e0d\u540c(Unlike)\u65bc<code>utf8</code>\u7684\u662f,\u6bcf\u4e00\u500b\u5728\u5b57\u4e32(string)\u4e2d\u7684\u5b57\u5143(each character)\u90fd\u6703\u4ee52\u6216\u662f4\u500b\u4f4d\u5143\u7d44(bytes)\u4f86\u7de8\u78bc(encoded)</li> <li>Node\u53ea\u6703\u652f\u63f4(supports)UTF-16\u7684\u8b8a\u9ad4(variant)=&gt; little-endian</li> <li><code>latin1</code>: <code>Latin-1</code>\u662f\u4ee3\u8868(stands for)ISO-8859-1\u3002\u9019\u500b\u5b57\u5143\u7de8\u78bc\u65b9\u5f0f(character encoding)\u50c5\u6703\u652f\u63f4(supports)\u5f9e\u842c\u570b\u78bc(Unicode)\u7684<code>U+0000</code>~<code>U+00FF</code>\u5b57\u5143(character)\u80fd\u7de8\u78bc(encoded)\u3002\u6bcf\u500b\u5b57\u5143(Each character)\u90fd\u6703\u7528\u55ae\u4e00\u500b\u4f4d\u5143\u7d44(single byte)\u4f86\u7de8\u78bc(encoded)\u3002\u90a3\u4e9b\u4e0d\u5728(do not fit into)\u524d\u8ff0\u7bc4\u570d(range)\u5167\u7684\u5b57\u5143\u5011(characters)\u6703\u88ab\u622a\u6389(truncated)\u5f8c,\u4e26\u6703\u95dc\u806f(mapped)\u5230\u524d\u8ff0\u7bc4\u570d\u5167\u7684\u5b57\u5143(characters)</li> </ul> </li> <li>\u82e5\u5229\u7528\u4e0a\u8ff0(above)\u63d0\u53ca(referred)\u7684\u4efb\u4f55\u4e00\u7a2e\u65b9\u5f0f,\u5c07<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u8f49\u63db\u70ba\u5b57\u4e32(string),\u90a3\u5c31\u662f \u89e3\u78bc(decoding) ; \u800c\u5982\u679c\u662f\u5c07\u5b57\u4e32(string)\u8f49\u63db\u70ba<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object),\u90a3\u5c31\u662f \u7de8\u78bc(encoding)</li> <li>Node\u4e5f\u6709\u652f\u63f4(supports)\u4ee5\u4e0b2\u7a2e\u4f4d\u5143\u7d44\u8f49\u5b57\u4e32(binary-to-text)\u7684\u7de8\u78bc\u65b9\u5f0f(encodings)\u3002 \u5c0d\u65bc\u4f4d\u5143\u7d44\u8f49\u5b57\u4e32\u7684\u7de8\u78bc\u65b9\u5f0f\u4f86\u8aaa,\u547d\u540d\u6163\u4f8b(naming convention)\u662f\u76f8\u53cd\u7684,\u4e5f\u5c31\u662f\u8aaa\u5c07<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u8f49\u63db\u70ba\u5b57\u4e32(string),\u90a3\u5c31\u662f\u7de8\u78bc(encoding); \u800c\u5982\u679c\u662f\u5c07\u5b57\u4e32(string)\u8f49\u63db\u70ba<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object),\u90a3\u5c31\u662f\u89e3\u78bc(decoding)<ul> <li><code>base64</code>: \u5c31\u662fBase64\u9019\u500b\u7de8\u78bc\u65b9\u5f0f(encoding)\u3002</li> <li>\u6bcf\u7576\u900f\u904e(from)\u5b57\u4e32\u4f86\u5efa\u7acb(creating)\u4e00\u500b<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u6642,\u9019\u500b\u7de8\u78bc\u65b9\u5f0f\u4e5f\u80fd\u6b63\u78ba\u5730(correctly)\u63a5\u53d7(accept)\u81eaRFC4648\u7684\u7b2c5\u7ae0\u7bc0\u4e2d\u6307\u5b9a(specified)\u7684\"<code>URL</code>\u8207\u6a94\u6848\u540d\u7a31\u7684\u5b89\u5168\u5b57\u6bcd( Filename Safe Alphabet)\"\u3002\u5728<code>base64</code>\u9019\u500b\u7de8\u78bc\u65b9\u5f0f\u4e2d\u7684\u6240\u6709\u88ab\u5305\u542b(contained)\u5728\u5b57\u4e32\u4e2d(within)\u7684\u7a7a\u767d\u5b57\u5143(whitespace characters),\u50cf\u662f\u7a7a\u767d(spaces)\u3001<code>tabs</code>\u9375\u3001\u63db\u884c\u7b26(new lines)\u90fd\u6703\u88ab\u5ffd\u7565(ignored)</li> <li><code>hex</code>: \u5c07\u6bcf\u500b\u4f4d\u5143\u7d44(each bytes)\u90fd\u7de8\u78bc(encode)\u70ba2\u500b16\u9032\u4f4d(hexadecimal)\u7684\u5b57\u5143(characters)</li> <li>\u7576\u89e3\u78bc\u5b57\u4e32(decoding strings)\u50c5(exclusively)\u5305\u542b(contain)\u6709\u6548\u7684(valid)16\u9032\u4f4d(hexadecimal)\u7684\u5b57\u5143(characters)\u6642,\u5c31\u53ef\u80fd(may)\u6703\u767c\u751f(occur)\u8cc7\u6599\u622a\u65b7(data truncation)\u3002\u8acb\u898b\u4ee5\u4e0b\u7bc4\u4f8b(example)</li> </ul> </li> <li>Node\u4e5f\u53ef\u4ee5\u652f\u63f4(supported)\u4ee5\u4e0b\u7684\u50b3\u7d71(legacy)\u5b57\u5143\u7de8\u78bc\u65b9\u5f0f(character encodings)<ul> <li><code>ascii</code>: \u50c5\u9069\u7528\u65bc7\u500b\u4f4d\u5143\u7d44(=&gt; \u4e5f\u5c31\u662f7-bit)\u7684ASCII\u7de8\u78bc\u683c\u5f0f\u7684\u8cc7\u6599(data)</li> <li>\u7576\u5c07\u5b57\u4e32(string)\u7de8\u78bc(encoding)\u70ba<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u6642,\u9019\u5c31\u76f8\u7576(equivalent)\u65bc\u662f\u4f7f\u7528(using)<code>latin1</code>\u9019\u500b\u7de8\u78bc\u65b9\u5f0f</li> <li>\u7576\u5c07<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u89e3\u78bc(decoding)\u70ba\u5b57\u4e32(string)\u6642,\u4f7f\u7528<code>ascii</code>\u9019\u500b\u7de8\u78bc\u65b9\u5f0f\u5c31\u6703\u53e6\u5916(additionally)\u5c07\u6bcf\u500b\u4f4d\u5143\u7d44(each byte)\u7684\u6700\u9ad8\u4f4d\u5143(highest bit)\u79fb\u52d5(unset),\u7136\u5f8c\u518d\u89e3\u78bc(decoding)\u70ba<code>latin1</code>\u7684\u7de8\u78bc\u683c\u5f0f</li> <li>\u901a\u5e38(Generally),\u6211\u5011\u6c92\u6709\u7406\u7531(no reason)\u6703\u9700\u8981\u4f7f\u7528<code>ascii</code>\u9019\u7a2e\u7de8\u78bc\u65b9\u5f0f,\u56e0\u70ba\u5df2\u7d93\u6709<code>utf-8</code>\u7de8\u78bc\u683c\u5f0f\u4e86(\u6216\u8005,\u5982\u679c\u5c0d\u5df2\u77e5\u6578\u64da(the data is known)\u7e3d\u662f\u50c5\u80fd\u4f7f\u7528<code>ASCII</code>\u7de8\u78bc\u683c\u5f0f(ASCII-only)\u7684\u8a71 or \u5728\u7de8\u78bc(<code>encode</code>)/\u89e3\u78bc(<code>decode</code>)\u6642,\u50c5\u80fd\u4f7f\u7528<code>ASCII</code>\u7de8\u78bc\u683c\u5f0f\u7684\u6587\u5b57(ASCII-only text)\u7684\u8a71,\u5247<code>latin1</code>\u5c31\u6703\u662f\u4e00\u500b\u66f4\u597d\u7684\u9078\u64c7(better choice))</li> <li>Node\u4e4b\u6240\u4ee5\u6703\u63d0\u4f9b(provided)<code>ASCII</code>\u9019\u7a2e\u7de8\u78bc\u683c\u5f0f\u7684\u539f\u56e0\u5c31\u53ea\u662f\u70ba\u4e86\u50b3\u7d71(legacy)\u7684\u76f8\u5bb9\u6027(compatibility)\u554f\u984c</li> <li><code>binary</code>: \u70ba<code>latin1</code>\u7684\u5225\u540d(alias)\u3002\u53ef\u5148\u53c3\u8003binary strings\u4f86\u4e86\u89e3\u66f4\u591a\u95dc\u65bc\u9019\u500b\u4e3b\u984c(topic)\u7684\u80cc\u666f\u77e5\u8b58(brackground)</li> <li>\u5176\u5be6<code>binary</code>\u9019\u500b\u7de8\u78bc\u65b9\u5f0f\u7684\u547d\u540d(name)\u5f88\u5bb9\u6613\u88ab\u8aa4\u5c0e(misleading),\u662f\u56e0\u70ba\u6240\u6709\u9019\u88e1\u6240\u5217\u51fa(listed)\u7684\u7de8\u78bc\u65b9\u5f0f(encodings)\u90fd\u662f\u8981\u5c07\u5b57\u4e32(<code>string</code>)\u8207\u4e8c\u9032\u4f4d\u5143(<code>binary</code>)\u7684\u8cc7\u6599\u4e4b\u9593\u505a\u76f8\u4e92\u8f49\u63db(convert between)\u3002 \u800c\u5c0d\u65bc\u8981\u5c07\u5b57\u4e32(<code>string</code>)\u8207<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u7684\u8cc7\u6599\u4e4b\u9593\u505a\u76f8\u4e92\u8f49\u63db(converting between),\u901a\u5e38<code>utf-8</code>\u7de8\u78bc\u65b9\u5f0f\u6703\u662f\u6b63\u78ba\u7684\u9078\u64c7(right choice)</li> <li><code>ucs2</code>: \u70ba<code>utf16le</code>\u7684\u5225\u540d(alias)\u3002\u5728\u4ee5\u524d(used to),<code>UCS-2</code>\u9019\u7a2e\u7de8\u78bc\u65b9\u5f0f\u662f\u6307\u53c3\u8003(refer to)<code>UTF-16</code>\u7de8\u78bc\u65b9\u5f0f\u800c\u7522\u751f\u7684\u8b8a\u5f62(variant),\u4e3b\u8981\u662f\u70ba\u4e86\u652f\u63f4(support)\u90a3\u4e9b\u9ede\u4f4d(code points)\u8d85\u904e(larger than)<code>U+FFFF</code>\u7684\u5b57\u5143(characters)</li> <li>\u5728Node\u4e2d,\u9019\u4e9b\u9ede\u4f4d(code points)\u7686\u7e3d\u662f\u6709\u88ab\u652f\u63f4(always supported)\u4e86   JavaScript<pre><code>Buffer.from('1ag', 'hex');\n// Prints &lt;Buffer 1a&gt;, data truncated when first non-hexadecimal value\n// ('g') encountered.\n\nBuffer.from('1a7g', 'hex');\n// Prints &lt;Buffer 1a&gt;, data truncated when data ends in single digit ('7').\n\nBuffer.from('1634', 'hex');\n// Prints &lt;Buffer 16 34&gt;, all data represented.\n</code></pre></li> </ul> </li> <li>\u73fe\u4ee3\u5316\u7db2\u9801\u700f\u89bd\u5668\u7686\u6709\u9075\u5faaWHATWG Encoding Standard,\u4e5f\u5c31\u662f<code>latin1</code>\u3001<code>ISO-8859-1</code>\u7686\u70ba<code>win-1252</code>\u9019\u500b\u7de8\u78bc\u65b9\u5f0f\u7684\u5225\u540d(alias)\u3002\u9019\u4e5f\u610f\u5473(means)\u8457\u7576\u57f7\u884c\u50cf\u662f<code>http.get()</code>\u65b9\u6cd5\u7684\u6642\u5019,\u5982\u679c\u56de\u50b3(returned)\u7684\u5b57\u5143\u7de8\u78bc\u683c\u5f0f(charset)\u70ba<code>WHATWG</code>\u898f\u683c(specification)\u4e2d\u5217\u51fa(listed)\u7684\u5176\u4e2d\u4e00\u7a2e\u6642,\u5f88\u6709\u53ef\u80fd(possible)\u5176\u5be6\u4f3a\u670d\u5668(server)\u5be6\u969b\u4e0a(actually)\u662f\u56de\u50b3(returned)\u4ee5<code>win-1252</code>\u9019\u500b\u7de8\u78bc\u65b9\u5f0f\u6240\u7de8\u78bc\u904e\u5f8c\u7684\u8cc7\u6599(=&gt; \u4e5f\u5c31\u662f<code>win-1252</code>-encoded data),\u6240\u4ee5\u9019\u6642\u5019\u5982\u679c\u4f7f\u7528<code>latin1</code>\u9019\u500b\u7de8\u78bc\u65b9\u5f0f\u4f86\u89e3\u78bc(decode)\u5b57\u5143(characters)\u7684\u8a71,\u6703\u9020\u6210\u932f\u8aa4(incorrectly) <p><code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object) &amp; \u8fed\u4ee3 (Buffers and iteration)</p> </li> <li><code>Buffers</code>(\u7de9\u5b58)\u5be6\u4f8b(instances)\u662f\u80fd\u5920\u5229\u7528(using)<code>for...of</code>\u8a9e\u6cd5(syntax)\u4f86\u8fed\u4ee3(iterated over)\u7684       JavaScript<pre><code>const buf = Buffer.from([1, 2, 3]);\n\nfor (const b of buf) {\n  console.log(b);\n}\n// Prints:\n//   1\n//   2\n//   3\n</code></pre></li> <li>\u6b64\u5916(Additionally),buf.values()\u3001buf.keys()\u3001buf.entries()\u65b9\u6cd5(methods)\u7686\u53ef\u4ee5\u88ab\u7528\u4f86(used to)\u5efa\u7acb(create)\u8fed\u4ee3(iterators) <p>Class</p> </li> <li>Buffer<ul> <li><code>Buffers</code>(\u7de9\u5b58)\u985e\u5225(class)\u662f\u4e00\u500b\u5168\u57df(global)\u7684\u578b\u5225(type)\u4ee5\u7528\u4f86\u66f4\u76f4\u63a5(directly)\u5730\u8655\u7406(dealing)\u4e8c\u9032\u4f4d\u5236\u4f4d\u5143(binary)\u7684\u8cc7\u6599(data)\u3002\u5b83\u80fd\u900f\u904e\u8a31\u591a\u7a2e\u65b9\u5f0f(in a variety of ways)\u4f86\u5efa\u69cb(constructed)\u51fa\u4f86</li> </ul> </li> <li> <p>Static method</p> <ul> <li>Buffer.alloc(size[, fill[, encoding]])</li> <li>args<ul> <li>size: (integer)</li> <li>\u6e34\u671b(desired)\u65b0(new)\u7684<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u9577\u5ea6(length)\u662f\u591a\u5c11</li> <li>fill: (string) | (Buffer) | Unit8Array | integer</li> <li>\u8981\u9810\u5148\u586b\u9032(pre-fill)\u65b0(new)\u7684<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u7684\u503c(value)</li> <li>\u9810\u8a2d\u503c: <code>0</code></li> <li>encoding: (string)</li> <li>\u5982\u679c<code>fill</code>\u53c3\u6578\u7684\u503c\u662f\u5b57\u4e32(string)\u578b\u5225\u7684\u8a71,\u90a3\u9ebc\u6b64<code>encoding</code>\u53c3\u6578\u7684\u503c\u5c31\u6703\u662f\u9019\u500b\u5b57\u4e32\u53c3\u6578\u7684\u7de8\u78bc\u683c\u5f0f(encoding)</li> <li>\u9810\u8a2d\u503c: <code>utf8</code></li> </ul> </li> <li>\u6703\u5206\u914d(allocates)\u4e00\u500b\u7b26\u5408<code>size</code>\u53c3\u6578\u503c\u6307\u5b9a\u5927\u5c0f\u7684\u65b0(new)\u7684<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u3002\u5982\u679c<code>fill</code>\u53c3\u6578\u7684\u503c\u662f<code>undefined</code>\u7684\u8a71,\u5247<code>Buffer</code>\u7269\u4ef6\u7684\u503c\u5c07\u6703\u662f<code>0</code>(zero-filled)       JavaScript<pre><code>const buf = Buffer.alloc(5);\n\nconsole.log(buf);\n// Prints: &lt;Buffer 00 00 00 00 00&gt;\n</code></pre></li> <li>\u82e5<code>size</code>\u53c3\u6578\u7684\u503c\u6bd4buffer.constants.MAX_LENGTH\u5c6c\u6027\u7684\u503c\u9084\u8981\u5927(larger)\u6216\u662f<code>size</code>\u53c3\u6578\u7684\u503c\u6bd4<code>0</code>\u9084\u8981\u5c0f(smaller)\u7684\u8a71,\u5c31\u6703\u62cb\u51fa(thrown)ERR_INVALID_ARG_VALUE\u9019\u500b\u932f\u8aa4(<code>error</code>)<ul> <li>\u88dc\u5145: <code>buffer.constants.MAX_LENGTH</code>\u5c6c\u6027\u7684\u503c\u6703\u8996\u4f5c\u696d\u7cfb\u7d71(operating system)\u7684\u4f4d\u5143\u67b6\u69cb(architectures)\u800c\u5b9a,\u4f8b\u5982: <code>32-bit</code>\u7684\u4f5c\u696d\u7cfb\u7d71\u5927\u7d04\u5c31\u662f1GB\u5de6\u53f3; \u800c<code>64-bit</code>\u7684\u4f5c\u696d\u7cfb\u7d71\u5927\u7d04\u5c31\u662f2GB\u5de6\u53f3</li> </ul> </li> <li>\u82e5<code>fill</code>\u53c3\u6578\u7684\u503c\u6709\u7d66\u5b9a(specified)\u7684\u8a71,\u5247\u9019\u500b\u65b0\u88ab\u5206\u914d(allocated)\u7684<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u5c31\u6703\u900f\u904e\u547c\u53eb(calling)buf.fill(fill)\u65b9\u6cd5(method)\u4f86\u521d\u59cb\u5316(initialized)       JavaScript<pre><code>const buf = Buffer.alloc(5, 'a');\n\nconsole.log(buf);\n// Prints: &lt;Buffer 61 61 61 61 61&gt;\n</code></pre></li> <li>\u82e5<code>fill</code>\u8207<code>encoding</code>\u53c3\u6578\u7684\u503c\u90fd\u6709\u7d66\u5b9a(specified)\u7684\u8a71,\u5247\u9019\u500b\u65b0\u88ab\u5206\u914d(allocated)\u7684<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u5c31\u6703\u900f\u904e\u547c\u53eb(calling)buf.fill(fill, encoding)\u65b9\u6cd5(method)\u4f86\u521d\u59cb\u5316(initialized)       JavaScript<pre><code>const buf = Buffer.alloc(11, 'aGVsbG8gd29ybGQ=', 'base64');\n\nconsole.log(buf);\n// Prints: &lt;Buffer 68 65 6c 6c 6f 20 77 6f 72 6c 64&gt;\n</code></pre></li> <li>\u96d6\u7136\u547c\u53ebBuffer.alloc()\u65b9\u6cd5\u53ef\u9810\u898b(measurably)\u5730\u6703\u6bd4\u5b83\u7684\u66ff\u4ee3\u65b9\u6cd5(alternative)(=&gt; \u4e5f\u5c31\u662fBuffer.allocUnsafe()\u65b9\u6cd5)\u4f86\u5f97\u6162(slower),\u4f46\u662f<code>Buffer.alloc()</code>\u65b9\u6cd5\u80fd\u78ba\u4fdd(ensures)\u5176\u6240\u65b0(newly)\u5efa\u7acb(created)\u51fa\u4f86\u7684<code>Buffer</code>(\u7de9\u5b58)\u5be6\u4f8b(instance)\u7684\u5167\u5bb9(contents)\u5c07\u6c38\u9060\u4e0d\u6703(never)\u5305\u542b(contain)\u4e4b\u524d\u5206\u914d\u904e(previous allocations)\u7684\u654f\u611f\u6027\u8cc7\u6599(sensitive data),\u800c\u9019\u4e5f\u5305\u62ec(including)\u4e86\u90a3\u4e9b\u5c1a\u672a\u88ab\u5206\u914d(not have been allocated)\u7d66<code>Buffers</code>\u5be6\u4f8b(instance)\u7684\u8cc7\u6599(data)</li> <li>Buffer.allocUnsafe(size)</li> <li>args<ul> <li>size: (integer)</li> <li>\u6e34\u671b(desired)\u65b0(new)\u7684<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u9577\u5ea6(length)\u662f\u591a\u5c11</li> </ul> </li> <li>\u6703\u5206\u914d(allocates)\u4e00\u500b\u7b26\u5408<code>size</code>\u53c3\u6578\u503c\u6307\u5b9a\u5927\u5c0f\u7684\u65b0(new)\u7684<code>Buffers</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u3002\u5982\u679c<code>fill</code>\u53c3\u6578\u7684\u503c\u662f<code>undefined</code>\u7684\u8a71,\u5247<code>Buffer</code>\u7269\u4ef6\u7684\u503c\u5c07\u6703\u662f<code>0</code>(zero-filled)</li> <li>\u900f\u904e<code>Buffer.allocUnsafe()</code>\u65b9\u6cd5(method)\u6240\u5efa\u7acb(created)\u7684<code>Buffers</code>(\u7de9\u5b58)\u5be6\u4f8b(instance)\u7684\u57fa\u672c\u8a18\u61b6\u9ad4(underlying memory)\u5c07\u4e0d\u6703\u88ab\u521d\u59cb\u5316(initialized)\u3002\u800c\u9019\u500b\u65b0\u5efa\u7acb\u51fa\u4f86\u7684<code>Buffer</code>\u5be6\u4f8b\u7684\u5167\u5bb9(contents)\u5c07\u6703\u662f\u672a\u77e5(unknown)\u7684,\u4e26\u4e14\u53ef\u80fd(may)\u6703\u5305\u542b(contain)\u654f\u611f\u6027\u8cc7\u6599(sensitive data)<ul> <li>\u53ef\u4f7f\u7528<code>Buffer.alloc()</code>\u65b9\u6cd5\u4f86\u5efa\u7acb\u4e00\u500b\u521d\u59cb\u5316(initialize)\u7684<code>Buffer</code>\u5be6\u4f8b(instance),\u4e26\u9810\u5148\u586b\u9032\u503c\u70ba<code>0</code>(zeros)   JavaScript<pre><code>const buf = Buffer.allocUnsafe(10);\n\nconsole.log(buf);\n// Prints (contents may vary): &lt;Buffer a0 8b 28 3f 01 00 00 00 50 32&gt;\n\nbuf.fill(0);\n\nconsole.log(buf);\n// Prints: &lt;Buffer 00 00 00 00 00 00 00 00 00 00&gt;\n</code></pre></li> <li>\u5982\u679c<code>Buffer.allocUnsafe()</code>\u65b9\u6cd5(method)\u4e2d\u7684<code>size</code>\u53c3\u6578\u7684\u503c,\u82e5\u4e0d\u662f\u6578\u5b57(number)\u7684\u8a71\u5c31\u6703\u62cb\u51fa(thrown)<code>TypeError</code>\u932f\u8aa4(error)</li> </ul> </li> <li><code>Buffer</code>(\u7de9\u5b58)\u6a21\u7d44(module)\u6703\u5728Buffer.poolsize())\u4e4b\u4e2d\u7684\u4e00\u500b\u5167\u90e8(internal)<code>Buffer</code>\u5be6\u4f8b(instance)\u88e1\u9762,\u9810\u5148\u5206\u914d(pre-allocates)\u597d\u4e00\u500b\u6307\u5b9a\u5927\u5c0f(<code>size</code>)\u7684\u5340\u584a\u3002\u800c<code>Buffer.poolsize()</code>\u985e\u5225(class)\u662f\u7528\u4f86(used as)\u63d0\u4f9bBuffer.allocUnsafe()\u65b9\u6cd5\b\u3001Buffer.from(array)\u65b9\u6cd5\u3001Buffer.concat()\u65b9\u6cd5,\u4ee5\u53ca\u53ea\u6709(only)\u7576<code>size</code>\u9019\u500b\u53c3\u6578\u7684\u503c\u5c0f\u65bc(less than) or \u7b49\u65bc(equal to) <code>Buffer.poolSize &gt;&gt; 1</code>(=&gt; \u4e5f\u5c31\u662fBuffer.poolSize()\u9664\u4ee5(divided)2\u5f8c\u7684\u6700\u5927\u6574\u6578\u503c(floor))\u7684\u6642\u5019,\u624d\u6703\u7528\u5230\u7684\u5df2\u7d93\u88ab\u68c4\u7f6e\u7684<code>new Buffer(size)</code>\u5efa\u69cb\u5b50(constructor)\u4f86\u5728\u5171\u7528\u6c60(pool)\u4e4b\u4e2d\u5feb\u901f\u5206\u914d(fast allocation)\u8a18\u61b6\u9ad4\u4f4d\u7f6e\u7d66\u65b0(new)\u7684<code>Buffer</code>(\u7de9\u5b58)\u5be6\u4f8b(instance)</li> <li>\u5229\u7528\u6b64\u9810\u5206\u914d(pre-allocated)\u597d\u7684\u5167\u90e8\u5171\u7528\u6c60\u4e2d\u7684\u8a18\u61b6\u9ad4(internal memory pool)\u662f\u5728\u547c\u53eb(calling)<code>Buffer.alloc(size, fill)</code>\u65b9\u6cd5\u3001<code>Buffer.allocUnsafe(size).fill(fill)</code>\u65b9\u6cd5\u4e4b\u9593\u7684\u4e00\u500b\u95dc\u9375\u7684\u5340\u5225<ul> <li>\u7279\u5225\u7684\u662f(Specifically),<code>Buffer.alloc(size, fill)</code>\u65b9\u6cd5(method)\u6c38\u9060\u4e0d\u6703(never)\u7528\u5230(use)\u5167\u90e8(internal)<code>Buffer</code>(\u7de9\u5b58)\u5171\u7528\u6c60(pool)\u4e2d\u7684\u8a18\u61b6\u9ad4; \u800c<code>Buffer.allocUnsafe(size).fill(fill)</code>\u65b9\u6cd5\u5247\u6703\u5728<code>size</code>\u53c3\u6578\u7684\u503c\u5c0f\u65bc or \u7b49\u65bc <code>Buffer.poolSize</code>\u7684\u4e00\u534a(half)\u6642,\u5c31\u6703\u7528\u5230\u5167\u90e8<code>Buffer</code>(\u7de9\u5b58)\u5171\u7528\u6c60(pool)\u4e2d\u7684\u8a18\u61b6\u9ad4\u3002\u96d6\u7136\u9019\u500b\u5dee\u7570\u662f\u975e\u5e38\u7d30\u5fae(subtle)\u7684,\u4f46\u5176\u5be6\u5f88\u91cd\u8981(important)\u7684,\u5c24\u5176\u662f\u7576\u6211\u5011\u7684\u61c9\u7528\u7a0b\u5f0f(application)\u8981\u6c42(requires)\u984d\u5916(additional)\u7684\u6548\u80fd(performance)\u6642,\u9019\u6642\u5019\u5c31\u6b63\u662f<code>Buffer.allocUnsafe()</code>\u65b9\u6cd5(method)\u6240\u80fd\u63d0\u4f9b(provides)\u7684\u4e86</li> </ul> </li> <li>Buffer.concat(list[, totalLength])</li> <li>args<ul> <li>list: (Buffer) | (Unit8Array)</li> <li>totalLength: (integer)</li> <li>\u4e32\u9023\u5728<code>list</code>\u53c3\u6578\u503c\u4e2d\u7684\u6240\u6709<code>Buffer</code>(\u7de9\u5b58)\u5be6\u4f8b(instance)\u5f8c\u7684\u7e3d\u9577\u5ea6</li> <li>Returns: (Buffer)</li> </ul> </li> <li>\u6b64\u65b9\u6cd5\u6703\u56de\u50b3\u5df2\u4e32\u9023<code>list</code>\u53c3\u6578\u503c\u4e2d\u7684\u6240\u6709<code>Buffer</code>(\u7de9\u5b58)\u5be6\u4f8b(instance)\u904e\u5f8c\u7684\u7684\u4e00\u500b\u65b0\u7684<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6<ul> <li>\u5982\u679c<code>list</code>\u53c3\u6578\u503c\u4e2d,\u6c92\u6709\u4efb\u4f55\u6771\u897f(item); \u6216\u662f<code>totalLength</code>\u53c3\u6578\u503c\u70ba<code>0</code>\u7684\u8a71,\u9019\u5169\u7a2e\u60c5\u6cc1\u90fd\u6703\u56de\u50b3(returned)\u4e00\u500b\u65b0(new)\u7684\u96f6\u9577\u5ea6(zero-length)\u7684<code>Buffer</code>\u7269\u4ef6</li> <li>\u82e5\u6c92\u6709\u63d0\u4f9b(provided)<code>totalLength</code>\u9019\u500b\u53c3\u6578\u503c\u7684\u8a71,\u5c31\u6703\u900f\u904e<code>list</code>\u4e2d\u7684<code>Buffer</code>(\u7de9\u5b58)\u5be6\u4f8b\u5011(instances)\u4f86\u8a08\u7b97(calculated)\u5b83\u5011\u7684\u52a0\u7e3d(adding)\u5f8c\u7684\u7e3d\u9577\u5ea6(their lengths)</li> <li>\u82e5\u6709\u63d0\u4f9b<code>totalLength</code>\u9019\u500b\u53c3\u6578\u503c\u7684\u8a71,\u5c31\u6703\u5f37\u8feb(coerced)\u8b8a\u6210\u4e00\u500b\u672a\u6307\u6d3e(unsigned)\u7684\u6574\u6578(integer)\u3002\u5982\u679c\u5c07<code>list</code>\u5167\u7684\u6240\u6709Buffer<code>(\u7de9\u5b58)</code>\u5be6\u4f8b\u5011(instances)\u5408\u4f75(combined)\u5f8c\u5df2\u8d85\u904e(exceeds)<code>totalLength</code>\u53c3\u6578\u503c\u7684\u8a71,\u90a3<code>Buffer.concat()</code>\u65b9\u6cd5(method)\u6240\u56de\u50b3\u7684<code>Buffer</code>\u5be6\u4f8b\u5c31\u6703\u88ab\u622a\u65b7(truncated)\u5230\u7b26\u5408<code>totalLength</code>\u53c3\u6578\u503c\u6240\u898f\u7bc4\u7684\u9577\u5ea6\u9650\u5236 JavaScript<pre><code>// Create a single `Buffer` from a list of three `Buffer` instances.\n\nconst buf1 = Buffer.alloc(10);\nconst buf2 = Buffer.alloc(14);\nconst buf3 = Buffer.alloc(18);\nconst totalLength = buf1.length + buf2.length + buf3.length;\n\nconsole.log(totalLength);\n// Prints: 42\n\nconst bufA = Buffer.concat([buf1, buf2, buf3], totalLength);\n\nconsole.log(bufA);\n// Prints: &lt;Buffer 00 00 00 00 ...&gt;\nconsole.log(bufA.length);\n// Prints: 42\n</code></pre></li> </ul> </li> <li><code>Buffer.concat()</code>\u65b9\u6cd5(method)\u4e5f\u53ef\u4ee5\u50cfBuffer.allocUnsafe()\u65b9\u6cd5\u4e00\u6a23\u80fd\u4f7f\u7528(use)\u5167\u90e8(internal)<code>Buffer</code>(\u7de9\u5b58)\u5171\u7528\u6c60(pool)</li> <li>Buffer.from(array)</li> <li>args<ul> <li>array: (integer[])</li> </ul> </li> <li>\u6b64\u65b9\u6cd5\u6703\u5229\u7528<code>array</code>\u53c3\u6578\u503c\u7684\u4f4d\u5143\u7d44(bytes)(=&gt; \u5fc5\u9808\u5728<code>0</code>~<code>255</code>\u7684\u7bc4\u570d\u5167)\u4f86\u5206\u914d(allocates)\u4e00\u500b\u65b0(new)\u7684<code>Buffer</code>(\u7de9\u5b58)\u5be6\u4f8b       JavaScript<pre><code>// Creates a new Buffer containing the UTF-8 bytes of the string 'buffer'.\nconst buf = Buffer.from([0x62, 0x75, 0x66, 0x66, 0x65, 0x72]);\n</code></pre></li> <li>\u82e5<code>array</code>\u53c3\u6578\u7684\u503c\u4e0d\u662f\u4e00\u500bJavascript\u7684<code>Array</code>\u578b\u5225 or \u53e6\u4e00\u500b(another)\u9069\u7528(appropriate)\u65bc<code>Buffer.from()</code>\u65b9\u6cd5\u7684\u8b8a\u5f62(variants)\u7684\u578b\u5225(type)\u7684\u8a71,\u5c31\u6703\u62cb\u51fa(thrown)\u4e00\u500b<code>TypeError</code>\u932f\u8aa4(error)</li> <li><code>Buffer.from(array)</code>\u65b9\u6cd5(method)\u8207Buffer.from(string)\u65b9\u6cd5(method)\u4e5f\u53ef\u4ee5\u50cfBuffer.allocUnsafe()\u65b9\u6cd5\u4e00\u6a23\u80fd\u4f7f\u7528(use)\u5167\u90e8(internal)<code>Buffer</code>(\u7de9\u5b58)\u5171\u7528\u6c60(pool)</li> <li>Buffer.from(buffer)</li> <li>args<ul> <li>buffer: (Buffer) | (Unit8Array)</li> <li>\u6307\u5b9a\u8981\u5f9e\u5df2\u7d93\u5b58\u5728(existing)\u7684\u54ea\u500b<code>Buffer</code>\u7269\u4ef6 or <code>Unit8Array</code>\u985e\u5225\u4f86\u8907\u88fd\u8cc7\u6599(copy data)</li> </ul> </li> <li>\u6b64\u65b9\u6cd5(method)\u6703\u5c07\u50b3\u905e(passed)\u7d66\u9019\u500b\u65b9\u6cd5\u7684<code>buffer</code>\u53c3\u6578\u8907\u88fd(copies)\u4e00\u4efd\u8cc7\u6599(data)\u7d66\u65b0(new)\u7684<code>Buffer</code>(\u7de9\u5b58)\u5be6\u4f8b(instance)       JavaScript<pre><code>const buf1 = Buffer.from('buffer');\nconst buf2 = Buffer.from(buf1);\n\nbuf1[0] = 0x61;\n\nconsole.log(buf1.toString());\n// Prints: auffer\nconsole.log(buf2.toString());\n// Prints: buffer\n</code></pre></li> <li>\u82e5<code>Buffer.from(buffer)</code>\u65b9\u6cd5(method)\u7684<code>buffer</code>\u53c3\u6578\u7684\u503c\u4e0d\u662f\u4e00\u500bJavascript\u7684<code>Buffer</code>\u7269\u4ef6 or \u53e6\u4e00\u500b(another)\u9069\u7528(appropriate)\u65bc<code>Buffer.from()</code>\u65b9\u6cd5\u7684\u8b8a\u5f62(variants)\u7684\u578b\u5225(type)\u7684\u8a71,\u5c31\u6703\u62cb\u51fa(thrown)\u4e00\u500b<code>TypeError</code>\u932f\u8aa4(error)</li> <li>Buffer.from(string[, encoding])</li> <li>args<ul> <li>string: (string)</li> <li>\u8981\u7de8\u78bc\u70ba<code>Buffer</code>\u7269\u4ef6\u7684\u5b57\u4e32(string)</li> <li>encoding: (string)</li> <li>\u53ef\u6307\u5b9a\u8981\u4f7f\u7528\u54ea\u7a2e\u7de8\u78bc\u683c\u5f0f(encoding)\u4f86\u7de8\u78bc\u5b57\u4e32(string)</li> <li>\u9810\u8a2d\u503c: <code>utf8</code></li> </ul> </li> <li>\u6b64\u65b9\u6cd5\u6703\u5efa\u7acb\u4e00\u500b\u65b0\u7684<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6,\u4e26\u4e14\u9019\u500b<code>Buffer</code>\u7269\u4ef6\u7684\u5167\u5bb9\u6703\u5305\u62ec(containing)\u5b57\u4e32(<code>string</code>)\u53c3\u6578\u7684\u503c<ul> <li>\u800c\u6b64\u65b9\u6cd5(method)\u7684<code>encoding</code>\u53c3\u6578\u662f\u7528\u4f86\u78ba\u8a8d(identifies)\u6211\u5011\u5c07\u8981\u4f7f\u7528(used)\u54ea\u7a2e\u7de8\u78bc\u683c\u5f0f(character encoding)\u4f86\u5c07\u5b57\u4e32(string)\u8f49\u63db(converting)\u70ba\u4f4d\u5143\u7d44(<code>bytes</code>)   JavaScript<pre><code>const buf1 = Buffer.from('this is a t\u00e9st');\nconst buf2 = Buffer.from('7468697320697320612074c3a97374', 'hex');\n\nconsole.log(buf1.toString());\n// Prints: this is a t\u00e9st\nconsole.log(buf2.toString());\n// Prints: this is a t\u00e9st\nconsole.log(buf1.toString('latin1'));\n// Prints: this is a t\u00c3\u00a9st\n</code></pre></li> </ul> </li> <li>\u82e5<code>Buffer.from(string)</code>\u65b9\u6cd5(method)\u7684<code>string</code>\u53c3\u6578\u7684\u503c\u4e0d\u662f\u5c6c\u65bcJavascript\u7684<code>string</code>\u578b\u5225 or \u53e6\u4e00\u500b(another)\u9069\u7528(appropriate)\u65bc<code>Buffer.from()</code>\u65b9\u6cd5\u7684\u8b8a\u5f62(variants)\u7684\u578b\u5225(type)\u7684\u8a71,\u5c31\u6703\u62cb\u51fa(thrown)\u4e00\u500b<code>TypeError</code>\u932f\u8aa4(error)</li> </ul> </li> <li> <p>method</p> <ul> <li>buf.toJSON()</li> <li>Returns: (object)</li> <li>\u6b64\u65b9\u6cd5(method)\u6703\u56de\u50b3(returns)\u4e00\u500b<code>JSON</code>\u7269\u4ef6\u4f86\u4ee3\u8868(representation)\u7576\u8981\u5c07<code>Buffer</code>(\u7de9\u5b58)\u5be6\u4f8b(instance)\u8f49\u63db\u70ba\u5b57\u4e32(stringifying)\u6642,JSON.stringify()\u65b9\u6cd5\u6709\u4e0d\u660e\u78ba\u5730(implicitly)\u547c\u53eb<code>buf.JSON()</code>\u65b9\u6cd5</li> <li><code>Buffer.from()</code>\u65b9\u6cd5(method)\u80fd\u63a5\u53d7(accepts)\u5f9e<code>buf.JSON()</code>\u65b9\u6cd5\u6240\u56de\u50b3(returned)\u51fa\u4f86\u7684<code>JSON</code>\u7269\u4ef6(objects)\u7684\u683c\u5f0f(format)</li> <li>\u5c24\u5176\u662f(In particular),<code>buf.toJSON()</code>\u65b9\u6cd5(method)\u57f7\u884c\u8d77\u4f86\u5c31\u6703\u50cf(works like)\u662f<code>Buffer.from(buf)</code>\u65b9\u6cd5\u4e00\u6a23     JavaScript<pre><code>const buf = Buffer.from([0x1, 0x2, 0x3, 0x4, 0x5]);\nconst json = JSON.stringify(buf);\n\nconsole.log(json);\n// Prints: {\"type\":\"Buffer\",\"data\":[1,2,3,4,5]}\n\nconst copy = JSON.parse(json, (key, value) =&gt; {\n  return value &amp;&amp; value.type === 'Buffer' ?\n    Buffer.from(value) :\n    value;\n});\n\nconsole.log(copy);\n// Prints: &lt;Buffer 01 02 03 04 05&gt;\n</code></pre></li> <li>buf.toString([encoding[, start[, end]]])</li> <li>args<ul> <li>encoding: (string)</li> <li>\u53ef\u6307\u5b9a\u8981\u4f7f\u7528\u54ea\u7a2e\u7de8\u78bc\u683c\u5f0f(encoding)\u4f86\u7de8\u78bc\u5b57\u4e32(string)</li> <li>\u9810\u8a2d\u503c: <code>utf8</code></li> <li>start: (integer)</li> <li>\u53ef\u6307\u5b9a\u8981\u5f9e\u504f\u79fb(offset)\u591a\u5c11\u4f4d\u5143\u7d44(byte)\u5f8c\u624d\u958b\u59cb(start)\u89e3\u78bc(decoding)</li> <li>\u9810\u8a2d\u503c: <code>0</code></li> <li>end: (integer)</li> <li>\u53ef\u6307\u5b9a\u8981\u5f9e\u504f\u79fb(offset)\u591a\u5c11\u4f4d\u5143\u7d44(byte)\u5f8c\u624d\u505c\u6b62(stop)\u89e3\u78bc(decoding)(=&gt; \u4e5f\u5c31\u662f\u4e0d\u8981\u5305\u542b\u7684(not inclusive))</li> <li>\u9810\u8a2d\u503c: buf.length</li> </ul> </li> <li>\u6b64\u65b9\u6cd5(method)\u6703\u6839\u64da(according)\u6307\u5b9a(specified)\u7684\u7de8\u78bc\u65b9\u5f0f(character encoding)\u4f86\u89e3\u78bc(decodes)<code>buf</code>\u7269\u4ef6(\u4e5f\u5c31\u662f=&gt; <code>encoding</code>\u7684\u53c3\u6578\u503c)<ul> <li>\u800c<code>start</code>\u8207<code>end</code>\u53c3\u6578\u53ef\u4ee5\u50c5\u5728\u9700\u8981\u89e3\u78bc(decode only)<code>buf</code>\u7269\u4ef6\u7684\u5b50\u96c6(subset)\u6642\u624d\u50b3\u905e(passed)\u5230<code>buf.toString()</code>\u65b9\u6cd5(method)\u88e1\u9762,\u4f5c\u70ba\u53c3\u6578</li> <li>\u82e5<code>encoding</code>\u53c3\u6578\u7684\u503c\u662f<code>utf8</code>,\u4e26\u4e14\u8f38\u5165(input)\u7684\u4f4d\u5143\u7d44\u5e8f\u5217(a byte sequence)\u4e0d\u662f\u6709\u6548\u7684(not valid)<code>UTF-8</code>\u683c\u5f0f\u7684\u8a71,\u90a3\u9ebc(then)\u9019\u4e9b\u6bcf\u4e00\u500b(each)\u7121\u6548(invalid)\u7684\u4f4d\u5143\u7d44(byte)\u5c31\u6703\u88ab<code>U+FFFD</code>\u9019\u500b\u66ff\u4ee3\u5b57\u5143(replacement character)\u4f86\u53d6\u4ee3(replaced)</li> </ul> </li> <li>\u5b57\u4e32\u5be6\u4f8b(string instance)(=&gt; \u5fc5\u9808\u662f\u4ee5<code>UTF-16</code>\u4ee3\u78bc(code)\u70ba\u55ae\u4f4d(unit))\u7684\u6700\u5927\u9577\u5ea6(maximum length)\u5fc5\u9808\u662f\u7b26\u5408buffer.constants.MAX_STRING_LENGTH\u5c6c\u6027\u503c\u7684\u9650\u5236     JavaScript<pre><code>const buf1 = Buffer.allocUnsafe(26);\n\nfor (let i = 0; i &lt; 26; i++) {\n  // 97 is the decimal ASCII value for 'a'.\n  buf1[i] = i + 97;\n}\n\nconsole.log(buf1.toString('utf8'));\n// Prints: abcdefghijklmnopqrstuvwxyz\nconsole.log(buf1.toString('utf8', 0, 5));\n// Prints: abcde\n\nconst buf2 = Buffer.from('t\u00e9st');\n\nconsole.log(buf2.toString('hex'));\n// Prints: 74c3a97374\nconsole.log(buf2.toString('utf8', 0, 3));\n// Prints: t\u00e9\nconsole.log(buf2.toString(undefined, 0, 3));\n// Prints: t\u00e9\n</code></pre></li> <li>buf.write(string[, offset[, length]][, encoding])</li> <li>args<ul> <li>string: (string)</li> <li>\u6307\u5b9a\u8981\u5beb\u5165(write)\u5230<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u88e1\u9762\u7684\u5b57\u4e32(<code>string</code>)</li> <li>offset: (integer)</li> <li>\u8981\u5148\u8df3\u904e(skip)\u591a\u5c11\u6578\u91cf\u7684\u4f4d\u5143\u7d44(number of bytes)\u5f8c\u624d\u958b\u59cb(starting)\u5c07\u6307\u5b9a\u7684\u5b57\u4e32(<code>string</code>)\u5beb\u5165(write)\u5230<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u4e2d</li> <li>length: (integer)</li> <li>\u53ef\u9650\u5236\u6700\u5927(maximum)\u80fd\u5beb\u5165(write)\u591a\u5c11\u6578\u91cf\u7684\u4f4d\u5143\u7d44(number of bytes)(\u4e26\u4e14\u9019\u500b\u6307\u5b9a\u5927\u5c0f\u7684\u6578\u503c\"\u4e0d\u80fd\"\u8d85\u904e(not exceed)<code>buf.length - offset</code>\u7684\u503c)</li> <li>\u9810\u8a2d\u503c: <code>buf.length - offset</code></li> <li>encoding: (string)</li> <li>\u53ef\u6307\u5b9a\u8981\u7528\u54ea\u7a2e\u5b57\u5143\u7de8\u78bc\u683c\u5f0f(character encoding)\u4f86\u5c07<code>string</code>\u7de8\u78bc(encoding)\u70ba<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object)</li> <li>Returns: (integer)</li> <li>\u6b64\u65b9\u6cd5(method)\u6703\u56de\u50b3\u6709\u591a\u5c11\u6578\u91cf\u7684\u4f4d\u5143\u7d44(number of bytes)\u5df2\u7d93\u88ab\u5beb\u5165(written)\u4e86</li> </ul> </li> <li>\u6b64\u65b9\u6cd5(method)\u6703\u5c07<code>string</code>(\u5b57\u4e32)\u5beb\u5165\u5230<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u4e2d\b,\u4e26\u6839\u64da(according to)<code>encoding</code>(\u5b57\u5143\u7de8\u78bc\u683c\u5f0f)\u4f86\u7de8\u78bc(encoding)<ul> <li>\u6b64\u65b9\u6cd5(method)\u7684<code>length</code>\u53c3\u6578(parameter)\u503c\u662f\u7528\u4f86\u4ee3\u8868\u8981\u5beb\u5165(write)\u7684<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u6703\u7528\u6389\u591a\u5c11\u6578\u91cf\u7684\u4f4d\u5143\u7d44(number of bytes)\u3002\u82e5<code>buf</code>\u7269\u4ef6(object)\u6c92\u6709\u5305\u542b(contain)\u8db3\u5920(enough)\u7684\u7a7a\u9593(space)\u80fd\u586b\u5165\u6574\u500b(entire)\u6307\u5b9a\u7684<code>string</code>(\u5b57\u4e32)\u7684\u8a71,\u90a3\u9ebc\u5c31\u53ea\u6703\u6709\u90e8\u5206(part)\u7684\u6307\u5b9a\u7684<code>string</code>(\u5b57\u4e32)\u6703\u88ab\u5beb\u5165(written)\u3002\u7136\u800c(However),\u9019\u6a23\u5c31\u4e0d\u6703\u5c07\u90a3\u4e9b\u90e8\u5206(partially)\u7684\u7de8\u78bc\u904e\u5f8c\u7684\u5b57\u5143(encoded characters)\u4e86\u5beb\u5165\u5230<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object)\u4e2d\u4e86   JavaScript<pre><code>const buf = Buffer.alloc(256);\n\nconst len = buf.write('\\u00bd + \\u00bc = \\u00be', 0);\n\nconsole.log(`${len} bytes: ${buf.toString('utf8', 0, len)}`);\n// Prints: 12 bytes: \u00bd + \u00bc = \u00be\n\nconst buffer = Buffer.alloc(10);\n\nconst length = buffer.write('abcd', 8);\n\nconsole.log(`${length} bytes: ${buffer.toString('utf8', 8, 10)}`);\n// Prints: 2 bytes : ab\n</code></pre></li> </ul> </li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#stream","title":"Stream","text":"<ul> <li><code>stream</code>(\u4e32\u6d41)\u662f\u5728Node\u4e2d\u7528\u4f86\u8655\u7406(working with)\u6578\u64da\u4e32\u6d41(streaming data)\u7684\u62bd\u8c61(abstract)\u4ecb\u9762(interface)</li> <li>Node\u5167\u5efa\u7684<code>stream</code>(\u4e32\u6d41)\u6a21\u7d44(module)\u5c31\u662f\u7528\u4f86\u63d0\u4f9bAPI\u4f86\u5be6\u4f5c(implementing)<code>stream</code></li> <li>Node\u6709\u63d0\u4f9b\u8a31\u591a\u7684<code>stream</code>(\u4e32\u6d41)\u7269\u4ef6(objects)\u3002\u8209\u4f8b\u4f86\u8aaa,\u4ee5\u4e0b2\u7a2e\u90fd\u7b97\u662f<code>stream</code>\u5be6\u4f8b(instances)</li> <li>\u5f80\u4f3a\u670d\u5668\u7aef\u767c\u9001\u7684\u8acb\u6c42(a request to an HTTP server)</li> <li>\u9023\u63a5(connected)\u5230\u6a19\u6e96\u8f38\u51fa(<code>stdout</code>)\u7684\u4e32\u6d41(process.stdout)</li> <li><code>stream</code>(\u4e32\u6d41)\u662f\u53ef\u8b80\u53d6\u7684(readable) &amp; \u53ef\u5beb\u5165\u7684(writable)</li> <li>\u6240\u6709\u7684<code>stream</code>(\u4e32\u6d41)\u90fd\u662fEventEmitter\u7684\u5be6\u4f8b(instances)</li> <li>\u5982\u679c\u60f3\u8981\u5b58\u53d6(access)<code>stream</code>(\u4e32\u6d41)\u6a21\u7d44(module)\u7684\u8a71,\u80fd\u900f\u904e\u4ee5\u4e0b\u7bc4\u4f8b\u7a0b\u5f0f\u78bc     JavaScript<pre><code>const stream = require('stream');\n</code></pre></li> <li><code>stream</code>(\u4e32\u6d41)\u6a21\u7d44(module)\u5c0d\u65bc\u60f3\u8981\u5efa\u7acb\u65b0\u7684\u4e32\u6d41\u5be6\u4f8b\u578b\u5225\u7684\u8a71\u662f\u975e\u5e38\u6709\u7528\u7684</li> <li>\u901a\u5e38\u4e0d\u9700\u8981(not necessary)\u5229\u7528(use)<code>stream</code>(\u4e32\u6d41)\u6a21\u7d44(module)\u4f86\u6d88\u5316(consume)<code>stream</code>(\u4e32\u6d41) <p>\u6b64\u6587\u4ef6\u7684\u7de8\u6392 (Organization of this document)</p> </li> <li>\u6b64\u6587\u4ef6(document)\u5305\u542b(contains)\u4e862\u500b\u4e3b\u8981(primary)\u7684\u90e8\u5206(sections)\u4ee5\u53ca\u7b2c3\u90e8\u5206\u70ba\u8a3b\u89e3(notes)<ul> <li>\u7b2c1\u500b\u90e8\u5206(section)\u662f\u5728\u8aaa\u660e(explains)\u8981\u5982\u4f55\u5728\u4e00\u500b\u61c9\u7528\u7a0b\u5f0f(application)\u4e2d(within)\u4f7f\u7528(use)\u5df2\u7d93\u5b58\u5728(existing)\u7684<code>streams</code>(\u4e32\u6d41)</li> <li>\u7b2c2\u90e8\u5206(section)\u662f\u5728\u8aaa\u660e(explains)\u8a72\u5982\u4f55\u5efa\u7acb(create)\u65b0\u985e\u578b(new types)\u7684<code>streams</code>(\u4e32\u6d41) <p><code>Streams</code>(\u4e32\u6d41)\u7684\u985e\u578b (Types of streams)</p> </li> </ul> </li> <li>\u5728Node\u4e2d,\u6703\u67094\u7a2e\u57fa\u790e\u7684<code>streams</code>(\u4e32\u6d41)\u7684\u985e\u578b(types)<ul> <li>Writable: \u53ef\u4ee5\u5411\u5176\u5beb\u5165(written)\u6578\u64da(data)\u7684<code>streams</code>(\u4e32\u6d41)</li> <li>\u4f8b: fs.createWriteStream()</li> <li>Readable: \u53ef\u4ee5\u5f9e\u5176\u4e4b\u4e2d\u8b80\u53d6(read)\u6578\u64da(data)\u7684<code>streams</code>(\u4e32\u6d41)</li> <li>\u4f8b: fs.createReadStream()</li> <li>Duplex: \u540c\u6642\u53ef\u4ee5\u5beb\u5165(Writable) &amp; \u8b80\u53d6(Readable)\u7684<code>streams</code>(\u4e32\u6d41)</li> <li>\u4f8b: net.Socket</li> <li>Transaform: \u5c31\u662f\u4e00\u7a2e\u80fd\u5728\u5beb\u5165(written) or \u8b80\u53d6(read)\u6642,\u53ef\u4ee5\u4fee\u6539(modify)\u6216\u662f\u8f49\u63db(transform)\u7684<code>streams</code>(\u4e32\u6d41)</li> <li>\u4f8b: zlib.createDeflate()</li> </ul> </li> <li>\u6b64\u5916(Additionally),<code>stream</code>(\u4e32\u6d41)\u6a21\u7d44(module)\u5305\u62ec(includes)\u4e86\u4e00\u4e9b\u5be6\u7528(utility)\u7684\u529f\u80fd(functions),\u50cf\u662f\u4ee5\u4e0b\u9019\u5e7e\u7a2e<ul> <li>stream.pipeline()</li> <li>stream.finished()</li> <li>stream.Readable.from()</li> <li>stream.addAbortSignal()</li> </ul> </li> <li> <p><code>Stream</code>(\u4e32\u6d41)\u7684<code>Promise</code>API (Streams Promises API)</p> <ul> <li><code>stream</code>/<code>promise</code>API\u6703\u63d0\u4f9b(provides)\u4e00\u500b\u80fd\u56de\u50b3(return)<code>Promise</code>\u7269\u4ef6(objects)\u800c\u4e0d\u662f(rather than)\u4f7f\u7528\u56de\u547c\u51fd\u5f0f(callbacks)\u7684\u4e00\u7d44(set)\u975e\u540c\u6b65(asynchronous)\u5be6\u7528\u529f\u80fd(utility functions)\u7684<code>stream</code>(\u4e32\u6d41)</li> <li>\u9019\u7d44<code>Promsie</code>API\u80fd\u900f\u904e(via)\u4ee5\u4e0b2\u7a2e\u65b9\u5f0f\u4f86\u4f7f\u7528(accessible)   JavaScript<pre><code>require('stream/promises')\n</code></pre> JavaScript<pre><code>require('stream').promises.\n</code></pre></li> </ul> </li> <li> <p>\u7269\u4ef6\u6a21\u5f0f (Object mode)</p> <ul> <li>\u6240\u6709\u900f\u904eNode\u7684APIs\u64cd\u4f5c(operate)\u4e0b,\u6240\u5efa\u7acb(created)\u7684<code>streams</code>(\u4e32\u6d41)\u90fd\u50c5(exclusively)\u662f\u5b57\u4e32(strings)\u3001<code>Buffer</code>(\u7de9\u5b58)\u3001\u6216\u662f<code>Unit8Array</code>\u7269\u4ef6(objects)</li> <li>\u7136\u800c(however),\u8981\u5229\u7528\u5176\u5b83Javascript\u7684\u503c(values)\u4f86\u5be6\u73fe(implementations)<code>stream</code>(\u4e32\u6d41)\u662f\u6709\u53ef\u80fd(possible)\u7684(=&gt; \u4f46\u662f\u4e0d\u5305\u542b<code>null</code>,\u56e0\u70ba<code>null</code>\u5728<code>streams</code>(\u4e32\u6d41)\u4e2d\u662f\u6709\u5176\u5b83\u7279\u6b8a\u7528\u9014(special purpose)\u7684),\u800c\u4ee5\u4e0a\u9019\u7a2e\u60c5\u6cc1\u7684<code>stream</code>(\u4e32\u6d41)\u5c31\u6703\u88ab\u8996\u70ba(considered to)\u4ee5\"\u7269\u4ef6\u6a21\u5f0f(object mode)\"\u4f86\u64cd\u4f5c(operate)</li> </ul> </li> <li> <p>\u7de9\u5b58 (Buffering)</p> <ul> <li>Writable\u8207Readable<code>streams</code>(\u4e32\u6d41)\u90fd\u53ef\u4ee5\u5c07\u8cc7\u6599\u5132\u5b58(store data)\u5728\u5167\u90e8(internal)<code>buffer</code>(\u7de9\u5b58)\u4e2d</li> <li>\u53ef\u80fd(potentially)\u7de9\u5b58(buffered)\u7684\u8cc7\u6599\u91cf(data)\u662f\u53d6\u6c7a\u65bc(depends on)\u50b3\u5165(passed into)\u5230<code>stream</code>(\u4e32\u6d41)\u5efa\u69cb\u5b50(constructor)\u4e2d\u7684\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>)\u7684\u9078\u9805(option)</li> <li>\u5c0d\u65bc\u6b63\u5e38(normal)\u7684<code>streams</code>(\u4e32\u6d41)\u800c\u8a00,\u6240\u8b02\u7684\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>)\u7684\u9078\u9805(option)\u5c31\u662f\u6307\u53ef\u4ee5\u6307\u5b9a(specifies)\u4f4d\u5143\u7d44\u7684\u7e3d\u6578\u91cf(total number of bytes)</li> <li>\u5c0d\u65bc\u5728\u7269\u4ef6\u6a21\u5f0f(object mode)\u64cd\u4f5c(operating)\u7684<code>streams</code>(\u4e32\u6d41)\u800c\u8a00,\u6240\u8b02\u7684\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>)\u7684\u9078\u9805(option)\u5c31\u662f\u6307\u53ef\u4ee5\u6307\u5b9a(specifies)\u7269\u4ef6\u7684\u7e3d\u6578\u91cf(<code>total number of objects</code>)</li> <li>\u7576\u900f\u904e\u547c\u53eb(calls)stream.push(chunk)\u65b9\u6cd5\u4f86\u5be6\u73fe(implementation)\u7de9\u5b58\u6642,\u8cc7\u6599(data)\u6703\u88ab\u7de9\u5b58(buffered in)\u5230\u53ef\u8b80\u53d6\u4e32\u6d41\u4e2d(<code>Readable streams</code>)</li> <li>\u9019\u6642,\u5982\u679c\u6b64<code>streams</code>(\u4e32\u6d41)\u7684\u6d88\u8cbb\u8005(consumer) \u6c92\u6709\u547c\u53eb (call)stream.read()\u65b9\u6cd5\u7684\u8a71,\u90a3\u9ebc\u8a72\u8cc7\u6599(data)\u5c31\u6703\u4ee3\u7406(sit in)\u5167\u90e8\u968a\u5217(internal queue)\u76f4\u5230(until)\u8a72\u8cc7\u6599\u88ab\u6d88\u5316\u6389(consumed)\u70ba\u6b62</li> <li>\u4e00\u65e6(Once)\u5167\u90e8\u53ef\u8b80\u53d6\u7de9\u5b58(internal read <code>buffer</code>)\u7684\u7e3d\u5927\u5c0f(total size) \u5230\u9054 (reaches)\u4e86\u6307\u5b9a(specified)\u7684\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>)\u9580\u6abb(threshold)\u6642,\u9019\u6642\u8a72<code>stream</code>(\u4e32\u6d41)\u5c31\u6703\u5c31\u6703\u505c\u6b62(stop)\u5f9e\u57fa\u790e\u8cc7\u6e90(underlying resource)\u4e2d\u8b80\u53d6(reading)\u8cc7\u6599(data),\u76f4\u5230\u7576\u524d(currently)\u7684\u7de9\u5b58\u8cc7\u6599(the data currently buffered)\u80fd\u88ab\u6d88\u5316(consumed)\u6642\u624d\u6703\u7e7c\u7e8c\u8b80\u53d6</li> <li>\u4e5f\u5c31\u662f\u8aaa,\u8a72<code>stream</code>(\u4e32\u6d41)\u6703\u505c\u6b62\u547c\u53eb\u5167\u90e8\u7684readable._read()\u65b9\u6cd5(method),\u800c\u9019\u500b\u65b9\u6cd5\u5c31\u662f\u88ab\u7528\u4f86(used to)\u586b\u6eff(fill)\u53ef\u8b80\u53d6\u4e32\u6d41(read buffer)</li> <li>\u7576writable.write(chunk)\u65b9\u6cd5(method)\u88ab\u91cd\u8907\u5730\u547c\u53eb(called repeatedly)\u6642,\u8cc7\u6599(data)\u5c31\u6703\u88ab\u7de9\u5b58(buffered in)\u5230\u53ef\u5beb\u5165\u4e32\u6d41(<code>Writable streams</code>)\u4e2d\u3002\u7576(while)\u5167\u90e8\u53ef\u5beb\u5165\u7de9\u5b58(internal write buffer)\u7684\u7e3d\u5927\u5c0f(total size) \u4f4e\u65bc (below)\u8a2d\u5b9a(set)\u597d\u7684\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>)\u9580\u6abb(threshold)\u6642,\u9019\u6642\u547c\u53eb(calls)<code>writable.write()</code>\u65b9\u6cd5(method)\u5c31\u6703\u56de\u50b3(return)<code>true</code>\u3002\u800c\u4e00\u65e6(Once)\u5167\u90e8\u53ef\u5beb\u5165\u7de9\u5b58(internal write buffer)\u7684\u7e3d\u5927\u5c0f(total size) \u5230\u9054 (reaches) or \u8d85\u904e (exceeds)\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>)\u9580\u6abb(threshold)\u6642,\u5247\u6703\u56de\u50b3(returned)<code>false</code></li> <li><code>Stream API</code>\u7684\u5176\u4e2d\u4e00\u500b\u95dc\u9375\u76ee\u6a19(key goal),\u5c24\u5176(particularly)\u662fstream.pipe()\u65b9\u6cd5(method),\u5c31\u662f\u9650\u5236(limit)\u8cc7\u6599(data)\u7684\u7de9\u5b58(buffering)\u5728\u4e00\u500b\u53ef\u63a5\u53d7(acceptable)\u7684\u7a0b\u5ea6(levels)\u4e4b\u5167,\u4ee5\u4f7f\u8cc7\u6e90(resources) &amp; \u4e0d\u540c\u901f\u5ea6\u7684\u76ee\u6a19(destinations of differing speeds)\u80fd\u5920\u4e0d\u6703\u6df9\u6c92(overwhelm)\u6389\u53ef\u7528(available)\u7684\u8a18\u61b6\u9ad4\u7a7a\u9593(memory)</li> <li>\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>)\u9078\u9805(option)\u662f\u4e00\u500b\u9580\u6abb(threshold),\u800c\u4e0d\u662f\u4e00\u7a2e\u9650\u5236(limit)\u3002\u5b83\u4ee3\u8868\u5728\u8acb\u6c42(asking)\u66f4\u591a\u7684\u8cc7\u6599\u4e4b\u524d,\u8a72\u7de9\u5b58\u4e32\u6d41(<code>stream buffers</code>)\u6240\u64c1\u6709\u7684\u8cc7\u6599\u91cf(the amount of data)</li> <li>\u901a\u5e38(in general),\u5b83\u4e26\u4e0d\u6703\u5f37\u5236\u57f7\u884c(enforce)\u56b4\u683c(strict)\u7684\u8a18\u61b6\u9ad4(memory)\u9650\u5236(limitation)\u3002\u6211\u5011\u53ef\u4ee5\u5728\u7279\u5b9a(specific)\u7684<code>stream</code>(\u4e32\u6d41)\u5be6\u4f5c(implementations)\u4e2d\u9078\u64c7(choose to)\u5be6\u65bd(enforce)\u66f4\u56b4\u683c(stricter)\u7684\u8a18\u61b6\u9ad4\u9650\u5236(limits),\u4f46\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>)\u9019\u500b\u9078\u9805\u4ecd\u7136\u662f\u9078\u64c7\u6027(optional)\u7684\u64cd\u4f5c</li> <li>\u56e0\u70baDuplex\u3001Transform\u90fd\u662f\u53ef\u4ee5\u88ab\u8b80\u53d6(<code>Readable</code>)\u4e5f\u53ef\u4ee5\u88ab\u5beb\u5165(<code>Writable</code>)\u7684,\u6bcf\u4e00\u500b<code>stream</code>(\u4e32\u6d41)\u6703\u7dad\u8b77(maintains)2\u500b\u7528\u4f86\u8b80\u53d6(reading) &amp; \u5beb\u5165(writing)\u7684\u5206\u958b(separate)\u7684\u5167\u90e8\u7684\u7de9\u5b58(internal <code>buffers</code>),\u5f9e\u800c\u5141\u8a31(allowing)\u6bcf\u4e00\u7aef(each side)\u7368\u7acb(independently)\u65bc\u53e6\u4e00\u7aef(the other)\u9032\u884c\u64cd\u4f5c(operate),\u540c\u6642\u4fdd\u6301(maintaining)\u9069\u7576(appropriate)\u4e14\u6709\u6548\u7387(efficient)\u7684\u6578\u64da\u6d41(flow of data)</li> <li>\u8209\u4f8b\u4f86\u8aaa,net.Socket\u5be6\u4f8b(instances)\u662f\u96d9\u5411\u4e32\u6d41(Duplex <code>streams</code>),\u800c\u5b83\u7684\u53ef\u8b80\u53d6\u9019\u7aef(<code>Readable</code> side)\u5141\u8a31(allows)\u6d88\u5316(consumption)\u6389\u5f9e\u63d2\u5ea7(<code>socket</code>)\u63a5\u6536(received)\u5230\u7684\u8cc7\u6599\u3002\u53e6\u5916,\u5b83\u7684\u53ef\u5beb\u5165\u9019\u7aef(<code>Writable</code> side)\u5141\u8a31(allows)\u5c07\u8cc7\u6599\u5beb\u5165(writing data)\u5230\u8a72\u63d2\u5ea7(<code>socket</code>)\u4e2d</li> <li>\u9019\u9ebc\u505a\u662f\u56e0\u70ba\u8cc7\u6599\u5beb\u5165\u5230\u63d2\u5ea7(data may be written to <code>socket</code>)\u7684\u901f\u7387(rate)\u6709\u53ef\u80fd\u6703\u6bd4\u6536\u5230\u7684\u6642\u9593\u4f86\u5f97\u5feb(faster) or \u6162(slower),\u56e0\u6b64\u6bcf\u4e00\u7aef(each side)\u61c9\u8a72\u8981\u7368\u7acb\u5730(independently)\u64cd\u4f5c(operate) &amp; <code>buffer</code>(\u7de9\u5b58)\u65bc\u53e6\u4e00\u7aef(the other)</li> <li>\u5167\u90e8\u7de9\u5b58\u6a5f\u5236(The mechanics of the internal buffering)\u662f\u4e00\u500b\u5167\u90e8\u5be6\u4f5c(internal implementation)\u7684\u7d30\u7bc0(detail),\u800c\u9019\u500b\u7d30\u7bc0\u53ef\u80fd\u6703\u5728\u4efb\u4f55\u4e00\u500b\u6642\u9593(at any time)\u88ab\u6539\u8b8a(changed)\u6389<ul> <li>\u7136\u800c(However),\u5c0d\u65bc\u67d0\u4e9b\u9032\u968e(certain advanced)\u7684\u5be6\u4f5c(implementations)\u800c\u8a00,\u5167\u90e8\u7de9\u5b58(<code>internal buffers</code>)\u53ef\u4ee5\u900f\u904e<code>writable.writableBuffer</code>\u3001<code>readable.readableBuffer</code>\u5c6c\u6027\u4f86\u5f97\u5230(retrieved)\u3002\u4f46\u662f\u4f7f\u7528\u50cf\u9019\u6a23\u6c92\u6709\u88ab\u6b63\u5f0f\u6587\u4ef6\u5316(undocumented)\u7684\u5c6c\u6027(properties),\u662f\u4e0d\u88ab\u9f13\u52f5(discouraged)\u9019\u9ebc\u505a\u7684 <p><code>stream</code>(\u4e32\u6d41)\u6d88\u8cbb\u8005\u7684API (API for stream consumers)</p> </li> </ul> </li> </ul> </li> <li>\u5e7e\u4e4e\u6240\u6709\u7684Node\u61c9\u7528\u7a0b\u5f0f(applications),\u4e0d\u7ba1\u662f\u591a\u7c21\u55ae,\u90fd\u6703\u4ee5\u67d0\u7a2e\u65b9\u5f0f(manner)\u4f86\u4f7f\u7528<code>streams</code>(\u4e32\u6d41)\u3002\u63a5\u4e0b\u4f86\u7684\u5c31\u662f\u4e00\u500b\u5728Node\u61c9\u7528\u7a0b\u5f0f\u4e2d\u4f7f\u7528<code>streams</code>(\u4e32\u6d41)\u4f86\u5be6\u4f5c(implements)\u4e00\u500b<code>HTTP</code>\u4f3a\u670d\u5668(server)\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc       JavaScript<pre><code>const http = require('http');\n\nconst server = http.createServer((req, res) =&gt; {\n  // `req` is an http.IncomingMessage, which is a readable stream.\n  // `res` is an http.ServerResponse, which is a writable stream.\n\n  let body = '';\n  // Get the data as utf8 strings.\n  // If an encoding is not set, Buffer objects will be received.\n  req.setEncoding('utf8');\n\n  // Readable streams emit 'data' events once a listener is added.\n  req.on('data', (chunk) =&gt; {\n    body += chunk;\n  });\n\n  // The 'end' event indicates that the entire body has been received.\n  req.on('end', () =&gt; {\n    try {\n      const data = JSON.parse(body);\n      // Write back something interesting to the user:\n      res.write(typeof data);\n      res.end();\n    } catch (er) {\n      // uh oh! bad json!\n      res.statusCode = 400;\n      return res.end(`error: ${er.message}`);\n    }\n  });\n});\n\nserver.listen(1337);\n\n// $ curl localhost:1337 -d \"{}\"\n// object\n// $ curl localhost:1337 -d \"\\\"foo\\\"\"\n// string\n// $ curl localhost:1337 -d \"not json\"\n// error: Unexpected token o in JSON at position 1\n</code></pre><ul> <li>\u53ef\u5beb\u5165\u4e32\u6d41(Writable streams)(=&gt; \u5c31\u50cf\u662f\u4e0a\u9762\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d\u7684<code>res</code>\u4e00\u6a23)\u6703\u516c\u958b(expose)\u4e00\u4e9b\u65b9\u6cd5(methods),\u4f8b\u5982:<code>res.write()</code>\u3001<code>res.end()</code>\u9019\u4e9b\u65b9\u6cd5\u662f\u7528\u4f86\u5c07\u8cc7\u6599\u5beb\u5165(write data)\u5230<code>stream</code>(\u4e32\u6d41)\u4e2d\u7684</li> <li>\u53ef\u8b80\u53d6\u4e32\u6d41(Readable streams)\u6703\u5728\u7576\u8cc7\u6599(data)\u53ef\u4ee5\u5f9e<code>stream</code>(\u4e32\u6d41)\u4e2d\u88ab\u8b80\u53d6(read off)\u6642,\u4f7f\u7528EventEmitterAPI\u4f86\u901a\u77e5(notifying)\u61c9\u7528\u7a0b\u5f0f\u7684\u7a0b\u5f0f\u78bc(application code)</li> <li>\u800c\u8a72\u53ef\u5f9e<code>stream</code>(\u4e32\u6d41)\u4e2d\u8b80\u53d6\u7684\u8cc7\u6599(available data)\u53ef\u4ee5\u5229\u7528\u591a\u7a2e\u65b9\u5f0f(multiple ways)\u4f86\u8b80\u53d6(read from)</li> <li>Writable streams\u3001Readable streams\u90fd\u53ef\u4ee5\u900f\u904e\u591a\u7a2e\u65b9\u5f0f(in various ways)\u4f86\u4f7f\u7528(use)EventEmitterAPI\u4f86\u50b3\u9054(communicate)\u7576\u524d<code>stream</code>(\u4e32\u6d41)\u7684\u72c0\u614b(state)</li> <li>Duplex\u3001Transform\u90fd\u662f\u53ef\u5beb\u5165\u4e32\u6d41(Writable streams) &amp; \u53ef\u8b80\u53d6\u4e32\u6d41(Readable streams)</li> <li>\u5f9e<code>stream</code>(\u4e32\u6d41)\u4e2d\u5beb\u5165\u8cc7\u6599(writing data) or \u6d88\u5316\u8cc7\u6599(consuming data)\u7684\u61c9\u7528\u7a0b\u5f0f(applications)\u4e0d\u6703\u88ab\u8981\u6c42(not required)\u8981\u76f4\u63a5(directly)\u5730\u5be6\u4f5c(implement)\u4e32\u6d41\u4ecb\u9762(<code>stream</code> interfaces),\u4e26\u4e14\u901a\u5e38(generally)\u6c92\u6709\u7406\u7531(have no reason)\u6703\u9700\u8981\u547c\u53eb(call)<code>require('stream')</code>\u8a9e\u6cd5</li> <li>\u60f3\u8981\u5be6\u4f5c(implement)\u65b0(new)\u7684<code>streams</code>\u985e\u578b(types)\u7684\u958b\u767c\u8005(developers)\u5011\u53ef\u4ee5\u53c3\u8003(refer to)API for stream implementers\u7ae0\u7bc0(section)</li> </ul> </li> <li> <p>\u53ef\u5beb\u5165\u4e32\u6d41 (Writable streams)</p> <ul> <li>\u53ef\u5beb\u5165\u4e32\u6d41(writable streams)\u662f\u4e00\u500b\u7d66\u8cc7\u6599(data)\u5beb\u5165(written)\u7684\u62bd\u8c61(abstraction)\u76ee\u7684\u5730(destination)</li> <li>\u4ee5\u4e0b\u662f\u5e38\u898b\u7684\u53ef\u5beb\u5165\u4e32\u6d41(writable streams)\u7684\u7bc4\u4f8b,\u5305\u62ec\u4e86</li> <li>HTTP requests, on the client</li> <li>HTTP responses, on the server</li> <li>fs write streams</li> <li>zlib streams</li> <li>crypto streams</li> <li>TCP sockets</li> <li>child process stdin</li> <li>process.stdout &amp; process.stderr</li> <li>\u4ee5\u4e0a\u7bc4\u4f8b\u4e2d\u7684\u5176\u4e2d\u4e00\u4e9b\u5be6\u969b(actually)\u4e0a\u662f\u96d9\u5411\u4e32\u6d41(Duplex streams)\u4f86\u5be6\u73fe\u53ef\u5beb\u5165\u4ecb\u9762Writable interface\u7684</li> <li>\u6240\u6709\u7684\u53ef\u5beb\u5165\u4e32\u6d41(Writable streams)\u6703\u5be6\u4f5c(implement)\u7531stream.writable\u985e\u5225(class)\u6240\u5b9a\u7fa9(defined)\u7684\u4ecb\u9762(interface)</li> <li>\u7136\u800c(While)\u7279\u5b9a(specific)\u7684\u53ef\u5beb\u5165\u4e32\u6d41(Writable streams)\u5be6\u4f8b(instances)\u6703\u5728\u4e0d\u540c\u65b9\u9762\u4e0b(various ways)\u6709\u6240\u4e0d\u540c(differ in),\u4f46\u662f\u6240\u6709\u53ef\u5beb\u5165\u4e32\u6d41(<code>Writable streams</code>)\u90fd\u6703\u90fd\u6703\u9075\u5f9e(follow)\u76f8\u540c(same)\u7684\u57fa\u790e(fundamental)\u7528\u6cd5(usage)\u6a21\u5f0f(pattern),\u5c31\u5982\u540c\u4ee5\u4e0b\u7684\u7bc4\u4f8b\u8aaa\u660e(illustrate)     JavaScript<pre><code>const myStream = getWritableStreamSomehow();\nmyStream.write('some data');\nmyStream.write('some more data');\nmyStream.end('done writing data');\n</code></pre></li> <li> <p>Class</p> </li> <li>stream.Writable</li> <li> <p>Event</p> <ul> <li>pipe</li> <li>args<ul> <li>src: stream.Readable</li> <li>\u8981\u50b3\u905e(piping to)\u7d66\u6b64\u53ef\u5beb\u5165(writable)\u7684\u6e90\u982d\u4e32\u6d41(source <code>stream</code>)</li> </ul> </li> <li><code>pipe</code>\u4e8b\u4ef6(event)\u6703\u5728\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u547c\u53eb(called)stream.pipe()\u65b9\u6cd5(method)\u6642\u88ab\u767c\u51fa(emitted),\u4e26\u53ef\u4ee5\u5c07\u9019\u500b\u53ef\u5beb\u5165\u4e32\u6d41(writable stream)\u6dfb\u52a0(adding)\u5230\u5176\u8a2d\u5b9a\u597d(its set of)\u7684\u76ee\u7684\u5730(destination)<ul> <li><code>js     const writer = getWritableStreamSomehow();     const reader = getReadableStreamSomehow();     writer.on('pipe', (src) =&gt; {       console.log('Something is piping into the writer.');       assert.equal(src, reader);     });     reader.pipe(writer);</code></li> </ul> </li> </ul> </li> <li> <p>method</p> <ul> <li>writable.end([chunk[, encoding]][, callback])</li> <li>args<ul> <li>chunk: (string | Buffer | Unit8Array) | any)</li> <li>\u8981\u5beb\u5165(write)\u7684\u53ef\u9078\u64c7\u6027(optional)\u8cc7\u6599(data)\u3002\u5c0d\u65bc\u90a3\u4e9b\"\u4e0d\u662f\"\u5728\u7269\u4ef6\u6a21\u5f0f(object mode)\u4e0b\u64cd\u4f5c(operating)\u7684<code>streams</code>(\u4e32\u6d41)\u4f86\u8aaa,<code>chunk</code>\u53c3\u6578\u503c\u7684\u578b\u5225\u5fc5\u9808\u70ba\u5b57\u4e32(string) or <code>Buffer</code>(\u7de9\u5b58) or <code>Unit8Array</code>\u4e09\u8005\u4e4b\u4e00\u3002\u800c\u5c0d\u65bc\u7269\u4ef6\u6a21\u5f0f(object mode)\u7684<code>streams</code>\u4f86\u8aaa,<code>chunk</code>\u53c3\u6578\u503c\u7684\u578b\u5225\u53ef\u4ee5\u662f\u4efb\u4f55Javascript\u4e2d\u7684\u4efb\u4f55\u578b\u5225(<code>any</code>) or <code>null</code></li> <li>encoding: (string)</li> <li>\u5982\u679c<code>chunk</code>\u53c3\u6578\u7684\u503c\u662f\u5b57\u4e32(string)\u578b\u5225\u7684\u8a71,\u53ef\u4ee5\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u7de8\u78bc\u683c\u5f0f(encoding)</li> <li>callback: (function)</li> <li>\u7576<code>stream</code>(\u4e32\u6d41)\u7d50\u675f(finished)\u6642,\u8981\u57f7\u884c\u7684\u56de\u547c\u51fd\u5f0f(callback)</li> <li>Returns: (this)</li> </ul> </li> <li>\u7576\u547c\u53eb(calling)\u6b64<code>writable.end()</code>\u65b9\u6cd5(method)\u6642,\u5c31\u662f\u4ee5\u4fe1\u865f\u767c\u51fa(signals)\u5df2\u7d93\u6c92\u6709\u66f4\u591a(no more)\u7684\u8cc7\u6599(data)\u8981\u5beb\u5165(written)\u5230\u53ef\u5beb\u5165\u4e32\u6d41(Writable)\u4e2d<ul> <li>\u800c\u53ef\u9078\u64c7\u6027(optional)\u8f38\u5165\u7684<code>chunk</code> &amp; <code>encoding</code> \u90192\u500b\u53c3\u6578(arguments)\u53ef\u5141\u8a31(allow)\u5728\u95dc\u9589(closing)<code>stream</code>(\u4e32\u6d41)\u4e4b\u524d,\u7acb\u5373(immediately)\u5beb\u5165(written)\u6700\u5f8c\u4e00\u500b(one final)\u984d\u5916(additional)\u7684\u8cc7\u6599\u584a(chunk of data)</li> </ul> </li> <li>\u82e5\u5728\u547c\u53eb(calling)stream.end()\u65b9\u6cd5(method)\u4e4b\u5f8c(after)\u624d\u547c\u53eb(calling)stream.write()\u65b9\u6cd5(method)\u7684\u8a71,\u6703\u5f15\u767c\u932f\u8aa4(raise an error)     JavaScript<pre><code>// Write 'hello, ' and then end with 'world!'.\nconst fs = require('fs');\nconst file = fs.createWriteStream('example.txt');\nfile.write('hello, ');\nfile.end('world!');\n// Writing more now is not allowed!\n</code></pre></li> <li>writable.write(chunk[, encoding][, callback])</li> <li>args<ul> <li>chunk: (string | Buffer | Unit8Array) | any)</li> <li>\u8981\u5beb\u5165(write)\u7684\u53ef\u9078\u64c7\u6027(optional)\u8cc7\u6599(data)\u3002\u5c0d\u65bc\u90a3\u4e9b\"\u4e0d\u662f\"\u5728\u7269\u4ef6\u6a21\u5f0f(object mode)\u4e0b\u64cd\u4f5c(operating)\u7684<code>streams</code>(\u4e32\u6d41)\u4f86\u8aaa,<code>chunk</code>\u53c3\u6578\u503c\u7684\u578b\u5225\u5fc5\u9808\u70ba\u5b57\u4e32(string) or <code>Buffer</code>(\u7de9\u5b58) or <code>Unit8Array</code>\u4e09\u8005\u4e4b\u4e00\u3002\u800c\u5c0d\u65bc\u7269\u4ef6\u6a21\u5f0f(object mode)\u7684<code>streams</code>\u4f86\u8aaa,<code>chunk</code>\u53c3\u6578\u503c\u7684\u578b\u5225\u53ef\u4ee5\u662f\u4efb\u4f55Javascript\u4e2d\u7684\u4efb\u4f55\u578b\u5225(<code>any</code>) or <code>null</code></li> <li>encoding: (string)</li> <li>\u5982\u679c<code>chunk</code>\u53c3\u6578\u7684\u503c\u662f\u5b57\u4e32(string)\u578b\u5225\u7684\u8a71,\u53ef\u4ee5\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u7de8\u78bc\u683c\u5f0f(encoding)</li> <li>\u9810\u8a2d\u503c: <code>utf8</code></li> <li>callback: (function)</li> <li>\u53ef\u6307\u5b9a\u7576\u5237\u65b0(flushed)\u6b64\u8cc7\u6599\u584a(chunk of data)\u7684\u6642\u5019\u8981\u547c\u53eb\u7684\u56de\u547c\u51fd\u5f0f(callback)</li> <li>Returns: (boolean)</li> <li>\u82e5<code>stream</code>(\u4e32\u6d41)\u5e0c\u671b(wishes)\u5728\u7e7c\u7e8c(continuing)\u5beb\u5165(write)\u984d\u5916(additional)\u7684\u8cc7\u6599(data)\u4e4b\u524d,\u5148\u7b49\u5f85(wait for)<code>drain</code>\u4e8b\u4ef6(event)\u88ab\u767c\u51fa(emitted)\u5f8c,\u518d\u4f86\u547c\u53eb(calling)\u7a0b\u5f0f\u78bc(code),\u5247\u8a72\u65b9\u6cd5\u6703\u56de\u50b3<code>false</code>; \u5426\u5247(otherwise),\u5c31\u662f<code>true</code></li> </ul> </li> <li>\u6b64\u65b9\u6cd5(method)\u6703\u5beb\u5165(writes)\u4e00\u4e9b\u8cc7\u6599(data)\u5230<code>stream</code>(\u4e32\u6d41)\u4e2d,\u4e26\u5728\u8cc7\u6599\u88ab\u5b8c\u5168\u8655\u7406(fully handled)\u5f8c,\u624d\u6703\u547c\u53eb\u6211\u5011\u6240\u63d0\u4f9b(supplied)\u7684\u56de\u547c\u51fd\u5f0f(callback)<ul> <li>\u82e5\u6709\u767c\u751f(occurs)\u932f\u8aa4(error)\u7684\u8a71,\u5247\u56de\u547c\u51fd\u5f0f(callback)\u53ef\u4ee5\u9078\u64c7\u8981\u4e0d\u8981\u4ee5<code>errors</code>(\u932f\u8aa4)\u70ba\u7b2c1\u500b\u53c3\u6578(argument)\u3002\u70ba\u4e86\u53ef\u9760(reliably)\u5730\u5075\u6e2c(detect)\u5230\u932f\u8aa4(errors),\u6211\u5011\u53ef\u4ee5\u65b0\u589e(add)\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(event listener)\u7d66error(\u932f\u8aa4)\u4e8b\u4ef6(event),\u800c\u56de\u547c\u51fd\u5f0f(callback)\u6703\u5728<code>error</code>\u4e8b\u4ef6\u88ab\u767c\u51fa(emitted)\u4e4b\u524d(before),\u4ee5\u975e\u540c\u6b65(asynchronously)\u7684\u65b9\u5f0f\u88ab\u547c\u53eb(called)</li> </ul> </li> <li>\u82e5\u5167\u90e8\u7de9\u5b58(internal <code>buffer</code>)\u5c0f\u65bc(less than)\u6211\u5011\u6240\u914d\u7f6e(configured)\u7684\u9ad8\u6c34\u4f4d\u7dda(<code>highWaterMark</code>),\u4e26\u4e14\u7576<code>stream</code>\u4e32\u6d41\u88ab\u5efa\u7acb(created)\u6642\u5df2\u7d93\u5141\u8a31(admitted)<code>chunk</code>\u4e86\u7684\u8a71,\u5247\u6b64\u65b9\u6cd5\u6703\u56de\u50b3<code>true</code><ul> <li>\u82e5\u6b64\u65b9\u6cd5\u56de\u50b3<code>false</code>,\u5247\u61c9\u505c\u6b62(stop)\u9032\u4e00\u6b65(further)\u5617\u8a66(attempts)\u8981\u5c07\u8cc7\u6599(data)\u5beb\u5165(write)<code>stream</code>\u4e32\u6d41,\u76f4\u5230drain\u4e8b\u4ef6(event)\u88ab\u767c\u51fa(emitted)\u5f8c</li> </ul> </li> <li>\u7576<code>stream</code>\u4e32\u6d41\u6c92\u6709\u8017\u76e1(not draining)\u6642,\u547c\u53eb<code>writable.write()</code>\u65b9\u6cd5(method)\u6703\u7de9\u5b58<code>chunk</code>,\u4e26\u4e14\u6b64\u65b9\u6cd5\u6703\u56de\u50b3<code>false</code>\u3002\u7576\u76ee\u524d(currently)\u6240\u6709(all)\u7684\u7de9\u5b58\u8cc7\u6599\u584a(buffered chunks)\u90fd\u8017\u76e1(drained)\u6642(=&gt; \u7531\u4f5c\u696d\u7cfb\u7d71(operating system)\u8ca0\u8cac\u63a5\u53d7(accepted)\u50b3\u905e(delivery)),drain\u4e8b\u4ef6(event)\u5c31\u6703\u88ab\u767c\u51fa(emitted)<ul> <li>\u5efa\u8b70\u7576\u6b64\u65b9\u6cd5\u56de\u50b3(returns)<code>false</code>\u6642,\u5c31\u4e0d\u8981\u518d(no more)\u5beb\u5165\u4efb\u4f55\u7684\u8cc7\u6599\u584a(chunks),\u76f4\u5230drain\u4e8b\u4ef6(event)\u88ab\u767c\u51fa(emitted)\u5f8c,\u624d\u80fd\u7e7c\u7e8c\u5beb\u5165\u8cc7\u6599\u584a</li> <li>\u7136\u800c,\u547c\u53eb<code>write()</code>\u65b9\u6cd5\u5728\u4e00\u500b\u9084\u6c92\u6709\u8017\u76e1(not draining)\u7684<code>stream</code>\u4e32\u6d41\u4e0a\u662f\u53ef\u5141\u8a31(allowed)\u7684,Node\u6703\u7de9\u5b58(buffer)\u6240\u6709\u5beb\u5165(writter)\u7684\u8cc7\u6599\u584a(chunks),\u76f4\u5230\u5230(until)\u9054\u6700\u5927\u8a18\u61b6\u9ad4\u4f7f\u7528\u91cf(maximum memory usage)\u9650\u5236\u767c\u751f(occurs)\u70ba\u6b62,\u5728\u9019\u6642\u5c07\u6703\u7121\u689d\u4ef6(unconditionally)\u5730\u7d42\u6b62(abort)\u3002\u5373\u4f7f(even)\u5728\u7d42\u6b62(abort)\u4e4b\u524d(before),\u9ad8\u8a18\u61b6\u9ad4\u4f7f\u7528\u7387(high memory usage)\u6703\u9020\u6210\u8ca7\u4e4f(poor)\u7684\u5783\u573e\u56de\u6536\u6548\u80fd(garbage collector performance)\u3001RSS(\u4e00\u822c\u4f86\u8aaa\u4e0d\u6703\u88ab\u91cb\u653e(released back)\u56de\u4f5c\u696d\u7cfb\u7d71\u4e2d(system),\u5373\u4f7f(even)\u5728\u90a3\u4e9b\u8a18\u61b6\u9ad4(memory)\u5df2\u7d93\u4e0d\u518d(no longer)\u88ab\u9700\u8981(required)\u5f8c)\u3002\u82e5\u9060\u7aef(remote)\u5c0d\u7b49\u65b9(peer)\u4e0d\u8b80\u53d6(not read)\u8cc7\u6599(data)\u7684\u8a71,\u5247<code>TCP</code>\u63d2\u5ea7(sockets)\u53ef\u80fd\u6c38\u9060\u4e0d\u6703\u8017\u76e1(drain),\u56e0\u6b64\u5beb\u5165(writing)\u4e00\u500b\u4e0d\u6703\u88ab\u8017\u76e1(not draining)\u7684\u63d2\u5ea7(socket),\u53ef\u80fd\u6703\u5c0e\u81f4(lead to)\u9060\u7aef(remotely)\u53ef\u88ab\u5229\u7528(exploitable)\u7684\u5f31\u9ede(vulnerability)</li> </ul> </li> <li>\u7576<code>stream</code>\u4e32\u6d41\u6c92\u6709\u88ab\u8017\u76e1\u6642,\u5c31\u5beb\u5165\u8cc7\u6599\u5c0dTransform stream\u4f86\u8aaa\u662f\u5c24\u5176\u6709\u554f\u984c(particularly problematic)\u7684,\u56e0\u70ba<code>Transform streams</code>\u5728\u9ed8\u8a8d(default)\u60c5\u6cc1\u4e0b\u662f\u6703\u66ab\u505c(paused)\u7684,\u76f4\u5230(until)\u5b83\u5011\u88ab\u900f\u904e\u7ba1\u9053\u50b3\u905e(piped) or \u4e00\u500b<code>data</code> or <code>readable</code>\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u88ab\u65b0\u589e(added)\u5f8c\u624d\u6703\u7e7c\u7e8c\u958b\u59cb</li> <li>\u5982\u679c\u8981\u5beb\u5165(written)\u7684\u8cc7\u6599(data)\u80fd\u5920\u6309\u7167\u9700\u6c42(on demand)\u751f\u6210(generated) or \u7372\u53d6(fetched),\u5247\u5efa\u8b70(recommended)\u5c07\u908f\u8f2f(logic)\u5c01\u88dd(encapsulate)\u9032\u53ef\u8b80\u53d6\u4e32\u6d41(Readable)\u4e2d,\u4e26\u5229\u7528stream.pipe()\u65b9\u6cd5(method)\u4f86\u5b8c\u6210<ul> <li>\u7136\u800c(However),\u82e5\u547c\u53eb<code>writable.write()\b</code>\u65b9\u6cd5\u662f\u512a\u5148\u4f7f\u7528(preferred)\u7684\u8a71,\u9019\u662f\u6709\u53ef\u80fd(possible)\u7684\u8981\u5c0a\u91cd\u80cc\u58d3(respect backpressure)\u4e14\u907f\u514d(avoid)\u8a18\u61b6\u9ad4\u554f\u984c(memory issues),\u4e26\u4f7f\u7528drain\u4e8b\u4ef6(event)   JavaScript<pre><code>function write(data, cb) {\n  if (!stream.write(data)) {\n    stream.once('drain', cb);\n  } else {\n    process.nextTick(cb);\n  }\n}\n\n// Wait for cb to be called before doing any other write.\nwrite('hello', () =&gt; {\n  console.log('Write completed, do more writes now.');\n});\n</code></pre></li> </ul> </li> <li>\u88dc\u5145: \u4e00\u500b\u7269\u4ef6\u6a21\u5f0f(object mode)\u4e0b\u7684\u53ef\u5beb\u5165\u4e32\u6d41(Writable stream),\u5c07\u7e3d\u662f(always)\u6703\u5ffd\u7565(ignore)\u6389<code>encoding</code>\u9019\u500b\u53c3\u6578(argument)</li> </ul> </li> <li> <p>properties</p> <ul> <li>writable.writable</li> <li>Returns: (boolean)</li> <li>\u5982\u679c\u6b64\u5c6c\u6027(<code>writable.writable</code>)\u7684\u503c\u662f<code>true</code>\u7684\u8a71,\u90a3\u5c31\u80fd\u5b89\u5168\u5730\u547c\u53ebwritable.write()\u65b9\u6cd5(method)\u4e86,\u4e5f\u5c31\u662f\u4ee3\u8868\u8a72<code>stream</code>(\u4e32\u6d41)\u6c92\u6709\u88ab\u6d88\u6ec5(destroyed)\u6389 or \u767c\u751f\u932f\u8aa4(errored) or \u7d50\u675f(ended)</li> </ul> </li> </ul> </li> <li> <p>\u53ef\u8b80\u53d6\u4e32\u6d41 (Readable streams)</p> <ul> <li>\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u662f\u4e00\u500b\u6d88\u8017(consumed)\u6389\u8cc7\u6599(data)\u7684\u62bd\u8c61(abstraction)\u4f86\u6e90(source)</li> <li>\u4ee5\u4e0b\u662f\u5e38\u898b\u7684\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u7684\u7bc4\u4f8b,\u5305\u62ec\u4e86</li> <li>HTTP responses, on the client</li> <li>HTTP requests, on the server</li> <li>fs read streams</li> <li>zlib streams</li> <li>crypto streams</li> <li>TCP sockets</li> <li>child process stdout and stderr</li> <li>process.stdin</li> <li>\u6240\u6709\u7684\u53ef\u8b80\u53d6\u4e32\u6d41(Readable streams)\u90fd\u662f\u900f\u904estream.readable\u985e\u5225(class)\u4f86\u5be6\u4f5c(implement)\u4ecb\u9762(interface)\u7684</li> <li> <p>2\u7a2e\u53ef\u8b80\u53d6\u4e32\u6d41\u7684\u6a21\u5f0f (Two reading modes)</p> </li> <li>\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u53ef\u4ee5\u7528\u4ee5\u4e0b2\u7a2e\u6709\u6548\u7387(effective)\u7684\u6a21\u5f0f(modes)\u4e4b\u4e00\u4f86\u64cd\u4f5c(operate)<ul> <li>\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code>)</li> <li>\u66ab\u505c\u6a21\u5f0f(<code>paused</code>)</li> </ul> </li> <li>\u4ee5\u4e0a\u90192\u7a2e\u6a21\u5f0f\u90fd\u662f\u5f9e\u7269\u4ef6\u6a21\u5f0f(object mode)\u4e0b\u7684\u4e32\u6d41\u4e2d\u5206\u96e2\u51fa\u4f86(separate from)\u7684\u3002\u4e00\u500b\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u53ef\u4ee5\u662f\u7269\u4ef6\u6a21\u5f0f(object mode)\u4e5f\u53ef\u4ee5\u4e0d\u662f,\u4e0d\u7ba1\u5b83\u662f\u5728\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode) or \u66ab\u505c\u6a21\u5f0f(<code>paused</code> mode)</li> <li>\u5728\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)\u4e2d,\u8cc7\u6599(data)\u662f\u5f9e\u5e95\u5c64\u7cfb\u7d71(underlying system)\u8b80\u53d6\u9032\u4f86(read from)\u7684,\u4e26\u4f7f\u7528\u4e8b\u4ef6(events)\u81ea\u52d5(automatically)\u4e14\u76e1\u5feb(as quickly as possible)\u5730\u900f\u904eEventEmitter\u4ecb\u9762(interface)\u4f86\u5c07\u8cc7\u6599\u63d0\u4f9b(provided)\u7d66\u61c9\u7528\u7a0b\u5f0f(application)</li> <li>\u5728\u66ab\u505c\u6a21\u5f0f(<code>paused</code> mode)\u4e2d,stream.read()\u65b9\u6cd5(method)\u5fc5\u9808\u88ab\u660e\u78ba(explicitly)\u5730\u547c\u53eb(called)\u4f86\u8b80\u53d6(reads)<code>stream</code>(\u4e32\u6d41)\u4e2d\u7684\u8cc7\u6599\u584a(chunks of data)</li> <li>\u6240\u6709\u7684\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u90fd\u662f\u5f9e\u66ab\u505c\u6a21\u5f0f(<code>paused</code> mode)\u958b\u59cb(begin)\u7684,\u4f46\u662f\u90fd\u80fd\u900f\u904e\u4ee5\u4e0b\u76843\u7a2e\u65b9\u5f0f\u4f86\u5207\u63db(switched to)\u70ba\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)<ul> <li>\u65b0\u589e(Adding)data\u9019\u500b\u4e8b\u4ef6\u8655\u7406\u5668(event handler)</li> <li>\u547c\u53ebstream.resume()\u65b9\u6cd5(method)</li> <li>\u547c\u53ebstream.pipe()\u65b9\u6cd5(method)</li> </ul> </li> <li>\u6240\u6709\u7684\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u4e5f\u90fd\u80fd\u900f\u904e\u4ee5\u4e0b\u76842\u7a2e\u65b9\u5f0f\u4f86\u5f9e\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)\u5207\u63db(switch back to)\u70ba\u66ab\u505c\u6a21\u5f0f(<code>paused</code> mode)<ul> <li>\u82e5\"\u6c92\u6709\"\u7ba1\u9053(pipe)\u50b3\u9001\u7684\u76ee\u7684\u5730(destinations)\u7684\u8a71,\u5247\u547c\u53eb(calling)stream.pause()\u65b9\u6cd5(method)</li> <li>\u82e5\u6709\u7ba1\u9053(pipe)\u50b3\u9001\u7684\u76ee\u7684\u5730(destinations)\u7684\u8a71,\u5247\u8981\u79fb\u9664(removing)\u6240\u6709(all)\u7684\u7ba1\u9053(pipe)\u50b3\u9001\u76ee\u7684\u5730(destination)</li> <li>\u591a\u6578\u7684\u7ba1\u9053(pipe)\u50b3\u9001\u76ee\u7684\u5730(destinations)\u90fd\u53ef\u4ee5\u900f\u904e\u547c\u53ebstream.umpipe()\u65b9\u6cd5(method)\u4f86\u79fb\u9664(removing)\u6389</li> </ul> </li> <li>\u6709\u4e00\u500b\u8981\u8a18\u4f4f\u7684\u91cd\u8981\u89c0\u5ff5\u5c31\u662f,\u5728\u76f4\u5230(until)\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u63d0\u4f9b\u4e00\u7a2e\u6d88\u8017(consuming) or \u5ffd\u7565(ignoring)\u8cc7\u6599(data)\u7684\u6a5f\u5236(mechanism)\u4e4b\u524d,\u90fd\u4e0d\u6703\u751f\u6210(generate)\u8cc7\u6599(data)\u3002\u5982\u679c\u6d88\u8017\u6a5f\u5236\u662f\u88ab\u7981\u7528(disable)\u7684 or \u53d6\u6d88(taken away)\u7684\u8a71,\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u5c07\u5617\u8a66(attempt to)\u505c\u6b62(stop)\u751f\u6210(generating)\u8cc7\u6599(data)</li> <li>\u57fa\u65bc\u5411\u5f8c(backward)\u76f8\u5bb9(compatibility)\u7684\u539f\u56e0(reasons),\u79fb\u9664(removing)data\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u5c07 \u4e0d\u6703\u81ea\u52d5(autmatically)\u5730\u66ab\u505c(pause)\u6389stream(\u4e32\u6d41)<ul> <li>\u540c\u6a23\u5730,\u5982\u679c\u6709\u7ba1\u9053(piped)\u50b3\u9001\u7684\u76ee\u7684\u5730(destinations)\u7684\u8a71,\u5247\u4e00\u65e6(once)\u90a3\u4e9b\u7ba1\u9053\u76ee\u7684\u5730\u8017\u76e1(drain)\u4e26\u8981\u6c42(ask)\u66f4\u591a\u7684\u8cc7\u6599(more data)\u6642,\u9019\u6642\u518d\u547c\u53ebstream.pause()\u65b9\u6cd5(method)\u5c07\u4e0d\u80fd\u4fdd\u8b49(guarantee)<code>stream</code>(\u4e32\u6d41)\u5c07\u6703\u4fdd\u6301(remain)\u66ab\u505c(paused)\u7684</li> </ul> </li> <li>\u5982\u679c\u5c07\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u88ab\u5207\u63db\u70ba\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode),\u5247\u5c07\u4e0d\u6703\u6709\u6d88\u8cbb\u8005(consumers)\u80fd\u5920(available)\u8655\u7406(handle)\u9019\u4e9b\u8cc7\u6599(data),\u800c\u9019\u4e9b\u8cc7\u6599\u4e5f\u5c31\u6703\u907a\u5931(lost)\u6389\u3002\u8209\u4f8b\u4f86\u8aaa(for instance),\u7576\u5728\u6c92\u6709(without)\u9644\u52a0(attached)data\u4e8b\u4ef6(event) or \u7576\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u5df2\u7d93\u5f9e<code>stream</code>(\u4e32\u6d41)\u4e2d\u79fb\u9664(removed from)\u7684\u60c5\u6cc1\u4e0b\u6642,\u547c\u53eb(called)readable.resume()\u65b9\u6cd5(method)\u7684\u8a71,\u9019\u6a23\u7684\u60c5\u6cc1\u5c31\u6703\u767c\u751f(oocur)</li> <li>\u65b0\u589e\u4e00\u500b\u53ef\u8b80\u53d6\u4e32\u6d41(Readable)\u7684\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u6703\u81ea\u52d5(automatically)\u5730\u8b93<code>stream</code>(\u4e32\u6d41)\u505c\u6b62(stop)\u6d41\u52d5(<code>flowing</code>),\u4e26\u4e14\u8cc7\u6599\u6703\u7e7c\u7e8c\u900f\u904ereadable.read()\u65b9\u6cd5(method)\u4f86\u6d88\u8017(consumed)\u6389<ul> <li>\u82e5readable\u9019\u500b\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u5df2\u7d93\u88ab\u79fb\u9664(removed)\u6389,\u4e26\u4e14\u6709data\u9019\u500b\u4e8b\u4ef6\u8655\u7406\u5668(event handler)\u7684\u8a71,\u90a3\u9ebc<code>stream</code>(\u4e32\u6d41)\u5c07\u6703\u518d(again)\u958b\u59cb(start)\u6d41\u52d5(<code>flowing</code>)\u4e0b\u53bb</li> </ul> </li> <li> <p>3\u7a2e\u53ef\u8b80\u53d6\u4e32\u6d41\u7684\u72c0\u614b (Three states)</p> </li> <li>\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u76842\u7a2e\u6a21\u5f0f(tow modes)\u7684\u64cd\u4f5c(operation),\u5176\u5be6\u662f\u5c0d\u65bc\u53ef\u8b80\u53d6\u4e32\u6d41(readable streams)\u5728\u5be6\u4f5c(implementation)\u767c\u751f(happening)\u4e2d\u7684\u6642\u5019,\u5176\u66f4\u8907\u96dc(more complicated)\u7684\u5167\u90e8(internal)\u72c0\u614b(state)\u7ba1\u7406(management)\u7684\u4e00\u7a2e\u7c21\u6613(simplified)\u62bd\u8c61(abstraction)</li> <li>\u5177\u9ad4\u4f86\u8aaa(Specifically),\u5728\u4efb\u4f55(any)\u4e00\u500b\u5047\u5b9a(given)\u7684\u6642\u9593\u9ede(point in time),\u6bcf\u4e00\u500b\u53ef\u8b80\u53d6\u4e32\u6d41(<code>Readable</code>)\u90fd\u6703\u662f\u4ee5\u4e0b3\u7a2e\u53ef\u80fd(possible)\u7684\u72c0\u614b(states)\u4e4b\u4e00<ul> <li><code>readable.readableFlowing === null</code></li> <li><code>readable.readableFlowing === false</code></li> <li><code>readable.readableFlowing === true</code></li> <li>\u53ef\u53c3\u8003readable.readableFlowing#\u7ae0\u7bc0\u7684\u4ecb\u7d39</li> </ul> </li> <li>\u7576<code>readable.readableFlowing</code>\u5c6c\u6027\u7684\u503c\u662f<code>null</code>\u7684\u8a71,\u5247\u5c07\u4e0d\u6703\u63d0\u4f9b(provided)\u6d88\u8017(consuming)\u8cc7\u6599\u6d41(stream's data)\u7684\u6a5f\u5236(mechanism)\u3002\u56e0\u6b64(Therefore),<code>stream</code>(\u4e32\u6d41)\u5c07\u4e0d\u6703\u751f\u6210(generate)\u8cc7\u6599(data)\u3002\u7576\u5728\u9019\u500b\u72c0\u614b(state)\u4e0b\u6642,\u9644\u52a0(attaching)\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u7d66data\u9019\u500b\u4e8b\u4ef6(event),\u518d\u547c\u53ebreadable.pipe()\u65b9\u6cd5(method),\u6216\u662f\u547c\u53ebreadable.resume()\u65b9\u6cd5(method),\u5247\u6703\u5c07<code>readable.readableFlowing</code>\u9019\u500b\u5c6c\u6027\u7684\u503c\u5207\u63db(switch)\u70ba<code>true</code>,\u5c0e\u81f4(causing)\u53ef\u8b80\u53d6\u4e32\u6d41(Reable)\u6703\u5728\u8cc7\u6599(data)\u751f\u6210(generated)\u6642,\u4e3b\u52d5(actively)\u5730\u767c\u51fa(emitting)\u4e8b\u4ef6(events)</li> <li>\u547c\u53eb(Calling)readable.pause()\u65b9\u6cd5(method) or readable.unpipe()\u65b9\u6cd5(method) or \u63a5\u53d7(receiving)\u80cc\u58d3(backpressure)\u5c07\u6703\u5c0e\u81f4(cause)<code>readable.readableFlowing</code>\u9019\u500b\u5c6c\u6027\u7684\u503c\u88ab\u8a2d\u5b9a(set)\u70ba<code>false</code>,\u9019\u5c07\u6703\u66ab\u6642(temporarily)\u5730\u7d42\u6b62(halting)\u63a5\u4e0b\u4f86(following)\u7684\u4e8b\u4ef6\u5011(events),\u4f46\u662f\"\u4e0d\u6703\"\u7d42\u6b62(halting)\u751f\u6210(generating)\u8cc7\u6599(data)\u3002\u7576\u8655\u65bc\u9019\u7a2e\u72c0\u614b(state)\u6642,\u9644\u52a0(attaching)\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u7d66data\u9019\u500b\u4e8b\u4ef6(event)\u7684\u8a71,\u5c07\u4e0d\u6703\u628a<code>readable.readableFlowing</code>\u9019\u500b\u5c6c\u6027\u7684\u503c\u5207\u63db(switch)\u70ba<code>true</code> JavaScript<pre><code>const { PassThrough, Writable } = require('stream');\nconst pass = new PassThrough();\nconst writable = new Writable();\n\npass.pipe(writable);\npass.unpipe(writable);\n// readableFlowing is now false.\n\npass.on('data', (chunk) =&gt; { console.log(chunk.toString()); });\npass.write('ok');  // Will not emit 'data'.\npass.resume();     // Must be called to make stream emit 'data'.\n</code></pre><ul> <li>\u7576<code>readable.readableFlowing</code>\u9019\u500b\u5c6c\u6027\u7684\u503c\u70ba<code>false</code>\u7684\u8a71,\u8cc7\u6599(data)\u5c07\u53ef\u4ee5(may)\u88ab\u7d2f\u7a4d(accumulating)\u5728<code>stream</code>(\u4e32\u6d41)\u7684\u5167\u90e8\u7de9\u5b58(internal buffer)\u4e4b\u4e2d(within)</li> </ul> </li> <li> <p>\u9078\u64c7\u4e00\u500bAPI\u985e\u578b (Choose one API style)</p> </li> <li>\u53ef\u8b80\u53d6\u4e32\u6d41(Readable) API\u5df2\u7d93\u767c\u5c55(evolved)\u6210\u80fd\u8de8(accross)\u591a\u500b(multiple)Node\u7248\u672c(versions)\u4e26\u63d0\u4f9b(provides)\u591a\u500b(multiple)\u6d88\u8017(consuming)\u8cc7\u6599\u6d41(stream data)\u7684\u65b9\u6cd5(method)<ul> <li>\u901a\u5e38\u4f86\u8aaa(In general),\u958b\u767c\u8005(developers)\u61c9\u8a72\u8981\u9078\u64c7(choose)\u4e00\u500b\u6d88\u8017(consuming)\u8cc7\u6599(data)\u7684\u65b9\u6cd5(method)\u4e26\u4e14\u61c9\u8a72\u6c38\u9060(never)\u4e0d\u8981\u5728\u55ae\u4e00(single)\u500b<code>stream</code>(\u4e32\u6d41\u4e2d)\u4f7f\u7528(use)\u591a\u500b(multiple)\u65b9\u6cd5(methods)\u4f86\u6d88\u8017(consume)\u8cc7\u6599(data)</li> <li>\u5177\u9ad4\u4f86\u8aaa(Specifically),\u4f7f\u7528<code>on('data')</code> &amp; <code>on('readable')</code> &amp; <code>pipe()</code>\u7684\u7d44\u5408,\u6216\u662f\u975e\u540c\u6b65(asynchronous)\u7684\u8fed\u4ee3\u5668(iterators)\u53ef\u80fd\u6703\u5c0e\u81f4\u4e0d\u76f4\u89ba(unintuitive)\u7684\u884c\u70ba(behavior)</li> </ul> </li> <li>\u5efa\u8b70\u5927\u591a\u6578\u7684\u4f7f\u7528\u8005\u53ef\u4ee5\u5229\u7528readable.pipe()\u65b9\u6cd5(method),\u56e0\u70ba\u5b83\u80fd\u63d0\u4f9b(provide)\u6d88\u8017(consuming)\u8cc7\u6599\u6d41(stream data)\u7684\u6700\u7c21\u55ae(easiest)\u7684\u5be6\u4f5c(implemented)\u65b9\u5f0f<ul> <li>\u958b\u767c\u8005\u82e5\u8981\u6c42(require)\u66f4\u7d30\u7dfb(fine-grained)\u5730\u63a7\u5236(control over)\u8f49\u63db(transform) &amp; \u751f\u6210\u8cc7\u6599(generation of data)\u7684\u8a71,\u80fd\u4f7f\u7528EventEmitter\u985e\u5225(class)\u4ee5\u53ca<code>readable.on('readable')</code>/<code>readable.read()</code> or <code>readable.pause()/readable.resume()</code> APIs</li> </ul> </li> <li> <p>Class</p> </li> <li>stream.readable</li> <li> <p>Event</p> <ul> <li>data</li> <li>args<ul> <li>chunk (Buffer) | (String) | (any)</li> <li>\u8cc7\u6599\u584a(The chunk of data)\u3002\u5c0d\u65bc\u90a3\u4e9b\u4e0d\u662f\u4ee5\u7269\u4ef6\u6a21\u5f0f(object mode)\u4f86\u64cd\u4f5c(operating in)\u7684<code>streams</code>(\u4e32\u6d41)\u4f86\u8aaa,\u8cc7\u6599\u584a(chunk)\u5c07\u6703\u662f\u5b57\u4e32(string) or <code>Buffer</code>(\u7de9\u5b58)\u90192\u7a2e\u578b\u5225\u4e4b\u4e00\u3002\u800c\u5c0d\u65bc\u662f\u4ee5\u7269\u4ef6\u6a21\u5f0f(object mode)\u4f86\u64cd\u4f5c(operating in)\u7684<code>streams</code>(\u4e32\u6d41)\u4f86\u8aaa,\u8cc7\u6599\u584a(chunk)\u5c07\u80fd\u662f\u9664\u4e86<code>null</code>\u4ee5\u5916\u7684Javascript\u4e2d\u7684\u4efb\u4f55\u503c(any value)</li> </ul> </li> <li>\u6bcf\u7576(whenever)<code>stream</code>(\u4e32\u6d41)\u5c07\u8cc7\u6599\u584a(a chunk of data)\u7684\u64c1\u6709\u6b0a(ownership)\u8f49\u79fb(relinquishing)\u7d66\u6d88\u8cbb\u8005(consumer)\u6642,\u90fd\u6703\u767c\u51fa(emitted)<code>data</code>\u4e8b\u4ef6(event)</li> <li>\u6bcf\u7576(whenever)\u900f\u904e\u547c\u53eb(calling)readable.pipe()\u65b9\u6cd5 or readable.resume()\u65b9\u6cd5 or \u9644\u52a0(attaching)\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u7684\u56de\u547c\u51fd\u5f0f(callback)\u5728<code>data</code>\u9019\u500b\u4e8b\u4ef6(event)\u4e0a\u6642,\u4f86\u8b93<code>stream</code>(\u4e32\u6d41)\u88ab\u5207\u63db(switched)\u70ba\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)\u7684\u6642\u5019,\u90fd\u6709\u53ef\u80fd(may)\u6703\u767c\u751f(occur)\u767c\u51fa(emitted)<code>data</code>\u9019\u500b\u4e8b\u4ef6(event)</li> <li>\u6bcf\u7576(whenever)\u547c\u53eb(called)readable.read()\u65b9\u6cd5(method)\u6642,\u4e26\u4e14\u8cc7\u6599\u584a(a chunk of data)\u662f\u80fd\u5920(available)\u88ab\u56de\u50b3(returned)\u7684\u60c5\u6cc1\u4e0b\u6642,\u4e5f\u53ef\u80fd\u6703\u767c\u51fa(emitted)<code>data</code>\u9019\u500b\u4e8b\u4ef6(event)</li> <li>\u9644\u52a0(Attaching)\u4e00\u500b\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u5230\u90a3\u4e9b\u9084\u5c1a\u672a(has not been)\u88ab\u660e\u78ba(explicitly)\u5730\u66ab\u505c(paused)\u7684<code>stream</code>(\u4e32\u6d41)\u4e0a\u6642,\u5c07\u6703\u628a<code>stream</code>(\u4e32\u6d41)\u5207\u63db\u70ba\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)\u3002\u9019\u6642,\u8cc7\u6599(data)\u5c07\u6703\u5728\u5176\u80fd\u5920(available)\u4f7f\u7528\u6642\u76e1\u5feb(as soon as)\u5730\u50b3\u905e(passed)\u51fa\u53bb</li> <li>\u82e5\u8a72<code>stream</code>(\u4e32\u6d41)\u7684\u9810\u8a2d(default)\u7de8\u78bc\u683c\u5f0f(encoding)\u5df2\u7d93\u6709\u900f\u904ereadable.setEncoding()\u65b9\u6cd5(method)\u4f86\u6307\u5b9a(specified)\u904e\u7684\u8a71,\u4e8b\u4ef6\u76e3\u807d\u5668(listener)\u56de\u547c\u51fd\u5f0f(callback)\u5c07\u6703\u628a\u8cc7\u6599\u584a(the chunk of data)\u4ee5\u5b57\u4e32(string)\u578b\u5225\u7684\u65b9\u5f0f\u50b3\u905e(passed)\u51fa\u53bb; \u5426\u5247(otherwise),\u8cc7\u6599(data)\u5c07\u6703\u4ee5<code>Buffer</code>(\u7de9\u5b58)\u578b\u5225\u7684\u65b9\u5f0f\u4f86\u50b3\u905e(passed)\u51fa\u53bb     JavaScript<pre><code>const readable = getReadableStreamSomehow();\nreadable.on('data', (chunk) =&gt; {\n  console.log(`Received ${chunk.length} bytes of data.`);\n});\n</code></pre></li> <li>pause</li> <li>\u7576\u547c\u53eb(called)stream.pause()\u65b9\u6cd5(method)\u6642,\u4e26\u4e14readable.redableFlowing\u7684\u5c6c\u6027\u503c\"\u4e0d\u70ba\"<code>false</code>\u7684\u8a71,<code>pause</code>\u4e8b\u4ef6(event)\u5c31\u6703\u88ab\u767c\u51fa(emitted)</li> <li> <p>method</p> </li> <li>readable.pause()<ul> <li>Returns: (this)</li> <li><code>readable.pause()</code>\u65b9\u6cd5(method)\u6703\u5c0e\u81f4(cause)\u8655\u65bc\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)\u7684<code>stream</code>(\u4e32\u6d41)\u505c\u6b62(stop)\u767c\u51fa(emitting)data\u9019\u500b\u4e8b\u4ef6(events),\u4e26\u5f9e\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)\u4e2d\u5207\u63db\u51fa\u4f86(switching out of)\u3002\u4efb\u4f55(any)\u8b8a\u6210(becomes)\u53ef\u7528(available)\u7684\u8cc7\u6599(data)\u90fd\u5c07\u6703\u4fdd\u6301(remain)\u5728\u5167\u90e8\u7de9\u5b58(internal buffer)\u4e2d   JavaScript<pre><code>const readable = getReadableStreamSomehow();\nreadable.on('data', (chunk) =&gt; {\n  console.log(`Received ${chunk.length} bytes of data.`);\n  readable.pause();\n  console.log('There will be no additional data for 1 second.');\n  setTimeout(() =&gt; {\n    console.log('Now data will start flowing again.');\n    readable.resume();\n  }, 1000);\n});\n</code></pre></li> <li>\u88dc\u5145: \u82e5\u6709\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u4e8b\u4ef6\u76e3\u807d\u5668(event listener)\u7684\u8a71,<code>readable.pause()</code>\u65b9\u6cd5(method)\u5c07\u6703 \u7121\u6548 (no effect)</li> </ul> </li> <li>readable.read([size])<ul> <li>args</li> <li>size: (Number)<ul> <li>\u9019\u662f\u4e00\u500b\u53ef\u9078\u64c7\u6027(optional)\u8981\u4e0d\u8981\u7d66\u7684\u53c3\u6578(argument),\u662f\u7528\u4f86\u6307\u5b9a(specify)\u6709\u591a\u5c11\u6578\u91cf\u7684\u8cc7\u6599(data)\u8981\u88ab\u8b80\u53d6(read)</li> </ul> </li> <li>Returns: (string) | (Buffer) | (null) | (any)</li> <li>\u6b64<code>readable.read()</code>\u65b9\u6cd5(method)\u6703\u5f9e\u5167\u90e8\u7de9\u5b58\u5340(internal buffers)\u62c9\u51fa(pull)\u4e00\u4e9b\u8cc7\u6599(data)\u4e26\u4e14\u56de\u50b3(returns)\u9019\u4e9b\u8cc7\u6599\u3002\u82e5\u6c92\u6709\u8cc7\u6599\u80fd\u5920(available)\u8b80\u53d6\u7684\u8a71,\u5c31\u6703\u56de\u50b3(returned)<code>null</code></li> <li>\u9810\u8a2d\u60c5\u6cc1(default)\u4e0b,\u56de\u50b3(returned)\u7684\u8cc7\u6599\u6703\u662f<code>Buffer</code>(\u7de9\u5b58)\u7269\u4ef6(object),\u9664\u975e(unless)\u6211\u5011\u6709\u900f\u904ereadable.setEncoding()\u65b9\u6cd5(method)\u4f86\u6307\u5b9a(specify)\u60f3\u8981\u7684\u7de8\u78bc\u683c\u5f0f(encoding),\u6216\u662f<code>stream</code>(\u4e32\u6d41)\u662f\u4ee5\u7269\u4ef6\u6a21\u5f0f(object mode)\u4f86\u904b\u4f5c(operating)\u7684</li> <li>\u6b64\u65b9\u6cd5(method)\u4e2d\u7684\u53ef\u9078\u6027(optional)\u586b\u5165\u7684\u53c3\u6578(argument)<code>size</code>\u53ef\u4ee5\u7528\u4f86\u6307\u5b9a(specifies)\u8981\u8b80\u53d6(read)\u591a\u5c11\u7279\u5b9a(specific)\u6578\u91cf(number)\u7684\u4f4d\u5143\u7d44(bytes)\u3002\u82e5<code>size</code>\u53c3\u6578\u4e0d\u662f\u6709\u6548(available)\u7684\u8a71,\u90a3\u9ebc\u5c31\u6703\u56de\u50b3<code>null</code>,\u9664\u975e(unless)<code>stream</code>(\u4e32\u6d41)\u5df2\u7d93\u7d50\u675f(ended)\u4e86\u7684\u8a71,\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b(in which case),\u5c31\u6703\u5c07\u6240\u6709\u5728\u5167\u90e8\u7de9\u5b58(internal buffer)\u4e2d\u5269\u4e0b(remaining)\u7684\u8cc7\u6599(data)\u90fd\u56de\u50b3(returned)\u51fa\u4f86</li> <li>\u82e5\u6b64\u65b9\u6cd5\u4e2d\u7684<code>size</code>\u53c3\u6578\u6c92\u6709\u88ab\u6307\u5b9a(specified)\u7684\u8a71,\u5c07\u56de\u50b3(returned)\u6240\u6709\u5305\u542b(contained)\u5728\u5167\u90e8\u7de9\u5b58\u5340(internal buffer)\u4e2d\u7684\u8cc7\u6599(data)</li> <li><code>size</code>\u53c3\u6578\u7684\u503c\u5fc5\u9808\u5c0f\u65bc or \u7b49\u65bc 1 <code>Gib</code></li> <li><code>readable.read()</code>\u65b9\u6cd5(method)\u61c9\u53ea\u80fd\u5728\u4ee5\u66ab\u505c\u6a21\u5f0f(<code>paused</code> mode)\u904b\u4f5c(operating)\u4e26\u5728\u53ef\u8b80\u53d6\u4e32\u6d41(Readable)\u4e2d\u547c\u53eb(called)\u6b64\u65b9\u6cd5\u3002\u5728\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)\u4e2d,\u76f4\u5230(until)\u5167\u90e8\u7de9\u5b58(internal buffer)\u88ab\u5b8c\u5168\u8017\u76e1(fully drained)\u6642,\u5c31\u6703\u81ea\u52d5\u5730\u547c\u53eb<code>readable.read()</code>\u65b9\u6cd5   JavaScript<pre><code>const readable = getReadableStreamSomehow();\n\n// 'readable' may be triggered multiple times as data is buffered in\nreadable.on('readable', () =&gt; {\n  let chunk;\n  console.log('Stream is readable (new data received in buffer)');\n  // Use a loop to make sure we read all currently available data\n  while (null !== (chunk = readable.read())) {\n    console.log(`Read ${chunk.length} bytes of data...`);\n  }\n});\n\n// 'end' will be triggered once when there is no more data available\nreadable.on('end', () =&gt; {\n  console.log('Reached end of stream.');\n});\n</code></pre></li> <li>\u6bcf\u4e00\u6b21(Each)\u547c\u53eb(call)<code>readable.read()</code>\u65b9\u6cd5\u90fd\u6703\u56de\u50b3(returns)\u4e00\u500b\u8cc7\u6599\u584a(a chunk of data), \u6216\u662f<code>null</code>\u3002\u800c\u9019\u4e9b\u8cc7\u6599\u584a(chunks)\u4e26\u4e0d\u662f\u4e32\u9023(concatenated)\u7684</li> <li>\u5728\u4e0a\u9762\u7684\u7bc4\u4f8b\u7a0b\u5f0f\u78bc\u4e2d,<code>while</code>\u8ff4\u5708(loop)\u662f\u5fc5\u8981(necessary)\u5730\u7528\u4f86\u6d88\u8017(consume)\u7576\u524d(currently)<code>buffer</code>(\u7de9\u5b58)\u4e2d\u7684\u6240\u6709\u8cc7\u6599(data)</li> <li>\u7576\u8b80\u53d6(reading)\u4e00\u500b\u6bd4\u8f03\u5927(large)\u7684\u6a94\u6848(file)\u6642,<code>readable.read()</code>\u65b9\u6cd5\u5c07\u6703\u56de\u50b3<code>null</code>,\u5230\u76ee\u524d\u70ba\u6b62(so far)\u5df2\u7d93\u6d88\u8017(consumed)\u6389\u6240\u6709\u7684\u7de9\u5b58(buffered)\u5167\u5bb9(content)\u4e86,\u4f46\u662f\u4ecd\u7136\u6709\u66f4\u591a\u8cc7\u6599\u5c1a\u672a\u88ab\u7de9\u5b58(buffered)\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b(In this case),\u7576\u4ecd\u7136\u6709\u66f4\u591a\u8cc7\u6599\u9084\u5728<code>buffer</code>(\u7de9\u5b58)\u6642,\u5c31\u6703\u767c\u51fa(emitted)\u4e00\u500b\u65b0(new)\u7684readable\u4e8b\u4ef6(event)\u3002\u6700\u5f8c(Finally),\u7576\u6c92\u6709\u66f4\u591a(no more)\u7684\u8cc7\u6599(data)\u8981\u50b3\u4f86\u6642,\u5c31\u6703\u767c\u51fa(emitted)end\u4e8b\u4ef6(event)</li> <li>\u56e0\u6b64(Therefore),\u82e5\u8981\u5f9e\u53ef\u8b80\u53d6\u4e32\u6d41(<code>readable</code>)\u4e2d\u8b80\u53d6(read)\u4e00\u500b\u6a94\u6848(file)\u7684\u5168\u90e8\u5167\u5bb9(whole contents)\u7684\u8a71,\u8de8\u591a\u500breadable\u4e8b\u4ef6(event)\u4f86\u6536\u96c6(collect)\u8cc7\u6599\u584a(chunks)\u662f\u5fc5\u8981(necessary)\u7684 JavaScript<pre><code>const chunks = [];\n\nreadable.on('readable', () =&gt; {\n  let chunk;\n  while (null !== (chunk = readable.read())) {\n    chunks.push(chunk);\n  }\n});\n\nreadable.on('end', () =&gt; {\n  const content = chunks.join('');\n});\n</code></pre></li> <li>\u5728\u7269\u4ef6\u6a21\u5f0f(object mode)\u4e2d\u7684\u53ef\u8b80\u53d6\u4e32\u6d41(<code>Readable</code>)\u5c07\u7e3d\u662f\u5728\u547c\u53eb(call)<code>readable.read(size)</code>\u65b9\u6cd5\u6642,\u56de\u50b3(return)\u55ae\u4e00(single)\u500b\u9805\u76ee(item),\u800c\u4e0d\u7ba1(regardless of)\u6b64\u65b9\u6cd5\u4e2d\u7684<code>size</code>\u53c3\u6578(argument)\u503c\u662f\u88ab\u6307\u5b9a\u70ba\u591a\u5c11</li> <li>\u82e5<code>readable.read()</code>\u65b9\u6cd5(method)\u56de\u50b3(returns)\u4e00\u500b\u8cc7\u6599\u584a(a chunk of data),\u90a3\u9ebc\u5c31\u6703\u767c\u51fa(emitted)\u4e00\u500bdata\u4e8b\u4ef6(event)</li> <li>\u82e5\u5728end\u4e8b\u4ef6(event)\u5df2\u88ab\u767c\u51fa(emitted)\u4e4b\u5f8c\u624d\u547c\u53ebstream.read(size)\u65b9\u6cd5(method)\u7684\u8a71,\u5c07\u6703\u56de\u50b3(return)<code>null</code>\u3002\u9019\u9ebc\u505a\u4e26\u4e0d\u6703\u5f15\u767c(raised)\u904b\u884c\u932f\u8aa4(<code>runtime error</code>)</li> </ul> </li> <li>readable.resume()<ul> <li>Returns: (this)</li> <li><code>readable.resume()</code>\u65b9\u6cd5(method)\u5c07\u6703\u5c0e\u81f4\u660e\u78ba(explicitly)\u5730\u986f\u793a\u66ab\u505c(paused)\u7684\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u6703 \u7e7c\u7e8c (resume)\u767c\u51fa(emitting)data\u4e8b\u4ef6(events),\u4e26\u5c07<code>stream</code>(\u4e32\u6d41)\u5207\u63db(switching)\u5230\u6d41\u52d5\u6a21\u5f0f(<code>flowing</code> mode)\u4e2d</li> <li><code>readable.resume()</code>\u65b9\u6cd5(method)\u53ef\u4ee5\u88ab\u7528\u4f86(used to)\u5b8c\u5168(fully)\u5730\u6d88\u8017(consume)\u5f9e<code>stream</code>(\u4e32\u6d41)\u50b3\u905e\u904e\u4f86\u7684\u8cc7\u6599(data),\u800c\u7121\u9700(without)\u5be6\u969b(actually)\u5730\u8655\u7406(processing)\u4efb\u4f55\u90a3\u6a23\u7684\u8cc7\u6599(any of that data)   JavaScript<pre><code>getReadableStreamSomehow()\n  .resume()\n  .on('end', () =&gt; {\n    console.log('Reached the end, but did not read anything.');\n  });\n</code></pre></li> <li>\u88dc\u5145: \u82e5\u6709\u53ef\u8b80\u53d6\u4e32\u6d41(readable stream)\u4e8b\u4ef6\u76e3\u807d\u5668(event listener)\u7684\u8a71,<code>readable.resume()</code>\u65b9\u6cd5(method)\u5c07\u6703 \u7121\u6548 (no effect)</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"programming_language/nodejs/#_2","title":"\u53c3\u8003\u8cc7\u6599\u4f86\u6e90","text":""},{"location":"programming_language/nodejs/#_3","title":"\u5b98\u65b9\u6587\u4ef6","text":"<ul> <li>Node.js</li> <li>Node Package Manager(NPM)</li> <li>Yarn</li> <li>Node Version Manager(NVM)</li> <li>Express.js</li> </ul>"},{"location":"programming_language/nodejs/#_4","title":"\u7db2\u8def\u6587\u7ae0","text":"<ul> <li>Understanding Worker Threads in Node.js</li> <li>\u6df1\u5165\u7406\u89e3 Node.js \u7684\u8a2d\u8a08\u932f\u8aa4 \u2014 \u5f9e Ryan Dahl \u7684\u6f14\u8b1b\u4e2d\u53cd\u601d</li> <li>\u5e38\u898b\u7684\u4e94\u500b\u958b\u6e90\u5c08\u6848\u6388\u6b0a\u689d\u6b3e,\u4f7f\u7528\u8edf\u9ad4\u66f4\u81ea\u7531</li> </ul>"},{"location":"programming_language/nodejs/#_5","title":"\u7db2\u8def\u5f71\u7247","text":"<ul> <li>10 Things I Regret About Node.js - Ryan Dahl - JSConf EU</li> </ul>"},{"location":"version_control/git/","title":"Git Learn","text":""},{"location":"version_control/git/#git","title":"\u81ea\u4e3b\u5b78\u7fd2 Git \u7684\u89c0\u5ff5\u548c\u6307\u4ee4\u5f8c\u505a\u7684\u7d71\u6574 &amp; \u5b78\u7fd2\u7b46\u8a18","text":"\u76ee\u9304<ul> <li>Git Learn<ul> <li>\u81ea\u4e3b\u5b78\u7fd2 Git \u7684\u89c0\u5ff5\u548c\u6307\u4ee4\u5f8c\u505a\u7684\u7d71\u6574 &amp; \u5b78\u7fd2\u7b46\u8a18<ul> <li>\u5b89\u88dd\u65b9\u5f0f<ul> <li>Windows\u7cfb\u7d71</li> <li>MacOS\u7cfb\u7d71</li> <li>Linux\u7cfb\u7d71</li> </ul> </li> <li>\u8a2d\u5b9aGit</li> <li>Git \u57fa\u790e\u5e38\u7528\u6307\u4ee4<ul> <li>\u521d\u59cb\u5316\u8a72\u76ee\u9304,\u4e3b\u8981\u76ee\u7684\u662f\u8b93Git\u958b\u59cb\u5c0d\u9019\u500b\u76ee\u9304\u9032\u884c\u7248\u672c\u63a7\u5236</li> <li>\u628a\u9019\u500b\u6a94\u6848\u4ea4\u7d66Git\u4f86\u63a7\u7ba1</li> <li>\u628a\u66ab\u5b58\u5340(staging area)\u7684\u6a94\u6848\u63d0\u4ea4\u5230\u5009\u5eab\u5b58\u6a94</li> <li>\u60f3\u6aa2\u8996Git\u7d00\u9304</li> <li>\u522a\u9664Git\u6a94\u6848</li> <li>\u8b8a\u66f4\u6a94\u540d</li> <li>\u4fee\u6539Commit\u7d00\u9304</li> <li>\u5982\u679c\u6709\u7279\u5b9a\u6a94\u6848\u4e0d\u60f3\u653e\u5728Git\u88e1\u9762\u4e00\u8d77\u5099\u4efd\u6216\u662f\u4e0a\u50b3\u5230Git Server\u7684\u8a71,\u4f8b\u5982:\u8cc7\u6599\u5eab\u5bc6\u78bc,\u96f2\u7aef\u4f3a\u670d\u5668\u7684\u91d1\u9470...\u53ef\u4ee5\u52a0\u5165 .gitignore\u4e2d</li> <li>\u6aa2\u8996\u7279\u5b9a\u6a94\u6848\u7684commit\u7d00\u9304</li> <li>\u60f3\u8981\u77e5\u9053\u67d0\u500b\u6a94\u6848\u7684\u67d0\u4e00\u884c\u662f\u8ab0\u5beb\u7684</li> <li>\u5728\u5de5\u4f5c\u76ee\u9304(working directory)\u60f3\u8981\u5fa9\u539f\u4e0d\u5c0f\u5fc3\u900f\u904e rm \u6307\u4ee4\u522a\u9664\u7684\u6a94\u6848</li> <li>\u5982\u679c\u60f3\u91cd\u65b0\u7de8\u8f2f\u525b\u624d\u7684commit</li> <li>\u65b0\u589eTag\u7269\u4ef6\u5230Commmit\u7269\u4ef6</li> <li>\u5206\u652f(branch)\u64cd\u4f5c</li> <li>\u8a72\u5982\u4f55\u56de\u5fa9\u5230\u4e0a\u4e00\u6b21commit\u7d00\u9304\u7684\u72c0\u614b?</li> </ul> </li> <li>\u89c0\u5ff5\u4ecb\u7d39<ul> <li>Git \u5176\u5be6\u662f\u4e00\u7a2e\u5206\u6563\u5f0f\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7d71</li> <li>Git \u7684\u512a\u9ede</li> <li>Git \u662f\u7528\u5feb\u7167(snapshot)\u5728\u505a\u7248\u672c\u63a7\u5236\u7684</li> <li>Git \u7684\u56db\u5927\u7269\u4ef6(Blob,Tree,Commit,Tag)\u89c0\u5ff5\u4ecb\u7d39</li> <li>$ git count-objects: \u53ef\u4ee5\u6aa2\u8996\u76ee\u524d\u6709\u591a\u5c11\u7269\u4ef6\u548c\u7528\u6389\u591a\u5c11\u5132\u5b58\u7a7a\u9593</li> <li>\u5728\u4f7f\u7528Git\u6642,\u6307\u4ee4\u8981\u5728\u6b63\u78ba\u7684\u76ee\u9304\u4e0b\u624d\u80fd\u6b63\u5e38\u904b\u4f5c</li> <li>\u5728Git\u8853\u8a9e\u4e2d,\u66ab\u5b58\u5340(staging area)=\u7d22\u5f15(index)</li> <li>Git \u4e16\u754c\u88e1\u7684\u7684\u4e09\u5927\u5340\u57df---\u5de5\u4f5c\u76ee\u9304(working directory),\u66ab\u5b58\u5340(staging area),\u5132\u5b58\u5eab(repository)</li> <li>\u70ba\u4ec0\u9ebc\u6bcf\u6b21\u90fd\u8981\u5148$ git add \u518d $ git commit</li> <li>Git\u7269\u4ef6\u7684id\u662f\u600e\u9ebc\u8a08\u7b97\u51fa\u4f86\u7684? (SHA-1\u6f14\u7b97\u6cd5)</li> <li>HEAD\u662f\u4ec0\u9ebc?</li> <li>ORIG_HEAD\u662f\u4ec0\u9ebc?</li> <li>\u5206\u652f(branch)\u662f\u4ec0\u9ebc?</li> <li>Detached HEAD (\u65b7\u982d) \u662f\u4ec0\u9ebc?</li> <li>Tag (\u6a19\u7c64) \u662f\u4ec0\u9ebc?</li> <li>Git\u7684\u8cc7\u6e90\u56de\u6536\u6a5f\u5236($ git gc)\u662f\u600e\u9ebc\u904b\u4f5c\u7684\u5462?</li> </ul> </li> <li>\u89c0\u5ff5\u91d0\u6e05<ul> <li>Git\u7121\u6cd5\u63a7\u7ba1 \u7a7a\u76ee\u9304/</li> <li>$ git rm --cached V.S. .gitignore \u6bd4\u8f03</li> <li>\u5728\u5c08\u6848\u4e2d\u7684\u6574\u500b.git/ \u76ee\u9304\u662fGit\u7248\u63a7\u7684\u6838\u5fc3\u6a94\u6848</li> <li>$ git reset \u662f\u7528\u4f86\"\u524d\u5f80\"\u5230\u6307\u5b9a\u7684Commit\u7269\u4ef6\u4e0a\u7684</li> <li>Git\u56db\u5927\u7269\u4ef6(Blob,Tree,Commit,Tag)\u5f7c\u6b64\u4e4b\u9593\u5176\u5be6\u662f\u5e73\u884c\u95dc\u4fc2</li> <li>Git\u5176\u5be6\u4e0d\u662f\u5728\u505a\u5dee\u7570\u5099\u4efd,\u800c\u662f\u5728\u70ba\u7576\u6642\u7684\u5c08\u6848\u5efa\u7acb\u5feb\u7167(snapshot)</li> <li>\u628acat\u5206\u652f\u5408\u4f75\u5230dog\u5206\u652f&amp;\u628adog\u5206\u652f\u5408\u4f75\u5230cat\u5206\u652f\u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?</li> <li>\u5408\u4f75\u5206\u652f\u5176\u5be6\u4e0d\u662f\u771f\u7684\u5728\u5408\u4f75\u5206\u652f!</li> <li>Reset\u3001Rebase\u3001Revert \u4e09\u500b\u6307\u4ee4\u6709\u4ec0\u9ebc\u5dee\u5225?</li> <li>\u6a19\u7c64(Tag)\u8ddf\u5206\u652f(branch)\u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?</li> <li>Unreachable\u7269\u4ef6 &amp; Dangling\u7269\u4ef6 \u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?</li> <li>$ git log &amp; git reflog \u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?</li> </ul> </li> <li>\u5be6\u6230\u60c5\u5883\u984c<ul> <li>\u5982\u679c\u5728git add\u4e4b\u5f8c\u53c8\u4fee\u6539\u4e86\u90a3\u500b\u6a94\u6848\u7684\u5167\u5bb9\u5462?</li> <li>\u5982\u679c\u4e0d\u5c0f\u5fc3\u4f7f\u7528$ git reset --hard \u6a21\u5f0f,\u80fd\u6551\u56de\u4f86\u55ce?</li> <li>\u5982\u679c\u9019\u6b21\u53ea\u60f3commit\u4e00\u500b\u6a94\u6848\u4e2d\u7684\u90e8\u4efd\u5167\u5bb9\u7684\u8a71,\u8a72\u600e\u9ebc\u505a\u5462?</li> <li>\u5982\u679c\u4fee\u6539\u5c08\u6848\u7684\u67d0\u4e9b\u6a94\u6848\u5230\u4e00\u534a,\u537b\u4e0d\u5c0f\u5fc3\u5148\u5207\u63db\u5230\u5225\u7684\u5206\u652f(branch),\u8a72\u600e\u9ebc\u8fa6?</li> <li>\u5982\u679c\u4e0d\u5c0f\u5fc3\u628a\u9084\u6c92\u5408\u4f75\u7684\u5206\u652f\u522a\u6389\u4e86,\u8a72\u600e\u9ebc\u633d\u6551?</li> <li>\u5982\u679c\u60f3\u5f9e\u904e\u53bb\u7684\u67d0\u6b21commit\u7d00\u9304\u518d\u9577\u4e00\u500b\u65b0\u7684\u5206\u652f(branch)\u51fa\u4f86,\u8a72\u5982\u4f55\u505a\u5462?</li> <li>\u7576\u5169\u500b\u5206\u652f\u90fd\u7de8\u8f2f\u4e86\u540c\u4e00\u500b\u6a94\u6848(both modified \u72c0\u614b),\u9020\u6210\u5408\u4f75\u5206\u652f\u6642\u767c\u751f\u885d\u7a81\u4e86,\u8a72\u600e\u9ebc\u89e3\u6c7a\u5462?</li> <li>\u76ee\u524d\u7684\u5de5\u4f5c\u505a\u5230\u4e00\u534a,\u5982\u679c\u8981\u81e8\u6642\u5207\u63db\u5230\u5225\u7684\u4efb\u52d9,\u8a72\u600e\u9ebc\u505a\u5462?</li> <li>\u5982\u679c\u4e0d\u5c0f\u5fc3\u5c07\u6a5f\u654f\u8cc7\u6599(ex:\u5e33\u865f\u3001\u5bc6\u78bc)\u653e\u5728Git\u88e1,\u60f3\u628a\u5b83\u522a\u6389,\u8a72\u600e\u9ebc\u505a\u5462?</li> <li>\u53ef\u4ee5\u53ea\u53d6\u7528\u67d0\u500b\u5206\u652f\u7684\u5176\u4e2d\u67d0\u5e7e\u500bcommit\u55ce?</li> <li>\u5982\u4f55\u628a\u4e00\u500b\u6a94\u6848\u5f9eGit\u7248\u63a7\u4e2d\u771f\u6b63\u7684\u79fb\u9664\u6389\u5462?</li> </ul> </li> <li>\u9060\u7aef\u5171\u540c\u5354\u4f5c\u7bc7---\u4ee5 GitHub \u70ba\u4f8b<ul> <li>GitHub \u57fa\u790e\u4f7f\u7528\u64cd\u4f5c\u8aaa\u660e</li> <li>\u65b0\u5efa\u4e00\u500bGitHub repository,\u4e26\u63a8\u9001\u672c\u5730\u7aefrepository\u5230GitHub\u4e0a</li> <li>\u5f9e\u9060\u7aefrepository\u5229\u7528Pull\u4e0b\u8f09\u4e26\u66f4\u65b0</li> <li>\u70ba\u4ec0\u9ebc\u6709\u6642\u5019\u6703\u63a8\u9001(Push)\u4e0d\u4e0a\u53bb\u9060\u7aefrepository\u5462?</li> <li>\u5f9e\u4f3a\u670d\u5668\u4e0a\u8907\u88fd\u9060\u7aefrepository\u4e0b\u4f86</li> <li>Clone(\u8907\u88fd) \u548c Pull(\u62c9\u4e0b\u4f86\u66f4\u65b0) \u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?</li> <li>\u5229\u7528Pull Request\u4f86\u8ddf\u5176\u5b83\u958b\u767c\u8005\u7684\u958b\u6e90\u5c08\u6848\u505a\u4e92\u52d5</li> <li>\u5982\u4f55\u8ddf\u4e0a\u7576\u521dFork\u7684\u5c08\u6848\u7684\u9032\u5ea6\u5462?</li> <li>\u5982\u4f55\u522a\u9664\u9060\u7aef\u5206\u652f\u5462?</li> <li>\u4ec0\u9ebc\u6642\u6a5f\u9069\u5408\u7528$ git push -f \u4f86\u5f37\u5236\u63a8\u9001(Push)\u4e0a\u53bb\u5230\u9060\u7aefrepository\u5462?</li> <li>\u5982\u4f55\u900f\u904e\u66f4\u65b0\u6a94(Patch)\u4f86\u66f4\u65b0\u672c\u6a5f\u7aef\u7684repository\u7684\u5167\u5bb9\u5462?</li> </ul> </li> <li>Git \u5e38\u898b\u7684\u5718\u968a\u5de5\u4f5c\u6d41\u7a0b &amp; \u898f\u7bc4<ul> <li>Git Flow\u4ecb\u7d39</li> <li>GitHub Flow\u4ecb\u7d39</li> <li>GitLab Flow\u4ecb\u7d39</li> <li>Git Flow &amp; GitHub Flow &amp; GitLab Flow \u4e09\u8005\u7684\u6bd4\u8f03</li> </ul> </li> <li>\u89c0\u5ff5\u88dc\u5145<ul> <li>\u7d42\u7aef\u6a5f(Terminal)\u662f\u4ec0\u9ebc?</li> <li>Vim \u662fGit\u7684\u9810\u8a2d\u7de8\u8f2f\u5668,Vim\u4e3b\u8981\u5e38\u7528\u7684\u5169\u7a2e\u6a21\u5f0f</li> <li>SHA-1(\u5b89\u5168\u6563\u5217\u6f14\u7b97\u6cd5) \u4ecb\u7d39</li> </ul> </li> <li>\u53c3\u8003\u8cc7\u6599\u4f86\u6e90<ul> <li>\u66f8\u7c4d</li> <li>Medium</li> <li>iT\u90a6\u5e6b\u5fd9</li> <li>\u7df4\u7fd2\u5834</li> <li>\u514d\u8cbb\u7dda\u4e0a\u5b78\u7fd2\u8cc7\u6e90</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"version_control/git/#_1","title":"\u5b89\u88dd\u65b9\u5f0f","text":""},{"location":"version_control/git/#windows","title":"Windows\u7cfb\u7d71","text":"<ul> <li>\u9023\u7d50: https://git-scm.com/download/win</li> <li>\u5b89\u88dd\u5b8c\u5f8c,\u4f7f\u7528Git Bash\u5c31\u53ef\u4ee5\u64cd\u4f5cGit\u4e86</li> <li>$ <code>which git</code>    // /mingw/bin/git</li> <li>$ <code>git --version</code>   // git version 2.28.0.windows.1</li> <li>GUI client\u63a8\u85a6: SourceTree, GitHub Desktop<ul> <li>\u4e0b\u8f09\u9023\u7d50: https://git-scm.com/downloads/guis</li> </ul> </li> <li>\u88dc\u5145: Git Bash\u4e0d\u540c\u65bcWindows\u5167\u5efa\u7684\"\u547d\u4ee4\u63d0\u793a\u5b57\u5143\",\u5b83\u672c\u8eab\u6a21\u64ec\u4e86Linux\u7684 Bash</li> </ul>"},{"location":"version_control/git/#macos","title":"MacOS\u7cfb\u7d71","text":"<ul> <li>\u9023\u7d50: https://git-scm.com/download/mac</li> <li>\u6216\u662f\u5229\u7528Homebrew\u5b89\u88dd</li> <li>$ <code>brew install git</code></li> <li>\u88dc\u5145: Homebrew\u662f\u4e00\u500bMacOS\u5c08\u5c6c\u7684\u5957\u4ef6\u7ba1\u7406\u5305\u5de5\u5177,\u6709\u9ede\u50cf\u662fLinux\u7684apt-get\u4e4b\u985e\u7684\u5b89\u88dd\u5de5\u5177,\u901a\u5e38\u53ea\u8981\u4e00\u884c\u6307\u4ee4\u5c31\u53ef\u4ee5\u5b8c\u6210\u4e0b\u8f09.\u7de8\u8b6f.\u5b89\u88dd</li> <li>GUI client\u63a8\u85a6: SourceTree, GitHub Desktop<ul> <li>\u4e0b\u8f09\u9023\u7d50: https://git-scm.com/downloads/guis</li> </ul> </li> </ul>"},{"location":"version_control/git/#linux","title":"Linux\u7cfb\u7d71","text":"<ul> <li>\u9023\u7d50: https://git-scm.com/download/linux</li> <li>\u5229\u7528apt-get\u5b89\u88dd</li> <li>$ <code>sudo apt-get install git</code>    // \u5728Linux\u7cfb\u7d71\u4e2d\u8981\u5b89\u88dd\u8edf\u9ad4\u8981\u5148\u5207\u63db\u6210root\u6b0a\u9650</li> <li>GUI client\u63a8\u85a6: gitk<ul> <li>$ <code>sudo apt-get install gitk</code></li> </ul> </li> </ul>"},{"location":"version_control/git/#git_1","title":"\u8a2d\u5b9aGit","text":"<p><code>git config</code> - Get and set repository or global options <code>git log</code> - Show commit logs</p> <ul> <li>\u6240\u6709Git\u76f8\u95dc\u7684\u8a2d\u5b9a\u90fd\u6703\u5132\u5b58\u5728 <code>~/.gitconfig</code> \u9019\u500b\u6a94\u6848\u88e1</li> <li>\u8a2d\u5b9a\u4f7f\u7528\u8005\u7684Email\uff06username</li> <li>$ <code>git config --global user.name \"Hans-Tsai\"</code></li> <li>$ <code>git config --global user.email \"lgs840522@gmail.com\"</code></li> <li>\u6aa2\u8996\u76ee\u524d\u7684\u8a2d\u5b9a</li> <li>$ <code>cat ~/.gitconfig</code></li> <li>$ <code>git config --list</code></li> <li>\u8a2d\u5b9aGit\u8981\u4f7f\u7528\u7684\u7de8\u8f2f\u5668(\u9810\u8a2d\u662f\u4f7f\u7528Vim)</li> <li>$ <code>git config --global core.editor emacs</code></li> <li>\u8a2d\u5b9aGit\u5ba2\u88fd\u5316\u7e2e\u5beb\u6307\u4ee4</li> <li>$ <code>git config --global alias.co checkout</code> </li> <li>$ <code>git config --global alias.br branch</code></li> <li>$ <code>git config --global alias.st status</code></li> <li>$ <code>git config --global alias.ls 'log --graph --pretty=format:\"%h &lt;%an&gt; %ar %s\"'</code></li> </ul>"},{"location":"version_control/git/#git_2","title":"Git \u57fa\u790e\u5e38\u7528\u6307\u4ee4","text":"<p><code>git init</code> - Create an empty Git repository or reinitialize an existing one <code>git status</code> - Show the working tree status <code>git add</code> - Add file contents to the index <code>git commit</code> - Record changes to the repository <code>git log</code> - Show commit logs <code>git rm</code> - Remove files from the working tree and from the index <code>git mv</code> - Move or rename a file, a directory, or a symlink <code>gitignore</code> - Specifies intentionally untracked files to ignore <code>git clean</code> - Remove untracked files from the working tree <code>git blame</code> - Show what revision and author last modified each line of a file <code>git checkout</code> - Switch branches or restore working tree files <code>git switch</code> - Switch branches <code>git restore</code> - Restore working tree files <code>git reset</code> - Reset current HEAD to the specified state <code>git reflog</code> - Manage reflog information <code>git tag</code> - Create, list, delete or verify a tag object signed with GPG <code>git merge</code> - Join two or more development histories together <code>git rebase</code> - Reapply commits on top of another base tip <code>git revert</code> - Revert some existing commits</p>"},{"location":"version_control/git/#git_3","title":"\u521d\u59cb\u5316\u8a72\u76ee\u9304,\u4e3b\u8981\u76ee\u7684\u662f\u8b93Git\u958b\u59cb\u5c0d\u9019\u500b\u76ee\u9304\u9032\u884c\u7248\u672c\u63a7\u5236","text":"<ul> <li>$ <code>git init</code></li> <li>\u6703\u5728\u8a72\u76ee\u9304\u88e1\u9762\u5efa\u7acb\u4e00\u500b <code>.git/</code> \u96b1\u85cf\u6a94\u76ee\u9304,\u6574\u500bGit\u7684\u7cbe\u83ef\u90fd\u6703\u5728\u9019\u500b\u76ee\u9304\u88e1\u9762</li> <li>\u5982\u679c\u8a72\u76ee\u9304\u4e0d\u60f3\u518d\u88abGit\u505a\u7248\u672c\u63a7\u5236,\u53ea\u8981\u5c07<code>.git/</code>\u76ee\u9304\u6574\u500b\u522a\u9664\u5c31\u53ef\u4ee5 </li> <li>$ <code>rm -rf .git/</code> </li> <li>\u6ce8\u610f:\u6574\u500b\u5c08\u6848\u76ee\u9304\u88e1,\u4ec0\u9ebc\u6a94\u6848\u6216\u76ee\u9304\u522a\u4e86\u90fd\u6551\u5f97\u56de\u4f86,\u4f46 <code>.git/</code> \u76ee\u9304\u53ea\u8981\u522a\u4e86\u5c31\u6c92\u8fa6\u6cd5\u4e86 !</li> <li>\u67e5\u8a62\u73fe\u5728\u9019\u500b\u76ee\u9304\u7684\"\u72c0\u614b\"</li> <li>$ <code>git status</code></li> <li>Untracked files =&gt; \u4ee3\u8868\u9019\u500b\u6a94\u6848\u5c1a\u672a\u88ab\u52a0\u5230Git\u7248\u63a7\u7cfb\u7d71\u88e1,\u9084\u6c92\u958b\u59cb\u6b63\u5f0f\u88ab\"\u8ffd\u8e64\",\u5b83\u53ea\u662f\u525b\u525b\u624d\u52a0\u5165\u5230\u9019\u500b\u76ee\u9304\u88e1\u800c\u5df2</li> <li></li> </ul>"},{"location":"version_control/git/#git_4","title":"\u628a\u9019\u500b\u6a94\u6848\u4ea4\u7d66Git\u4f86\u63a7\u7ba1","text":"<ul> <li>$ <code>git add welcome.html</code></li> <li>\u525b\u624d\u7684\u6a94\u6848 <code>welcome.html</code>\u5f9eUntracked\u8b8a\u6210new file\u72c0\u614b =&gt; \u8868\u793a\u9019\u500b\u6a94\u6848\u5df2\u7d93\u88ab\u5b89\u7f6e\u5230\u66ab\u5b58\u5340(Staging Area),\u7b49\u5f85\u7a0d\u5f8c\u8ddf\u5176\u4ed6\u6a94\u6848\u4e00\u8d77\u88ab\u5b58\u5230\u5132\u5b58\u5eab\u88e1\u9762</li> <li></li> <li>\u5982\u679c\u60f3\u5c07\u5168\u90e8\u6a94\u6848\u4e00\u53e3\u6c23\u52a0\u5165\u66ab\u5b58\u5340,\u53ef\u4ee5\u4f7f\u7528--all\u53c3\u6578;\u4e0d\u8ad6\u6a94\u6848\u72c0\u614b\u662fUntracked files\u6216\u662fChanges not staged for commit,\u90fd\u6703\u4e00\u53e3\u6c23\u8b8a\u6210Changes to committed<ul> <li>$ <code>git add --all</code> or $ <code>git add -A</code> </li> <li>$ <code>git add --all</code> =&gt;\u6703\u5c07\u6574\u500b\u5c08\u6848\u88e1\u7684\u5168\u90e8\u7570\u52d5\u6a94\u6848\u52a0\u5230\u66ab\u5b58\u5340,\u4e0d\u53d7\u9650\u9019\u500b\u6307\u4ee4\u5728\u54ea\u4e00\u5c64\u76ee\u9304\u57f7\u884c</li> <li>$ <code>git add .</code>=&gt;\u53ea\u6703\u628a\u7576\u524d\u57f7\u884ccommand\u7684\u90a3\u500b\u76ee\u9304\u4ee5\u53ca\u5b83\u7684\u5b50\u76ee\u9304\u7684\u7570\u52d5\u6a94\u6848\u52a0\u5230\u66ab\u5b58\u5340,\u6240\u4ee5\u5728\u54ea\u4e00\u5c64\u76ee\u9304\u57f7\u884c\u9019\u500bcommand\u5f88\u91cd\u8981</li> </ul> </li> <li>\u5982\u679c\u60f3\u8981\u53d6\u6d88\u525b\u525b\u52a0\u5165\u5230\u66ab\u5b58\u5340(Staging Area)\u7684\u6a94\u6848\u7684\u8a71,\u4e26\u5c07\u8a72\u6a94\u6848\u4e1f\u56de\u5230\u5de5\u4f5c\u76ee\u9304(Working Directory)\u4e2d,\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u6307\u4ee4<ul> <li>$ <code>git restore --staged &lt;\u8981\u5f9e\u66ab\u5b58\u5340\u9000\u56de\u5230\u5de5\u4f5c\u76ee\u9304\u7684\u6a94\u6848&gt;</code>: \u9019\u6a23\u5c31\u53ef\u4ee5\u628a\u525b\u525b\u52a0\u5165\u5230\u66ab\u5b58\u5340(Staging Area)\u7684\u6a94\u6848\u4e1f\u56de\u5230\u5de5\u4f5c\u76ee\u9304(Working Directory)\u4e2d</li> <li><code>-S</code> (=&gt; <code>--staged</code>): \u6307\u5b9a\u8981\u5f9e\u54ea\u500b\u4f4d\u7f6e(location)<code>\u56de\u5fa9</code>(Restore)\u5230\u5de5\u4f5c\u76ee\u9304(Working Directory)\u4e2d</li> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#staging-area","title":"\u628a\u66ab\u5b58\u5340(staging area)\u7684\u6a94\u6848\u63d0\u4ea4\u5230\u5009\u5eab\u5b58\u6a94","text":"<ul> <li>$ <code>git commit -m \"git commit\u7df4\u7fd2\"</code></li> <li>-m = (--messge)\u53c3\u6578:\u4ee3\u8868\u5728\u9019\u6b21commit\u505a\u4e86\u4ec0\u9ebc\u4e8b\u60c5\u7684\u8aaa\u660e\u5b57\u4e32,\u4e2d\u82f1\u6587\u7686\u53ef,\u8a00\u7c21\u610f\u8cc5\u5c31\u597d; $ <code>git commit</code>\u9810\u8a2d-m\u53c3\u6578\u662f\u5fc5\u586b\u7684</li> <li></li> <li>\u53ef\u4ee5\u4e0d\u7528\u4e8c\u6bb5\u5f0fcommit,\u4e5f\u53ef\u4ee5\u7528$ <code>git commit -a -m \"update content\"</code> \u4f86\u9054\u5230$ <code>git add</code> <ul> <li>$ <code>git commit -m</code></li> </ul> </li> <li>Git\u6bcf\u6b21commit\u90fd\u53ea\u6703\u8655\u7406\u66ab\u5b58\u5340(staging area)\u88e1\u7684\u5167\u5bb9,\u4e5f\u5c31\u662f\u8aaa,\u5982\u679c\u5728\u57f7\u884c $ <code>git commit</code> \u4e4b\u524d\u9084\u6c92\u88ab\u52a0\u5230\u66ab\u5b58\u5340\u88e1\u7684\u6a94\u6848,\u5c31\u4e0d\u6703\u88abcommit\u5230\u5132\u5b58\u5eab\u4e86</li> <li>\u63d0\u9192:\u8981\u5b8c\u6210commit\u624d\u7b97\u662f\u5b8c\u6210\u6574\u500b\u6d41\u7a0b\u5594!</li> </ul>"},{"location":"version_control/git/#git_5","title":"\u60f3\u6aa2\u8996Git\u7d00\u9304","text":"<ul> <li>\u4f7f\u7528$ <code>git log</code>\u6307\u4ee4,\u8d8a\u65b0\u7684\u8cc7\u8a0a\u6703\u5728\u8d8a\u4e0a\u9762,\u4e26\u6703\u5f97\u5230\u4ee5\u4e0b\u4e09\u500b\u8cc7\u8a0a</li> <li>Commit\u4f5c\u8005\u662f\u8ab0? =&gt; \u4eba\u662f\u8ab0\u6bba\u7684?</li> <li>\u4ec0\u9ebc\u6642\u5019commit\u7684? =&gt; \u4ec0\u9ebc\u6642\u5019\u6bba\u7684?</li> <li>\u6bcf\u6b21\u7684commit\u5927\u6982\u505a\u4e86\u54ea\u4e9b\u4e8b? =&gt; \u600e\u9ebc\u6bba\u7684?</li> <li></li> <li>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u53c3\u6578\u5c07$ <code>git log</code>\u8f38\u51fa\u6210\u4e0d\u540c\u7684\u5f62\u5f0f<ul> <li>$ <code>git log --oneline --graph</code> </li> <li><code>--oneline</code>:\u6bcf\u500bcommit\u7269\u4ef6\u50c5\u986f\u793a\u6210\u4e00\u884c</li> <li><code>--graph</code>:\u7528\u5716\u8868\u4f86\u8868\u793acommit\u7269\u4ef6\u4e4b\u9593\u7684\u7dda\u6027\u95dc\u4fc2</li> <li></li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e$ <code>git log</code>\u5c0b\u627e\u7279\u5b9aauthor\u7684commit\u7269\u4ef6<ul> <li>$ <code>git log --oneline --author=\"Hans\"</code></li> <li>\u4f5c\u8005(author)\u662f\u6700\u521d\u4fee\u6539\u7684\u4eba</li> <li>\u63d0\u4ea4\u8005(committer)\u662f\u6700\u5f8c\u5957\u7528\u8a72\u5de5\u4f5c\u6210\u679c\u7684\u4eba</li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e$ <code>git log</code>\u5c0b\u627e\u7b26\u5408\u7279\u5b9a\u5b57\u4e32\u7684commit\"\u8a0a\u606f(-m)\"<ul> <li>$ <code>git log --oneline --grep=\"initial\"</code></li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e$ <code>git log</code>\u641c\u5c0b\u5728\u6240\u6709commit\u7269\u4ef6\u4e2d,\u6709\u54ea\u4e9b\u7b26\u5408\u7279\u5b9a\u689d\u4ef6\u7684<ul> <li>$ <code>git log -S \"Ruby\"</code></li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e$ <code>git log</code>\u642d\u914d\u53c3\u6578\u4f86\u67e5\u8a62\u7279\u5b9a\u6642\u9593\u5167\u7684commit\u7269\u4ef6<ul> <li>$ <code>git log --oneline --since \"9am\" --until \"12am\" --after=\"2017-01\"</code></li> <li><code>--since</code>:\"hham/pm\"</li> <li><code>--until</code>:\"hham/pm\"</li> <li><code>--after</code>:\"yyyy-mm\"</li> </ul> </li> </ul>"},{"location":"version_control/git/#git_6","title":"\u522a\u9664Git\u6a94\u6848","text":"<ul> <li>\u522a\u9664\u6a94\u6848\u5c0dGit\u4f86\u8aaa\u90fd\u662f\u4e00\u7a2e\"\u4fee\u6539\" </li> <li>\u53ef\u4ee5\u900f\u904e\u7cfb\u7d71\u6307\u4ee4\u522a\u9664\u6a94\u6848$ <code>rm welcome.html</code><ul> <li>\u9019\u6642\u5019\u7684\u6a94\u6848\u6703\u662fdeleted\u72c0\u614b</li> <li></li> <li>\u9084\u9700\u8981\u518d\u57f7\u884c$ <code>git add xxx.txt</code> \u624d\u6703\u5c07\u9019\u500b\"\u522a\u9664\"\u52a0\u5230\u66ab\u5b58\u5340</li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e$ <code>git rm welcome.html</code><ul> <li>$ <code>git rm</code> = <code>rm xxx.txt</code> + <code>git add xxx.txt</code></li> <li>$ <code>git rm</code> \u76f8\u7576\u65bc\u5148$ <code>rm</code>\u522a\u9664\u6a94\u6848\u5f8c\u518d$ <code>git add</code> \u52a0\u5165\u66ab\u5b58\u5340\u7684\u5169\u6bb5\u5f0f\u52d5\u4f5c</li> <li></li> <li>\u4e0d\u7ba1\u662f\u7cfb\u7d71\u6307\u4ee4\u7684$ <code>rm</code>\u6216\u662f$ <code>git rm</code>\u90fd\u771f\u7684\u6703\u628a\u6a94\u6848\u5f9e\u5de5\u4f5c\u76ee\u9304\u522a\u6389,\u4f46\u5982\u679c\u53ea\u662f\u4e0d\u60f3\u8b93\u6a94\u6848\u518d\u88abGit\u63a7\u7ba1,\u53ef\u4ee5\u52a0\u4e0a<code>--cached</code>\u53c3\u6578</li> <li>$ <code>git rm xxx.html --cached</code></li> <li><code>--cached</code>:\u4e0d\u6703\u771f\u7684\u5c07\u6a94\u6848\u522a\u9664\u6389,\u50c5\u5c07\u6a94\u6848\u812b\u96e2Git\u63a7\u7ba1,\u6210\u70baUntracked file</li> </ul> </li> </ul>"},{"location":"version_control/git/#_2","title":"\u8b8a\u66f4\u6a94\u540d","text":"<ul> <li>\u8ddf\"\u522a\u9664\"\u6a94\u6848\u4e00\u6a23,\u8b8a\u66f4\u6a94\u540d\u4e5f\u662f\u4e00\u7a2e\"\u4fee\u6539\"</li> <li></li> <li>\u96d6\u7136\u53ea\u662f\u900f\u904e\u7cfb\u7d71\u6307\u4ee4$ <code>rm</code> \u4f86\u6539\u540d,\u4f46\u5c0dGit\u4f86\u8aaa\u6703\u88ab\u8a8d\u70ba\u662f\u5169\u500b\u52d5\u4f5c,\u5f8c\u7e8c\u4ecd\u9808\u4f7f\u7528$ <code>git add world.html</code>\u6307\u4ee4\u4f86\u628a\u9019\u4e9b\u7570\u52d5\u52a0\u5165\u66ab\u5b58\u5340<ul> <li>\u522a\u9664<sub>~hello.html</sub>~\u6a94\u6848</li> <li>\u65b0\u589eworld.html\u6a94\u6848(\u8b8a\u6210Untracked file)</li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e$ <code>git mv world.html hans_world.html</code><ul> <li>$ <code>git mv</code> = <code>mv \u65b0\u6a94\u540d.html</code> + <code>git add \u65b0\u6a94\u540d.html</code></li> <li>$ <code>git mv</code> \u76f8\u7576\u65bc\u5148$ <code>mv</code>\u4fee\u6539\u6a94\u540d\u5f8c\u518d$ <code>git add</code> \u52a0\u5165\u66ab\u5b58\u5340\u7684\u5169\u6bb5\u5f0f\u52d5\u4f5c</li> <li></li> <li>\u9019\u6a23<code>hans_world.html</code>\u5c31\u6703\u76f4\u63a5\u8b8a\u6210<code>renamed file</code></li> </ul> </li> <li>\u5176\u5be6Git\u662f\u6839\u64da\u6a94\u6848\u7684\"\u5167\u5bb9\"\u53bb\u7b97\u51faSHA-1\u7684\u503c,\u6240\u4ee5Git\u4e0d\u662f\u5f88\u5728\u4e4e\u4f60\u7684\u6a94\u6848\u53eb\u4ec0\u9ebc\u540d\u7a31,\u53ea\u5728\u4e4e\u6a94\u6848\u7684\u5167\u5bb9\u662f\u4ec0\u9ebc\u3002\u6240\u4ee5\u7576\u9032\u884c\u66f4\u6539\u6a94\u540d\u7684\u6642\u5019,Git\u4e26\u6c92\u6709\u70ba\u6b64\u505a\u51fa\u4e00\u500b\u65b0\u7684Blob\u7269\u4ef6,\u800c\u50c5\u662f\u6307\u5411\u539f\u4f86\u820a\u7684\u90a3\u9846Blob\u7269\u4ef6;\u4f46\u56e0\u70ba\u6a94\u6848\u540d\u7a31\u6539\u8b8a\u4e86,\u6240\u4ee5\u6703\u505a\u51fa\u4e00\u9846\u65b0\u7684Tree\u7269\u4ef6\u5594!</li> </ul>"},{"location":"version_control/git/#commit","title":"\u4fee\u6539Commit\u7d00\u9304","text":"<ul> <li>\u60f3\u4fee\u6539commit\u7d00\u9304\u6709\u4ee5\u4e0b4\u7a2e\u65b9\u6cd5<ul> <li>\u628a<code>.git/</code>\u76ee\u9304\u6574\u500b\u522a\u9664 -&gt; \u4e0d\u5efa\u8b70,\u7b49\u65bc\u780d\u6389\u91cd\u7df4</li> <li>\u4f7f\u7528$ <code>git rebase</code> \u4f86\u4fee\u6539\u6b77\u53f2</li> <li>\u5148\u628acommit\u7528$ <code>git reset</code>\u62c6\u6389,\u6574\u7406\u5f8c\u518d\u91cd\u65b0commit</li> <li>\u4f7f\u7528<code>git commit --amend</code>\u53c3\u6578\u4f86\u4fee\u6539\u6700\u5f8c\u4e00\u6b21\u7684commit\u7269\u4ef6 -&gt; \u8f03\u63a8\u85a6\u6b64\u4f5c\u6cd5!</li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e$ <code>git commit --amend -m \"\u65b0\u7684commit message\"</code>\u4f86\u4fee\u6539commit\u7d00\u9304<ul> <li><code>--amend</code>:\u53ea\u80fd\u4fee\u6539\"\u6700\u8fd1\u4e00\u6b21\"\u7684commit\u7d00\u9304</li> <li></li> </ul> </li> <li>\u5982\u679c\u5728\u5b8c\u6210commit\u5f8c,\u537b\u767c\u73fe\u6709\u4e00\u500b\u6a94\u6848\u5fd8\u4e86\u52a0\u5230\u9019\u6b21\u7684commit\u4e2d,\u4f46\u4e0d\u60f3\u56e0\u70ba\u9019\u500b\u6a94\u6848\u518d\u91cd\u65b0\u767c\u9001\u4e00\u6b21commit,\u60f3\u628a\u9019\u500b\u6a94\u6848\u52a0\u5165\u6700\u8fd1\u4e00\u6b21commit,\u6b64\u6642\u6709\u5169\u500b\u505a\u6cd5<ul> <li>\u4f7f\u7528$ <code>git reset</code> \u628a\u6700\u5f8c\u4e00\u6b21\u7684commit\u62c6\u6389,\u52a0\u5165\u65b0\u6a94\u6848\u5f8c\u518d\u91cd\u65b0commit</li> <li>\u4f7f\u7528<code>--amend</code>\u53c3\u6578\u9032\u884ccommit</li> <li>$ \u5148 <code>git add pizza.html</code>,\u5c07Untracked file \u52a0\u5165\u8ffd\u8e64</li> <li>$ \u518d <code>git commit --amend --no-edit</code>,\u628a\u9019\u500b\u6a94\u6848\u4f75\u5165\u6700\u5f8c\u4e00\u6b21\u7684commit\u4e2d,\u800c\u5f8c\u9762\u7684<code>--no-edit</code>\u53c3\u6578\u5c31\u662f\u4e0d\u8981\u958b\u555fvim\u7de8\u8f2f\u8996\u7a97\u4f86\u7de8\u8f2fcommit message\u7684\u610f\u601d</li> <li></li> </ul> </li> <li>\u63d0\u9192:\u5373\u4fbf\"\u53ea\u662f\u4fee\u6539commit message\",\u4ecd\u7136\u6703\u7522\u751f\u65b0\u7684commit id,\u56e0\u70ba\u9019\u6a23\u5c0dGit\u4f86\u8aaacommit\u7269\u4ef6\u7684\u5167\u5bb9\u662f\u6709\"\u8b8a\u52d5\"\u7684,\u6240\u4ee5Git\u6703\u91cd\u65b0\u8a08\u7b97\u4e26\u7522\u751f\u4e00\u9846\u65b0\u7684Commit\u7269\u4ef6,\u4e5f\u5c31\u662f\u8aaa\u9019\u5176\u5be6\u7b97\u662f\u4e00\u6b21\u5168\u65b0\u7684commit</li> <li>\u5982\u679c\u60f3\u4fee\u6539\u66f4\u65e9\u7684commit\u7d00\u9304,\u5c31\u5fc5\u9808\u4f7f\u7528$ <code>git rebase</code> \u6307\u4ee4\u4e86<ul> <li>\u53ef\u53c3\u8003 \u5206\u652f(branch)\u64cd\u4f5c \u7684 $ <code>git rebase -i</code> \u7ae0\u7bc0 </li> </ul> </li> <li>\u5718\u968a\u958b\u767c\u5b88\u5247:\u5373\u4fbf\u53ea\u662f\u4fee\u6539commit message,\u4e0d\u7ba1\u5982\u4f55\u5b83\u5c31\u662f\u4fee\u6539\u4e86\u4e00\u6b21\u6b77\u53f2,\u6240\u4ee5\u8acb\u76e1\u91cf\"\u4e0d\u8981\"\u5728\u5df2\u7d93<code>push</code>\u51fa\u53bb\u4e4b\u5f8c\u518d\u4fee\u6539,\u5426\u5247\u53ef\u80fd\u6703\u9020\u6210\u5176\u4ed6\u4eba\u7684\u56f0\u64fe</li> </ul>"},{"location":"version_control/git/#gitgit-server-gitignore","title":"\u5982\u679c\u6709\u7279\u5b9a\u6a94\u6848\u4e0d\u60f3\u653e\u5728Git\u88e1\u9762\u4e00\u8d77\u5099\u4efd\u6216\u662f\u4e0a\u50b3\u5230Git Server\u7684\u8a71,\u4f8b\u5982:\u8cc7\u6599\u5eab\u5bc6\u78bc,\u96f2\u7aef\u4f3a\u670d\u5668\u7684\u91d1\u9470...\u53ef\u4ee5\u52a0\u5165 <code>.gitignore</code>\u4e2d","text":"<ul> <li>\u53ef\u4ee5\u5728\u5c08\u6848\u4e2d\u5efa\u7acb\u4e00\u500b <code>.gitignore</code> \u7684\u6a94\u6848,\u88e1\u9762\u53ef\u4ee5\u8a2d\u5b9a\u60f3\u8981\u5ffd\u7565\u7684\u898f\u5247</li> <li><code>.gitignore</code>\u53ea\u8981\u4e00\u88ab\u5efa\u7acb\u4e26\u7b26\u5408\u898f\u5247\u5c31\u6703\u751f\u6548,\u5373\u4f7f\u9019\u500b\u6a94\u6848\u9084\u6c92\u88abcommit\u6216\u662f\u9084\u6c92\u88abpush\u5230Git Server,\u9019\u8981\u4e00\u4f86\u6574\u500b\u5c08\u6848\u7684\u4eba\u90fd\u53ef\u4ee5\u5171\u4eab\u9019\u500b\"\u5ffd\u7565\u898f\u5247\"\u7684\u8a2d\u5b9a</li> <li>\u60f3\u67e5\u8a62\u5728\u4f7f\u2f64\u7684\u2f2f\u5177\u6216\u7a0b\u5f0f\u8a9e\u2f94\u901a\u5e38\u6703\u5ffd\u7565\u54ea\u4e9b\u6a94\u6848,\u53ef\u4ee5\u5230GitHub\u4e0a\u6709\u6574\u7406\u4e86\u2f00\u4efd\u5404\u7a2e\u7a0b\u5f0f\u8a9e\u2f94\u5e38\u2f92\u7684 <code>.gitignore</code> \u6a94\u6848<ul> <li>github/gitignore repository\u9023\u7d50:https://github.com/github/gitignore</li> </ul> </li> <li>\u53ef\u4ee5\u5229\u7528<code>-f</code>\u53c3\u6578,\u4f86\u7121\u8996 <code>.gitignore</code>\u7684\u5ffd\u7565,\u5f37\u5236\u5c07\u6a94\u6848\u52a0\u5165Git\u8ffd\u8e64\u7bc4\u570d\u4e2d<ul> <li>$ <code>git add -f xxx.tmp</code></li> <li></li> <li>\u63d0\u9192: <code>.gitignore</code> \u6a94\u6848\u8a2d\u5b9a\u7684\u898f\u5247,\u53ea\u5c0d\"\u5728\u898f\u5247\u8a2d\u5b9a\u4e4b\u5f8c\"\u7684\u6a94\u6848\u6709\u6548</li> </ul> </li> <li>\u60f3\u4e00\u6b21\u5c07\u88ab <code>.gitignore</code> \u5ffd\u7565\u7684\u6a94\u6848\u5011\u4e00\u6b21\u522a\u9664,\u53ef\u4ee5\u4f7f\u7528$ <code>git clean</code>\u4f86\u5b8c\u6210<ul> <li>$ <code>git clean</code> \u53ef\u4ee5\u5c07\u5de5\u4f5c\u76ee\u9304(working directory)\u4e2d\u7684\u6240\u6709Untracked files\u90fd\u4e00\u6b21\u522a\u9664</li> <li>$ <code>git clean -fX</code></li> <li>-f: \u5f37\u5236\u57f7\u884c</li> <li>-X: \u53ea\u79fb\u9664\u88abGit\u5ffd\u7565\u7684\u6a94\u6848(\u6709\u5728.gitignore\u4e2d\u63d0\u5230\u7684)</li> </ul> </li> </ul>"},{"location":"version_control/git/#commit_1","title":"\u6aa2\u8996\u7279\u5b9a\u6a94\u6848\u7684commit\u7d00\u9304","text":"<ul> <li>$ <code>git log -p xxx.html</code><ul> <li>-p: \u53ef\u4ee5\u66f4\u8a73\u7d30\u7684\u6aa2\u8996\u6bcf\u4e00\u6b21\u7684commit\u5230\u5e95\u505a\u4e86\u54ea\u4e9b\u4fee\u6539</li> <li>\u88dc\u5145: \u524d\u9762\u7684\"+\"\u662f\u65b0\u589e,\"-\"\u662f\u522a\u9664</li> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#_3","title":"\u60f3\u8981\u77e5\u9053\u67d0\u500b\u6a94\u6848\u7684\u67d0\u4e00\u884c\u662f\u8ab0\u5beb\u7684","text":"<ul> <li>$ <code>git blame xxx.html</code></li> <li>\u53ef\u4ee5\u8a73\u7d30\u5730\u770b\u51fa\u4f86\u6bcf\u4e00\u884c\u662f\u8ab0\u5728\u4ec0\u9ebc\u6642\u5019\u5beb\u7684</li> <li>\u6bcf\u4e00\u884c\u524d\u9762\u7684SHA-1\u503c\u5c31\u662f\u6bcf\u4e00\u500bCommit\u7269\u4ef6\u7684\u8b58\u5225\u4ee3\u78bc</li> <li></li> <li>$ <code>git blame -L xxx.html</code><ul> <li>-L ,: \u53ef\u4ee5\u53ea\u986f\u793a\u6307\u5b9a\u884c\u6578\u7684\u5167\u5bb9"},{"location":"version_control/git/#working-directory-rm","title":"\u5728\u5de5\u4f5c\u76ee\u9304(working directory)\u60f3\u8981\u5fa9\u539f\u4e0d\u5c0f\u5fc3\u900f\u904e <code>rm</code> \u6307\u4ee4\u522a\u9664\u7684\u6a94\u6848","text":"<ul> <li>$ <code>git checkout</code>\u53ef\u4ee5\u7528\u4f86 (\u5728Git <code>Version 2.23.0</code> \u4e4b\u5f8c)<ul> <li>\u5207\u63db\u5206\u652f(= $ <code>git switch</code>)</li> <li>\u6062\u5fa9\u5de5\u4f5c\u76ee\u9304(working directory)\u88e1\u7684\u6587\u4ef6(= $ <code>git restore</code>)</li> <li>\u7576$ <code>git checkout \"\u5206\u652f\u540d\u7a31\"</code> \u6642,\u5c31\u6703\u5207\u63db\u5230\u6307\u5b9a\u7684\u5206\u652f</li> <li>\u4f8b\u5982:$ <code>git checkout -b tiger</code>: \u5207\u63db\u5230<code>tiger</code>\u5206\u652f,\u5982\u679c\u6c92\u6709\u8a72\u5206\u652f\u7684\u8a71,\u5c31\u65b0\u589e\u4e00\u500b<code>tiger</code>\u5206\u652f<ul> <li><code>-b &lt;\u65b0\u7684\u5206\u652f\u540d\u7a31&gt;</code>: (=&gt; <code>branch</code>): \u5207\u63db\u5230<code>&lt;\u65b0\u7684\u5206\u652f\u540d\u7a31&gt;</code>,\u5982\u679c\u6c92\u6709\u7684\u8a71,\u5c31\u65b0\u589e\u4e00\u500b<code>&lt;\u8a72\u5206\u652f&gt;</code></li> </ul> </li> <li>\u7576$ <code>git checkout \"\u6a94\u6848\u540d\u7a31 or \u8def\u5f91\"</code> \u6642,Git\u5c31\u6703\u5230 <code>.git/</code> \u76ee\u9304\u88e1\u62c9\u4e00\u4efd\u5230\u76ee\u524d\u7684\u5de5\u4f5c\u76ee\u9304(working directory)</li> </ul> </li> <li>$ <code>git checkout xxx.html</code> \u53ef\u4ee5\u5c07\u5de5\u4f5c\u76ee\u9304(working directory)\u4e2d\u4e0d\u5c0f\u5fc3\u522a\u9664(<code>rm</code>)\u6389\u7684\u6307\u5b9a\u6a94\u6848\u5fa9\u539f\u56de\u4f86</li> <li>\u4f8b\u5982: <code>pizza.html</code> \u5f9edeleted status\u8b8a\u56de\u539f\u672c\u7684\u72c0\u614b</li> <li>\u4e5f\u53ef\u4ee5\u5229\u7528 $ <code>git checkout .</code> \u4e00\u53e3\u6c23\u628a\u6240\u6709\u5de5\u4f5c\u76ee\u9304(working directory)\u4e2d\u88ab\u522a\u6389\u7684\u6a94\u6848\u6551\u56de\u4f86</li> <li></li> <li>$ <code>git checkout HEAD~2 yyy.html</code><ul> <li>\u9019\u6a23\u5c31\u6703\u5230 <code>.git/</code> \u88e1\u62ff\u8ddd\u96e2\u73fe\u5728\u5169\u500b\u7248\u672c\u4ee5\u524d\u7684 yyy.html \u4f86\u8986\u84cb\u73fe\u5728\u5de5\u4f5c\u76ee\u9304(working directory)\u7684 yyy.html ,\u4f46\u8981\u6ce8\u610f\u7684\u662f,\u9019\u540c\u6642\u4e5f\u6703\u66f4\u65b0\u66ab\u5b58\u5340(staging area)\u7684\u72c0\u614b\u5594 </li> </ul> </li> <li>\u4ee5\u6b64\u985e\u63a8, $ <code>git checkout HEAD~2</code><ul> <li>\u9019\u6a23\u5c31\u6703\u62ff\u8ddd\u96e2\u73fe\u5728\u5169\u500b\u7248\u672c\u4ee5\u524d\u7684\u6a94\u6848\u4f86\u8986\u84cb\u73fe\u5728\u5de5\u4f5c\u76ee\u9304(working directory)\u88e1\u7684\u6a94\u6848,\u540c\u6642\u4e5f\u66f4\u65b0\u66ab\u5b58\u5340(staging area)\u88e1\u7684\u72c0\u614b</li> </ul> </li> </ul>"},{"location":"version_control/git/#commit_2","title":"\u5982\u679c\u60f3\u91cd\u65b0\u7de8\u8f2f\u525b\u624d\u7684commit","text":"<ul> <li>$ <code>git log --oneline</code> \u986f\u793a\u7684\u6b77\u53f2commit\u7d00\u9304\u662f\u7531\u65b0\u5230\u820a(\u4e0a\u5230\u4e0b)<ul> <li></li> </ul> </li> <li>\u5229\u7528 $ <code>git reset f06546a</code> \u4f86\u56de\u6eaf\u5230\u904e\u53bb\u6307\u5b9a\u7684Commit\u7269\u4ef6\u4e2d<ul> <li>\u53ef\u4ee5\u4f7f\u7528\"\u76f8\u5c0d\"\u6216\u662f\"\u7d55\u5c0d\"\u7684\u8868\u793a\u65b9\u5f0f</li> <li><code>^</code> : \u524d\u4e00\u6b21</li> <li><code>~\u6b21\u6578</code> : \u8981\u5012\u9000\u81f3\u5e7e\u6b21commit\u4ee5\u524d</li> <li><code>SHA-1\u503c</code>: \u7d55\u5c0d\u7684\u8868\u793a\u65b9\u5f0f</li> <li>\u6240\u4ee5$ <code>git reset f06546a^^</code> = $ <code>git reset f06546a~2</code></li> <li>\u4f8b\u5982: $ <code>git reset f06546a^</code> =&gt;\u4ee3\u8868\u56de\u5230\u8a72commit\u7684\u524d\u4e00\u6b21commit\u7d00\u9304\u4e2d</li> <li>\u4f8b\u5982: $ <code>git reset master^</code> =&gt;\u4ee3\u8868\u56de\u5230master\u5206\u652f\u7684\u524d\u4e00\u6b21commit\u7d00\u9304\u4e2d</li> <li>\u4f8b\u5982: $ <code>git reset HEAD^</code> =&gt;\u4ee3\u8868\u56de\u5230HEAD\u76ee\u524d\u6307\u5411\u7684\u5206\u652f(\u8a72\u5206\u652f\u6307\u5411\u7684commit)\u7684\u524d\u4e00\u6b21commit\u7d00\u9304\u4e2d</li> </ul> </li> <li>$ <code>git reset &lt;\u6a21\u5f0f&gt;</code> ,\u6709\u4e09\u7a2e\u6a21\u5f0f\u53ef\u4ee5\u9078\u64c7,\u9810\u8a2d\u70ba <code>mixed</code>\u6a21\u5f0f<ul> <li><code>mixed</code> \u6a21\u5f0f: \u9019\u6a21\u5f0f\u4e0b\u7684<code>reset</code>\u6703\u628a\u66ab\u5b58\u5340(staging area)\u7684\u6a94\u6848\u4e1f\u6389,\u4f46\u4e0d\u6703\u52d5\u5230\u5de5\u4f5c\u76ee\u9304(working directory)\u7684\u6a94\u6848,\u4e5f\u5c31\u662f\u8aaacommit\u62c6\u51fa\u4f86\u7684\u6a94\u6848\u6703\u7559\u5728\u5de5\u4f5c\u76ee\u9304,\u4f46\u4e0d\u6703\u7559\u5728\u66ab\u5b58\u5340</li> <li><code>soft</code> \u6a21\u5f0f: \u9019\u6a21\u5f0f\u4e0b\u7684<code>reset</code>,\u5de5\u4f5c\u76ee\u9304(working directory)\u548c\u66ab\u5b58\u5340(staging area)\u7684\u6a94\u6848\u90fd\u4e0d\u6703\u88ab\u4e1f\u6389,\u56e0\u6b64\u770b\u8d77\u4f86\u5c31\u53ea\u6709<code>HEAD</code>\u5728\u79fb\u52d5\u800c\u5df2; \u6240\u4ee5commit\u62c6\u51fa\u4f86\u7684\u6a94\u6848\u90fd\u6703\u76f4\u63a5\u88ab\u5b58\u653e\u5728\u66ab\u5b58\u5340</li> <li><code>hard</code> \u6a21\u5f0f: \u9019\u6a21\u5f0f\u4e0b\u7684<code>reset</code>,\u4e0d\u7ba1\u662f\u66ab\u5b58\u5340(staging area)\u548c\u5de5\u4f5c\u76ee\u9304(working directory)\u90fd\u6703\u88ab\u4e1f\u6389</li> <li>\u5c0f\u7d71\u6574:           \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/</li> <li><code>mixed</code> \u6a21\u5f0f=&gt; <code>index\u79fb\u9664staged\u6a19\u8a18</code>,\u8b8a\u6210Modified\u6216\u662fUntracked file,\u5167\u5bb9\u662f\u65b0\u7248\u7684</li> <li><code>soft</code> \u6a21\u5f0f=&gt; <code>\u50c5\u79fb\u9664commit\u8b8a\u6210\u65b0\u7248\"\u672a\"commit</code>,\u5167\u5bb9\u4ecd\u662f\u65b0\u7248\u7684</li> <li><code>hard</code> \u6a21\u5f0f=&gt; \u56de\u5230\u4e0a\u4e00\u7248\u672c,<code>\u9019\u671f\u9593\u7684\u6240\u6709\u8b8a\u66f4\u5b8c\u5168\u79fb\u9664</code>,\u5167\u5bb9\u53ca\u72c0\u614b\u7686\u662f\u4e0a\u4e00\u7248</li> </ul> </li> </ul>"},{"location":"version_control/git/#tagcommmit","title":"\u65b0\u589e<code>Tag\u7269\u4ef6</code>\u5230<code>Commmit\u7269\u4ef6</code>","text":"<ul> <li>$ <code>git tag -a wow -m \"Tag\u7269\u4ef6-annotated tag \u7df4\u7fd2\"</code><ul> <li>$ <code>git cat-file -t &lt;</code>Tag\u7269\u4ef6<code>\u7684SHA-1\u503c&gt;</code></li> <li></li> </ul> </li> <li>\u7d71\u6574: <code>Tag\u7269\u4ef6</code>\u4e2d\u7684\u6709\u9644\u8a3bTag(Annotated Tag)\u6703\u6307\u5411\u67d0\u500b<code>Commit\u7269\u4ef6</code></li> </ul>"},{"location":"version_control/git/#branch","title":"\u5206\u652f(branch)\u64cd\u4f5c","text":"<ul> <li>\u5206\u652f\u57fa\u790e\u64cd\u4f5c\u53ef\u53c3\u8003 \u5206\u652fbranch\u662f\u4ec0\u9ebc \u7ae0\u7bc0</li> <li> <p>\u5408\u4f75\u5206\u652f\u7684\u5169\u7a2e\u65b9\u5f0f($ <code>git merge</code> &amp; $ <code>git rebase</code>)</p> <ul> <li>\u65b9\u6cd5\u4e00 : $ <code>git merge</code></li> <li>$ <code>git merge &lt;\u8981\u5408\u4f75\u5230\u7684\u5206\u652f\u540d\u7a31&gt;</code>: \u53ef\u4ee5\u7528\u4f86\u5c07\u76ee\u524d\u6240\u5728\u7684\u5206\u652f(branch)\u5408\u4f75\u5230 <code>&lt;\u8981\u5408\u4f75\u5230\u7684\u5206\u652f\u540d\u7a31&gt;</code></li> <li>\u82e5\u8981\u5408\u4f75\u6389\u5225\u4eba\u7684\u5206\u652f\u662f\u5f9e\u8981\u88ab\u5408\u4f75\u6389\u7684\u5206\u652f\u7684\u958b\u51fa\u4f86\u7684,\u82e5\u8981\u88ab\u5408\u4f75\u6389\u7684\u5206\u652f\u6c92\u6709\u4fee\u6539\u7684\u8a71,Git\u6703\u9810\u8a2d\u4f7f\u7528\u5feb\u8f49\u6a21\u5f0f(fast-forward)\u4f86\u505a\u5408\u4f75 <ul> <li>$ <code>git merge --ff &lt;\u8981\u5408\u4f75\u5230\u7684\u5206\u652f\u540d\u7a31&gt;</code></li> <li><code>--ff</code> (=&gt; \u6b64\u70baGit\u9810\u8a2d<code>fast-forward</code>\u6a21\u5f0f)</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655: https://backlog.com/git-tutorial/tw/stepup/stepup1_4.html</li> </ul> </li> <li>\u4f46\u82e5\u539f\u672c\u7684\u90a3\u500b\u5206\u652f\u6709\u4fee\u6539\u904e\u7684\u8a71,\u9019\u6642\u5019Git\u5c31\u4e0d\u6703\u4f7f\u7528\u5feb\u8f49\u6a21\u5f0f(<code>fast-forward</code>),\u6b64\u6642Git\u6703\u984d\u5916\u518d\u505a\u51fa\u4e00\u500b\u65b0\u7684<code>Commit\u7269\u4ef6</code>\u4f86\u5408\u4f75\u9019\u5169\u500b\u5206\u652f<ul> <li>$ <code>git merge --no-ff &lt;\u8981\u5408\u4f75\u5230\u7684\u5206\u652f\u540d\u7a31&gt;</code></li> <li><code>--no-ff</code> (=&gt; \u5f37\u5236\"\u4e0d\u8981\"\u4f7f\u7528fast-forward\u6a21\u5f0f)</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655: https://backlog.com/git-tutorial/tw/stepup/stepup1_4.html</li> </ul> </li> <li>$ <code>git merge --ff-only &lt;\u8981\u5408\u4f75\u5230\u7684\u5206\u652f\u540d\u7a31&gt;</code><ul> <li><code>--ff-only</code> (=&gt; \u76e1\u53ef\u80fd\u7684\u512a\u5148\u4f7f\u7528fast-forward\u6a21\u5f0f\u5408\u4f75,\u6b64\u6642\u5982\u679c\u7121\u6cd5\u505a\u5230\u4f7f\u7528fast-forward\u6a21\u5f0f\u5408\u4f75\u7684\u8a71,Git\u5c31\u6703\u62d2\u7d55\u9019\u6b21\u7684\u6307\u4ee4\u4e26\u56de\u50b3\u4e00\u500b\"\u5931\u6557\"\u7684\u932f\u8aa4\u72c0\u614b) </li> </ul> </li> <li><code>\u60c5\u5883\u8aaa\u660e</code>(\u8981\u7528<code>master\u5206\u652f</code>\u4f86\u5408\u4f75<code>pig\u5206\u652f</code>)</li> <li>\u5148\u65b0\u589e\u4e00\u500b\u5206\u652f(branch): <code>pig</code></li> <li>\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u6a94\u6848,\u4e26commit: <code>pig.html</code></li> <li>\u65b0\u589e\u4e00\u884c\u6587\u5b57\u5f8c,\u518dcommit\u4e00\u6b21: <code>hello, pig</code></li> <li>$ <code>git log</code>: \u6aa2\u8996\u4e00\u4e0b\u76ee\u524d\u7684commit\u6b77\u53f2\u7d00\u9304(\u78ba\u8a8d\u76ee\u524d\u662f\u5728<code>pig\u5206\u652f</code>\u4e26\u4e14\u6709<code>\u5169\u6b21commit\u7684\u7d00\u9304</code>)</li> <li></li> <li>\u8981\u5148\u5207\u56de<code>master\u5206\u652f</code></li> <li>$ <code>git checkout master</code></li> <li>$ <code>git merge pig</code>: \u5c07<code>pig\u5206\u652f</code>\u5408\u4f75\u56de\u5230<code>master\u5206\u652f</code></li> <li>\u672c\u4f86\u843d\u5f8c<code>pig\u5206\u652f</code>\u5169\u6b21commit\u7d00\u9304\u7684<code>master\u5206\u652f</code>,\u73fe\u5728\u4e5f\u5df2\u7d93\u8ddf\u4e0a<code>pig\u5206\u652f</code>\u7684\u9032\u5ea6\u4e86 </li> <li> <p></p> </li> <li> <p>\u65b9\u6cd5\u4e8c : $ <code>git rebase</code></p> </li> <li>$ <code>git rebase &lt;\u8981\u88abrebase\u7684\u5206\u652f\u540d\u7a31&gt;</code></li> <li>\u53ef\u4ee5\u91cd\u65b0\u5b9a\u7fa9<code>\u5206\u652f(branch)</code>\u53c3\u8003\u7684\u57fa\u6e96</li> <li>\u53ef\u4ee5\u7528\u4f86\u5c07\u76ee\u524d\u6240\u5728\u7684\u5206\u652f(branch)\u5408\u4f75\u5230 <code>&lt;\u8981\u88abrebase\u7684\u5206\u652f\u540d\u7a31&gt;</code></li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655: https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1?fbclid=IwAR22RpLWxsCk1qKLdJynK4BCMyD5FSTvRHta8GvAyJO2ALi4WObsdQ-UWNU</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u5f9e<code>master</code>\u5206\u652f\u62c6\u5206\u51fa\u5169\u500b\u5206\u652f(<code>elephant</code>,<code>zebra</code>),\u4e26\u5206\u5225\u5404commit\u5169\u6b21</li> <li></li> <li>\u8a18\u5f97\u8981\u5148\u5207\u63db\u5230<code>elephant\u5206\u652f</code>(\u8981rebase\u5230\u5225\u4eba\u7684\u5206\u652f)!<ul> <li>$ <code>git checkout elephant</code> </li> </ul> </li> <li>$ <code>git rebase zebra</code>: \u5c07<code>elephant\u5206\u652f</code>rebase\u5230<code>zebra\u5206\u652f</code>\u4e0a\u9762</li> <li></li> <li>$ <code>git rebase -i &lt;HEAD\u7684\u76f8\u5c0d\u4f4d\u7f6e&gt;</code></li> <li>\u4f8b\u5982: $ <code>git rebase -i HEAD~3</code></li> <li>\u53ef\u4ee5\u5148\u5728\u4e92\u52d5\u5f0f\u6a21\u5f0f\u7de8\u8f2f\u54ea\u4e9b<code>Commit\u7269\u4ef6</code>\u8981\u88ab<code>Rebase</code><ul> <li>\u53ef\u4ee5\u4f7f\u7528\u50cf\u662f<code>pick</code>\u3001<code>edit</code>\u3001<code>squash</code>\u3001<code>drop</code> \u7b49\u76f8\u95dcGit\u6307\u4ee4\u4f86\u7de8\u8f2f\u9019\u4e9b<code>Commit\u7269\u4ef6</code> </li> </ul> </li> <li><code>-i</code> (=&gt; <code>--interactive</code>): \u5229\u7528\u4e92\u52d5\u5f0f\u6a21\u5f0f\u4f86\"\u9810\u5148\"\u7de8\u8f2f\u8981<code>\u88abrebased\u7684\u90a3\u4e9bCommit\u7269\u4ef6</code></li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655: https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1?fbclid=IwAR22RpLWxsCk1qKLdJynK4BCMyD5FSTvRHta8GvAyJO2ALi4WObsdQ-UWNU</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655: https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1?fbclid=IwAR22RpLWxsCk1qKLdJynK4BCMyD5FSTvRHta8GvAyJO2ALi4WObsdQ-UWNU</li> <li>$ <code>git rebase</code> \u662f\u4e00\u7a2e\u6703\u4fee\u6539\u5230\u6b77\u53f2\u7d00\u9304\u7684\u6307\u4ee4,\u76e1\u91cf\u4e0d\u8981\u96a8\u4fbf\u5c0d\u5df2\u7d93\u63a8\u51fa\u53bb\u7d66\u5225\u4eba\u5167\u5bb9\u9032\u884c<code>rebase</code>,\u9019\u6a23\u5f88\u5bb9\u6613\u9020\u6210\u5176\u4ed6\u4eba\u7684\u56f0\u64fe</li> <li>\u7528$ <code>git rebase</code> \u7684\u65b9\u5f0f\u5408\u4f75\u5206\u652f &amp; \u7528$ <code>git merge</code> \u7684\u65b9\u5f0f\u5408\u4f75\u5206\u652f,\u6709\u4e00\u500b\u5f88\u660e\u986f\u7684\u5dee\u5225\u662f\u7528<code>Rebase\u65b9\u5f0f</code>\u5408\u4f75\u5206\u652f\u7684\u8a71,Git\u4e26\u4e0d\u6703\u7279\u5225\u505a\u51fa\u4e00\u500b\u5c08\u9580\u7528\u4f86\u5408\u4f75\u5206\u652f\u7684<code>Commit\u7269\u4ef6</code></li> <li>$ <code>git rebase</code> \u7684\u539f\u7406\u5176\u5be6\u662f\u505a\u591a\u6b21\"Apply\"\u5230<code>\u65b0\u7684\u57fa\u6e96\u9edebranch</code>\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>\u4e0a</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655: https://gitbook.tw/chapters/branch/merge-with-rebase.html</li> <li>\u7528<code>Rebase\u5408\u4f75\u5206\u652f</code>\u904e\u5f8c,\u539f\u4f86\u820a\u7684\u90a3\u500b\u5206\u652f\u539f\u672c\u6240\u7528\u5230\u7684\u90a3\u4e9bCommit\u7269\u4ef6,\u4e26\"\u4e0d\u6703\u7acb\u5373\u88abGit\u522a\u9664\"; \u53ea\u662f\u56e0\u70ba\u90a3\u4e9b<code>Commit\u7269\u4ef6</code>\u6c92\u6709<code>\u5206\u652f(branch)</code>\u6307\u5411\u4ed6\u5011,\u6240\u4ee5\u5982\u679c\u6211\u5011\u4e5f\u6c92\u7279\u5225\u53bb\u8a18\u4e0b\u9019\u4e9b<code>Commit\u7269\u4ef6\u7684id</code>\u7684\u8a71,\u9019\u4e9b<code>Commit\u7269\u4ef6</code>\u5c31\u6703\u6162\u6162\u5730\u88ab\u908a\u7de3\u5316,\u76f4\u5230\u6709\u4e00\u5929\u88abGit\u7684\u5167\u5efa\u8cc7\u6e90\u56de\u6536\u6a5f\u5236\u5e36\u8d70</li> <li>\u5176\u5be6\u8ab0Rebase\u8ab0\u4ee5\u7d50\u679c\u4f86\u770b\u662f\u6c92\u4ec0\u9ebc\u5dee\u5225\u7684,\u4f46\u4ee5\u6b77\u53f2\u7d00\u9304\u4f86\u8aaa\u7684\u8a71,\u88abrebase\u7684\u5206\u652f\u6703\u5beb\u5728\u5f8c\u9762</li> <li>\u60f3\u53d6\u6d88\u5408\u4f75\u5206\u652f\u7684\u8a71,\u6709\u4ee5\u4e0b\u5169\u7a2e\u65b9\u5f0f</li> <li>\u5982\u679c\u662f\u7528 $ <code>git merge</code> \u4f86\u5408\u4f75\u5206\u652f\u7684\u8a71: \u7528 $ <code>git reset HEAD~2 --hard</code> =&gt; \u4e5f\u5c31\u662f\u62c6\u6389\u9019\u500b\u5408\u4f75\u7684Commit\u7269\u4ef6,\u5927\u5bb6\u5c31\u6703\u9000\u56de\u5230\u5408\u4f75\u524d\u7684\u72c0\u614b</li> <li>\u5982\u679c\u662f\u7528 $ <code>git rebase</code> \u4f86\u5408\u4f75\u5206\u652f\u7684\u8a71,\u56e0\u70ba\u9019\u500b\u65b9\u6cd5Git\u4e26\u4e0d\u6703\u7279\u5225\u505a\u51fa\u4e00\u500b<code>Commit\u7269\u4ef6</code>\u4f86\u5408\u4f75\u5206\u652f,\u6240\u4ee5\u4e0d\u80fd\u7528\u4e0a\u8ff0\u7684\u65b9\u6cd5;\u4f46\u53ef\u4ee5\u7528\u4ee5\u4e0b\u5169\u7a2e\u65b9\u5f0f\u4f86\u53d6\u6d88\u5408\u4f75\u5206\u652f<ul> <li>\u5148\u6aa2\u8996\u76ee\u524d\u7684<code>Reflog\u7d00\u9304</code></li> <li>$ <code>git reflog</code><ul> <li></li> <li>\u627e\u51fa\u5c0d\u61c9\u5230\u6700\u4e45\u4ee5\u524d\u7684 <code>rebase\u95dc\u9375\u5b57</code>\u7684\u524d\u4e00\u6b21<code>Commit\u7269\u4ef6</code>\u7684id</li> <li>\u4ee5\u9019\u500b\u4f8b\u5b50\u662f: <code>ce76004</code>\u9019\u500b<code>Commit\u7269\u4ef6id</code></li> </ul> </li> <li>\u7528 $ <code>git reset &lt;\u8981\u56de\u5230\u904e\u53bb\u7684\u54ea\u500bCommit\u7269\u4ef6id&gt; --hard</code></li> <li>\u9019\u6a23\u5c31\u53ef\u4ee5\u56de\u5230<code>Rebase</code>\u4ee5\u524d\u7684\u72c0\u614b\u4e86</li> <li>\u5148\u6aa2\u8996\u76ee\u524d\u7684<code>ORIG_HEAD</code>\u6307\u5411\u7684<code>Commit\u7269\u4ef6\u7684id</code></li> <li>\u53ef\u5148\u53c3\u8003 ORIG_HEAD`\u662f\u4ec0\u9ebc? \u7ae0\u7bc0</li> <li>$ <code>cat .git/ORIG_HEAD</code>: <code>\u56de\u50b3Git\u5371\u96aa\u64cd\u4f5c\u4ee5\u524d\u7684</code>ORIG_HEAD<code>\u6307\u5411\u7684</code>Commit\u7269\u4ef6`\u7684id</li> <li></li> </ul> </li> <li>\u4f7f\u7528<code>Rebase</code>\u65b9\u5f0f\u4f86\u5408\u4f75\u5206\u652f\u7684\u512a\u7f3a\u9ede\u5206\u6790</li> <li>\u597d\u86551: \u4e0d\u6703\u7279\u5225\u7522\u751f\u4e00\u500b\u70ba\u4e86\u5408\u4f75\u5206\u652f\u7684<code>Commit\u7269\u4ef6</code></li> <li>\u597d\u86552: \u5408\u4f75\u7684\u6b77\u53f2\u9806\u5e8f\u53ef\u4ee5\u81ea\u7531\u6c7a\u5b9a(\u4f9d\u7167<code>\u8ab0Rebase\u8ab0</code>\u800c\u5b9a)</li> <li>\u7f3a\u9ede1: \u76f8\u5c0d\u4f86\u8aaa,\u6bd4\u8d77<code>Merge</code>\u65b9\u5f0f\u4f86\u5408\u4f75\u5206\u652f,\u4e26\u6c92\u6709\u90a3\u9ebc\u76f4\u89ba</li> <li>\u7f3a\u9ede2: \u5982\u679c\u4e00\u500b\u4e0d\u5c0f\u5fc3\u53ef\u80fd\u6703\u5f04\u58de\u6389\u800c\u4e14\u9084\u4e0d\u77e5\u9053\u8a72\u600e\u9ebc<code>Reset</code>\u56de\u4f86</li> <li>\u5efa\u8b70: \u53ef\u4ee5\u5728\u9084\u6c92\u63a8\u51fa\u53bb\u524d(<code>Push</code>),\u5982\u679c\u89ba\u5f97<code>Commit\u7269\u4ef6</code>\u5011\u592a\u51cc\u4e82or\u7463\u788e,\u53ef\u4ee5\u5148\u7528<code>Rebase\u5408\u4f75\u5206\u652f\u7684\u65b9\u5f0f</code>\u4f86\u6574\u7406\u9019\u4e9b<code>Commit\u7269\u4ef6</code>,\u518d\u63a8\u51fa\u53bb</li> <li>\u63d0\u9192: <code>Rebase</code>\u7b49\u65bc\u662f\u4fee\u6539\u6b77\u53f2\u7d00\u9304,\u5982\u679c\u4fee\u6539\u5df2\u7d93\u63a8\u51fa\u53bb(<code>Push</code>)\u7684\u6b77\u53f2\u7d00\u9304\u53ef\u80fd\u6703\u9020\u6210\u5176\u4ed6\u4eba\u7684\u56f0\u64fe,\u6240\u4ee5\u5982\u679c\u662f\u5df2\u7d93\u63a8\u51fa\u53bb(<code>Push</code>)\u7684\u5167\u5bb9,\u975e\u5fc5\u8981\u76e1\u91cf\u4e0d\u8981\u4f7f\u7528<code>Rebase</code></li> <li>$ <code>git rebase -i &lt;\u904e\u53bb\u7684\u4e00\u500bCommit\u7269\u4ef6id&gt;</code></li> <li>\u53ef\u4ee5\u4f7f\u7528\u50cf\u662f<code>pick</code>\u3001<code>edit</code>\u3001<code>squash</code>\u3001<code>drop</code> \u7b49\u76f8\u95dcGit\u6307\u4ee4\u4f86\u7de8\u8f2f\u9019\u4e9b<code>Commit\u7269\u4ef6</code></li> <li><code>Rebase\u6307\u4ee4</code>\u7684\u4e92\u52d5\u6a21\u5f0f(<code>-i</code>)\u4e5f\u53ef\u4ee5\u7528\u4f86\u7de8\u8f2f\u904e\u53bb\u7684\u6240\u6709<code>Commit\u7269\u4ef6</code></li> <li><code>-p</code> (=&gt; <code>--pick</code>): use commit</li> <li><code>-r</code> (=&gt; <code>reword</code>): use commit, but edit the commit message(\u7576\u60f3\u4fee\u6539\u904e\u53bb\u6b77\u53f2\u7d00\u9304\u4e2d\u7684<code>commit message</code>\u6642)</li> <li><code>-e</code> (=&gt; <code>edit</code>): use commit, but stop for amending(\u9069\u7528\u4ee5\u4e0b\u60c5\u5883)<ul> <li>\u7576\u60f3\u628a\u4e00\u500b<code>commit\u7d00\u9304</code>\u62c6\u89e3\u6210\u591a\u500b<code>commit\u7d00\u9304</code>\u6642</li> <li>\u7576\u60f3\u5728\u67d0\u4e9bcommit\u4e4b\u9593\u518d\u52a0\u65b0\u7684<code>commit\u7d00\u9304</code></li> <li>\u7576\u60f3\u8981\u522a\u9664\u67d0\u5e7e\u500bcommit\u7d00\u9304</li> <li>\u7576\u60f3\u8981\u8abf\u6574\u904e\u53bbcommit\u7d00\u9304\u7684\u9806\u5e8f</li> <li>Git\u6703\u518d\u91cd\u65b0\u57f7\u884c\u4e00\u6b21<code>Rebase</code>\u6642,\u505c\u5728<code>edit</code>\u90a3\u884c\u7684<code>Commit\u7269\u4ef6</code>\u4e0a</li> <li>\u9019\u6642Git\u7684\u72c0\u614b\u61c9\u8a72\u6703\u985e\u4f3c\u9019\u6a23</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655: https://gitbook.tw/chapters/rewrite-history/split-one-commit-to-many-commits.html</li> <li>\u9019\u6642Git\u6703\u8a62\u554f\u8981\u5982\u4f55\u4fee\u6539\u9019\u500b<code>Commit\u7269\u4ef6</code>,\u901a\u5e38\u9019\u6642\u5019\u8981\u5148\u628a\u8981\u505a\"\u4fee\u6539\"\u7684<code>Commit\u7269\u4ef6</code>\u7684\u8abf\u6574\u597d,\u63a5\u8457\u7e7c\u7e8c<code>Rebase</code>\u4e0b\u53bb</li> <li>$ <code>git commit --amend</code>: \"\u4fee\u6539\"\u8a72<code>Commit\u7269\u4ef6</code></li> <li><code>$ git rebase --continue</code>: \u7e7c\u7e8c<code>Rebase</code>\u4e0b\u53bb</li> <li>\u5982\u679c\u9019\u6642\u5019\u4e0d\u662f\u8981\u4fee\u6539\u8a72<code>Commit\u7269\u4ef6</code>,\u800c\u662f\u60f3\u8981\u5c07\u8a72<code>Commit\u7269\u4ef6</code>\u62c6\u5206\u6210\u5169\u500b<code>Commit\u7269\u4ef6</code>\u7684\u8a71,\u53ef\u4ee5\u7528<code>Reset</code>\u6307\u4ee4\u4f86\u5b8c\u6210</li> <li>\u53ef\u5148\u53c3\u8003 \u5982\u679c\u4e0d\u5c0f\u5fc3\u4f7f\u7528 git reset --hard \u6a21\u5f0f,\u80fd\u6551\u56de\u4f86\u55ce? \u7ae0\u7bc0</li> <li>$ <code>git reset HEAD^</code> : \u56de\u5230<code>HEAD</code>\u76ee\u524d\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>\u7684\u524d\u4e00\u6b21<code>commit\u7d00\u9304</code>\u4e0a</li> <li>$ <code>git status</code>: \u5148\u6aa2\u8996\u4e00\u4e0b\u76ee\u524d\u7684Git\u72c0\u614b<ul> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655: https://gitbook.tw/chapters/rewrite-history/split-one-commit-to-many-commits.html</li> </ul> </li> <li>\u53ef\u4ee5\u770b\u5230<code>cat3.html</code> &amp; <code>cat4.html</code>\u90fd\u88ab\u62c6\u51fa\u4f86\u653e\u5728\u5de5\u4f5c\u76ee\u9304\u4e26\u4e14\u662f\u8655\u65bc<code>Untracked File</code>\u72c0\u614b</li> <li>\u63a5\u8457\u5c31\u6309\u7167\u5e73\u5e38\u7684\u6d41\u7a0b($ <code>git add &lt;\u4e00\u500b\u6a94\u6848\u7684\u6a94\u540d&gt;</code> + <code>$ git commit -m \"xxxx\"</code>),\u5c31\u53ef\u4ee5\u62c6\u89e3\u6210\u5169\u6b21<code>commit\u7d00\u9304</code>\u51fa\u4f86\u4e86</li> <li>\u6700\u5f8c\u9084\u662f\u8981\u8a18\u5f97\u76ee\u524d\u4ecd\u4f9d\u7136\u8655\u65bc<code>Rebase\u72c0\u614b</code>,\u6240\u4ee5\u8981\u8b93<code>Rebase\u6d41\u7a0b</code>\u7e7c\u7e8c\u8dd1\u5b8c\u624d\u7b97\u5b8c\u6210\u5594!<ul> <li>$ <code>git rebase --continue</code> </li> </ul> </li> </ul> </li> <li><code>-s</code> (=&gt; <code>squash</code>): use commit, but meld into previous commit(\u7576\u60f3\u628a\u591a\u500b<code>commit\u7d00\u9304</code>\u5408\u4f75\u6210\u4e00\u500b<code>c</code>ommit\u7d00\u9304`\u6642)</li> <li><code>-d</code> (=&gt; <code>drop</code>): remove commit</li> <li>\u6ce8\u610f! $ <code>git rebase -i</code> \u8207 $ <code>git log</code> \u986f\u793acommit\u7d00\u9304\u7684\u9806\u5e8f\u662f\u76f8\u53cd\u7684,\u82e5\u90fd\u662f\"\u5f9e\u4e0a\u5230\u4e0b\"\u6aa2\u8996\u7684\u8a71</li> <li>$ <code>git rebase -i</code>: \u5f9e\u820a-&gt;\u65b0</li> <li>$ <code>git log</code>: \u5f9e\u65b0-&gt;\u820a</li> <li>$ <code>git reflog</code>: \u5f9e\u65b0-&gt;\u820a</li> <li></li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>$ <code>git rebase -i &lt;ca7a70e&gt;</code></li> <li><code>ca7a70e</code>: \u70ba\u5c08\u6848\u6700\u521d\u59cb\u7684<code>Commit\u7269\u4ef6\u7684id</code></li> <li>\u627e\u5230\u8981\u7de8\u8f2f<code>commit message</code>\u7684<code>Commit\u7269\u4ef6</code>,\u5c07<code>pick</code>\u4fee\u6539\u70ba<code>reword</code>,\u5c31\u6703\u8df3\u9032\u53bb\u8a72<code>Commit\u7269\u4ef6</code>\u88e1\u9762,\u53ef\u4ee5\u5229\u7528 Vim\u6a21\u5f0f \u4f86\u7de8\u8f2f\u8a72\u7269\u4ef6\u7684<code>commit message</code>\u5f8c,\u4e26\u5b58\u6a94 &amp; \u96e2\u958b \u5373\u53ef</li> <li></li> <li>\u63d0\u9192: \u7d93\u904e<code>Rebase\u6a21\u5f0f</code>\u4fee\u6539\u5f8c,\u56e0\u70ba\u524d\u5f8c\u8981\u63a5\u7684Commit\u7269\u4ef6\u90fd\u4e0d\u540c(\u5176\u5be6\u6642\u9593\u4e5f\u4e0d\u540c),\u6240\u4ee5\u6703\u91cd\u65b0\u8a08\u7b97\u4e26\u505a\u51fa\u4e00\u9846\u65b0\u7684Commit\u7269\u4ef6;  \u800c\u56e0\u70ba\u5728Git\u6b77\u53f2\u7d00\u9304\u4e0a\u7684\u9019\u5169\u9846Commit\u7269\u4ef6\u88ab\u63db\u6389\u4e86,\u5728\u5b83\u5011\u5169\u500b\u4e4b\u5f8c\u7684\u4e00\u6574\u4e32Commit\u7269\u4ef6\u5168\u90e8\u90fd\u5fc5\u9808\u505a\u51fa\u65b0\u7684Commit\u7269\u4ef6\u51fa\u4f86\u66ff\u4ee3\u820a\u7684Commit\u7269\u4ef6\u5011</li> <li>\u76f8\u95dc\u89c0\u5ff5\u53ef\u53c3\u8003 \u5206\u652f(branch)\u64cd\u4f5c \u7ae0\u7bc0</li> <li>$ <code>git rebase</code> \u7684\u539f\u7406\u5176\u5be6\u662f\u505a\u591a\u6b21\"Apply\"\u5230<code>\u65b0\u7684\u57fa\u6e96\u9edebranch</code>\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>\u4e0a\u539f\u7406 &amp; \u5716\u89e3\u8aaa\u660e</li> <li>\u63d0\u9192: \u5728\u57f7\u884c<code>Rebase\u64cd\u4f5c</code>\u6642,\u8981\u591a\u6ce8\u610f\"\u76f8\u4f9d\u6027\u554f\u984c\", \u5426\u5247\u4e00\u5b9a\u6703\u51fa\u554f\u984c\u7684</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u67d0\u6b21<code>commit\u7d00\u9304</code>\u4fee\u6539\u4e86<code>zebra.html</code>,\u7d50\u679c\u537b\u4e0d\u5c0f\u5fc3\u628a\u9019\u6b21<code>commit\u7d00\u9304</code>\u79fb\u52d5\u5230\u5efa\u7acb<code>zebra.html</code>\u7684\u90a3\u6b21<code>commit\u7d00\u9304</code>\u4e4b\u524d</li> <li>\u522a\u9664\u4e86\u67d0\u6b21\u5efa\u7acb<code>sheep.html</code>\u7684<code>commit\u7d00\u9304</code>,\u4f46\u5f8c\u9762\u7684<code>commit\u7d00\u9304</code>\u90fd\u9700\u8981\u7528\u5230<code>sheep.html</code>\u9019\u500b\u6a94\u6848</li> </ul> </li> </ul>"},{"location":"version_control/git/#commit_3","title":"\u8a72\u5982\u4f55\u56de\u5fa9\u5230\u4e0a\u4e00\u6b21<code>commit\u7d00\u9304</code>\u7684\u72c0\u614b?","text":"<ul> <li>$ <code>git revert HEAD --no-edit</code>: \u6703\u53d6\u6d88\u6700\u5f8c\u4e00\u6b21\u7684<code>commit\u7d00\u9304</code>,\u4e26\"\u56de\u5fa9\"\u5230\u524d\u4e00\u6b21<code>commit\u7d00\u9304</code>\u7684\u72c0\u614b</li> <li><code>--no-edit</code>: \u6307\u5b9a<code>Revert</code>\u6307\u4ee4\u4e0d\u8981\u958b\u555f<code>commit message</code>\u7de8\u8f2f\u5668</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u7de8\u8f2f<code>pig.html</code>,\u4e26\u65b0\u589e\"abc\"\u5b57\u4e32</li> <li></li> <li><code>git revert HEAD --no-edit</code>: \u6703\u53d6\u6d88\u6700\u5f8c\u4e00\u6b21\u7684<code>commit\u7d00\u9304</code>,\u4e26\u56de\u5fa9\u5230<code>HEAD</code>\u7684\u524d\u4e00\u6b21commit\u7d00\u9304</li> <li></li> <li>\u900f\u904eSourcetree\u53ef\u4ee5\u767c\u73fe,Git\u6703\u70ba\u4e86<code>Revert\u64cd\u4f5c</code>,\u65b0\u589e\u4e00\u500b<code>Commit\u7269\u4ef6</code></li> <li></li> <li>\u90a3\u8981\u5982\u4f55\u53d6\u6d88<code>Revert</code>\u5462? \u6709\u4ee5\u4e0b2\u7a2e\u65b9\u6cd5</li> <li>$ <code>git revert HEAD --no-edit</code>: \u9019\u6a23\u4e00\u4f86\u525b\u525b\u88ab\u522a\u9664\u7684<code>pig.html</code>\u4e2d\u7684\"abc\"\u5b57\u4e32\u53c8\u5fa9\u6d3b\u4e86; \u4f46\u540c\u6642Git\u53c8\u6703\u65b0\u589e\u4e00\u500b<code>Revert_\"Revert\" xxxxx</code> \u7684<code>Commit\u7269\u4ef6</code>,\u6703\u9020\u6210<code>Commit\u7269\u4ef6</code>\u8d8a\u4f86\u8d8a\u591a</li> <li> </li> <li>$ <code>git reset HEAD^ --hard</code>: \u9069\u7528\u65bc\u76f4\u63a5\u653e\u68c4<code>HEAD</code>\u7684\u524d\u4e00\u6b21<code>commit\u7d00\u9304</code>\u7684\u6240\u6709\u64cd\u4f5c(\u5305\u62ec\u5de5\u4f5c\u76ee\u9304 \u548c \u66ab\u5b58\u5340)</li> <li>\u53ef\u53c3\u8003 \u5982\u679c\u60f3\u91cd\u65b0\u7de8\u8f2f\u525b\u624d\u7684commit \u7ae0\u7bc0</li> <li>\u8f03\u63a8\u85a6\u6b64\u4f5c\u6cd5!</li> <li><code>Revert\u6307\u4ee4</code>\u7684\u5efa\u8b70\u4f7f\u7528\u60c5\u5883</li> <li>\u5982\u679c\u662f\u500b\u4eba\u958b\u767c\u7684\u5c08\u6848,\u5176\u5be6\u53ef\u4ee5\u76f4\u63a5\u7528<code>Reset</code>\u5207\u56de\u53bb\u5c31\u597d</li> <li>\u4f46\u5982\u679c\u662f\u591a\u4eba\u5171\u540c\u5354\u4f5c\u7684\u5c08\u6848,\u5c31\u4e0d\u4e00\u5b9a\u6709\u6a5f\u6703\u53ef\u4ee5\u4f7f\u7528<code>Reset</code>\u6307\u4ee4,\u9019\u6642\u5019\u5c31\u53ef\u4ee5\u7528<code>Revert</code>\u6307\u4ee4\u4f86\u505a\u51fa\u4e00\u500b\"\u53d6\u6d88\"\u7684<code>Commit\u7269\u4ef6</code>; \u9019\u6a23\u5c0d\u5176\u4ed6\u4eba\u4f86\u8aaa\u4e5f\u4e0d\u7b97\u662f\"\u4fee\u6539\u6b77\u53f2\",\u53ea\u662f\u5efa\u7acb\u4e00\u500b\u8ddf\u67d0\u500b<code>commit\u7d00\u9304</code>\u53cd\u5411\u7684\u64cd\u4f5c\u7684<code>Commit\u7269\u4ef6</code>\u800c\u5df2</li> </ul>"},{"location":"version_control/git/#_4","title":"\u89c0\u5ff5\u4ecb\u7d39","text":"<p><code>The HEAD</code>: HEAD is the pointer to the current branch reference, which is in turn a pointer to the last commit made on that branch. That means HEAD will be the parent of the next commit that is created. It\u2019s generally simplest to think of HEAD as the snapshot of your last commit on that branch. <code>ORIG_HEAD</code>: Git\u5728\u5371\u96aa\u64cd\u4f5c\u4ee5\u524d,\u6703\u5148\u81ea\u52d5\u8a18\u9304\u7576\u4e0b<code>HEAD</code>\u6307\u5411\u7684<code>Commit\u7269\u4ef6\u7684id</code> <code>git branch</code> - List, create, or delete branches <code>git cat-file</code> - Provide content or type and size information for repository object <code>git count-objects</code> - Count unpacked number of objects and their disk consumption <code>git tag</code> - Create, list, delete or verify a tag object signed with GPG <code>git show</code> - Show various types of objects <code>git prune</code> - Prune all unreachable objects from the object database</p>"},{"location":"version_control/git/#git_7","title":"Git \u5176\u5be6\u662f\u4e00\u7a2e\u5206\u6563\u5f0f\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7d71","text":"<ul> <li>Git\u662f\u4e00\u7a2e\u5206\u6563\u5f0f\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7d71,\u800c\u6240\u8b02\u7684\"\u7248\u672c\u63a7\u5236\u7cfb\u7d71\"\u5c31\u662f\u6307\u6703\u5e6b\u4f60\u8a18\u9304\u6240\u6709\u7684\u72c0\u614b\u8b8a\u5316,\u96a8\u6642\u53ef\u4ee5\u5207\u63db\u5230\u904e\u53bb\u67d0\u500b\u7248\u672c\u7684\u72c0\u614b</li> </ul>"},{"location":"version_control/git/#git_8","title":"Git \u7684\u512a\u9ede","text":"<ul> <li>Git\u7684\u512a\u9ede</li> <li>\u514d\u8cbb.\u958b\u6e90</li> <li>Git\u662f\u8a18\u9304\u6a94\u6848\u5167\u5bb9\u7684\u5feb\u7167(snapshot),\u800c\u4e0d\u662f\u8a18\u9304\u7248\u672c\u4e4b\u9593\u7684\u5dee\u7570,\u5b83\u53ef\u4ee5\u8b93Git\u66f4\u5feb\u901f\u5730\u5207\u63db\u7248\u672c</li> <li>Git\u662f\u4e00\u6b3e\u5206\u6563\u5f0f\u7684\u7248\u63a7\u7cfb\u7d71(Distributed Version Control),\u96d6\u7136\u4e5f\u6703\u6709\u5171\u540c\u7684\u4f3a\u670d\u5668,\u4f46\u5373\u4f7f\u5728\u6c92\u6709\u4f3a\u670d\u5668\u6216\u662f\u6c92\u6709\u7db2\u8def\u7684\u74b0\u5883,\u4f9d\u820a\u53ef\u4ee5\u4f7f\u7528Git\u4f86\u9032\u884c\u7248\u63a7,\u5f85\u4f3a\u670d\u5668\u6062\u5fa9\u6b63\u5e38\u904b\u4f5c\u6216\u662f\u5728\u6709\u7db2\u8def\u7684\u74b0\u5883\u5f8c\u518d\u540c\u6b65,\u4e0d\u6703\u53d7\u5f71\u97ff</li> <li>\u8a3b: Git\u548cSVN\u76f8\u6bd4,\u6700\u5927\u7684\u4e0d\u540c\u9ede\u5c31\u662f,Git\u53ef\u4ee5\u5728local\u7aef\u505a\u4e00\u4e9b\u4fee\u6539,\u7136\u5f8ccommit\u5230\u672c\u5730\u7684\u7248\u672c\u5eab,\u6700\u5f8cpush\u5230\u4f3a\u670d\u5668; \u800cSVN\u53ea\u8981\u4e00commit,\u66f4\u6539\u5c31\u5df2\u7d93\u63d0\u4ea4\u5230\u4f3a\u670d\u5668\u4e86</li> </ul>"},{"location":"version_control/git/#git-snapshot","title":"Git \u662f\u7528\u5feb\u7167(snapshot)\u5728\u505a\u7248\u672c\u63a7\u5236\u7684","text":"<ul> <li>Git\u5728\u6bcf\u6b21\u7248\u672c\u8b8a\u5316\u7684\u6642\u5019,\u6709\u9ede\u50cf\u62cd\u7167(snapshot)\u4e00\u6a23,Git\u6703\u66f4\u65b0\u4e26\u8a18\u9304\u6574\u500b\u76ee\u9304\u8ddf\u6a94\u6848\u7684\u6a39\u72c0\u7d50\u69cb</li> </ul>"},{"location":"version_control/git/#git-blobtreecommittag","title":"Git \u7684\u56db\u5927\u7269\u4ef6(<code>Blob</code>,<code>Tree</code>,<code>Commit</code>,<code>Tag</code>)\u89c0\u5ff5\u4ecb\u7d39","text":"<ul> <li>Git\u7684\u56db\u5927\u7269\u4ef6\u7d50\u69cb: \u5728<code>.git/</code> \u7684\u8cc7\u6599\u7d50\u69cb\u88e1\u9762\u6703\u6709</li> <li>Blob\u7269\u4ef6<ul> <li><code>\u60c5\u5883\u8aaa\u660e</code> </li> <li>\u7576\u6a94\u6848\u88ab\u52a0\u5165\u66ab\u5b58\u5340(staging area)\u6642,Git\u4fbf\u6703\u5728<code>.git/</code>\u76ee\u9304\u88e1\u7522\u751f\u4e00\u500b<code>Blob</code>(Binary large object)\u7269\u4ef6,\u4e26\u4e14\u4f9d\u7167\u5b83\u7684\"\u898f\u5247\"\u64fa\u653e\u5230\u5b83\u7684\u76ee\u9304\u88e1,\u9019\u500b<code>Blob\u7269\u4ef6</code>\u662f\u7528\u4f86\u5b58\u653e\u8a72\u6a94\u6848\u7684\"\u5167\u5bb9\"</li> <li>\u63a5\u4e0b\u4f86,\u5c31\u6703\u5230 <code>.git/objects/</code>\u76ee\u9304\u88e1\u5b58\u653e\u8a72\u6a94\u6848,Git\u6703\u7528<code>SHA-1</code>\u768440\u500b\u5b57\u4e2d\u7684<code>\u524d2\u500b\u5b57</code>\u4f5c\u70ba\u76ee\u9304,\u5269\u9918\u768438\u500b\u5c31\u662f\u6a94\u6848\u540d\u7a31</li> <li></li> <li>\u900f\u904e$ <code>git cat-file</code>\u4f86\u6aa2\u8996Git repository\u5167\u5404\u7269\u4ef6\u7684 <code>\u503c</code> or <code>\u578b\u614b</code> or <code>\u5927\u5c0f</code> or <code>\u76f8\u95dc\u8a73\u7d30\u8cc7\u8a0a</code></li> <li>-t: \u986f\u793a\u8a72\u7269\u4ef6\u7684\u578b\u614b(type)</li> <li>-p: \u986f\u793a\u8a72\u7269\u4ef6\u7684\u5167\u5bb9(content)</li> <li>-s: \u986f\u793a\u8a72\u7269\u4ef6\u7684\u5927\u5c0f(size)</li> <li></li> <li>\u7d71\u6574: </li> <li>\u6b65\u9a5f\u4e00: \u7576\u4f7f\u7528$ <code>git add</code>\u628a\u6a94\u6848\u52a0\u5165\u81f3\u66ab\u5b58\u5340\u6642,Git\u6703\u6839\u64da\u9019\u500b\u7269\u4ef6\u7684\"\u5167\u5bb9\"\u8a08\u7b97\u51fa<code>SHA-1</code>\u503c</li> <li>\u6b65\u9a5f\u4e8c: Git\u63a5\u8457\u6703\u7528\u9019\u500b<code>SHA-1</code>\u503c\u7684\u524d<code>2</code>\u500b\u5b57\u7576\u4f5c<code>\u76ee\u9304\u540d\u7a31</code>,\u5f8c38\u500b\u5b57\u7576\u4f5c\u6a94\u6848\u540d\u7a31;\u63a5\u8457Git\u6703\u628a\u76ee\u9304\u53ca\u6a94\u6848\u5efa\u7acb\u5728<code>.git/objects/</code> \u76ee\u9304\u88e1\u9762</li> <li>\u6b65\u9a5f\u4e09: \u8a72\u6a94\u6848\u7684\u5167\u5bb9\u5247\u662fGit\u4f7f\u7528\u58d3\u7e2e\u6f14\u7b97\u6cd5,\u628a\u539f\u672c\u7684\"\u5167\u5bb9\"\u58d3\u7e2e\u4e4b\u5f8c\u7684\u7d50\u679c</li> <li>\u88dc\u5145: <code>Blob\u7269\u4ef6</code>\u7684<code>\u6a94\u540d</code>\u662f\u7531<code>SHA-1</code>\u6f14\u7b97\u6cd5\u6c7a\u5b9a\u7684,Blob\u7269\u4ef6\u7684<code>\u5167\u5bb9</code>\u5247\u662f\u58d3\u7e2e\u6f14\u7b97\u6cd5\u6c7a\u5b9a\u7684</li> </ul> </li> <li>Tree\u7269\u4ef6<ul> <li><code>Tree\u7269\u4ef6</code>\u6703\u6307\u5411<code>\u67d0\u500b</code>\u6216\u662f<code>\u67d0\u4e9bBlob\u7269\u4ef6</code>,\u6216\u662f\u5176\u4ed6<code>Tree\u7269\u4ef6</code></li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655: https://git-scm.com/book/zh-tw/v2/Git-Internals-Git-Objects </li> <li></li> <li>\u7d71\u6574:</li> <li>\u6b65\u9a5f\u4e00: <code>\u6a94\u6848</code>\u5728Git\u88e1\u6703\u4ee5<code>Blob\u7269\u4ef6</code>\u7684\u65b9\u5f0f\u5b58\u653e</li> <li>\u6b65\u9a5f\u4e8c: <code>\u76ee\u9304</code>\u53ca\u6a94\u6848\u540d\u7a31\u6703\u4ee5<code>Tree\u7269\u4ef6</code>\u7684\u5f62\u5f0f\u5b58\u653e</li> <li>\u6b65\u9a5f\u4e09: <code>Tree\u7269\u4ef6</code>\u6703\u6307\u5411<code>\u67d0\u500b</code>\u6216\u662f<code>\u67d0\u4e9bBlob\u7269\u4ef6</code>,\u6216\u662f\u5176\u4ed6<code>Tree\u7269\u4ef6</code></li> </ul> </li> <li>Commit\u7269\u4ef6<ul> <li>\u901a\u5e38\u5305\u542b\u4ee5\u4e0b 4 \u9805\u8cc7\u8a0a </li> <li>\u67d0\u500b<code>Tree\u7269\u4ef6</code></li> <li>parent: \u6703\u6307\u5411\u524d\u4e00\u6b21\u7684Commit\u7269\u4ef6</li> <li>\u4f5c\u8005\u8ddf\u9019\u6b21commit\u7684\u4eba&amp;\u8a72\u6b21\u7684commit\u6642\u9593</li> <li>\u672c\u6b21\u7684commit\u8a0a\u606f($ <code>git commit -m</code>)</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655: https://git-scm.com/book/en/v2/Git-Internals-Git-Objects</li> <li>\u7d71\u6574<code>Commit\u7269\u4ef6</code>\u7684\u898f\u5247:</li> <li><code>Commit\u7269\u4ef6</code>\u6703\u6307\u5411\u67d0\u500b<code>Tree\u7269\u4ef6</code></li> <li><code>Tree\u7269\u4ef6</code>\u6703\u6307\u5411<code>\u67d0\u500b</code>\u6216\u662f<code>\u67d0\u4e9bBlob\u7269\u4ef6</code>,\u6216\u662f\u5176\u4ed6<code>Tree\u7269\u4ef6</code></li> <li>\u9664\u4e86\u7b2c\u4e00\u500b<code>Commit\u7269\u4ef6</code>\u4ee5\u5916,\u6240\u6709\u7684<code>Commit\u7269\u4ef6</code>\u90fd\u6703\u6307\u5411\u5b83\u7684\u524d\u4e00\u6b21\u7684<code>Commit\u7269\u4ef6</code></li> </ul> </li> <li>Tag\u7269\u4ef6<ul> <li>$ <code>git tag -a wow -m \"Tag\u7269\u4ef6 annotated tag \u7df4\u7fd2\"</code></li> <li>$ <code>git cat-file -t &lt;</code>Tag\u7269\u4ef6<code>\u7684SHA-1\u503c&gt;</code></li> <li></li> <li>\u7d71\u6574:</li> <li><code>Tag\u7269\u4ef6</code>\u4e2d\u7684\u6709\u9644\u8a3bTag(Annotated Tag)\u6703\u6307\u5411\u67d0\u500b<code>Commit\u7269\u4ef6</code></li> </ul> </li> <li>Git\u56db\u5927\u7269\u4ef6(<code>Blob</code>,<code>Tree</code>,<code>Commit</code>,<code>Tag</code>)\u89c0\u5ff5\u6574\u5408:<ul> <li>\u628a\u6a94\u6848\u52a0\u5165Git\u4e4b\u5f8c,\u6a94\u6848\u7684\u5167\u5bb9\u6703\u88ab\u8f49\u6210<code>Blob\u7269\u4ef6</code>\u5132\u5b58</li> <li>\u76ee\u9304\u4ee5\u53ca\u6a94\u540d\u6703\u5b58\u653e\u5728<code>Tree\u7269\u4ef6</code>\u5167,<code>Tree\u7269\u4ef6</code>\u6703\u6307\u5411<code>Blob\u7269\u4ef6</code>,\u6216\u662f\u5176\u5b83\u7684<code>Tree\u7269\u4ef6</code></li> <li><code>Commit\u7269\u4ef6</code>\u6703\u6307\u5411\u67d0\u500b<code>Tree\u7269\u4ef6</code>;\u9664\u4e86\u7b2c\u4e00\u500b<code>Commit\u7269\u4ef6</code>\u4ee5\u5916,\u5176\u5b83\u7684commit\u90fd\u6703\u6307\u5411\u524d\u4e00\u6b21\u7684<code>Commit\u7269\u4ef6</code></li> <li><code>Tag\u7269\u4ef6</code>(Annotated Tag)\u6703\u6307\u5411\u67d0\u500b<code>Commit\u7269\u4ef6</code></li> <li><code>\u5206\u652f</code>(branch)\u96d6\u7136\u4e0d\u5c6c\u65bc\u56db\u500b\u7269\u4ef6\u4e4b\u4e00,\u4f46\u5b83\u6703\u6307\u5411\u67d0\u500b<code>Commit\u7269\u4ef6</code></li> <li>\u7576\u958b\u59cb\u5f80Git Server\u4e0a\u63a8\u9001\u4e4b\u5f8c,\u5728 <code>.git/refs/</code> \u5e95\u4e0b\u5c31\u6703\u591a\u51fa\u4e00\u500b <code>remote/\u76ee\u9304</code>,\u88e1\u9762\u653e\u7684\u662f\u9060\u7aef\u7684\u5206\u652f,\u57fa\u672c\u4e0a\u8ddf\u672c\u5730\u7684\u5206\u652f\u662f\u5dee\u4e0d\u591a\u7684\u6982\u5ff5,\u540c\u6a23\u4e5f\u6703\u6307\u5411\u67d0\u500b<code>Commit\u7269\u4ef6</code></li> <li> </li> <li><code>HEAD</code>\u4e5f\u4e0d\u5c6c\u65bcGit\u56db\u5927\u7269\u4ef6\u4e4b\u4e00,\u5b83\u6703\u6307\u5411\u67d0\u500b<code>\u5206\u652f</code>(branch)</li> </ul> </li> </ul>"},{"location":"version_control/git/#git-count-objects","title":"$ <code>git count-objects</code>: \u53ef\u4ee5\u6aa2\u8996\u76ee\u524d\u6709\u591a\u5c11\u7269\u4ef6\u548c\u7528\u6389\u591a\u5c11\u5132\u5b58\u7a7a\u9593","text":"<ul> <li>$ <code>git count-objects</code>: \u53ef\u4ee5\u6aa2\u8996\u76ee\u524d\u6709\u591a\u5c11\u7269\u4ef6\u548c\u7528\u6389\u591a\u5c11\u5132\u5b58\u7a7a\u9593</li> <li></li> <li><code>-v</code> (=&gt; <code>--verbose</code>): \u986f\u793a\u9019\u500bGit\u7ba1\u63a7\u7684\u5c08\u6848\u4e2d\u6240\u6709\u7269\u4ef6\u7684\u66f4\u591a\u8a73\u7d30\u8cc7\u8a0a</li> <li><code>-H</code> (=&gt; <code>--human-readable</code>): \u5c07\u6240\u6709\u5728\u9019\u500bGit\u7ba1\u63a7\u7684\u5c08\u6848\u4e2d\u6240\u6709\u7269\u4ef6\u6240\u4f54\u7528\u7684\u5132\u5b58\u7a7a\u9593\u7528\u4eba\u985e\u53ef\u95b1\u8b80\u7684\u683c\u5f0f\u4f86\u986f\u793a(MB)</li> </ul>"},{"location":"version_control/git/#git_9","title":"\u5728\u4f7f\u7528Git\u6642,\u6307\u4ee4\u8981\u5728\u6b63\u78ba\u7684\u76ee\u9304\u4e0b\u624d\u80fd\u6b63\u5e38\u904b\u4f5c","text":"<ul> <li>\u5728\u4f7f\u7528Git\u6642,\u6307\u4ee4\u8981\u5728\u6b63\u78ba\u7684\u76ee\u9304\u4e0b\u624d\u80fd\u6b63\u5e38\u904b\u4f5c</li> </ul>"},{"location":"version_control/git/#gitstaging-areaindex","title":"\u5728Git\u8853\u8a9e\u4e2d,\u66ab\u5b58\u5340(staging area)=\u7d22\u5f15(index)","text":"<ul> <li>\u66ab\u5b58\u5340(Staging Area)\u53c8\u53ef\u7a31\u70ba\u7d22\u5f15(index)</li> </ul>"},{"location":"version_control/git/#git-working-directorystaging-arearepository","title":"Git \u4e16\u754c\u88e1\u7684\u7684\u4e09\u5927\u5340\u57df---<code>\u5de5\u4f5c\u76ee\u9304(working directory)</code>,<code>\u66ab\u5b58\u5340(staging area)</code>,<code>\u5132\u5b58\u5eab(repository)</code>","text":"<ul> <li>\u5728Git\u88e1,\u4e3b\u8981\u53ef\u4ee5\u5206\u6210\u4e09\u500b\u5340\u57df,\u900f\u904e\u4e0d\u540c\u7684git\u6307\u4ee4\u53ef\u4ee5\u628a\u6a94\u6848\u79fb\u52d5\u5f80\u4e0d\u540c\u7684\u5340\u57df</li> <li>\u5de5\u4f5c\u76ee\u9304(Working Directory)</li> <li>\u66ab\u5b58\u5340\u57df(Staging Area) or (index)</li> <li>\u5132\u5b58\u5eab(Repository)</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/</li> </ul>"},{"location":"version_control/git/#git-add-git-commit","title":"\u70ba\u4ec0\u9ebc\u6bcf\u6b21\u90fd\u8981\u5148$ <code>git add</code> \u518d $ <code>git commit</code>","text":"<ul> <li>\u53ef\u4ee5\u60f3\u50cf\u4f60\u6709\u4e00\u500b\u5009\u5eab,\u5009\u5eab\u9580\u53e3\u6709\u500b\u5c0f\u5ee3\u5834,\u9019\u500b\u5ee3\u5834\u7684\u6982\u5ff5\u5c31\u50cf\u8ddf\u66ab\u5b58\u5340\u4e00\u6a23,\u4f60\u628a\u8981\u5b58\u653e\u5230\u5009\u5eab\u7684\u8ca8\u7269\u5148\u653e\u5230\u9019\u908a($ <code>git add</code>),\u7136\u5f8c\u7b49\u6536\u96c6\u7684\u5dee\u4e0d\u591a\u4e86\u5c31\u53ef\u4ee5\u6253\u958b\u5009\u5eab\u9580,\u628a\u653e\u5728\u5ee3\u5834\u4e0a\u7684\u8ca8\u7269\u9001\u9032\u5009\u5eab\u88e1($ <code>git commit -m</code>,\u4e26\u8a18\u9304\u4e0b\u4f86\u9019\u6279\u8ca8\u662f\u4ec0\u9ebc\u7528\u9014\u7684? &amp; \u8ab0\u9001\u4f86\u7684?)</li> </ul>"},{"location":"version_control/git/#gitid-sha-1","title":"Git\u7269\u4ef6\u7684id\u662f\u600e\u9ebc\u8a08\u7b97\u51fa\u4f86\u7684? (<code>SHA-1\u6f14\u7b97\u6cd5</code>)","text":"<ul> <li>\u5728Git\u7684Commit\u7269\u4ef6\u88e1\u6bcf\u4e32\u770b\u8d77\u4f86\u50cf\u4e82\u78bc\u7684\u6587\u5b57,\u90fd\u662f\u900f\u904eSHA-1\u6f14\u7b97\u6cd5\u8a08\u7b97\u51fa\u4f86\u7684\u7d50\u679c,\u662f\u4e00\u7a2e\u91cd\u8907\u7387\u6975\u4f4e\u7684\u6f14\u7b97\u6cd5;Git\u4f7f\u7528\u9019\u6a23\u7684\u5b57\u4e32\u4f5c\u70ba\u8b58\u5225,\u6bcf\u500bCommit\u7269\u4ef6\u90fd\u6709\u4e00\u500b\u9019\u6a23\u7684\u503c,\u4f60\u53ef\u4ee5\u628a\u5b83\u60f3\u50cf\u6210\u662f\u6bcf\u500bCommit\u7269\u4ef6\u7684\u8eab\u5206\u8b49\u5b57\u865f,\u4e0d\u6703\u91cd\u8907</li> </ul>"},{"location":"version_control/git/#head","title":"<code>HEAD</code>\u662f\u4ec0\u9ebc?","text":"<ul> <li><code>HEAD</code> \u662f\u4e00\u500b\u6307\u6a19,\u6703\u6307\u5411\u67d0\u4e00\u500b\u5206\u652f,\u6211\u5011\u901a\u5e38\u53ef\u4ee5\u628a<code>HEAD</code>\u7576\u4f5c\"\u76ee\u524d\u5206\u652f\"\u4f86; \u4e5f\u53ef\u4ee5\u5728<code>.git/HEAD</code>\u9019\u500b\u6a94\u6848\u88e1\u770b\u5230\u8a18\u9304\u8457<code>HEAD</code>\u7684\u5167\u5bb9</li> <li>$ <code>cat .git/HEAD</code>: \u986f\u793a\u76ee\u524d<code>HEAD</code>\u6307\u5411\u7684\u5206\u652f <ul> <li></li> </ul> </li> <li>$ <code>cat .git/refs/&lt;\u5206\u652f\u540d\u7a31&gt;</code>: \u6aa2\u8996\u76ee\u524dHEAD\u6307\u5411\u7684\u5206\u652f\u7684commit\u7269\u4ef6<ul> <li></li> </ul> </li> <li>\u7576\u5207\u63db\u5206\u652f\u6642,HEAD\u6307\u5411\u7684\u5206\u652f\u4e5f\u6703\u8f49\u8b8a<ul> <li>$ <code>git branch</code>: \u6aa2\u8996\u76ee\u524d\u6240\u6709\u7684\u5206\u652f\u6709\u54ea\u4e9b</li> <li>$ <code>git branch bird</code>: \u5efa\u7acb\u4e00\u500b\u65b0\u7684\u5206\u652f\u540d\u7a31\u70ba<code>bird</code></li> <li>$ <code>git checkout bird</code>:\u5207\u63db\u5230<code>bird</code>\u5206\u652f</li> <li>$ <code>cat .git/HEAD</code> : \u6aa2\u8996\u76ee\u524dHEAD\u6307\u5411\u7684\u662f\u54ea\u500b\u5206\u652f\u540d\u7a31 // <p>ref: refs/heads/bird </p> </li> <li>\u7e3d\u7d50: <code>.git/HEAD</code>\u7684\u5167\u5bb9(<code>.git/refs/heads/&lt;\u76ee\u524d\u6240\u5728\u5206\u652f\u7684\u540d\u7a31&gt;</code>\u6703\u96a8\u8457$ <code>git checkout &lt;\u5206\u652f\u540d\u7a31&gt;</code> \u800c\u6539\u8b8a)</li> </ul> </li> <li>\u88dc\u5145: \u5728Git <code>v1.8.5</code> \u4e4b\u5f8c\u7684\u7248\u672c\u958b\u59cb\u652f\u63f4,\u53ef\u4ee5\u7528 <code>\uff20</code> \u9019\u500b\u7b26\u865f\u4f86\u4ee3\u8868<code>HEAD</code><ul> <li><code>\u60c5\u5883\u8aaa\u660e</code> </li> <li>$ <code>git reset HEAD~2</code> = $ <code>git reset @~2</code></li> <li>$ <code>git reset HEAD^^</code>= $ <code>git reset @^^</code></li> <li>\u4ee5\u4e0a\u56db\u7a2e\u6307\u4ee4\u90fd\u662f\u76f8\u540c\u7684\u610f\u601d,\u4ee3\u8868\u8981\u56de\u5230\u76ee\u524d\u7684<code>HEAD\u6307\u6a19</code>\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>\u4ee5\u524d\u7684<code>2\u6b21``commit\u7d00\u9304</code>\u7684\u90a3\u6642\u5019</li> <li>\u53ef\u53c3\u8003 \u5982\u679c\u60f3\u91cd\u65b0\u7de8\u8f2f\u525b\u624d\u7684commit \u7ae0\u7bc0</li> </ul> </li> </ul>"},{"location":"version_control/git/#orig_head","title":"<code>ORIG_HEAD</code>\u662f\u4ec0\u9ebc?","text":"<ul> <li><code>ORIG_HEAD</code> \u662fGit\u7279\u5225\u7684\u4e00\u500b\u7d00\u9304\u9ede,\u9019\u500b\u7d00\u9304\u9ede\u6703\u81ea\u52d5\u8a18\u9304\u5728\"Git\u7684\u5371\u96aa\u64cd\u4f5c\"\u4ee5\u524d,\u7576\u4e0b\u7684<code>HEAD</code>\u6307\u5411\u7684<code>Commit\u7269\u4ef6\u7684id</code></li> <li>Git\u7684\"\u5371\u96aa\u64cd\u4f5c\"\u6709: <code>merge</code>\u3001<code>rebase</code>\u3001<code>reset</code></li> <li>$ <code>cat .git/ORIG_HEAD</code><ul> <li></li> </ul> </li> <li>\u53ef\u4ee5\u6aa2\u8996\u76ee\u524d\u7684 <code>ORIG_HEAD</code> \u7d00\u9304\u9ede\u662f\u6307\u5411\u54ea\u500b<code>Commit\u7269\u4ef6</code></li> <li>$ cat <code>.git/ORIG_HEAD</code><ul> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#branch_1","title":"<code>\u5206\u652f(branch)</code>\u662f\u4ec0\u9ebc?","text":"<ul> <li>\u5728Git\u88e1\u9762,<code>\u5206\u652f(branch)</code>\u5c31\u50cf\u8cbc\u7d19\u4e00\u6a23,\u5b83\u6703\u8cbc\u5728\u67d0\u500b<code>Commit\u7269\u4ef6</code>\u4e0a,\u4e26\u4e14\u6703\u96a8\u8457\u6bcf\u6b21\u7684commit\u8ddf\u8457\u79fb\u52d5</li> <li>\u6240\u4ee5<code>HEAD</code>\u6703\u6307\u5411\u4e00\u500b<code>\u5206\u652f(branch)</code>,\u4e26\u4e14<code>\u5206\u652f</code>\u6703\u6307\u5411\u4e00\u500b<code>Commit\u7269\u4ef6</code><ul> <li>\u901a\u5e38\u4f86\u8aaa<code>HEAD</code>\u6240\u6307\u7684\u90a3\u500b<code>\u5206\u652f(branch)</code>,\u6703\u8ddf\u8457\u65b0\u7684<code>Commit\u7269\u4ef6</code>\u524d\u9032(\u800c<code>HEAD</code>\u4e5f\u6703\u8ddf\u8457\u4e00\u8d77\u524d\u9032) </li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell </li> </ul> </li> <li>\u7576 $ <code>git checkout &lt;\u5206\u652f\u540d\u7a31orCommit\u7269\u4ef6&gt;</code>\u6642,Git\u6703\u4f9d\u64da\u7576\u4e0b\u7684\u9019\u500b<code>Commit\u7269\u4ef6</code>\u4f86\u9084\u539f\u5de5\u4f5c\u76ee\u9304(<code>working directory</code>)\u7684\u5167\u5bb9,\u4e26\u53c3\u8003 <code>.git/objects/</code> \u76ee\u9304\u88e1\u7684\u5167\u5bb9\u50cf\u62ce\u8461\u8404\u4e00\u6a23\u6574\u4e32\u5f9e\u982d\u7684\u5730\u65b9\u62ce\u8d77\u4f86,\u53ea\u8981\u5f9e\u6e90\u982d\u7684<code>Commit\u7269\u4ef6</code>\u62ce\u8d77\u4f86,\u6574\u4e32\u5167\u5bb9\u90fd\u53ef\u4ee5\u88ab\u62ff\u51fa\u4f86<ul> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://git-scm.com/docs/git-checkout</li> <li>\u6ce8\u610f! \u9019\u6642\u5019\u6709\u53ef\u80fd\u6703\u767c\u751f<code>Detached HEAD</code>\u7684\u60c5\u6cc1!</li> <li>\u7576\u4f7f\u7528 $ <code>git checkout &lt;Commit\u7269\u4ef6\u7684id&gt;</code> \u5f8c,\u8a72<code>Commit\u7269\u4ef6</code>\u525b\u597d\u76ee\u524d\u6c92\u6709\u5206\u652f(branch)\u6307\u5411\u5b83 </li> </ul> </li> <li>$ <code>git branch</code>: \u6aa2\u8996\u76ee\u524d\u6240\u6709\u7684\u5206\u652f\u6709\u54ea\u4e9b<ul> <li> </li> </ul> </li> <li>$ <code>git branch bird</code>: \u5efa\u7acb\u4e00\u500b\u65b0\u7684\u5206\u652f\u540d\u7a31\u70ba<code>bird</code><ul> <li></li> </ul> </li> <li>$ <code>git checkout bird</code>: \u5207\u63db\u5230<code>bird</code>\u5206\u652f<ul> <li>\u7576Git\u5728\u5207\u63db\u5206\u652f ($ <code>git checkout &lt;branch name&gt;</code>) \u7684\u6642\u5019\u6703\u505a\u4ee5\u4e0b\u5169\u4ef6\u4e8b\u60c5</li> <li>\u7528\u8a72\u5206\u652f\u6307\u5411\u7684\u90a3\u500b<code>Commit\u7269\u4ef6</code>\u7684\u5167\u5bb9\u4f86\"\u66f4\u65b0\"\u66ab\u5b58\u5340(staging area)\u4ee5\u53ca\u5de5\u4f5c\u76ee\u9304(working directory),\u7576\u5207\u63db\u5206\u652f\"\u4e4b\u524d\"\u6240\u505a\u7684\u4fee\u6539\u5167\u5bb9\u4ecd\u6703\u7559\u5728\u5de5\u4f5c\u76ee\u9304(working directory)\u4e0d\u53d7\u5f71\u97ff</li> <li>\u540c\u6642<code>HEAD</code>\u4e5f\u6703\u8ddf\u8457\u4e00\u8d77\u524d\u9032,\u6307\u5411\u525b\u525b\u5207\u63db\u904e\u53bb\u7684\u90a3\u500b\u5206\u652f(branch)</li> </ul> </li> <li>$ <code>git branch -m bird fish</code>: \u5c07<code>bird\u5206\u652f</code>\u66f4\u540d\u70ba<code>fish\u5206\u652f</code><ul> <li><code>-m</code> (=&gt; <code>--move</code>): \u79fb\u52d5or\u66f4\u540d <code>\u5206\u652f</code>(branch)\u548c\u5176\u76f8\u5c0d\u61c9\u7684<code>reflog</code></li> <li></li> </ul> </li> <li>$ <code>git branch -d fish</code>: \u5c07<code>fish</code>\u5206\u652f\u522a\u9664<ul> <li><code>-d</code> (=&gt; <code>--delete</code>): \u522a\u9664\u8a72\u5206\u652f</li> <li>\u88dc\u5145: \u53ea\u6709\u76ee\u524d\u6240\u5728\u7684\u5206\u652f\u4e0d\u80fd\u522a\u9664,\u53ea\u8981\u5148$ <code>git checkout</code> \u5207\u63db\u5230\u5225\u7684\u5206\u652f\u5f8c\u4e5f\u53ef\u4ee5\u522a\u9664\u539f\u672c\u6240\u5728\u7684\u90a3\u500b\u5206\u652f(\u5118\u7ba1\u662fmaster\u5206\u652f)</li> <li></li> </ul> </li> <li>\u6216\u662f $ <code>git branch -D fish</code>:\u5f37\u5236\u5c07\u5c1a\u672a\u5408\u4f75(merged)\u7684\u5206\u652f\u522a\u9664<ul> <li><code>-D</code> = <code>-d</code> + <code>-f</code> (=&gt; <code>--delete --force</code> \u7684\u7e2e\u5beb): \u5f37\u5236\u522a\u9664\u8a72\u5206\u652f( \u4e0d\u7ba1\u8a72\u5206\u652f\u662f\u5426\u5df2\u7d93\u5408\u4f75(merged)\u5230\u5176\u4e0a\u6e38\u5206\u652f(upstream branch) )</li> </ul> </li> <li>\u5408\u4f75\u904e\u5f8c\u7684\u5206\u652f,\u60f3\u522a\u9664\u5c31\u53ef\u4ee5\u522a\u9664,\u56e0\u70ba\u5206\u652f\u53ea\u662f\u4e00\u500b<code>40</code>\u5b57\u5143\u7684\u6a94\u6848\u800c\u5df2,\u5b83\u6703\u6a19\u8a18\u51fa\u5b83\u76ee\u524d\u662f\u6307\u5411\u54ea\u4e00\u500b<code>Commit\u7269\u4ef6</code>; \u6240\u4ee5<code>\u522a\u9664\u5206\u652f</code>\u9019\u500b\u52d5\u4f5c\u5c31\u50cf\u662f\u628a\u4e00\u5f35\u8cbc\u7d19\u6495\u8d77\u4f86\u7684\u6982\u5ff5\u800c\u5df2,\u539f\u4f86\u88ab\u9019\u5f35\u8cbc\u7d19\u8cbc\u8457\u7684\u6771\u897f\u4e26\"\u4e0d\u6703\"\u56e0\u6b64\u800c\u4e0d\u898b</li> <li>\u5728Git\u958b\u5206\u652f\u5176\u5be6\u5f88\"\u4fbf\u5b9c\",\u56e0\u70ba<code>\u5206\u652f(branch)</code>\u5176\u5be6\u5c31\u53ea\u662f\u4e00\u5f35<code>40</code>\u5b57\u5143(<code>\u67d0\u500bCommit\u7269\u4ef6\u7684SHA-1\u503c</code>)\u7684<code>\u8cbc\u7d19</code>,\u800c\u9019\u500b\u8cbc\u7d19\u6703\u6307\u5411\u5b83\u5c0d\u61c9\u7684<code>Commit\u7269\u4ef6\u7684id</code></li> <li>\u53ef\u6aa2\u8996 <code>.git/refs/heads/&lt;\u5206\u652f\u540d\u7a31&gt;</code> \u9019\u500b\u6a94\u6848\u88e1\u7684\u5167\u5bb9\u5c31\u662f\u8a72<code>\u5206\u652f(branch)</code>\u6307\u5411\u5b83\u5c0d\u61c9\u7684<code>Commit\u7269\u4ef6\u7684id</code><ul> <li>$ <code>ls -al .git/refs/heads/</code></li> <li> </li> <li></li> </ul> </li> <li>\u5982\u679c\u628a <code>.git/refs/heads/</code> \u76ee\u9304\u88e1\u9762\u7684\u5176\u4e2d\u4e00\u500b\u5206\u652f\u522a\u6389\u7684\u8a71,\u5c31\u76f8\u7576\u65bc\u522a\u9664\u5206\u652f\u4e86<ul> <li>$ <code>rm .git/refs/heads/&lt;\u8981\u522a\u9664\u7684\u5206\u652f\u540d\u7a31&gt;</code> </li> <li> </li> </ul> </li> <li>\u5982\u679c\u628a <code>.git/refs/heads</code> \u76ee\u9304\u88e1\u9762\u7684\u5176\u4e2d\u4e00\u500b\u5206\u652f\u540d\u7a31\u6539\u6389\u7684\u8a71,\u5c31\u76f8\u7576\u65bc\u4fee\u6539\u5206\u652f\u540d\u7a31\u4e86<ul> <li>$ <code>mv .git/refs/heads/&lt;\u539f\u5206\u652f\u540d\u7a31&gt; .git/refs/heads/&lt;\u65b0\u5206\u652f\u540d\u7a31&gt;</code></li> <li></li> </ul> </li> <li>Git\u5982\u4f55\u77e5\u9053\u73fe\u5728\u662f\u5728\u54ea\u4e00\u500b\u5206\u652f(branch)?</li> <li>\u53ef\u4ee5\u900f\u904eGit\u6307\u4ee4 $ <code>git branch -l</code><ul> <li><code>-l</code> (=&gt; <code>--list</code>): \u986f\u793a\u76ee\u524d\u6709\u54ea\u4e9b\u5206\u652f(<code>branch</code>)</li> </ul> </li> <li>\u53ef\u4ee5\u900f\u904e\u6aa2\u8996 <code>.git/HEAD</code> \u9019\u500b\u6a94\u6848,\u4f86\u5f97\u77e5HEAD\u6307\u6a19\u76ee\u524d\u6307\u5411\u7684\u662f\u54ea\u4e00\u500b\u5206\u652f(branch)<ul> <li>$ <code>cat .git/HEAD</code></li> <li></li> <li>\u7576\u5207\u63db\u5206\u652f(brach)\u6642, .git/HEAD \u7684\u5167\u5bb9\u4e5f\u6703\u540c\u6642\u8b8a\u52d5</li> <li>\u5148 $ <code>git checkout &lt;\u53e6\u4e00\u500b\u5206\u652f\u540d\u7a31&gt;</code></li> <li>\u518d $ <code>cat .git/HEAD</code></li> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#detached-head","title":"<code>Detached HEAD</code> (\u65b7\u982d) \u662f\u4ec0\u9ebc?","text":"<ul> <li><code>Detached HEAD</code> (\u65b7\u982d): \u6b63\u5e38\u60c5\u6cc1\u4e0b,HEAD\u6703\u6307\u5411\u67d0\u4e00\u500b\u5206\u652f,\u800c\u5206\u652f\u6703\u6307\u5411\u67d0\u4e00\u500bCommit\u7269\u4ef6\u3002\u4f46\u6709\u6642\u5019<code>HEAD</code>\u6703\u767c\u751f\"\u6c92\u6709\u8fa6\u6cd5\u6307\u5230\u67d0\u500b\u5206\u652f\"\u7684\u60c5\u6cc1,\u9019\u500b\u72c0\u614b\u7684<code>HEAD</code>\u5c31\u7a31\u70ba \"<code>detached HEAD(\u65b7\u982d)</code>\"</li> <li>\u4ee5\u4e0b\u662f3\u7a2e\u5e38\u898b\u7684\u539f\u56e0\u53ef\u80fd\u6703\u9020\u6210<code>Detached HEAD</code>\u7684\u72c0\u614b<ul> <li>\u4f7f\u7528 $ <code>git checkout &lt;Commit\u7269\u4ef6\u7684id&gt;</code> \u5f8c,\u8a72<code>Commit\u7269\u4ef6</code>\u525b\u597d\u76ee\u524d\u6c92\u6709\u5206\u652f(branch)\u6307\u5411\u5b83</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://git-scm.com/docs/git-checkout</li> <li>$ <code>git rebase</code> \u7684\u904e\u7a0b\u5176\u5be6\u4e5f\u662f\u4e0d\u65b7\u5730\u8655\u65bc<code>Detached HEAD</code>\u7684\u72c0\u614b</li> <li>\u5207\u63db\u5230\u67d0\u500b\u9060\u7aef\u5206\u652f(remote branch)\u7684\u6642\u5019</li> <li>\u4f8b\u5982: $ <code>git checkout -b test origin/test</code> </li> </ul> </li> <li>\u5728 <code>Detached HEAD</code> \u72c0\u614b\u4e0b\u5176\u5be6\u8ddf\u5e73\u5e38\u4e00\u6a23\u64cd\u4f5cGit,\u4e5f\u53ef\u4ee5\u9032\u884ccommit,\u53ea\u662fcommit\u5f8c,\u7576\u4e0b\u7684\u90a3\u500b<code>Commit\u7269\u4ef6</code>\u5c31\u53ea\u6703\u6709<code>HEAD</code>\u6307\u6a19\u6307\u5411\u5b83,\u9019\u6642\u5982\u679c\u5c07<code>HEAD</code>\u6307\u6a19\u5207\u63db\u5230\u5176\u4ed6\u5206\u652f\u7684\u8a71,\u9019\u500b<code>Commit\u7269\u4ef6</code>\u5c31\u5f88\u4e0d\u5bb9\u4ee5\u88ab\u627e\u56de\u4f86\u4e86(\u9664\u975e\u4f60\u6709\u8a18\u4e0b\u9019\u500b<code>Commit\u7269\u4ef6</code>\u7684id); \u5982\u679c\u4e00\u76f4\u6c92\u6709\u4eba\u4f86\u627e\u5b83\u7684\u8a71,\u5c31\u8981\u7b49\u5230Git\u81ea\u52d5\u89f8\u767c\u8cc7\u6e90\u56de\u6536\u6a5f\u5236\u4f86\u56de\u6536\u5b83\u4e86<ul> <li>\u9019\u60c5\u6cc1\u6703\u6709\u9ede\u985e\u4f3c\u65bc\u8981\u5f9e\u904e\u53bb\u7684<code>commit\u7d00\u9304</code>,\u518d\u9577\u4e00\u500b\u65b0\u7684\u5206\u652f\u51fa\u4f86\u7684\u60c5\u5883</li> <li>\u53ef\u53c3\u8003 \u5982\u679c\u60f3\u5f9e\u904e\u53bb\u7684\u67d0\u6b21commit\u7d00\u9304\u518d\u9577\u4e00\u500b\u65b0\u7684\u5206\u652f(branch)\u51fa\u4f86,\u8a72\u5982\u4f55\u505a\u5462? \u7ae0\u7bc0</li> <li>\u9019\u6642\u5982\u679c\u60f3\u7559\u4e0b\u9019\u500b<code>Commit\u7269\u4ef6</code>\u7684\u8a71,\u53ef\u4ee5\u5728\u8a72Commit\u7269\u4ef6\u4e0a\u5efa\u7acb\u4e00\u500b<code>\u5206\u652f(branch)</code>\u8cbc\u7d19\u8cbc\u5728\u4e0a\u9762</li> <li>$ <code>git branch &lt;\u8981\u65b0\u589e\u7684\u5206\u652f\u540d\u7a31&gt; &lt;\u8a72Commit\u7269\u4ef6\u7684id&gt;</code></li> <li>\u4e5f\u53ef\u4ee5\u5efa\u7acb\u65b0\u7684\u5206\u652f\u5f8c,\u76f4\u63a5\u5207\u63db\u5230\u8a72\u5206\u652f\u4e0a\u9762</li> <li>$ <code>git checkout -b &lt;\u8981\u65b0\u589e\u7684\u5206\u652f\u540d\u7a31&gt; &lt;\u8a72Commit\u7269\u4ef6\u7684id&gt;</code></li> </ul> </li> <li>\u5176\u5be6\u56b4\u683c\u4f86\u8aaa,\u7576<code>HEAD</code>\u6307\u6a19\u6c92\u6709\u6307\u5230\u67d0\u500b\"\u672c\u5730\"\u5206\u652f\u7684\u8a71,\u5c31\u6703\u5448\u73fe<code>Detached HEAD</code>\u7684\u72c0\u614b<ul> <li>$ <code>git branch -r</code>: \u5217\u51fa\u76ee\u524d\u6240\u6709\u7684<code>\u9060\u7aef\u5206\u652f(remote branch)</code></li> <li><code>-r</code> (=&gt; <code>--remotes</code>): \u5217\u51fa\u76ee\u524d\u6240\u6709\u7684<code>\u9060\u7aef\u5206\u652f(remote branch)</code></li> <li></li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u5982\u679c\u8981\u5207\u63db\u5230\u9060\u7aef\u5206\u652f,\u800c\u4e0d\u5e0c\u671b\u5448\u73fe<code>Detached HEAD</code>\u72c0\u614b,\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4<ul> <li>$ <code>git checkout -t origin/&lt;\u9060\u7aef\u5206\u652f\u540d\u7a31&gt;</code></li> <li><code>-t</code> (=&gt; <code>--track</code>): Git\u6703\u5728\u672c\u6a5f\u5efa\u7acb\u4e00\u500b<code>\u8ffd\u8e64\u5206\u652f</code>(tracking branch)</li> </ul> </li> <li>\u5982\u679c\u60f3\u8981\u7c21\u55ae\u4e00\u9ede\u4e5f\u53ef\u4ee5\u628a\u524d\u9762\u7684\"origin\"\u62ff\u6389,\u4e26\u76f4\u63a5\u5207\u63db\u5230<code>\u9060\u7aef\u5206\u652f</code>(remote branch)\u53bb<ul> <li>$ <code>git checkout &lt;\u9060\u7aef\u5206\u652f\u540d\u7a31&gt;</code> </li> </ul> </li> </ul> </li> <li>\u5982\u4f55\u96e2\u958b<code>Detached HEAD</code>\u72c0\u614b\u5462?<ul> <li>\u65e2\u7136\u5df2\u7d93\u77e5\u9053\u6240\u8b02\u7684<code>Detached HEAD</code>\u72c0\u614b\u53ea\u662f<code>HEAD</code>\u6307\u6a19\u6c92\u6709\u6307\u5411\u4efb\u4f55\u5206\u652f\u6240\u9020\u6210\u7684,\u8981\u812b\u96e2\u9019\u500b\u72c0\u614b,\u53ea\u8981\u8b93<code>HEAD</code>\u80fd\u6307\u5411\u4efb\u4f55\u4e00\u500b<code>\u5206\u652f(branch)</code>\u5c31\u53ef\u4ee5\u4e86</li> <li>\u4f8b\u5982: $ <code>git checkout master</code></li> <li>\u5c07\u76ee\u524d\u7684<code>HEAD\u6307\u6a19</code>\u6307\u5411<code>master\u5206\u652f</code>\u5c31\u53ef\u4ee5\u89e3\u9664<code>Detached HEAD</code>\u7684\u72c0\u614b\u4e86</li> </ul> </li> </ul>"},{"location":"version_control/git/#tag","title":"<code>Tag</code> (\u6a19\u7c64) \u662f\u4ec0\u9ebc?","text":"<ul> <li><code>Tag</code> (\u6a19\u7c64): \u662f\u4e00\u500b\u6307\u5411\u67d0\u4e00\u500b<code>Commit\u7269\u4ef6</code>\u7684\"\u6307\u6a19\"</li> <li>\u53ef\u5148\u53c3\u8003 Git \u7684\u56db\u5927\u7269\u4ef6(Blob, Tree, Commit, Tag)\u89c0\u5ff5\u4ecb\u7d39 \u7ae0\u7bc0</li> <li><code>Tag</code> (\u6a19\u7c64)\u4f9d\u64da\u5b98\u65b9\u6587\u4ef6\u6709\u4ee5\u4e0b3\u7a2e\u9069\u5408\u4f5c\u70ba\u7684\u7528\u9014       &gt; Annotated tags are meant for release while lightweight tags are meant for private or temporary object labels. <ul> <li>\u8edf\u9ad4\u7248\u672c\u865f(<code>release version</code>)</li> <li>\u500b\u4eba\u4f7f\u7528(<code>private</code>)</li> <li>\u66ab\u6642\u6a19\u8a18\u7528\u9014(<code>temporary object labels</code>)</li> </ul> </li> <li><code>Tag</code> (\u6a19\u7c64)\u53ef\u5206\u70ba\u5169\u7a2e\u5f62\u5f0f<ul> <li><code>\u8f15\u91cf\u6a19\u7c64</code>(lightweight tag): \u4e3b\u8981\u7528\u4f86\u4f5c\u70ba\u8edf\u9ad4\u7248\u672c\u865f(<code>release version</code>)</li> <li><code>\u8f15\u91cf\u6a19\u7c64</code>(lightweight tag)\u6703\u6307\u5411\u4e00\u500b<code>Commit\u7269\u4ef6</code> </li> <li>$ <code>git tag &lt;\u8f15\u91cf\u6a19\u7c64\u7684\u540d\u7a31&gt; &lt;\u8981\u6a19\u8a18\u5728\u54ea\u500bCommit\u7269\u4ef6\u4e0a\u7684id&gt;</code></li> <li>\u4f8b\u5982: $ <code>git tag refresh_hyperlink 19468c5</code>: \u9019\u6a23Git\u5c31\u6703\u5728\"19468c5\"\u9019\u500b<code>Commit\u7269\u4ef6</code>\u4e0a,\u5efa\u7acb\u4e00\u500b<code>\u8f15\u91cf\u6a19\u7c64</code>(lightweight tag)\u53eb\u505a\"refresh_hyperlink\"</li> <li></li> <li><code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(annotated tag): \u7528\u4f86\u4f5c\u70ba\u500b\u4eba\u4f7f\u7528(<code>private</code>)\u6216\u662f\u66ab\u6642\u6a19\u8a18\u7528\u9014(<code>temporary object labels</code>)</li> <li>\u6ce8\u610f: <code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(annotated tag)\u6703\u6307\u5411\u4e00\u500b<code>Tag\u7269\u4ef6</code>,\u800c\u9019\u500b<code>Tag\u7269\u4ef6</code>\u624d\u6703\u6307\u5411\u4e00\u500b<code>Commit\u7269\u4ef6</code></li> <li>$ <code>git tag &lt;\u8f15\u91cf\u6a19\u7c64\u7684\u540d\u7a31&gt; &lt;\u8981\u6a19\u8a18\u5728\u54ea\u500bCommit\u7269\u4ef6\u4e0a\u7684id&gt; -a -m \"refresh_form_width\"</code></li> <li>\u4f8b\u5982: $<code>git tag refresh_form_width 6894635 -a -m \"\u6709\u9644\u8a3b\u6a19\u7c64\u7684\u7df4\u7fd2\"</code>: \u9019\u6a23Git\u5c31\u6703\u5728\"6894635\"\u9019\u500b<code>Commit\u7269\u4ef6</code>\u4e0a,\u5efa\u7acb\u4e00\u500b<code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(annotated tag)\u53eb\u505a\"refresh_form_width\",\u4e26\u4e14\u65b0\u589e\u4e00\u500btag message\u53eb\u505a\"\u6709\u9644\u8a3b\u6a19\u7c64\u7684\u7df4\u7fd2\"<ul> <li><code>-a</code> (=&gt; <code>--annotate</code>): \u8acbGit\u5e6b\u5fd9\u5efa\u7acb\u4e00\u500b<code>\u6709\u9644\u8a3b\u6a19\u7c64</code></li> <li><code>-m</code> (=&gt; <code>--message</code>): \u5efa\u7acb\u4e00\u500b<code>\u6709\u9644\u8a3b\u6a19\u7c64</code>\u7684<code>\u8a0a\u606f</code>(tag message)</li> </ul> </li> <li></li> <li><code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(annotated tag)\u6703\u6709\u8a18\u9304\u66f4\u8a73\u7d30\u7684\u6a19\u7c64\u76f8\u95dc\u8cc7\u8a0a,\u901a\u5e38\u6703\u6709\u4ee5\u4e0b\u8cc7\u8a0a<ul> <li>\u8ab0\u8cbc\u7684\u6a19\u7c64?</li> <li>\u4ec0\u9ebc\u6642\u5019\u8cbc\u7684\u6a19\u7c64?</li> <li>\u70ba\u4ec0\u9ebc\u8981\u8cbc\u9019\u5f35\u6a19\u7c64? </li> </ul> </li> <li>\u65b0\u589e\u5b8c\u6a19\u7c64(<code>tag</code>)\u4ee5\u5f8c,\u53ef\u4ee5\u7528$ <code>git log --oneline</code>\u4f86\u6aa2\u8996\u76ee\u524d\u7684<code>commit\u7d00\u9304</code>\u7684\u60c5\u6cc1</li> <li><code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(annotated tag)\u7684\u8a0a\u606f\u91cf\u4e5f\u6703\u6bd4<code>\u8f15\u91cf\u6a19\u7c64</code>(lightweight tag)\u7684\u8a0a\u606f\u91cf\u591a</li> <li>$ <code>git show &lt;\u6a19\u7c64\u7684\u540d\u7a31&gt;</code>: \u53ef\u4ee5\u7528\u4f86\u6aa2\u8996\u5404\u7a2e\u7269\u4ef6\u7684\u578b\u614b<ul> <li>\u4f8b\u5982: $ <code>git show refresh_hyperlink</code> =&gt; \u6aa2\u8996<code>\u8f15\u91cf\u6a19\u7c64</code>(lightweight tag)\u7684\u578b\u614b</li> <li></li> <li>\u4f8b\u5982: $ <code>git show refresh_form_width</code> =&gt; \u6aa2\u8996<code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(annotated tag)\u7684\u578b\u614b</li> <li></li> </ul> </li> <li>\u4e5f\u53ef\u4ee5\u5230 <code>.git/refs/tags/</code> \u76ee\u9304\u88e1\u9762,\u6aa2\u8996\u6240\u6709\u7684\u6a19\u7c64</li> <li>$ <code>cat .git/refs/tags/&lt;\u6a19\u7c64\u7684\u540d\u7a31&gt;</code><ul> <li>\u5982\u679c\u662f<code>\u8f15\u91cf\u6a19\u7c64</code>,\u6703\u986f\u793a\u8a72\u6a19\u7c64(<code>tag</code>)\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>\u7684id</li> <li>\u5982\u679c\u662f<code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(annotated tag)\u6703\u986f\u793a\u5176\u6307\u5411\u7684<code>Tag\u7269\u4ef6</code>,\u800c\u9019\u500b<code>Tag\u7269\u4ef6</code>\u624d\u6703\u6307\u5411\u4e00\u500b<code>Commit\u7269\u4ef6</code>\u7684id</li> </ul> </li> <li>\u522a\u9664\u6a19\u7c64</li> <li>$ <code>git tag -d &lt;\u6a19\u7c64\u7684\u540d\u7a31&gt;</code>: \u5c07\u8a72<code>\u6a19\u7c64</code>\u522a\u9664<ul> <li>\u4f8b\u5982: $ <code>git tag -d refresh_hyperlink</code></li> <li><code>-d</code> (=&gt; <code>--delete</code>): \u522a\u9664\u5df2\u7d93\u5b58\u5728\u7684\u6a19\u7c64</li> </ul> </li> </ul> </li> </ul>"},{"location":"version_control/git/#git-git-gc","title":"Git\u7684\u8cc7\u6e90\u56de\u6536\u6a5f\u5236($ <code>git gc</code>)\u662f\u600e\u9ebc\u904b\u4f5c\u7684\u5462?","text":"<ul> <li>\u5728Git\u88e1,\u6bcf\u7576\u628a\u6a94\u6848\u52a0\u5165\u66ab\u5b58\u5340(staging area)\u6642,Git\u4fbf\u6703\u6839\u64da\"\u6a94\u6848\u5167\u5bb9\"\u88fd\u4f5c\u51fa<code>Blob\u7269\u4ef6</code>; \u6bcf\u7576\u5b8c\u6210<code>commit</code>,\u4fbf\u6703\u8ddf\u8457\u7522\u751f\u6240\u9700\u7684<code>Tree\u7269\u4ef6</code>\u4ee5\u53ca<code>Commit\u7269\u4ef6</code></li> <li>\u7576\u7269\u4ef6\u8d8a\u4f86\u8d8a\u591a,\u4e26\u9054\u5230\u89f8\u767cGit\u81ea\u52d5\u8cc7\u6e90\u56de\u6536\u7684\u6a5f\u5236(<code>Garbage Collection</code>)\u6642,Git\u6703\u5229\u7528\u9019\u500b\u6a5f\u5236\u4f86\u81ea\u52d5\u6574\u7406\u9019\u4e9b\u7269\u4ef6,\u540c\u6642\u4e5f\u6703\u628a<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6\u6e05\u6389 </li> <li>\u53ef\u4ee5\u5148\u53c3\u8003 Git\u5176\u5be6\u4e0d\u662f\u5728\u505a\u5dee\u7570\u5099\u4efd,\u800c\u662f\u5728\u70ba\u7576\u6642\u7684\u5c08\u6848\u5efa\u7acb\u5feb\u7167(snapshot) \u7ae0\u7bc0</li> <li>Git\u7684\u8cc7\u6e90\u56de\u6536\u6a5f\u5236($ <code>git gc</code>)\u6703\u81ea\u52d5\u56de\u6536\u6389<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6,\u4f46\u9700\u8981\u52a0\u4e0a <code>--prune=now</code> \u4f86\u642d\u914d\u4f7f\u7528,\u624d\u6703\u7576\u4e0b\u7acb\u5373\u5c31\u751f\u6548<ul> <li>\u53ef\u4ee5\u5148\u53c3\u8003 \u5982\u4f55\u628a\u4e00\u500b\u6a94\u6848\u5f9eGit\u7248\u63a7\u4e2d\u771f\u6b63\u7684\u79fb\u9664\u6389\u5462? \u7ae0\u7bc0</li> </ul> </li> <li>$ <code>git gc</code>\u5176\u5be6\u6703\u9ed8\u9ed8\u5730\u547c\u53eb$ <code>git prune</code>\u6307\u4ee4\u4f86\u6e05\u9664<code>Unreachable\u7269\u4ef6</code>,\u4f46$ <code>git prune</code>\u6307\u4ee4\u4e5f\u662f\u8981\u7d66\u5b83\u8a2d\u5b9a\u5230\u671f\u65e5,\u6240\u4ee5\u525b\u624d\u7684\u6307\u4ee4\u5176\u5be6\u539f\u7406\u5982\u4e0b<ul> <li>$ <code>git gc --prune=now</code>  =  $ <code>git gc</code> + $ <code>git prune --expire=now</code></li> </ul> </li> <li>\u9084\u6709\u4ec0\u9ebc\u65b9\u5f0f\u6703\u7522\u751f\u51fa<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6?</li> <li>\u7576\u5df2\u7d93\u5c07\u6a94\u6848\u52a0\u5165\u66ab\u5b58\u5340(staging area)\u5f8c,\u537b\u53c8\u5c07\u8a72\u6a94\u6848\u5f9eGit\u7248\u63a7\u4e2d\u79fb\u9664,\u812b\u96e2Git\u7684\u63a7\u7ba1,\u8b8a\u70ba<code>Untracked File</code>\u72c0\u614b</li> <li>\u56e0\u70ba\u4e00\u65e6Git\u7269\u4ef6\u7522\u751f\u5f8c,\u9664\u975e\u624b\u52d5\u9032 <code>.git/objects/</code> \u76ee\u9304\u8655\u7406\u6389,\u4e0d\u7136\u8a72\u7269\u4ef6\u5c31\u6703\u4e00\u76f4\u7559\u5728\u90a3\u908a\u4e86</li> <li>\u53ef\u5148\u53c3\u8003 Git\u5176\u5be6\u4e0d\u662f\u5728\u505a\u5dee\u7570\u5099\u4efd,\u800c\u662f\u5728\u70ba\u7576\u6642\u7684\u5c08\u6848\u5efa\u7acb\u5feb\u7167(snapshot) \u7684 <code>git ls-files -s</code> \u7ae0\u7bc0</li> <li>\u53ef\u5148\u53c3\u8003 <code>git rm --cached</code> V.S. <code>.gitignore</code> \u6bd4\u8f03 \u7ae0\u7bc0\u7684 $ <code>git rm --cached</code> \u90e8\u5206</li> <li><code>\u60c5\u5883\u8aaa\u660e</code><ul> <li>$ <code>echo \"\u624b\u52d5\u7522\u751f\u4e00\u500bUnreachable\u7269\u4ef6\" &gt; unreachable.html</code></li> <li>$ <code>git add unreachable.html</code></li> <li>$ <code>git ls-files -s</code></li> <li>\u628a\u6a94\u6848\u52a0\u5230\u66ab\u5b58\u5340(staging area)\u5f8c,\u6aa2\u8996\u4e00\u4e0b\u76ee\u524d\u7684Git\u7269\u4ef6\u5217\u8868(\u5305\u542b\u5de5\u4f5c\u76ee\u9304 &amp; \u66ab\u5b58\u5340 \u4e2d\u7684)</li> <li>$ <code>git rm --cached unreachable.html</code></li> <li>\u5c07<code>unreachable.html</code>\u9019\u500b\u6a94\u6848\u5f9eGit\u63a7\u7ba1\u4e2d\u79fb\u9664,\u812b\u96e2Git\u63a7\u7ba1,\u8b8a\u70ba<code>Untracked file</code>\u72c0\u614b</li> <li>$ <code>git fsck --unreachable</code></li> <li>\u6703\u986f\u793a\u76ee\u524d<code>unreachable.html</code>\u9019\u500b\u6a94\u6848\u6210\u70ba<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6</li> <li></li> <li>$ <code>git cat-file -p &lt;\u8a72Unreachable\u72c0\u614b\u7684Blob\u7269\u4ef6\u7684id&gt;</code></li> <li></li> </ul> </li> <li>\u88ab\u522a\u9664\u7684<code>\u6a19\u7c64</code>(Tag)\u7269\u4ef6,\u4e5f\u6703\u6210\u70ba<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6<ul> <li>\u53ef\u5148\u53c3\u8003 Tag (\u6a19\u7c64) \u662f\u4ec0\u9ebc? \u7ae0\u7bc0 </li> <li>$ <code>git tag -a unreachable_object -m \"\u522a\u9664Tag\u7269\u4ef6\u5f8c,\u6703\u7522\u751fUnreachable\u72c0\u614b\u7684\u7269\u4ef6\"</code></li> <li>\u5efa\u7acb\u4e00\u500b<code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(Annotated Tag),\u56e0\u70ba<code>\u6a19\u7c64</code>(Tag)\u7269\u4ef6\u539f\u672c\u662f\u6307\u5411\u67d0\u500b<code>Commit\u7269\u4ef6</code>,\u4f46\u7576\u8a72\u6709\u9644\u8a3b\u6a19\u7c64\u88ab\u522a\u9664\u6642,\u9019\u500b\u88ab\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>\u5c31\u6703\u8b8a\u6210<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6</li> <li>$ <code>git tag -d unreachable_object</code></li> <li>\u522a\u9664\u8a72<code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(Annotated Tag)</li> <li>$ <code>git fsck --unreachable</code></li> <li>\u6703\u986f\u793a\u9019\u500b\u88ab\u522a\u9664\u7684Tag\u7269\u4ef6(<code>unreachable_object</code>),\u8a72\u6a94\u6848\u6703\u8b8a\u6210\u70ba<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6</li> <li>\u56e0\u70ba\u5b83\u4e0d\u50cf<code>Commit\u7269\u4ef6</code>,\u9084\u6703\u6709<code>Reflog</code>\u5c0d\u5b83\u5ff5\u5ff5\u4e0d\u5fd8,\u5df2\u7d93\u6c92\u6709\u5176\u4ed6\u7269\u4ef6\u6216\u6307\u6a19\u6307\u5411\u9019\u500b<code>Tag\u7269\u4ef6</code>,\u6240\u4ee5\u9019\u500b\u5df2\u88ab\u522a\u9664\u7684<code>Tag\u7269\u4ef6</code>\u5c31\u6703\u7acb\u523b\u8b8a\u6210<code>Unreachable\u72c0\u614b</code></li> </ul> </li> <li>\u5728\u505a<code>Rebase</code>\u7684\u6642\u5019,\u5176\u5be6\u4e5f\u6703\u7522\u751f\u51fa\u591a\u500b<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6<ul> <li>\u53ef\u5148\u53c3\u8003 \u5206\u652f(branch)\u64cd\u4f5c \u7ae0\u7bc0\u7684 <code>git rebase</code> \u539f\u7406\u7684\u90e8\u5206</li> <li>\u56e0\u70ba\u5728<code>Rebase</code>\u7684\u904e\u7a0b\u4e2d,Git\u6703\u628a\u539f\u672c\u7684<code>Commit\u7269\u4ef6</code>\u5011\u5206\u5225\u8907\u88fd\u4e00\u4efd\u5230\u65b0\u7684<code>base\u5206\u652f</code>\u4e0a\u4e26\u4e14\u91cd\u65b0\u8a08\u7b97\u4e00\u4efd\u65b0\u7684<code>SHA-1</code>\u503c\u7d66\u9019\u4e9b\u65b0\u7684<code>Commit\u7269\u4ef6</code>; \u540c\u6642,\u6700\u5f8c<code>\u5206\u652f</code>\u8207<code>HEAD</code>\u4e5f\u90fd\u6703\u9077\u79fb\u904e\u53bb\u65b0\u7684<code>Commit\u7269\u4ef6</code>\u4e0a,\u6240\u4ee5\u9019\u6642\u5019\u539f\u672c\u820a\u7684\u90a3\u4e9b<code>Commit\u7269\u4ef6</code>\u5011,\u5c31\u6703\u8b8a\u6210<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6\u5011</li> </ul> </li> <li>\u7e3d\u7d50: \u5728Git\u7684\u4e16\u754c\u4e2d<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6\u5176\u5be6\u662f\u9084\u883b\u5e38\u898b\u5230\u7684,\u4ee5\u4e0b\u60c5\u6cc1\u90fd\u6703\u7522\u751f\u51fa<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6<ul> <li>\u5229\u7528$ <code>git reset --hard</code>\u5207\u5230\u5225\u7684<code>Commit\u7269\u4ef6</code>\u4e0a\u5f8c,\u4e26\u4e14\u5c07<code>Reflog</code>\u8a2d\u5b9a\u70ba\u5df2\u5230\u671f\u5f8c; \u9019\u6642\u5019\u5728<code>Reset</code>\u4e4b\u524d,Git\u539f\u672c\u6307\u5411\u7684\u90a3\u4e9b<code>Commit\u7269\u4ef6</code>\u5c31\u6703\u8b8a\u6210<code>Unreachable\u72c0\u614b</code></li> <li>\u65b0\u589e\u4e00\u500b\u6a94\u6848,\u7528$ <code>git add</code>\u52a0\u5230\u66ab\u5b58\u5340\u5f8c,\u53c8\u7528\u4e86$ <code>git rm --cached</code>\u5c07\u8a72\u6a94\u6848\u5f9eGit\u63a7\u7ba1\u4e2d\u79fb\u9664,\u812b\u96e2Git\u63a7\u7ba1,\u8b8a\u70ba<code>Untracked file</code>\u72c0\u614b</li> <li>\u5982\u679c\u5728<code>commit</code>\u4e4b\u524d,\u6a94\u6848$ <code>git add</code>\u4e4b\u5f8c\u53c8\u518d\u4fee\u6539,\u7136\u5f8c\u518d\u57f7\u884c$ <code>git add</code>\u6307\u4ee4,\u4e5f\u6703\u7522\u751f\u51fa<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6</li> <li>\u5373\u4fbf\u662f$ <code>git commit --amend</code>\u9019\u7a2e\u55ae\u7d14\u4fee\u6539<code>commit message</code>\u7684\u6307\u4ee4\u4e5f\u6703\u7522\u751f\u51fa<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6</li> <li>\u88ab\u522a\u9664\u7684<code>\u6a19\u7c64</code>(Tag)\u7269\u4ef6,\u4e5f\u6703\u6210\u70ba<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6</li> <li>\u5728\u505a<code>Rebase</code>\u7684\u6642\u5019,\u5176\u5be6\u4e5f\u6703\u7522\u751f\u51fa\u591a\u500b<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6</li> </ul> </li> </ul>"},{"location":"version_control/git/#_5","title":"\u89c0\u5ff5\u91d0\u6e05","text":"<p><code>git ls-files</code> - Show information about files in the index and the working tree <code>git verify-pack</code> - Validate packed Git archive files <code>Unreachable Object</code> - \u6c92\u6709\u4efb\u4f55\u7269\u4ef6\u6216\u6307\u6a19\u6307\u8457\u5b83,\u5982\u540c\u5b57\u9762\u4e0a\u8aaa\u7684\"\u7121\u6cd5\u5230\u9054\u7684\"; \u4f46\u5b83\u4ecd\u53ef\u4ee5\u6307\u5411\u5176\u4ed6\u7269\u4ef6 <code>Dangling Object</code> - \u8ddf<code>Unreachable\u7269\u4ef6</code>\u4e00\u6a23,\u6c92\u6709\u4efb\u4f55\u7269\u4ef6\u6216\u6307\u6a19\u6307\u8457\u5b83,\u5b83\u4e5f\u6c92\u6709\u6307\u8457\u5176\u4ed6\u7269\u4ef6,\u5982\u540c\u5b8c\u5168\"\u61f8\u5728\u5929\u908a\"\u7684\u4e00\u9846\u7269\u4ef6</p>"},{"location":"version_control/git/#git_10","title":"Git\u7121\u6cd5\u63a7\u7ba1 <code>\u7a7a\u76ee\u9304/</code>","text":"<ul> <li>Git\u5728\u7522\u751f\u7269\u4ef6\u6642,\u53ea\u5728\u4e4e\"\u6a94\u6848\u5167\u5bb9\",\u6240\u4ee5\u5982\u679c\u53ea\u662f\u65b0\u589e\u4e00\u500b\"\u7a7a\u7684\u76ee\u9304\",Git\u662f\u6c92\u6709\u8fa6\u6cd5\u8655\u7406\u8a72\u7a7a\u76ee\u9304\u7684</li> <li>\u539f\u56e0: Git\u6703\u5c0d\u6a94\u6848\u7684\"\u5167\u5bb9\"\u4f7f\u7528<code>SHA-1</code>\u6f14\u7b97\u6cd5\u8a08\u7b97\u7136\u5f8c\u518d<code>.git/objects/</code>\u76ee\u9304\u88e1,\u5efa\u7acb\u5c0d\u61c9\u7684\u76ee\u9304\u53ca\u6a94\u6848,\u5982\u679c\u662f\u4e00\u500b\u7a7a\u76ee\u9304\u7684\u8a71,\u5c31\u6c92\u6709\"\u5167\u5bb9\"\u53ef\u4ee5\u8a08\u7b97,\u6240\u4ee5Git\u9023\u611f\u61c9\u90fd\u611f\u61c9\u4e0d\u5230,\u56e0\u6b64<code>\u7a7a\u76ee\u9304</code>\u5c0dGit\u4f86\u8aaa\u9023<code>Untracked file</code>\u90fd\u7a31\u4e0d\u4e0a\u5594</li> <li>\u7a7a\u7684\u76ee\u9304\u4e5f\u4e0d\u6703\u88abcommit</li> <li></li> <li>\u5982\u679c\u9084\u662f\u60f3\u8b93\u7a7a\u76ee\u9304\u88abGit\u8ffd\u8e64,\u53ea\u8981\u5728\u7a7a\u76ee\u9304\u4e2d\u96a8\u4fbf\u653e\u4e00\u500b\u6a94\u6848\u5c31\u884c\u4e86,\u6163\u4f8b\u4e0a\u7fd2\u6163\u653e<code>.keep</code> \u6216\u662f <code>.gitkeep</code> \u7684\u7a7a\u6a94\u6848,\u8b93Git\u80fd\"\u611f\u61c9\"\u5230\u9019\u500b\u76ee\u9304\u7684\u5b58\u5728</li> <li></li> <li>\u5229\u7528$ <code>git status</code> \u5c31\u53ef\u4ee5\u770b\u5230Git\u611f\u61c9\u5230\u9019\u500b\u76ee\u9304(empty_dir)\u7684\u5b58\u5728\u4e86,\u5176\u5be6\u662f\u611f\u61c9\u5230\u88e1\u2faf\u90a3\u500b <code>.gitkeep</code> \u6a94\u6848\u7684\u5b58\u5728</li> </ul>"},{"location":"version_control/git/#git-rm-cached-vs-gitignore","title":"$ <code>git rm --cached</code> V.S. <code>.gitignore</code> \u6bd4\u8f03","text":"<ul> <li>$ <code>git rm --cached</code> V.S. <code>.gitignore</code> \u6bd4\u8f03</li> <li>$ <code>git rm xxx.html --cached</code>:\u4e26\u4e0d\u6703\u5c07\u6a94\u6848\u771f\u7684\u522a\u9664\u6389,\u50c5\u628a\u66ab\u5b58\u5340(staging area)\u8a72\u6a94\u6848\u5f9eGit\u63a7\u7ba1\u4e2d\u79fb\u9664,\u812b\u96e2Git\u63a7\u7ba1,\u8b8a\u70ba<code>Untracked file</code>\u72c0\u614b;\u82e5\u539f\u672c\u5728\u5de5\u4f5c\u76ee\u9304(working directory)\u4e2d\u7684\u6a94\u6848,\u4e0d\u7ba1\u662f\u5426\u6709\u505a\u904e\u4fee\u6539(modified)\u90fd\u5c07\u7559\u4e0b</li> <li>$ <code>.gitignore</code>:\u662f\u958b\u767c\u8005\u6307\u5b9a\u597d\u8981Git\u7248\u63a7\"\u5ffd\u7565\"\u6389\u7684\u6a94\u6848\u548c\u898f\u5247,\u8a2d\u5b9a\u597d\u5f8c,Git\u5c31\u4e0d\u6703\u63a7\u7ba1\u9019\u4e9b\u6a94\u6848\u4e86</li> </ul>"},{"location":"version_control/git/#git-git","title":"\u5728\u5c08\u6848\u4e2d\u7684\u6574\u500b<code>.git/</code> \u76ee\u9304\u662fGit\u7248\u63a7\u7684\u6838\u5fc3\u6a94\u6848","text":"<ul> <li>\u7576\u6a94\u6848\u88ab\u522a\u9664\u6642\u90fd\u9084\u80fd\u5c31\u56de\u4f86,\u56e0\u70ba\u6574\u500bGit\u7d00\u9304\u90fd\u662f\u653e\u5728\u8a72\u5c08\u6848\u7684\u6839\u76ee\u9304 <code>.git/</code> \u76ee\u9304\u88e1\u9762,\u6240\u4ee5\u5982\u679c\u771f\u7684\u4e0d\u5c0f\u5fc3\u628a <code>.git/</code> \u522a\u6389\u7684\u8a71,\u5c31\u8868\u793a\u6b77\u53f2\u7d00\u9304\u4e5f\u88ab\u522a\u6389\u4e86,\u5c31\u771f\u7684\u6c92\u6551\u4e86...</li> </ul>"},{"location":"version_control/git/#git-reset-commit","title":"$ <code>git reset</code> \u662f\u7528\u4f86\"\u524d\u5f80\"\u5230\u6307\u5b9a\u7684<code>Commit\u7269\u4ef6</code>\u4e0a\u7684","text":"<ul> <li>$ <code>git reset</code>\u7684Reset\u9019\u500b\u82f1\u6587\u55ae\u5b57\u5728\u4e2d\u6587\u7ffb\u8b6f\u662f\"\u91cd\u65b0\u8a2d\u5b9a\",\u4f46\u4e8b\u5be6\u4e0a$ <code>git reset</code>\u6307\u4ee4\u6bd4\u8f03\u50cf\u662f\"\u524d\u5f80\"\u6216\u662f\"\u8b8a\u6210\",\u4e5f\u5c31\u662f\"go to\"\u6216\u662f\"become\"\u7684\u6982\u5ff5</li> <li>\u4f8b\u5982: $ <code>git reset HEAD~2</code></li> <li>\u9019\u500b\u6307\u4ee4\u61c9\u8a72\u8981\u89e3\u8b80\u6210,\"\u6211\u8981\u524d\u5f80\u5169\u500bcommit\u4e4b\u524d\u7684\u72c0\u614b\" \u6216\u662f \"\u6211\u8981\u8b8a\u6210\u5169\u500bcommit\u4e4b\u524d\u7684\u72c0\u614b\",\u800c\u96a8\u8457\u4f7f\u7528\u4e0d\u540c\u7684\u53c3\u6578\u6a21\u5f0f(<code>mixed or soft or hard</code>),\u539f\u672c\u7684\u9019\u4e9b\u6a94\u6848\u5c31\u6703\u88ab\u4e1f\u5230\u4e0d\u540c\u7684\u5340\u57df</li> <li>\u5be6\u969b\u4e0a$ <code>git reset</code>\u6307\u4ee4\u4e5f\u4e0d\u662f\u771f\u7684\u522a\u9664\u6216\u662f\u91cd\u65b0\u8a2d\u5b9acommit,\u53ea\u662f\"\u524d\u5f80\"\u5230\u6307\u5b9a\u7684commit\u7269\u4ef6\u4e2d,\u90a3\u4e9b\u770b\u8d77\u4f86\u597d\u50cf\u4e0d\u898b\u7684\u6771\u897f\u53ea\u662f\u66ab\u6642\u770b\u4e0d\u5230,\u4f46\u5176\u5be6\u96a8\u6642\u90fd\u53ef\u4ee5\u518d\u64bf\u56de\u4f86</li> </ul>"},{"location":"version_control/git/#gitblobtreecommittag","title":"Git\u56db\u5927\u7269\u4ef6(<code>Blob</code>,<code>Tree</code>,<code>Commit</code>,<code>Tag</code>)\u5f7c\u6b64\u4e4b\u9593\u5176\u5be6\u662f\u5e73\u884c\u95dc\u4fc2","text":"<ul> <li>Git\u7684\u56db\u5927\u7269\u4ef6(<code>Blob</code>,<code>Tree</code>,<code>Commit</code>,<code>Tag</code>)\u5f7c\u6b64\u4e4b\u9593\u662f\"\u6c92\u6709\"\u968e\u5c64\u6216\u662f\u76ee\u9304,\u5b50\u76ee\u9304\u7684\u95dc\u4fc2,\u5927\u5bb6\u90fd\u662f\u5e73\u884c\u7684\u95dc\u4fc2,\u6b64\u95dc\u4fc2\u93c8\u7a31\u70baDAG(Directed Acyclic Graph),\u4e2d\u6587\u4e0a\u7a31\u70ba\"\u6709\u5411\u7121\u5faa\u74b0\u5716\"</li> </ul>"},{"location":"version_control/git/#gitsnapshot","title":"Git\u5176\u5be6\u4e0d\u662f\u5728\u505a\u5dee\u7570\u5099\u4efd,\u800c\u662f\u5728\u70ba\u7576\u6642\u7684\u5c08\u6848\u5efa\u7acb\u5feb\u7167(snapshot)","text":"<ul> <li>Git \u4e0d\u662f\u5728\u505a\u5dee\u7570\u5099\u4efd,\u800c\u662f<code>\u70ba\u7576\u6642\u7684\u5c08\u6848\u8cc7\u6599\u5efa\u7acb\u5feb\u7167(Snapshot)</code>,\u5982\u679c\u5c08\u6848\u5167\u6c92\u6709\u8b8a\u66f4\u7684\u6a94\u6848\u5c31\u4e0d\u6703\u591a\u5132\u5b58\u4e00\u4efd\u4f86\u4f54\u7528\u78c1\u789f\u7a7a\u9593,\u800c\u53ea\u662f\u589e\u52a0\u4e86\u4e00\u7b46\u9019\u500b\u6a94\u6848\u7684\u5c0d\u61c9\u9023\u7d50,\u958b\u767c\u8005\u958b\u555f\u65b0\u7248\u672c\u5b58\u53d6\u9019\u500b\u6a94\u6848\u6642,\u9084\u662f\u958b\u555f\u5148\u524d\u7684\u820a\u7248\u6a94\u6848,\u800c\u4e0d\u662f\u958b\u555f\u5167\u5bb9\u76f8\u540c\u7684\u65b0\u526f\u672c</li> <li>\u56e0\u6b64,\u53ea\u8981\u8a72\u6a94\u6848\u7684\u5167\u5bb9\u6539\u4e86\u4e00\u500b\u5b57,\u56e0\u70ba\u8a08\u7b97\u51fa\u4f86\u7684<code>SHA-1\u503c</code>\u4e0d\u540c,Git\u5c31\u6703\u70ba\u5b83\u505a\u51fa\u4e00\u9846\u5168\u65b0\u7684<code>Blob\u7269\u4ef6</code>,\u800c\"\u4e0d\u662f\u53ea\u8a18\u9304\u5dee\u7570\"</li> <li>Git\u5728\u88fd\u4f5c\u65b0\u7684<code>Blob\u7269\u4ef6</code>\u6642\u6703\u5148\u9032\u884c\u58d3\u7e2e,\u4f46\u70ba\u4e86\u56e0\u61c9\"\u5176\u5be6\u53ea\u4fee\u6539\u4e86\u4e00\u9ede\u9ede\u5c31\u8981\u6574\u500b\u6a94\u6848\u91cd\u65b0\u5099\u4efd\u4e00\u904d\"\u7684\u4f5c\u6cd5\u800c\u6709\u9ede\u6d6a\u8cbb\u786c\u789f\u7684\u5132\u5b58\u7a7a\u9593,<code>Git\u6709\u4e00\u5957\u81ea\u5df1\u7684\u8cc7\u6e90\u56de\u6536\u6a5f\u5236</code></li> <li>Git\u7684<code>\u8cc7\u6e90\u56de\u6536\u6a5f\u5236</code>,\u7576\u9019\u500b\u6a5f\u5236\"\u89f8\u767c\"\u7684\u6642\u5019( \u901a\u5e38\u6703\u5728Git\u89ba\u5f97\u8a72\u5c08\u6848\u7684\u7269\u4ef6(objects)\u592a\u591a\u6642 ),Git\u6703\u4ee5\u975e\u5e38\u6709\u6548\u7387\u7684\u65b9\u5f0f\u58d3\u7e2e\u7269\u4ef6\u4ee5\u53ca\u88fd\u4f5c\u7d22\u5f15 <ul> <li><code>\u60c5\u5883\u8aaa\u660e</code>:</li> <li>$ <code>git ls-files -s</code>: \u6aa2\u8996\u66ab\u5b58\u5340(staging area)\u548c\u5de5\u4f5c\u76ee\u9304(working directory)\u4e2d\u7684\u6a94\u6848\u60c5\u6cc1</li> <li><code>-s</code> (=&gt; <code>--stage</code>): \u986f\u793a\u66ab\u5b58\u5340(staging area)\u7684\u6a94\u6848\u8cc7\u8a0a</li> <li></li> <li>$ <code>git gc</code>: \u6e05\u9664\u975e\u5fc5\u8981(unnecessary)\u7684\u6a94\u6848\u548c\u512a\u5316\u672c\u5730\u7aef\u5132\u5b58\u5eab(local repository)\u7684\u7a7a\u9593 </li> <li></li> <li>\u9019\u500b\u6307\u4ee4\u6703\u628a\u539f\u672c\u653e\u5728 <code>.git/objects/</code> \u76ee\u9304\u4e0b\u7684\u90a3\u4e9b\u7269\u4ef6\u5168\u90e8\u6253\u5305\u5230 <code>.git/objects/pack/</code> \u76ee\u9304\u4e0b</li> <li></li> <li>$ <code>git verify-pack -v</code> &lt;<code>.git/objects/pack/pack-xxxxxx.idx</code>&gt;: \u78ba\u8a8dGit\u6253\u5305(packed)\u597d\u7684\u6a94\u6848\u60c5\u6cc1</li> <li><code>-v</code>(=&gt; <code>--verbose</code>): \u986f\u793a\u6253\u5305\u904e\u5f8c\u7684\u6a94\u6848\u8a73\u7d30\u8cc7\u8a0a </li> <li>\u7b2c\u4e00\u6b04: <code>SHA-1\u503c</code></li> <li>\u7b2c\u4e8c\u6b04: <code>\u7269\u4ef6\u7684\u578b\u614b</code></li> <li>\u7b2c\u4e09\u6b04: <code>\u6a94\u6848\u5927\u5c0f</code></li> </ul> </li> <li>\u7d71\u6574: Git\u4ec0\u9ebc\u6642\u5019\u6703\u81ea\u52d5\u89f8\u767c<code>\u8cc7\u6e90\u56de\u6536\u6a5f\u5236</code>\u5462?<ul> <li>\u7576\u5728 <code>.git/objects/</code> \u76ee\u9304\u4e0b\u7684\u7269\u4ef6\u6216\u662f\u6253\u5305\u904e\u7684packfile\u6578\u91cf\u904e\u591a\u7684\u6642\u5019,Git\u6703<code>\u81ea\u52d5\u89f8\u767c\u8cc7\u6e90\u56de\u6536\u6307\u4ee4</code></li> <li>\u7576\u57f7\u884c $ <code>git push</code> \u6307\u4ee4\u628a\u5167\u5bb9\u63a8\u81f3\u9060\u7aef\u4f3a\u670d\u5668\u6642</li> </ul> </li> </ul>"},{"location":"version_control/git/#catdogdogcat","title":"\u628a<code>cat\u5206\u652f</code>\u5408\u4f75\u5230<code>dog\u5206\u652f</code>&amp;\u628a<code>dog\u5206\u652f</code>\u5408\u4f75\u5230<code>cat\u5206\u652f</code>\u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?","text":"<ul> <li>\u5728Git\u4e2d,\u5408\u4f75\u5206\u652f\u662f<code>\u54ea\u500b\u5206\u652f</code>\u5408\u4f75\u6389<code>\u54ea\u500b\u5206\u652f</code>\u5176\u5be6\u6c92\u6709\u592a\u5927\u5dee\u7570</li> <li><code>\u60c5\u5883\u8aaa\u660e</code><ul> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/</li> <li>\u7576<code>cat\u5206\u652f</code>\u548c<code>dog\u5206\u652f</code>\u90fd\u662f\u4f86\u81ea<code>master\u5206\u652f</code>\u6642</li> <li>\u5047\u8a2d\u9019\u6b21\u662f<code>cat\u5206\u652f</code>\u8981\u5408\u4f75\u6389<code>dog\u5206\u652f</code>,\u70ba\u4e86\u8981\u9032\u884c\u9019\u6b21\u7684\u5408\u4f75,Git\u6703\u505a\u51fa\u4e00\u500b\u65b0\u7684<code>Commit\u7269\u4ef6</code>,\u800c\u9019\u500b\u65b0\u7684<code>Commit\u7269\u4ef6</code>\u6703\u5206\u5225\u6307\u5411<code>cat\u5206\u652f</code>\u548c<code>dog\u5206\u652f</code>,\u800c<code>HEAD</code>\u6703\u7e7c\u7e8c\u96a8\u8457<code>cat\u5206\u652f</code>\u5f80\u524d,\u800c<code>dog\u5206\u652f</code>\u6703\u7559\u5728\u539f\u5730</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/</li> </ul> </li> <li>\u7d50\u8ad6: \u5176\u5be6\u4ee5\"\u7d50\u679c\"\u4f86\u770b,\u8ab0\u5408\u4f75\u8ab0\u5176\u5be6\u6c92\u5dee,\u56e0\u70ba\u5408\u4f75\u5f8c\u7522\u751f\u7684\u65b0\u7684<code>Commit\u7269\u4ef6</code>\u7684\u5167\u5bb9\u90fd\u5305\u542b\u4e86\u5169\u500b\u539f\u4f86\u7684\u5206\u652f(<code>cat</code> &amp; <code>dog</code>)<ul> <li>\u7d30\u7bc0\u63d0\u9192: \u9019\u5169\u500b\u5206\u652f\u90fd\u662f\u5e73\u7b49\u95dc\u4fc2,\u7d30\u5fae\u7684\u5dee\u7570\u662f<code>cat</code>\u5408\u4f75\u6389<code>dog</code>\u5206\u652f\u7684\u8a71,<code>cat\u5206\u652f</code>\u6703\u5f80\u524d\u79fb\u52d5</li> <li>\u7d30\u7bc0\u63d0\u9192: \u5408\u4f75\u5206\u652f\u5f8c\u800c\u7522\u751f\u7684\u65b0\u7684<code>Commit\u7269\u4ef6</code>\u5176\u5be6\u88e1\u9762\u6703\u7d00\u9304\u8ab0\u662f\u8ab0\u7684\u8001\u7238,\u7576<code>cat</code>\u5408\u4f75<code>dog\u5206\u652f</code>\u7684\u8a71,<code>cat\u5206\u652f</code>\u5c31\u6703\u5beb\u5728\u524d\u9762</li> <li>\u53ef\u4ee5\u7528$ <code>git cat-file -p &lt;\u7269\u4ef6id&gt;</code> \u4f86\u6aa2\u8996\u8a72<code>Commit\u7269\u4ef6</code>\u7684<code>Parent</code>(\u901a\u5e38\u6703\u6307\u5411\u524d\u4e00\u6b21\u7684<code>Commit\u7269\u4ef6</code>)\u662f\u6307\u5411\u54ea\u500b<code>Commit\u7269\u4ef6</code></li> <li>\u53ef\u53c3\u8003 Git \u7684\u56db\u5927\u7269\u4ef6(Blob, Tree, Commit, Tag)\u89c0\u5ff5\u4ecb\u7d39 \u7ae0\u7bc0</li> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#_6","title":"\u5408\u4f75\u5206\u652f\u5176\u5be6\u4e0d\u662f\u771f\u7684\u5728\u5408\u4f75\u5206\u652f!","text":"<ul> <li>\u6240\u8b02\u7684\"\u5408\u4f75\u5206\u652f\"\u5176\u5be6\u662f\u5728\u5408\u4f75\u5169\u500b\u5206\u652f\u5206\u5225\u6307\u5411\u7684\u5169\u500b<code>Commit\u7269\u4ef6</code></li> <li>\u7562\u7adf\u5206\u652f\u53ea\u662f\u4e00\u5f35\u8cbc\u7d19\u800c\u5df2,\u5b83\u662f\u6c92\u8fa6\u6cd5\u88ab\"\u5408\u4f75\"\u7684,\u6211\u5011\u901a\u5e38\u7528\"\u5408\u4f75\u5206\u652f\"\u9019\u500b\u8aaa\u6cd5\u53ea\u662f\u6bd4\u8f03\u597d\u60f3\u50cf\u548c\u6e9d\u901a\u800c\u5df2</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging</li> </ul>"},{"location":"version_control/git/#resetrebaserevert","title":"<code>Reset</code>\u3001<code>Rebase</code>\u3001<code>Revert</code> \u4e09\u500b\u6307\u4ee4\u6709\u4ec0\u9ebc\u5dee\u5225?","text":"\u6307\u4ee4 \u6539\u8b8a\u6b77\u53f2\u7d00\u9304 \u8aaa\u660e \u9069\u5408\u4f7f\u7528\u60c5\u5883 Reset \u662f \u628a\u76ee\u524d\u7684\u72c0\u614b\u8a2d\u5b9a\u6210\u67d0\u500b\u6307\u5b9a\u7684 Commit \u7684\u72c0\u614b \u901a\u5e38\u9069\u7528\u65bc\u5c1a\u672a\u63a8\u51fa\u53bb\u7684 Commit Rebase \u662f \u4e0d\u7ba1\u662f\u65b0\u589e\u3001\u4fee\u6539\u3001\u522a\u9664 Commit \u90fd\u76f8\u7576\u65b9\u4fbf\uff0c\u7528\u4f86\u6574\u7406\u3001\u7de8\u8f2f\u9084\u6c92\u6709\u63a8\u51fa\u53bb\u7684 Commit \u76f8\u7576\u65b9\u4fbf \u901a\u5e38\u4e5f\u53ea\u9069\u7528\u65bc\u5c1a\u672a\u63a8\u51fa\u53bb\u7684 Commit Revert \u5426 \u65b0\u589e\u4e00\u500b Commit \u4f86\u53cd\u8f49\uff08\u6216\u8aaa\u53d6\u6d88\uff09\u53e6\u4e00\u500b Commit \u7684\u5167\u5bb9\uff0c\u539f\u672c\u7684 Commit \u4f9d\u820a\u9084\u662f\u6703\u4fdd\u7559\u5728\u6b77\u53f2\u7d00\u9304\u4e2d\u3002\u96d6\u7136\u6703\u56e0\u6b64\u800c\u589e\u52a0 Commit \u6578 \u4f46\u901a\u5e38\u6bd4\u8f03\u9069\u7528\u65bc\u5df2\u7d93\u63a8\u51fa\u53bb\u7684 Commit\uff0c\u6216\u662f\u4e0d\u5141\u8a31\u4f7f\u7528 Reset \u6216 Rebase \u4e4b\u4fee\u6539\u6b77\u53f2\u7d00\u9304\u7684\u6307\u4ee4\u7684\u5834\u5408 <ul> <li>\u53c3\u8003\u8868\u683c\u51fa\u8655: https://gitbook.tw/chapters/rewrite-history/reset-revert-and-rebase.html</li> </ul>"},{"location":"version_control/git/#tagbranch","title":"<code>\u6a19\u7c64(Tag)</code>\u8ddf<code>\u5206\u652f(branch)</code>\u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?","text":"<ul> <li><code>\u6a19\u7c64(Tag)</code>\u8207<code>\u5206\u652f(branch)</code>\u90fd\u662f\u4e00\u7a2e\u6307\u6a19,\u90fd\u6703\u653e\u5728 .git/refs/ \u76ee\u9304\u88e1\u9762,\u4f46\u653e\u7684\u4f4d\u7f6e\u4e0d\u540c</li> <li><code>\u6a19\u7c64(Tag)</code> \u6703\u653e\u5728 <code>.git/refs/tags/</code> \u76ee\u9304\u88e1\u9762</li> <li><code>\u5206\u652f(branch)</code>\u6703\u653e\u5728 <code>.git/refs/heads/</code> \u76ee\u9304\u88e1\u9762</li> <li>\u53ef\u5148\u53c3\u8003 Tag (\u6a19\u7c64) \u662f\u4ec0\u9ebc? \u7ae0\u7bc0</li> <li>\u53ef\u5148\u53c3\u8003 \u5206\u652f(branch)\u662f\u4ec0\u9ebc? \u7ae0\u7bc0</li> <li><code>\u6a19\u7c64(Tag)</code>\u8207<code>\u5206\u652f(branch)</code>\u7684\u5167\u5bb9\u770b\u8d77\u4f86\u6703\u5f88\u50cf,\u90fd\u662f<code>40</code>\u500b\u5b57\u5143\u7684<code>SHA-1\u503c</code></li> <li><code>\u8f15\u91cf\u6a19\u7c64</code>(lightweight tag)\u6307\u5411\u7684\u662f\u4e00\u500bCommit\u7269\u4ef6<ul> <li>$ <code>cat .git/refs/tags/&lt;\u8f15\u91cf\u6a19\u7c64\u7684\u540d\u7a31&gt;</code></li> <li></li> </ul> </li> <li><code>\u6709\u9644\u8a3b\u6a19\u7c64</code>(annotated tag)\u6307\u5411\u7684\u662f\u4e00\u500b<code>Tag\u7269\u4ef6</code>,\u800c\u9019\u500b<code>Tag\u7269\u4ef6</code>\u624d\u6703\u6307\u5411\u4e00\u500b<code>Commit\u7269\u4ef6</code><ul> <li>$ <code>cat .git/refs/tags/&lt;\u6709\u9644\u8a3b\u6a19\u7c64\u7684\u540d\u7a31&gt;</code></li> <li></li> </ul> </li> <li>\u91cd\u8981: <code>\u6a19\u7c64(Tag)</code>\u8207<code>\u5206\u652f(branch)</code>\u6700\u5927\u7684\u5dee\u5225\u5728\u65bc</li> <li><code>\u5206\u652f(branch)</code> \"\u6703\u96a8\u8457\" <code>commit\u7d00\u9304</code>\u79fb\u52d5,\u4e5f\u5c31\u662f\u8aaa\u7576Git\u5f80\u524d\u63a8\u9032\u4e00\u500b<code>commit\u7d00\u9304</code>\u6642,\u5b83\u6240\u5728\u7684\u5206\u652f\u6703\u8ddf\u8457\u5f80\u524d\u79fb\u52d5</li> <li><code>\u6a19\u7c64(Tag)</code> \u4e0d\u6703\u96a8\u8457 <code>commit\u7d00\u9304</code>\u79fb\u52d5,\u4e5f\u5c31\u662f\u8aaa\u6a19\u7c64\u4e00\u65e6\u8cbc\u4e0a\u53bb\u5f8c,\u4e0d\u7ba1<code>commit\u7d00\u9304</code>\u600e\u9ebc\u524d\u9032,\u6a19\u7c64\u9084\u662f\u6703\u505c\u7559\u5728\u539f\u4f86\u8cbc\u7684\u90a3\u500b\u4f4d\u7f6e\u4e0a</li> <li>\u7d50\u8ad6: \u67d0\u65b9\u9762\u4f86\u8aaa,\u6211\u5011\u53ef\u4ee5\u628a<code>\u5206\u652f(branch)</code>\u8996\u70ba\u6703\u79fb\u52d5\u7684<code>\u6a19\u7c64(Tag)</code></li> </ul>"},{"location":"version_control/git/#unreachable-dangling","title":"<code>Unreachable\u7269\u4ef6</code> &amp; <code>Dangling\u7269\u4ef6</code> \u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?","text":"<ul> <li><code>Unreachable Object</code> : \u6c92\u6709\u4efb\u4f55\u7269\u4ef6\u6216\u6307\u6a19\u6307\u8457\u5b83,\u5982\u540c\u5b57\u9762\u4e0a\u8aaa\u7684\"\u7121\u6cd5\u5230\u9054\u7684\"; \u4f46\u5b83\u4ecd\u53ef\u4ee5\u6307\u5411\u5176\u4ed6\u7269\u4ef6</li> <li><code>Dangling Object</code> : \u8ddf<code>Unreachable\u7269\u4ef6</code>\u4e00\u6a23,\u6c92\u6709\u4efb\u4f55\u7269\u4ef6\u6216\u6307\u6a19\u6307\u8457\u5b83,\u5b83\u4e5f\u6c92\u6709\u6307\u8457\u5176\u4ed6\u7269\u4ef6,\u5982\u540c\u5b8c\u5168\"\u61f8\u5728\u5929\u908a\"\u7684\u4e00\u9846\u7269\u4ef6</li> <li><code>Dangling\u7269\u4ef6</code>\u53ef\u4ee5\u7b97\u662f<code>Unreachable\u7269\u4ef6</code>\u7684\u5b50\u96c6\u5408,\u5b83\u4e5f\u662f\u4e00\u7a2e<code>Unreachable\u7269\u4ef6</code>,\u6240\u4ee5\u5728\u9032\u884c$ <code>git gc</code>\u6642,\u4e5f\u6703\u4e00\u8d77\u88ab\u56de\u6536\u8d70</li> <li>\u4ec0\u9ebc\u60c5\u6cc1\u4e0bGit\u6703\u7522\u751f\u51fa<code>Dangling\u7269\u4ef6</code>\u5462?</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>$ <code>echo \"test for dangling object\" &gt; dangling_object.html</code></li> <li>$ <code>git add --all</code></li> <li>$ <code>git commit -m \"\u65b0\u589edangling object \u5167\u5bb9\"</code></li> <li>\u4e0a\u8ff0\u4e09\u6b65\u9a5f\u518d\u91cd\u8907\u505a\u4e00\u904d,\u5df2\u65b0\u589e\u51fa\u6e2c\u8a66\u8981\u7528\u76842\u6b21commit\u7d00\u9304</li> <li>$ <code>git reset HEAD~2 --hard</code>: \u5207\u56de\u5230<code>HEAD\u6307\u6a19</code>\u6307\u5411\u7684\u524d2\u6b21<code>Commit\u7269\u4ef6</code></li> <li>$ <code>git fsck --unreachable --no-reflogs</code>: \u986f\u793a\u6240\u6709<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6\u548c <code>Dangling\u72c0\u614b</code>\u7684\u7269\u4ef6<ul> <li> </li> </ul> </li> <li>\u6ce8\u610f! \u6b64\u6642\u7684<code>3d3bce0</code>,<code>4cfc041</code>\u9019\u5169\u500b<code>Commit\u7269\u4ef6</code>\u90fd\u5df2\u7d93\u8b8a\u6210<code>Unreachable\u72c0\u614b</code>\u7684\u7269\u4ef6; </li> <li>$ git fsck --no-reflogs: \u53ea\u986f\u793a\u51fa<code>Dangling\u72c0\u614b</code>\u7684\u7269\u4ef6<ul> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#git-log-git-reflog","title":"$ <code>git log</code> &amp; <code>git reflog</code> \u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?","text":"<ul> <li>$ <code>git log</code>: \u53ef\u4ee5\u986f\u793a\u6240\u6709<code>\u63d0\u4ea4</code>(commit)\u904e\u7684\u7248\u672c\u8cc7\u8a0a <p>$ git log - Show commit logs --- by \u5b98\u65b9\u6587\u4ef6</p> </li> <li></li> <li>$ <code>git reflog</code>: \u53ef\u4ee5\u6aa2\u8996\u6240\u6709\u5206\u652f\u7684\u6240\u6709\u64cd\u4f5c\u8a18\u9304(\u5305\u62ec<code>\u5df2\u7d93\u88ab\u522a\u9664\u7684commit\u8a18\u9304</code>\u548c<code>Reset\u64cd\u4f5c</code>) <p>$ <code>git reflog</code> - Manage reflog information --- by \u5b98\u65b9\u6587\u4ef6</p> </li> <li></li> </ul>"},{"location":"version_control/git/#_7","title":"\u5be6\u6230\u60c5\u5883\u984c","text":"<p><code>git stash</code> - Stash the changes in a dirty working directory away <code>git filter-branch</code> - Rewrite branches <code>git cherry-pick - Apply the changes introduced by some existing commits</code> <code>git fsck</code> - Verifies the connectivity and validity of the objects in the database</p>"},{"location":"version_control/git/#git-add","title":"\u5982\u679c\u5728git add\u4e4b\u5f8c\u53c8\u4fee\u6539\u4e86\u90a3\u500b\u6a94\u6848\u7684\u5167\u5bb9\u5462?","text":"<ul> <li>\u65b0\u589e\u4e86\u4e00\u500b\u6a94\u6848\u53eb\u505aabc.txt</li> <li>\u57f7\u884c $ <code>git add abc.txt</code> \u628a\u6a94\u6848\u52a0\u5230\u66ab\u5b58\u5340</li> <li>\u53c8\u518d\u7de8\u8f2f\u4e86\u4e00\u6b21\u8a72\u6a94\u6848</li> <li>\u6b63\u78ba\u505a\u6cd5:\u5fc5\u9808\u518d\u5c07\u8a72\u6a94\u6848 $ <code>git add abc.txt</code> \u5230\u66ab\u5b58\u5340\u4e00\u904d</li> <li></li> </ul>"},{"location":"version_control/git/#git-reset-hard","title":"\u5982\u679c\u4e0d\u5c0f\u5fc3\u4f7f\u7528$ <code>git reset --hard</code> \u6a21\u5f0f,\u80fd\u6551\u56de\u4f86\u55ce?","text":"<ul> <li>\u5047\u5982\u4e0d\u5c0f\u5fc3$ <code>git reset HEAD~2 --hard</code>,</li> <li>$ <code>git reflog</code> \u662f\u7576HEAD\u6709\u79fb\u52d5\u7684\u6642\u5019(\u4f8b\u5982\u5207\u63db\u5206\u652for $ <code>git reset</code> \u6642,Git\u90fd\u6703\u5728 <code>Reflog</code> \u4e0a\u9762\u505a\u8a18\u9304),\u5728 <code>Reflog</code> \u4e2d,\u8d8a\u65b0\u7684\u7d00\u9304\u5beb\u5728\u8d8a\u4e0a\u9762<ul> <li> <p>\u5b98\u65b9\u5b9a\u7fa9: Reference logs, or \"reflogs\", record when the tips of branches and other references were updated in the local repository. </p> </li> </ul> </li> <li>\u53ef\u4ee5\u5229\u7528$ <code>git reflog</code> \u4f86\u6aa2\u8996<code>HEAD</code>\u7684\u8b8a\u5316\u7d00\u9304<ul> <li>\u7576\u5207\u63db\u5206\u652f\u6642,HEAD\u6703\u8b8a\u52d5</li> <li>\u7576$ <code>git reset</code> \u6642,HEAD\u6703\u8b8a\u52d5</li> </ul> </li> <li>\u89e3\u6c7a\u65b9\u6cd5:\u76f4\u63a5\u56de\u5230\u6b63\u78ba(=&gt;reset\u932f\u8aa4\u524d\u7684\u90a3\u4e00\u6b21)\u7684commit\u7269\u4ef6\u4e0a<ul> <li>$ <code>git reset c015c1f --hard</code></li> <li>\u5c31\u53ef\u4ee5\u628a\u525b\u525b\u7684\u6771\u897f\u6551\u56de\u4f86\u4e86</li> <li></li> <li>\u88dc\u5145: $ <code>git reflog</code> = $ <code>git log -g</code> = $ <code>git log --walk-reflogs</code></li> </ul> </li> </ul>"},{"location":"version_control/git/#commit_4","title":"\u5982\u679c\u9019\u6b21\u53ea\u60f3commit\u4e00\u500b\u6a94\u6848\u4e2d\u7684\u90e8\u4efd\u5167\u5bb9\u7684\u8a71,\u8a72\u600e\u9ebc\u505a\u5462?","text":"<ul> <li><code>git add -p xxx.hmtl</code>: \u5728$ <code>git add</code>\u5c07\u6a94\u6848\u52a0\u5165\u66ab\u5b58\u5340(staging area)\u7684\u6642\u5019,\u52a0\u4e0a <code>-p</code> \u53c3\u6578,\u900f\u904e\u4e92\u52d5\u5f0f\u4ecb\u9762,\u9078\u64c7\u8981$ <code>git add</code>\u7684\u7bc4\u570d<ul> <li><code>-p</code> (=&gt; <code>--patch</code>): \u53ef\u4ee5\u4e92\u52d5\u5f0f\u5730\u9078\u64c7\u8a72\u6a94\u6848\u7684\u54ea\u4e9b\u90e8\u5206\u8981\u52a0\u5165\u66ab\u5b58\u5340(staging area),\u54ea\u4e9b\u4e0d\u7528(\u7559\u5728\u5de5\u4f5c\u76ee\u9304\u5c31\u597d)</li> <li><code>e</code> (=&gt; edit): \u7de8\u8f2f\u8a72\u6a94\u6848\u4e2d\u7684\u54ea\u4e9b\u90e8\u5206\u8981\u65b0\u589e\u5230\u66ab\u5b58\u5340(staging area)</li> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#branch_2","title":"\u5982\u679c\u4fee\u6539\u5c08\u6848\u7684\u67d0\u4e9b\u6a94\u6848\u5230\u4e00\u534a,\u537b\u4e0d\u5c0f\u5fc3\u5148\u5207\u63db\u5230\u5225\u7684\u5206\u652f(branch),\u8a72\u600e\u9ebc\u8fa6?","text":"<ul> <li>$ <code>git checkout -b tiger</code>: \u5148\u5207\u63db\u5230tiger\u5206\u652f</li> <li>$ <code>echo tiger 123 &gt;  tiger_test.html</code>: \u65b0\u589e\u4e00\u500b\u6a94\u6848<code>tiger_test.html</code>,\u4e26\u5728\u88e1\u9762\u8f38\u5165\u4e00\u4e32\u6587\u5b57</li> <li>\u4e5f\u7de8\u8f2f<code>pizza.html</code>,\u65b0\u589e\u4e00\u884c\u6587\u5b57</li> <li>\u6b64\u6642,\u5207\u63db\u5230<code>master</code>\u5206\u652f,\u6703\u767c\u73fe\u525b\u525b\u65b0\u589e\u7684\u6a94\u6848(<code>tiger_test.html</code>)\u4ee5\u53ca\u4fee\u6539\u7684\u6a94\u6848(<code>pizza.html</code>)\u90fd\u9084\u662f\u6703\u7559\u5728\u5de5\u4f5c\u76ee\u9304(working directory)\u4e0d\u53d7\u5f71\u97ff</li> <li></li> <li>\u7e3d\u7d50: Git\u5207\u63db\u5206\u652f( <code>$ git checkout &lt;branch name&gt;</code> )\u6642,\u4e26\u4e0d\u6703\u5f71\u97ff\u5230\u5df2\u7d93\u5728\u5de5\u4f5c\u76ee\u9304(working directory)\u7684\u90a3\u4e9b\u4fee\u6539\u5594!</li> </ul>"},{"location":"version_control/git/#_8","title":"\u5982\u679c\u4e0d\u5c0f\u5fc3\u628a\u9084\u6c92\u5408\u4f75\u7684\u5206\u652f\u522a\u6389\u4e86,\u8a72\u600e\u9ebc\u633d\u6551?","text":"<ul> <li>\u53ef\u5148\u53c3\u8003 \u5206\u652f(branch) \u662f\u4ec0\u9ebc? \u7ae0\u7bc0\u7684\u522a\u9664\u5206\u652f\u7bc7</li> <li>$ <code>git branch -D &lt;\u5c1a\u672a\u5408\u4f75\u7684\u5206\u652f\u540d\u7a31&gt;</code>: \u5f37\u5236\u522a\u9664\u8a72\u5206\u652f( \u4e0d\u7ba1\u8a72\u5206\u652f\u662f\u5426\u5df2\u7d93\u5408\u4f75(merged)\u5230\u5176\u4e0a\u6e38\u5206\u652f(upstream branch) )<ul> <li>\u6b64\u6642\u6703\u986f\u793a\"\u88ab\u522a\u9664\u7684\u5206\u652f\"\u7576\u4e0b\u662f\u6307\u5411\u54ea\u500b<code>Commit\u7269\u4ef6</code>,\u53ef\u4ee5\u5148\u8a18\u4e0b\u4f86\u9019\u500b<code>Commit\u7269\u4ef6</code>\u7684id</li> <li></li> <li>\u88dc\u5145:<code>\u5206\u652f(branch)</code>\u53ea\u662f\u4e00\u500b\u6307\u5411\u67d0\u500b<code>Commit\u7269\u4ef6</code>\u7684\u8cbc\u7d19,\u522a\u9664\u9019\u500b\u8cbc\u7d19\"\u4e26\u4e0d\u6703\"\u9020\u6210\u90a3\u4e9b<code>Commit\u7269\u4ef6</code>\u6d88\u5931</li> <li>\u6240\u4ee5\u65e2\u7136\u522a\u6389\u5206\u652f\u5f8c,\u90a3\u4e9b<code>Commit\u7269\u4ef6</code>\u90fd\u9084\u5728\u7684\u8a71,\u53ea\u662f\u56e0\u70ba\u6211\u5011\u7576\u4e0b\u901a\u5e38\u6c92\u6709\u8a18\u4e0b\u90a3\u4e9b<code>Commit\u7269\u4ef6\u7684id</code>,\u6240\u4ee5\u6bd4\u8f03\u4e0d\u5bb9\u6613\u518d\u62ff\u56de\u4f86\u4f7f\u7528,\u9019\u6642\u6211\u5011\u53ef\u4ee5\u5275\u9020\u4e00\u500b<code>\u65b0\u7684\u5206\u652f(new branch)</code>\u4f86\u628a\u9019\u4e9b<code>Commit\u7269\u4ef6</code>\u90fd\u63a5\u56de\u4f86!</li> <li>$ <code>git branch &lt;\u65b0\u7684\u5206\u652f\u540d\u7a31&gt; &lt;\u525b\u525b\u88ab\u522a\u6389\u7684\u5206\u652f\u7576\u4e0b\u6307\u5411\u7684Commit\u7269\u4ef6\u7684id&gt;</code>: \u5efa\u7acb\u4e00\u500b<code>\u65b0\u7684\u5206\u652f(new branch)</code>\u4e26\u8b93\u8a72\u5206\u652f\u6307\u5411\u9019\u500b<code>Commit\u7269\u4ef6</code>,\u76f8\u7576\u65bc\u518d\u62ff\u4e00\u5f35\u65b0\u7684\u8cbc\u7d19\u8cbc\u56de\u53bb\u7684\u610f\u601d</li> <li>\u88dc\u5145: \u82e5\u7576\u4e0b\u522a\u9664\"\u5c1a\u672a\u5408\u4f75\u5206\u652f\"\u7684\u6642\u5019,\u6c92\u6709\u8a18\u4e0b\u8a72\u5206\u652f\u7576\u4e0b\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>\u7684id,\u53ef\u4ee5\u7528git reflog\u4f86\u627e\u627e\u770b,\u56e0\u70baGit\u7684Reflog\u6703\u9810\u8a2d\u4fdd\u7559<code>30</code>\u5929</li> <li>\u53ef\u53c3\u8003 \u5982\u679c\u4e0d\u5c0f\u5fc3\u4f7f\u7528$ <code>git reset --hard</code> \u6a21\u5f0f,\u80fd\u6551\u56de\u4f86\u55ce? \u7ae0\u7bc0</li> </ul> </li> </ul>"},{"location":"version_control/git/#commitbranch","title":"\u5982\u679c\u60f3\u5f9e\u904e\u53bb\u7684\u67d0\u6b21<code>commit\u7d00\u9304</code>\u518d\u9577\u4e00\u500b<code>\u65b0\u7684\u5206\u652f(branch)</code>\u51fa\u4f86,\u8a72\u5982\u4f55\u505a\u5462?","text":"<ul> <li>\u7b2c\u4e00\u6b65\u9a5f: \u5fc5\u9808\u5148\u56de\u5230\u904e\u53bb\u7684\u90a3\u500b<code>commit\u7d00\u9304</code>\u7684\u72c0\u614b<ul> <li>$ <code>git checkout &lt;\u8981\u56de\u5230\u7684\u904e\u53bb\u7684\u90a3\u500bCommit\u7269\u4ef6\u7684id&gt;</code> </li> </ul> </li> <li>\u7b2c\u4e8c\u6b65\u9a5f: \u65b0\u589e\u4e00\u500b<code>\u5206\u652f(branch)</code>\u5728\u904e\u53bb\u7684\u90a3\u500b<code>Commit\u7269\u4ef6</code>\u4e0a<ul> <li>$ <code>git checkout -b &lt;\u65b0\u7684\u5206\u652f\u540d\u7a31&gt;</code> </li> </ul> </li> <li>\u88dc\u5145: \u5728\u57f7\u884c\u7b2c\u4e00\u6b65\u9a5f\u6642<ul> <li>\u9019\u6642\u5019\u53ef\u80fd\u6703\u767c\u751f <code>detached HEAD</code> \u72c0\u614b (\u662f\u56e0\u70ba\u904e\u53bb\u7684\u90a3\u500b<code>Commit\u7269\u4ef6</code>\u76ee\u524d\u6c92\u6709\u5206\u652f\u6307\u5411\u5b83)</li> <li>\u9019\u6642\u5019\u53ef\u4ee5\u518d\u5207\u63db\u5230\u904e\u53bb\u7684\u90a3\u500b<code>commit\u7d00\u9304</code>\u6642,\u540c\u6642\u65b0\u589e\u4e00\u500b<code>\u5206\u652f(branch)</code>,\u4ee5\u9632\u8df3\u51fa <code>detached HEAD</code> \u72c0\u614b</li> </ul> </li> <li>\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4e00\u884c\u6307\u4ee4\u5b8c\u6210,\u4ee5\u4e0b\u5169\u7a2e\u65b9\u5f0f\u90fd\u662f\u5728\u8868\u9054\"\u8acbGit\u5e6b\u6211\u5728<code>&lt;\u8981\u56de\u5230\u7684\u904e\u53bb\u7684\u90a3\u500bCommit\u7269\u4ef6&gt;</code>\u4e0a\u8cbc\u4e0a\u4e00\u5f35ocean\u7684<code>\u5206\u652f(branch)</code>\u8cbc\u7d19\"<ul> <li>$ <code>git branch &lt;\u65b0\u7684\u5206\u652f\u540d\u7a31&gt; &lt;\u8981\u56de\u5230\u7684\u904e\u53bb\u7684\u90a3\u500bCommit\u7269\u4ef6\u7684id&gt;</code></li> <li>\u4f8b\u5982: $ <code>git branch ocean</code> </li> <li>\u4e5f\u53ef\u4ee5\u66f4\u65b9\u4fbf\u5730,\u5728\u56de\u5230\u904e\u53bb\u7684commit\u7d00\u9304\u6642,\u65b0\u589e\u4e00\u500b\u5206\u652f,\u4e26\u540c\u6642\u5207\u63db\u5230\u90a3\u500b\u5206\u652f</li> <li>$ <code>git checkout -b &lt;\u65b0\u7684\u5206\u652f\u540d\u7a31&gt; &lt;\u8981\u56de\u5230\u7684\u904e\u53bb\u7684\u90a3\u500bCommit\u7269\u4ef6\u7684id&gt;</code></li> <li> </li> </ul> </li> </ul>"},{"location":"version_control/git/#both-modified","title":"\u7576\u5169\u500b\u5206\u652f\u90fd\u7de8\u8f2f\u4e86\u540c\u4e00\u500b\u6a94\u6848(<code>both modified \u72c0\u614b</code>),\u9020\u6210<code>\u5408\u4f75\u5206\u652f\u6642\u767c\u751f\u885d\u7a81</code>\u4e86,\u8a72\u600e\u9ebc\u89e3\u6c7a\u5462?","text":"<ul> <li>\u5047\u8a2d\u6709\u5169\u500b\u5206\u652f\u90fd\u7de8\u8f2f\u904e\u540c\u4e00\u500b\u6a94\u6848,\u82e5\u6a94\u6848\u5167\u5bb9\u4e0d\u4e00\u81f4,\u6703\u9020\u6210<code>both modified \u72c0\u614b</code>,\u9020\u6210\u5408\u4f75\u5206\u652f\u6642\u6703\u767c\u751f\u885d\u7a81</li> <li><code>\u60c5\u5883\u8aaa\u660e1</code><ul> <li>\u7528<code>Merge\u65b9\u5f0f</code>\u5408\u4f75\u5206\u652f\u6642\u767c\u751f\u885d\u7a81</li> <li>\u5efa\u7acb\u4e00\u500b<code>merge_conflict.html</code>\u7684\u6e2c\u8a66<code>\u5408\u4f75\u5206\u652f\u885d\u7a81</code>\u7684\u6a94\u6848</li> <li>\u5f9e<code>master</code>,\u5efa\u7acb\u4e00\u500b<code>sun\u5206\u652f</code>(branch)</li> <li>\u5f9e<code>master</code>,\u5efa\u7acb\u4e00\u500b<code>moon\u5206\u652f</code>(branch)</li> <li>\u6b64\u6642\u5148\u5207\u63db\u5230<code>sun\u5206\u652f</code>,\u4e26\u65b0\u589e\"\u6211\u662fsun\u5206\u652f\"\u5230<code>merge_conflict.html</code>\u7684\u6e2c\u8a66<code>\u5408\u4f75\u5206\u652f\u885d\u7a81</code>\u7684\u6a94\u6848,\u52a0\u5230\u66ab\u5b58\u5340\u5f8c,\u518dcommit\u5230\u672c\u5730\u7aefrepo</li> <li>$ <code>git checkout sun</code></li> <li>\u65b0\u589e\"\u6211\u662fsun\u5206\u652f\"\u5230<code>merge_conflict.html</code>\u7684\u6e2c\u8a66<code>\u5408\u4f75\u5206\u652f\u885d\u7a81</code>\u7684\u6a94\u6848</li> <li>$ <code>git add --all</code></li> <li>$ <code>git commit -m \"sun\u5206\u652f\u7de8\u8f2fmerge_conflict.html\"</code></li> <li></li> <li>\u518d\u5207\u63db\u5230<code>moon\u5206\u652f</code>,\u4e26\u65b0\u589e\"\u6211\u662fmoon\u5206\u652f\"\u5230<code>merge_conflict.html</code>\u7684\u6e2c\u8a66<code>\u5408\u4f75\u5206\u652f\u885d\u7a81</code>\u7684\u6a94\u6848,\u52a0\u5230\u66ab\u5b58\u5340\u5f8c,\u518dcommit\u5230\u672c\u5730\u7aefrepo</li> <li>$ <code>git checkout moon</code></li> <li>\u65b0\u589e\"\u6211\u662fmoon\u5206\u652f\"\u5230<code>merge_conflict.html</code>\u7684\u6e2c\u8a66<code>\u5408\u4f75\u5206\u652f\u885d\u7a81</code>\u7684\u6a94\u6848</li> <li>$ <code>git add --all</code></li> <li>$ <code>git commit -m \"moon\u5206\u652f\u7de8\u8f2fmerge_conflict.html\"</code></li> <li></li> <li>$ <code>git merge sun</code>: \u5c07<code>moon\u5206\u652f</code>\u5408\u4f75\u5230<code>sun\u5206\u652f</code>\u7684\u4e0a\u9762</li> <li>\u6b64\u6642Git\u6709\u80fd\u529b\u5e6b\u5fd9\u6aa2\u67e5\u7c21\u55ae\u7684\u885d\u7a81</li> <li>\u53ef\u4ee5\u6c7a\u5b9a\u8981\u63a5\u53d7\u54ea\u500b\u5206\u652f\u7684\u4fee\u6539,\u4e5f\u53ef\u4ee5\u90fd\u63a5\u53d7\u96d9\u65b9\u7684\u4fee\u6539</li> <li>`</li> <li>\u6700\u5f8c\u7528Sourcetree\u4f86\u6aa2\u8996\u4e00\u4e0b\u6700\u5f8c\u7684<code>History</code></li> <li>\"!\" : \u4ee3\u8868\"\u6709\u885d\u7a81\"\u7684\u6a94\u6848</li> <li></li> <li>\u7d71\u6574\u5716\u89e3\u8aaa\u660e</li> <li></li> </ul> </li> <li><code>\u60c5\u5883\u8aaa\u660e2</code><ul> <li>\u7528<code>Rebase\u65b9\u5f0f</code>\u5408\u4f75\u5206\u652f\u6642\u767c\u751f\u885d\u7a81</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/branch/fix-conflict.html</li> <li>\u6b64\u6642<code>HEAD</code>\u4e26\"\u6c92\u6709\u6307\u5411\"\u4efb\u4f55\u4e00\u500b\u5206\u652f,\u5b83\u73fe\u5728\u6709\u9ede\u50cf\u662f\u5728\u4fee\u6539\u6b77\u53f2\u7684\u6642\u5019,\u5361\u5728\u67d0\u500b\u6642\u7a7a\u7e2b\u9699\u88e1\u7684\u72c0\u614b</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/branch/fix-conflict.html</li> <li>\u6aa2\u8996\u4e00\u4e0b\u76ee\u524dGit\u7684\u72c0\u614b</li> <li>$ <code>git status</code></li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/branch/fix-conflict.html</li> <li>\u9019\u6642\u5019\u7684Git\u72c0\u614b\u6e05\u695a\u5730\u986f\u793a\"rebase in progress\"(=&gt; \u6b63\u5728\u9032\u884c\u4e2d\u7684)</li> <li>\u540c\u6642,\u5169\u500b\u5206\u652f\u540c\u6642\u90fd\u7de8\u8f2f\u5230\u7684\u90a3\u500b\u6a94\u6848\u6703\u88ab\u6a19\u793a\u6210<code>both modified \u72c0\u614b</code></li> <li>\u6b64\u6642\u53ef\u4ee5\u76f4\u63a5\u6309\u7167\u5e73\u5e38\u7684\u6d41\u7a0b,\"\u5148\u5c07\u8a72\u885d\u7a81\u6a94\u6848\u4fee\u6b63\u5b8c\u6210\u5f8c\"</li> <li>\u518d\u5c07\"\u5df2\u4fee\u6b63\u7684\u6a94\u6848\" \u52a0\u5230 \"\u66ab\u5b58\u5340\"(staging area)<ul> <li>$ <code>git add &lt;\u5df2\u4fee\u6b63\u7684\u6a94\u6848&gt;</code></li> </ul> </li> <li>\u6700\u5f8c,\u63a5\u8457\u7e7c\u7e8c\u5b8c\u6210\u525b\u525b\u4e2d\u65b7\u7684Rebase\u5408\u4f75\u5206\u652f\u7684\u64cd\u4f5c<ul> <li>$ <code>git rebase --continue</code></li> <li><code>--continue</code>: \u7576\u5df2\u7d93\u4fee\u6539\u5b8c\u885d\u7a81\u6a94\u6848\u5f8c,\u7e7c\u7e8c \"\u91cd\u65b0\u555f\u52d5\" Rebase\u6a5f\u5236</li> </ul> </li> </ul> </li> <li><code>\u60c5\u5883\u8aaa\u660e3</code><ul> <li>\u7528<code>Merge\u65b9\u5f0f</code>\u5408\u4f75\u5206\u652f\u6642\u767c\u751f\u885d\u7a81(=&gt; \"\u7576\u5169\u500b\u5206\u652f\u90fd\u6709\u4e00\u500b\u540c\u540d\u7a31\u7684\u5716\u7247\u6a94\u6848\u6642\u7684\u60c5\u6cc1\")</li> <li>\u96d6\u7136Git\u6709\u80fd\u529b\u5e6b\u5fd9\u6aa2\u67e5\u7c21\u55ae\u7684\u885d\u7a81\u4e26\u6a19\u793a\u51fa\"\u885d\u7a81\u9ede\"\u5728\u8a72\u6a94\u6848\u54ea\u5e7e\u884c; \u4f46\u662f\u5982\u679c\u662f\u5716\u7247\u6a94\u4e4b\u985e\u7684\u4e8c\u9032\u4f4d\u6a94\u7684\u8a71,\u5c31\u5fc5\u9808\u7528\u5225\u7684\u65b9\u5f0f\u4f86\u89e3\u6c7a\u4e86</li> <li>\u5efa\u7acb\u4e00\u500b<code>cutest_animal.jpg</code>\u7684\u6e2c\u8a66<code>\u5408\u4f75\u5206\u652f\u885d\u7a81</code>\u7684\u540c\u540d\u5716\u7247\u6a94\u6848</li> <li>\u5f9e<code>master</code>,\u5efa\u7acb\u4e00\u500b<code>cat\u5206\u652f</code>(branch)</li> <li>\u5f9e<code>master</code>,\u5efa\u7acb\u4e00\u500b<code>dog\u5206\u652f</code>(branch)</li> <li>\u5148\u5207\u63db\u5230<code>cat\u5206\u652f</code>\u4e26\u65b0\u589e\u4e00\u500b\"\u540c\u540d\u7a31\u7684\u5716\u7247\u6a94\u6848\"(<code>cutest_animal.jpg</code>)</li> <li> </li> <li>$ <code>git add --all</code></li> <li>$ <code>git commit -m \"cat\u5206\u652f \u65b0\u589ecutest_animal.jpg\"</code></li> <li>\u518d\u5207\u63db\u5230<code>dog\u5206\u652f</code>\u4e26\u65b0\u589e\u4e00\u500b\"\u540c\u540d\u7a31\u7684\u5716\u7247\u6a94\u6848\"(<code>cutest_animal.jpg</code>)</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQ3Xm4P7nHI3rcMuRdM3KR3av1PqeqaPHW-nA&amp;usqp=CAU</li> <li>$ <code>git add --all</code></li> <li>$ <code>git commit -m \"dog\u5206\u652f \u65b0\u589ecutest_animal.jpg\"</code></li> <li>\u6b64\u6642\u5207\u63db\u5230<code>cat\u5206\u652f</code>,\u5229\u7528\u6307\u4ee4\u5408\u4f75\u5230<code>dog\u5206\u652f</code>\u4e0a\u9762</li> <li>$ <code>git merge dog</code><ul> <li>\u9019\u6642\u6703\u767c\u751f\u5408\u4f75\u5206\u652f\u7684\u885d\u7a81,\u4e26\u4e14\u986f\u793aGit\u7121\u6cd5\u81ea\u52d5\u89e3\u6c7a\u8a72\u885d\u7a81(<code>Merge conflict in /pics/gitcutest_animal.jpg</code> &amp; <code>Automatic merge failed</code>)`</li> <li></li> </ul> </li> <li>\u9019\u6642\u5019\u53ef\u4ee5\u6c7a\u5b9a\u8981\u63a1\u7528\u54ea\u500b\u5206\u652f\u7684\u540c\u540d\u7a31\u5716\u7247\u6a94\u6848(<code>cutest_animal.jpg</code>)<ul> <li>$ <code>git checkout --ours/--theirs &lt;\u8def\u5f91/\u6c7a\u5b9a\u8981\u7528\u7684\u540c\u540d\u7a31\u5716\u7247\u6a94\u6848\u7684\u6a94\u540d&gt;</code></li> <li>\u5047\u5982\u6c7a\u5b9a\u8981\u7528\"\u76ee\u524d\u6240\u5728\u5206\u652f\u7684\"\u5716\u7247\u6a94\u6848</li> <li>$ <code>git checkout --ours cutest_animal.jpg</code></li> <li><code>--ours</code>: \u6c7a\u5b9a\u8981\u7528\"\u76ee\u524d\u6240\u5728\u5206\u652f\u7684\"\u5716\u7247\u6a94\u6848</li> <li>\u5047\u5982`\u6c7a\u5b9a\u8981\u7528\"\u53e6\u4e00\u500b\u5206\u652f\u7684\"\u5716\u7247\u6a94\u6848</li> <li>$ <code>git checkout --theirs cutest_animal.jpg</code></li> <li><code>--theirs</code>: \u6c7a\u5b9a\u8981\u7528\"\u53e6\u4e00\u500b\u5206\u652f\u7684\"\u5716\u7247\u6a94\u6848</li> </ul> </li> <li>\u63a5\u8457\u8a18\u5f97\u7e7c\u7e8c\u6309\u7167\u5e73\u5e38\u7684\u6d41\u7a0b,\u5c07\"\u5df2\u4fee\u6b63\u7684\u6a94\u6848\" \u52a0\u5230 \"\u66ab\u5b58\u5340\"(staging area)</li> <li>$ <code>git add &lt;\u8def\u5f91/\u6c7a\u5b9a\u8981\u7528\u7684\u540c\u540d\u7a31\u5716\u7247\u6a94\u6848\u7684\u6a94\u540d&gt;</code></li> <li>$ <code>git commit -m \"git merge\u5716\u7247\u6a94\u6848\u767c\u751f\u885d\u7a81\u6642,\u53ef\u4ee5\u7528git checkout --ours/--theirs\u53c3\u6578 \u4f86\u8655\u7406\u5408\u4f75\u5206\u652f\u7684\u885d\u7a81\"</code></li> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#_9","title":"\u76ee\u524d\u7684\u5de5\u4f5c\u505a\u5230\u4e00\u534a,\u5982\u679c\u8981\u81e8\u6642\u5207\u63db\u5230\u5225\u7684\u4efb\u52d9,\u8a72\u600e\u9ebc\u505a\u5462?","text":"<ul> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u5047\u8a2d\u73fe\u5728\u81e8\u6642\u6709\u500b\u91cd\u5927Bug\u8981\u4fee\u5fa9,\u4f46\u662f\u7576\u4e0b\u6b63\u5728<code>develop\u5206\u652f</code>\u958b\u767c\u65b0\u529f\u80fd,\u958b\u767c\u5230\u4e00\u534a; \u9019\u6642\u5019\u53ef\u4ee5\u7528\u4ee5\u4e0b2\u7a2e\u65b9\u5f0f\u4f86\u8655\u7406</li> <li>\u5148<code>commit</code>\u76ee\u524d\u7684\u9032\u5ea6<ul> <li>$ <code>git add --all</code></li> <li>$ <code>git commit -m \"\u5c1a\u672a\u5b8c\u6210\u7684\u65b0\u529f\u80fd\u958b\u767c\u5206\u652f\"</code></li> <li>\u63a5\u4e0b\u4f86\u5c31\u53ef\u4ee5\u5207\u63db\u5230\u91cd\u5927Bug\u6240\u5728\u7684\u5206\u652f(branch)\u5148\u9032\u884c\u4fee\u5fa9,\u5f85\u5b8c\u6210\u4e4b\u5f8c\u518d\u5207\u63db\u56de\u4f86\u539f\u4f86\u505a\u4e00\u534a\u7684<code>develop\u5206\u652f</code></li> <li>$ <code>git checkout develop</code></li> <li>\u518d\u5229\u7528<code>Reset</code>\u56de\u5230<code>HEAD</code>\u6307\u6a19\u76ee\u524d\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>(\"\u5c1a\u672a\u5b8c\u6210\u7684\u65b0\u529f\u80fd\u958b\u767c\u5206\u652f\")\u7684\u524d\u4e00\u6b21HEAD\u7d00\u9304,\u628a\u525b\u525b\u958b\u767c\u5230\u4e00\u534a\u7684\u6771\u897f\u62c6\u51fa\u4f86\u7e7c\u7e8c\u958b\u767c</li> <li>$ <code>git reset HEAD^</code></li> </ul> </li> <li>\u5229\u7528Git\u7684<code>Stash</code>\u529f\u80fd<ul> <li>$ <code>git stash</code>: \u5c07\"\u66ab\u5b58\u5340\"(staging area)\u7684\u6a94\u6848\u90fd\u52a0\u5230<code>Stash</code>\u4e2d</li> <li>$ <code>git stash</code> \u9810\u8a2d\u5c31\u662f\u76f8\u7576\u65bc $ <code>git stash push</code> </li> <li><code>-u</code> (=&gt; <code>--include-untracked</code>): \u53ef\u4ee5\u52a0\u4e0a\u9019\u500b\u53c3\u6578,\u8b93<code>\u5de5\u4f5c\u76ee\u9304</code>(working directory)\u4e2d\u7684<code>Untracked Files</code>\u4e5f\u4e00\u8d77\u52a0\u5165\u5230<code>Stash</code>\u4e2d</li> <li></li> <li>\u9019\u6642\u5019\u6aa2\u8996Git\u72c0\u614b,\u6703\u767c\u73fe\u7576\u4e0b\u7684\u72c0\u614b\u8ddf\u525b<code>commit</code>\u5b8c\u4e00\u6a23\u4e7e\u6de8</li> <li>$ <code>git stash list</code>: \u5217\u51fa\u6240\u6709\u76ee\u524d\u64c1\u6709\u7684<code>Stash</code>\u9805\u76ee</li> <li>\u6700\u524d\u9762\u7684<code>stash@{0}</code>\u5c31\u662f\u9019\u500b<code>Stash</code>\u7684\u4ee3\u540d\u8a5e</li> <li>\u5f8c\u9762\u7684<code>WIP on &lt;\u8a72\u5206\u652f\u7684\u540d\u7a31&gt;</code>\u7684<code>WIP</code>\u662f\"Work In Progress\",\u4e5f\u5c31\u662f\u5de5\u4f5c\u9032\u884c\u4e2d\u7684\u610f\u601d</li> <li><code>Stash</code>\u53ef\u4ee5\u5efa\u7acb\u597d\u591a\u500b</li> <li></li> <li>$ <code>git stash pop stash@{&lt;\u7de8\u865f&gt;}</code>: \u5c07\u67d0\u500bStash\u9805\u76ee\u62ff\u51fa\u4f86\u4e26\u5957\u7528\u5230\u76ee\u524d\u7684\u5206\u652f\u4e0a; \u7576\u5957\u7528\u6210\u529f\u5f8c,\u8a72<code>Stash</code>\u5c31\u6703\u88ab\u522a\u9664</li> <li>\u5982\u679c\u4f7f\u7528 $ <code>git stash pop</code>\u6307\u4ee4,\u537b\u6c92\u6709\u6307\u5b9a\u8981\u5957\u7528\u54ea\u500b<code>Stash</code>\u7684\u8a71,\u5c31\u6703\u5f9e\u6700\u5c0f\u7684\u958b\u59cb,\u76f8\u7576\u65bc\u5f9e<code>stash@{0}</code>\u958b\u59cb\u62ff(\u4e5f\u5c31\u662f\u6700\u5f8c\u758a\u4e0a\u53bb<code>Stash</code>\u7684\u90a3\u6b21)</li> <li></li> <li>$ <code>git stash apply stash@{&lt;\u7de8\u865f&gt;}</code>: \u5c07\u67d0\u500bStash\u9805\u76ee\u62ff\u51fa\u4f86\u4e26\u5957\u7528\u5230\u76ee\u524d\u7684\u5206\u652f\u4e0a; \u4f46\u662f\u7576\u5957\u7528\u6210\u529f\u5f8c,\u4f46\"\u4e0d\u8981\"\u5c07\u8a72<code>Stash</code>\u522a\u9664,\u9084\u662f\u6703\u7559\u5728<code>Stash List</code>\u4e0a</li> <li>$ <code>git stash drop stash@{&lt;\u7de8\u865f&gt;}</code>: \u5f9e<code>Stash List</code>\u4e2d\u522a\u9664\u8a72<code>Stash</code></li> <li>$ <code>git stash clear</code>: \u5f9e<code>Stash List</code>\u4e2d\u6e05\u9664\u6240\u6709\u7684<code>Stash</code></li> </ul> </li> </ul>"},{"location":"version_control/git/#exgit","title":"\u5982\u679c\u4e0d\u5c0f\u5fc3\u5c07\u6a5f\u654f\u8cc7\u6599(ex:\u5e33\u865f\u3001\u5bc6\u78bc)\u653e\u5728Git\u88e1,\u60f3\u628a\u5b83\u522a\u6389,\u8a72\u600e\u9ebc\u505a\u5462?","text":"<ul> <li>\u53ef\u5148\u53c3\u8003 \u5982\u679c\u6709\u7279\u5b9a\u6a94\u6848\u4e0d\u60f3\u653e\u5728Git\u88e1\u9762\u4e00\u8d77\u5099\u4efd\u6216\u662f\u4e0a\u50b3\u5230Git Server\u7684\u8a71,\u4f8b\u5982:\u8cc7\u6599\u5eab\u5bc6\u78bc,\u96f2\u7aef\u4f3a\u670d\u5668\u7684\u91d1\u9470...\u53ef\u4ee5\u52a0\u5165 .gitignore \u4e2d] \u7ae0\u7bc0</li> <li>\u9996\u5148,\u5982\u679c\u662f\u5df2\u7d93<code>\u63a8\u9001(Push)</code>\u4e0a\u53bb\u5230GitHub\u4e0a\u7684\u8a71,\u8acb\u5148\u4e0d\u8981\u60f3\u8981\u7528Git\u4f86\u89e3\u6c7a,\u5f37\u70c8\u5efa\u8b70\u76f4\u63a5\u5148\u6539\u5bc6\u78bc\u518d\u8aaa! \u6539\u5b8c\u5bc6\u78bc\u5f8c,\u518d\u63a5\u8457\u5229\u7528Git\u505a\u5f8c\u7e8c\u88dc\u6551\u63aa\u65bd</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u5047\u8a2d\u6211\u60f3\u8981\u628a<code>config/database.yml</code>\u9019\u500b\u6a94\u6848\u5f9e\u6bcf\u500b<code>Commit\u7269\u4ef6</code>\u88e1\u628a\u5b83\u62ff\u6389,\u6bd4\u8f03\u8f9b\u82e6\u7684\u505a\u6cd5\u662f\u4f7f\u7528 <code>Rebase</code>\u6307\u4ee4,\u7136\u5f8c\u4e00\u500b\u4e00\u500b\u9032\u53bb<code>Commit\u7269\u4ef6</code>\u53bb\u7de8\u8f2f</li> <li>\u90a3\u5982\u679c\u4e0d\u60f3\u4f7f\u7528<code>Rabse\u6307\u4ee4</code>\u7684\u65b9\u5f0f\u4f86\u8655\u7406\u7684\u8a71,\u6709\u4ee5\u4e0b3\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u88dc\u6551<ul> <li>\u6574\u500b\u780d\u6389\u91cd\u7df4(=&gt;\u4e0d\u5efa\u8b70\u9019\u6a23\u505a)</li> <li>$ <code>rm -r .git/</code>: \u5c07\u6574\u500b<code>.git/</code>\u76ee\u9304\u522a\u6389</li> <li>\u628a\u6240\u6709\u542b\u6709\u6a5f\u654f\u8cc7\u6599\u7684\u76f8\u95dc\u6a94\u6848\"\u522a\u9664\"\u6216\u662f\"\u4fee\u6b63\"</li> <li>\u91cd\u65b0<code>commit</code>\u4e00\u6b21<ul> <li>$ <code>git add --all</code></li> <li>$ <code>git commit -m \"initial commit\"</code></li> </ul> </li> <li>\u5229\u7528 $ <code>git filter-branch</code>\u6307\u4ee4</li> <li>$ <code>git filter-branch --tree-filter &lt;command&gt;</code><ul> <li>$ <code>git filter-branch</code> \u9019\u500b\u6307\u4ee4\u53ef\u4ee5\u8b93\u4f60\u6839\u64da\u4e0d\u540c\u7684<code>filter\u689d\u4ef6</code>,\u4e00\u500b\u4e00\u500b\u61c9\u7528\u5230\u6bcf\u500b<code>Commit\u7269\u4ef6</code>\u4e0a\u4f86\u8655\u7406</li> <li><code>--tree-filter &lt;command&gt;</code>: \u6703\u5728\u63a5\u4e0b\u4f86$ <code>git checkout</code> \u7684\u6bcf\u500bCommit\u7269\u4ef6\u6642,\u90fd\u6703\u57f7\u884c\u5f8c\u9762\u6307\u5b9a\u7684<code>&lt;command&gt;</code>,\u5168\u90e8\u57f7\u884c\u5b8c\u5f8c\u6703\u518d\u81ea\u52d5\u91cd\u65b0\u518d<code>commit</code>\u4e00\u6b21</li> <li>\u5047\u8a2d\u662f\u522a\u9664\u4e86\u4e00\u500b\u6a5f\u654f\u8cc7\u6599\u7684\u6a94\u6848\u7684\u8a71,\u56e0\u70ba\u662f\"\u522a\u9664\"\u7684\u884c\u70ba,\u6240\u4ee5\u5c0dGit\u4f86\u8aaa\u5728\u90a3\u4e4b\u5f8c\u7684\u6240\u6709<code>Commit\u7269\u4ef6</code>\u90fd\u8981\u5168\u90e8\u91cd\u65b0\u8a08\u7b97,\u4e5f\u5c31\u662f\u76f8\u7576\u65bc\u7522\u751f\u4e00\u4efd\u65b0\u7684<code>commit\u7d00\u9304</code>\u4e86</li> <li>\u5099\u8a3b: \u6a94\u6848\u4e00\u65e6\u52a0\u5165Git\u7248\u63a7\u4e2d,\u8981\u5fb9\u5e95\u522a\u9664\u5c31\u6c92\u90a3\u9ebc\u597d\u522a\u9664\u4e86</li> <li>\u4f8b\u5982: $ <code>git filter-branch --tree-filter \"rm -f config/database.yml\"</code> =&gt; \u5c07<code>config/database.yml</code>\u9019\u500b\u6a94\u6848\u5f9e\u6bcf\u6b21\u7684Commit\u7269\u4ef6\u4e2d\u522a\u9664</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/faq/remove-sensitive-data.html</li> </ul> </li> <li>\u5982\u679c\u53c8\u5f8c\u6094\u4e86,\u60f3\u8981\u56de\u5fa9\u525b\u525b$ <code>git filter-branch</code>\u9020\u6210\u7684\u7d50\u679c\u4ee5\u524d\u7684\u72c0\u614b,\u8a72\u600e\u9ebc\u8fa6\u5462?<ul> <li>\u539f\u7406: \u7576\u57f7\u884c$ <code>git filter-branch</code>\u6307\u4ee4\u7684\u6642\u5019,Git\u6703\u5e6b\u4f60\u628a\u4e4b\u524d\u7684\u72c0\u614b\u5099\u4efd\u4e00\u4efd\u5728 <code>.git/refs/original/refs/heads/</code> \u9019\u500b\u76ee\u9304\u88e1\u9762</li> <li>\u5176\u5be6\u8207\u5176\u8aaa\u662f\u5099\u4efd,\u4e5f\u53ea\u662f\u5099\u4efd\u958b\u59cb\u9032\u884c<code>filter-branch</code>\u4e4b\u524d\u7684\u90a3\u500b<code>HEAD</code>\u6307\u5411\u7684<code>Commit\u7269\u4ef6</code>\u7684<code>SHA-1\u503c</code>\u800c\u5df2</li> <li>\u63a5\u8457\u5c31\u53ef\u4ee5\u5229\u7528<code>hard Reset\u6307\u4ee4</code>\u76f4\u63a5\u5207\u56de\u53bb\u539f\u4f86\u7684<code>Commit\u7269\u4ef6</code>,\u9019\u6a23\u5c31\u90fd\u56de\u4f86\u4e86</li> <li>$ <code>git reset .git/refs/original/refs/heads/master --hard</code> </li> <li>\u53ef\u53c3\u8003 git reset \u662f\u7528\u4f86\u524d\u5f80\u5230\u6307\u5b9a\u7684 Commit \u7269\u4ef6\u4e0a\u7684 \u7ae0\u7bc0</li> <li>\u53ef\u53c3\u8003 \u5982\u679c\u60f3\u91cd\u65b0\u7de8\u8f2f\u525b\u624d\u7684commit \u7ae0\u7bc0</li> </ul> </li> <li>\u5229\u7528 $ <code>git push -f</code>:\u91cd\u65b0\"\u5f37\u5236\"<code>\u63a8\u9001(Push)</code>\u4e00\u4efd\u4f60\u525b\u525b\u5df2\u7d93$ <code>git filter-branch</code>\u904e\u5f8c\u7684<code>commit</code>\u4e0a\u53bb\u4f86\u8986\u84cb\u6389\u5b83</li> <li>\u63d0\u9192: \u56e0\u70ba\u5176\u5be6\u5df2\u7d93<code>\u63a8\u9001(Push)</code>\u51fa\u53bb\u7684\u6771\u897f\u5c31\u8ddf\u6f51\u51fa\u53bb\u7684\u6c34\u4e00\u6a23,\u6536\u4e0d\u56de\u4f86\u7684 </li> </ul> </li> </ul>"},{"location":"version_control/git/#commit_5","title":"\u53ef\u4ee5\u53ea\u53d6\u7528\u67d0\u500b\u5206\u652f\u7684\u5176\u4e2d\u67d0\u5e7e\u500b<code>commit</code>\u55ce?","text":"<ul> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li><code>$ git cherry-pick &lt;\u8981\u53d6\u7528\u7684Commit\u7269\u4ef6\u7684id&gt;</code>: \u53ef\u4ee5\u53ea\u9078\u53d6\u6307\u5b9a\u7684<code>commit</code>\u4f86\u7528</li> <li>\u5047\u8a2d\u5728<code>red\u5206\u652f</code>\u65b0\u589e\u4e00\u500b<code>cherry-pick-test.html</code>\u6a94\u6848,\u4e26\u7528<code>cherry-pick\u6307\u4ee4</code>\u5c07\u9019\u500b<code>commit</code>\u62ff\u4f86\u4f7f\u7528,\u52a0\u5230\u76ee\u524d\u6240\u5728\u7684\u5206\u652f\u4e0a\u9762<ul> <li>$ <code>git checkout -b red</code>: \u65b0\u589e\u4e00\u500b<code>red\u5206\u652f</code>\u4e26\u5207\u63db\u5230\u8a72\u5206\u652f\u4e0a</li> <li>$ <code>echo \"test $ git cherry-pick\" &gt; cherry-pick-test.html</code>: \u65b0\u589e\u4e00\u6bb5\u6587\u5b57\u5230\u6e2c\u8a66\u6a94\u6848\u4e2d</li> <li>$ <code>git commit -a -m \"\u65b0\u589egit cherry-pick\u7b46\u8a18\"</code>: \u5c07\u6e2c\u8a66\u6a94\u6848\u52a0\u5230<code>\u66ab\u5b58\u5340</code>(staging area)\u4e26\u540c\u6642\u63d0\u4ea4\u5230<code>\u5132\u5b58\u5eab</code>(repo)</li> <li>$ <code>git checkout master</code>: \u5207\u63db\u56de<code>master\u5206\u652f</code>\u4e0a</li> <li>$ <code>git cherry-pick d685d6f</code>: \u9078\u53d6<code>red\u5206\u652f</code>\u4e0a\u525b\u525b\u63d0\u4ea4\u7684\u90a3\u500b<code>Commit\u7269\u4ef6</code>,\u4e26\u5c07\u5b83\u52a0\u5230\u76ee\u524d\u6240\u5728\u5206\u652f\u7684\u6700\u524d\u9762</li> <li></li> </ul> </li> <li><code>$ git cherry-pick &lt;\u8981\u53d6\u7528\u7684Commit\u7269\u4ef6\u7684id 1&gt; &lt;\u8981\u53d6\u7528\u7684Commit\u7269\u4ef6\u7684id 2&gt;</code>: \u53ef\u4ee5\u4e00\u6b21\u9078\u53d6\u591a\u500b\u6307\u5b9a\u7684<code>commit</code>\u4f86\u7528</li> <li>$ <code>git cherry-pick &lt;\u8981\u53d6\u7528\u7684Commit\u7269\u4ef6\u7684id&gt; --no-commit</code>: \u64bf\u904e\u4f86\u7684<code>commit</code>\u4e0d\u6703\u76f4\u63a5\u5408\u4f75,\u800c\u662f\u5148\u653e\u5230<code>\u66ab\u5b58\u5340</code>(staging area)<ul> <li><code>--no-commit</code>: \u64bf\u904e\u4f86\u7684<code>commit</code>\u4e0d\u6703\u76f4\u63a5\u5408\u4f75,\u800c\u662f\u6703\u5148\u653e\u5728<code>\u66ab\u5b58\u5340</code>(staging area)</li> </ul> </li> </ul>"},{"location":"version_control/git/#git_11","title":"\u5982\u4f55\u628a\u4e00\u500b\u6a94\u6848\u5f9eGit\u7248\u63a7\u4e2d\u771f\u6b63\u7684\u79fb\u9664\u6389\u5462?","text":"<ul> <li>\u56e0\u70baGit\u662f\u4e00\u500b\u5206\u6563\u5f0f\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7d71,\u7576\u6a94\u6848\u88abGit\u7248\u63a7\u5f8c,\u5c31\u5f88\u96e3\u771f\u6b63\u7684\u79fb\u9664\u6389\u4e86</li> <li>\u60f3\u8981\u5c07\u5df2\u88abGit\u7248\u63a7\u7684\u6a94\u6848,\u5b8c\u5168\u5f9eGit\u79fb\u9664\u6389\u7684\u8a71,\u6709\u4ee5\u4e0b3\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u505a\u5230</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/faq/remove-files-from-git.html<ul> <li>\u5c07\u6574\u500b <code>.git/</code> \u76ee\u9304\u5b8c\u5168\u79fb\u9664</li> <li>\u7528<code>Rebase\u65b9\u5f0f</code>\u9032\u884c\u7de8\u8f2f,\u91cd\u6574<code>commit\u7d00\u9304</code> (=&gt; \u9069\u7528\u65bc\u7576<code>commit\u7d00\u9304</code>\u7684\u6578\u91cf\u4e0d\u7b97\u591a\u7684\u6642\u5019)</li> <li>\u53ef\u53c3\u8003 \u5206\u652f(branch)\u64cd\u4f5c \u7ae0\u7bc0\u7684 <code>git rebase -i</code></li> <li>\u5229\u7528$ <code>git filter-branch --tree-filter &lt;command&gt;</code>,\u53ef\u4ee5\u5927\u7bc4\u570d\u7684\u5c0d\u6bcf\u500b<code>Commit\u7269\u4ef6</code>\u90fd\u57f7\u884c\u4e00\u6b21\u8a72\u6307\u5b9a\u7684\u547d\u4ee4(<code>&lt;command&gt;</code>),\u4e26\u65bc\u4fee\u6539\u5b8c\u6210\u5f8c\u518d\u81ea\u52d5\u91cd\u65b0<code>commit</code></li> <li>\u4f8b\u5982: <code>$ git filter-branch -f --tree-filter \"rm -f config/database.yml\"</code><ul> <li>\u6ce8\u610f! \u591a\u52a0\u4e86\u4e00\u500b \"<code>-f</code>\"\u53c3\u6578,\u662f\u56e0\u70ba\u8981\u5f37\u5236\u8986\u5beb<code>filter-branch</code>\u7684\u5099\u4efd\u9ede,\u9019\u908a\u4f7f\u7528<code>filter-branch</code>\u6307\u4ee4\u628a\u6a94\u6848\u5f9e<code>\u5de5\u4f5c\u76ee\u9304</code>(working directory)\u79fb\u9664\u6389,\u9019\u6642\u5019<code>database.yml</code>\u78ba\u5be6\u4e0d\u898b\u4e86,\u4f46\u9084\u6709\u597d\u5e7e\u500b\u8ddf\u8cc7\u6e90\u56de\u6536\u6709\u95dc\u7684\u4e8b\u60c5\u9700\u8981\u8655\u7406</li> <li><code>-f</code> (=&gt; <code>--force</code>): \u5f37\u5236\u8986\u5beb<code>filter-branch</code>\u7684\u5099\u4efd\u9ede <p><code>git filter-branch -f</code>: git filter-branch refuses to start with an existing temporary directory or when there are already refs starting with refs/original/, unless forced.</p> </li> </ul> </li> <li>\u53ef\u4ee5\u53c3\u8003 \u5982\u679c\u4e0d\u5c0f\u5fc3\u5c07\u6a5f\u654f\u8cc7\u6599(ex:\u5e33\u865f\u3001\u5bc6\u78bc)\u653e\u5728Git\u88e1,\u60f3\u628a\u5b83\u522a\u6389,\u8a72\u600e\u9ebc\u505a\u5462? \u7ae0\u7bc0</li> <li>\u56e0\u70ba\u57f7\u884c$ <code>git filter-branch</code>\u6307\u4ee4,\u6240\u6709Git\u6703\u81ea\u52d5\u6709\u5099\u4efd\u9ede,\u96a8\u6642\u53ef\u4ee5\u900f\u904e\u5b83\u518d\u8df3\u56de\u53bb,\u6240\u4ee5\u8981\u5148\u65b7\u4e86\u9019\u689d\u7dda</li> <li>$ <code>rm .git/refs/original/refs/heads/master</code></li> <li>$ <code>git reflog expire --all --expire=now</code>: \u8981\u6c42<code>Reflog</code>\u73fe\u5728\u7acb\u523b\u904e\u671f(\u56e0\u70ba<code>Reflog</code>\u9810\u8a2d\u6703\u81ea\u52d5\u4fdd\u5b5830\u5929\u5167\u7684\u7d00\u9304)</li> <li>$ <code>git reflog expire</code>: <code>Reflog</code>\u7684\u5b50\u547d\u4ee4<code>expire</code>\u6703\u4fee\u526a\u6389\u904e\u53bb\"\u820a\u7684\" <code>Reflog\u7d00\u9304</code> <p>The \"expire\" subcommand prunes older reflog entries.</p> </li> <li><code>--all</code> (=&gt; <code>--force</code>): \u5c0d\u6240\u6709\u7684<code>Reflog\u7d00\u9304</code>\u505a\u8655\u7406</li> <li><code>--expire=&lt;time&gt;</code>: \u4fee\u526a\u6389\u6bd4<code>&lt;time&gt;</code>\u9019\u500b\u6642\u9593\u9084\"\u820a\"\u7684<code>Reflog\u7d00\u9304</code></li> <li>$ <code>git fsck --unreachable</code>: \u9a57\u8b49\u6240\u6709\u7684Git\u7269\u4ef6\u5728<code>.git/objects</code>\u4e2d,\u4e26\u53ea\u986f\u793a\u51fa\"\u4ecd\u7136\u5b58\u5728\"\u4f46\u662f\u70ba\"Unreachable\u72c0\u614b\"\u7684\u7269\u4ef6</li> <li><code>--unreachable</code>: \u50c5\u5217\u51fa\"\u4ecd\u7136\u5b58\u5728\"\u4f46\u662f\u70ba\"Unreachable\u72c0\u614b\"\u7684\u7269\u4ef6</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/faq/remove-files-from-git.html</li> <li>\u6700\u5f8c,\u555f\u52d5Git\u7684\u8cc7\u6e90\u56de\u6536\u6a5f\u5236,\u8acb\u5783\u573e\u8eca\"\u73fe\u5728\"\u4f86\u628a\u5b83\u5011\u8f09\u8d70</li> <li>$ <code>git gc --prune=now</code>: <ul> <li><code>--prune=&lt;date&gt;</code>: \u4fee\u526a\u6389\u6240\u6709\u6bd4<code>&lt;date&gt;</code>\u9019\u500b\u6642\u9593\u9084\"\u820a\"\u7684\u4e26\u4e14\"\u672a\u53d7\u63a7\u5236\"(loose)\u7684\u7269\u4ef6 </li> </ul> </li> <li>\u53ef\u53c3\u8003 Git\u5176\u5be6\u4e0d\u662f\u5728\u505a\u5dee\u7570\u5099\u4efd,\u800c\u662f\u5728\u70ba\u7576\u6642\u7684\u5c08\u6848\u5efa\u7acb\u5feb\u7167(snapshot) \u7ae0\u7bc0\u7684$<code>git gc</code>\u7ae0\u7bc0</li> <li>\u53ef\u4ee5\u6aa2\u67e5\u770b\u770b\u662f\u5426\u771f\u7684\u5b8c\u5168\u522a\u9664\u4e86\u8a72\u6a94\u6848,\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b2\u7a2e\u65b9\u6cd5</li> <li>$ <code>git fsck</code><ul> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/faq/remove-files-from-git.html</li> </ul> </li> <li>$ <code>git reset &lt;Commit\u7269\u4ef6\u7684id&gt; --hard</code><ul> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/faq/remove-files-from-git.html</li> <li>\u63d0\u9192: \u5982\u679c\u9019\u4e9b\u5167\u5bb9\u5df2\u7d93<code>\u63a8\u9001</code>(Push)\u51fa\u53bb\u7684\u8a71,\u8981\u8a18\u5f97\u7528$ <code>git push -f</code> \u4f86\u628a\u7dda\u4e0a\u7684\u7d00\u9304\u5f37\u5236\u84cb\u6389\u5594!</li> </ul> </li> </ul> </li> </ul>"},{"location":"version_control/git/#-github","title":"\u9060\u7aef\u5171\u540c\u5354\u4f5c\u7bc7---\u4ee5 GitHub \u70ba\u4f8b","text":"<p><code>GitHub \u5b98\u65b9\u6587\u4ef6</code>(Official Docs) - https://docs.github.com/en <code>GitHub \u5b98\u65b9\u7db2\u7ad9</code>(Official Website) - https://github.com/ <code>git remote</code> - Manage set of tracked repositories <code>git push</code> - Update remote refs along with associated objects <code>git pull</code> - Fetch from and integrate with another repository or a local branch <code>git fetch</code> - Download objects and refs from another repository <code>git clone</code> - Clone a repository into a new directory <code>Forking Projects</code> - \u5982\u679c\u6211\u5011\u60f3\u8981\u5c0d\u4e00\u500b\u5728GitHub\u4e0a\u5df2\u7d93\u5b58\u5728\u7684\u958b\u6e90\u5c08\u6848\u505a\u51fa\u8ca2\u737b(\u4fee\u6539),\u4f46\u662f\u6211\u5011\u6c92\u6709<code>\u63a8\u9001</code>(Push)\u5230\u9019\u500brepository\u7684\u6b0a\u9650\u7684\u8a71,\u6211\u5011\u53ef\u4ee5<code>Fork</code>\u4e00\u4efd\u9019\u500b\u5c08\u6848\u5230\u81ea\u5df1\u7684GitHub\u4e0a,\u6210\u70ba\u5c6c\u65bc\u5b58\u5728\u65bc\u6211\u5011\u81ea\u5df1\u7684GitHub namespace,\u9019\u6a23\u6211\u5011\u81ea\u5df1\u5c31\u6709\u6b0a\u9650\u53ef\u4ee5<code>\u63a8\u9001</code>(Push)\u5230\u9019\u500brepository\u4e0a\u9762\u53bb\u4e86 <code>Pull Request</code> - \u6703\u767c\u9001\u4e00\u500b\"\u901a\u77e5\"(<code>PR</code>)\u7d66\u539f\u4f5c\u8005,\u8acb\u6c42\u539f\u4f5c\u8005\u540c\u610f\u5c07\u6211\u5011\u4e4b\u524d<code>Fork</code>\u56de\u4f86\u4e26\u4fee\u6539\u5f8c\u7684\u5167\u5bb9<code>\u5408\u4f75</code>(Merge)\u5230\u539f\u4f5c\u8005\u7684\u5c08\u6848\u4e2d; \u540c\u6642\u539f\u4f5c\u8005\u4e5f\u53ef\u4ee5\u4e0d\u7528\u64d4\u5fc3\u9700\u8981\u958b\u653e\u7de8\u8f2f\u6b0a\u9650\u7d66\u6240\u6709\u958b\u767c\u8005\u5011\u800c\u96e3\u4ee5\u7ba1\u7406 <code>git format-patch</code> - Prepare patches for e-mail submission <code>git am</code> - Apply a series of patches from a mailbox</p>"},{"location":"version_control/git/#github","title":"GitHub \u57fa\u790e\u4f7f\u7528\u64cd\u4f5c\u8aaa\u660e","text":"<ul> <li>GitHub\u662f\u76ee\u524d\u5168\u7403\u6700\u5927\u7684Git Server,\u53ef\u4ee5\u5e6b\u5fd9\u8ca2\u737b\u5176\u4ed6\u4eba\u7684\u5c08\u6848,\u4e26\u4e14\u5176\u4ed6\u4eba\u4e5f\u53ef\u4ee5\u56de\u994b\u5230\u4f60\u7684\u5c08\u6848,\u5efa\u7acb\u826f\u6027\u5faa\u74b0</li> <li>Git\u662f\u4e00\u500b\u7528\u4f86\u505a\u7248\u672c\u63a7\u5236\u7684\u8edf\u9ad4,\u800cGitHub\u662f\u4e00\u500b\u7db2\u7ad9</li> <li>\u5176\u4e2dGitHub\u7684\u672c\u9ad4\u662f\u4e00\u500bGit Server,\u7db2\u7ad9\u5247\u662f\u7528Ruby on Rails\u958b\u767c\u7684</li> <li>GitHub\u65bc 2019/01 \u4ee5\u5f8c,\u958b\u59cb\u53ef\u4ee5\u514d\u8cbb\u5efa\u7acbprivate repository</li> </ul>"},{"location":"version_control/git/#github-repositoryrepositorygithub","title":"\u65b0\u5efa\u4e00\u500bGitHub repository,\u4e26\u63a8\u9001\u672c\u5730\u7aefrepository\u5230GitHub\u4e0a","text":"<ul> <li>\u5982\u4f55\u5efa\u7acb\u4e00\u500b\u65b0\u7684GitHub repository\u5462?</li> <li>\u5b98\u65b9\u5efa\u8b70\u6bcf\u7576\u65b0\u5efa\u4e00\u500brepository\u6642,\u9700\u5305\u542b\u4ee5\u4e0b3\u7a2e\u6a94\u6848<ul> <li><code>README.md</code>: \u8a72repository\u7684\u4f7f\u7528\u8aaa\u660e</li> <li><code>LICENSE.md</code>: \u8a72repository\u7684\u6388\u6b0a\u7bc4\u570d</li> <li><code>.gitignore</code>: \u8a72repository\u6307\u5b9a\"\u4e0d\u8981\"\u8ffd\u8e64\u7684\u6a94\u6848\u6709\u54ea\u4e9b?</li> </ul> </li> <li><code>\u6d41\u7a0b\u5982\u4ee5\u4e0b\u8aaa\u660e</code></li> <li>\u53ef\u4ee5\u9078\u64c7\u8981\u7528 <code>HTTPS</code> or <code>SSH</code> \u7684\u65b9\u5f0f\u4f86\u9023\u7dda\u5230\u9019\u500bGitHub repository<ul> <li><code>HTTPS</code>:\u5728\u4e0a\u50b3\u6642\u9700\u8981\u8f38\u5165\u5e33\u5bc6,\u5982\u679c\u4e0d\u9700\u8981\u5927\u591a\u662f\u5e33\u5bc6(Key Chain)\u5df2\u5b58\u5728\u96fb\u8166\u5167</li> <li><code>SSH</code>: \u9700\u8981\u5148\u5728\u96fb\u8166\u5167\u8a2d\u5b9a\u597d\u91d1\u9470(SSH key),\u4e26\u5132\u5b58\u9019\u500b\u91d1\u9470\u5230\u81ea\u5df1\u7684GitHub\u4e0a,\u4e0a\u50b3\u6642\u5c31\u4e0d\u9700\u8981\u8f38\u5165\u984d\u5916\u5e33\u5bc6</li> </ul> </li> <li>\u5982\u679c\u662f\u5168\u65b0\u958b\u59cb,\u53ef\u4ee5\u53c3\u8003\u5b98\u7db2\u4e0a\u7684\u63d0\u793a \"create a new repository on the command line\" \u7684\u6307\u793a\u9032\u884c<ul> <li>$ <code>echo \"# gitLearn\" &gt;&gt; README.md</code></li> <li>$ <code>git init</code> </li> <li>$ <code>git add README.md</code></li> <li>$ <code>git commit -m \"first commit\"</code></li> <li>$ <code>git remote add origin git@github.com:&lt;\u81ea\u5df1\u7684username&gt;/&lt;\u8981\u65b0\u5efa\u7684repository\u7684\u540d\u7a31&gt;.git</code></li> <li>$ <code>git remote add</code>: \u4ee3\u8868\u8981\u8a2d\u5b9a\u4e00\u500b\u9060\u7aef(remote)\u7684\u7bc0\u9ede</li> <li><code>origin</code>: \u662f\u4e00\u500b\u6163\u7528\u7684\u4ee3\u540d\u8a5e,\u4f5c\u70ba\u9060\u7aef\u7bc0\u9ede\u7684\u9810\u8a2d\u540d\u7a31,\u6307\u7684\u662f\u5f8c\u9762\u90a3\u4e32GitHub\u4f3a\u670d\u5668\u7684\u4f4d\u7f6e</li> <li>\u5982\u679c\u4e4b\u5f8c\u60f3\u66f4\u6539\u7684\u8a71,\u53ef\u4ee5\u76f4\u63a5\u5728\u8f38\u5165\u4e00\u6b21\u9019\u500b\u6307\u4ee4\u66f4\u6539<ul> <li>\u4f8b\u5982: $ <code>git remote add superman git@github.com:&lt;\u81ea\u5df1\u7684username&gt;/&lt;\u8981\u65b0\u5efa\u7684repository\u7684\u540d\u7a31&gt;.git</code> </li> </ul> </li> <li>$ <code>git push -u origin master</code></li> <li>\u8a2d\u5b9a\u597d\u9060\u7aef\u7bc0\u9ede\u5f8c,\u5c31\u8981\u5c07\u6771\u897f\u63a8\u9001(Push)\u4e0a\u53bb\u4e86</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u9019\u500b\u6307\u4ee4\u6703\u5c07<code>master\u5206\u652f</code>\u7684\u5167\u5bb9\u63a8\u9001\u5230\u9060\u7aef\u7684<code>origin\u7bc0\u9ede</code><ul> <li>\u5982\u679c<code>master\u5206\u652f</code>\u4e0d\u5b58\u5728\u7684\u8a71,\u5c31\u6703\u5efa\u7acb\u4e00\u500b\u53eb\u505amaster\u7684\u540c\u540d\u5206\u652f</li> <li>\u4f46\u5982\u679c\u672c\u4f86\u9060\u7aef\u7684<code>origin\u7bc0\u9ede</code>\u5c31\u5b58\u5728master\u5206\u652f\u7684\u8a71,\u4fbf\u6703\u79fb\u52d5\u9060\u7aef\u7684<code>origin\u7bc0\u9ede</code>\u4e0amaster\u5206\u652f\u7684\u4f4d\u7f6e,\u4f7f\u5b83\u5230\u76ee\u524d\u6700\u65b0\u7684\u9032\u5ea6\u4e0a</li> <li><code>-u</code> (=&gt; <code>--set-upstream</code>): \u8a2d\u5b9a<code>upstream</code>; \u6240\u8b02\"\u4e0a\u6e38(upstream)\"\u7684\u6982\u5ff5\u5176\u5be6\u5c31\u53ea\u662f\u53e6\u4e00\u500b\u5206\u652f\u7684\u540d\u5b57\u800c\u5df2\u3002\u5728Git\u88e1,\u6bcf\u500b\u5206\u652f\u53ef\u4ee5\u8a2d\u5b9a\u4e00\u500b<code>\u4e0a\u6e38(upstream)</code>,\u4f46\u6bcf\u500b\u5206\u652f\u6700\u591a\u53ea\u80fd\u8a2d\u5b9a\u4e00\u500b<code>\u4e0a\u6e38(upstream)</code>,\u5b83\u6703\u6307\u5411\u4e26\u8ffd\u8e64(track)\u67d0\u500b\u5206\u652f\u3002\u901a\u5e38<code>\u4e0a\u6e38(upstream)</code>\u6703\u662f\u9060\u7aefServer\u4e0a\u7684\u67d0\u500b\u5206\u652f,\u4f46\u5176\u5be6\u8981\u8a2d\u5b9a\u5728\u672c\u5730\u7aef\u7684\u5176\u4ed6\u5206\u652f\u4e5f\u53ef\u4ee5</li> <li>\u5982\u679c\u6709\u50cf\u9019\u500b\u6307\u4ee4\u8a2d\u5b9a\u597d\u5f8c,\u672a\u4f86\u5b83\u5c31\u6703\u88ab\u7576\u4f5c\u9810\u8a2d\u503c; \u4ee5\u9019\u500b\u6307\u4ee4\u4f86\u770b,\u5c31\u6703\u628a <code>origin/master</code> \u8a2d\u5b9a\u70ba\u672c\u5730master\u5206\u652f\u7684 <code>\u4e0a\u6e38(upstream)</code>,\u4e0b\u6b21$ <code>git push</code>\u6642,\u5c31\u53ef\u4ee5\u4e0d\u52a0\u4efb\u4f55\u53c3\u6578,Git\u5c31\u6703\u9810\u8a2d\u4f60\u662f\u8981\u63a8\u9001\u5230origin\u9019\u500b\u9060\u7aef\u7bc0\u9ede,\u4e26\u4e14\u628amaster\u9019\u500b\u5206\u652f\u7684\u5167\u5bb9\u63a8\u9001\u4e0a\u53bb</li> <li>\u4f8b\u5982: $ <code>git push</code></li> </ul> </li> <li>\u88dc\u51451: \u5982\u679c\u6c92\u6709\u8a2d\u5b9a\u597dupstream\u7684\u8a71,\u5c31\u5fc5\u9808\u5728\u6bcf\u6b21\u63a8\u9001\u51fa\u53bb\u6642,\u90fd\u8981\u8ddfGit\u8b1b\u6e05\u695a<ul> <li>\u4f8b\u5982: $ <code>git push origin master</code> = $ <code>git push origin master:master</code></li> </ul> </li> <li>\u88dc\u51452: \u5982\u679c\u63a8\u9001\u4e0a\u53bb\u9060\u7aeforigin\u7bc0\u9ede\u6642,\u4e0d\u60f3\u8981\u7528\u8ddf\u672c\u5730\u7aef\u5206\u652f\u7684\u540d\u7a31\u76f8\u540c\u7684\u8a71,\u53ef\u4ee5\u63a1\u53d6\u4ee5\u4e0b\u505a\u6cd5<ul> <li>\u4f8b\u5982: $ <code>git push origin master:dog</code></li> <li>\u9019\u6a23\u4ee3\u8868\u7576\u628a\u672c\u5730\u7aef\u7684master\u5206\u652f\u63a8\u9001\u4e0a\u53bb\u9060\u7aeforigin\u7bc0\u9ede\u6642,\u5c31\"\u4e0d\u6703\"\u5efa\u7acb\u4e00\u500borigin/master\u5206\u652f,\u800c\u662f\u5efa\u7acb(or \u66f4\u65b0\u9032\u5ea6)\u4e00\u500b\u53eb\u505aorigin/dog\u7684\u9060\u7aef\u5206\u652f</li> </ul> </li> </ul> </li> <li>\u5982\u679c\u662f\u8981\u4e0a\u5b58\u672c\u6a5f\u7aef(local)\u73fe\u5b58\u7684\u5c08\u6848,\u5247\u53ef\u4ee5\u53c3\u8003\u5b98\u7db2\u4e0a\u7684\u63d0\u793a \"push an existing repository from the command line\" \u7684\u6307\u793a\u9032\u884c<ul> <li>$ <code>git remote add origin git@github.com:&lt;\u81ea\u5df1\u7684username&gt;/&lt;\u8981\u65b0\u5efa\u7684repository\u7684\u540d\u7a31&gt;.git</code></li> <li>$ <code>git push -u origin master</code></li> </ul> </li> </ul>"},{"location":"version_control/git/#repositorypull","title":"\u5f9e\u9060\u7aefrepository\u5229\u7528Pull\u4e0b\u8f09\u4e26\u66f4\u65b0","text":"<ul> <li>\u53ef\u4ee5\u5229\u7528<code>Pull\u6307\u4ee4</code>\u5c07\u9060\u7aef\u5132\u5b58\u5eab(remote repository)\u4e0b\u8f09\u56de\u672c\u5730\u7aef\u5132\u5b58\u5eab(local repository)\u4e26\u66f4\u65b0</li> <li>\u7576\u57f7\u884c<code>Fetch\u6307\u4ee4</code>\u6642,Git\u6703\u6aa2\u67e5\u4e00\u4e0b\u9060\u7aefrepository\u7684\u7248\u672c\u5167\u5bb9\u5f8c,\u5c07\u76ee\u524d\u9060\u7aefrepository\u6709,\u4f46\u662f\u76ee\u524d\u672c\u5730\u7aefrepository\u6c92\u6709\u7684\u5167\u5bb9\u4e0b\u8f09\u4e00\u4efd\u56de\u4f86,\u540c\u6642\u79fb\u52d5origin\u76f8\u95dc\u7684\u5206\u652f </li> <li>\u5728\u539f\u7406\u4e0a, $ <code>git pull</code> = $ <code>git fetch</code> + $ <code>git merge FETCH_HEAD</code></li> <li><code>Fetch\u6307\u4ee4\u8aaa\u660e</code><ul> <li>\u9069\u7528\u60c5\u5883: \u53ea\u662f\u60f3\u78ba\u8a8d\u9060\u7aef\u6578\u64da\u5eab\u7684\u5167\u5bb9\u537b\u4e0d\u662f\u771f\u7684\u60f3\u5408\u4f75</li> <li>\u53ef\u4ee5\u53d6\u5f97\u9060\u7aef\u6578\u64da\u5eab\u7684\u6700\u65b0\u6b77\u53f2\u8a18\u9304; \u53d6\u5f97\u7684\u63d0\u4ea4\u6703\u5c0e\u5165\u5728\u81ea\u52d5\u5efa\u7acb\u7684\u5206\u652f\u4e2d,\u4e26\u53ef\u4ee5\u5207\u63db\u9019\u500b\u540d\u70ba<code>FETCH_HEAD</code>\u7684\u5206\u652f</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://backlog.com/git-tutorial/tw/stepup/stepup3_2.html</li> <li>$ <code>git fetch &lt;\u9060\u7aeforigin\u7bc0\u9ede&gt;</code>: \u5c07\u6574\u500b\u9060\u7aeforigin\u7bc0\u9ede\u7684\u5168\u90e8\u66f4\u65b0,\u5168\u90e8\u4e0b\u8f09\u56de\u4f86(\u9810\u8a2d\u60c5\u6cc1\u662f\u53d6\u56de\u6240\u6709\u5206\u652f\u7684\u66f4\u65b0)</li> <li>\u4f8b\u5982: $ <code>git fetch origin</code></li> <li>$ <code>git fetch &lt;\u9060\u7aeforigin\u7bc0\u9ede&gt; &lt;\u9060\u7aef\u5206\u652f\u7684\u540d\u7a31&gt;</code>: \u53ea\u5c07\u9060\u7aeforigin\u7bc0\u9ede\u7684\u7279\u5b9a\u5206\u652f(remote branch)\u7684\u66f4\u65b0\u4e0b\u8f09\u56de\u4f86</li> <li>\u4f8b\u5982: $ <code>git fetch origin master</code> </li> <li>$ <code>git fetch --all</code>: \u6703\u5f9e\u53e6\u4e00\u500brepository\u4e0b\u8f09<code>\u5206\u652f</code>(branch)\u548c<code>\u6a19\u7c64</code>(tag)</li> <li><code>--all</code>: \u4e0b\u8f09\u5168\u90e8\u9060\u7aef\u5206\u652f(remote branches)\u7684\u5167\u5bb9</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u56e0\u70ba\u73fe\u5728\u9019\u500b\u5c08\u6848\u4e4b\u524d\u6709\u63a8\u9001\u6771\u897f\u5230Server\u4e0a,\u6240\u4ee5\u9060\u7aef\u5206\u652f\u4e5f\u6703\u8a18\u9304\u4e00\u4efd\u5728\u672c\u6a5f\u4e0a,\u4e00\u6a23\u4e5f\u662f\u6709<code>HEAD</code>\u3001<code>master\u5206\u652f</code>,\u4f46\u6703\u5728\u524d\u9762\u52a0\u8a3b\u9060\u7aef\u7bc0\u9edeorigin,\u8b8a\u6210<code>origin/HEAD</code>\u3001<code>origin/master</code></li> <li>\u5176\u5be6\u4e4b\u524d\u5728<code>Push\u6307\u4ee4</code>\u6642\u6709\u52a0<code>-u</code> (=&gt; <code>--set-upstream</code>)\u53c3\u6578,\u5c31\u662f\u7528\u4f86\u8a2d\u5b9a<code>upstream</code>(\u4e0a\u6e38)\u7528\u7684,\u6240\u4ee5\u76ee\u524d\u9019\u500b<code>origin/master</code>\u9060\u7aef\u5206\u652f\u5176\u5be6\u5c31\u662f\u672c\u5730<code>master\u5206\u652f</code>\u7684upstream\u5594<ul> <li>\u53ef\u53c3\u8003 \u65b0\u5efa\u4e00\u500bGitHub repository,\u4e26\u63a8\u9001\u672c\u5730\u7aefrepository\u5230GitHub\u4e0a \u7ae0\u7bc0</li> </ul> </li> <li>\u5229\u7528 $ <code>git fetch origin master</code> \u5c07<code>\u9060\u7aef\u5206\u652f</code>(origin/master)\u4e0b\u8f09\u4e00\u4efd\u56de\u5230\u672c\u5730\u7aef\u7684<code>master\u5206\u652f</code>\u4e0a\u9762 </li> <li>\u56e0\u70ba\u9019\u500b\u9060\u7aef\u5206\u652f(origin/master)\u662f\u5f9emaster\u5206\u652f\u5206\u51fa\u53bb\u7684,\u800c\u4e14\u9032\u5ea6\u9084\u6bd4master\u5206\u652f\u9084\u8981\u65b0,\u53ef\u4ee5\u5229\u7528<code>Merge\u6307\u4ee4</code>\u5408\u4f75\u5b83\u5011<ul> <li>$ <code>git merge origin/master</code>: \u5c07\u76ee\u524d\u6240\u5728\u7684\u5206\u652f\u5408\u4f75\u5230<code>\u9060\u7aef\u5206\u652f</code>(origin/master); \u5c31\u80fd\u8b93<code>\u672c\u5730\u7aef\u5206\u652f</code>(master)\u8ddf\u4e0a<code>\u9060\u7aef\u5206\u652f</code>(origin/master)\u7684\u9032\u5ea6\u4e86</li> <li>\u53ef\u53c3\u8003 \u5206\u652f(branch)\u64cd\u4f5c \u7ae0\u7bc0\u7684 <code>git merge</code> \u7bc7</li> </ul> </li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/github/pull-from-github.html</li> <li>\u88dc\u51451: \u5176\u5be6\u53ef\u4ee5\u628a<code>origin/master</code>\u9019\u7a2e\u9060\u7aef\u5206\u652f\u8996\u70ba\u4e00\u500b\u5f9e\u539f\u4f86\u672c\u5730\u7aef<code>master\u5206\u652f</code>\u5206\u51fa\u53bb\u7684\u4e00\u500b\u5206\u652f\u5c31\u597d\u4e86</li> <li>\u88dc\u51452: \u56e0\u70ba<code>\u9060\u7aef\u5206\u652f</code>(origin/master)\u8207<code>\u672c\u5730\u7aef\u5206\u652f</code>(master)\u662f\u4f86\u81ea\u540c\u4e00\u500b\u6e90\u982d,\u6240\u4ee5\u5728\u9019\u6b21\u7684Merge\u904e\u7a0b,Git\u6703\u9810\u8a2d\u4f7f\u7528<code>\u5feb\u8f49\u6a21\u5f0f</code>(fast-forward\u6a21\u5f0f)</li> </ul> </li> <li><code>Pull\u6307\u4ee4\u8aaa\u660e</code><ul> <li>$ <code>git pull</code>: \u5176\u5be6\u5c31\u662f\u53bb\u9060\u7aeforigin\u7bc0\u9ede\u6293\u6771\u897f\u56de\u4f86(<code>Fetch</code>),\u4e26\u4e14\u66f4\u65b0\u672c\u6a5f\u7684\u9032\u5ea6(<code>Merge</code>)\u800c\u5df2</li> <li>\u57f7\u884c<code>Pull\u6307\u4ee4</code>\u6642,\u5982\u679c\u5167\u5bb9\u6c92\u6709\u885d\u7a81,\u5c31\u6703\u81ea\u52d5\u5efa\u7acb\u5408\u4f75\u63d0\u4ea4\u3002\u5982\u679c\u767c\u751f\u885d\u7a81\u7684\u8a71,\u9700\u5148\u89e3\u6c7a\u885d\u7a81\u7136\u5f8c\u518d\u624b\u52d5\u63d0\u4ea4</li> <li>\u4e5f\u53ef\u4ee5\u53ea\u7528<code>Rebase\u65b9\u5f0f</code>\u4f86\u5408\u4f75\u5206\u652f</li> <li>\u53ef\u53c3\u8003 \u5206\u652f(branch)\u64cd\u4f5c \u7ae0\u7bc0\u7684 <code>git rebase</code> \u7bc7</li> <li>$ <code>git pull --rebase</code>: \u6307\u5b9a\u4f7f\u7528<code>Rebase\u65b9\u5f0f</code>\u4f86\u5408\u4f75(Merge)\u4e0b\u8f09\u56de\u4f86\u7684\u5167\u5bb9<ul> <li><code>-r</code> (=&gt; <code>--rebase</code>): \u7576\u5f9e\u9060\u7aefrepository<code>\u4e0b\u8f09(Fetch)</code>\u56de\u4f86\u5f8c,\u5c07\u76ee\u524d\u6240\u5728\u7684\u5206\u652f(current branch)\u7528<code>Rebase\u7684\u65b9\u5f0f</code>\u5408\u4f75\u5230\u5176<code>\u4e0a\u6e38\u5206\u652f</code>(upstream branch)\u7684\u4e0a\u9762</li> </ul> </li> <li>\u9069\u7528\u60c5\u5883: \u7576\u4e0d\u60f3\u56e0\u70ba\u5408\u4f75\u5206\u652f\u800c\u591a\u7522\u751f\u4e00\u6b21<code>commit\u7d00\u9304</code>\u7684\u8a71,\u53ef\u4ee5\u7528<code>Rebase\u65b9\u5f0f</code>\u4f86\u5408\u4f75\u5206\u652f</li> </ul> </li> </ul>"},{"location":"version_control/git/#pushrepository","title":"\u70ba\u4ec0\u9ebc\u6709\u6642\u5019\u6703\u63a8\u9001(Push)\u4e0d\u4e0a\u53bb\u9060\u7aefrepository\u5462?","text":"<ul> <li>\u7576<code>\u9060\u7aeforigin\u7bc0\u9ede</code>\u7684repository\u5167\u5bb9\u6bd4\u6211\u5011\u7684<code>\u672c\u5730\u7aef\u5206\u652f</code>\u7684\u9019\u4efd\u5167\u5bb9\u9084\u8981\"\u65b0\"\u7684\u8a71,Git\u5c31\u4e0d\u6703\u8b93\u6211\u5011<code>\u63a8\u9001</code>(Push)\u4e0a\u53bb</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/github/fail-to-push.html</li> <li>\u6709\u6642\u5019\u662f\u56e0\u70ba\u591a\u4eba\u5171\u540c\u5354\u4f5c\u6642,\u7576<code>\u9060\u7aeforigin\u7bc0\u9ede</code>\u7684\u5206\u652f\u5df2\u7d93\u5148\u88ab\u67d0\u4eba\u66f4\u65b0\u6642,\u9019\u6642\u5019\u5176\u4ed6\u4eba\u5c31\u6703\u767c\u751f<code>\u63a8\u9001</code>(Push)\u4e0d\u4e0a\u53bb\u7684\u60c5\u6cc1</li> <li>\u5982\u540c\u4ee5\u4e0b\u60c5\u6cc1 </li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/github/fail-to-push.html</li> <li>\u9019\u6642\u5019\u6703\u67092\u7a2e\u65b9\u5f0f\u53ef\u4ee5\u7121\u6cd5<code>\u63a8\u9001</code>(Push)\u7684\u554f\u984c</li> <li>\u65b9\u6cd5\u4e00: \u5148\u66f4\u65b0\u672c\u5730\u7aef\u5132\u5b58\u5eab(local repository)\u7684\u5167\u5bb9,\u518d\u63a8\u9001\u4e0a\u53bb\u9060\u7aef\u5132\u5b58\u5eab(remote repository)\u4e00\u6b21<ul> <li>$ <code>git pull --rebase</code>: \u5c07<code>\u9060\u7aeforigin\u7bc0\u9ede</code>\u7684repository\u4e0b\u8f09\u56de\u4f86\u5f8c,\u6307\u5b9a\u8981\u7528<code>Rebase\u65b9\u5f0f</code>\u4f86\u5408\u4f75</li> <li><code>--rebase</code>: \u5c07\u76ee\u524d\u6240\u5728\u7684\u5206\u652frebase\u5230<code>\u9060\u7aeforigin\u7bc0\u9ede</code>\u7684<code>\u4e0a\u6e38\u5206\u652f</code>(upstream branch)\u7684\"\u4e0a\u9762\"</li> <li>\u6b64\u6642\u5982\u679c\u5408\u4f75\u6c92\u6709\u767c\u751f\u885d\u7a81\u7684\u8a71,\u5c31\u53ef\u4ee5\u9806\u5229\u7684\u5f80\u4e0a<code>\u63a8\u9001</code>(Push)\u4e86</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/github/fail-to-push.html</li> </ul> </li> <li>\u65b9\u6cd5\u4e8c: \u7121\u8ad6\u898f\u5247,\u5f37\u5236<code>\u63a8\u9001</code>(Push)\u4e0a\u53bb<ul> <li>$ <code>git push -f</code>: \u5f37\u5236\u5c07\u76ee\u524d<code>\u672c\u5730\u7aefrepository</code>\u7684\u5167\u5bb9\u63a8\u9001\u5230<code>\u9060\u7aeforigin\u7bc0\u9ede</code>\u7684repository\u4e0a\u9762,\u540c\u6642\u6703\u5c07\u539f\u672c\u9060\u7aefrepository\u7684\u5167\u5bb9\"\u8986\u84cb\u6389\"</li> <li><code>-f</code> (=&gt; <code>--force</code>): \"\u5f37\u5236\"\u57f7\u884c<code>\u63a8\u9001</code>(Push)\u6307\u4ee4</li> <li>\u6ce8\u610f! \u6b64\u65b9\u6cd5\u8981\u614e\u7528,\u56e0\u70ba\u6703\u8986\u84cb\u6389\u539f\u672c\u9060\u7aefrepository\u7684\u5167\u5bb9</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/github/fail-to-push.html</li> </ul> </li> </ul>"},{"location":"version_control/git/#repository","title":"\u5f9e\u4f3a\u670d\u5668\u4e0a\u8907\u88fd\u9060\u7aefrepository\u4e0b\u4f86","text":"<ul> <li>\u53ef\u4ee5\u5229\u7528$ <code>git clone &lt;HTTPS or SSH&gt;</code> \u6307\u4ee4\u4f86\u5c07\u9060\u7aef\u7684repository\u8907\u88fd\u4e00\u4efd\u5230\u672c\u5730\u7aef\u4f86\u6aa2\u8996</li> <li>\u53ef\u5148\u53c3\u8003 \u65b0\u5efa\u4e00\u500bGitHub repository,\u4e26\u63a8\u9001\u672c\u5730\u7aefrepository\u5230GitHub\u4e0a \u7ae0\u7bc0\u7684 HTTPS \u8207 SSH \u7684\u6bd4\u8f03</li> <li>\u65b9\u6cd5\u4e00: \u5229\u7528HTTPS\u7684\u65b9\u5f0f\u8907\u88fd<ul> <li>$ <code>git clone https://github.com/Hans-Tsai/gitLearn.git</code></li> <li>\u6b64\u65b9\u6cd5\u4f7f\u7528\u8005\u53ea\u8981\u7576\u4e0b\u8f38\u5165 <code>\u5e33\u865f</code> &amp; <code>\u5bc6\u78bc</code> \u5c31\u53ef\u4ee5\u8907\u88fd\u4e86</li> </ul> </li> <li>\u65b9\u6cd5\u4e8c: \u5229\u7528SSH\u7684\u65b9\u5f0f\u8907\u88fd<ul> <li>$ <code>git clone git@github.com:Hans-Tsai/gitLearn.git</code></li> <li>\u6b64\u65b9\u6cd5\u9700\u4e8b\u5148\u5728\u672c\u5730\u7aef\u7522\u751fSSH\u91d1\u9470\u5f8c,\u518d\u5230GitHub\u7684Settings\u505a\u8a2d\u5b9a; \u5b8c\u6210\u5f8c\u6703\u5982\u540c\u4ee5\u4e0b\u756b\u9762</li> <li></li> <li>\u8a2d\u5b9aGitHub SSH\u91d1\u9470\u8a8d\u8b49\u7684\u8a73\u7d30\u4f5c\u6cd5\u53ef\u4ee5\u53c3\u8003GitHub\u7684\u5b98\u65b9\u6587\u4ef6\u8aaa\u660e \u9023\u7d50: https://docs.github.com/en/enterprise-server@2.20/github/authenticating-to-github/adding-a-new-ssh-key-to-your-github-account</li> </ul> </li> <li>\u6b64\u8655\u7684<code>Clone\u6307\u4ee4</code>\u7684\u7528\u9014,\u4e0d\u55ae\u7d14\u53ea\u6709\u8907\u88fd\u6240\u6709\u5be6\u9ad4\u6a94\u6848,\u540c\u6642\u4e5f\u5305\u542b\u8907\u88fd\u4e86\u6574\u500b\u5c08\u6848\u7684\u4ee5\u4e0b\u5167\u5bb9</li> <li>\u6b77\u53f2\u7d00\u9304(log &amp; Reflog)</li> <li>\u5206\u652f(Branch)</li> <li>\u6a19\u7c64(Tag)</li> <li>\u5982\u679c\u60f3\u8981\u8907\u88fd\u4e0b\u4f86\u5f8c,\u91cd\u65b0\u547d\u540d\u9019\u500brepository\u7684\u8a71,\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u6307\u4ee4</li> <li>$ <code>git clone git@github.com:Hans-Tsai/gitLearn.git &lt;\u65b0\u547d\u540d\u7684\u5206\u652f\u540d\u7a31&gt;</code></li> <li>\u5728Git Version 1.7.10\u4e4b\u5f8c,\u5982\u679c\u60f3\u8981\u53ea\u55ae\u7d14\u5730\u5f9e\u9060\u7aefrepository\u8907\u88fd\u7279\u5b9a\u7684\u5206\u652f\u4e0b\u4f86\u5230\u672c\u6a5f\u7aef\u7684\u8a71,\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u6307\u4ee4</li> <li>$ <code>git clone -b &lt;\u6307\u5b9a\u8981\u8907\u88fd\u7684\u5206\u652f\u540d\u7a31&gt; --single-branch git@github.com:Hans-Tsai/gitLearn.git</code></li> <li><code>-b &lt;\u6307\u5b9a\u7684\u5206\u652f\u540d\u7a31&gt;</code> (=&gt; <code>--branch &lt;\u6307\u5b9a\u7684\u5206\u652f\u540d\u7a31&gt;</code>): Instead of pointing the newly created HEAD to the branch pointed to by the cloned repository\u2019s HEAD, point to  branch instead. In a non-bare repository, this is the branch that will be checked out. --branch can also take tags and detaches the HEAD at that commit in the resulting repository. <li><code>--single-branch</code>: \u53ea\u8907\u88fd\u8a72\u6307\u5b9a\u8981\u8907\u88fd\u7684\u5206\u652f\u7684\"\u6700\u65b0\"<code>\u6b77\u53f2commit\u7d00\u9304</code>,\u53ef\u4ee5\u642d\u914d<code>--branch</code>\u53c3\u6578\u4f86\u4f7f\u7528</li>"},{"location":"version_control/git/#clone-pull","title":"Clone(\u8907\u88fd) \u548c Pull(\u62c9\u4e0b\u4f86\u66f4\u65b0) \u6709\u4ec0\u9ebc\u4e0d\u540c\u5462?","text":"<ul> <li><code>Clone(\u8907\u88fd)</code></li> <li><code>\u4f7f\u7528\u60c5\u5883</code></li> <li>\u7576\u9019\u500b\u5c08\u6848\u662f\u7b2c\u4e00\u6b21\u770b\u5230,\u6211\u5011\u60f3\u8981\"\u8907\u88fd\"\u4e00\u4efd\u5230\u672c\u5730\u7aef\u4f86\u770b\u770b\u7684\u6642\u5019\u53ef\u4ee5\u7528<code>Clone(\u8907\u88fd)\u6307\u4ee4</code></li> <li>$ <code>git clone &lt;remote repo by HTTPS or SSH&gt;</code>: \u5f9e\u9060\u7aefrepository\u8907\u88fd\u4e00\u4efd\u9019\u500b\u5c08\u6848\u5230\u672c\u5730\u7aef\u7684\u96fb\u8166 </li> <li><code>Pull(\u62c9\u4e0b\u4f86\u66f4\u65b0)</code></li> <li><code>\u4f7f\u7528\u60c5\u5883</code></li> <li>\u7576\u9019\u500b\u5c08\u6848\u6211\u5df2\u7d93\u4e0b\u8f09\u56de\u4f86\u4e86(\u672c\u5730\u7aef\u5df2\u7d93\u6709\u4e00\u4efd\u9019\u500b\u5c08\u6848\u4e86)\u7684\u6642\u5019,\u53ea\u60f3\u8981\"\u66f4\u65b0\"\u5230\u8a72\u5c08\u6848\u6700\u65b0\u7248\u7684\u9060\u7aefrepository\u7684\u5167\u5bb9\u7684\u8a71,\u9019\u6642\u5019\u53ef\u4ee5\u4f7f\u7528<code>Pull(\u62c9\u4e0b\u4f86\u66f4\u65b0)\u6307\u4ee4</code></li> <li>$ <code>git pull &lt;\u9060\u7aef\u7bc0\u9ede\u540d\u7a31(ex: origin)&gt; &lt;\u8981\u5408\u4f75\u5230\u76ee\u524d\u6240\u5728\u5206\u652f\u4e0a\u9762\u7684\u9060\u7aef\u5206\u652f\u540d\u7a31&gt;</code>: \u5f9e\u9060\u7aefrepository<code>\u62c9\u4e0b\u4f86(Fetch)</code>\u4e00\u4efd\u5230\u672c\u5730\u7aef\u4e14<code>\u5408\u4f75(Merge)</code>\u5230\u76ee\u524d\u6240\u5728\u7684\u5206\u652f\u4e0a\u9762</li> </ul>"},{"location":"version_control/git/#pull-request","title":"\u5229\u7528Pull Request\u4f86\u8ddf\u5176\u5b83\u958b\u767c\u8005\u7684\u958b\u6e90\u5c08\u6848\u505a\u4e92\u52d5","text":"<ul> <li>\u56e0\u70ba\u6211\u5011\u6c92\u6709\u6b0a\u9650\u4f86<code>\u63a8\u9001</code>(Push)\u66f4\u65b0\u5230GitHub\u4e0a\u9762\u5225\u4eba\u7684\u5c08\u6848\u4e0a,<code>Fork</code>\u53ef\u4ee5\u7528\u4f86\u5c07GitHub\u4e0a\u5225\u7684\u958b\u767c\u8005\u5beb\u7684\u958b\u6e90\u5c08\u6848,\"\u8907\u88fd\"\u4e00\u4efd\u5230\u6211\u5011\u81ea\u5df1\u7684GitHub namespace\u4e0a,\u9019\u6a23\u6211\u5011\u5c31\u6709\u6b0a\u9650\u53ef\u4ee5<code>\u63a8\u9001</code>(Push)\u66f4\u65b0\u5230\u9019\u500b\u5c08\u6848\u4e0a\u4e86</li> <li><code>Fork</code>\u7684\u6d41\u7a0b\u4ecb\u7d39</li> <li>\u5148\u8907\u88fd(Fork)\u4e00\u4efd\u539f\u4f5c\u7684\u5c08\u6848\u5230\u4f60\u81ea\u5df1\u7684GitHub\u5e33\u865f\u5e95\u4e0b<ul> <li></li> </ul> </li> <li>\u56e0\u70ba\u9019\u500b\u8907\u88fd\u56de\u4f86\u7684\u5c08\u6848\u5df2\u7d93\u5728\u4f60\u81ea\u5df1\u7684GitHub\u5e33\u865f\u4e0b,\u6240\u4ee5\u4f60\u5c31\u6709\u5b8c\u6574\u7684\u6b0a\u9650,\u60f3\u600e\u9ebc\u6539\u5c31\u600e\u9ebc\u6539<ul> <li>$ <code>git clone &lt;\u81ea\u5df1GitHub\u4e0a\u525b\u525bFork\u56de\u4f86\u7684\u90a3\u500brepository&gt;</code></li> </ul> </li> <li>\u6539\u5b8c\u5f8c,\u5148\u63a8\u56de(Push)\"\u4f60\u81ea\u5df1\u5e33\u865f\"\u7684\u5c08\u6848<ul> <li>$ <code>git push</code></li> </ul> </li> <li>\u7136\u5f8c\u767c\u500b\"\u901a\u77e5\"(Pull Request),\u8b93\u539f\u4f5c\u8005\u77e5\u9053\u4f60\u6709\u5e6b\u5fd9\u505a\u4e86\u4e00\u4e9b\u4e8b\u60c5,\u8acb\u4ed6\u770b\u4e00\u4e0b<ul> <li>\u9019\u5c31\u662f<code>Pull Request</code>,<code>Pull Requset</code>\u5176\u5be6\u5c31\u662f\u767c\u4e00\u500b\u8acb\u6c42\u8acb\u539f\u4f5c\u8005\u62c9\u56de\u53bb(<code>Pull</code>)\u7684\u8acb\u6c42(<code>Request</code>),\u53ef\u4ee5\u7c21\u7a31\u70ba\"PR\"</li> <li></li> <li>\u56de\u5230\u81ea\u5df1\u7684\u5c08\u6848\u9801\u9762,\u9ede\u9078\"New pull request\"\u7684\u6309\u9215,\u518d\u9ede\u9078\"Create pull request\"\u7684\u6309\u9215\u5f8c,\u53ef\u4ee5\u9078\u64c7\u8981<code>PR</code>\u5230\u539f\u4f5c\u7684\u54ea\u500b\u5206\u652f</li> <li></li> </ul> </li> <li>\u539f\u4f5c\u8005\u770b\u5b8c\u5f8c\u8aaa\"\u6211\u89ba\u5f97\u53ef\u4ee5\",\u7136\u5f8c\u5c31\u6c7a\u5b9a\u628a\u4f60\u505a\u7684\u9019\u4e9b\u4fee\u6539\u5408\u4f75(<code>Merge</code>)\u5230\u4ed6\u7684\u5c08\u6848\u88e1<ul> <li>\u7576\u539f\u4f5c\u8005\u89ba\u5f97\u9019\u6b21\u7684\u4fee\u6539\u6c92\u554f\u984c\u7684\u8a71,\u5c31\u53ef\u4ee5\u6536\u4e0b\u9019\u6b21\u7684<code>PR</code>,\u9ede\u9078\"Merge pull request\"\u7684\u6309\u9215\u5f8c,\u5c31\u6703\u5408\u4f75(<code>Merge</code>)\u9019\u6b21\u7684commit\u4e86</li> </ul> </li> <li>\u53ef\u53c3\u8003\u5b98\u65b9\u6587\u4ef6\u63d0\u4f9b\u7684<code>Fork</code>\u6d41\u7a0b https://docs.github.com/en/free-pro-team@latest/github/getting-started-with-github/fork-a-repo</li> <li>\u53ef\u53c3\u8003\u5b98\u65b9\u6587\u4ef6\u63d0\u4f9b\u7684<code>Pull Request</code>\u6d41\u7a0b https://docs.github.com/en/free-pro-team@latest/github/collaborating-with-issues-and-pull-requests/about-pull-requests</li> <li>\u5728\u591a\u4eba\u5171\u540c\u5354\u4f5c\u7684\u5be6\u6230\u60c5\u5883\u4e2d,\u901a\u5e38\u6703\u5148\u6311\u9078\u56fa\u5b9a\u4e00\u500b\u5206\u652f\u4f5c\u70ba\u53ef\u4ee5\u4e0a\u7dda\u7684\u6b63\u5f0f\u7248\u672c\u5206\u652f,\u6163\u4f8b\u4e0a\u5e38\u6703\u6311\u9078<code>master</code>\u5206\u652f\u6216\u662f<code>production</code>\u5206\u652f\u4f5c\u70ba\u6b63\u5f0f\u5206\u652f; \u6bcf\u4f4d\u958b\u767c\u8005\u90fd\u6703\u5148\u5f9e\u516c\u53f8\u7684\u5c08\u6848<code>Fork</code>\u4e00\u4efd\u5230\u81ea\u5df1\u7684GitHub\u5e33\u865f\u88e1\u9762,\u518d\u4e0b\u8f09\u5230\u672c\u6a5f\u7aef\u9032\u884c\u958b\u767c,\u5f85\u958b\u767c\u7684\u529f\u80fd\u5b8c\u6210\u5f8c\u518d\u767c<code>PR</code>\u56de\u516c\u53f8\u7684\u5c08\u6848,\u6b64\u6642\u8ca0\u8cac\u7ba1\u7406\u9019\u500b\u5c08\u6848\u7684\u4eba\u6536\u5230<code>PR</code>\u5f8c,\u53ef\u4ee5\u958b\u59cb\u9032\u884c<code>Code Review</code>,\u4e26\u78ba\u8a8d\u7121\u8aa4\u5f8c\u4fbf\u53ef\u9032\u884c\u5408\u4f75,\u9019\u6a23\u505a\u7684\u512a\u9ede\u662f\u53ef\u4ee5\u4fdd\u6301\u8b93\u9019\u500b\u7522\u54c1\u7684\u5206\u652f\u8655\u65bc\u96a8\u6642\u90fd\u53ef\u4ee5\u4e0a\u7dda\u7684\u72c0\u614b</li> </ul>"},{"location":"version_control/git/#fork","title":"\u5982\u4f55\u8ddf\u4e0a\u7576\u521dFork\u7684\u5c08\u6848\u7684\u9032\u5ea6\u5462?","text":"<ul> <li>\u7576\u539f\u4f5c\u8005\u5148\u6536\u4e0b\u5225\u4eba\u7684<code>Pull Request</code>\u6642,\u8a72\u5c08\u6848\u7684\u9032\u5ea6\u5c31\u6703\u6bd4\u5728\u6211\u5011\u81ea\u5df1\u5e33\u865f\u5e95\u4e0b\u7684\u9032\u5ea6\u9084\u8981\u524d\u9762\u4e86; \u9019\u6642\u5982\u679c\u60f3\u8981\u8b93\u81ea\u5df1\u5e33\u865f\u5e95\u4e0b<code>Fork</code>\u904e\u4f86\u7684\u9019\u500b\u5c08\u6848\"\u8ddf\u4e0a\"\u539f\u4f5c\u5c08\u6848\u7684\u76ee\u524d\u7684\u9032\u5ea6\u7684\u8a71,\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b2\u7a2e\u65b9\u6cd5</li> <li>\u4e5f\u53ef\u4ee5\u5148\u53c3\u8003 \u70ba\u4ec0\u9ebc\u6709\u6642\u5019\u6703\u63a8\u9001(Push)\u4e0d\u4e0a\u53bb\u9060\u7aefrepository\u5462? \u7ae0\u7bc0</li> <li>\u65b9\u6cd5\u4e00: \u780d\u6389\u91cd\u65b0<code>Fork</code>\u4e00\u904d<ul> <li>\u53ef\u53c3\u8003 \u5229\u7528Pull Request\u4f86\u8ddf\u5176\u5b83\u958b\u767c\u8005\u7684\u958b\u6e90\u5c08\u6848\u505a\u4e92\u52d5 \u7ae0\u7bc0</li> </ul> </li> <li>\u65b9\u6cd5\u4e8c: \u8ddf\u4e0a\u6e38\u540c\u6b65<ul> <li>\u5148\u8a2d\u5b9a\u539f\u4f5c\u7684\u9060\u7aef\u7bc0\u9ede</li> <li>$ <code>git remote -v</code>: \u53ef\u4ee5\u5217\u51fa\u9060\u7aef\u7bc0\u9ede\u7684url</li> <li><code>-v</code> (=&gt; <code>--verbose</code>): \u8a73\u7d30\u5217\u51fa\u9060\u7aef\u7bc0\u9ede\u7684\u540d\u7a31\u8207url</li> <li></li> <li>$ <code>git remote add &lt;\u9060\u7aef\u7bc0\u9ede\u7684\u540d\u7a31&gt; &lt;\u9060\u7aef\u7bc0\u9ederepository\u7684url&gt;</code>: \u65b0\u589e\u53e6\u4e00\u500b\u9060\u7aef\u7bc0\u9ede\u540d\u7a31\u8207url,\u800c\u9019\u500b\u9060\u7aef\u7bc0\u9ede\u6307\u7684\u4f4d\u7f6e\u5c31\u662f\"\u539f\u4f5c\u7684\u5c08\u6848\"</li> <li>\u53ef\u53c3\u8003 \u65b0\u5efa\u4e00\u500bGitHub repository,\u4e26\u63a8\u9001\u672c\u5730\u7aefrepository\u5230GitHub\u4e0a \u7ae0\u7bc0\u7684 <code>git remote add</code>\u7bc7</li> <li>\u6293\u53d6\u539f\u4f5c\u5c08\u6848\u7684\u5167\u5bb9</li> <li>$ <code>git fetch &lt;\u525b\u525b\u8a2d\u5b9a\u597d\u7684\u65b0\u7684\u6307\u5411\u539f\u4f5c\u5c08\u6848\u7684\u9060\u7aef\u7bc0\u9ede\u7684\u540d\u7a31&gt;</code>: \u5229\u7528<code>Fetch</code>\u6307\u4ee4\u4f86\u53d6\u5f97\u539f\u4f5c\u5c08\u6848\u6700\u65b0\u7248\u7684\u5167\u5bb9</li> <li>$ <code>git merge &lt;\u8981\u5408\u4f75\u5230\u7684\u5206\u652f\u540d\u7a31&gt;</code>: \u5229\u7528<code>Merge</code>\u6307\u4ee4\u5408\u4f75\u5230<code>\u9060\u7aef\u7bc0\u9ede</code>(\u539f\u4f5c\u5c08\u6848)\u7684\u9060\u7aef\u5206\u652f\u4e0a\u9762</li> <li>\u4f8b\u5982: $ <code>git merge test_origin/master</code></li> <li>\u9019\u6a23\u4e00\u4f86\u6211\u5011\u672c\u6a5f\u7684\u9032\u5ea6\u5c31\u8ddf\u539f\u4f5c\u7684\u662f\u4e00\u6a23\u4e86</li> <li>\u5982\u679c\u60f3\u8981\u81ea\u5df1\u5728GitHub\u4e0a\u90a3\u500b<code>Fork</code>\u904e\u4f86\u7684\u5c08\u6848\u9032\u5ea6\u4e5f\u66f4\u65b0\u5230\u6700\u65b0\u7248\u7684\u8a71,\u53ea\u8981\u5c07\u73fe\u5728\u672c\u6a5f\u7aef\u7684\u5c08\u6848<code>\u63a8\u9001</code>(Push)\u4e0a\u53bb\u5c31\u597d\u4e86</li> <li>$ <code>git push origin master</code></li> <li>\u9019\u6a23\u4e00\u4f86,\u5728\u6211\u5011\u96fb\u8166\u88e1\u7684\u5c08\u6848,\u4ee5\u53ca\u5728GitHub\u4e0a\u5f9e\u539f\u4f5c\u90a3\u908a<code>Fork</code>\u904e\u4f86\u7684\u5c08\u6848\u90fd\u6703\u662f\u6700\u65b0\u7684\u9032\u5ea6\u4e86</li> </ul> </li> </ul>"},{"location":"version_control/git/#_10","title":"\u5982\u4f55\u522a\u9664\u9060\u7aef\u5206\u652f\u5462?","text":"<ul> <li>\u5176\u5be6\u8981\u522a\u9664\u9060\u7aef\u5206\u652f\u53ef\u4ee5\u900f\u904eGitHub\u4e0a\u5404\u500bRepository\u6700\u4e0a\u9762\u7684branches\u5716\u6848\u9ede\u9032\u53bb\u5f8c,\u5c31\u53ef\u4ee5\u522a\u9664\u9060\u7aef\u5206\u652f\u4e86(\u5783\u573e\u6876\u5716\u6848)</li> <li></li> <li>\u4e5f\u53ef\u4ee5\u900f\u904eGit\u6307\u4ee4\u4f86\u522a\u9664\u9060\u7aef\u5206\u652f</li> <li>$ <code>git push &lt;\u9060\u7aef\u7bc0\u9ede\u7684\u540d\u7a31&gt; &lt;\u8981\u8a18\u5f97\u5728\u9019\u908a\u7a7a\u4e00\u683c&gt;:&lt;\u8981\u522a\u9664\u7684\u9060\u7aef\u5206\u652f\u7684\u540d\u7a31&gt;</code>: \u5176\u5be6\u53ef\u4ee5\u900f\u904e<code>\u63a8\u9001</code>(Push)\u6642\u91cd\u65b0\u547d\u540d\u9060\u7aef\u5206\u652f\u7684\u540d\u7a31\u6642,\u4f86\u9054\u5230\u522a\u9664\u9060\u7aef\u5206\u652f\u7684\u6548\u679c</li> <li>\u53ef\u53c3\u8003 \u65b0\u5efa\u4e00\u500bGitHub repository,\u4e26\u63a8\u9001\u672c\u5730\u7aefrepository\u5230GitHub\u4e0a \u7ae0\u7bc0\u7684\u88dc\u51452(\u5982\u4f55\u5728\u63a8\u9001\u6642\u91cd\u65b0\u547d\u540d\u4e00\u500b\u9060\u7aef\u5206\u652f\u7684\u540d\u7a31\u5462?)</li> </ul>"},{"location":"version_control/git/#git-push-f-pushrepository","title":"\u4ec0\u9ebc\u6642\u6a5f\u9069\u5408\u7528$ <code>git push -f</code> \u4f86\u5f37\u5236\u63a8\u9001(Push)\u4e0a\u53bb\u5230\u9060\u7aefrepository\u5462?","text":"<ul> <li>\u7576\u60f3\u8981\u6574\u7406Git\u6b77\u53f2\u7d00\u9304or\u53ea\u6703\u5f71\u97ff\u5230\u81ea\u5df1\u4e00\u4eba\u6642,\u53ef\u4ee5\u4f7f\u7528\u5f37\u5236\u63a8\u9001( <code>$ git push -f</code> )\u7684\u6307\u4ee4</li> <li>\u6574\u7406\u6b77\u53f2\u7d00\u9304\u6642,\u6709\u6642\u5019\u6703\u9047\u5230\u8a72\u5c08\u6848\u7684<code>commit\u7d00\u9304</code>\u975e\u5e38\u6df7\u4e82,\u65bc\u662f\u6211\u5011\u4f7f\u7528\u4e86<code>Rebase\u7684\u65b9\u5f0f</code>\u4f86\u4fee\u6539<code>commit\u7684\u6b77\u53f2\u7d00\u9304</code>,\u4f46\u662f\u56e0\u70ba<code>Rebase</code>\u76f8\u7576\u65bc\u4fee\u6539\u5df2\u7d93\u767c\u751f\u7684\u4e8b\u5be6,\u6240\u4ee5\u6b63\u5e38\u4f86\u8aaa\u6703<code>\u63a8\u9001</code>(Push)\u4e0d\u4e0a\u53bb,\u9019\u6642\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528\u5f37\u5236\u63a8\u9001( <code>$ git push -f</code> )\u7684\u6307\u4ee4</li> <li>\u7576\u81ea\u5df1\u8981\u958b\u767c\u4e00\u500b\u65b0\u529f\u80fd\u4e26\u5f9e\u9060\u7aef\u7684repository \"\u958b\u4e86\u4e00\u500b\u65b0\u7684\u5206\u652f\" \u51fa\u4f86\u958b\u767c,\u4f46\u662f\u958b\u767c\u5b8c\u5f8c\u540c\u6a23\u767c\u73fecommit\u7d00\u9304\u592a\u904e\u7463\u788e\u4e86,\u60f3\u5229\u7528<code>Rebase\u7684\u65b9\u5f0f</code>\u4f86\u4fee\u6539<code>commit\u7684\u6b77\u53f2\u7d00\u9304</code>,\u4f46\u662f\u56e0\u70ba<code>Rebase</code>\u76f8\u7576\u65bc\u4fee\u6539\u5df2\u7d93\u767c\u751f\u7684\u4e8b\u5be6,\u6240\u4ee5\u6b63\u5e38\u4f86\u8aaa\u6703<code>\u63a8\u9001</code>(Push)\u4e0d\u4e0a\u53bb,\"\u4f46\u56e0\u70ba\u9019\u500b\u6b77\u53f2\u7d00\u9304\u5f71\u97ff\u7684\u7bc4\u570d\u53ea\u6709\u6211\u4e00\u500b\u4eba,\u6240\u4ee5\u4e26\u4e0d\u5f71\u97ff\u5176\u4ed6\u4eba\u6b63\u5e38\u4f7f\u7528\",\u6240\u4ee5\u9019\u6642\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528\u5f37\u5236\u63a8\u9001( <code>$ git push -f</code> )\u7684\u6307\u4ee4<ul> <li>\u4f8b\u5982: $ <code>git push -f origin features/my_branch</code></li> <li>\u9019\u6a23\u53ea\u6703\u5f37\u5236\u66f4\u65b0<code>features/my_branch</code>\u9019\u500b\u5206\u652f\u7684\u5167\u5bb9,\u4e26\u4e0d\u6703\u5f71\u97ff\u5176\u5b83\u5206\u652f\u3002</li> </ul> </li> <li>\u4e5f\u53ef\u4ee5\u4f7f\u7528GitHub\u63d0\u4f9b\u7684\u4fdd\u8b77\u6a5f\u5236,\u53ef\u4ee5\u907f\u514d\u67d0\u500b\u5206\u652f\u88ab<code>\u5f37\u5236\u63a8\u9001</code>(Force Push)\u4f86\u66f4\u65b0</li> <li>\u53ef\u4ee5\u5230\u8a72\u5c08\u6848\u7684<code>Settings</code>\u9801\u7c64,\u5de6\u908a\u9078\u64c7<code>Branches</code>,\u63a5\u8457\u53ef\u4ee5\u9078\u64c7\u60f3\u8981\u4fdd\u8b77\u7684\u5206\u652f,\u4e26\u8a2d\u5b9a\u8981\u4fdd\u8b77\u7684\u898f\u5247</li> <li>\u5982\u4ee5\u4e0b\u5716\u4f8b\u8aaa\u660e</li> <li></li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/github/using-force-push.html</li> <li>\u842c\u4e00\u5229\u7528$ <code>git push -f</code> \u4f86\u5f37\u5236\u63a8\u9001(Push)\u4e0a\u53bb\u5230\u9060\u7aefrepository\u5f8c\u53c8\u5f8c\u6094\u4e86\u7684\u8a71,\u53ef\u4ee5\u63db\u4f60\u6216\u662f\u5176\u5b83\u6709\u4e4b\u524d\u9032\u5ea6\u7684\u968a\u53cb,\u518d\u6b21\u9032\u884c$ <code>git push -f</code> \u6307\u4ee4\u4e00\u6b21,\u628a\u6b63\u78ba\u7684\u5167\u5bb9\u5f37\u8feb\u63a8\u4e0a\u53bb,\u84cb\u6389\u524d\u4e00\u6b21\u7684$ <code>git push -f</code> \u6307\u4ee4\u6240\u9020\u6210\u7684\u707d\u96e3</li> <li>\u53ef\u53c3\u8003 \u70ba\u4ec0\u9ebc\u6709\u6642\u5019\u6703\u63a8\u9001(Push)\u4e0d\u4e0a\u53bb\u9060\u7aefrepository\u5462? \u7ae0\u7bc0\u7684\u65b9\u6cd5\u4e8c: \u7121\u8ad6\u898f\u5247,\u5f37\u5236<code>\u63a8\u9001</code>(Push)\u4e0a\u53bb \u7bc7</li> </ul>"},{"location":"version_control/git/#patchrepository","title":"\u5982\u4f55\u900f\u904e<code>\u66f4\u65b0\u6a94</code>(Patch)\u4f86\u66f4\u65b0\u672c\u6a5f\u7aef\u7684repository\u7684\u5167\u5bb9\u5462?","text":"<ul> <li>\u5728Git\u548c\u8a31\u591a\u7248\u672c\u63a7\u5236\u7684\u8edf\u9ad4\u9084\u6c92\u6709\u8a95\u751f\u4ee5\u524d,\u958b\u767c\u8005\u5011\u5fc5\u9808\u900f\u904eEmail\u4f86\u5bc4\u9001\u66f4\u65b0\u6a94\u6848</li> <li>\u4f46\u662f\u6709\u4e86Git\u4e4b\u5f8c,\u4e5f\u53ef\u4ee5\u5229\u7528$ <code>git format-patch</code> \u6307\u4ee4\u4f86\u7522\u751f<code>\u66f4\u65b0\u6a94</code>(Patch)</li> <li>$ <code>git format-patch &lt;\u67d0\u500bCommit\u7269\u4ef6\u7684id&gt; &lt;\u67d0\u500bCommit\u7269\u4ef6\u7684id&gt;</code>: \u7522\u751f\u4e00\u4efd\u66f4\u65b0\u6a94,\u7bc4\u570d\u662f\u5f9e\u524d\u8005\u7684<code>Commit\u7269\u4ef6</code>\u5230\u5f8c\u8005\u7684<code>Commit\u7269\u4ef6</code>\u70ba\u6b62,\u4f46\"\u4e0d\u5305\u542b\"\u524d\u8005\u7684<code>Commit\u7269\u4ef6</code>\u672c\u8eab<ul> <li>\u5982\u540c\u4ee5\u4e0b\u5716\u7247\u793a\u7bc4</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/github/patch.html</li> </ul> </li> <li>\u4e5f\u53ef\u4ee5\u6307\u5b9a\u76f8\u5c0d\u7684$ <code>git log</code> \u7684<code>commit\u7d00\u9304</code>\u7684\u7bc4\u570d<ul> <li>$ <code>git format-patch -2</code>: \u9019\u6a23Git\u6703\u5e6b\u5fd9\u7522\u751f\u6700\u65b0\u76843\u6b21<code>commit\u7d00\u9304</code>\u7684<code>\u66f4\u65b0\u6a94</code>(Patch)</li> </ul> </li> <li>\u4e5f\u53ef\u4ee5\u6307\u5b9a\u7522\u751f\u7684<code>\u66f4\u65b0\u6a94</code>(Patch)\u7684\u4f4d\u7f6e<ul> <li>$ <code>git format-patch -2 -o &lt;\u66f4\u65b0\u6a94\u8981\u5b58\u653e\u7684\u6a94\u6848\u4f4d\u7f6e&gt;</code>: \u9019\u6a23Git\u6703\u5e6b\u5fd9\u7522\u751f\u6700\u65b0\u76843\u6b21<code>commit\u7d00\u9304</code>\u7684<code>\u66f4\u65b0\u6a94</code>(Patch),\u4e26\u6307\u5b9a\u5c07<code>\u66f4\u65b0\u6a94</code>(Patch)\u5b58\u653e\u5728\u6307\u5b9a\u7684\u4f4d\u7f6e</li> <li>\u5982\u540c\u4ee5\u4e0b\u5716\u7247\u793a\u7bc4</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/github/patch.html</li> </ul> </li> <li>\u53ef\u4ee5\u5229\u7528$ <code>git am</code> \u6307\u4ee4\u4f86<code>\u61c9\u7528</code>(Apply)<code>\u66f4\u65b0\u6a94</code>(Patch)</li> <li>$ <code>git am &lt; \u66f4\u65b0\u6a94\u5b58\u653e\u7684\u6a94\u6848\u4f4d\u7f6e\u8def\u5f91/* &gt;</code>: \u8868\u793a\u8981\u5c07\u8a72\u8def\u5f91\u4e0b\u7684<code>\u6240\u6709\u66f4\u65b0\u6a94</code>(Patches)\u90fd\u61c9\u7528\u5230\u73fe\u5728\u7684\u5c08\u6848\u4e0a</li> <li>\u53ef\u4ee5\u4e00\u6b21<code>\u61c9\u7528</code>(Apply)\u4e00\u500b\u66f4\u65b0\u6a94,\u4e5f\u53ef\u4ee5\u4e00\u6b21<code>\u61c9\u7528</code>(Apply)\u6240\u6709\u66f4\u65b0\u6a94</li> <li>Git\u6703\u4f9d\u64da\u6a94\u6848\u7684\u540d\u5b57\"\u4f9d\u5e8f\"\u4e00\u500b\u4e00\u500b\u5957\u7528\u5728\u73fe\u6709\u7684\u5c08\u6848\u4e0a\u9762</li> </ul>"},{"location":"version_control/git/#git_12","title":"Git \u5e38\u898b\u7684\u5718\u968a\u5de5\u4f5c\u6d41\u7a0b &amp; \u898f\u7bc4","text":"<p><code>GitHub Guides</code>(Official Guides) - https://guides.github.com/</p>"},{"location":"version_control/git/#git-flow","title":"Git Flow\u4ecb\u7d39","text":"<ul> <li><code>Git Flow</code>\u6700\u65e9\u662f\u5728\u897f\u51432010\u5e74\u88ab\u63d0\u51fa\u7684,<code>Git Flow</code>\u662f\u4e00\u5957\u5718\u968a\u5171\u540c\u5354\u4f5c\u7684\u5de5\u4f5c\u6d41\u7a0b,\u4ee5\u8b93\u5718\u968a\u5167\u7684\u6210\u54e1\u53ef\u4ee5\u6709\u4e00\u500b\u80fd\u5171\u540c\u9075\u5faa\u7684 \"\u958b\u767c\" &amp; \"\u7dad\u904b\" \u6d41\u7a0b</li> <li>\u7279\u8272: <code>Git Flow</code>\u6d41\u7a0b\u6703\u6709<code>master</code>\u3001<code>develop</code>\u3001<code>hotfix</code>\u3001<code>release</code>\u3001<code>feature</code>\u9019\u4e94\u7a2e\u5206\u652f,\u5404\u7a2e\u5206\u652f\u8ca0\u8cac\u4e0d\u540c\u7684\u529f\u80fd,\u5176\u4e2d<code>master</code>\u3001<code>develop</code>\u9019\u5169\u500b\u5206\u652f\u53c8\u88ab\u7a31\u4f5c\u9577\u671f\u5206\u652f,\u56e0\u70ba\u4ed6\u5011\u6703\u4e00\u76f4\u5b58\u6d3b\u5728\u6574\u500b<code>Git Flow</code>\u88e1,\u800c\u5176\u5b83\u7684\u5206\u652f\u5927\u591a\u6703\u56e0\u4efb\u52d9\u7d50\u675f\u800c\u88ab\u522a\u9664</li> <li>\u4ee5\u4e0b\u662f<code>Git Flow</code>\u6d41\u7a0b\u5716</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/chapters/gitflow/why-need-git-flow.html</li> <li>\u4ee5\u4e0b\u4ecb\u7d39<code>Git Flow</code>\u6d41\u7a0b\u4e2d\u6703\u78b0\u5230\u7684\u4e94\u5927\u5206\u652f</li> <li><code>\u9577\u671f\u5206\u652f</code> <ul> <li><code>Master</code> \u5206\u652f(= \u4e3b\u5206\u652f): \u4e3b\u8981\u662f\u7528\u4f86\u653e\u7a69\u5b9a\u3001\u96a8\u6642\u53ef\u4e0a\u7dda\u7684\u7248\u672c\u3002\u9019\u500b\u5206\u652f\u7684\u4f86\u6e90\u53ea\u80fd\u5f9e\u5225\u7684\u5206\u652f\u5408\u4f75\u904e\u4f86,\u958b\u767c\u8005\u4e0d\u6703\u76f4\u63a5commit \u5230\u9019\u500b\u5206\u652f\u3002\u56e0\u70ba\u662f\u7a69\u5b9a\u7248\u672c,\u6240\u4ee5\u901a\u5e38\u4e5f\u6703\u5728\u9019\u500b\u5206\u652f\u4e0a\u7684commit\u4e0a\u6253\u4e0a\u7248\u672c\u865f\u6a19\u7c64</li> <li><code>Develop</code> \u5206\u652f(= \u958b\u767c\u5206\u652f): \u4e3b\u8981\u662f\u6240\u6709\u958b\u767c\u7684\u57fa\u790e\u5206\u652f\u3002\u7576\u6709\u65b0\u7684\u529f\u80fd\u9700\u8981\u958b\u767c\u7684\u6642\u5019,\u6240\u6709\u7684Feature\u5206\u652f\u90fd\u662f\u5f9e\u9019\u908a\u5207\u51fa\u53bb\u3002\u800c\u7576<code>Feature\u5206\u652f</code>\u7684\u65b0\u529f\u80fd\u5b8c\u6210\u5f8c,\u4e5f\u90fd\u6703\u5408\u4f75\u56de\u4f86\u9019\u500b\u5206\u652f</li> </ul> </li> <li><code>\u77ed\u671f\u5206\u652f</code><ul> <li><code>Hotfix</code> \u5206\u652f(= \u4fee\u5fa9\u5206\u652f): \u7576\u7dda\u4e0a\u7522\u54c1\u767c\u751f\u7dca\u6025\u554f\u984c\u7684\u6642\u5019,\u6703**\u5f9eMaster\u5206\u652f\u958b\u4e00\u500bHotfix\u5206\u652f\u51fa\u4f86**\u9032\u884c\u4fee\u5fa9,\u7576<code>Hotfix\u5206\u652f</code>\u4fee\u5fa9\u5b8c\u6210\u4e4b\u5f8c,\u6703\u5408\u4f75\u56deMaster\u5206\u652f,\u4e5f\u540c\u6642\u6703\u5408\u4f75\u4e00\u4efd\u5230Develop\u5206\u652f</li> <li>\u8aaa\u660e1: \u4e4b\u6240\u4ee5\u8981\u5f9e<code>Master\u5206\u652f</code>\u5207\u51fa\u4f86\u4fee\u5fa9\u662f\u56e0\u70ba<code>Develop\u5206\u652f</code>\u53ef\u80fd\u5c1a\u5728\u958b\u767c\u4e2d,\u9019\u6642\u5019\u5982\u679c\u5f9e<code>Develop\u5206\u652f</code>\u5207\u51fa\u53bb\u518d\u4fee\u5fa9\u7684\u8a71,\u8981\u4f75\u56de<code>Master\u5206\u652f</code>\u6642,\u5f88\u53ef\u80fd\u6703\u9047\u5230\u5408\u4f75\u885d\u7a81\u7684\u554f\u984c</li> <li>\u8aaa\u660e2: \u4e4b\u6240\u4ee5\u8981\u7576\u4fee\u5fa9\u5b8c\u6642,\u8981\u5408\u4f75\u56de<code>Develop\u5206\u652f</code>\u662f\u56e0\u70ba\u5047\u8a2d\u4e4b\u5f8c<code>Develop\u5206\u652f</code>\u7684\u65b0\u529f\u80fd\u958b\u767c\u5b8c\u6210\u5f8c,\u4e26\u4e14\u4e5f\u5408\u4f75\u56de\u5230<code>Master\u5206\u652f</code>\u7684\u6642\u5019,\u9019\u6642\u5019<code>Hotfix</code>\u9047\u5230\u7684\u554f\u984c\u53c8\u6703\u518d\u5ea6\u6d6e\u73fe </li> <li><code>Release</code> \u5206\u652f(= \u9810\u767c\u5206\u652f): \u7576\u8a8d\u70ba<code>Develop\u5206\u652f</code>\u5920\u6210\u719f\u4e86,\u5c31\u53ef\u4ee5**\u628a<code>Develop\u5206\u652f</code>\u5408\u4f75\u5230<code>Release\u5206\u652f</code>,\u5728\u9019\u908a\u9032\u884c\u7b97\u662f\u4e0a\u7dda\u524d\u7684\u6700\u5f8c\u6e2c\u8a66**\u3002\u6e2c\u8a66\u5b8c\u6210\u5f8c,<code>Release\u5206\u652f</code>\u5c07\u6703\u540c\u6642\u5408\u4f75\u5230<code>Master</code>\u4ee5\u53ca<code>Develop</code>\u9019\u5169\u500b\u5206\u652f\u4e0a</li> <li>\u8aaa\u660e1: \u56e0\u70ba<code>Master\u5206\u652f</code>\u662f\u4e0a\u7dda\u7248\u672c,\u6240\u4ee5\u8981\u5408\u4f75\u5230<code>Master\u5206\u652f</code></li> <li>\u8aaa\u660e2: \u800c\u5408\u4f75\u56de<code>Develop\u5206\u652f</code>\u7684\u76ee\u7684,\u662f\u56e0\u70ba\u53ef\u80fd\u5728<code>Release\u5206\u652f</code>\u4e0a\u9084\u6703\u6e2c\u5230\u4e26\u4fee\u6b63\u4e00\u4e9b\u554f\u984c,\u6240\u4ee5\u9700\u8981\u8ddf<code>Develop\u5206\u652f</code>\u540c\u6b65,\u514d\u5f97\u4e4b\u5f8c\u7684\u7248\u672c\u53c8\u518d\u5ea6\u51fa\u73fe\u540c\u6a23\u7684\u554f\u984c</li> <li><code>Feature</code> \u5206\u652f(= \u529f\u80fd\u5206\u652f): \u7576\u8981\u958b\u59cb**\u65b0\u589e\u529f\u80fd\u7684\u6642\u5019,\u5c31\u662f\u4f7f\u7528<code>Feature\u5206\u652f</code>\u7684\u6642\u5019\u4e86**\u3002<code>Feature\u5206\u652f</code>\u90fd\u662f\u5f9e<code>Develop\u5206\u652f</code>\u4f86\u7684,\u5b8c\u6210\u4e4b\u5f8c\u6703\u518d\u4f75\u56de<code>Develop\u5206\u652f</code></li> </ul> </li> <li>\u95dc\u65bcGit Flow \u6d41\u7a0b\u7684\u4ecb\u7d39\u53ef\u4ee5\u53c3\u8003\u4ee5\u4e0b\u7684\u6587\u7ae0</li> <li><code>Git Flow</code>\u5c08\u6848on GitHub</li> <li>A successful Git branching model</li> </ul>"},{"location":"version_control/git/#github-flow","title":"GitHub Flow\u4ecb\u7d39","text":"<ul> <li><code>Github Flow</code>\u662f\u4e00\u500b\u9069\u540815\u201320\u4eba\u5de6\u53f3\u5718\u968a\uff0c\u5728\u90e8\u7f72\u4e0a\u81ea\u52d5\u5316\u4e14\u4e00\u5929\u4e4b\u5167\u6703\u9700\u8981\u591a\u6b21\u90e8\u7f72\u7684\u958b\u767c(\u6301\u7e8c\u767c\u5e03)</li> <li>\u7279\u8272: <code>GitHub Flow</code>\u662f\u4e00\u500b\u8f15\u91cf\u578b\u3001\u4ee5\u5206\u652f\u70ba\u57fa\u790e\u7684\u5de5\u4f5c\u6d41\u7a0b,\u53ef\u4ee5\u8b93\u6211\u5011\u7684\u5718\u968a\u8207\u5c08\u6848\u66f4\u6709\u898f\u5f8b\u5730\u90e8\u7f72 <p>GitHub flow is a lightweight, branch-based workflow that supports teams and projects where deployments are made regularly. --- by \u5b98\u65b9\u6587\u4ef6</p> </li> </ul> <p>There's only one rule: anything in the main branch is always deployable. --- --- by \u5b98\u65b9\u6587\u4ef6 - <code>GitHub Flow</code>\u5b98\u65b9\u6587\u4ef6\u4ecb\u7d39   + <code>\u524d\u7f6e\u6d41\u7a0b</code>:      * \u8981\u5148\u5c07\u9060\u7aef\u7684repository\u5229\u7528<code>Fork</code>\u7684\u65b9\u5f0f\u8907\u88fd\u5230\u81ea\u5df1\u7684GitHub repository     * \u5c07\u8a72<code>Fork</code>\u904e\u4f86\u7684\u5c08\u6848<code>Clone</code>(\u8907\u88fd)\u5230\u81ea\u5df1\u672c\u6a5f\u7aef(local)\u7684\u96fb\u8166\u4e0a   + <code>CREATE A BRANCH</code>: \u5728\u81ea\u5df1\u672c\u6a5f\u7aef(local)\u7684<code>Fork</code>\u904e\u4f86\u7684\u5c08\u6848\u4e0a,\u5efa\u7acb\u4e00\u500b\u65b0\u7684\u5206\u652f,\u4ee5\u8b93\u6211\u5011\u5b89\u5168\u7684\u505a\u958b\u767c\u548c\u8abf\u6574     * \u5305\u542b$ <code>git add</code>     * \u5305\u542b$ <code>git commit -m</code>   + <code>OPEN A PULL REQUEST</code>: \u5229\u7528<code>Pull Request</code>\u6a5f\u5236\u4f86 \u767c\u51fa/\u6536\u5230 \u5168\u4e16\u754c\u7684\u5176\u4ed6\u958b\u767c\u8005\u7684\u56de\u994b(feedback)     * \u5305\u542b <code>Conversation</code>     * \u5305\u542b <code>Code Review</code>   + <code>MERGE AND DEPLOY</code>: <code>\u5408\u4f75</code>(Merge)\u9019\u6b21<code>Pull Request</code>\u7684\u4fee\u6539\u5167\u5bb9\u5230\u539f\u4f5c\u8005\u7684\u9060\u7aefrepository\u4e0a,\u4e26\u4e14<code>\u90e8\u7f72</code>(Deploy)\u9019\u6b21\u7684\u4fee\u6539\u8b8a\u5316\u5230\u539f\u4f5c\u8005\u7684\u9060\u7aefrepository\u4e0a   + \u4ee5\u4e0b\u662f<code>GitHub Flow</code>\u5b98\u65b9\u7684\u6d41\u7a0b\u5716\u8aaa\u660e     *        \u53c3\u8003\u5716\u7247\u51fa\u8655https://guides.github.com/pdfs/githubflow-online.pdf   + \u95dc\u65bcGitHub Flow \u6d41\u7a0b\u7684\u4ecb\u7d39\u53ef\u4ee5\u53c3\u8003\u4ee5\u4e0b\u7684\u6587\u7ae0     * <code>GitHub Flow</code> \u5b98\u65b9\u5716\u89e3\u8aaa\u660e  - <code>GitHub Flow</code>\u6c11\u9593\u4ecb\u7d39   + GitHub \u6bd4 Git \u6709\u591a\u5169\u500b\u670d\u52d9,\u4e00\u500b\u662f<code>Fork</code>,\u53e6\u4e00\u500b\u662f<code>Pull Request</code>(\u7c21\u7a31PR),\u9084\u65b0\u589e<code>issue tracking</code>\u7528\u6cd5     * <code>issue tracking</code>: \u958b\u767c\u6642,\u53ef\u4ee5\u7d66\u5c08\u6848\u6a19\u8a18<code>issue</code>,\u9084\u6709\u5176\u4ed6\u4e0d\u540c\u6a19\u7c64,\u9084\u512a\u5316\u5c08\u6848\u3002\u7576\u63d0\u4ea4\u7684\u6642\u5019,\u5982\u679c\u63d0\u4ea4\u8a0a\u606f\u4e2d\u6709 fix #1 \u7b49,\u53ef\u4ee5\u81ea\u52d5\u5c0d\u61c9\u5230\u76f8\u95dc\u7de8\u865f\u7684<code>issue</code>     * \u95dc\u65bc<code>issue tracking</code>\u7684\u7528\u6cd5\u8aaa\u660e,\u53ef\u53c3\u8003 https://guides.github.com/features/issues/ or  https://github.com/g0v/dev/wiki/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-Issue-Tracker-%E5%9B%9E%E5%A0%B1%E5%95%8F%E9%A1%8C%E3%80%81%E6%8F%90%E4%BA%A4%E5%BB%BA%E8%AD%B0   + <code>GitHub Flow</code>\u7684\u6d41\u7a0b\u8aaa\u660e     * \u5148\u6709\u4e00\u500b\u5171\u6709\u7684\u9060\u7aef\u5009\u5eab(remote repository)     * \u7136\u5f8c\u5404\u81ea\u7528<code>Fork</code>\u628a\u9060\u7aef\u5009\u5eab<code>Fork</code>\u56de\u5230\u81ea\u5df1\u7684\u5009\u5eab(repository)     * \u5f9e<code>master\u5206\u652f</code>\u62c9\u51fa\u65b0\u5206\u652f,<code>\u4fee\u6539</code>\u4e14<code>\u63d0\u4ea4</code>(Commits)     * \u958b\u767c\u597d\u5f8c,\u518d\u5229\u7528<code>Pull Request</code>\u6a5f\u5236\u4f86\u767c\u4e00\u500b\u901a\u77e5\u56de\u53bb\u5171\u6709\u7684\u9060\u7aef\u5009\u5eab(remote repository)\u7684\u539f\u4f5c\u8005     * \u5f85\u5be9\u6838\u904e\u5f8c\u518d<code>\u5408\u4f75</code>(Merge)\u9032\u539f\u4f5c\u8005\u7684\u9060\u7aef\u5009\u5eab\u7684<code>master\u5206\u652f</code>     * \u5408\u4f75\u5f8c,<code>Pull Request</code>\u4fdd\u5b58\u4e86\u7576\u6642\u7684\u4fee\u6539\u6b77\u53f2\u8a18\u9304\u4ee5\u53ca\u56de\u994b,\u53ef\u4ee5\u8b93\u4efb\u958b\u767c\u4eba\u56de\u982d\u6aa2\u8996\u7576\u521d\u60c5\u6cc1    + \u4ee5\u4e0b\u662f<code>GitHub Flow</code>\u6c11\u9593\u7684\u6d41\u7a0b\u5716\u8aaa\u660e     *        \u53c3\u8003\u5716\u7247\u51fa\u8655https://medium.com/@lf2lf2111/%E4%B8%89%E7%A8%AE%E7%89%88%E6%8E%A7%E6%B5%81%E7%A8%8B-29c82f5d4469</p>"},{"location":"version_control/git/#gitlab-flow","title":"GitLab Flow\u4ecb\u7d39","text":"<ul> <li><code>GitLab flow</code>\u5206\u6210\u5169\u7a2e\u60c5\u6cc1\u4f86\u61c9\u4ed8\u4e0d\u540c\u7684\u958b\u767c\u6d41\u7a0b</li> <li>\u6301\u7e8c\u767c\u5e03(<code>Environment Branches</code> &amp; <code>Upstream First</code>)</li> <li>\u7248\u672c\u767c\u5e03(<code>Release Branches</code> &amp; <code>Upstream First</code>)</li> <li>\u7279\u8272: <code>GitLab Flow</code>\u6709\u4e00\u500b\u6700\u4e3b\u8981\u7684\u539f\u5247\u5c31\u662f\"\u4e0a\u6e38\u512a\u5148\"(<code>upstream first</code>),\u6240\u8b02**\u4e0a\u6e38\u512a\u5148**\u539f\u5247\u7684\u610f\u601d\u662f**\u53ea\u5b58\u5728\u4e00\u500b\u4e3b\u5206\u652fmaster,\u6b64\u5206\u652f\u70ba\u6240\u6709\u5176\u5b83\u7684\u5206\u652f\u7684\u4e0a\u6e38,\u4e5f\u5c31\u662f\u8aaa\u6240\u6709\u7684\u5206\u652f\u90fd\u662f\u7531\u4e3b\u5206\u652f(master\u5206\u652f)\u5efa\u7acb**; \u6240\u4ee5\u5206\u652f\u5408\u4f75\u7684\u9806\u5e8f\u5f88\u91cd\u8981,\u8981\u4e00\u6b21\u548c\u4e26\u4e14\u78ba\u4fdd\"\u901a\u904e\u6e2c\u8a66\"\u624d\u53ef\u4ee5\u5f80\u4e0b\u6e38\u5408\u4f75,\u9664\u975e\u662f\u7dca\u6025\u60c5\u6cc1,\u624d\u53ef\u4ee5\u5141\u8a31\u8df3\u904e\u4e0a\u6e38\u76f4\u63a5\u5728\u4e0b\u6e38\u64cd\u4f5c\u5408\u4f75</li> <li>\u5982\u4ee5\u4e0b\u7684\u5b98\u65b9\u5716\u89e3\u8aaa\u660e </li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://docs.gitlab.com/ee/topics/gitlab_flow.html#git-flow-and-its-problems</li> <li>\u63a5\u4e0b\u4f86\u8981\u4ecb\u7d39<code>GitLab Flow</code>\u7684\u5169\u7a2e\u60c5\u5883\u7684\u5de5\u4f5c\u6d41\u7a0b(<code>workflow</code>)</li> <li>\u6301\u7e8c\u767c\u5e03(<code>Environment Branches</code> &amp; <code>Upstream First</code>)<ul> <li>\u6301\u7e8c\u767c\u5e03\u7684\u5c08\u6848,\u6703\u5efa\u8b70\u518d\u591a\u51fa\u4e00\u500b\u5206\u652f,\u70ba<code>\u9810\u767c\u5206\u652f</code>(pre-production)</li> <li>\u6bcf\u500b\u74b0\u5883(\u5982\u958b\u767c\u74b0\u5883\u3001\u9810\u767c\u74b0\u5883\u3001\u6e2c\u8a66\u74b0\u5883\u2026\u7b49)\u90fd\u6703\u6709\u5c0d\u61c9\u7684\u5206\u652f\u3002\u5982\u4e0b\u5716,\u958b\u767c\u74b0\u5883\u70bamaster\u5206\u652f,\u9810\u767c\u74b0\u5883\u70ba<code>pre-production\u5206\u652f</code>,\u751f\u7522\u74b0\u5883\u70ba<code>production\u5206\u652f</code></li> <li>\u7531\u4e0b\u5716\u4f86\u8209\u4f8b,\u5982\u679c<code>\u751f\u7522\u74b0\u5883</code>(production)\u767c\u751f\u932f\u8aa4,\u5247\u8981\u5efa\u4e00\u500b\u65b0\u5206\u652f\u4fee\u6539\u5b8c\u5f8c\u5408\u4f75\u5230\u6700\u4e0a\u6e38\u7684<code>\u958b\u767c\u5206\u652f</code>(master),\u4e14**\u7d93\u904e\u6e2c\u8a66**,\u518d\u7e7c\u7e8c\u5f80<code>\u9810\u767c\u5206\u652f</code>\u5408\u4f75(pre-production),\u90fd\u8981\u7d93\u904e\u6e2c\u8a66\u6c92\u554f\u984c\u5f8c\u624d\u80fd\u5920\u518d\u5f80\u4e0b<code>\u5408\u4f75</code>(Merge)\u5230<code>\u751f\u7522\u74b0\u5883</code>\u3002</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://docs.gitlab.com/ee/topics/gitlab_flow.html#git-flow-and-its-problems</li> </ul> </li> <li>\u7248\u672c\u767c\u5e03(<code>Release Branches</code> &amp; <code>Upstream First</code>)<ul> <li>\u5728<code>GitLab Flow</code>\u4e2d,\u5c0d\u65bc**\u7248\u672c\u767c\u5e03**\u7684\u9805\u76ee,\u5efa\u8b70\u6bcf\u4e00\u500b\u7a69\u5b9a\u7684\u7248\u672c\u90fd\u8981\u5f9e<code>master\u5206\u652f</code>\u62c9\u51fa\u4f86\u5275\u5efa\u4e00\u500b\u65b0\u5206\u652f,\u6bd4\u5982\u4e0b\u5716\u7684<code>2\u20133-stable</code>\u3001<code>2\u20134-stable</code>(release\u5206\u652f)</li> <li>\u6839\u64da\u5c0d\u61c9\u7684<code>release\u5206\u652f</code>\u518d\u5275\u5efa\u4e00\u500b<code>\u4fee\u5fa9\u5206\u652f</code>,\u4fee\u88dcbug\u5f8c,\u4e00\u6a23\u8981\u7167\u8457\u4e0a\u6e38\u512a\u5148\u898f\u5247,\u5148<code>\u5408\u4f75</code>(Merge)\u5230<code>master\u5206\u652f</code>,\u78ba\u8a8d\u6c92\u554f\u984c\u904e\u5f8c,\u624d\u80fd\u5920\u5408\u4f75(Merge)\u5230release\u5206\u652f,\u4e26\u4e14\u8981\u66f4\u65b0\u7248\u672c\u865f</li> <li><code>Semantic Versioning</code>(\u8a9e\u6613\u5316\u7248\u672c\u898f\u7bc4)<ul> <li>\u7e3d\u5171\u6703\u662f\u4e09\u4f4d\u6578\u642d\u914d\u5169\u500b\u5c0f\u6578\u9ede\u7684\u7248\u672c\u8868\u793a\u65b9\u5f0f, \u4f8b\u5982: <code>2.0.0</code></li> <li>\u4e09\u500b\u4f4d\u6578\u4ee3\u8868\u7684\u5206\u5225\u662f: <code>MAJOR</code>.<code>MINOR</code>.<code>PATCH</code></li> <li><code>MAJOR version</code>: \u7576\u6211\u5011\u767c\u5e03\u8207\u4e4b\u524d\u7248\u672c**\u4e0d\u76f8\u5bb9(Incompatibal)** \u7684API\u8abf\u6574</li> <li><code>MINOR version</code>: \u7576\u6211\u5011\u65b0\u589e\u4e00\u500b\u53ef\u4ee5**\u5411\u5f8c\u517c\u5bb9\u898f\u7bc4(backwards compatible manner)** \u7684\u529f\u80fd</li> <li><code>PATCH version</code>: \u7576\u6211\u5011\u8655\u7406\u4e86\u53ef\u4ee5**\u5411\u5f8c\u517c\u5bb9(backwards compatible)** \u7684\u6545\u969c\u8655\u7406(bug fixes)</li> </ul> </li> <li>\u53ef\u53c3\u8003(Semantic Versioning)\u8a9e\u6613\u5316\u7248\u672c\u898f\u7bc4</li> <li>\u7576\u5982\u679c\u6709\u591a\u500b<code>release version</code>\u7684\u8a71\uff0c\u6703\u5efa\u7acb\u4e0d\u540c\u7248\u865f\u7684<code>release branch</code>\uff0c\u7576\u5982\u679c\u6709\u9700\u8981\u7248\u672c\u7684<code>\u66f4\u65b0\u6a94</code>(patch),\u6703\u85c9\u7531$ <code>git cherry-pick</code>\u6311\u9078\u9700\u8981\u7684<code>Commit\u7269\u4ef6</code>\u5230\u5c0d\u61c9\u7684\u7248\u672c\u5206\u652f(<code>release branch</code>)\u4e0a\u3002 </li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://docs.gitlab.com/ee/topics/gitlab_flow.html#git-flow-and-its-problems</li> </ul> </li> <li>GitLab Flow \u7684 <code>Merge Request</code>(MR)\u4ecb\u7d39</li> <li>\u5728GitLab Flow\u4e2d,\u7576\u9700\u8981\u5c07\u5169\u500b\u5206\u652f<code>\u5408\u4f75</code>(Merge)\u7684\u6642\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528<code>Merge Request</code></li> <li><code>Merge Request</code>\u53ef\u4ee5\u88ab\u7576\u4f5c<code>code review</code>\u7684\u5de5\u5177,\u800c\u4e14\u4e0d\u7528\u53e6\u5916\u5b89\u88dd\u984d\u5916\u7684\u8edf\u9ad4\u6216\u662f\u5957\u4ef6<ul> <li>\u7576\u6211\u5011\u65b0\u5efa\u4e00\u500b<code>Merge Request</code>\u5f8c,\u53ef\u4ee5\u7528 \"/cc @mark\" \u7684\u65b9\u5f0f\u4f86\u6a19\u8a18\u5176\u4ed6\u7684\u5718\u968a\u6210\u54e1,\u6b64\u6642\u4ee3\u8868\u8a72<code>MR</code>\u5c1a\u672a\u5b8c\u6210,\u4f46\u6b61\u8fce\u5927\u5bb6\u5c0d\u9019\u6b21\u7684<code>MR</code>\u505a\u51fa\u56de\u994b(<code>feedback</code>)</li> <li>\u9019\u6642\u6240\u6709\u7684\u5718\u968a\u6210\u54e1\u90fd\u53ef\u4ee5\u91dd\u5c0d\u9019\u6b21\u7684<code>MR</code>\u6240\u505a\u7684\u4fee\u6539\u505a\u51fa\u5168\u90e8(<code>general</code>)\u6216\u662f\u5c40\u90e8\u5c0d\u67d0\u5e7e\u884c(<code>specific line</code>)\u7684\u8a55\u8ad6(<code>line comments</code>)</li> <li>\u7576\u88ab\u6307\u6d3e\u6536\u5230<code>MR</code>\u7684\u6210\u54e1(\u901a\u5e38\u662f\u6700\u4e86\u89e3\u9019\u500b\u5c08\u6848\u7a0b\u5f0f\u78bc\u7684\u4eba or \u8a72\u5c08\u6848\u7684\u7ba1\u7406\u8005),\u89ba\u5f97\u6b64\u6b21\u7684<code>MR</code>\u662f\u53ef\u4ee5\u88ab\u63a5\u53d7\u7684,\u5c31\u6703\u63a5\u53d7\u6b64\u6b21\u7684<code>MR</code>,\u4e26<code>\u5408\u4f75</code>(Merge)\u5230\u4e3b\u5206\u652f(<code>master\u5206\u652f</code>)</li> <li>\u4f46\u5982\u679c\u88ab\u6307\u6d3e\u6536\u5230<code>MR</code>\u7684\u6210\u54e1(\u901a\u5e38\u662f\u6700\u4e86\u89e3\u9019\u500b\u5c08\u6848\u7a0b\u5f0f\u78bc\u7684\u4eba or \u8a72\u5c08\u6848\u7684\u7ba1\u7406\u8005),\u89ba\u5f97\u6b64\u6b21\u7684<code>MR</code>\u662f**\u4e0d\u80fd\u88ab\u63a5\u53d7\u7684**,\u4e5f\u53ef\u4ee5**\u62d2\u7d55\u63a5\u53d7\u6b64\u6b21\u7684MR**,\u4e26\u4e14**\u4e0d\u5408\u4f75**(Merge)\u5230\u4e3b\u5206\u652f(<code>master\u5206\u652f</code>)</li> <li>   \u53c3\u8003\u5716\u7247\u51fa\u8655https://docs.gitlab.com/ee/topics/gitlab_flow.html#git-flow-and-its-problems</li> </ul> </li> <li>\u5728GitLab Flow\u4e2d,\u6163\u4f8b\u4e0a\u90fd\u6703\u5c07<code>\u4e3b\u5206\u652f(master)</code>\u8a2d\u5b9a\u70ba<code>\u88ab\u4fdd\u8b77\u7684\u5206\u652f</code>(protected branch)</li> <li>\u6240\u4ee5\u5982\u679c\u6211\u5011\u60f3\u8981\u5c07\u9019\u6b21\u7684\u4fee\u6539<code>\u5408\u4f75</code>(Merge)\u5230<code>\u4e3b\u5206\u652f(master)</code>\u7684\u8a71,\u5c31\u8981\u5c07<code>MR</code>\u8acb\u6c42\u6307\u6d3e(<code>assign</code>)\u7d66\u64c1\u6709\u7dad\u8b77\u8005\u6b0a\u9650\u7684\u4eba(<code>maintainer permissions</code>)</li> <li>\u95dc\u65bcGitLab \u7684\u6b0a\u9650\u8a2d\u5b9a\u53ef\u4ee5\u53c3\u8003GitLab Permissions</li> </ul>"},{"location":"version_control/git/#git-flow-github-flow-gitlab-flow","title":"Git Flow &amp; GitHub Flow &amp; GitLab Flow \u4e09\u8005\u7684\u6bd4\u8f03","text":"<ul> <li><code>Git Flow</code></li> <li>\u512a\u9ede <ul> <li>\u662f\u4e00\u5957\u5b8c\u6574\u660e\u78ba\u4e14\u6e05\u6670\u7684\u5718\u968a\u5171\u540c\u5354\u4f5c\u6d41\u7a0b</li> <li>\u77ed\u671f\u5206\u652f(<code>hotfix</code> &amp; <code>release</code> &amp; <code>feature\u5206\u652f</code>)\u662f\u4f9d\u64da\"\u4efb\u52d9\"\u5efa\u7acb\u7684,\u7576\u4efb\u52d9\u7d50\u675f\u6642,\u5c31\u6703\u5408\u4f75\u5230\u9577\u671f\u5206\u652f(<code>master</code> &amp; <code>develop\u5206\u652f</code>)</li> </ul> </li> <li>\u7f3a\u9ede<ul> <li>\u76f8\u5c0d\u53e6\u5916\u5169\u7a2e\u5de5\u4f5c\u6d41\u7a0b(<code>workflow</code>)\u4f86\u8aaa\u6703\u6bd4\u8f03\u8907\u96dc</li> <li>\u9700\u983b\u7e41\u5207\u63db\u5206\u652f</li> <li>\u5728\u73fe\u4eca\u7248\u672c\u5feb\u901f\u66f4\u8fed\u7684\u6642\u4ee3,<code>Hotfix</code> &amp; <code>Release\u5206\u652f</code>\u662f\u5e7e\u4e4e\u7528\u4e0d\u5230\u7684\u3002\u56e0\u70ba\u5408\u4f75\u5230<code>master\u5206\u652f</code>\u5f8c\u5982\u679c\u6709<code>bug</code>\u5c31\u76f4\u63a5\u4fee\u5fa9\u4e14\u767c\u5e03\u4e0b\u500b\u7248\u672c\u4e86,\u5982\u679c\u9084\u4f7f\u7528\u9019\u5169\u500b\u5206\u652f,\u9700\u8981**\u5408\u4f75\u56dedevelop\u548cmaster\u5206\u652f**,\u4f46\u5be6\u969b\u4e0a**\u958b\u767c\u8005\u5f88\u5e38\u5fd8\u8a18\u5408\u4f75\u56de\u9019\u5169\u500b\u4e3b\u5206\u652f**</li> </ul> </li> <li>\u53ef\u53c3\u8003 Git Flow\u4ecb\u7d39 \u7ae0\u7bc0</li> <li><code>GitHub Flow</code></li> <li>\u512a\u9ede<ul> <li>\u9069\u5408\u5c6c\u65bc\u9700\u8981**\u6301\u7e8c\u767c\u5e03**\u7684\u5c08\u6848</li> <li>\u65b9\u4fbf\u7d50\u5408CI/CD (<code>Continuous integration</code>/<code>Continuous Delivery</code> &amp; <code>Continuous Deployment</code>)</li> <li>\u76f8\u5c0d<code>Git Flow</code>\u7c21\u55ae\u8a31\u591a</li> </ul> </li> <li>\u7f3a\u9ede<ul> <li><code>master\u5206\u652f</code>\u6703\u8b8a\u5f97\u4e0d\u7a69\u5b9a</li> <li><code>\u60c5\u5883\u8aaa\u660e</code></li> <li>\u7576\u9047\u5230iOS\u5b98\u65b9\u7248\u672c\u66f4\u65b0,\u800c\u5982\u679c\u5be9\u6838\u671f\u9593\u53c8\u6709\u65b0\u7248\u672c\u8981\u767c\u5e03\u7684\u8a71,\u9019\u500b\u6642\u5019\u53ea\u6709\u4e00\u500b<code>master\u4e3b\u5206\u652f</code>\u5c31\u6703\u4e0d\u5920\u7528,\u6240\u4ee5\u9084\u5f97\u53e6\u5916\u518d\u5efa\u4e00\u500b\u65b0\u5206\u652f\u4f86\u7dad\u8b77</li> <li>\u7576<code>master\u5206\u652f</code>\u5408\u4f75\u5f8c\u5982\u679c\u4e0d\u767c\u5e03,\u6703\u9020\u6210<code>\u7dda\u4e0a</code>(production)\u548c<code>master\u5206\u652f\u7684\u5167\u5bb9</code>\u4e0d\u4e00\u81f4</li> </ul> </li> <li>\u53ef\u53c3\u8003 GitHub Flow\u4ecb\u7d39 \u7ae0\u7bc0</li> <li><code>GitLab Flow</code></li> <li>\u512a\u9ede<ul> <li><code>GitLab Flow</code> \u7d50\u5408\u4e86 <code>Git Flow</code> &amp; <code>GitHub Flow</code>\u5169\u8005\u7684\u512a\u9ede</li> <li>\u6709\u958b\u767c\u74b0\u5883\u4e0a\u7684\u5f48\u6027\u53c8\u6709\u55ae\u4e00\u4e3b\u5206\u652f\u7684\u65b9\u4fbf</li> <li><code>master\u5206\u652f</code>\u7684\u5206\u652f\u4e0d\u5920,\u65bc\u662f\u589e\u52a0\u4e86\u4e00\u500b<code>production\u5206\u652f</code>,\u5c08\u9580\u7528\u4f86\u767c\u5e03\u7248\u672c(<code>release</code>)</li> <li>\u65b9\u4fbf\u7d50\u5408CI/CD (<code>Continuous integration</code>/<code>Continuous Delivery</code> &amp; <code>Continuous Deployment</code>)  </li> </ul> </li> <li>\u7f3a\u9ede<ul> <li>\u76f8\u8f03\u65bc<code>GitHub Flow</code>\u4f86\u8aaa\u6703\u6bd4\u8f03\u8907\u96dc</li> <li>\u7576<code>prodcution\u7248\u672c</code>\u9700\u8981\u591a\u500b\u7248\u672c(<code>pre-production\u5206\u652f</code>)\u4f86\u7dad\u8b77\u6642,\u53ef\u80fd\u6703\u8b8a\u5f97\u5982\u540c<code>Git Flow</code>\u4e00\u6a23\u8907\u96dc</li> </ul> </li> <li>\u53ef\u53c3\u8003 GitLab Flow\u4ecb\u7d39 \u7ae0\u7bc0</li> <li>\u4e09\u7a2e\u5718\u968a\u5171\u540c\u5354\u4f5c\u7684\u5de5\u4f5c\u6d41\u7a0b(workflow)\u7684\u5171\u540c\u9ede</li> <li>\u90fd\u662f**\u529f\u80fd\u9a45\u52d5\u5f0f\u958b\u767c**(<code>Feature-driven development</code>)---\u4ee5\u9700\u6c42\u70ba\u958b\u767c\u7684\u8d77\u9ede,\u5148\u6709\u9700\u6c42\u624d\u6709\u4ee5\u4e0a\u90a3\u4e9b\u5206\u652f,\u4e14\u958b\u767c\u5b8c\u5f8c\u8a72\u5206\u652f\u5c31\u6703\u88ab\u5408\u4f75\u5230\u4e3b\u5206\u652f,\u7136\u5f8c\u522a\u9664</li> <li><code>Git Flow</code> &amp; <code>GitHub Flow</code> &amp; <code>GitLab Flow</code> \u4e09\u7a2e\u5de5\u4f5c\u6d41\u7a0b\u7684\u6bd4\u8f03\u53ef\u53c3\u80034 branching workflows for Git</li> </ul>"},{"location":"version_control/git/#_11","title":"\u89c0\u5ff5\u88dc\u5145","text":"<p><code>git hash-object</code> - Compute object ID and optionally creates a blob from a file</p>"},{"location":"version_control/git/#terminal","title":"\u7d42\u7aef\u6a5f(Terminal)\u662f\u4ec0\u9ebc?","text":"<ul> <li>\u7d42\u7aef\u6a5f\u672c\u8eab\u901a\u5e38\u4e0d\u662f\u4e00\u90e8\u96fb\u8166,\u5b83\u672c\u8eab\u6c92\u6709\u904b\u7b97\u80fd\u529b,\u50c5\u7528\u4f86\u986f\u793a\u8cc7\u6599\u53ca\u8f38\u5165\u8cc7\u6599,\u6240\u6709\u7684\u8a08\u7b97\u90fd\u662f\u5728\u4e3b\u6a5f\u4e0a\u8655\u7406\u7684</li> <li>\u5176\u5be6\u7d42\u7aef\u6a5f\u5c31\u662f\u53ef\u4ee5\u8b93\u4f7f\u7528\u8005\u8f38\u5165\u6307\u4ee4,\u4f86\u8ddf\u96fb\u8166\u9032\u884c\u4e92\u52d5</li> </ul>"},{"location":"version_control/git/#vim-gitvim","title":"Vim \u662fGit\u7684\u9810\u8a2d\u7de8\u8f2f\u5668,Vim\u4e3b\u8981\u5e38\u7528\u7684\u5169\u7a2e\u6a21\u5f0f","text":"<ul> <li>Normal\u6a21\u5f0f:\u7121\u6cd5\u8f38\u5165\u6587\u5b57,\u50c5\u80fd\u8907\u88fd,\u8cbc\u4e0a,\u5b58\u6a94,\u96e2\u958b \u52d5\u4f5c</li> <li>Insert\u6a21\u5f0f:\u9700\u8981\u5148\u6309\u4e0b <code>I or A or O</code> ,\u624d\u80fd\u958b\u59cb\u8f38\u5165\u6587\u5b57</li> <li>\u5728Insert\u6a21\u5f0f\u4e0b,\u6309<code>esc</code>\u53ef\u9000\u56de\u5230Normal\u6a21\u5f0f</li> <li>\u5728Normal\u6a21\u5f0f\u4e0b,\u6309\u4e0b<code>:wq!</code> ,\u4ee3\u8868\u5f37\u5236\u5b58\u6a94\u5b8c\u6210\u5f8c\u76f4\u63a5\u95dc\u9589\u9019\u500b\u6a94\u6848</li> <li>     \u53c3\u8003\u5716\u7247\u51fa\u8655https://gitbook.tw/</li> </ul>"},{"location":"version_control/git/#sha-1","title":"SHA-1(\u5b89\u5168\u6563\u5217\u6f14\u7b97\u6cd5) \u4ecb\u7d39","text":"<ul> <li><code>SHA-1</code> (Secure Hash Algorithm 1)\u662f\u4e00\u7a2e\u96dc\u6e4a\u6f14\u7b97\u6cd5,\u8a08\u7b97\u4e4b\u5f8c\u7684\u7d50\u679c\u901a\u5e38\u6703\u4ee5<code>40</code>\u500b<code>16\u9032\u4f4d</code>\u7684\u6578\u5b57\u65b9\u5f0f\u4f86\u5448\u73fe</li> <li><code>SHA-1</code>: \u8a72\u6f14\u7b97\u6cd5\u7684\u7279\u6027\u4e4b\u4e00\u5c31\u662f,\u7576\u8f38\u5165\u7684\u503c\u76f8\u540c,\u5c31\u6703\u6709\u76f8\u540c\u7684\u8f38\u51fa\u503c</li> <li>\u5728Git\u4e2d,\u6240\u6709\u7269\u4ef6\u7684\"\u7de8\u865f\"\u7684\u8a08\u7b97,\u4e3b\u8981\u90fd\u662f\u900f\u904e\u9019\u500b\u6f14\u7b97\u6cd5\u7b97\u51fa\u4f86\u7684</li> <li>\u78b0\u649e(collision): \u4ee3\u8868\u8f38\u5165\u5169\u500b\u4e0d\u540c\u7684\u503c(\u4e0d\u540c\u7684\u6a94\u6848),\u537b\u5f97\u5230\u76f8\u540c\u7684\u7d50\u679c(\u76f8\u540c\u7684SHA-1\u503c),\u9019\u7a2e\u60c5\u6cc1\u7a31\u70ba\u78b0\u649e(collision)</li> <li>\u5728Git\u88e1,\u4e0d\u540c\u7a2e\u985e\u7684Git\u7269\u4ef6,<code>SHA-1</code>\u503c\u7684\u8a08\u7b97\u65b9\u5f0f\u6703\u6709\u4e9b\u4e0d\u540c</li> <li>\u53ef\u4ee5\u5229\u7528Git\u5167\u5efa\u7684$ <code>git hash-object</code> \u6307\u4ee4\u4f86\u5e6b\u5fd9\u7b97<code>SHA-1\u503c</code>,\u4e5f\u53ef\u4ee5\u5f97\u5230\u76f8\u540c\u7684\u7d50\u679c<ul> <li>$ <code>git hash-object</code>: \u8a08\u7b97\u51fa\u7269\u4ef6\u7684ID(<code>SHA-1\u503c</code>),\u4e26\u9078\u64c7\u6027\u5730\u5f9e\u4e00\u500b\u6307\u5b9a\u7684\u6a94\u6848,\u4f86\u5efa\u7acb\u4e00\u500bBlob\u7269\u4ef6<ul> <li><code>--stdin</code>: \u8b80\u53d6\u7269\u4ef6\u4f86\u81ea\u6a19\u6e96\u8f38\u5165,\u800c\u4e0d\u662f\u4f86\u81ea\u4e00\u500b\u6a94\u6848</li> </ul> </li> <li>\u4f8b\u5982: <code>Blob</code>\u7269\u4ef6\u7684<code>SHA-1</code>\u503c\u8a08\u7b97\u516c\u5f0f\u70ba</li> <li><code>blob\u5b57\u6a23</code> (\u82e5\u70ba<code>commit\u7269\u4ef6</code>,\u5247\u70ba<code>commit</code>\u5b57\u6a23;\u82e5\u70ba<code>Tree\u7269\u4ef6</code>,\u5247\u6539\u70ba<code>Tree</code>\u5b57\u6a23)</li> <li><code>\u4e00\u500b\u7a7a\u767d\u5b57\u5143</code></li> <li><code>\u8f38\u5165\u5167\u5bb9\u7684\u9577\u5ea6</code></li> <li><code>Null\u7d50\u675f\u7b26\u865f</code></li> <li><code>\u8f38\u5165\u5167\u5bb9</code></li> <li>\u5f9e\u4e0a\u5217\u516c\u5f0f\u53ef\u4ee5\u770b\u51fa,\u7b2c1~5\u9805\u90fd\u6c92\u6709\u8ddf<code>\u6642\u9593</code>\u6216\u662f<code>\u4e82\u78bc</code>\u6709\u95dc\u7684\u5167\u5bb9,\u53ea\u8ddf<code>\u8981\u8a08\u7b97\u7684\u5167\u5bb9</code>\u6709\u95dc</li> <li>\u4f46\u662f<code>Commit\u7269\u4ef6</code>\u548c<code>Tag\u7269\u4ef6</code>\u5247\u9664\u5916,\u56e0\u70ba\u9019\u5169\u500b\u7269\u4ef6\u672c\u8eab\u5c31<code>\u6709\u5305\u62ec\u6642\u9593</code></li> <li>\u6240\u4ee5,\u4ee5<code>Blob\u7269\u4ef6</code>\u4f86\u8aaa,\u4e0d\u7ba1\u662f\u5728\u4ec0\u9ebc\u6642\u9593\u6216\u4e0d\u540c\u7684\u96fb\u8166\u4e0a,\u4e00\u6a23\u7684\u8f38\u5165\u503c,\u5c31\u6703\u6709\u4e00\u6a23\u7684\u5167\u5bb9</li> <li>\u4f8b\u5982: $ <code>printf \"Hello, Hans Tsai\" | git hash-object --stdin</code> </li> <li></li> </ul> </li> </ul>"},{"location":"version_control/git/#_12","title":"\u53c3\u8003\u8cc7\u6599\u4f86\u6e90","text":""},{"location":"version_control/git/#_13","title":"\u66f8\u7c4d","text":"<ul> <li>\u70ba\u4f60\u81ea\u5df1\u5b78Git</li> <li>Pro Git</li> </ul>"},{"location":"version_control/git/#medium","title":"Medium","text":"<ul> <li>\u4e09\u7a2e\u5de5\u4f5c\u6d41\u7a0b: Git Flow &amp; GitHub Flow &amp; GitLab Flow \u7684\u4ecb\u7d39</li> <li>4 branching workflows for Git</li> </ul>"},{"location":"version_control/git/#it","title":"iT\u90a6\u5e6b\u5fd9","text":"<ul> <li>\u7528\u6a02\u9ad8\u73a9\u8f49 GIT \u7248\u672c\u63a7\u5236</li> <li>30\u5929\u7cbe\u901aGit\u7248\u672c\u63a7\u7ba1---by \u9ec3\u4fdd\u7fd5(Will \u4fdd\u54e5)</li> </ul>"},{"location":"version_control/git/#_14","title":"\u7df4\u7fd2\u5834","text":"<ul> <li>Git \u7df4\u7fd2\u5834</li> <li>Visualizing Git Concepts with D3---\u53ef\u7df4\u7fd2\u57fa\u790eGit\u6307\u4ee4</li> </ul>"},{"location":"version_control/git/#_15","title":"\u514d\u8cbb\u7dda\u4e0a\u5b78\u7fd2\u8cc7\u6e90","text":"<ul> <li>GitHub Cheat Sheets --- referenced to Git Official Docs</li> <li>Visual Git Cheat Sheets --- reference to Git Official Docs</li> <li>Resources to learn Git</li> </ul>"}]}